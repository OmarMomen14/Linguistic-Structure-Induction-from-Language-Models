Loading dataset...
Using subword tokenizer...
Number of tokens:  8000
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer_in_parser', nhid=512, nlayers=8, front_layers=3, rear_layers=5, subword='omarmomen/ptb_filtered_lowcase_bpe_tokenizer_8', n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=1111, nonmono=5, cuda=True, log_interval=100, save='trained_models/subword_structformer_in_parser_1111_35.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 37449108
Model architecture: StructFormer_In_Parser(
  (transformer_front): Transformer_Front(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(8000, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-2): 3 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
  (transformer_rear): Transformer_Rear(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(8000, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-4): 5 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (output_layer): Linear(in_features=512, out_features=8000, bias=True)
  )
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  269 batches | lr 0.00030 | ms/batch 173.53 | loss  7.77 | ppl  2372.82 
| epoch   1 |   200/  269 batches | lr 0.00030 | ms/batch 158.25 | loss  7.37 | ppl  1580.42 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 43.53s | valid loss  7.09 | valid ppl  1205.15 | valid bpc   10.235
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  269 batches | lr 0.00030 | ms/batch 166.10 | loss  7.28 | ppl  1451.24 
| epoch   2 |   200/  269 batches | lr 0.00030 | ms/batch 159.18 | loss  7.13 | ppl  1246.48 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 42.91s | valid loss  6.85 | valid ppl   942.80 | valid bpc    9.881
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  269 batches | lr 0.00030 | ms/batch 167.62 | loss  7.01 | ppl  1110.53 
| epoch   3 |   200/  269 batches | lr 0.00030 | ms/batch 196.77 | loss  6.78 | ppl   882.53 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 52.96s | valid loss  6.45 | valid ppl   630.40 | valid bpc    9.300
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  269 batches | lr 0.00030 | ms/batch 252.15 | loss  6.53 | ppl   687.19 
| epoch   4 |   200/  269 batches | lr 0.00030 | ms/batch 229.05 | loss  6.29 | ppl   539.37 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 64.93s | valid loss  5.92 | valid ppl   372.55 | valid bpc    8.541
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  269 batches | lr 0.00030 | ms/batch 252.54 | loss  6.06 | ppl   429.92 
| epoch   5 |   200/  269 batches | lr 0.00030 | ms/batch 229.75 | loss  5.92 | ppl   370.78 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 65.00s | valid loss  5.62 | valid ppl   277.16 | valid bpc    8.115
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  269 batches | lr 0.00030 | ms/batch 252.07 | loss  5.81 | ppl   333.99 
| epoch   6 |   200/  269 batches | lr 0.00030 | ms/batch 231.04 | loss  5.67 | ppl   290.86 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 65.03s | valid loss  5.40 | valid ppl   221.13 | valid bpc    7.789
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  269 batches | lr 0.00030 | ms/batch 253.98 | loss  5.60 | ppl   271.32 
| epoch   7 |   200/  269 batches | lr 0.00030 | ms/batch 229.15 | loss  5.51 | ppl   248.33 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 64.98s | valid loss  5.30 | valid ppl   200.01 | valid bpc    7.644
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  269 batches | lr 0.00030 | ms/batch 253.15 | loss  5.45 | ppl   232.97 
| epoch   8 |   200/  269 batches | lr 0.00030 | ms/batch 229.73 | loss  5.36 | ppl   213.78 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 65.05s | valid loss  5.19 | valid ppl   180.31 | valid bpc    7.494
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 8.0%
| epoch   9 |   100/  269 batches | lr 0.00030 | ms/batch 252.03 | loss  5.30 | ppl   200.04 
| epoch   9 |   200/  269 batches | lr 0.00030 | ms/batch 229.43 | loss  5.21 | ppl   183.47 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 64.98s | valid loss  5.06 | valid ppl   157.00 | valid bpc    7.295
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  269 batches | lr 0.00030 | ms/batch 253.71 | loss  5.20 | ppl   180.83 
| epoch  10 |   200/  269 batches | lr 0.00030 | ms/batch 229.74 | loss  5.10 | ppl   164.66 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 65.06s | valid loss  4.92 | valid ppl   137.08 | valid bpc    7.099
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  269 batches | lr 0.00030 | ms/batch 252.48 | loss  5.09 | ppl   162.30 
| epoch  11 |   200/  269 batches | lr 0.00030 | ms/batch 230.30 | loss  4.99 | ppl   147.20 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 65.40s | valid loss  4.84 | valid ppl   126.75 | valid bpc    6.986
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  269 batches | lr 0.00030 | ms/batch 253.26 | loss  5.00 | ppl   147.82 
| epoch  12 |   200/  269 batches | lr 0.00030 | ms/batch 229.44 | loss  4.92 | ppl   137.17 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 65.03s | valid loss  4.77 | valid ppl   117.60 | valid bpc    6.878
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 12.0%
| epoch  13 |   100/  269 batches | lr 0.00030 | ms/batch 252.97 | loss  4.87 | ppl   130.33 
| epoch  13 |   200/  269 batches | lr 0.00030 | ms/batch 228.66 | loss  4.82 | ppl   124.17 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 65.00s | valid loss  4.68 | valid ppl   107.54 | valid bpc    6.749
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 13.0%
| epoch  14 |   100/  269 batches | lr 0.00030 | ms/batch 252.03 | loss  4.78 | ppl   119.33 
| epoch  14 |   200/  269 batches | lr 0.00030 | ms/batch 229.36 | loss  4.74 | ppl   113.99 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 64.95s | valid loss  4.61 | valid ppl   100.96 | valid bpc    6.658
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  269 batches | lr 0.00030 | ms/batch 253.51 | loss  4.69 | ppl   109.00 
| epoch  15 |   200/  269 batches | lr 0.00030 | ms/batch 229.43 | loss  4.65 | ppl   104.28 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 65.04s | valid loss  4.53 | valid ppl    92.62 | valid bpc    6.533
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 15.0%
| epoch  16 |   100/  269 batches | lr 0.00030 | ms/batch 252.52 | loss  4.62 | ppl   101.19 
| epoch  16 |   200/  269 batches | lr 0.00030 | ms/batch 229.76 | loss  4.56 | ppl    95.31 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 65.04s | valid loss  4.51 | valid ppl    91.27 | valid bpc    6.512
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 16.0%
| epoch  17 |   100/  269 batches | lr 0.00030 | ms/batch 252.21 | loss  4.53 | ppl    92.91 
| epoch  17 |   200/  269 batches | lr 0.00030 | ms/batch 229.53 | loss  4.49 | ppl    89.39 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 65.39s | valid loss  4.41 | valid ppl    82.48 | valid bpc    6.366
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 17.0%
| epoch  18 |   100/  269 batches | lr 0.00030 | ms/batch 252.25 | loss  4.46 | ppl    86.89 
| epoch  18 |   200/  269 batches | lr 0.00030 | ms/batch 231.10 | loss  4.41 | ppl    82.64 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 65.05s | valid loss  4.37 | valid ppl    78.97 | valid bpc    6.303
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 18.0%
| epoch  19 |   100/  269 batches | lr 0.00030 | ms/batch 250.59 | loss  4.38 | ppl    79.76 
| epoch  19 |   200/  269 batches | lr 0.00030 | ms/batch 233.54 | loss  4.35 | ppl    77.56 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 65.15s | valid loss  4.34 | valid ppl    76.82 | valid bpc    6.263
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 19.0%
| epoch  20 |   100/  269 batches | lr 0.00030 | ms/batch 249.80 | loss  4.34 | ppl    76.52 
| epoch  20 |   200/  269 batches | lr 0.00030 | ms/batch 235.17 | loss  4.26 | ppl    71.16 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 65.58s | valid loss  4.24 | valid ppl    69.09 | valid bpc    6.110
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 20.0%
| epoch  21 |   100/  269 batches | lr 0.00030 | ms/batch 247.61 | loss  4.27 | ppl    71.86 
| epoch  21 |   200/  269 batches | lr 0.00030 | ms/batch 237.20 | loss  4.20 | ppl    66.58 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 65.38s | valid loss  4.27 | valid ppl    71.53 | valid bpc    6.161
-----------------------------------------------------------------------------------------
PROGRESS: 21.0%
| epoch  22 |   100/  269 batches | lr 0.00030 | ms/batch 246.94 | loss  4.17 | ppl    64.83 
| epoch  22 |   200/  269 batches | lr 0.00030 | ms/batch 236.03 | loss  4.17 | ppl    64.84 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 65.79s | valid loss  4.19 | valid ppl    65.72 | valid bpc    6.038
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 22.0%
| epoch  23 |   100/  269 batches | lr 0.00030 | ms/batch 244.47 | loss  4.14 | ppl    62.80 
| epoch  23 |   200/  269 batches | lr 0.00030 | ms/batch 239.62 | loss  4.10 | ppl    60.30 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 65.68s | valid loss  4.14 | valid ppl    62.60 | valid bpc    5.968
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 23.0%
| epoch  24 |   100/  269 batches | lr 0.00030 | ms/batch 243.74 | loss  4.09 | ppl    59.75 
| epoch  24 |   200/  269 batches | lr 0.00030 | ms/batch 239.20 | loss  4.06 | ppl    58.12 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 65.82s | valid loss  4.19 | valid ppl    65.88 | valid bpc    6.042
-----------------------------------------------------------------------------------------
PROGRESS: 24.0%
| epoch  25 |   100/  269 batches | lr 0.00030 | ms/batch 244.17 | loss  4.03 | ppl    56.31 
| epoch  25 |   200/  269 batches | lr 0.00030 | ms/batch 238.52 | loss  4.01 | ppl    55.17 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 65.84s | valid loss  4.14 | valid ppl    62.53 | valid bpc    5.967
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 25.0%
| epoch  26 |   100/  269 batches | lr 0.00030 | ms/batch 239.60 | loss  3.95 | ppl    51.94 
| epoch  26 |   200/  269 batches | lr 0.00030 | ms/batch 240.24 | loss  3.96 | ppl    52.59 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 65.73s | valid loss  4.04 | valid ppl    56.87 | valid bpc    5.830
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 26.0%
| epoch  27 |   100/  269 batches | lr 0.00030 | ms/batch 241.87 | loss  3.92 | ppl    50.58 
| epoch  27 |   200/  269 batches | lr 0.00030 | ms/batch 238.33 | loss  3.89 | ppl    48.81 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 65.74s | valid loss  4.05 | valid ppl    57.27 | valid bpc    5.840
-----------------------------------------------------------------------------------------
PROGRESS: 27.0%
| epoch  28 |   100/  269 batches | lr 0.00030 | ms/batch 240.31 | loss  3.89 | ppl    48.75 
| epoch  28 |   200/  269 batches | lr 0.00030 | ms/batch 238.26 | loss  3.84 | ppl    46.73 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 65.49s | valid loss  4.01 | valid ppl    55.42 | valid bpc    5.792
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  269 batches | lr 0.00030 | ms/batch 237.80 | loss  3.81 | ppl    45.10 
| epoch  29 |   200/  269 batches | lr 0.00030 | ms/batch 240.90 | loss  3.81 | ppl    45.23 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 65.59s | valid loss  4.03 | valid ppl    56.52 | valid bpc    5.821
-----------------------------------------------------------------------------------------
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  269 batches | lr 0.00030 | ms/batch 240.29 | loss  3.80 | ppl    44.87 
| epoch  30 |   200/  269 batches | lr 0.00030 | ms/batch 238.83 | loss  3.75 | ppl    42.62 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 65.51s | valid loss  4.02 | valid ppl    55.87 | valid bpc    5.804
-----------------------------------------------------------------------------------------
PROGRESS: 30.0%
| epoch  31 |   100/  269 batches | lr 0.00030 | ms/batch 237.06 | loss  3.76 | ppl    43.00 
| epoch  31 |   200/  269 batches | lr 0.00030 | ms/batch 239.08 | loss  3.72 | ppl    41.07 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 65.20s | valid loss  3.95 | valid ppl    52.17 | valid bpc    5.705
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 31.0%
| epoch  32 |   100/  269 batches | lr 0.00030 | ms/batch 238.60 | loss  3.70 | ppl    40.37 
| epoch  32 |   200/  269 batches | lr 0.00030 | ms/batch 239.87 | loss  3.68 | ppl    39.79 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 65.58s | valid loss  3.96 | valid ppl    52.26 | valid bpc    5.708
-----------------------------------------------------------------------------------------
PROGRESS: 32.0%
| epoch  33 |   100/  269 batches | lr 0.00030 | ms/batch 234.60 | loss  3.68 | ppl    39.75 
| epoch  33 |   200/  269 batches | lr 0.00030 | ms/batch 238.43 | loss  3.65 | ppl    38.37 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 65.11s | valid loss  3.93 | valid ppl    50.68 | valid bpc    5.663
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 33.0%
| epoch  34 |   100/  269 batches | lr 0.00030 | ms/batch 234.83 | loss  3.64 | ppl    38.07 
| epoch  34 |   200/  269 batches | lr 0.00030 | ms/batch 240.36 | loss  3.63 | ppl    37.72 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 65.22s | valid loss  3.93 | valid ppl    50.68 | valid bpc    5.663
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 34.0%
| epoch  35 |   100/  269 batches | lr 0.00030 | ms/batch 242.90 | loss  3.59 | ppl    36.09 
| epoch  35 |   200/  269 batches | lr 0.00030 | ms/batch 238.32 | loss  3.58 | ppl    35.87 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 65.87s | valid loss  3.97 | valid ppl    52.96 | valid bpc    5.727
-----------------------------------------------------------------------------------------
PROGRESS: 35.0%
| epoch  36 |   100/  269 batches | lr 0.00030 | ms/batch 235.91 | loss  3.56 | ppl    35.08 
| epoch  36 |   200/  269 batches | lr 0.00030 | ms/batch 239.27 | loss  3.54 | ppl    34.42 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 65.23s | valid loss  3.90 | valid ppl    49.17 | valid bpc    5.620
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 36.0%
| epoch  37 |   100/  269 batches | lr 0.00030 | ms/batch 238.62 | loss  3.53 | ppl    34.06 
| epoch  37 |   200/  269 batches | lr 0.00030 | ms/batch 239.23 | loss  3.52 | ppl    33.68 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 65.55s | valid loss  3.86 | valid ppl    47.49 | valid bpc    5.570
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 37.0%
| epoch  38 |   100/  269 batches | lr 0.00030 | ms/batch 243.19 | loss  3.50 | ppl    33.13 
| epoch  38 |   200/  269 batches | lr 0.00030 | ms/batch 239.78 | loss  3.50 | ppl    33.14 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 65.94s | valid loss  3.92 | valid ppl    50.56 | valid bpc    5.660
-----------------------------------------------------------------------------------------
PROGRESS: 38.0%
| epoch  39 |   100/  269 batches | lr 0.00030 | ms/batch 230.32 | loss  3.48 | ppl    32.62 
| epoch  39 |   200/  269 batches | lr 0.00030 | ms/batch 239.21 | loss  3.42 | ppl    30.61 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 64.82s | valid loss  3.90 | valid ppl    49.37 | valid bpc    5.626
-----------------------------------------------------------------------------------------
PROGRESS: 39.0%
| epoch  40 |   100/  269 batches | lr 0.00030 | ms/batch 241.26 | loss  3.44 | ppl    31.12 
| epoch  40 |   200/  269 batches | lr 0.00030 | ms/batch 240.15 | loss  3.43 | ppl    30.97 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 65.89s | valid loss  3.87 | valid ppl    48.03 | valid bpc    5.586
-----------------------------------------------------------------------------------------
PROGRESS: 40.0%
| epoch  41 |   100/  269 batches | lr 0.00015 | ms/batch 238.34 | loss  3.35 | ppl    28.57 
| epoch  41 |   200/  269 batches | lr 0.00015 | ms/batch 239.78 | loss  3.31 | ppl    27.36 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 65.60s | valid loss  3.81 | valid ppl    45.33 | valid bpc    5.502
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 41.0%
| epoch  42 |   100/  269 batches | lr 0.00015 | ms/batch 241.50 | loss  3.28 | ppl    26.67 
| epoch  42 |   200/  269 batches | lr 0.00015 | ms/batch 240.65 | loss  3.26 | ppl    25.93 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 65.89s | valid loss  3.81 | valid ppl    45.32 | valid bpc    5.502
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 42.0%
| epoch  43 |   100/  269 batches | lr 0.00015 | ms/batch 238.38 | loss  3.27 | ppl    26.32 
| epoch  43 |   200/  269 batches | lr 0.00015 | ms/batch 239.00 | loss  3.24 | ppl    25.47 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 65.57s | valid loss  3.81 | valid ppl    45.19 | valid bpc    5.498
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 43.0%
| epoch  44 |   100/  269 batches | lr 0.00015 | ms/batch 238.35 | loss  3.25 | ppl    25.85 
| epoch  44 |   200/  269 batches | lr 0.00015 | ms/batch 239.88 | loss  3.21 | ppl    24.68 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 65.56s | valid loss  3.77 | valid ppl    43.20 | valid bpc    5.433
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 44.0%
| epoch  45 |   100/  269 batches | lr 0.00015 | ms/batch 243.58 | loss  3.24 | ppl    25.45 
| epoch  45 |   200/  269 batches | lr 0.00015 | ms/batch 238.75 | loss  3.19 | ppl    24.39 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 65.92s | valid loss  3.79 | valid ppl    44.15 | valid bpc    5.464
-----------------------------------------------------------------------------------------
PROGRESS: 45.0%
| epoch  46 |   100/  269 batches | lr 0.00015 | ms/batch 239.51 | loss  3.19 | ppl    24.27 
| epoch  46 |   200/  269 batches | lr 0.00015 | ms/batch 240.05 | loss  3.16 | ppl    23.68 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 65.60s | valid loss  3.79 | valid ppl    44.05 | valid bpc    5.461
-----------------------------------------------------------------------------------------
PROGRESS: 46.0%
| epoch  47 |   100/  269 batches | lr 0.00015 | ms/batch 243.34 | loss  3.16 | ppl    23.57 
| epoch  47 |   200/  269 batches | lr 0.00015 | ms/batch 238.87 | loss  3.15 | ppl    23.32 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 65.96s | valid loss  3.72 | valid ppl    41.29 | valid bpc    5.368
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 47.0%
| epoch  48 |   100/  269 batches | lr 0.00015 | ms/batch 234.94 | loss  3.15 | ppl    23.31 
| epoch  48 |   200/  269 batches | lr 0.00015 | ms/batch 239.24 | loss  3.13 | ppl    22.87 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 65.21s | valid loss  3.78 | valid ppl    43.78 | valid bpc    5.452
-----------------------------------------------------------------------------------------
PROGRESS: 48.0%
| epoch  49 |   100/  269 batches | lr 0.00015 | ms/batch 243.31 | loss  3.14 | ppl    23.22 
| epoch  49 |   200/  269 batches | lr 0.00015 | ms/batch 238.92 | loss  3.11 | ppl    22.39 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 65.84s | valid loss  3.79 | valid ppl    44.09 | valid bpc    5.463
-----------------------------------------------------------------------------------------
PROGRESS: 49.0%
| epoch  50 |   100/  269 batches | lr 0.00015 | ms/batch 238.10 | loss  3.11 | ppl    22.49 
| epoch  50 |   200/  269 batches | lr 0.00015 | ms/batch 240.19 | loss  3.11 | ppl    22.44 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 65.49s | valid loss  3.77 | valid ppl    43.58 | valid bpc    5.446
-----------------------------------------------------------------------------------------
PROGRESS: 50.0%
| epoch  51 |   100/  269 batches | lr 0.00007 | ms/batch 243.81 | loss  3.11 | ppl    22.35 
| epoch  51 |   200/  269 batches | lr 0.00007 | ms/batch 238.09 | loss  3.02 | ppl    20.58 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 65.86s | valid loss  3.76 | valid ppl    42.83 | valid bpc    5.421
-----------------------------------------------------------------------------------------
PROGRESS: 51.0%
| epoch  52 |   100/  269 batches | lr 0.00007 | ms/batch 238.35 | loss  3.03 | ppl    20.75 
| epoch  52 |   200/  269 batches | lr 0.00007 | ms/batch 239.70 | loss  3.04 | ppl    20.82 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 65.54s | valid loss  3.70 | valid ppl    40.28 | valid bpc    5.332
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 52.0%
| epoch  53 |   100/  269 batches | lr 0.00007 | ms/batch 242.41 | loss  3.04 | ppl    20.90 
| epoch  53 |   200/  269 batches | lr 0.00007 | ms/batch 238.78 | loss  3.02 | ppl    20.54 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 65.91s | valid loss  3.78 | valid ppl    43.75 | valid bpc    5.451
-----------------------------------------------------------------------------------------
PROGRESS: 53.0%
| epoch  54 |   100/  269 batches | lr 0.00007 | ms/batch 241.08 | loss  3.01 | ppl    20.35 
| epoch  54 |   200/  269 batches | lr 0.00007 | ms/batch 240.03 | loss  2.97 | ppl    19.56 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 65.92s | valid loss  3.71 | valid ppl    40.95 | valid bpc    5.356
-----------------------------------------------------------------------------------------
PROGRESS: 54.0%
| epoch  55 |   100/  269 batches | lr 0.00007 | ms/batch 239.62 | loss  3.02 | ppl    20.39 
| epoch  55 |   200/  269 batches | lr 0.00007 | ms/batch 238.45 | loss  2.98 | ppl    19.75 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 65.54s | valid loss  3.69 | valid ppl    39.96 | valid bpc    5.321
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  269 batches | lr 0.00007 | ms/batch 242.59 | loss  2.99 | ppl    19.89 
| epoch  56 |   200/  269 batches | lr 0.00007 | ms/batch 239.45 | loss  2.98 | ppl    19.74 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 65.93s | valid loss  3.72 | valid ppl    41.44 | valid bpc    5.373
-----------------------------------------------------------------------------------------
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  269 batches | lr 0.00007 | ms/batch 242.38 | loss  2.97 | ppl    19.43 
| epoch  57 |   200/  269 batches | lr 0.00007 | ms/batch 239.60 | loss  2.97 | ppl    19.41 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 65.91s | valid loss  3.77 | valid ppl    43.25 | valid bpc    5.434
-----------------------------------------------------------------------------------------
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  269 batches | lr 0.00007 | ms/batch 241.81 | loss  2.94 | ppl    18.95 
| epoch  58 |   200/  269 batches | lr 0.00007 | ms/batch 239.83 | loss  2.94 | ppl    18.98 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 65.91s | valid loss  3.73 | valid ppl    41.60 | valid bpc    5.379
-----------------------------------------------------------------------------------------
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  269 batches | lr 0.00004 | ms/batch 238.21 | loss  2.95 | ppl    19.16 
| epoch  59 |   200/  269 batches | lr 0.00004 | ms/batch 238.90 | loss  2.90 | ppl    18.13 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 65.53s | valid loss  3.76 | valid ppl    42.80 | valid bpc    5.420
-----------------------------------------------------------------------------------------
PROGRESS: 59.0%
| epoch  60 |   100/  269 batches | lr 0.00004 | ms/batch 239.66 | loss  2.93 | ppl    18.75 
| epoch  60 |   200/  269 batches | lr 0.00004 | ms/batch 239.50 | loss  2.91 | ppl    18.32 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 65.71s | valid loss  3.74 | valid ppl    41.92 | valid bpc    5.390
-----------------------------------------------------------------------------------------
PROGRESS: 60.0%
| epoch  61 |   100/  269 batches | lr 0.00004 | ms/batch 238.92 | loss  2.94 | ppl    18.91 
| epoch  61 |   200/  269 batches | lr 0.00004 | ms/batch 239.94 | loss  2.89 | ppl    17.91 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 65.53s | valid loss  3.74 | valid ppl    42.16 | valid bpc    5.398
-----------------------------------------------------------------------------------------
PROGRESS: 61.0%
| epoch  62 |   100/  269 batches | lr 0.00002 | ms/batch 244.95 | loss  2.89 | ppl    18.03 
| epoch  62 |   200/  269 batches | lr 0.00002 | ms/batch 234.19 | loss  2.88 | ppl    17.76 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 65.61s | valid loss  3.76 | valid ppl    42.75 | valid bpc    5.418
-----------------------------------------------------------------------------------------
PROGRESS: 62.0%
| epoch  63 |   100/  269 batches | lr 0.00002 | ms/batch 247.40 | loss  2.88 | ppl    17.74 
| epoch  63 |   200/  269 batches | lr 0.00002 | ms/batch 233.40 | loss  2.89 | ppl    17.93 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 65.90s | valid loss  3.73 | valid ppl    41.83 | valid bpc    5.386
-----------------------------------------------------------------------------------------
PROGRESS: 63.0%
| epoch  64 |   100/  269 batches | lr 0.00002 | ms/batch 247.70 | loss  2.90 | ppl    18.10 
| epoch  64 |   200/  269 batches | lr 0.00002 | ms/batch 234.69 | loss  2.87 | ppl    17.72 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 65.98s | valid loss  3.70 | valid ppl    40.61 | valid bpc    5.344
-----------------------------------------------------------------------------------------
PROGRESS: 64.0%
| epoch  65 |   100/  269 batches | lr 0.00001 | ms/batch 249.31 | loss  2.87 | ppl    17.61 
| epoch  65 |   200/  269 batches | lr 0.00001 | ms/batch 232.47 | loss  2.86 | ppl    17.54 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 65.95s | valid loss  3.71 | valid ppl    40.66 | valid bpc    5.346
-----------------------------------------------------------------------------------------
PROGRESS: 65.0%
| epoch  66 |   100/  269 batches | lr 0.00001 | ms/batch 247.48 | loss  2.88 | ppl    17.83 
| epoch  66 |   200/  269 batches | lr 0.00001 | ms/batch 233.36 | loss  2.86 | ppl    17.45 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 65.92s | valid loss  3.72 | valid ppl    41.16 | valid bpc    5.363
-----------------------------------------------------------------------------------------
PROGRESS: 66.0%
| epoch  67 |   100/  269 batches | lr 0.00001 | ms/batch 249.41 | loss  2.89 | ppl    17.97 
| epoch  67 |   200/  269 batches | lr 0.00001 | ms/batch 232.90 | loss  2.85 | ppl    17.25 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 65.97s | valid loss  3.69 | valid ppl    40.07 | valid bpc    5.324
-----------------------------------------------------------------------------------------
PROGRESS: 67.0%
| epoch  68 |   100/  269 batches | lr 0.00000 | ms/batch 243.96 | loss  2.88 | ppl    17.75 
| epoch  68 |   200/  269 batches | lr 0.00000 | ms/batch 233.15 | loss  2.84 | ppl    17.16 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 65.40s | valid loss  3.72 | valid ppl    41.26 | valid bpc    5.367
-----------------------------------------------------------------------------------------
PROGRESS: 68.0%
| epoch  69 |   100/  269 batches | lr 0.00000 | ms/batch 247.69 | loss  2.89 | ppl    17.98 
| epoch  69 |   200/  269 batches | lr 0.00000 | ms/batch 233.45 | loss  2.83 | ppl    16.96 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 65.96s | valid loss  3.72 | valid ppl    41.19 | valid bpc    5.364
-----------------------------------------------------------------------------------------
PROGRESS: 69.0%
| epoch  70 |   100/  269 batches | lr 0.00000 | ms/batch 243.83 | loss  2.85 | ppl    17.34 
| epoch  70 |   200/  269 batches | lr 0.00000 | ms/batch 229.96 | loss  2.84 | ppl    17.18 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 65.15s | valid loss  3.73 | valid ppl    41.69 | valid bpc    5.382
-----------------------------------------------------------------------------------------
PROGRESS: 70.0%
| epoch  71 |   100/  269 batches | lr 0.00000 | ms/batch 248.16 | loss  2.89 | ppl    18.06 
| epoch  71 |   200/  269 batches | lr 0.00000 | ms/batch 233.24 | loss  2.84 | ppl    17.05 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 65.91s | valid loss  3.68 | valid ppl    39.76 | valid bpc    5.313
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 71.0%
| epoch  72 |   100/  269 batches | lr 0.00000 | ms/batch 248.55 | loss  2.88 | ppl    17.85 
| epoch  72 |   200/  269 batches | lr 0.00000 | ms/batch 234.35 | loss  2.84 | ppl    17.13 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 65.84s | valid loss  3.68 | valid ppl    39.50 | valid bpc    5.304
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 72.0%
| epoch  73 |   100/  269 batches | lr 0.00000 | ms/batch 254.00 | loss  2.88 | ppl    17.80 
| epoch  73 |   200/  269 batches | lr 0.00000 | ms/batch 233.40 | loss  2.83 | ppl    16.99 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 65.90s | valid loss  3.70 | valid ppl    40.49 | valid bpc    5.340
-----------------------------------------------------------------------------------------
PROGRESS: 73.0%
| epoch  74 |   100/  269 batches | lr 0.00000 | ms/batch 253.02 | loss  2.89 | ppl    18.05 
| epoch  74 |   200/  269 batches | lr 0.00000 | ms/batch 231.67 | loss  2.84 | ppl    17.17 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 65.60s | valid loss  3.72 | valid ppl    41.28 | valid bpc    5.367
-----------------------------------------------------------------------------------------
PROGRESS: 74.0%
| epoch  75 |   100/  269 batches | lr 0.00000 | ms/batch 253.86 | loss  2.87 | ppl    17.68 
| epoch  75 |   200/  269 batches | lr 0.00000 | ms/batch 233.62 | loss  2.86 | ppl    17.46 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 65.99s | valid loss  3.72 | valid ppl    41.10 | valid bpc    5.361
-----------------------------------------------------------------------------------------
PROGRESS: 75.0%
| epoch  76 |   100/  269 batches | lr 0.00000 | ms/batch 254.04 | loss  2.86 | ppl    17.54 
| epoch  76 |   200/  269 batches | lr 0.00000 | ms/batch 234.26 | loss  2.86 | ppl    17.41 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 66.00s | valid loss  3.73 | valid ppl    41.71 | valid bpc    5.382
-----------------------------------------------------------------------------------------
PROGRESS: 76.0%
| epoch  77 |   100/  269 batches | lr 0.00000 | ms/batch 254.36 | loss  2.89 | ppl    17.99 
| epoch  77 |   200/  269 batches | lr 0.00000 | ms/batch 235.19 | loss  2.84 | ppl    17.10 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 65.68s | valid loss  3.70 | valid ppl    40.44 | valid bpc    5.338
-----------------------------------------------------------------------------------------
PROGRESS: 77.0%
| epoch  78 |   100/  269 batches | lr 0.00000 | ms/batch 254.52 | loss  2.87 | ppl    17.65 
| epoch  78 |   200/  269 batches | lr 0.00000 | ms/batch 233.63 | loss  2.84 | ppl    17.14 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 65.86s | valid loss  3.68 | valid ppl    39.54 | valid bpc    5.305
-----------------------------------------------------------------------------------------
PROGRESS: 78.0%
| epoch  79 |   100/  269 batches | lr 0.00000 | ms/batch 255.31 | loss  2.88 | ppl    17.79 
| epoch  79 |   200/  269 batches | lr 0.00000 | ms/batch 233.54 | loss  2.83 | ppl    16.98 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 65.99s | valid loss  3.73 | valid ppl    41.53 | valid bpc    5.376
-----------------------------------------------------------------------------------------
PROGRESS: 79.0%
| epoch  80 |   100/  269 batches | lr 0.00000 | ms/batch 254.16 | loss  2.88 | ppl    17.74 
| epoch  80 |   200/  269 batches | lr 0.00000 | ms/batch 234.22 | loss  2.84 | ppl    17.07 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 66.01s | valid loss  3.73 | valid ppl    41.51 | valid bpc    5.375
-----------------------------------------------------------------------------------------
PROGRESS: 80.0%
| epoch  81 |   100/  269 batches | lr 0.00000 | ms/batch 253.88 | loss  2.87 | ppl    17.67 
| epoch  81 |   200/  269 batches | lr 0.00000 | ms/batch 233.79 | loss  2.83 | ppl    16.92 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 65.90s | valid loss  3.69 | valid ppl    40.24 | valid bpc    5.331
-----------------------------------------------------------------------------------------
PROGRESS: 81.0%
| epoch  82 |   100/  269 batches | lr 0.00000 | ms/batch 256.22 | loss  2.87 | ppl    17.62 
| epoch  82 |   200/  269 batches | lr 0.00000 | ms/batch 232.69 | loss  2.85 | ppl    17.30 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 66.05s | valid loss  3.71 | valid ppl    40.68 | valid bpc    5.346
-----------------------------------------------------------------------------------------
PROGRESS: 82.0%
| epoch  83 |   100/  269 batches | lr 0.00000 | ms/batch 253.46 | loss  2.88 | ppl    17.78 
| epoch  83 |   200/  269 batches | lr 0.00000 | ms/batch 232.91 | loss  2.83 | ppl    16.94 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 65.96s | valid loss  3.70 | valid ppl    40.53 | valid bpc    5.341
-----------------------------------------------------------------------------------------
PROGRESS: 83.0%
| epoch  84 |   100/  269 batches | lr 0.00000 | ms/batch 254.53 | loss  2.86 | ppl    17.50 
| epoch  84 |   200/  269 batches | lr 0.00000 | ms/batch 233.46 | loss  2.85 | ppl    17.36 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 65.89s | valid loss  3.74 | valid ppl    41.97 | valid bpc    5.391
-----------------------------------------------------------------------------------------
PROGRESS: 84.0%
| epoch  85 |   100/  269 batches | lr 0.00000 | ms/batch 254.36 | loss  2.87 | ppl    17.66 
| epoch  85 |   200/  269 batches | lr 0.00000 | ms/batch 233.54 | loss  2.82 | ppl    16.72 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 66.00s | valid loss  3.69 | valid ppl    39.86 | valid bpc    5.317
-----------------------------------------------------------------------------------------
PROGRESS: 85.0%
| epoch  86 |   100/  269 batches | lr 0.00000 | ms/batch 254.74 | loss  2.88 | ppl    17.78 
| epoch  86 |   200/  269 batches | lr 0.00000 | ms/batch 232.64 | loss  2.85 | ppl    17.23 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 65.92s | valid loss  3.71 | valid ppl    41.02 | valid bpc    5.358
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  269 batches | lr 0.00000 | ms/batch 254.00 | loss  2.86 | ppl    17.52 
| epoch  87 |   200/  269 batches | lr 0.00000 | ms/batch 233.19 | loss  2.85 | ppl    17.20 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 65.92s | valid loss  3.73 | valid ppl    41.71 | valid bpc    5.382
-----------------------------------------------------------------------------------------
PROGRESS: 87.0%
| epoch  88 |   100/  269 batches | lr 0.00000 | ms/batch 254.54 | loss  2.87 | ppl    17.69 
| epoch  88 |   200/  269 batches | lr 0.00000 | ms/batch 237.32 | loss  2.86 | ppl    17.47 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 66.00s | valid loss  3.76 | valid ppl    42.78 | valid bpc    5.419
-----------------------------------------------------------------------------------------
PROGRESS: 88.0%
| epoch  89 |   100/  269 batches | lr 0.00000 | ms/batch 253.44 | loss  2.89 | ppl    17.93 
| epoch  89 |   200/  269 batches | lr 0.00000 | ms/batch 239.70 | loss  2.84 | ppl    17.20 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 65.98s | valid loss  3.70 | valid ppl    40.43 | valid bpc    5.337
-----------------------------------------------------------------------------------------
PROGRESS: 89.0%
| epoch  90 |   100/  269 batches | lr 0.00000 | ms/batch 254.36 | loss  2.87 | ppl    17.63 
| epoch  90 |   200/  269 batches | lr 0.00000 | ms/batch 238.94 | loss  2.83 | ppl    16.93 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 65.97s | valid loss  3.74 | valid ppl    42.03 | valid bpc    5.393
-----------------------------------------------------------------------------------------
PROGRESS: 90.0%
| epoch  91 |   100/  269 batches | lr 0.00000 | ms/batch 254.79 | loss  2.88 | ppl    17.75 
| epoch  91 |   200/  269 batches | lr 0.00000 | ms/batch 239.89 | loss  2.85 | ppl    17.25 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 65.98s | valid loss  3.68 | valid ppl    39.53 | valid bpc    5.305
-----------------------------------------------------------------------------------------
PROGRESS: 91.0%
| epoch  92 |   100/  269 batches | lr 0.00000 | ms/batch 254.47 | loss  2.87 | ppl    17.55 
| epoch  92 |   200/  269 batches | lr 0.00000 | ms/batch 238.99 | loss  2.87 | ppl    17.66 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 65.99s | valid loss  3.75 | valid ppl    42.69 | valid bpc    5.416
-----------------------------------------------------------------------------------------
PROGRESS: 92.0%
| epoch  93 |   100/  269 batches | lr 0.00000 | ms/batch 253.58 | loss  2.89 | ppl    17.92 
| epoch  93 |   200/  269 batches | lr 0.00000 | ms/batch 240.16 | loss  2.85 | ppl    17.27 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 65.44s | valid loss  3.71 | valid ppl    40.96 | valid bpc    5.356
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  269 batches | lr 0.00000 | ms/batch 252.95 | loss  2.87 | ppl    17.69 
| epoch  94 |   200/  269 batches | lr 0.00000 | ms/batch 239.89 | loss  2.86 | ppl    17.38 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 63.56s | valid loss  3.75 | valid ppl    42.37 | valid bpc    5.405
-----------------------------------------------------------------------------------------
PROGRESS: 94.0%
| epoch  95 |   100/  269 batches | lr 0.00000 | ms/batch 180.18 | loss  2.87 | ppl    17.72 
| epoch  95 |   200/  269 batches | lr 0.00000 | ms/batch 171.49 | loss  2.83 | ppl    16.94 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 47.30s | valid loss  3.71 | valid ppl    41.04 | valid bpc    5.359
-----------------------------------------------------------------------------------------
PROGRESS: 95.0%
| epoch  96 |   100/  269 batches | lr 0.00000 | ms/batch 176.50 | loss  2.89 | ppl    17.98 
| epoch  96 |   200/  269 batches | lr 0.00000 | ms/batch 160.36 | loss  2.82 | ppl    16.84 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 45.04s | valid loss  3.68 | valid ppl    39.60 | valid bpc    5.308
-----------------------------------------------------------------------------------------
PROGRESS: 96.0%
| epoch  97 |   100/  269 batches | lr 0.00000 | ms/batch 206.27 | loss  2.86 | ppl    17.48 
| epoch  97 |   200/  269 batches | lr 0.00000 | ms/batch 238.93 | loss  2.85 | ppl    17.32 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 61.64s | valid loss  3.69 | valid ppl    40.09 | valid bpc    5.325
-----------------------------------------------------------------------------------------
PROGRESS: 97.0%
| epoch  98 |   100/  269 batches | lr 0.00000 | ms/batch 245.56 | loss  2.86 | ppl    17.49 
| epoch  98 |   200/  269 batches | lr 0.00000 | ms/batch 236.01 | loss  2.84 | ppl    17.13 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 65.57s | valid loss  3.76 | valid ppl    42.86 | valid bpc    5.421
-----------------------------------------------------------------------------------------
PROGRESS: 98.0%
| epoch  99 |   100/  269 batches | lr 0.00000 | ms/batch 243.91 | loss  2.86 | ppl    17.39 
| epoch  99 |   200/  269 batches | lr 0.00000 | ms/batch 236.34 | loss  2.83 | ppl    17.01 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 65.66s | valid loss  3.69 | valid ppl    40.24 | valid bpc    5.331
-----------------------------------------------------------------------------------------
PROGRESS: 99.0%
| epoch 100 |   100/  269 batches | lr 0.00000 | ms/batch 243.80 | loss  2.88 | ppl    17.79 
| epoch 100 |   200/  269 batches | lr 0.00000 | ms/batch 233.60 | loss  2.84 | ppl    17.10 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 65.58s | valid loss  3.67 | valid ppl    39.11 | valid bpc    5.289
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  3.83 | test ppl    45.97 | test bpc    5.523
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.3471, Mean Reca: 0.4885, Mean F1: 0.4023, Mean Subword_Reca: 0.7331
-----------------------------------------------------------------------------------------
=========================================================================================
Loading dataset...
Using subword tokenizer...
Number of tokens:  8000
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer_in_parser', nhid=512, nlayers=8, front_layers=3, rear_layers=5, subword='omarmomen/ptb_filtered_lowcase_bpe_tokenizer_8', n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=2222, nonmono=5, cuda=True, log_interval=100, save='trained_models/subword_structformer_in_parser_2222_35.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 37449108
Model architecture: StructFormer_In_Parser(
  (transformer_front): Transformer_Front(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(8000, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-2): 3 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
  (transformer_rear): Transformer_Rear(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(8000, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-4): 5 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (output_layer): Linear(in_features=512, out_features=8000, bias=True)
  )
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  269 batches | lr 0.00030 | ms/batch 178.97 | loss  7.73 | ppl  2282.98 
| epoch   1 |   200/  269 batches | lr 0.00030 | ms/batch 146.86 | loss  7.36 | ppl  1569.09 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 44.39s | valid loss  7.11 | valid ppl  1228.19 | valid bpc   10.262
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  269 batches | lr 0.00030 | ms/batch 225.80 | loss  7.30 | ppl  1485.90 
| epoch   2 |   200/  269 batches | lr 0.00030 | ms/batch 228.95 | loss  7.17 | ppl  1302.31 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 63.16s | valid loss  6.93 | valid ppl  1020.46 | valid bpc    9.995
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  269 batches | lr 0.00030 | ms/batch 244.95 | loss  7.09 | ppl  1199.53 
| epoch   3 |   200/  269 batches | lr 0.00030 | ms/batch 229.58 | loss  6.81 | ppl   903.40 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 65.15s | valid loss  6.37 | valid ppl   584.76 | valid bpc    9.192
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  269 batches | lr 0.00030 | ms/batch 244.50 | loss  6.51 | ppl   671.10 
| epoch   4 |   200/  269 batches | lr 0.00030 | ms/batch 230.46 | loss  6.22 | ppl   503.86 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 65.25s | valid loss  5.86 | valid ppl   349.59 | valid bpc    8.450
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  269 batches | lr 0.00030 | ms/batch 245.69 | loss  6.03 | ppl   416.27 
| epoch   5 |   200/  269 batches | lr 0.00030 | ms/batch 229.95 | loss  5.88 | ppl   359.34 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 65.21s | valid loss  5.57 | valid ppl   262.38 | valid bpc    8.036
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  269 batches | lr 0.00030 | ms/batch 245.02 | loss  5.77 | ppl   318.94 
| epoch   6 |   200/  269 batches | lr 0.00030 | ms/batch 231.09 | loss  5.62 | ppl   277.10 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 65.24s | valid loss  5.38 | valid ppl   216.45 | valid bpc    7.758
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  269 batches | lr 0.00030 | ms/batch 243.45 | loss  5.55 | ppl   258.27 
| epoch   7 |   200/  269 batches | lr 0.00030 | ms/batch 232.54 | loss  5.48 | ppl   239.77 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 65.20s | valid loss  5.24 | valid ppl   187.81 | valid bpc    7.553
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  269 batches | lr 0.00030 | ms/batch 238.18 | loss  5.41 | ppl   224.54 
| epoch   8 |   200/  269 batches | lr 0.00030 | ms/batch 229.73 | loss  5.34 | ppl   207.68 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 64.56s | valid loss  5.11 | valid ppl   164.85 | valid bpc    7.365
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 8.0%
| epoch   9 |   100/  269 batches | lr 0.00030 | ms/batch 243.92 | loss  5.29 | ppl   197.60 
| epoch   9 |   200/  269 batches | lr 0.00030 | ms/batch 230.26 | loss  5.23 | ppl   186.85 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 65.19s | valid loss  5.04 | valid ppl   154.34 | valid bpc    7.270
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  269 batches | lr 0.00030 | ms/batch 244.27 | loss  5.16 | ppl   174.52 
| epoch  10 |   200/  269 batches | lr 0.00030 | ms/batch 230.00 | loss  5.12 | ppl   167.68 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 65.20s | valid loss  4.91 | valid ppl   135.68 | valid bpc    7.084
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  269 batches | lr 0.00030 | ms/batch 244.59 | loss  5.07 | ppl   158.75 
| epoch  11 |   200/  269 batches | lr 0.00030 | ms/batch 229.32 | loss  4.99 | ppl   147.04 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 65.15s | valid loss  4.82 | valid ppl   123.53 | valid bpc    6.949
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  269 batches | lr 0.00030 | ms/batch 244.01 | loss  4.97 | ppl   144.60 
| epoch  12 |   200/  269 batches | lr 0.00030 | ms/batch 234.11 | loss  4.88 | ppl   131.12 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 65.54s | valid loss  4.70 | valid ppl   109.72 | valid bpc    6.778
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 12.0%
| epoch  13 |   100/  269 batches | lr 0.00030 | ms/batch 240.81 | loss  4.86 | ppl   128.74 
| epoch  13 |   200/  269 batches | lr 0.00030 | ms/batch 234.08 | loss  4.81 | ppl   122.15 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 65.15s | valid loss  4.72 | valid ppl   111.71 | valid bpc    6.804
-----------------------------------------------------------------------------------------
PROGRESS: 13.0%
| epoch  14 |   100/  269 batches | lr 0.00030 | ms/batch 245.54 | loss  4.74 | ppl   114.99 
| epoch  14 |   200/  269 batches | lr 0.00030 | ms/batch 228.83 | loss  4.73 | ppl   113.39 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 65.25s | valid loss  4.62 | valid ppl   101.50 | valid bpc    6.665
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  269 batches | lr 0.00030 | ms/batch 239.87 | loss  4.72 | ppl   111.74 
| epoch  15 |   200/  269 batches | lr 0.00030 | ms/batch 228.35 | loss  4.60 | ppl    99.26 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 64.54s | valid loss  4.55 | valid ppl    94.70 | valid bpc    6.565
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 15.0%
| epoch  16 |   100/  269 batches | lr 0.00030 | ms/batch 244.47 | loss  4.60 | ppl    99.72 
| epoch  16 |   200/  269 batches | lr 0.00030 | ms/batch 229.56 | loss  4.54 | ppl    94.06 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 65.25s | valid loss  4.47 | valid ppl    87.45 | valid bpc    6.450
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 16.0%
| epoch  17 |   100/  269 batches | lr 0.00030 | ms/batch 245.19 | loss  4.51 | ppl    91.04 
| epoch  17 |   200/  269 batches | lr 0.00030 | ms/batch 231.46 | loss  4.46 | ppl    86.65 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 65.13s | valid loss  4.43 | valid ppl    84.24 | valid bpc    6.396
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 17.0%
| epoch  18 |   100/  269 batches | lr 0.00030 | ms/batch 245.82 | loss  4.41 | ppl    82.64 
| epoch  18 |   200/  269 batches | lr 0.00030 | ms/batch 234.52 | loss  4.38 | ppl    80.14 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 65.27s | valid loss  4.38 | valid ppl    79.91 | valid bpc    6.320
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 18.0%
| epoch  19 |   100/  269 batches | lr 0.00030 | ms/batch 244.74 | loss  4.39 | ppl    80.35 
| epoch  19 |   200/  269 batches | lr 0.00030 | ms/batch 238.28 | loss  4.31 | ppl    74.39 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 65.25s | valid loss  4.36 | valid ppl    78.05 | valid bpc    6.286
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 19.0%
| epoch  20 |   100/  269 batches | lr 0.00030 | ms/batch 243.42 | loss  4.34 | ppl    76.34 
| epoch  20 |   200/  269 batches | lr 0.00030 | ms/batch 239.85 | loss  4.26 | ppl    70.92 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 65.15s | valid loss  4.32 | valid ppl    75.48 | valid bpc    6.238
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 20.0%
| epoch  21 |   100/  269 batches | lr 0.00030 | ms/batch 243.02 | loss  4.27 | ppl    71.27 
| epoch  21 |   200/  269 batches | lr 0.00030 | ms/batch 239.16 | loss  4.20 | ppl    66.56 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 65.39s | valid loss  4.25 | valid ppl    70.33 | valid bpc    6.136
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 21.0%
| epoch  22 |   100/  269 batches | lr 0.00030 | ms/batch 241.09 | loss  4.17 | ppl    64.65 
| epoch  22 |   200/  269 batches | lr 0.00030 | ms/batch 240.73 | loss  4.15 | ppl    63.72 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 64.99s | valid loss  4.15 | valid ppl    63.30 | valid bpc    5.984
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 22.0%
| epoch  23 |   100/  269 batches | lr 0.00030 | ms/batch 248.11 | loss  4.12 | ppl    61.71 
| epoch  23 |   200/  269 batches | lr 0.00030 | ms/batch 239.03 | loss  4.08 | ppl    58.94 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 65.76s | valid loss  4.19 | valid ppl    65.85 | valid bpc    6.041
-----------------------------------------------------------------------------------------
PROGRESS: 23.0%
| epoch  24 |   100/  269 batches | lr 0.00030 | ms/batch 242.25 | loss  4.07 | ppl    58.77 
| epoch  24 |   200/  269 batches | lr 0.00030 | ms/batch 240.52 | loss  4.04 | ppl    56.73 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 65.36s | valid loss  4.16 | valid ppl    64.19 | valid bpc    6.004
-----------------------------------------------------------------------------------------
PROGRESS: 24.0%
| epoch  25 |   100/  269 batches | lr 0.00030 | ms/batch 243.05 | loss  4.00 | ppl    54.84 
| epoch  25 |   200/  269 batches | lr 0.00030 | ms/batch 238.84 | loss  3.98 | ppl    53.46 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 65.44s | valid loss  4.13 | valid ppl    61.89 | valid bpc    5.952
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 25.0%
| epoch  26 |   100/  269 batches | lr 0.00030 | ms/batch 243.23 | loss  3.96 | ppl    52.57 
| epoch  26 |   200/  269 batches | lr 0.00030 | ms/batch 240.22 | loss  3.93 | ppl    51.16 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 65.11s | valid loss  4.11 | valid ppl    61.09 | valid bpc    5.933
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 26.0%
| epoch  27 |   100/  269 batches | lr 0.00030 | ms/batch 242.74 | loss  3.90 | ppl    49.57 
| epoch  27 |   200/  269 batches | lr 0.00030 | ms/batch 240.63 | loss  3.88 | ppl    48.20 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 65.07s | valid loss  4.08 | valid ppl    59.41 | valid bpc    5.893
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 27.0%
| epoch  28 |   100/  269 batches | lr 0.00030 | ms/batch 241.97 | loss  3.86 | ppl    47.45 
| epoch  28 |   200/  269 batches | lr 0.00030 | ms/batch 240.43 | loss  3.84 | ppl    46.62 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 65.32s | valid loss  4.02 | valid ppl    55.85 | valid bpc    5.803
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  269 batches | lr 0.00030 | ms/batch 243.52 | loss  3.81 | ppl    45.15 
| epoch  29 |   200/  269 batches | lr 0.00030 | ms/batch 239.74 | loss  3.80 | ppl    44.50 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 65.41s | valid loss  4.00 | valid ppl    54.41 | valid bpc    5.766
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  269 batches | lr 0.00030 | ms/batch 242.51 | loss  3.79 | ppl    44.14 
| epoch  30 |   200/  269 batches | lr 0.00030 | ms/batch 240.44 | loss  3.75 | ppl    42.68 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 65.36s | valid loss  3.98 | valid ppl    53.46 | valid bpc    5.740
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 30.0%
| epoch  31 |   100/  269 batches | lr 0.00030 | ms/batch 247.00 | loss  3.73 | ppl    41.49 
| epoch  31 |   200/  269 batches | lr 0.00030 | ms/batch 239.42 | loss  3.71 | ppl    40.83 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 65.79s | valid loss  3.97 | valid ppl    52.94 | valid bpc    5.726
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 31.0%
| epoch  32 |   100/  269 batches | lr 0.00030 | ms/batch 255.68 | loss  3.70 | ppl    40.32 
| epoch  32 |   200/  269 batches | lr 0.00030 | ms/batch 238.49 | loss  3.68 | ppl    39.82 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 65.29s | valid loss  3.95 | valid ppl    51.92 | valid bpc    5.698
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 32.0%
| epoch  33 |   100/  269 batches | lr 0.00030 | ms/batch 252.83 | loss  3.64 | ppl    38.21 
| epoch  33 |   200/  269 batches | lr 0.00030 | ms/batch 239.96 | loss  3.63 | ppl    37.82 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 65.57s | valid loss  3.93 | valid ppl    50.80 | valid bpc    5.667
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 33.0%
| epoch  34 |   100/  269 batches | lr 0.00030 | ms/batch 253.70 | loss  3.62 | ppl    37.42 
| epoch  34 |   200/  269 batches | lr 0.00030 | ms/batch 239.60 | loss  3.62 | ppl    37.21 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 65.65s | valid loss  3.90 | valid ppl    49.63 | valid bpc    5.633
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 34.0%
| epoch  35 |   100/  269 batches | lr 0.00030 | ms/batch 253.89 | loss  3.58 | ppl    36.03 
| epoch  35 |   200/  269 batches | lr 0.00030 | ms/batch 239.75 | loss  3.56 | ppl    35.10 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 65.93s | valid loss  3.93 | valid ppl    51.11 | valid bpc    5.676
-----------------------------------------------------------------------------------------
PROGRESS: 35.0%
| epoch  36 |   100/  269 batches | lr 0.00030 | ms/batch 254.89 | loss  3.55 | ppl    34.70 
| epoch  36 |   200/  269 batches | lr 0.00030 | ms/batch 238.68 | loss  3.52 | ppl    33.77 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 65.99s | valid loss  3.94 | valid ppl    51.49 | valid bpc    5.686
-----------------------------------------------------------------------------------------
PROGRESS: 36.0%
| epoch  37 |   100/  269 batches | lr 0.00030 | ms/batch 253.74 | loss  3.48 | ppl    32.53 
| epoch  37 |   200/  269 batches | lr 0.00030 | ms/batch 239.81 | loss  3.51 | ppl    33.33 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 65.26s | valid loss  3.89 | valid ppl    48.98 | valid bpc    5.614
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 37.0%
| epoch  38 |   100/  269 batches | lr 0.00030 | ms/batch 253.40 | loss  3.46 | ppl    31.69 
| epoch  38 |   200/  269 batches | lr 0.00030 | ms/batch 240.45 | loss  3.45 | ppl    31.54 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 65.22s | valid loss  3.91 | valid ppl    50.03 | valid bpc    5.645
-----------------------------------------------------------------------------------------
PROGRESS: 38.0%
| epoch  39 |   100/  269 batches | lr 0.00030 | ms/batch 253.96 | loss  3.46 | ppl    31.72 
| epoch  39 |   200/  269 batches | lr 0.00030 | ms/batch 239.96 | loss  3.42 | ppl    30.67 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 65.01s | valid loss  3.89 | valid ppl    48.77 | valid bpc    5.608
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 39.0%
| epoch  40 |   100/  269 batches | lr 0.00030 | ms/batch 253.86 | loss  3.41 | ppl    30.15 
| epoch  40 |   200/  269 batches | lr 0.00030 | ms/batch 239.96 | loss  3.40 | ppl    29.86 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 65.95s | valid loss  3.85 | valid ppl    46.99 | valid bpc    5.554
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 40.0%
| epoch  41 |   100/  269 batches | lr 0.00030 | ms/batch 253.17 | loss  3.35 | ppl    28.62 
| epoch  41 |   200/  269 batches | lr 0.00030 | ms/batch 239.21 | loss  3.36 | ppl    28.87 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 65.53s | valid loss  3.88 | valid ppl    48.61 | valid bpc    5.603
-----------------------------------------------------------------------------------------
PROGRESS: 41.0%
| epoch  42 |   100/  269 batches | lr 0.00030 | ms/batch 254.96 | loss  3.32 | ppl    27.75 
| epoch  42 |   200/  269 batches | lr 0.00030 | ms/batch 239.82 | loss  3.33 | ppl    28.02 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 65.64s | valid loss  3.92 | valid ppl    50.58 | valid bpc    5.661
-----------------------------------------------------------------------------------------
PROGRESS: 42.0%
| epoch  43 |   100/  269 batches | lr 0.00030 | ms/batch 253.98 | loss  3.31 | ppl    27.31 
| epoch  43 |   200/  269 batches | lr 0.00030 | ms/batch 239.32 | loss  3.30 | ppl    27.03 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 65.60s | valid loss  3.85 | valid ppl    46.83 | valid bpc    5.549
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 43.0%
| epoch  44 |   100/  269 batches | lr 0.00030 | ms/batch 253.86 | loss  3.27 | ppl    26.40 
| epoch  44 |   200/  269 batches | lr 0.00030 | ms/batch 239.43 | loss  3.29 | ppl    26.89 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 65.60s | valid loss  3.86 | valid ppl    47.38 | valid bpc    5.566
-----------------------------------------------------------------------------------------
PROGRESS: 44.0%
| epoch  45 |   100/  269 batches | lr 0.00030 | ms/batch 253.75 | loss  3.25 | ppl    25.76 
| epoch  45 |   200/  269 batches | lr 0.00030 | ms/batch 238.95 | loss  3.26 | ppl    26.04 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 65.98s | valid loss  3.81 | valid ppl    45.07 | valid bpc    5.494
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 45.0%
| epoch  46 |   100/  269 batches | lr 0.00030 | ms/batch 255.53 | loss  3.22 | ppl    24.96 
| epoch  46 |   200/  269 batches | lr 0.00030 | ms/batch 238.97 | loss  3.23 | ppl    25.40 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 65.62s | valid loss  3.85 | valid ppl    47.13 | valid bpc    5.559
-----------------------------------------------------------------------------------------
PROGRESS: 46.0%
| epoch  47 |   100/  269 batches | lr 0.00030 | ms/batch 253.82 | loss  3.24 | ppl    25.42 
| epoch  47 |   200/  269 batches | lr 0.00030 | ms/batch 240.28 | loss  3.19 | ppl    24.40 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 65.95s | valid loss  3.86 | valid ppl    47.53 | valid bpc    5.571
-----------------------------------------------------------------------------------------
PROGRESS: 47.0%
| epoch  48 |   100/  269 batches | lr 0.00030 | ms/batch 254.64 | loss  3.19 | ppl    24.22 
| epoch  48 |   200/  269 batches | lr 0.00030 | ms/batch 239.78 | loss  3.18 | ppl    24.03 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 65.86s | valid loss  3.83 | valid ppl    46.27 | valid bpc    5.532
-----------------------------------------------------------------------------------------
PROGRESS: 48.0%
| epoch  49 |   100/  269 batches | lr 0.00015 | ms/batch 253.98 | loss  3.12 | ppl    22.57 
| epoch  49 |   200/  269 batches | lr 0.00015 | ms/batch 240.08 | loss  3.07 | ppl    21.45 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 65.97s | valid loss  3.80 | valid ppl    44.67 | valid bpc    5.481
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 49.0%
| epoch  50 |   100/  269 batches | lr 0.00015 | ms/batch 252.56 | loss  3.03 | ppl    20.77 
| epoch  50 |   200/  269 batches | lr 0.00015 | ms/batch 240.11 | loss  3.03 | ppl    20.78 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 66.10s | valid loss  3.82 | valid ppl    45.68 | valid bpc    5.513
-----------------------------------------------------------------------------------------
PROGRESS: 50.0%
| epoch  51 |   100/  269 batches | lr 0.00015 | ms/batch 251.79 | loss  3.02 | ppl    20.44 
| epoch  51 |   200/  269 batches | lr 0.00015 | ms/batch 238.87 | loss  3.02 | ppl    20.59 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 65.88s | valid loss  3.87 | valid ppl    48.03 | valid bpc    5.586
-----------------------------------------------------------------------------------------
PROGRESS: 51.0%
| epoch  52 |   100/  269 batches | lr 0.00015 | ms/batch 249.45 | loss  2.97 | ppl    19.47 
| epoch  52 |   200/  269 batches | lr 0.00015 | ms/batch 239.04 | loss  2.98 | ppl    19.67 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 66.01s | valid loss  3.80 | valid ppl    44.62 | valid bpc    5.480
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 52.0%
| epoch  53 |   100/  269 batches | lr 0.00015 | ms/batch 250.61 | loss  2.97 | ppl    19.56 
| epoch  53 |   200/  269 batches | lr 0.00015 | ms/batch 240.84 | loss  2.96 | ppl    19.23 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 66.28s | valid loss  3.80 | valid ppl    44.48 | valid bpc    5.475
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 53.0%
| epoch  54 |   100/  269 batches | lr 0.00015 | ms/batch 255.31 | loss  2.96 | ppl    19.28 
| epoch  54 |   200/  269 batches | lr 0.00015 | ms/batch 238.82 | loss  2.92 | ppl    18.62 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 66.17s | valid loss  3.82 | valid ppl    45.83 | valid bpc    5.518
-----------------------------------------------------------------------------------------
PROGRESS: 54.0%
| epoch  55 |   100/  269 batches | lr 0.00015 | ms/batch 252.87 | loss  2.94 | ppl    18.83 
| epoch  55 |   200/  269 batches | lr 0.00015 | ms/batch 239.54 | loss  2.93 | ppl    18.67 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 66.33s | valid loss  3.79 | valid ppl    44.41 | valid bpc    5.473
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  269 batches | lr 0.00015 | ms/batch 253.28 | loss  2.94 | ppl    18.84 
| epoch  56 |   200/  269 batches | lr 0.00015 | ms/batch 233.84 | loss  2.92 | ppl    18.51 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 65.86s | valid loss  3.77 | valid ppl    43.23 | valid bpc    5.434
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  269 batches | lr 0.00015 | ms/batch 253.73 | loss  2.91 | ppl    18.33 
| epoch  57 |   200/  269 batches | lr 0.00015 | ms/batch 231.34 | loss  2.87 | ppl    17.66 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 65.68s | valid loss  3.77 | valid ppl    43.59 | valid bpc    5.446
-----------------------------------------------------------------------------------------
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  269 batches | lr 0.00015 | ms/batch 252.41 | loss  2.87 | ppl    17.61 
| epoch  58 |   200/  269 batches | lr 0.00015 | ms/batch 233.88 | loss  2.87 | ppl    17.57 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 66.26s | valid loss  3.84 | valid ppl    46.72 | valid bpc    5.546
-----------------------------------------------------------------------------------------
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  269 batches | lr 0.00015 | ms/batch 250.53 | loss  2.86 | ppl    17.43 
| epoch  59 |   200/  269 batches | lr 0.00015 | ms/batch 233.02 | loss  2.87 | ppl    17.65 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 66.23s | valid loss  3.79 | valid ppl    44.13 | valid bpc    5.464
-----------------------------------------------------------------------------------------
PROGRESS: 59.0%
| epoch  60 |   100/  269 batches | lr 0.00007 | ms/batch 240.60 | loss  2.83 | ppl    16.87 
| epoch  60 |   200/  269 batches | lr 0.00007 | ms/batch 233.71 | loss  2.81 | ppl    16.59 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 65.27s | valid loss  3.77 | valid ppl    43.43 | valid bpc    5.441
-----------------------------------------------------------------------------------------
PROGRESS: 60.0%
| epoch  61 |   100/  269 batches | lr 0.00007 | ms/batch 248.75 | loss  2.78 | ppl    16.19 
| epoch  61 |   200/  269 batches | lr 0.00007 | ms/batch 233.81 | loss  2.79 | ppl    16.26 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 65.95s | valid loss  3.80 | valid ppl    44.67 | valid bpc    5.481
-----------------------------------------------------------------------------------------
PROGRESS: 61.0%
| epoch  62 |   100/  269 batches | lr 0.00007 | ms/batch 249.32 | loss  2.77 | ppl    15.89 
| epoch  62 |   200/  269 batches | lr 0.00007 | ms/batch 232.77 | loss  2.77 | ppl    16.01 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 65.87s | valid loss  3.80 | valid ppl    44.59 | valid bpc    5.479
-----------------------------------------------------------------------------------------
PROGRESS: 62.0%
| epoch  63 |   100/  269 batches | lr 0.00004 | ms/batch 248.20 | loss  2.76 | ppl    15.84 
| epoch  63 |   200/  269 batches | lr 0.00004 | ms/batch 232.21 | loss  2.73 | ppl    15.39 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 65.85s | valid loss  3.84 | valid ppl    46.37 | valid bpc    5.535
-----------------------------------------------------------------------------------------
PROGRESS: 63.0%
| epoch  64 |   100/  269 batches | lr 0.00004 | ms/batch 248.33 | loss  2.72 | ppl    15.25 
| epoch  64 |   200/  269 batches | lr 0.00004 | ms/batch 233.45 | loss  2.73 | ppl    15.32 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 65.94s | valid loss  3.75 | valid ppl    42.62 | valid bpc    5.413
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 64.0%
| epoch  65 |   100/  269 batches | lr 0.00004 | ms/batch 247.30 | loss  2.74 | ppl    15.53 
| epoch  65 |   200/  269 batches | lr 0.00004 | ms/batch 234.89 | loss  2.71 | ppl    14.98 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 65.87s | valid loss  3.80 | valid ppl    44.70 | valid bpc    5.482
-----------------------------------------------------------------------------------------
PROGRESS: 65.0%
| epoch  66 |   100/  269 batches | lr 0.00004 | ms/batch 247.94 | loss  2.72 | ppl    15.23 
| epoch  66 |   200/  269 batches | lr 0.00004 | ms/batch 232.87 | loss  2.71 | ppl    15.03 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 66.00s | valid loss  3.78 | valid ppl    43.77 | valid bpc    5.452
-----------------------------------------------------------------------------------------
PROGRESS: 66.0%
| epoch  67 |   100/  269 batches | lr 0.00004 | ms/batch 248.73 | loss  2.75 | ppl    15.72 
| epoch  67 |   200/  269 batches | lr 0.00004 | ms/batch 233.66 | loss  2.67 | ppl    14.40 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 65.97s | valid loss  3.80 | valid ppl    44.81 | valid bpc    5.486
-----------------------------------------------------------------------------------------
PROGRESS: 67.0%
| epoch  68 |   100/  269 batches | lr 0.00002 | ms/batch 247.64 | loss  2.71 | ppl    15.00 
| epoch  68 |   200/  269 batches | lr 0.00002 | ms/batch 230.88 | loss  2.67 | ppl    14.45 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 65.57s | valid loss  3.68 | valid ppl    39.79 | valid bpc    5.314
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 68.0%
| epoch  69 |   100/  269 batches | lr 0.00002 | ms/batch 248.92 | loss  2.70 | ppl    14.82 
| epoch  69 |   200/  269 batches | lr 0.00002 | ms/batch 228.85 | loss  2.69 | ppl    14.68 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 65.62s | valid loss  3.84 | valid ppl    46.30 | valid bpc    5.533
-----------------------------------------------------------------------------------------
PROGRESS: 69.0%
| epoch  70 |   100/  269 batches | lr 0.00002 | ms/batch 249.05 | loss  2.70 | ppl    14.85 
| epoch  70 |   200/  269 batches | lr 0.00002 | ms/batch 233.88 | loss  2.67 | ppl    14.48 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 66.00s | valid loss  3.75 | valid ppl    42.56 | valid bpc    5.411
-----------------------------------------------------------------------------------------
PROGRESS: 70.0%
| epoch  71 |   100/  269 batches | lr 0.00002 | ms/batch 248.16 | loss  2.69 | ppl    14.67 
| epoch  71 |   200/  269 batches | lr 0.00002 | ms/batch 233.89 | loss  2.66 | ppl    14.26 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 65.94s | valid loss  3.76 | valid ppl    42.86 | valid bpc    5.422
-----------------------------------------------------------------------------------------
PROGRESS: 71.0%
| epoch  72 |   100/  269 batches | lr 0.00001 | ms/batch 247.59 | loss  2.68 | ppl    14.54 
| epoch  72 |   200/  269 batches | lr 0.00001 | ms/batch 234.63 | loss  2.66 | ppl    14.31 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 66.01s | valid loss  3.74 | valid ppl    42.04 | valid bpc    5.394
-----------------------------------------------------------------------------------------
PROGRESS: 72.0%
| epoch  73 |   100/  269 batches | lr 0.00001 | ms/batch 247.13 | loss  2.68 | ppl    14.62 
| epoch  73 |   200/  269 batches | lr 0.00001 | ms/batch 233.97 | loss  2.67 | ppl    14.39 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 65.85s | valid loss  3.78 | valid ppl    43.78 | valid bpc    5.452
-----------------------------------------------------------------------------------------
PROGRESS: 73.0%
| epoch  74 |   100/  269 batches | lr 0.00001 | ms/batch 248.50 | loss  2.67 | ppl    14.46 
| epoch  74 |   200/  269 batches | lr 0.00001 | ms/batch 234.35 | loss  2.64 | ppl    14.06 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 66.00s | valid loss  3.76 | valid ppl    42.86 | valid bpc    5.421
-----------------------------------------------------------------------------------------
PROGRESS: 74.0%
| epoch  75 |   100/  269 batches | lr 0.00000 | ms/batch 248.59 | loss  2.68 | ppl    14.59 
| epoch  75 |   200/  269 batches | lr 0.00000 | ms/batch 233.81 | loss  2.66 | ppl    14.27 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 65.92s | valid loss  3.76 | valid ppl    42.96 | valid bpc    5.425
-----------------------------------------------------------------------------------------
PROGRESS: 75.0%
| epoch  76 |   100/  269 batches | lr 0.00000 | ms/batch 249.96 | loss  2.68 | ppl    14.53 
| epoch  76 |   200/  269 batches | lr 0.00000 | ms/batch 233.61 | loss  2.66 | ppl    14.30 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 65.93s | valid loss  3.82 | valid ppl    45.47 | valid bpc    5.507
-----------------------------------------------------------------------------------------
PROGRESS: 76.0%
| epoch  77 |   100/  269 batches | lr 0.00000 | ms/batch 247.22 | loss  2.69 | ppl    14.68 
| epoch  77 |   200/  269 batches | lr 0.00000 | ms/batch 234.07 | loss  2.65 | ppl    14.19 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 65.90s | valid loss  3.78 | valid ppl    43.89 | valid bpc    5.456
-----------------------------------------------------------------------------------------
PROGRESS: 77.0%
| epoch  78 |   100/  269 batches | lr 0.00000 | ms/batch 248.55 | loss  2.67 | ppl    14.51 
| epoch  78 |   200/  269 batches | lr 0.00000 | ms/batch 235.15 | loss  2.63 | ppl    13.91 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 65.98s | valid loss  3.74 | valid ppl    42.21 | valid bpc    5.400
-----------------------------------------------------------------------------------------
PROGRESS: 78.0%
| epoch  79 |   100/  269 batches | lr 0.00000 | ms/batch 247.16 | loss  2.67 | ppl    14.42 
| epoch  79 |   200/  269 batches | lr 0.00000 | ms/batch 234.24 | loss  2.64 | ppl    14.00 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 65.87s | valid loss  3.73 | valid ppl    41.85 | valid bpc    5.387
-----------------------------------------------------------------------------------------
PROGRESS: 79.0%
| epoch  80 |   100/  269 batches | lr 0.00000 | ms/batch 247.51 | loss  2.68 | ppl    14.52 
| epoch  80 |   200/  269 batches | lr 0.00000 | ms/batch 235.21 | loss  2.64 | ppl    14.08 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 65.97s | valid loss  3.78 | valid ppl    43.83 | valid bpc    5.454
-----------------------------------------------------------------------------------------
PROGRESS: 80.0%
| epoch  81 |   100/  269 batches | lr 0.00000 | ms/batch 246.76 | loss  2.67 | ppl    14.50 
| epoch  81 |   200/  269 batches | lr 0.00000 | ms/batch 234.16 | loss  2.63 | ppl    13.86 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 65.97s | valid loss  3.78 | valid ppl    43.81 | valid bpc    5.453
-----------------------------------------------------------------------------------------
PROGRESS: 81.0%
| epoch  82 |   100/  269 batches | lr 0.00000 | ms/batch 247.83 | loss  2.67 | ppl    14.50 
| epoch  82 |   200/  269 batches | lr 0.00000 | ms/batch 234.95 | loss  2.64 | ppl    13.97 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 66.00s | valid loss  3.77 | valid ppl    43.44 | valid bpc    5.441
-----------------------------------------------------------------------------------------
PROGRESS: 82.0%
| epoch  83 |   100/  269 batches | lr 0.00000 | ms/batch 248.14 | loss  2.66 | ppl    14.30 
| epoch  83 |   200/  269 batches | lr 0.00000 | ms/batch 233.28 | loss  2.64 | ppl    14.04 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 65.92s | valid loss  3.75 | valid ppl    42.37 | valid bpc    5.405
-----------------------------------------------------------------------------------------
PROGRESS: 83.0%
| epoch  84 |   100/  269 batches | lr 0.00000 | ms/batch 247.38 | loss  2.67 | ppl    14.41 
| epoch  84 |   200/  269 batches | lr 0.00000 | ms/batch 234.80 | loss  2.66 | ppl    14.24 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 65.90s | valid loss  3.78 | valid ppl    43.63 | valid bpc    5.447
-----------------------------------------------------------------------------------------
PROGRESS: 84.0%
| epoch  85 |   100/  269 batches | lr 0.00000 | ms/batch 247.43 | loss  2.69 | ppl    14.70 
| epoch  85 |   200/  269 batches | lr 0.00000 | ms/batch 233.78 | loss  2.63 | ppl    13.84 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 65.87s | valid loss  3.78 | valid ppl    43.64 | valid bpc    5.447
-----------------------------------------------------------------------------------------
PROGRESS: 85.0%
| epoch  86 |   100/  269 batches | lr 0.00000 | ms/batch 249.07 | loss  2.66 | ppl    14.28 
| epoch  86 |   200/  269 batches | lr 0.00000 | ms/batch 233.11 | loss  2.65 | ppl    14.13 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 65.98s | valid loss  3.72 | valid ppl    41.43 | valid bpc    5.373
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  269 batches | lr 0.00000 | ms/batch 249.81 | loss  2.68 | ppl    14.52 
| epoch  87 |   200/  269 batches | lr 0.00000 | ms/batch 233.44 | loss  2.64 | ppl    14.06 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 65.94s | valid loss  3.77 | valid ppl    43.33 | valid bpc    5.437
-----------------------------------------------------------------------------------------
PROGRESS: 87.0%
| epoch  88 |   100/  269 batches | lr 0.00000 | ms/batch 252.49 | loss  2.70 | ppl    14.85 
| epoch  88 |   200/  269 batches | lr 0.00000 | ms/batch 229.28 | loss  2.64 | ppl    13.99 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 65.88s | valid loss  3.75 | valid ppl    42.71 | valid bpc    5.417
-----------------------------------------------------------------------------------------
PROGRESS: 88.0%
| epoch  89 |   100/  269 batches | lr 0.00000 | ms/batch 254.05 | loss  2.68 | ppl    14.61 
| epoch  89 |   200/  269 batches | lr 0.00000 | ms/batch 228.63 | loss  2.64 | ppl    14.05 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 65.96s | valid loss  3.77 | valid ppl    43.53 | valid bpc    5.444
-----------------------------------------------------------------------------------------
PROGRESS: 89.0%
| epoch  90 |   100/  269 batches | lr 0.00000 | ms/batch 252.72 | loss  2.67 | ppl    14.49 
| epoch  90 |   200/  269 batches | lr 0.00000 | ms/batch 227.59 | loss  2.66 | ppl    14.32 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 65.89s | valid loss  3.77 | valid ppl    43.19 | valid bpc    5.433
-----------------------------------------------------------------------------------------
PROGRESS: 90.0%
| epoch  91 |   100/  269 batches | lr 0.00000 | ms/batch 253.27 | loss  2.68 | ppl    14.58 
| epoch  91 |   200/  269 batches | lr 0.00000 | ms/batch 224.80 | loss  2.65 | ppl    14.09 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 65.61s | valid loss  3.79 | valid ppl    44.41 | valid bpc    5.473
-----------------------------------------------------------------------------------------
PROGRESS: 91.0%
| epoch  92 |   100/  269 batches | lr 0.00000 | ms/batch 253.47 | loss  2.65 | ppl    14.10 
| epoch  92 |   200/  269 batches | lr 0.00000 | ms/batch 226.99 | loss  2.66 | ppl    14.29 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 65.87s | valid loss  3.79 | valid ppl    44.38 | valid bpc    5.472
-----------------------------------------------------------------------------------------
PROGRESS: 92.0%
| epoch  93 |   100/  269 batches | lr 0.00000 | ms/batch 254.04 | loss  2.67 | ppl    14.50 
| epoch  93 |   200/  269 batches | lr 0.00000 | ms/batch 228.51 | loss  2.65 | ppl    14.11 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 66.00s | valid loss  3.78 | valid ppl    43.69 | valid bpc    5.449
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  269 batches | lr 0.00000 | ms/batch 254.26 | loss  2.67 | ppl    14.37 
| epoch  94 |   200/  269 batches | lr 0.00000 | ms/batch 228.50 | loss  2.66 | ppl    14.30 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 66.01s | valid loss  3.77 | valid ppl    43.47 | valid bpc    5.442
-----------------------------------------------------------------------------------------
PROGRESS: 94.0%
| epoch  95 |   100/  269 batches | lr 0.00000 | ms/batch 253.06 | loss  2.67 | ppl    14.50 
| epoch  95 |   200/  269 batches | lr 0.00000 | ms/batch 186.56 | loss  2.65 | ppl    14.10 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 56.70s | valid loss  3.78 | valid ppl    43.94 | valid bpc    5.457
-----------------------------------------------------------------------------------------
PROGRESS: 95.0%
| epoch  96 |   100/  269 batches | lr 0.00000 | ms/batch 176.57 | loss  2.67 | ppl    14.39 
| epoch  96 |   200/  269 batches | lr 0.00000 | ms/batch 169.29 | loss  2.64 | ppl    13.96 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 46.91s | valid loss  3.77 | valid ppl    43.19 | valid bpc    5.433
-----------------------------------------------------------------------------------------
PROGRESS: 96.0%
| epoch  97 |   100/  269 batches | lr 0.00000 | ms/batch 162.29 | loss  2.67 | ppl    14.43 
| epoch  97 |   200/  269 batches | lr 0.00000 | ms/batch 160.61 | loss  2.62 | ppl    13.69 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 45.28s | valid loss  3.76 | valid ppl    42.79 | valid bpc    5.419
-----------------------------------------------------------------------------------------
PROGRESS: 97.0%
| epoch  98 |   100/  269 batches | lr 0.00000 | ms/batch 247.05 | loss  2.65 | ppl    14.19 
| epoch  98 |   200/  269 batches | lr 0.00000 | ms/batch 239.13 | loss  2.64 | ppl    14.06 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 65.59s | valid loss  3.76 | valid ppl    42.94 | valid bpc    5.424
-----------------------------------------------------------------------------------------
PROGRESS: 98.0%
| epoch  99 |   100/  269 batches | lr 0.00000 | ms/batch 243.57 | loss  2.66 | ppl    14.32 
| epoch  99 |   200/  269 batches | lr 0.00000 | ms/batch 240.01 | loss  2.65 | ppl    14.17 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 65.33s | valid loss  3.75 | valid ppl    42.48 | valid bpc    5.409
-----------------------------------------------------------------------------------------
PROGRESS: 99.0%
| epoch 100 |   100/  269 batches | lr 0.00000 | ms/batch 249.07 | loss  2.66 | ppl    14.35 
| epoch 100 |   200/  269 batches | lr 0.00000 | ms/batch 238.92 | loss  2.68 | ppl    14.53 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 66.39s | valid loss  3.72 | valid ppl    41.41 | valid bpc    5.372
-----------------------------------------------------------------------------------------
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  3.84 | test ppl    46.66 | test bpc    5.544
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.4566, Mean Reca: 0.6405, Mean F1: 0.5291, Mean Subword_Reca: 0.7704
-----------------------------------------------------------------------------------------
=========================================================================================
Loading dataset...
Using subword tokenizer...
Number of tokens:  8000
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer_in_parser', nhid=512, nlayers=8, front_layers=3, rear_layers=5, subword='omarmomen/ptb_filtered_lowcase_bpe_tokenizer_8', n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=3333, nonmono=5, cuda=True, log_interval=100, save='trained_models/subword_structformer_in_parser_3333_35.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 37449108
Model architecture: StructFormer_In_Parser(
  (transformer_front): Transformer_Front(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(8000, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-2): 3 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
  (transformer_rear): Transformer_Rear(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(8000, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-4): 5 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (output_layer): Linear(in_features=512, out_features=8000, bias=True)
  )
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  269 batches | lr 0.00030 | ms/batch 206.02 | loss  7.74 | ppl  2298.55 
| epoch   1 |   200/  269 batches | lr 0.00030 | ms/batch 239.29 | loss  7.37 | ppl  1581.99 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 61.11s | valid loss  7.09 | valid ppl  1197.79 | valid bpc   10.226
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  269 batches | lr 0.00030 | ms/batch 244.81 | loss  7.29 | ppl  1459.71 
| epoch   2 |   200/  269 batches | lr 0.00030 | ms/batch 240.53 | loss  7.17 | ppl  1305.27 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 65.31s | valid loss  6.93 | valid ppl  1021.19 | valid bpc    9.996
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  269 batches | lr 0.00030 | ms/batch 246.41 | loss  7.05 | ppl  1154.71 
| epoch   3 |   200/  269 batches | lr 0.00030 | ms/batch 239.57 | loss  6.72 | ppl   827.59 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 65.37s | valid loss  6.25 | valid ppl   517.28 | valid bpc    9.015
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  269 batches | lr 0.00030 | ms/batch 244.79 | loss  6.37 | ppl   581.89 
| epoch   4 |   200/  269 batches | lr 0.00030 | ms/batch 240.54 | loss  6.15 | ppl   467.58 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 65.48s | valid loss  5.79 | valid ppl   327.98 | valid bpc    8.357
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  269 batches | lr 0.00030 | ms/batch 244.37 | loss  5.97 | ppl   390.00 
| epoch   5 |   200/  269 batches | lr 0.00030 | ms/batch 240.81 | loss  5.83 | ppl   339.41 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 65.41s | valid loss  5.55 | valid ppl   257.83 | valid bpc    8.010
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  269 batches | lr 0.00030 | ms/batch 244.66 | loss  5.73 | ppl   307.00 
| epoch   6 |   200/  269 batches | lr 0.00030 | ms/batch 240.12 | loss  5.65 | ppl   283.17 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 65.30s | valid loss  5.41 | valid ppl   222.85 | valid bpc    7.800
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  269 batches | lr 0.00030 | ms/batch 246.51 | loss  5.58 | ppl   264.65 
| epoch   7 |   200/  269 batches | lr 0.00030 | ms/batch 239.97 | loss  5.46 | ppl   235.39 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 65.39s | valid loss  5.24 | valid ppl   189.03 | valid bpc    7.562
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  269 batches | lr 0.00030 | ms/batch 245.44 | loss  5.38 | ppl   217.68 
| epoch   8 |   200/  269 batches | lr 0.00030 | ms/batch 239.15 | loss  5.33 | ppl   205.92 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 65.34s | valid loss  5.12 | valid ppl   167.87 | valid bpc    7.391
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 8.0%
| epoch   9 |   100/  269 batches | lr 0.00030 | ms/batch 245.04 | loss  5.30 | ppl   199.49 
| epoch   9 |   200/  269 batches | lr 0.00030 | ms/batch 239.99 | loss  5.23 | ppl   185.98 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 65.33s | valid loss  4.99 | valid ppl   147.61 | valid bpc    7.206
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  269 batches | lr 0.00030 | ms/batch 245.03 | loss  5.17 | ppl   175.99 
| epoch  10 |   200/  269 batches | lr 0.00030 | ms/batch 239.95 | loss  5.08 | ppl   161.31 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 65.40s | valid loss  4.98 | valid ppl   145.05 | valid bpc    7.180
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  269 batches | lr 0.00030 | ms/batch 243.86 | loss  5.05 | ppl   156.02 
| epoch  11 |   200/  269 batches | lr 0.00030 | ms/batch 240.29 | loss  5.00 | ppl   148.34 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 65.32s | valid loss  4.82 | valid ppl   123.96 | valid bpc    6.954
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  269 batches | lr 0.00030 | ms/batch 244.13 | loss  4.96 | ppl   142.74 
| epoch  12 |   200/  269 batches | lr 0.00030 | ms/batch 241.06 | loss  4.91 | ppl   135.80 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 65.34s | valid loss  4.77 | valid ppl   118.27 | valid bpc    6.886
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 12.0%
| epoch  13 |   100/  269 batches | lr 0.00030 | ms/batch 244.46 | loss  4.89 | ppl   133.48 
| epoch  13 |   200/  269 batches | lr 0.00030 | ms/batch 239.97 | loss  4.79 | ppl   120.34 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 65.68s | valid loss  4.68 | valid ppl   107.49 | valid bpc    6.748
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 13.0%
| epoch  14 |   100/  269 batches | lr 0.00030 | ms/batch 246.47 | loss  4.81 | ppl   123.28 
| epoch  14 |   200/  269 batches | lr 0.00030 | ms/batch 239.57 | loss  4.72 | ppl   112.45 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 65.35s | valid loss  4.61 | valid ppl   100.27 | valid bpc    6.648
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  269 batches | lr 0.00030 | ms/batch 245.79 | loss  4.71 | ppl   110.73 
| epoch  15 |   200/  269 batches | lr 0.00030 | ms/batch 239.01 | loss  4.64 | ppl   103.97 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 65.38s | valid loss  4.56 | valid ppl    95.71 | valid bpc    6.581
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 15.0%
| epoch  16 |   100/  269 batches | lr 0.00030 | ms/batch 246.32 | loss  4.62 | ppl   101.65 
| epoch  16 |   200/  269 batches | lr 0.00030 | ms/batch 239.65 | loss  4.57 | ppl    96.24 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 65.49s | valid loss  4.48 | valid ppl    88.39 | valid bpc    6.466
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 16.0%
| epoch  17 |   100/  269 batches | lr 0.00030 | ms/batch 245.89 | loss  4.55 | ppl    94.35 
| epoch  17 |   200/  269 batches | lr 0.00030 | ms/batch 238.28 | loss  4.47 | ppl    86.97 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 65.40s | valid loss  4.42 | valid ppl    82.79 | valid bpc    6.371
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 17.0%
| epoch  18 |   100/  269 batches | lr 0.00030 | ms/batch 245.19 | loss  4.47 | ppl    87.53 
| epoch  18 |   200/  269 batches | lr 0.00030 | ms/batch 240.23 | loss  4.41 | ppl    82.32 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 65.70s | valid loss  4.32 | valid ppl    75.04 | valid bpc    6.230
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 18.0%
| epoch  19 |   100/  269 batches | lr 0.00030 | ms/batch 243.76 | loss  4.38 | ppl    80.21 
| epoch  19 |   200/  269 batches | lr 0.00030 | ms/batch 240.76 | loss  4.35 | ppl    77.57 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 65.55s | valid loss  4.29 | valid ppl    72.72 | valid bpc    6.184
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 19.0%
| epoch  20 |   100/  269 batches | lr 0.00030 | ms/batch 243.04 | loss  4.31 | ppl    74.79 
| epoch  20 |   200/  269 batches | lr 0.00030 | ms/batch 239.56 | loss  4.30 | ppl    73.60 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 65.50s | valid loss  4.26 | valid ppl    71.09 | valid bpc    6.152
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 20.0%
| epoch  21 |   100/  269 batches | lr 0.00030 | ms/batch 242.87 | loss  4.26 | ppl    70.68 
| epoch  21 |   200/  269 batches | lr 0.00030 | ms/batch 240.73 | loss  4.23 | ppl    68.56 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 65.62s | valid loss  4.24 | valid ppl    69.17 | valid bpc    6.112
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 21.0%
| epoch  22 |   100/  269 batches | lr 0.00030 | ms/batch 243.19 | loss  4.22 | ppl    67.88 
| epoch  22 |   200/  269 batches | lr 0.00030 | ms/batch 238.73 | loss  4.14 | ppl    62.73 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 65.40s | valid loss  4.21 | valid ppl    67.67 | valid bpc    6.080
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 22.0%
| epoch  23 |   100/  269 batches | lr 0.00030 | ms/batch 247.51 | loss  4.12 | ppl    61.61 
| epoch  23 |   200/  269 batches | lr 0.00030 | ms/batch 240.76 | loss  4.11 | ppl    61.18 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 66.02s | valid loss  4.17 | valid ppl    64.85 | valid bpc    6.019
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 23.0%
| epoch  24 |   100/  269 batches | lr 0.00030 | ms/batch 249.24 | loss  4.09 | ppl    59.97 
| epoch  24 |   200/  269 batches | lr 0.00030 | ms/batch 240.87 | loss  4.06 | ppl    57.70 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 65.92s | valid loss  4.16 | valid ppl    64.11 | valid bpc    6.003
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 24.0%
| epoch  25 |   100/  269 batches | lr 0.00030 | ms/batch 252.75 | loss  4.02 | ppl    55.59 
| epoch  25 |   200/  269 batches | lr 0.00030 | ms/batch 241.35 | loss  3.99 | ppl    54.25 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 65.85s | valid loss  4.15 | valid ppl    63.26 | valid bpc    5.983
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 25.0%
| epoch  26 |   100/  269 batches | lr 0.00030 | ms/batch 254.36 | loss  3.99 | ppl    53.94 
| epoch  26 |   200/  269 batches | lr 0.00030 | ms/batch 240.98 | loss  3.96 | ppl    52.38 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 65.82s | valid loss  4.12 | valid ppl    61.71 | valid bpc    5.948
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 26.0%
| epoch  27 |   100/  269 batches | lr 0.00030 | ms/batch 254.42 | loss  3.93 | ppl    50.76 
| epoch  27 |   200/  269 batches | lr 0.00030 | ms/batch 240.97 | loss  3.89 | ppl    49.15 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 65.65s | valid loss  4.09 | valid ppl    59.55 | valid bpc    5.896
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 27.0%
| epoch  28 |   100/  269 batches | lr 0.00030 | ms/batch 253.30 | loss  3.87 | ppl    48.11 
| epoch  28 |   200/  269 batches | lr 0.00030 | ms/batch 240.67 | loss  3.87 | ppl    47.89 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 65.52s | valid loss  4.05 | valid ppl    57.51 | valid bpc    5.846
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  269 batches | lr 0.00030 | ms/batch 254.45 | loss  3.83 | ppl    46.09 
| epoch  29 |   200/  269 batches | lr 0.00030 | ms/batch 239.82 | loss  3.81 | ppl    44.94 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 65.75s | valid loss  3.99 | valid ppl    54.01 | valid bpc    5.755
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  269 batches | lr 0.00030 | ms/batch 254.74 | loss  3.79 | ppl    44.44 
| epoch  30 |   200/  269 batches | lr 0.00030 | ms/batch 239.34 | loss  3.77 | ppl    43.59 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 66.05s | valid loss  4.05 | valid ppl    57.42 | valid bpc    5.843
-----------------------------------------------------------------------------------------
PROGRESS: 30.0%
| epoch  31 |   100/  269 batches | lr 0.00030 | ms/batch 251.69 | loss  3.76 | ppl    42.98 
| epoch  31 |   200/  269 batches | lr 0.00030 | ms/batch 240.96 | loss  3.70 | ppl    40.64 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 65.94s | valid loss  3.99 | valid ppl    54.15 | valid bpc    5.759
-----------------------------------------------------------------------------------------
PROGRESS: 31.0%
| epoch  32 |   100/  269 batches | lr 0.00030 | ms/batch 249.88 | loss  3.69 | ppl    39.96 
| epoch  32 |   200/  269 batches | lr 0.00030 | ms/batch 239.53 | loss  3.69 | ppl    40.18 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 66.10s | valid loss  3.94 | valid ppl    51.46 | valid bpc    5.685
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 32.0%
| epoch  33 |   100/  269 batches | lr 0.00030 | ms/batch 250.92 | loss  3.68 | ppl    39.76 
| epoch  33 |   200/  269 batches | lr 0.00030 | ms/batch 239.61 | loss  3.64 | ppl    38.02 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 66.25s | valid loss  3.97 | valid ppl    52.85 | valid bpc    5.724
-----------------------------------------------------------------------------------------
PROGRESS: 33.0%
| epoch  34 |   100/  269 batches | lr 0.00030 | ms/batch 250.45 | loss  3.65 | ppl    38.30 
| epoch  34 |   200/  269 batches | lr 0.00030 | ms/batch 239.82 | loss  3.58 | ppl    35.95 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 66.13s | valid loss  3.97 | valid ppl    53.06 | valid bpc    5.729
-----------------------------------------------------------------------------------------
PROGRESS: 34.0%
| epoch  35 |   100/  269 batches | lr 0.00030 | ms/batch 247.02 | loss  3.57 | ppl    35.56 
| epoch  35 |   200/  269 batches | lr 0.00030 | ms/batch 240.06 | loss  3.58 | ppl    35.94 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 65.61s | valid loss  3.95 | valid ppl    51.75 | valid bpc    5.693
-----------------------------------------------------------------------------------------
PROGRESS: 35.0%
| epoch  36 |   100/  269 batches | lr 0.00015 | ms/batch 248.81 | loss  3.52 | ppl    33.72 
| epoch  36 |   200/  269 batches | lr 0.00015 | ms/batch 239.58 | loss  3.45 | ppl    31.44 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 66.01s | valid loss  3.85 | valid ppl    47.07 | valid bpc    5.557
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 36.0%
| epoch  37 |   100/  269 batches | lr 0.00015 | ms/batch 245.33 | loss  3.44 | ppl    31.25 
| epoch  37 |   200/  269 batches | lr 0.00015 | ms/batch 239.87 | loss  3.42 | ppl    30.44 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 65.34s | valid loss  3.84 | valid ppl    46.41 | valid bpc    5.536
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 37.0%
| epoch  38 |   100/  269 batches | lr 0.00015 | ms/batch 248.62 | loss  3.44 | ppl    31.13 
| epoch  38 |   200/  269 batches | lr 0.00015 | ms/batch 240.60 | loss  3.39 | ppl    29.54 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 65.80s | valid loss  3.82 | valid ppl    45.83 | valid bpc    5.518
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 38.0%
| epoch  39 |   100/  269 batches | lr 0.00015 | ms/batch 249.20 | loss  3.38 | ppl    29.40 
| epoch  39 |   200/  269 batches | lr 0.00015 | ms/batch 239.48 | loss  3.38 | ppl    29.51 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 66.10s | valid loss  3.89 | valid ppl    48.92 | valid bpc    5.612
-----------------------------------------------------------------------------------------
PROGRESS: 39.0%
| epoch  40 |   100/  269 batches | lr 0.00015 | ms/batch 249.85 | loss  3.35 | ppl    28.39 
| epoch  40 |   200/  269 batches | lr 0.00015 | ms/batch 240.11 | loss  3.32 | ppl    27.60 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 66.14s | valid loss  3.83 | valid ppl    46.24 | valid bpc    5.531
-----------------------------------------------------------------------------------------
PROGRESS: 40.0%
| epoch  41 |   100/  269 batches | lr 0.00015 | ms/batch 249.68 | loss  3.34 | ppl    28.14 
| epoch  41 |   200/  269 batches | lr 0.00015 | ms/batch 239.81 | loss  3.31 | ppl    27.27 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 66.09s | valid loss  3.89 | valid ppl    48.76 | valid bpc    5.607
-----------------------------------------------------------------------------------------
PROGRESS: 41.0%
| epoch  42 |   100/  269 batches | lr 0.00007 | ms/batch 249.27 | loss  3.28 | ppl    26.70 
| epoch  42 |   200/  269 batches | lr 0.00007 | ms/batch 240.48 | loss  3.25 | ppl    25.72 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 65.68s | valid loss  3.77 | valid ppl    43.53 | valid bpc    5.444
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 42.0%
| epoch  43 |   100/  269 batches | lr 0.00007 | ms/batch 247.96 | loss  3.27 | ppl    26.22 
| epoch  43 |   200/  269 batches | lr 0.00007 | ms/batch 240.32 | loss  3.23 | ppl    25.29 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 66.04s | valid loss  3.82 | valid ppl    45.67 | valid bpc    5.513
-----------------------------------------------------------------------------------------
PROGRESS: 43.0%
| epoch  44 |   100/  269 batches | lr 0.00007 | ms/batch 247.54 | loss  3.25 | ppl    25.79 
| epoch  44 |   200/  269 batches | lr 0.00007 | ms/batch 240.36 | loss  3.22 | ppl    25.14 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 66.03s | valid loss  3.79 | valid ppl    44.18 | valid bpc    5.465
-----------------------------------------------------------------------------------------
PROGRESS: 44.0%
| epoch  45 |   100/  269 batches | lr 0.00007 | ms/batch 247.36 | loss  3.21 | ppl    24.82 
| epoch  45 |   200/  269 batches | lr 0.00007 | ms/batch 242.62 | loss  3.21 | ppl    24.77 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 66.16s | valid loss  3.76 | valid ppl    43.16 | valid bpc    5.432
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 45.0%
| epoch  46 |   100/  269 batches | lr 0.00007 | ms/batch 248.73 | loss  3.19 | ppl    24.29 
| epoch  46 |   200/  269 batches | lr 0.00007 | ms/batch 234.63 | loss  3.19 | ppl    24.28 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 66.04s | valid loss  3.74 | valid ppl    42.23 | valid bpc    5.400
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 46.0%
| epoch  47 |   100/  269 batches | lr 0.00007 | ms/batch 247.72 | loss  3.21 | ppl    24.82 
| epoch  47 |   200/  269 batches | lr 0.00007 | ms/batch 233.85 | loss  3.15 | ppl    23.33 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 66.03s | valid loss  3.78 | valid ppl    43.81 | valid bpc    5.453
-----------------------------------------------------------------------------------------
PROGRESS: 47.0%
| epoch  48 |   100/  269 batches | lr 0.00007 | ms/batch 248.78 | loss  3.19 | ppl    24.21 
| epoch  48 |   200/  269 batches | lr 0.00007 | ms/batch 232.47 | loss  3.15 | ppl    23.31 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 66.03s | valid loss  3.83 | valid ppl    45.84 | valid bpc    5.519
-----------------------------------------------------------------------------------------
PROGRESS: 48.0%
| epoch  49 |   100/  269 batches | lr 0.00007 | ms/batch 244.90 | loss  3.16 | ppl    23.63 
| epoch  49 |   200/  269 batches | lr 0.00007 | ms/batch 230.09 | loss  3.16 | ppl    23.46 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 65.30s | valid loss  3.79 | valid ppl    44.20 | valid bpc    5.466
-----------------------------------------------------------------------------------------
PROGRESS: 49.0%
| epoch  50 |   100/  269 batches | lr 0.00004 | ms/batch 248.31 | loss  3.17 | ppl    23.75 
| epoch  50 |   200/  269 batches | lr 0.00004 | ms/batch 229.71 | loss  3.11 | ppl    22.32 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 65.74s | valid loss  3.79 | valid ppl    44.05 | valid bpc    5.461
-----------------------------------------------------------------------------------------
PROGRESS: 50.0%
| epoch  51 |   100/  269 batches | lr 0.00004 | ms/batch 247.68 | loss  3.12 | ppl    22.59 
| epoch  51 |   200/  269 batches | lr 0.00004 | ms/batch 235.18 | loss  3.11 | ppl    22.32 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 66.12s | valid loss  3.78 | valid ppl    43.71 | valid bpc    5.450
-----------------------------------------------------------------------------------------
PROGRESS: 51.0%
| epoch  52 |   100/  269 batches | lr 0.00004 | ms/batch 243.88 | loss  3.12 | ppl    22.59 
| epoch  52 |   200/  269 batches | lr 0.00004 | ms/batch 235.98 | loss  3.10 | ppl    22.15 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 65.78s | valid loss  3.76 | valid ppl    43.06 | valid bpc    5.428
-----------------------------------------------------------------------------------------
PROGRESS: 52.0%
| epoch  53 |   100/  269 batches | lr 0.00002 | ms/batch 248.42 | loss  3.11 | ppl    22.44 
| epoch  53 |   200/  269 batches | lr 0.00002 | ms/batch 233.86 | loss  3.10 | ppl    22.23 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 66.04s | valid loss  3.75 | valid ppl    42.61 | valid bpc    5.413
-----------------------------------------------------------------------------------------
PROGRESS: 53.0%
| epoch  54 |   100/  269 batches | lr 0.00002 | ms/batch 248.34 | loss  3.09 | ppl    22.02 
| epoch  54 |   200/  269 batches | lr 0.00002 | ms/batch 234.30 | loss  3.08 | ppl    21.72 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 66.14s | valid loss  3.69 | valid ppl    40.22 | valid bpc    5.330
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 54.0%
| epoch  55 |   100/  269 batches | lr 0.00002 | ms/batch 248.96 | loss  3.10 | ppl    22.09 
| epoch  55 |   200/  269 batches | lr 0.00002 | ms/batch 233.72 | loss  3.08 | ppl    21.81 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 66.06s | valid loss  3.76 | valid ppl    43.13 | valid bpc    5.431
-----------------------------------------------------------------------------------------
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  269 batches | lr 0.00002 | ms/batch 249.04 | loss  3.10 | ppl    22.17 
| epoch  56 |   200/  269 batches | lr 0.00002 | ms/batch 234.46 | loss  3.07 | ppl    21.49 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 66.13s | valid loss  3.78 | valid ppl    43.96 | valid bpc    5.458
-----------------------------------------------------------------------------------------
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  269 batches | lr 0.00002 | ms/batch 249.20 | loss  3.10 | ppl    22.14 
| epoch  57 |   200/  269 batches | lr 0.00002 | ms/batch 233.55 | loss  3.07 | ppl    21.59 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 66.02s | valid loss  3.84 | valid ppl    46.45 | valid bpc    5.538
-----------------------------------------------------------------------------------------
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  269 batches | lr 0.00001 | ms/batch 248.86 | loss  3.11 | ppl    22.45 
| epoch  58 |   200/  269 batches | lr 0.00001 | ms/batch 234.30 | loss  3.03 | ppl    20.77 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 66.09s | valid loss  3.74 | valid ppl    42.01 | valid bpc    5.393
-----------------------------------------------------------------------------------------
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  269 batches | lr 0.00001 | ms/batch 249.29 | loss  3.08 | ppl    21.81 
| epoch  59 |   200/  269 batches | lr 0.00001 | ms/batch 234.66 | loss  3.04 | ppl    20.95 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 66.11s | valid loss  3.78 | valid ppl    43.76 | valid bpc    5.452
-----------------------------------------------------------------------------------------
PROGRESS: 59.0%
| epoch  60 |   100/  269 batches | lr 0.00001 | ms/batch 249.06 | loss  3.06 | ppl    21.26 
| epoch  60 |   200/  269 batches | lr 0.00001 | ms/batch 229.94 | loss  3.05 | ppl    21.07 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 65.69s | valid loss  3.75 | valid ppl    42.71 | valid bpc    5.417
-----------------------------------------------------------------------------------------
PROGRESS: 60.0%
| epoch  61 |   100/  269 batches | lr 0.00000 | ms/batch 249.37 | loss  3.04 | ppl    20.83 
| epoch  61 |   200/  269 batches | lr 0.00000 | ms/batch 233.35 | loss  3.05 | ppl    21.08 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 66.17s | valid loss  3.76 | valid ppl    42.85 | valid bpc    5.421
-----------------------------------------------------------------------------------------
PROGRESS: 61.0%
| epoch  62 |   100/  269 batches | lr 0.00000 | ms/batch 248.56 | loss  3.09 | ppl    21.97 
| epoch  62 |   200/  269 batches | lr 0.00000 | ms/batch 234.41 | loss  3.04 | ppl    20.90 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 66.04s | valid loss  3.76 | valid ppl    42.87 | valid bpc    5.422
-----------------------------------------------------------------------------------------
PROGRESS: 62.0%
| epoch  63 |   100/  269 batches | lr 0.00000 | ms/batch 249.17 | loss  3.09 | ppl    22.02 
| epoch  63 |   200/  269 batches | lr 0.00000 | ms/batch 233.69 | loss  3.05 | ppl    21.12 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 66.05s | valid loss  3.74 | valid ppl    41.94 | valid bpc    5.390
-----------------------------------------------------------------------------------------
PROGRESS: 63.0%
| epoch  64 |   100/  269 batches | lr 0.00000 | ms/batch 249.07 | loss  3.05 | ppl    21.04 
| epoch  64 |   200/  269 batches | lr 0.00000 | ms/batch 233.78 | loss  3.04 | ppl    20.94 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 66.04s | valid loss  3.77 | valid ppl    43.50 | valid bpc    5.443
-----------------------------------------------------------------------------------------
PROGRESS: 64.0%
| epoch  65 |   100/  269 batches | lr 0.00000 | ms/batch 249.20 | loss  3.08 | ppl    21.74 
| epoch  65 |   200/  269 batches | lr 0.00000 | ms/batch 234.09 | loss  3.05 | ppl    21.10 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 65.96s | valid loss  3.78 | valid ppl    43.83 | valid bpc    5.454
-----------------------------------------------------------------------------------------
PROGRESS: 65.0%
| epoch  66 |   100/  269 batches | lr 0.00000 | ms/batch 248.68 | loss  3.08 | ppl    21.78 
| epoch  66 |   200/  269 batches | lr 0.00000 | ms/batch 234.85 | loss  3.03 | ppl    20.68 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 66.19s | valid loss  3.77 | valid ppl    43.49 | valid bpc    5.443
-----------------------------------------------------------------------------------------
PROGRESS: 66.0%
| epoch  67 |   100/  269 batches | lr 0.00000 | ms/batch 249.82 | loss  3.07 | ppl    21.55 
| epoch  67 |   200/  269 batches | lr 0.00000 | ms/batch 232.47 | loss  3.03 | ppl    20.69 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 66.07s | valid loss  3.77 | valid ppl    43.31 | valid bpc    5.437
-----------------------------------------------------------------------------------------
PROGRESS: 67.0%
| epoch  68 |   100/  269 batches | lr 0.00000 | ms/batch 250.66 | loss  3.06 | ppl    21.40 
| epoch  68 |   200/  269 batches | lr 0.00000 | ms/batch 228.25 | loss  3.03 | ppl    20.68 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 65.74s | valid loss  3.77 | valid ppl    43.48 | valid bpc    5.442
-----------------------------------------------------------------------------------------
PROGRESS: 68.0%
| epoch  69 |   100/  269 batches | lr 0.00000 | ms/batch 254.30 | loss  3.08 | ppl    21.73 
| epoch  69 |   200/  269 batches | lr 0.00000 | ms/batch 229.76 | loss  3.03 | ppl    20.74 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 66.08s | valid loss  3.74 | valid ppl    42.18 | valid bpc    5.399
-----------------------------------------------------------------------------------------
PROGRESS: 69.0%
| epoch  70 |   100/  269 batches | lr 0.00000 | ms/batch 254.54 | loss  3.08 | ppl    21.73 
| epoch  70 |   200/  269 batches | lr 0.00000 | ms/batch 224.99 | loss  3.05 | ppl    21.06 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 65.71s | valid loss  3.73 | valid ppl    41.51 | valid bpc    5.375
-----------------------------------------------------------------------------------------
PROGRESS: 70.0%
| epoch  71 |   100/  269 batches | lr 0.00000 | ms/batch 254.22 | loss  3.07 | ppl    21.62 
| epoch  71 |   200/  269 batches | lr 0.00000 | ms/batch 229.41 | loss  3.04 | ppl    20.93 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 66.10s | valid loss  3.73 | valid ppl    41.70 | valid bpc    5.382
-----------------------------------------------------------------------------------------
PROGRESS: 71.0%
| epoch  72 |   100/  269 batches | lr 0.00000 | ms/batch 254.30 | loss  3.10 | ppl    22.11 
| epoch  72 |   200/  269 batches | lr 0.00000 | ms/batch 228.24 | loss  3.03 | ppl    20.75 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 66.06s | valid loss  3.74 | valid ppl    41.90 | valid bpc    5.389
-----------------------------------------------------------------------------------------
PROGRESS: 72.0%
| epoch  73 |   100/  269 batches | lr 0.00000 | ms/batch 255.48 | loss  3.08 | ppl    21.77 
| epoch  73 |   200/  269 batches | lr 0.00000 | ms/batch 227.75 | loss  3.04 | ppl    20.81 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 66.14s | valid loss  3.72 | valid ppl    41.08 | valid bpc    5.360
-----------------------------------------------------------------------------------------
PROGRESS: 73.0%
| epoch  74 |   100/  269 batches | lr 0.00000 | ms/batch 255.42 | loss  3.09 | ppl    21.88 
| epoch  74 |   200/  269 batches | lr 0.00000 | ms/batch 227.82 | loss  3.00 | ppl    20.10 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 65.98s | valid loss  3.78 | valid ppl    43.65 | valid bpc    5.448
-----------------------------------------------------------------------------------------
PROGRESS: 74.0%
| epoch  75 |   100/  269 batches | lr 0.00000 | ms/batch 253.70 | loss  3.05 | ppl    21.10 
| epoch  75 |   200/  269 batches | lr 0.00000 | ms/batch 228.74 | loss  3.04 | ppl    20.98 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 66.04s | valid loss  3.72 | valid ppl    41.14 | valid bpc    5.362
-----------------------------------------------------------------------------------------
PROGRESS: 75.0%
| epoch  76 |   100/  269 batches | lr 0.00000 | ms/batch 254.59 | loss  3.05 | ppl    21.19 
| epoch  76 |   200/  269 batches | lr 0.00000 | ms/batch 227.64 | loss  3.04 | ppl    20.97 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 66.00s | valid loss  3.72 | valid ppl    41.10 | valid bpc    5.361
-----------------------------------------------------------------------------------------
PROGRESS: 76.0%
| epoch  77 |   100/  269 batches | lr 0.00000 | ms/batch 255.10 | loss  3.08 | ppl    21.82 
| epoch  77 |   200/  269 batches | lr 0.00000 | ms/batch 227.55 | loss  3.02 | ppl    20.53 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 66.04s | valid loss  3.71 | valid ppl    40.81 | valid bpc    5.351
-----------------------------------------------------------------------------------------
PROGRESS: 77.0%
| epoch  78 |   100/  269 batches | lr 0.00000 | ms/batch 254.43 | loss  3.07 | ppl    21.47 
| epoch  78 |   200/  269 batches | lr 0.00000 | ms/batch 228.04 | loss  3.05 | ppl    21.11 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 66.08s | valid loss  3.78 | valid ppl    43.87 | valid bpc    5.455
-----------------------------------------------------------------------------------------
PROGRESS: 78.0%
| epoch  79 |   100/  269 batches | lr 0.00000 | ms/batch 252.89 | loss  3.07 | ppl    21.64 
| epoch  79 |   200/  269 batches | lr 0.00000 | ms/batch 229.32 | loss  3.02 | ppl    20.57 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 66.00s | valid loss  3.74 | valid ppl    42.10 | valid bpc    5.396
-----------------------------------------------------------------------------------------
PROGRESS: 79.0%
| epoch  80 |   100/  269 batches | lr 0.00000 | ms/batch 253.80 | loss  3.08 | ppl    21.79 
| epoch  80 |   200/  269 batches | lr 0.00000 | ms/batch 229.85 | loss  3.03 | ppl    20.61 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 66.09s | valid loss  3.75 | valid ppl    42.68 | valid bpc    5.416
-----------------------------------------------------------------------------------------
PROGRESS: 80.0%
| epoch  81 |   100/  269 batches | lr 0.00000 | ms/batch 253.98 | loss  3.07 | ppl    21.56 
| epoch  81 |   200/  269 batches | lr 0.00000 | ms/batch 228.46 | loss  3.03 | ppl    20.68 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 66.05s | valid loss  3.76 | valid ppl    43.09 | valid bpc    5.429
-----------------------------------------------------------------------------------------
PROGRESS: 81.0%
| epoch  82 |   100/  269 batches | lr 0.00000 | ms/batch 252.39 | loss  3.08 | ppl    21.83 
| epoch  82 |   200/  269 batches | lr 0.00000 | ms/batch 230.74 | loss  3.04 | ppl    20.88 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 66.05s | valid loss  3.77 | valid ppl    43.27 | valid bpc    5.435
-----------------------------------------------------------------------------------------
PROGRESS: 82.0%
| epoch  83 |   100/  269 batches | lr 0.00000 | ms/batch 251.05 | loss  3.08 | ppl    21.70 
| epoch  83 |   200/  269 batches | lr 0.00000 | ms/batch 232.21 | loss  3.05 | ppl    21.11 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 66.05s | valid loss  3.72 | valid ppl    41.29 | valid bpc    5.368
-----------------------------------------------------------------------------------------
PROGRESS: 83.0%
| epoch  84 |   100/  269 batches | lr 0.00000 | ms/batch 248.61 | loss  3.05 | ppl    21.13 
| epoch  84 |   200/  269 batches | lr 0.00000 | ms/batch 234.64 | loss  3.05 | ppl    21.10 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 66.08s | valid loss  3.77 | valid ppl    43.51 | valid bpc    5.443
-----------------------------------------------------------------------------------------
PROGRESS: 84.0%
| epoch  85 |   100/  269 batches | lr 0.00000 | ms/batch 248.44 | loss  3.07 | ppl    21.47 
| epoch  85 |   200/  269 batches | lr 0.00000 | ms/batch 234.92 | loss  3.02 | ppl    20.59 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 66.12s | valid loss  3.77 | valid ppl    43.45 | valid bpc    5.441
-----------------------------------------------------------------------------------------
PROGRESS: 85.0%
| epoch  86 |   100/  269 batches | lr 0.00000 | ms/batch 248.88 | loss  3.09 | ppl    22.07 
| epoch  86 |   200/  269 batches | lr 0.00000 | ms/batch 234.58 | loss  3.03 | ppl    20.74 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 66.12s | valid loss  3.70 | valid ppl    40.65 | valid bpc    5.345
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  269 batches | lr 0.00000 | ms/batch 249.04 | loss  3.07 | ppl    21.64 
| epoch  87 |   200/  269 batches | lr 0.00000 | ms/batch 233.78 | loss  3.03 | ppl    20.78 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 66.05s | valid loss  3.77 | valid ppl    43.48 | valid bpc    5.442
-----------------------------------------------------------------------------------------
PROGRESS: 87.0%
| epoch  88 |   100/  269 batches | lr 0.00000 | ms/batch 250.08 | loss  3.06 | ppl    21.35 
| epoch  88 |   200/  269 batches | lr 0.00000 | ms/batch 233.71 | loss  3.02 | ppl    20.57 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 66.13s | valid loss  3.72 | valid ppl    41.16 | valid bpc    5.363
-----------------------------------------------------------------------------------------
PROGRESS: 88.0%
| epoch  89 |   100/  269 batches | lr 0.00000 | ms/batch 248.47 | loss  3.06 | ppl    21.26 
| epoch  89 |   200/  269 batches | lr 0.00000 | ms/batch 233.22 | loss  3.05 | ppl    21.08 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 66.05s | valid loss  3.70 | valid ppl    40.48 | valid bpc    5.339
-----------------------------------------------------------------------------------------
PROGRESS: 89.0%
| epoch  90 |   100/  269 batches | lr 0.00000 | ms/batch 247.37 | loss  3.07 | ppl    21.49 
| epoch  90 |   200/  269 batches | lr 0.00000 | ms/batch 234.89 | loss  3.02 | ppl    20.44 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 66.03s | valid loss  3.78 | valid ppl    43.98 | valid bpc    5.459
-----------------------------------------------------------------------------------------
PROGRESS: 90.0%
| epoch  91 |   100/  269 batches | lr 0.00000 | ms/batch 250.25 | loss  3.08 | ppl    21.69 
| epoch  91 |   200/  269 batches | lr 0.00000 | ms/batch 234.03 | loss  3.01 | ppl    20.21 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 66.11s | valid loss  3.78 | valid ppl    43.86 | valid bpc    5.455
-----------------------------------------------------------------------------------------
PROGRESS: 91.0%
| epoch  92 |   100/  269 batches | lr 0.00000 | ms/batch 248.39 | loss  3.07 | ppl    21.63 
| epoch  92 |   200/  269 batches | lr 0.00000 | ms/batch 234.32 | loss  3.03 | ppl    20.76 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 66.17s | valid loss  3.71 | valid ppl    40.92 | valid bpc    5.355
-----------------------------------------------------------------------------------------
PROGRESS: 92.0%
| epoch  93 |   100/  269 batches | lr 0.00000 | ms/batch 249.65 | loss  3.05 | ppl    21.22 
| epoch  93 |   200/  269 batches | lr 0.00000 | ms/batch 233.71 | loss  3.05 | ppl    21.10 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 66.06s | valid loss  3.80 | valid ppl    44.48 | valid bpc    5.475
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  269 batches | lr 0.00000 | ms/batch 249.80 | loss  3.06 | ppl    21.34 
| epoch  94 |   200/  269 batches | lr 0.00000 | ms/batch 237.12 | loss  3.01 | ppl    20.23 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 66.13s | valid loss  3.68 | valid ppl    39.61 | valid bpc    5.308
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 94.0%
| epoch  95 |   100/  269 batches | lr 0.00000 | ms/batch 249.18 | loss  3.06 | ppl    21.42 
| epoch  95 |   200/  269 batches | lr 0.00000 | ms/batch 236.82 | loss  3.08 | ppl    21.69 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 61.66s | valid loss  3.78 | valid ppl    43.64 | valid bpc    5.448
-----------------------------------------------------------------------------------------
PROGRESS: 95.0%
| epoch  96 |   100/  269 batches | lr 0.00000 | ms/batch 174.62 | loss  3.06 | ppl    21.30 
| epoch  96 |   200/  269 batches | lr 0.00000 | ms/batch 171.28 | loss  3.04 | ppl    20.84 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 47.28s | valid loss  3.76 | valid ppl    42.80 | valid bpc    5.419
-----------------------------------------------------------------------------------------
PROGRESS: 96.0%
| epoch  97 |   100/  269 batches | lr 0.00000 | ms/batch 169.14 | loss  3.06 | ppl    21.30 
| epoch  97 |   200/  269 batches | lr 0.00000 | ms/batch 159.91 | loss  3.03 | ppl    20.80 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 44.80s | valid loss  3.78 | valid ppl    43.73 | valid bpc    5.451
-----------------------------------------------------------------------------------------
PROGRESS: 97.0%
| epoch  98 |   100/  269 batches | lr 0.00000 | ms/batch 217.66 | loss  3.07 | ppl    21.53 
| epoch  98 |   200/  269 batches | lr 0.00000 | ms/batch 241.22 | loss  3.06 | ppl    21.29 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 63.60s | valid loss  3.77 | valid ppl    43.42 | valid bpc    5.440
-----------------------------------------------------------------------------------------
PROGRESS: 98.0%
| epoch  99 |   100/  269 batches | lr 0.00000 | ms/batch 234.39 | loss  3.07 | ppl    21.45 
| epoch  99 |   200/  269 batches | lr 0.00000 | ms/batch 239.98 | loss  3.04 | ppl    20.87 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 65.23s | valid loss  3.76 | valid ppl    43.06 | valid bpc    5.428
-----------------------------------------------------------------------------------------
PROGRESS: 99.0%
| epoch 100 |   100/  269 batches | lr 0.00000 | ms/batch 206.89 | loss  3.05 | ppl    21.12 
| epoch 100 |   200/  269 batches | lr 0.00000 | ms/batch 171.51 | loss  3.05 | ppl    21.08 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 50.50s | valid loss  3.78 | valid ppl    43.84 | valid bpc    5.454
-----------------------------------------------------------------------------------------
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  3.84 | test ppl    46.48 | test bpc    5.539
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.4564, Mean Reca: 0.6397, Mean F1: 0.5287, Mean Subword_Reca: 0.7814
-----------------------------------------------------------------------------------------
=========================================================================================
Loading dataset...
Using subword tokenizer...
Number of tokens:  8000
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer_in_parser', nhid=512, nlayers=8, front_layers=3, rear_layers=5, subword='omarmomen/ptb_filtered_lowcase_bpe_tokenizer_8', n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=4444, nonmono=5, cuda=True, log_interval=100, save='trained_models/subword_structformer_in_parser_4444_35.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 37449108
Model architecture: StructFormer_In_Parser(
  (transformer_front): Transformer_Front(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(8000, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-2): 3 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
  (transformer_rear): Transformer_Rear(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(8000, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-4): 5 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (output_layer): Linear(in_features=512, out_features=8000, bias=True)
  )
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  269 batches | lr 0.00030 | ms/batch 252.28 | loss  7.74 | ppl  2309.05 
| epoch   1 |   200/  269 batches | lr 0.00030 | ms/batch 231.52 | loss  7.35 | ppl  1563.70 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 66.21s | valid loss  7.13 | valid ppl  1243.26 | valid bpc   10.280
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  269 batches | lr 0.00030 | ms/batch 248.23 | loss  7.28 | ppl  1447.38 
| epoch   2 |   200/  269 batches | lr 0.00030 | ms/batch 228.44 | loss  7.16 | ppl  1282.98 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 65.30s | valid loss  6.87 | valid ppl   964.71 | valid bpc    9.914
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  269 batches | lr 0.00030 | ms/batch 250.25 | loss  7.02 | ppl  1118.36 
| epoch   3 |   200/  269 batches | lr 0.00030 | ms/batch 225.55 | loss  6.71 | ppl   822.83 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 65.28s | valid loss  6.24 | valid ppl   515.14 | valid bpc    9.009
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  269 batches | lr 0.00030 | ms/batch 253.85 | loss  6.35 | ppl   572.31 
| epoch   4 |   200/  269 batches | lr 0.00030 | ms/batch 222.89 | loss  6.12 | ppl   452.93 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 65.39s | valid loss  5.78 | valid ppl   322.86 | valid bpc    8.335
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  269 batches | lr 0.00030 | ms/batch 254.60 | loss  5.94 | ppl   379.69 
| epoch   5 |   200/  269 batches | lr 0.00030 | ms/batch 221.44 | loss  5.83 | ppl   339.75 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 65.23s | valid loss  5.49 | valid ppl   243.17 | valid bpc    7.926
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  269 batches | lr 0.00030 | ms/batch 255.16 | loss  5.71 | ppl   301.36 
| epoch   6 |   200/  269 batches | lr 0.00030 | ms/batch 220.54 | loss  5.58 | ppl   266.17 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 65.34s | valid loss  5.37 | valid ppl   215.06 | valid bpc    7.749
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  269 batches | lr 0.00030 | ms/batch 254.67 | loss  5.54 | ppl   255.15 
| epoch   7 |   200/  269 batches | lr 0.00030 | ms/batch 220.92 | loss  5.44 | ppl   229.99 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 65.41s | valid loss  5.18 | valid ppl   177.96 | valid bpc    7.475
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  269 batches | lr 0.00030 | ms/batch 254.06 | loss  5.38 | ppl   217.68 
| epoch   8 |   200/  269 batches | lr 0.00030 | ms/batch 220.33 | loss  5.29 | ppl   197.66 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 65.38s | valid loss  5.15 | valid ppl   172.35 | valid bpc    7.429
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 8.0%
| epoch   9 |   100/  269 batches | lr 0.00030 | ms/batch 254.05 | loss  5.27 | ppl   194.05 
| epoch   9 |   200/  269 batches | lr 0.00030 | ms/batch 221.63 | loss  5.18 | ppl   178.22 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 65.37s | valid loss  5.00 | valid ppl   148.59 | valid bpc    7.215
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  269 batches | lr 0.00030 | ms/batch 256.14 | loss  5.15 | ppl   172.28 
| epoch  10 |   200/  269 batches | lr 0.00030 | ms/batch 219.63 | loss  5.08 | ppl   160.87 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 65.30s | valid loss  4.88 | valid ppl   131.05 | valid bpc    7.034
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  269 batches | lr 0.00030 | ms/batch 254.02 | loss  5.04 | ppl   154.51 
| epoch  11 |   200/  269 batches | lr 0.00030 | ms/batch 221.84 | loss  4.99 | ppl   147.38 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 65.34s | valid loss  4.86 | valid ppl   128.61 | valid bpc    7.007
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  269 batches | lr 0.00030 | ms/batch 254.05 | loss  4.93 | ppl   138.01 
| epoch  12 |   200/  269 batches | lr 0.00030 | ms/batch 222.00 | loss  4.88 | ppl   131.21 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 65.36s | valid loss  4.77 | valid ppl   117.43 | valid bpc    6.876
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 12.0%
| epoch  13 |   100/  269 batches | lr 0.00030 | ms/batch 255.24 | loss  4.86 | ppl   129.47 
| epoch  13 |   200/  269 batches | lr 0.00030 | ms/batch 220.42 | loss  4.79 | ppl   120.66 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 65.24s | valid loss  4.65 | valid ppl   104.86 | valid bpc    6.712
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 13.0%
| epoch  14 |   100/  269 batches | lr 0.00030 | ms/batch 254.50 | loss  4.76 | ppl   117.18 
| epoch  14 |   200/  269 batches | lr 0.00030 | ms/batch 215.37 | loss  4.70 | ppl   109.72 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 64.74s | valid loss  4.61 | valid ppl   100.63 | valid bpc    6.653
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  269 batches | lr 0.00030 | ms/batch 254.31 | loss  4.67 | ppl   106.50 
| epoch  15 |   200/  269 batches | lr 0.00030 | ms/batch 223.03 | loss  4.61 | ppl   100.23 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 65.58s | valid loss  4.55 | valid ppl    94.34 | valid bpc    6.560
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 15.0%
| epoch  16 |   100/  269 batches | lr 0.00030 | ms/batch 254.55 | loss  4.60 | ppl    99.73 
| epoch  16 |   200/  269 batches | lr 0.00030 | ms/batch 218.45 | loss  4.55 | ppl    94.80 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 64.99s | valid loss  4.51 | valid ppl    90.55 | valid bpc    6.501
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 16.0%
| epoch  17 |   100/  269 batches | lr 0.00030 | ms/batch 254.79 | loss  4.51 | ppl    91.05 
| epoch  17 |   200/  269 batches | lr 0.00030 | ms/batch 223.91 | loss  4.48 | ppl    87.94 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 65.56s | valid loss  4.45 | valid ppl    85.59 | valid bpc    6.419
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 17.0%
| epoch  18 |   100/  269 batches | lr 0.00030 | ms/batch 253.20 | loss  4.43 | ppl    83.54 
| epoch  18 |   200/  269 batches | lr 0.00030 | ms/batch 219.75 | loss  4.43 | ppl    84.12 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 65.06s | valid loss  4.35 | valid ppl    77.10 | valid bpc    6.269
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 18.0%
| epoch  19 |   100/  269 batches | lr 0.00030 | ms/batch 253.01 | loss  4.36 | ppl    78.36 
| epoch  19 |   200/  269 batches | lr 0.00030 | ms/batch 225.72 | loss  4.36 | ppl    77.99 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 65.74s | valid loss  4.30 | valid ppl    73.98 | valid bpc    6.209
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 19.0%
| epoch  20 |   100/  269 batches | lr 0.00030 | ms/batch 253.41 | loss  4.32 | ppl    75.21 
| epoch  20 |   200/  269 batches | lr 0.00030 | ms/batch 225.14 | loss  4.27 | ppl    71.69 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 65.72s | valid loss  4.30 | valid ppl    73.46 | valid bpc    6.199
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 20.0%
| epoch  21 |   100/  269 batches | lr 0.00030 | ms/batch 253.67 | loss  4.24 | ppl    69.36 
| epoch  21 |   200/  269 batches | lr 0.00030 | ms/batch 221.82 | loss  4.22 | ppl    68.04 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 65.29s | valid loss  4.27 | valid ppl    71.47 | valid bpc    6.159
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 21.0%
| epoch  22 |   100/  269 batches | lr 0.00030 | ms/batch 254.22 | loss  4.19 | ppl    65.88 
| epoch  22 |   200/  269 batches | lr 0.00030 | ms/batch 224.33 | loss  4.17 | ppl    64.79 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 65.62s | valid loss  4.23 | valid ppl    68.72 | valid bpc    6.103
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 22.0%
| epoch  23 |   100/  269 batches | lr 0.00030 | ms/batch 255.21 | loss  4.11 | ppl    60.65 
| epoch  23 |   200/  269 batches | lr 0.00030 | ms/batch 221.34 | loss  4.11 | ppl    60.71 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 65.34s | valid loss  4.19 | valid ppl    66.13 | valid bpc    6.047
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 23.0%
| epoch  24 |   100/  269 batches | lr 0.00030 | ms/batch 255.07 | loss  4.06 | ppl    58.05 
| epoch  24 |   200/  269 batches | lr 0.00030 | ms/batch 220.34 | loss  4.03 | ppl    56.35 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 65.35s | valid loss  4.16 | valid ppl    64.23 | valid bpc    6.005
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 24.0%
| epoch  25 |   100/  269 batches | lr 0.00030 | ms/batch 254.11 | loss  4.01 | ppl    55.19 
| epoch  25 |   200/  269 batches | lr 0.00030 | ms/batch 222.52 | loss  4.00 | ppl    54.42 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 65.31s | valid loss  4.15 | valid ppl    63.21 | valid bpc    5.982
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 25.0%
| epoch  26 |   100/  269 batches | lr 0.00030 | ms/batch 255.53 | loss  3.98 | ppl    53.48 
| epoch  26 |   200/  269 batches | lr 0.00030 | ms/batch 221.97 | loss  3.93 | ppl    51.06 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 65.41s | valid loss  4.09 | valid ppl    59.47 | valid bpc    5.894
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 26.0%
| epoch  27 |   100/  269 batches | lr 0.00030 | ms/batch 255.97 | loss  3.95 | ppl    51.71 
| epoch  27 |   200/  269 batches | lr 0.00030 | ms/batch 224.64 | loss  3.88 | ppl    48.31 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 65.66s | valid loss  4.10 | valid ppl    60.52 | valid bpc    5.919
-----------------------------------------------------------------------------------------
PROGRESS: 27.0%
| epoch  28 |   100/  269 batches | lr 0.00030 | ms/batch 255.91 | loss  3.87 | ppl    48.13 
| epoch  28 |   200/  269 batches | lr 0.00030 | ms/batch 228.06 | loss  3.84 | ppl    46.43 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 66.07s | valid loss  4.06 | valid ppl    58.22 | valid bpc    5.863
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  269 batches | lr 0.00030 | ms/batch 253.78 | loss  3.84 | ppl    46.31 
| epoch  29 |   200/  269 batches | lr 0.00030 | ms/batch 224.43 | loss  3.79 | ppl    44.13 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 65.60s | valid loss  4.03 | valid ppl    56.54 | valid bpc    5.821
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  269 batches | lr 0.00030 | ms/batch 254.51 | loss  3.78 | ppl    43.99 
| epoch  30 |   200/  269 batches | lr 0.00030 | ms/batch 224.71 | loss  3.75 | ppl    42.48 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 65.67s | valid loss  4.05 | valid ppl    57.25 | valid bpc    5.839
-----------------------------------------------------------------------------------------
PROGRESS: 30.0%
| epoch  31 |   100/  269 batches | lr 0.00030 | ms/batch 254.54 | loss  3.74 | ppl    42.12 
| epoch  31 |   200/  269 batches | lr 0.00030 | ms/batch 221.42 | loss  3.73 | ppl    41.71 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 65.35s | valid loss  3.99 | valid ppl    54.12 | valid bpc    5.758
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 31.0%
| epoch  32 |   100/  269 batches | lr 0.00030 | ms/batch 254.87 | loss  3.70 | ppl    40.28 
| epoch  32 |   200/  269 batches | lr 0.00030 | ms/batch 225.50 | loss  3.68 | ppl    39.78 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 65.82s | valid loss  4.00 | valid ppl    54.70 | valid bpc    5.773
-----------------------------------------------------------------------------------------
PROGRESS: 32.0%
| epoch  33 |   100/  269 batches | lr 0.00030 | ms/batch 253.74 | loss  3.63 | ppl    37.67 
| epoch  33 |   200/  269 batches | lr 0.00030 | ms/batch 225.51 | loss  3.63 | ppl    37.83 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 65.76s | valid loss  4.03 | valid ppl    55.98 | valid bpc    5.807
-----------------------------------------------------------------------------------------
PROGRESS: 33.0%
| epoch  34 |   100/  269 batches | lr 0.00030 | ms/batch 252.13 | loss  3.61 | ppl    37.11 
| epoch  34 |   200/  269 batches | lr 0.00030 | ms/batch 226.19 | loss  3.62 | ppl    37.25 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 65.68s | valid loss  4.00 | valid ppl    54.48 | valid bpc    5.768
-----------------------------------------------------------------------------------------
PROGRESS: 34.0%
| epoch  35 |   100/  269 batches | lr 0.00015 | ms/batch 254.04 | loss  3.54 | ppl    34.50 
| epoch  35 |   200/  269 batches | lr 0.00015 | ms/batch 227.03 | loss  3.51 | ppl    33.43 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 65.67s | valid loss  3.86 | valid ppl    47.52 | valid bpc    5.570
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 35.0%
| epoch  36 |   100/  269 batches | lr 0.00015 | ms/batch 254.53 | loss  3.47 | ppl    32.28 
| epoch  36 |   200/  269 batches | lr 0.00015 | ms/batch 226.12 | loss  3.43 | ppl    30.75 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 65.37s | valid loss  3.89 | valid ppl    48.75 | valid bpc    5.607
-----------------------------------------------------------------------------------------
PROGRESS: 36.0%
| epoch  37 |   100/  269 batches | lr 0.00015 | ms/batch 254.78 | loss  3.43 | ppl    31.01 
| epoch  37 |   200/  269 batches | lr 0.00015 | ms/batch 230.42 | loss  3.40 | ppl    29.89 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 65.74s | valid loss  3.86 | valid ppl    47.55 | valid bpc    5.571
-----------------------------------------------------------------------------------------
PROGRESS: 37.0%
| epoch  38 |   100/  269 batches | lr 0.00015 | ms/batch 253.58 | loss  3.42 | ppl    30.52 
| epoch  38 |   200/  269 batches | lr 0.00015 | ms/batch 235.14 | loss  3.38 | ppl    29.44 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 65.68s | valid loss  3.91 | valid ppl    49.93 | valid bpc    5.642
-----------------------------------------------------------------------------------------
PROGRESS: 38.0%
| epoch  39 |   100/  269 batches | lr 0.00007 | ms/batch 253.92 | loss  3.35 | ppl    28.45 
| epoch  39 |   200/  269 batches | lr 0.00007 | ms/batch 233.37 | loss  3.33 | ppl    28.01 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 65.66s | valid loss  3.85 | valid ppl    46.96 | valid bpc    5.553
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 39.0%
| epoch  40 |   100/  269 batches | lr 0.00007 | ms/batch 249.98 | loss  3.34 | ppl    28.10 
| epoch  40 |   200/  269 batches | lr 0.00007 | ms/batch 240.01 | loss  3.31 | ppl    27.35 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 66.10s | valid loss  3.88 | valid ppl    48.63 | valid bpc    5.604
-----------------------------------------------------------------------------------------
PROGRESS: 40.0%
| epoch  41 |   100/  269 batches | lr 0.00007 | ms/batch 247.19 | loss  3.31 | ppl    27.48 
| epoch  41 |   200/  269 batches | lr 0.00007 | ms/batch 237.31 | loss  3.29 | ppl    26.96 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 65.72s | valid loss  3.84 | valid ppl    46.53 | valid bpc    5.540
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 41.0%
| epoch  42 |   100/  269 batches | lr 0.00007 | ms/batch 245.27 | loss  3.29 | ppl    26.82 
| epoch  42 |   200/  269 batches | lr 0.00007 | ms/batch 239.88 | loss  3.26 | ppl    25.97 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 65.72s | valid loss  3.82 | valid ppl    45.80 | valid bpc    5.517
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 42.0%
| epoch  43 |   100/  269 batches | lr 0.00007 | ms/batch 249.05 | loss  3.28 | ppl    26.45 
| epoch  43 |   200/  269 batches | lr 0.00007 | ms/batch 240.08 | loss  3.26 | ppl    26.12 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 66.10s | valid loss  3.86 | valid ppl    47.44 | valid bpc    5.568
-----------------------------------------------------------------------------------------
PROGRESS: 43.0%
| epoch  44 |   100/  269 batches | lr 0.00007 | ms/batch 244.55 | loss  3.25 | ppl    25.87 
| epoch  44 |   200/  269 batches | lr 0.00007 | ms/batch 239.82 | loss  3.24 | ppl    25.53 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 65.66s | valid loss  3.81 | valid ppl    45.33 | valid bpc    5.502
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 44.0%
| epoch  45 |   100/  269 batches | lr 0.00007 | ms/batch 247.97 | loss  3.26 | ppl    26.17 
| epoch  45 |   200/  269 batches | lr 0.00007 | ms/batch 240.88 | loss  3.22 | ppl    24.92 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 66.09s | valid loss  3.79 | valid ppl    44.19 | valid bpc    5.466
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 45.0%
| epoch  46 |   100/  269 batches | lr 0.00007 | ms/batch 250.03 | loss  3.24 | ppl    25.50 
| epoch  46 |   200/  269 batches | lr 0.00007 | ms/batch 238.96 | loss  3.22 | ppl    24.95 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 66.03s | valid loss  3.85 | valid ppl    47.04 | valid bpc    5.556
-----------------------------------------------------------------------------------------
PROGRESS: 46.0%
| epoch  47 |   100/  269 batches | lr 0.00007 | ms/batch 248.86 | loss  3.21 | ppl    24.66 
| epoch  47 |   200/  269 batches | lr 0.00007 | ms/batch 238.96 | loss  3.19 | ppl    24.40 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 66.01s | valid loss  3.86 | valid ppl    47.70 | valid bpc    5.576
-----------------------------------------------------------------------------------------
PROGRESS: 47.0%
| epoch  48 |   100/  269 batches | lr 0.00007 | ms/batch 244.07 | loss  3.20 | ppl    24.60 
| epoch  48 |   200/  269 batches | lr 0.00007 | ms/batch 240.84 | loss  3.18 | ppl    24.07 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 65.66s | valid loss  3.86 | valid ppl    47.31 | valid bpc    5.564
-----------------------------------------------------------------------------------------
PROGRESS: 48.0%
| epoch  49 |   100/  269 batches | lr 0.00004 | ms/batch 244.69 | loss  3.20 | ppl    24.48 
| epoch  49 |   200/  269 batches | lr 0.00004 | ms/batch 241.64 | loss  3.14 | ppl    23.06 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 65.79s | valid loss  3.84 | valid ppl    46.74 | valid bpc    5.546
-----------------------------------------------------------------------------------------
PROGRESS: 49.0%
| epoch  50 |   100/  269 batches | lr 0.00004 | ms/batch 247.70 | loss  3.17 | ppl    23.85 
| epoch  50 |   200/  269 batches | lr 0.00004 | ms/batch 241.32 | loss  3.13 | ppl    22.87 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 66.10s | valid loss  3.83 | valid ppl    46.02 | valid bpc    5.524
-----------------------------------------------------------------------------------------
PROGRESS: 50.0%
| epoch  51 |   100/  269 batches | lr 0.00004 | ms/batch 246.01 | loss  3.15 | ppl    23.32 
| epoch  51 |   200/  269 batches | lr 0.00004 | ms/batch 238.82 | loss  3.14 | ppl    23.10 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 65.69s | valid loss  3.77 | valid ppl    43.53 | valid bpc    5.444
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 51.0%
| epoch  52 |   100/  269 batches | lr 0.00004 | ms/batch 248.83 | loss  3.16 | ppl    23.57 
| epoch  52 |   200/  269 batches | lr 0.00004 | ms/batch 240.73 | loss  3.10 | ppl    22.31 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 66.15s | valid loss  3.83 | valid ppl    46.05 | valid bpc    5.525
-----------------------------------------------------------------------------------------
PROGRESS: 52.0%
| epoch  53 |   100/  269 batches | lr 0.00004 | ms/batch 248.24 | loss  3.15 | ppl    23.35 
| epoch  53 |   200/  269 batches | lr 0.00004 | ms/batch 241.25 | loss  3.12 | ppl    22.68 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 66.04s | valid loss  3.78 | valid ppl    43.66 | valid bpc    5.448
-----------------------------------------------------------------------------------------
PROGRESS: 53.0%
| epoch  54 |   100/  269 batches | lr 0.00004 | ms/batch 249.67 | loss  3.14 | ppl    23.08 
| epoch  54 |   200/  269 batches | lr 0.00004 | ms/batch 239.22 | loss  3.10 | ppl    22.24 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 66.01s | valid loss  3.85 | valid ppl    47.14 | valid bpc    5.559
-----------------------------------------------------------------------------------------
PROGRESS: 54.0%
| epoch  55 |   100/  269 batches | lr 0.00002 | ms/batch 245.59 | loss  3.11 | ppl    22.41 
| epoch  55 |   200/  269 batches | lr 0.00002 | ms/batch 239.57 | loss  3.09 | ppl    21.93 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 65.68s | valid loss  3.83 | valid ppl    46.20 | valid bpc    5.530
-----------------------------------------------------------------------------------------
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  269 batches | lr 0.00002 | ms/batch 245.02 | loss  3.12 | ppl    22.58 
| epoch  56 |   200/  269 batches | lr 0.00002 | ms/batch 240.36 | loss  3.08 | ppl    21.66 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 65.67s | valid loss  3.75 | valid ppl    42.54 | valid bpc    5.411
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  269 batches | lr 0.00002 | ms/batch 248.61 | loss  3.11 | ppl    22.51 
| epoch  57 |   200/  269 batches | lr 0.00002 | ms/batch 239.75 | loss  3.08 | ppl    21.84 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 66.07s | valid loss  3.79 | valid ppl    44.31 | valid bpc    5.470
-----------------------------------------------------------------------------------------
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  269 batches | lr 0.00002 | ms/batch 248.58 | loss  3.11 | ppl    22.46 
| epoch  58 |   200/  269 batches | lr 0.00002 | ms/batch 240.15 | loss  3.08 | ppl    21.74 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 66.02s | valid loss  3.77 | valid ppl    43.21 | valid bpc    5.433
-----------------------------------------------------------------------------------------
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  269 batches | lr 0.00002 | ms/batch 249.01 | loss  3.11 | ppl    22.49 
| epoch  59 |   200/  269 batches | lr 0.00002 | ms/batch 240.10 | loss  3.07 | ppl    21.53 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 66.01s | valid loss  3.78 | valid ppl    43.69 | valid bpc    5.449
-----------------------------------------------------------------------------------------
PROGRESS: 59.0%
| epoch  60 |   100/  269 batches | lr 0.00001 | ms/batch 248.82 | loss  3.11 | ppl    22.45 
| epoch  60 |   200/  269 batches | lr 0.00001 | ms/batch 239.89 | loss  3.09 | ppl    22.05 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 66.01s | valid loss  3.79 | valid ppl    44.42 | valid bpc    5.473
-----------------------------------------------------------------------------------------
PROGRESS: 60.0%
| epoch  61 |   100/  269 batches | lr 0.00001 | ms/batch 248.28 | loss  3.08 | ppl    21.73 
| epoch  61 |   200/  269 batches | lr 0.00001 | ms/batch 240.73 | loss  3.08 | ppl    21.76 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 66.30s | valid loss  3.76 | valid ppl    43.05 | valid bpc    5.428
-----------------------------------------------------------------------------------------
PROGRESS: 61.0%
| epoch  62 |   100/  269 batches | lr 0.00001 | ms/batch 247.33 | loss  3.12 | ppl    22.55 
| epoch  62 |   200/  269 batches | lr 0.00001 | ms/batch 240.20 | loss  3.10 | ppl    22.14 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 66.35s | valid loss  3.80 | valid ppl    44.72 | valid bpc    5.483
-----------------------------------------------------------------------------------------
PROGRESS: 62.0%
| epoch  63 |   100/  269 batches | lr 0.00000 | ms/batch 242.73 | loss  3.09 | ppl    22.00 
| epoch  63 |   200/  269 batches | lr 0.00000 | ms/batch 242.03 | loss  3.09 | ppl    21.90 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 66.17s | valid loss  3.73 | valid ppl    41.51 | valid bpc    5.375
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 63.0%
| epoch  64 |   100/  269 batches | lr 0.00000 | ms/batch 246.85 | loss  3.09 | ppl    21.97 
| epoch  64 |   200/  269 batches | lr 0.00000 | ms/batch 238.56 | loss  3.06 | ppl    21.41 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 66.28s | valid loss  3.79 | valid ppl    44.15 | valid bpc    5.464
-----------------------------------------------------------------------------------------
PROGRESS: 64.0%
| epoch  65 |   100/  269 batches | lr 0.00000 | ms/batch 243.35 | loss  3.07 | ppl    21.59 
| epoch  65 |   200/  269 batches | lr 0.00000 | ms/batch 241.29 | loss  3.06 | ppl    21.31 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 66.16s | valid loss  3.76 | valid ppl    43.05 | valid bpc    5.428
-----------------------------------------------------------------------------------------
PROGRESS: 65.0%
| epoch  66 |   100/  269 batches | lr 0.00000 | ms/batch 243.70 | loss  3.07 | ppl    21.50 
| epoch  66 |   200/  269 batches | lr 0.00000 | ms/batch 239.20 | loss  3.07 | ppl    21.62 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 65.93s | valid loss  3.77 | valid ppl    43.46 | valid bpc    5.442
-----------------------------------------------------------------------------------------
PROGRESS: 66.0%
| epoch  67 |   100/  269 batches | lr 0.00000 | ms/batch 241.79 | loss  3.08 | ppl    21.79 
| epoch  67 |   200/  269 batches | lr 0.00000 | ms/batch 240.89 | loss  3.06 | ppl    21.27 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 65.93s | valid loss  3.82 | valid ppl    45.70 | valid bpc    5.514
-----------------------------------------------------------------------------------------
PROGRESS: 67.0%
| epoch  68 |   100/  269 batches | lr 0.00000 | ms/batch 240.43 | loss  3.10 | ppl    22.13 
| epoch  68 |   200/  269 batches | lr 0.00000 | ms/batch 239.54 | loss  3.05 | ppl    21.11 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 65.68s | valid loss  3.79 | valid ppl    44.37 | valid bpc    5.472
-----------------------------------------------------------------------------------------
PROGRESS: 68.0%
| epoch  69 |   100/  269 batches | lr 0.00000 | ms/batch 242.45 | loss  3.09 | ppl    21.92 
| epoch  69 |   200/  269 batches | lr 0.00000 | ms/batch 241.33 | loss  3.05 | ppl    21.11 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 66.04s | valid loss  3.76 | valid ppl    43.16 | valid bpc    5.432
-----------------------------------------------------------------------------------------
PROGRESS: 69.0%
| epoch  70 |   100/  269 batches | lr 0.00000 | ms/batch 243.40 | loss  3.12 | ppl    22.58 
| epoch  70 |   200/  269 batches | lr 0.00000 | ms/batch 238.38 | loss  3.05 | ppl    21.07 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 66.04s | valid loss  3.76 | valid ppl    43.06 | valid bpc    5.428
-----------------------------------------------------------------------------------------
PROGRESS: 70.0%
| epoch  71 |   100/  269 batches | lr 0.00000 | ms/batch 239.00 | loss  3.07 | ppl    21.56 
| epoch  71 |   200/  269 batches | lr 0.00000 | ms/batch 240.47 | loss  3.03 | ppl    20.79 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 65.71s | valid loss  3.83 | valid ppl    46.02 | valid bpc    5.524
-----------------------------------------------------------------------------------------
PROGRESS: 71.0%
| epoch  72 |   100/  269 batches | lr 0.00000 | ms/batch 241.74 | loss  3.09 | ppl    22.07 
| epoch  72 |   200/  269 batches | lr 0.00000 | ms/batch 240.26 | loss  3.04 | ppl    20.96 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 66.01s | valid loss  3.82 | valid ppl    45.78 | valid bpc    5.517
-----------------------------------------------------------------------------------------
PROGRESS: 72.0%
| epoch  73 |   100/  269 batches | lr 0.00000 | ms/batch 242.63 | loss  3.09 | ppl    21.88 
| epoch  73 |   200/  269 batches | lr 0.00000 | ms/batch 238.96 | loss  3.05 | ppl    21.11 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 66.04s | valid loss  3.81 | valid ppl    45.33 | valid bpc    5.502
-----------------------------------------------------------------------------------------
PROGRESS: 73.0%
| epoch  74 |   100/  269 batches | lr 0.00000 | ms/batch 242.08 | loss  3.07 | ppl    21.62 
| epoch  74 |   200/  269 batches | lr 0.00000 | ms/batch 240.40 | loss  3.06 | ppl    21.35 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 65.98s | valid loss  3.82 | valid ppl    45.58 | valid bpc    5.510
-----------------------------------------------------------------------------------------
PROGRESS: 74.0%
| epoch  75 |   100/  269 batches | lr 0.00000 | ms/batch 242.65 | loss  3.10 | ppl    22.17 
| epoch  75 |   200/  269 batches | lr 0.00000 | ms/batch 240.06 | loss  3.04 | ppl    20.86 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 66.04s | valid loss  3.78 | valid ppl    43.75 | valid bpc    5.451
-----------------------------------------------------------------------------------------
PROGRESS: 75.0%
| epoch  76 |   100/  269 batches | lr 0.00000 | ms/batch 243.71 | loss  3.08 | ppl    21.78 
| epoch  76 |   200/  269 batches | lr 0.00000 | ms/batch 238.98 | loss  3.04 | ppl    20.89 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 66.02s | valid loss  3.79 | valid ppl    44.09 | valid bpc    5.462
-----------------------------------------------------------------------------------------
PROGRESS: 76.0%
| epoch  77 |   100/  269 batches | lr 0.00000 | ms/batch 241.69 | loss  3.09 | ppl    21.93 
| epoch  77 |   200/  269 batches | lr 0.00000 | ms/batch 240.62 | loss  3.06 | ppl    21.33 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 66.02s | valid loss  3.82 | valid ppl    45.48 | valid bpc    5.507
-----------------------------------------------------------------------------------------
PROGRESS: 77.0%
| epoch  78 |   100/  269 batches | lr 0.00000 | ms/batch 242.49 | loss  3.07 | ppl    21.55 
| epoch  78 |   200/  269 batches | lr 0.00000 | ms/batch 239.35 | loss  3.03 | ppl    20.76 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 66.01s | valid loss  3.79 | valid ppl    44.47 | valid bpc    5.475
-----------------------------------------------------------------------------------------
PROGRESS: 78.0%
| epoch  79 |   100/  269 batches | lr 0.00000 | ms/batch 242.22 | loss  3.08 | ppl    21.79 
| epoch  79 |   200/  269 batches | lr 0.00000 | ms/batch 239.16 | loss  3.04 | ppl    20.83 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 65.94s | valid loss  3.73 | valid ppl    41.61 | valid bpc    5.379
-----------------------------------------------------------------------------------------
PROGRESS: 79.0%
| epoch  80 |   100/  269 batches | lr 0.00000 | ms/batch 243.15 | loss  3.08 | ppl    21.82 
| epoch  80 |   200/  269 batches | lr 0.00000 | ms/batch 239.36 | loss  3.04 | ppl    20.98 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 65.93s | valid loss  3.79 | valid ppl    44.34 | valid bpc    5.471
-----------------------------------------------------------------------------------------
PROGRESS: 80.0%
| epoch  81 |   100/  269 batches | lr 0.00000 | ms/batch 243.46 | loss  3.08 | ppl    21.79 
| epoch  81 |   200/  269 batches | lr 0.00000 | ms/batch 240.45 | loss  3.07 | ppl    21.45 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 65.84s | valid loss  3.77 | valid ppl    43.30 | valid bpc    5.436
-----------------------------------------------------------------------------------------
PROGRESS: 81.0%
| epoch  82 |   100/  269 batches | lr 0.00000 | ms/batch 244.91 | loss  3.08 | ppl    21.66 
| epoch  82 |   200/  269 batches | lr 0.00000 | ms/batch 240.69 | loss  3.06 | ppl    21.35 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 65.89s | valid loss  3.78 | valid ppl    43.97 | valid bpc    5.458
-----------------------------------------------------------------------------------------
PROGRESS: 82.0%
| epoch  83 |   100/  269 batches | lr 0.00000 | ms/batch 249.64 | loss  3.08 | ppl    21.77 
| epoch  83 |   200/  269 batches | lr 0.00000 | ms/batch 238.95 | loss  3.06 | ppl    21.25 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 66.10s | valid loss  3.82 | valid ppl    45.53 | valid bpc    5.509
-----------------------------------------------------------------------------------------
PROGRESS: 83.0%
| epoch  84 |   100/  269 batches | lr 0.00000 | ms/batch 249.03 | loss  3.08 | ppl    21.78 
| epoch  84 |   200/  269 batches | lr 0.00000 | ms/batch 240.54 | loss  3.03 | ppl    20.59 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 66.12s | valid loss  3.72 | valid ppl    41.08 | valid bpc    5.360
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 84.0%
| epoch  85 |   100/  269 batches | lr 0.00000 | ms/batch 249.48 | loss  3.08 | ppl    21.67 
| epoch  85 |   200/  269 batches | lr 0.00000 | ms/batch 238.68 | loss  3.06 | ppl    21.28 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 66.09s | valid loss  3.78 | valid ppl    43.97 | valid bpc    5.458
-----------------------------------------------------------------------------------------
PROGRESS: 85.0%
| epoch  86 |   100/  269 batches | lr 0.00000 | ms/batch 249.38 | loss  3.08 | ppl    21.70 
| epoch  86 |   200/  269 batches | lr 0.00000 | ms/batch 239.55 | loss  3.05 | ppl    21.21 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 66.03s | valid loss  3.76 | valid ppl    43.04 | valid bpc    5.428
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  269 batches | lr 0.00000 | ms/batch 247.31 | loss  3.07 | ppl    21.54 
| epoch  87 |   200/  269 batches | lr 0.00000 | ms/batch 239.95 | loss  3.06 | ppl    21.39 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 65.94s | valid loss  3.80 | valid ppl    44.71 | valid bpc    5.482
-----------------------------------------------------------------------------------------
PROGRESS: 87.0%
| epoch  88 |   100/  269 batches | lr 0.00000 | ms/batch 247.98 | loss  3.08 | ppl    21.78 
| epoch  88 |   200/  269 batches | lr 0.00000 | ms/batch 240.83 | loss  3.04 | ppl    20.99 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 66.05s | valid loss  3.82 | valid ppl    45.56 | valid bpc    5.510
-----------------------------------------------------------------------------------------
PROGRESS: 88.0%
| epoch  89 |   100/  269 batches | lr 0.00000 | ms/batch 249.25 | loss  3.08 | ppl    21.73 
| epoch  89 |   200/  269 batches | lr 0.00000 | ms/batch 239.79 | loss  3.04 | ppl    20.81 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 66.06s | valid loss  3.79 | valid ppl    44.28 | valid bpc    5.468
-----------------------------------------------------------------------------------------
PROGRESS: 89.0%
| epoch  90 |   100/  269 batches | lr 0.00000 | ms/batch 247.75 | loss  3.08 | ppl    21.84 
| epoch  90 |   200/  269 batches | lr 0.00000 | ms/batch 240.73 | loss  3.04 | ppl    20.92 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 66.03s | valid loss  3.84 | valid ppl    46.53 | valid bpc    5.540
-----------------------------------------------------------------------------------------
PROGRESS: 90.0%
| epoch  91 |   100/  269 batches | lr 0.00000 | ms/batch 248.85 | loss  3.09 | ppl    21.92 
| epoch  91 |   200/  269 batches | lr 0.00000 | ms/batch 239.00 | loss  3.05 | ppl    21.17 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 66.10s | valid loss  3.81 | valid ppl    45.26 | valid bpc    5.500
-----------------------------------------------------------------------------------------
PROGRESS: 91.0%
| epoch  92 |   100/  269 batches | lr 0.00000 | ms/batch 248.97 | loss  3.09 | ppl    21.91 
| epoch  92 |   200/  269 batches | lr 0.00000 | ms/batch 240.73 | loss  3.04 | ppl    20.96 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 66.12s | valid loss  3.81 | valid ppl    44.96 | valid bpc    5.490
-----------------------------------------------------------------------------------------
PROGRESS: 92.0%
| epoch  93 |   100/  269 batches | lr 0.00000 | ms/batch 248.42 | loss  3.09 | ppl    21.94 
| epoch  93 |   200/  269 batches | lr 0.00000 | ms/batch 240.00 | loss  3.05 | ppl    21.07 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 65.99s | valid loss  3.81 | valid ppl    45.03 | valid bpc    5.493
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  269 batches | lr 0.00000 | ms/batch 250.40 | loss  3.08 | ppl    21.80 
| epoch  94 |   200/  269 batches | lr 0.00000 | ms/batch 238.21 | loss  3.02 | ppl    20.56 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 65.89s | valid loss  3.81 | valid ppl    45.07 | valid bpc    5.494
-----------------------------------------------------------------------------------------
PROGRESS: 94.0%
| epoch  95 |   100/  269 batches | lr 0.00000 | ms/batch 253.45 | loss  3.08 | ppl    21.77 
| epoch  95 |   200/  269 batches | lr 0.00000 | ms/batch 235.11 | loss  3.06 | ppl    21.27 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 66.05s | valid loss  3.82 | valid ppl    45.78 | valid bpc    5.517
-----------------------------------------------------------------------------------------
PROGRESS: 95.0%
| epoch  96 |   100/  269 batches | lr 0.00000 | ms/batch 254.44 | loss  3.11 | ppl    22.47 
| epoch  96 |   200/  269 batches | lr 0.00000 | ms/batch 176.19 | loss  3.04 | ppl    20.89 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 55.17s | valid loss  3.75 | valid ppl    42.56 | valid bpc    5.411
-----------------------------------------------------------------------------------------
PROGRESS: 96.0%
| epoch  97 |   100/  269 batches | lr 0.00000 | ms/batch 181.05 | loss  3.08 | ppl    21.75 
| epoch  97 |   200/  269 batches | lr 0.00000 | ms/batch 170.43 | loss  3.03 | ppl    20.79 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 46.75s | valid loss  3.83 | valid ppl    45.84 | valid bpc    5.519
-----------------------------------------------------------------------------------------
PROGRESS: 97.0%
| epoch  98 |   100/  269 batches | lr 0.00000 | ms/batch 167.92 | loss  3.09 | ppl    21.89 
| epoch  98 |   200/  269 batches | lr 0.00000 | ms/batch 160.70 | loss  3.06 | ppl    21.31 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 48.65s | valid loss  3.79 | valid ppl    44.19 | valid bpc    5.466
-----------------------------------------------------------------------------------------
PROGRESS: 98.0%
| epoch  99 |   100/  269 batches | lr 0.00000 | ms/batch 254.85 | loss  3.08 | ppl    21.73 
| epoch  99 |   200/  269 batches | lr 0.00000 | ms/batch 239.69 | loss  3.04 | ppl    20.91 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 62.55s | valid loss  3.75 | valid ppl    42.73 | valid bpc    5.417
-----------------------------------------------------------------------------------------
PROGRESS: 99.0%
| epoch 100 |   100/  269 batches | lr 0.00000 | ms/batch 180.25 | loss  3.08 | ppl    21.87 
| epoch 100 |   200/  269 batches | lr 0.00000 | ms/batch 171.68 | loss  3.04 | ppl    20.95 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 46.56s | valid loss  3.77 | valid ppl    43.27 | valid bpc    5.435
-----------------------------------------------------------------------------------------
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  3.90 | test ppl    49.33 | test bpc    5.624
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.3955, Mean Reca: 0.5527, Mean F1: 0.4574, Mean Subword_Reca: 0.6773
-----------------------------------------------------------------------------------------
=========================================================================================
Loading dataset...
Using subword tokenizer...
Number of tokens:  8000
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer_in_parser', nhid=512, nlayers=8, front_layers=3, rear_layers=5, subword='omarmomen/ptb_filtered_lowcase_bpe_tokenizer_8', n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=5555, nonmono=5, cuda=True, log_interval=100, save='trained_models/subword_structformer_in_parser_5555_35.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 37449108
Model architecture: StructFormer_In_Parser(
  (transformer_front): Transformer_Front(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(8000, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-2): 3 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
  (transformer_rear): Transformer_Rear(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(8000, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-4): 5 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (output_layer): Linear(in_features=512, out_features=8000, bias=True)
  )
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  269 batches | lr 0.00030 | ms/batch 244.38 | loss  7.74 | ppl  2289.22 
| epoch   1 |   200/  269 batches | lr 0.00030 | ms/batch 240.32 | loss  7.37 | ppl  1585.13 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 66.22s | valid loss  7.13 | valid ppl  1242.96 | valid bpc   10.280
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  269 batches | lr 0.00030 | ms/batch 236.19 | loss  7.32 | ppl  1503.08 
| epoch   2 |   200/  269 batches | lr 0.00030 | ms/batch 239.26 | loss  7.19 | ppl  1326.29 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 65.28s | valid loss  6.96 | valid ppl  1056.91 | valid bpc   10.046
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  269 batches | lr 0.00030 | ms/batch 235.02 | loss  7.12 | ppl  1238.73 
| epoch   3 |   200/  269 batches | lr 0.00030 | ms/batch 240.55 | loss  6.96 | ppl  1053.91 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 65.33s | valid loss  6.49 | valid ppl   655.89 | valid bpc    9.357
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  269 batches | lr 0.00030 | ms/batch 233.06 | loss  6.58 | ppl   718.33 
| epoch   4 |   200/  269 batches | lr 0.00030 | ms/batch 241.68 | loss  6.35 | ppl   572.95 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 65.15s | valid loss  5.89 | valid ppl   362.01 | valid bpc    8.500
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  269 batches | lr 0.00030 | ms/batch 231.18 | loss  6.08 | ppl   438.40 
| epoch   5 |   200/  269 batches | lr 0.00030 | ms/batch 240.67 | loss  5.93 | ppl   374.45 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 64.96s | valid loss  5.59 | valid ppl   268.96 | valid bpc    8.071
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  269 batches | lr 0.00030 | ms/batch 231.31 | loss  5.81 | ppl   332.07 
| epoch   6 |   200/  269 batches | lr 0.00030 | ms/batch 238.39 | loss  5.68 | ppl   293.73 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 64.77s | valid loss  5.44 | valid ppl   230.27 | valid bpc    7.847
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  269 batches | lr 0.00030 | ms/batch 236.13 | loss  5.60 | ppl   270.92 
| epoch   7 |   200/  269 batches | lr 0.00030 | ms/batch 238.99 | loss  5.49 | ppl   241.51 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 65.27s | valid loss  5.23 | valid ppl   186.31 | valid bpc    7.542
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  269 batches | lr 0.00030 | ms/batch 239.16 | loss  5.45 | ppl   233.92 
| epoch   8 |   200/  269 batches | lr 0.00030 | ms/batch 237.25 | loss  5.33 | ppl   207.40 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 65.37s | valid loss  5.16 | valid ppl   174.48 | valid bpc    7.447
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 8.0%
| epoch   9 |   100/  269 batches | lr 0.00030 | ms/batch 242.02 | loss  5.33 | ppl   206.83 
| epoch   9 |   200/  269 batches | lr 0.00030 | ms/batch 235.66 | loss  5.22 | ppl   185.40 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 65.31s | valid loss  5.04 | valid ppl   153.91 | valid bpc    7.266
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  269 batches | lr 0.00030 | ms/batch 243.49 | loss  5.17 | ppl   175.15 
| epoch  10 |   200/  269 batches | lr 0.00030 | ms/batch 231.49 | loss  5.11 | ppl   165.96 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 65.27s | valid loss  4.97 | valid ppl   144.43 | valid bpc    7.174
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  269 batches | lr 0.00030 | ms/batch 245.37 | loss  5.05 | ppl   155.43 
| epoch  11 |   200/  269 batches | lr 0.00030 | ms/batch 231.18 | loss  5.01 | ppl   149.33 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 65.39s | valid loss  4.81 | valid ppl   123.08 | valid bpc    6.943
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  269 batches | lr 0.00030 | ms/batch 245.18 | loss  4.96 | ppl   141.99 
| epoch  12 |   200/  269 batches | lr 0.00030 | ms/batch 231.22 | loss  4.91 | ppl   135.31 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 65.41s | valid loss  4.73 | valid ppl   113.23 | valid bpc    6.823
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 12.0%
| epoch  13 |   100/  269 batches | lr 0.00030 | ms/batch 244.78 | loss  4.86 | ppl   128.46 
| epoch  13 |   200/  269 batches | lr 0.00030 | ms/batch 230.49 | loss  4.80 | ppl   121.99 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 65.29s | valid loss  4.65 | valid ppl   104.33 | valid bpc    6.705
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 13.0%
| epoch  14 |   100/  269 batches | lr 0.00030 | ms/batch 244.58 | loss  4.78 | ppl   119.62 
| epoch  14 |   200/  269 batches | lr 0.00030 | ms/batch 233.92 | loss  4.69 | ppl   108.81 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 65.73s | valid loss  4.59 | valid ppl    98.06 | valid bpc    6.616
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  269 batches | lr 0.00030 | ms/batch 244.38 | loss  4.67 | ppl   107.23 
| epoch  15 |   200/  269 batches | lr 0.00030 | ms/batch 230.82 | loss  4.62 | ppl   101.98 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 65.30s | valid loss  4.56 | valid ppl    95.40 | valid bpc    6.576
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 15.0%
| epoch  16 |   100/  269 batches | lr 0.00030 | ms/batch 245.73 | loss  4.58 | ppl    97.95 
| epoch  16 |   200/  269 batches | lr 0.00030 | ms/batch 229.70 | loss  4.54 | ppl    93.78 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 65.33s | valid loss  4.45 | valid ppl    85.41 | valid bpc    6.416
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 16.0%
| epoch  17 |   100/  269 batches | lr 0.00030 | ms/batch 247.96 | loss  4.51 | ppl    91.07 
| epoch  17 |   200/  269 batches | lr 0.00030 | ms/batch 230.51 | loss  4.47 | ppl    87.26 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 65.69s | valid loss  4.43 | valid ppl    83.93 | valid bpc    6.391
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 17.0%
| epoch  18 |   100/  269 batches | lr 0.00030 | ms/batch 244.25 | loss  4.45 | ppl    85.75 
| epoch  18 |   200/  269 batches | lr 0.00030 | ms/batch 230.17 | loss  4.38 | ppl    79.82 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 65.38s | valid loss  4.42 | valid ppl    82.68 | valid bpc    6.370
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 18.0%
| epoch  19 |   100/  269 batches | lr 0.00030 | ms/batch 244.38 | loss  4.36 | ppl    78.12 
| epoch  19 |   200/  269 batches | lr 0.00030 | ms/batch 230.12 | loss  4.36 | ppl    78.03 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 65.25s | valid loss  4.30 | valid ppl    73.86 | valid bpc    6.207
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 19.0%
| epoch  20 |   100/  269 batches | lr 0.00030 | ms/batch 245.05 | loss  4.30 | ppl    73.53 
| epoch  20 |   200/  269 batches | lr 0.00030 | ms/batch 231.59 | loss  4.27 | ppl    71.45 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 65.31s | valid loss  4.29 | valid ppl    72.90 | valid bpc    6.188
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 20.0%
| epoch  21 |   100/  269 batches | lr 0.00030 | ms/batch 245.10 | loss  4.24 | ppl    69.41 
| epoch  21 |   200/  269 batches | lr 0.00030 | ms/batch 233.16 | loss  4.20 | ppl    66.97 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 65.62s | valid loss  4.23 | valid ppl    68.40 | valid bpc    6.096
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 21.0%
| epoch  22 |   100/  269 batches | lr 0.00030 | ms/batch 244.08 | loss  4.19 | ppl    65.76 
| epoch  22 |   200/  269 batches | lr 0.00030 | ms/batch 232.07 | loss  4.13 | ppl    62.26 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 65.35s | valid loss  4.20 | valid ppl    66.67 | valid bpc    6.059
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 22.0%
| epoch  23 |   100/  269 batches | lr 0.00030 | ms/batch 245.07 | loss  4.11 | ppl    61.04 
| epoch  23 |   200/  269 batches | lr 0.00030 | ms/batch 233.45 | loss  4.06 | ppl    57.91 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 65.61s | valid loss  4.15 | valid ppl    63.60 | valid bpc    5.991
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 23.0%
| epoch  24 |   100/  269 batches | lr 0.00030 | ms/batch 245.26 | loss  4.05 | ppl    57.68 
| epoch  24 |   200/  269 batches | lr 0.00030 | ms/batch 233.70 | loss  4.01 | ppl    55.19 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 65.66s | valid loss  4.17 | valid ppl    64.41 | valid bpc    6.009
-----------------------------------------------------------------------------------------
PROGRESS: 24.0%
| epoch  25 |   100/  269 batches | lr 0.00030 | ms/batch 249.51 | loss  4.03 | ppl    56.09 
| epoch  25 |   200/  269 batches | lr 0.00030 | ms/batch 233.77 | loss  3.96 | ppl    52.25 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 66.06s | valid loss  4.14 | valid ppl    62.91 | valid bpc    5.975
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 25.0%
| epoch  26 |   100/  269 batches | lr 0.00030 | ms/batch 244.69 | loss  3.97 | ppl    52.93 
| epoch  26 |   200/  269 batches | lr 0.00030 | ms/batch 229.91 | loss  3.92 | ppl    50.19 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 65.28s | valid loss  4.04 | valid ppl    56.78 | valid bpc    5.827
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 26.0%
| epoch  27 |   100/  269 batches | lr 0.00030 | ms/batch 245.24 | loss  3.89 | ppl    48.88 
| epoch  27 |   200/  269 batches | lr 0.00030 | ms/batch 233.07 | loss  3.87 | ppl    48.16 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 65.71s | valid loss  4.12 | valid ppl    61.52 | valid bpc    5.943
-----------------------------------------------------------------------------------------
PROGRESS: 27.0%
| epoch  28 |   100/  269 batches | lr 0.00030 | ms/batch 245.60 | loss  3.87 | ppl    47.75 
| epoch  28 |   200/  269 batches | lr 0.00030 | ms/batch 234.35 | loss  3.81 | ppl    44.94 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 65.71s | valid loss  4.04 | valid ppl    57.01 | valid bpc    5.833
-----------------------------------------------------------------------------------------
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  269 batches | lr 0.00030 | ms/batch 245.52 | loss  3.82 | ppl    45.79 
| epoch  29 |   200/  269 batches | lr 0.00030 | ms/batch 230.00 | loss  3.78 | ppl    43.74 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 65.32s | valid loss  4.07 | valid ppl    58.55 | valid bpc    5.872
-----------------------------------------------------------------------------------------
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  269 batches | lr 0.00015 | ms/batch 248.17 | loss  3.72 | ppl    41.35 
| epoch  30 |   200/  269 batches | lr 0.00015 | ms/batch 229.69 | loss  3.67 | ppl    39.38 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 65.56s | valid loss  3.92 | valid ppl    50.27 | valid bpc    5.652
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 30.0%
| epoch  31 |   100/  269 batches | lr 0.00015 | ms/batch 247.04 | loss  3.64 | ppl    38.06 
| epoch  31 |   200/  269 batches | lr 0.00015 | ms/batch 235.14 | loss  3.62 | ppl    37.39 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 66.04s | valid loss  3.89 | valid ppl    48.72 | valid bpc    5.607
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 31.0%
| epoch  32 |   100/  269 batches | lr 0.00015 | ms/batch 248.46 | loss  3.61 | ppl    36.91 
| epoch  32 |   200/  269 batches | lr 0.00015 | ms/batch 231.00 | loss  3.58 | ppl    35.81 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 65.70s | valid loss  3.89 | valid ppl    48.98 | valid bpc    5.614
-----------------------------------------------------------------------------------------
PROGRESS: 32.0%
| epoch  33 |   100/  269 batches | lr 0.00015 | ms/batch 245.54 | loss  3.58 | ppl    35.72 
| epoch  33 |   200/  269 batches | lr 0.00015 | ms/batch 234.00 | loss  3.56 | ppl    35.11 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 65.68s | valid loss  3.93 | valid ppl    51.08 | valid bpc    5.675
-----------------------------------------------------------------------------------------
PROGRESS: 33.0%
| epoch  34 |   100/  269 batches | lr 0.00015 | ms/batch 244.35 | loss  3.57 | ppl    35.41 
| epoch  34 |   200/  269 batches | lr 0.00015 | ms/batch 232.73 | loss  3.52 | ppl    33.82 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 65.69s | valid loss  3.88 | valid ppl    48.45 | valid bpc    5.598
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 34.0%
| epoch  35 |   100/  269 batches | lr 0.00015 | ms/batch 243.87 | loss  3.52 | ppl    33.67 
| epoch  35 |   200/  269 batches | lr 0.00015 | ms/batch 234.33 | loss  3.51 | ppl    33.53 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 65.58s | valid loss  3.88 | valid ppl    48.32 | valid bpc    5.595
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 35.0%
| epoch  36 |   100/  269 batches | lr 0.00015 | ms/batch 249.43 | loss  3.48 | ppl    32.50 
| epoch  36 |   200/  269 batches | lr 0.00015 | ms/batch 234.35 | loss  3.47 | ppl    32.22 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 66.07s | valid loss  3.89 | valid ppl    48.68 | valid bpc    5.605
-----------------------------------------------------------------------------------------
PROGRESS: 36.0%
| epoch  37 |   100/  269 batches | lr 0.00015 | ms/batch 249.95 | loss  3.46 | ppl    31.91 
| epoch  37 |   200/  269 batches | lr 0.00015 | ms/batch 233.32 | loss  3.45 | ppl    31.41 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 65.99s | valid loss  3.87 | valid ppl    47.74 | valid bpc    5.577
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 37.0%
| epoch  38 |   100/  269 batches | lr 0.00015 | ms/batch 247.89 | loss  3.46 | ppl    31.73 
| epoch  38 |   200/  269 batches | lr 0.00015 | ms/batch 233.67 | loss  3.43 | ppl    30.79 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 65.92s | valid loss  3.87 | valid ppl    47.84 | valid bpc    5.580
-----------------------------------------------------------------------------------------
PROGRESS: 38.0%
| epoch  39 |   100/  269 batches | lr 0.00015 | ms/batch 243.73 | loss  3.42 | ppl    30.65 
| epoch  39 |   200/  269 batches | lr 0.00015 | ms/batch 234.08 | loss  3.42 | ppl    30.46 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 65.71s | valid loss  3.83 | valid ppl    46.13 | valid bpc    5.528
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 39.0%
| epoch  40 |   100/  269 batches | lr 0.00015 | ms/batch 243.50 | loss  3.40 | ppl    29.99 
| epoch  40 |   200/  269 batches | lr 0.00015 | ms/batch 235.11 | loss  3.39 | ppl    29.81 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 65.64s | valid loss  3.83 | valid ppl    46.09 | valid bpc    5.526
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 40.0%
| epoch  41 |   100/  269 batches | lr 0.00015 | ms/batch 242.73 | loss  3.40 | ppl    30.05 
| epoch  41 |   200/  269 batches | lr 0.00015 | ms/batch 234.41 | loss  3.37 | ppl    29.07 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 65.46s | valid loss  3.80 | valid ppl    44.83 | valid bpc    5.487
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 41.0%
| epoch  42 |   100/  269 batches | lr 0.00015 | ms/batch 242.30 | loss  3.36 | ppl    28.79 
| epoch  42 |   200/  269 batches | lr 0.00015 | ms/batch 235.54 | loss  3.35 | ppl    28.56 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 65.48s | valid loss  3.84 | valid ppl    46.52 | valid bpc    5.540
-----------------------------------------------------------------------------------------
PROGRESS: 42.0%
| epoch  43 |   100/  269 batches | lr 0.00015 | ms/batch 247.91 | loss  3.36 | ppl    28.66 
| epoch  43 |   200/  269 batches | lr 0.00015 | ms/batch 233.51 | loss  3.30 | ppl    27.08 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 65.87s | valid loss  3.82 | valid ppl    45.66 | valid bpc    5.513
-----------------------------------------------------------------------------------------
PROGRESS: 43.0%
| epoch  44 |   100/  269 batches | lr 0.00015 | ms/batch 248.30 | loss  3.30 | ppl    27.07 
| epoch  44 |   200/  269 batches | lr 0.00015 | ms/batch 234.96 | loss  3.30 | ppl    26.98 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 65.62s | valid loss  3.87 | valid ppl    47.84 | valid bpc    5.580
-----------------------------------------------------------------------------------------
PROGRESS: 44.0%
| epoch  45 |   100/  269 batches | lr 0.00007 | ms/batch 241.83 | loss  3.28 | ppl    26.58 
| epoch  45 |   200/  269 batches | lr 0.00007 | ms/batch 239.05 | loss  3.23 | ppl    25.24 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 65.43s | valid loss  3.85 | valid ppl    47.01 | valid bpc    5.555
-----------------------------------------------------------------------------------------
PROGRESS: 45.0%
| epoch  46 |   100/  269 batches | lr 0.00007 | ms/batch 245.48 | loss  3.25 | ppl    25.88 
| epoch  46 |   200/  269 batches | lr 0.00007 | ms/batch 239.90 | loss  3.22 | ppl    25.07 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 65.71s | valid loss  3.78 | valid ppl    43.74 | valid bpc    5.451
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 46.0%
| epoch  47 |   100/  269 batches | lr 0.00007 | ms/batch 248.79 | loss  3.21 | ppl    24.67 
| epoch  47 |   200/  269 batches | lr 0.00007 | ms/batch 238.98 | loss  3.20 | ppl    24.61 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 66.01s | valid loss  3.82 | valid ppl    45.48 | valid bpc    5.507
-----------------------------------------------------------------------------------------
PROGRESS: 47.0%
| epoch  48 |   100/  269 batches | lr 0.00007 | ms/batch 247.80 | loss  3.21 | ppl    24.85 
| epoch  48 |   200/  269 batches | lr 0.00007 | ms/batch 240.64 | loss  3.18 | ppl    24.01 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 65.97s | valid loss  3.77 | valid ppl    43.19 | valid bpc    5.433
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 48.0%
| epoch  49 |   100/  269 batches | lr 0.00007 | ms/batch 248.65 | loss  3.19 | ppl    24.31 
| epoch  49 |   200/  269 batches | lr 0.00007 | ms/batch 239.75 | loss  3.19 | ppl    24.30 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 65.86s | valid loss  3.80 | valid ppl    44.75 | valid bpc    5.484
-----------------------------------------------------------------------------------------
PROGRESS: 49.0%
| epoch  50 |   100/  269 batches | lr 0.00007 | ms/batch 250.28 | loss  3.17 | ppl    23.90 
| epoch  50 |   200/  269 batches | lr 0.00007 | ms/batch 239.95 | loss  3.15 | ppl    23.35 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 65.88s | valid loss  3.84 | valid ppl    46.55 | valid bpc    5.541
-----------------------------------------------------------------------------------------
PROGRESS: 50.0%
| epoch  51 |   100/  269 batches | lr 0.00007 | ms/batch 253.18 | loss  3.18 | ppl    23.94 
| epoch  51 |   200/  269 batches | lr 0.00007 | ms/batch 239.16 | loss  3.15 | ppl    23.31 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 65.88s | valid loss  3.81 | valid ppl    45.28 | valid bpc    5.501
-----------------------------------------------------------------------------------------
PROGRESS: 51.0%
| epoch  52 |   100/  269 batches | lr 0.00004 | ms/batch 254.87 | loss  3.15 | ppl    23.42 
| epoch  52 |   200/  269 batches | lr 0.00004 | ms/batch 239.31 | loss  3.13 | ppl    22.94 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 65.85s | valid loss  3.80 | valid ppl    44.60 | valid bpc    5.479
-----------------------------------------------------------------------------------------
PROGRESS: 52.0%
| epoch  53 |   100/  269 batches | lr 0.00004 | ms/batch 254.23 | loss  3.14 | ppl    23.10 
| epoch  53 |   200/  269 batches | lr 0.00004 | ms/batch 239.55 | loss  3.09 | ppl    21.94 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 65.90s | valid loss  3.78 | valid ppl    43.89 | valid bpc    5.456
-----------------------------------------------------------------------------------------
PROGRESS: 53.0%
| epoch  54 |   100/  269 batches | lr 0.00004 | ms/batch 252.74 | loss  3.13 | ppl    22.79 
| epoch  54 |   200/  269 batches | lr 0.00004 | ms/batch 239.62 | loss  3.10 | ppl    22.15 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 65.81s | valid loss  3.78 | valid ppl    43.86 | valid bpc    5.455
-----------------------------------------------------------------------------------------
PROGRESS: 54.0%
| epoch  55 |   100/  269 batches | lr 0.00002 | ms/batch 254.21 | loss  3.12 | ppl    22.58 
| epoch  55 |   200/  269 batches | lr 0.00002 | ms/batch 238.41 | loss  3.07 | ppl    21.64 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 65.82s | valid loss  3.79 | valid ppl    44.38 | valid bpc    5.472
-----------------------------------------------------------------------------------------
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  269 batches | lr 0.00002 | ms/batch 253.61 | loss  3.10 | ppl    22.23 
| epoch  56 |   200/  269 batches | lr 0.00002 | ms/batch 239.51 | loss  3.07 | ppl    21.52 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 65.91s | valid loss  3.75 | valid ppl    42.38 | valid bpc    5.405
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  269 batches | lr 0.00002 | ms/batch 254.35 | loss  3.10 | ppl    22.29 
| epoch  57 |   200/  269 batches | lr 0.00002 | ms/batch 239.16 | loss  3.05 | ppl    21.16 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 65.94s | valid loss  3.76 | valid ppl    42.85 | valid bpc    5.421
-----------------------------------------------------------------------------------------
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  269 batches | lr 0.00002 | ms/batch 255.50 | loss  3.08 | ppl    21.78 
| epoch  58 |   200/  269 batches | lr 0.00002 | ms/batch 239.57 | loss  3.05 | ppl    21.08 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 66.00s | valid loss  3.80 | valid ppl    44.58 | valid bpc    5.478
-----------------------------------------------------------------------------------------
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  269 batches | lr 0.00002 | ms/batch 253.05 | loss  3.09 | ppl    22.04 
| epoch  59 |   200/  269 batches | lr 0.00002 | ms/batch 240.96 | loss  3.06 | ppl    21.28 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 65.99s | valid loss  3.73 | valid ppl    41.87 | valid bpc    5.388
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 59.0%
| epoch  60 |   100/  269 batches | lr 0.00002 | ms/batch 253.04 | loss  3.09 | ppl    21.99 
| epoch  60 |   200/  269 batches | lr 0.00002 | ms/batch 239.62 | loss  3.04 | ppl    20.83 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 65.96s | valid loss  3.75 | valid ppl    42.55 | valid bpc    5.411
-----------------------------------------------------------------------------------------
PROGRESS: 60.0%
| epoch  61 |   100/  269 batches | lr 0.00002 | ms/batch 255.53 | loss  3.08 | ppl    21.85 
| epoch  61 |   200/  269 batches | lr 0.00002 | ms/batch 239.05 | loss  3.03 | ppl    20.76 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 66.00s | valid loss  3.72 | valid ppl    41.07 | valid bpc    5.360
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 61.0%
| epoch  62 |   100/  269 batches | lr 0.00002 | ms/batch 254.13 | loss  3.08 | ppl    21.71 
| epoch  62 |   200/  269 batches | lr 0.00002 | ms/batch 238.71 | loss  3.04 | ppl    20.91 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 65.94s | valid loss  3.78 | valid ppl    43.85 | valid bpc    5.455
-----------------------------------------------------------------------------------------
PROGRESS: 62.0%
| epoch  63 |   100/  269 batches | lr 0.00002 | ms/batch 253.63 | loss  3.09 | ppl    21.98 
| epoch  63 |   200/  269 batches | lr 0.00002 | ms/batch 240.78 | loss  3.05 | ppl    21.08 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 66.04s | valid loss  3.72 | valid ppl    41.32 | valid bpc    5.369
-----------------------------------------------------------------------------------------
PROGRESS: 63.0%
| epoch  64 |   100/  269 batches | lr 0.00002 | ms/batch 253.69 | loss  3.06 | ppl    21.32 
| epoch  64 |   200/  269 batches | lr 0.00002 | ms/batch 239.59 | loss  3.06 | ppl    21.25 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 66.00s | valid loss  3.75 | valid ppl    42.63 | valid bpc    5.414
-----------------------------------------------------------------------------------------
PROGRESS: 64.0%
| epoch  65 |   100/  269 batches | lr 0.00001 | ms/batch 256.01 | loss  3.04 | ppl    20.99 
| epoch  65 |   200/  269 batches | lr 0.00001 | ms/batch 239.38 | loss  3.04 | ppl    20.93 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 66.01s | valid loss  3.80 | valid ppl    44.89 | valid bpc    5.488
-----------------------------------------------------------------------------------------
PROGRESS: 65.0%
| epoch  66 |   100/  269 batches | lr 0.00001 | ms/batch 254.22 | loss  3.06 | ppl    21.33 
| epoch  66 |   200/  269 batches | lr 0.00001 | ms/batch 239.38 | loss  3.05 | ppl    21.04 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 66.00s | valid loss  3.75 | valid ppl    42.52 | valid bpc    5.410
-----------------------------------------------------------------------------------------
PROGRESS: 66.0%
| epoch  67 |   100/  269 batches | lr 0.00001 | ms/batch 255.09 | loss  3.06 | ppl    21.34 
| epoch  67 |   200/  269 batches | lr 0.00001 | ms/batch 239.27 | loss  3.03 | ppl    20.68 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 66.03s | valid loss  3.79 | valid ppl    44.06 | valid bpc    5.461
-----------------------------------------------------------------------------------------
PROGRESS: 67.0%
| epoch  68 |   100/  269 batches | lr 0.00000 | ms/batch 254.41 | loss  3.06 | ppl    21.29 
| epoch  68 |   200/  269 batches | lr 0.00000 | ms/batch 238.30 | loss  3.01 | ppl    20.34 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 66.00s | valid loss  3.77 | valid ppl    43.47 | valid bpc    5.442
-----------------------------------------------------------------------------------------
PROGRESS: 68.0%
| epoch  69 |   100/  269 batches | lr 0.00000 | ms/batch 254.59 | loss  3.05 | ppl    21.08 
| epoch  69 |   200/  269 batches | lr 0.00000 | ms/batch 239.18 | loss  3.04 | ppl    20.93 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 66.06s | valid loss  3.77 | valid ppl    43.39 | valid bpc    5.439
-----------------------------------------------------------------------------------------
PROGRESS: 69.0%
| epoch  70 |   100/  269 batches | lr 0.00000 | ms/batch 252.48 | loss  3.06 | ppl    21.25 
| epoch  70 |   200/  269 batches | lr 0.00000 | ms/batch 240.09 | loss  3.01 | ppl    20.37 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 66.33s | valid loss  3.76 | valid ppl    42.81 | valid bpc    5.420
-----------------------------------------------------------------------------------------
PROGRESS: 70.0%
| epoch  71 |   100/  269 batches | lr 0.00000 | ms/batch 250.30 | loss  3.05 | ppl    21.15 
| epoch  71 |   200/  269 batches | lr 0.00000 | ms/batch 241.35 | loss  3.02 | ppl    20.39 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 66.19s | valid loss  3.75 | valid ppl    42.35 | valid bpc    5.404
-----------------------------------------------------------------------------------------
PROGRESS: 71.0%
| epoch  72 |   100/  269 batches | lr 0.00000 | ms/batch 247.79 | loss  3.02 | ppl    20.47 
| epoch  72 |   200/  269 batches | lr 0.00000 | ms/batch 241.39 | loss  3.01 | ppl    20.21 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 65.97s | valid loss  3.79 | valid ppl    44.44 | valid bpc    5.474
-----------------------------------------------------------------------------------------
PROGRESS: 72.0%
| epoch  73 |   100/  269 batches | lr 0.00000 | ms/batch 244.55 | loss  3.04 | ppl    20.86 
| epoch  73 |   200/  269 batches | lr 0.00000 | ms/batch 239.38 | loss  3.02 | ppl    20.39 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 65.65s | valid loss  3.74 | valid ppl    42.14 | valid bpc    5.397
-----------------------------------------------------------------------------------------
PROGRESS: 73.0%
| epoch  74 |   100/  269 batches | lr 0.00000 | ms/batch 248.92 | loss  3.06 | ppl    21.35 
| epoch  74 |   200/  269 batches | lr 0.00000 | ms/batch 240.27 | loss  3.02 | ppl    20.48 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 66.01s | valid loss  3.69 | valid ppl    39.94 | valid bpc    5.320
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 74.0%
| epoch  75 |   100/  269 batches | lr 0.00000 | ms/batch 247.79 | loss  3.05 | ppl    21.13 
| epoch  75 |   200/  269 batches | lr 0.00000 | ms/batch 240.41 | loss  3.02 | ppl    20.41 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 66.10s | valid loss  3.75 | valid ppl    42.49 | valid bpc    5.409
-----------------------------------------------------------------------------------------
PROGRESS: 75.0%
| epoch  76 |   100/  269 batches | lr 0.00000 | ms/batch 249.52 | loss  3.04 | ppl    20.86 
| epoch  76 |   200/  269 batches | lr 0.00000 | ms/batch 237.59 | loss  3.00 | ppl    20.01 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 65.96s | valid loss  3.77 | valid ppl    43.21 | valid bpc    5.433
-----------------------------------------------------------------------------------------
PROGRESS: 76.0%
| epoch  77 |   100/  269 batches | lr 0.00000 | ms/batch 248.77 | loss  3.04 | ppl    20.99 
| epoch  77 |   200/  269 batches | lr 0.00000 | ms/batch 236.95 | loss  3.01 | ppl    20.24 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 65.94s | valid loss  3.78 | valid ppl    43.71 | valid bpc    5.450
-----------------------------------------------------------------------------------------
PROGRESS: 77.0%
| epoch  78 |   100/  269 batches | lr 0.00000 | ms/batch 249.35 | loss  3.05 | ppl    21.11 
| epoch  78 |   200/  269 batches | lr 0.00000 | ms/batch 235.54 | loss  3.03 | ppl    20.60 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 65.99s | valid loss  3.71 | valid ppl    40.92 | valid bpc    5.355
-----------------------------------------------------------------------------------------
PROGRESS: 78.0%
| epoch  79 |   100/  269 batches | lr 0.00000 | ms/batch 250.00 | loss  3.06 | ppl    21.37 
| epoch  79 |   200/  269 batches | lr 0.00000 | ms/batch 233.11 | loss  3.00 | ppl    20.14 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 65.65s | valid loss  3.74 | valid ppl    41.93 | valid bpc    5.390
-----------------------------------------------------------------------------------------
PROGRESS: 79.0%
| epoch  80 |   100/  269 batches | lr 0.00000 | ms/batch 248.59 | loss  3.04 | ppl    20.90 
| epoch  80 |   200/  269 batches | lr 0.00000 | ms/batch 235.97 | loss  3.02 | ppl    20.48 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 65.98s | valid loss  3.81 | valid ppl    45.21 | valid bpc    5.499
-----------------------------------------------------------------------------------------
PROGRESS: 80.0%
| epoch  81 |   100/  269 batches | lr 0.00000 | ms/batch 247.63 | loss  3.04 | ppl    20.96 
| epoch  81 |   200/  269 batches | lr 0.00000 | ms/batch 234.74 | loss  3.02 | ppl    20.52 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 66.00s | valid loss  3.75 | valid ppl    42.54 | valid bpc    5.411
-----------------------------------------------------------------------------------------
PROGRESS: 81.0%
| epoch  82 |   100/  269 batches | lr 0.00000 | ms/batch 247.83 | loss  3.04 | ppl    20.82 
| epoch  82 |   200/  269 batches | lr 0.00000 | ms/batch 234.10 | loss  3.02 | ppl    20.45 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 65.99s | valid loss  3.79 | valid ppl    44.40 | valid bpc    5.472
-----------------------------------------------------------------------------------------
PROGRESS: 82.0%
| epoch  83 |   100/  269 batches | lr 0.00000 | ms/batch 249.15 | loss  3.04 | ppl    20.89 
| epoch  83 |   200/  269 batches | lr 0.00000 | ms/batch 232.96 | loss  3.02 | ppl    20.54 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 66.01s | valid loss  3.73 | valid ppl    41.88 | valid bpc    5.388
-----------------------------------------------------------------------------------------
PROGRESS: 83.0%
| epoch  84 |   100/  269 batches | lr 0.00000 | ms/batch 249.49 | loss  3.03 | ppl    20.75 
| epoch  84 |   200/  269 batches | lr 0.00000 | ms/batch 233.37 | loss  3.00 | ppl    20.19 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 66.04s | valid loss  3.80 | valid ppl    44.59 | valid bpc    5.479
-----------------------------------------------------------------------------------------
PROGRESS: 84.0%
| epoch  85 |   100/  269 batches | lr 0.00000 | ms/batch 248.62 | loss  3.05 | ppl    21.03 
| epoch  85 |   200/  269 batches | lr 0.00000 | ms/batch 235.14 | loss  3.00 | ppl    20.17 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 66.10s | valid loss  3.80 | valid ppl    44.54 | valid bpc    5.477
-----------------------------------------------------------------------------------------
PROGRESS: 85.0%
| epoch  86 |   100/  269 batches | lr 0.00000 | ms/batch 248.88 | loss  3.03 | ppl    20.76 
| epoch  86 |   200/  269 batches | lr 0.00000 | ms/batch 234.10 | loss  3.00 | ppl    20.17 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 65.98s | valid loss  3.78 | valid ppl    43.68 | valid bpc    5.449
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  269 batches | lr 0.00000 | ms/batch 247.86 | loss  3.03 | ppl    20.64 
| epoch  87 |   200/  269 batches | lr 0.00000 | ms/batch 233.74 | loss  3.03 | ppl    20.72 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 65.99s | valid loss  3.79 | valid ppl    44.10 | valid bpc    5.463
-----------------------------------------------------------------------------------------
PROGRESS: 87.0%
| epoch  88 |   100/  269 batches | lr 0.00000 | ms/batch 250.72 | loss  3.04 | ppl    20.95 
| epoch  88 |   200/  269 batches | lr 0.00000 | ms/batch 233.02 | loss  3.03 | ppl    20.67 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 66.09s | valid loss  3.80 | valid ppl    44.91 | valid bpc    5.489
-----------------------------------------------------------------------------------------
PROGRESS: 88.0%
| epoch  89 |   100/  269 batches | lr 0.00000 | ms/batch 248.38 | loss  3.04 | ppl    20.93 
| epoch  89 |   200/  269 batches | lr 0.00000 | ms/batch 234.31 | loss  3.00 | ppl    20.12 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 66.09s | valid loss  3.82 | valid ppl    45.56 | valid bpc    5.510
-----------------------------------------------------------------------------------------
PROGRESS: 89.0%
| epoch  90 |   100/  269 batches | lr 0.00000 | ms/batch 247.45 | loss  3.05 | ppl    21.16 
| epoch  90 |   200/  269 batches | lr 0.00000 | ms/batch 234.89 | loss  2.98 | ppl    19.65 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 66.07s | valid loss  3.77 | valid ppl    43.43 | valid bpc    5.441
-----------------------------------------------------------------------------------------
PROGRESS: 90.0%
| epoch  91 |   100/  269 batches | lr 0.00000 | ms/batch 247.77 | loss  3.03 | ppl    20.73 
| epoch  91 |   200/  269 batches | lr 0.00000 | ms/batch 234.00 | loss  3.02 | ppl    20.44 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 65.98s | valid loss  3.72 | valid ppl    41.06 | valid bpc    5.360
-----------------------------------------------------------------------------------------
PROGRESS: 91.0%
| epoch  92 |   100/  269 batches | lr 0.00000 | ms/batch 249.11 | loss  3.04 | ppl    20.92 
| epoch  92 |   200/  269 batches | lr 0.00000 | ms/batch 233.87 | loss  3.04 | ppl    20.87 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 66.11s | valid loss  3.76 | valid ppl    43.11 | valid bpc    5.430
-----------------------------------------------------------------------------------------
PROGRESS: 92.0%
| epoch  93 |   100/  269 batches | lr 0.00000 | ms/batch 247.74 | loss  3.04 | ppl    20.81 
| epoch  93 |   200/  269 batches | lr 0.00000 | ms/batch 234.84 | loss  3.02 | ppl    20.51 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 66.00s | valid loss  3.73 | valid ppl    41.63 | valid bpc    5.380
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  269 batches | lr 0.00000 | ms/batch 249.95 | loss  3.04 | ppl    20.97 
| epoch  94 |   200/  269 batches | lr 0.00000 | ms/batch 233.70 | loss  3.03 | ppl    20.67 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 66.04s | valid loss  3.68 | valid ppl    39.63 | valid bpc    5.309
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 94.0%
| epoch  95 |   100/  269 batches | lr 0.00000 | ms/batch 248.00 | loss  3.04 | ppl    20.91 
| epoch  95 |   200/  269 batches | lr 0.00000 | ms/batch 234.92 | loss  3.03 | ppl    20.61 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 66.03s | valid loss  3.77 | valid ppl    43.54 | valid bpc    5.444
-----------------------------------------------------------------------------------------
PROGRESS: 95.0%
| epoch  96 |   100/  269 batches | lr 0.00000 | ms/batch 248.08 | loss  3.05 | ppl    21.07 
| epoch  96 |   200/  269 batches | lr 0.00000 | ms/batch 234.82 | loss  3.02 | ppl    20.54 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 66.08s | valid loss  3.71 | valid ppl    40.87 | valid bpc    5.353
-----------------------------------------------------------------------------------------
PROGRESS: 96.0%
| epoch  97 |   100/  269 batches | lr 0.00000 | ms/batch 248.29 | loss  3.03 | ppl    20.69 
| epoch  97 |   200/  269 batches | lr 0.00000 | ms/batch 165.27 | loss  3.01 | ppl    20.27 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 54.14s | valid loss  3.76 | valid ppl    42.77 | valid bpc    5.418
-----------------------------------------------------------------------------------------
PROGRESS: 97.0%
| epoch  98 |   100/  269 batches | lr 0.00000 | ms/batch 178.47 | loss  3.03 | ppl    20.64 
| epoch  98 |   200/  269 batches | lr 0.00000 | ms/batch 165.74 | loss  3.00 | ppl    20.15 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 46.51s | valid loss  3.77 | valid ppl    43.54 | valid bpc    5.444
-----------------------------------------------------------------------------------------
PROGRESS: 98.0%
| epoch  99 |   100/  269 batches | lr 0.00000 | ms/batch 167.90 | loss  3.05 | ppl    21.05 
| epoch  99 |   200/  269 batches | lr 0.00000 | ms/batch 123.89 | loss  3.01 | ppl    20.25 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 39.28s | valid loss  3.78 | valid ppl    43.67 | valid bpc    5.449
-----------------------------------------------------------------------------------------
PROGRESS: 99.0%
| epoch 100 |   100/  269 batches | lr 0.00000 | ms/batch 179.27 | loss  3.04 | ppl    20.98 
| epoch 100 |   200/  269 batches | lr 0.00000 | ms/batch 170.88 | loss  3.02 | ppl    20.46 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 46.46s | valid loss  3.74 | valid ppl    42.21 | valid bpc    5.400
-----------------------------------------------------------------------------------------
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  3.83 | test ppl    45.95 | test bpc    5.522
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.4814, Mean Reca: 0.6758, Mean F1: 0.5579, Mean Subword_Reca: 0.8493
-----------------------------------------------------------------------------------------
=========================================================================================
Loading dataset...
Using subword tokenizer...
Number of tokens:  8000
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer_in_parser', nhid=512, nlayers=8, front_layers=4, rear_layers=4, subword='omarmomen/ptb_filtered_lowcase_bpe_tokenizer_8', n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=1111, nonmono=5, cuda=True, log_interval=100, save='trained_models/subword_structformer_in_parser_1111_44.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 37449092
Model architecture: StructFormer_In_Parser(
  (transformer_front): Transformer_Front(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(8000, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-3): 4 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
  (transformer_rear): Transformer_Rear(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(8000, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-3): 4 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (output_layer): Linear(in_features=512, out_features=8000, bias=True)
  )
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  269 batches | lr 0.00030 | ms/batch 252.10 | loss  7.77 | ppl  2362.56 
| epoch   1 |   200/  269 batches | lr 0.00030 | ms/batch 231.83 | loss  7.36 | ppl  1577.74 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 66.12s | valid loss  7.07 | valid ppl  1179.45 | valid bpc   10.204
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  269 batches | lr 0.00030 | ms/batch 244.91 | loss  7.29 | ppl  1470.56 
| epoch   2 |   200/  269 batches | lr 0.00030 | ms/batch 230.74 | loss  7.17 | ppl  1303.01 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 65.26s | valid loss  6.94 | valid ppl  1034.97 | valid bpc   10.015
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  269 batches | lr 0.00030 | ms/batch 244.07 | loss  7.16 | ppl  1281.26 
| epoch   3 |   200/  269 batches | lr 0.00030 | ms/batch 230.80 | loss  7.05 | ppl  1157.34 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 65.22s | valid loss  6.77 | valid ppl   872.23 | valid bpc    9.769
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  269 batches | lr 0.00030 | ms/batch 244.15 | loss  6.82 | ppl   914.32 
| epoch   4 |   200/  269 batches | lr 0.00030 | ms/batch 231.14 | loss  6.51 | ppl   668.79 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 65.29s | valid loss  6.07 | valid ppl   430.54 | valid bpc    8.750
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  269 batches | lr 0.00030 | ms/batch 244.44 | loss  6.20 | ppl   491.62 
| epoch   5 |   200/  269 batches | lr 0.00030 | ms/batch 229.86 | loss  5.99 | ppl   401.11 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 65.15s | valid loss  5.69 | valid ppl   297.34 | valid bpc    8.216
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  269 batches | lr 0.00030 | ms/batch 249.97 | loss  5.86 | ppl   350.01 
| epoch   6 |   200/  269 batches | lr 0.00030 | ms/batch 229.83 | loss  5.72 | ppl   306.07 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 64.95s | valid loss  5.47 | valid ppl   237.64 | valid bpc    7.893
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  269 batches | lr 0.00030 | ms/batch 254.27 | loss  5.65 | ppl   283.82 
| epoch   7 |   200/  269 batches | lr 0.00030 | ms/batch 230.38 | loss  5.52 | ppl   250.41 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 65.24s | valid loss  5.32 | valid ppl   204.09 | valid bpc    7.673
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  269 batches | lr 0.00030 | ms/batch 255.85 | loss  5.48 | ppl   240.79 
| epoch   8 |   200/  269 batches | lr 0.00030 | ms/batch 229.90 | loss  5.39 | ppl   218.20 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 65.35s | valid loss  5.17 | valid ppl   176.62 | valid bpc    7.464
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 8.0%
| epoch   9 |   100/  269 batches | lr 0.00030 | ms/batch 254.90 | loss  5.35 | ppl   210.44 
| epoch   9 |   200/  269 batches | lr 0.00030 | ms/batch 230.06 | loss  5.23 | ppl   187.03 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 65.24s | valid loss  5.06 | valid ppl   157.89 | valid bpc    7.303
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  269 batches | lr 0.00030 | ms/batch 254.11 | loss  5.24 | ppl   189.11 
| epoch  10 |   200/  269 batches | lr 0.00030 | ms/batch 234.72 | loss  5.12 | ppl   167.96 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 65.60s | valid loss  4.96 | valid ppl   142.71 | valid bpc    7.157
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  269 batches | lr 0.00030 | ms/batch 253.51 | loss  5.09 | ppl   162.29 
| epoch  11 |   200/  269 batches | lr 0.00030 | ms/batch 231.34 | loss  5.06 | ppl   158.23 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 65.34s | valid loss  4.87 | valid ppl   130.81 | valid bpc    7.031
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  269 batches | lr 0.00030 | ms/batch 253.97 | loss  5.00 | ppl   148.89 
| epoch  12 |   200/  269 batches | lr 0.00030 | ms/batch 231.56 | loss  4.95 | ppl   141.29 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 65.28s | valid loss  4.77 | valid ppl   117.90 | valid bpc    6.881
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 12.0%
| epoch  13 |   100/  269 batches | lr 0.00030 | ms/batch 254.16 | loss  4.92 | ppl   136.65 
| epoch  13 |   200/  269 batches | lr 0.00030 | ms/batch 229.84 | loss  4.84 | ppl   126.28 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 65.25s | valid loss  4.71 | valid ppl   111.53 | valid bpc    6.801
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 13.0%
| epoch  14 |   100/  269 batches | lr 0.00030 | ms/batch 254.33 | loss  4.84 | ppl   126.86 
| epoch  14 |   200/  269 batches | lr 0.00030 | ms/batch 225.37 | loss  4.74 | ppl   114.72 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 65.36s | valid loss  4.72 | valid ppl   112.65 | valid bpc    6.816
-----------------------------------------------------------------------------------------
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  269 batches | lr 0.00030 | ms/batch 254.01 | loss  4.75 | ppl   115.27 
| epoch  15 |   200/  269 batches | lr 0.00030 | ms/batch 225.30 | loss  4.69 | ppl   109.30 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 65.66s | valid loss  4.61 | valid ppl   100.42 | valid bpc    6.650
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 15.0%
| epoch  16 |   100/  269 batches | lr 0.00030 | ms/batch 254.91 | loss  4.68 | ppl   107.41 
| epoch  16 |   200/  269 batches | lr 0.00030 | ms/batch 221.52 | loss  4.62 | ppl   101.13 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 65.40s | valid loss  4.51 | valid ppl    90.97 | valid bpc    6.507
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 16.0%
| epoch  17 |   100/  269 batches | lr 0.00030 | ms/batch 253.10 | loss  4.58 | ppl    97.23 
| epoch  17 |   200/  269 batches | lr 0.00030 | ms/batch 224.47 | loss  4.55 | ppl    94.71 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 65.63s | valid loss  4.50 | valid ppl    89.66 | valid bpc    6.486
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 17.0%
| epoch  18 |   100/  269 batches | lr 0.00030 | ms/batch 253.94 | loss  4.50 | ppl    90.02 
| epoch  18 |   200/  269 batches | lr 0.00030 | ms/batch 213.92 | loss  4.48 | ppl    88.32 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 64.68s | valid loss  4.42 | valid ppl    83.13 | valid bpc    6.377
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 18.0%
| epoch  19 |   100/  269 batches | lr 0.00030 | ms/batch 254.00 | loss  4.44 | ppl    84.95 
| epoch  19 |   200/  269 batches | lr 0.00030 | ms/batch 221.88 | loss  4.40 | ppl    81.43 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 65.32s | valid loss  4.35 | valid ppl    77.57 | valid bpc    6.278
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 19.0%
| epoch  20 |   100/  269 batches | lr 0.00030 | ms/batch 253.79 | loss  4.39 | ppl    80.46 
| epoch  20 |   200/  269 batches | lr 0.00030 | ms/batch 220.26 | loss  4.35 | ppl    77.76 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 65.27s | valid loss  4.33 | valid ppl    75.60 | valid bpc    6.240
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 20.0%
| epoch  21 |   100/  269 batches | lr 0.00030 | ms/batch 253.66 | loss  4.30 | ppl    74.03 
| epoch  21 |   200/  269 batches | lr 0.00030 | ms/batch 222.13 | loss  4.29 | ppl    72.99 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 65.27s | valid loss  4.28 | valid ppl    72.47 | valid bpc    6.179
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 21.0%
| epoch  22 |   100/  269 batches | lr 0.00030 | ms/batch 254.80 | loss  4.28 | ppl    72.22 
| epoch  22 |   200/  269 batches | lr 0.00030 | ms/batch 228.15 | loss  4.22 | ppl    68.01 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 66.01s | valid loss  4.26 | valid ppl    70.89 | valid bpc    6.147
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 22.0%
| epoch  23 |   100/  269 batches | lr 0.00030 | ms/batch 254.06 | loss  4.19 | ppl    66.05 
| epoch  23 |   200/  269 batches | lr 0.00030 | ms/batch 220.64 | loss  4.18 | ppl    65.68 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 65.28s | valid loss  4.25 | valid ppl    69.96 | valid bpc    6.128
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 23.0%
| epoch  24 |   100/  269 batches | lr 0.00030 | ms/batch 252.54 | loss  4.14 | ppl    63.01 
| epoch  24 |   200/  269 batches | lr 0.00030 | ms/batch 222.67 | loss  4.15 | ppl    63.18 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 65.30s | valid loss  4.19 | valid ppl    66.07 | valid bpc    6.046
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 24.0%
| epoch  25 |   100/  269 batches | lr 0.00030 | ms/batch 248.29 | loss  4.10 | ppl    60.60 
| epoch  25 |   200/  269 batches | lr 0.00030 | ms/batch 229.78 | loss  4.07 | ppl    58.27 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 65.28s | valid loss  4.13 | valid ppl    62.38 | valid bpc    5.963
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 25.0%
| epoch  26 |   100/  269 batches | lr 0.00030 | ms/batch 248.55 | loss  4.06 | ppl    57.80 
| epoch  26 |   200/  269 batches | lr 0.00030 | ms/batch 233.60 | loss  4.02 | ppl    55.67 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 65.59s | valid loss  4.13 | valid ppl    62.37 | valid bpc    5.963
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 26.0%
| epoch  27 |   100/  269 batches | lr 0.00030 | ms/batch 248.09 | loss  4.01 | ppl    55.21 
| epoch  27 |   200/  269 batches | lr 0.00030 | ms/batch 237.48 | loss  3.96 | ppl    52.32 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 65.63s | valid loss  4.08 | valid ppl    59.00 | valid bpc    5.883
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 27.0%
| epoch  28 |   100/  269 batches | lr 0.00030 | ms/batch 245.03 | loss  3.95 | ppl    51.98 
| epoch  28 |   200/  269 batches | lr 0.00030 | ms/batch 239.55 | loss  3.93 | ppl    51.04 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 65.30s | valid loss  4.07 | valid ppl    58.74 | valid bpc    5.876
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  269 batches | lr 0.00030 | ms/batch 244.91 | loss  3.89 | ppl    48.72 
| epoch  29 |   200/  269 batches | lr 0.00030 | ms/batch 239.08 | loss  3.89 | ppl    48.91 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 65.64s | valid loss  4.02 | valid ppl    55.97 | valid bpc    5.807
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  269 batches | lr 0.00030 | ms/batch 244.53 | loss  3.88 | ppl    48.65 
| epoch  30 |   200/  269 batches | lr 0.00030 | ms/batch 239.89 | loss  3.83 | ppl    45.96 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 65.19s | valid loss  3.98 | valid ppl    53.68 | valid bpc    5.746
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 30.0%
| epoch  31 |   100/  269 batches | lr 0.00030 | ms/batch 247.34 | loss  3.81 | ppl    45.12 
| epoch  31 |   200/  269 batches | lr 0.00030 | ms/batch 239.98 | loss  3.81 | ppl    45.28 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 65.72s | valid loss  4.00 | valid ppl    54.77 | valid bpc    5.775
-----------------------------------------------------------------------------------------
PROGRESS: 31.0%
| epoch  32 |   100/  269 batches | lr 0.00030 | ms/batch 244.72 | loss  3.77 | ppl    43.33 
| epoch  32 |   200/  269 batches | lr 0.00030 | ms/batch 239.79 | loss  3.76 | ppl    42.86 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 65.29s | valid loss  4.03 | valid ppl    56.21 | valid bpc    5.813
-----------------------------------------------------------------------------------------
PROGRESS: 32.0%
| epoch  33 |   100/  269 batches | lr 0.00030 | ms/batch 248.19 | loss  3.74 | ppl    42.18 
| epoch  33 |   200/  269 batches | lr 0.00030 | ms/batch 239.66 | loss  3.72 | ppl    41.25 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 65.66s | valid loss  3.99 | valid ppl    53.99 | valid bpc    5.755
-----------------------------------------------------------------------------------------
PROGRESS: 33.0%
| epoch  34 |   100/  269 batches | lr 0.00015 | ms/batch 244.32 | loss  3.66 | ppl    38.89 
| epoch  34 |   200/  269 batches | lr 0.00015 | ms/batch 239.76 | loss  3.64 | ppl    38.02 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 65.63s | valid loss  3.87 | valid ppl    47.93 | valid bpc    5.583
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 34.0%
| epoch  35 |   100/  269 batches | lr 0.00015 | ms/batch 247.28 | loss  3.59 | ppl    36.39 
| epoch  35 |   200/  269 batches | lr 0.00015 | ms/batch 240.16 | loss  3.57 | ppl    35.65 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 65.88s | valid loss  3.87 | valid ppl    47.90 | valid bpc    5.582
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 35.0%
| epoch  36 |   100/  269 batches | lr 0.00015 | ms/batch 253.05 | loss  3.58 | ppl    36.04 
| epoch  36 |   200/  269 batches | lr 0.00015 | ms/batch 240.14 | loss  3.54 | ppl    34.40 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 65.60s | valid loss  3.91 | valid ppl    50.06 | valid bpc    5.646
-----------------------------------------------------------------------------------------
PROGRESS: 36.0%
| epoch  37 |   100/  269 batches | lr 0.00015 | ms/batch 253.35 | loss  3.56 | ppl    35.24 
| epoch  37 |   200/  269 batches | lr 0.00015 | ms/batch 240.88 | loss  3.52 | ppl    33.82 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 65.26s | valid loss  3.90 | valid ppl    49.30 | valid bpc    5.624
-----------------------------------------------------------------------------------------
PROGRESS: 37.0%
| epoch  38 |   100/  269 batches | lr 0.00015 | ms/batch 254.72 | loss  3.53 | ppl    34.05 
| epoch  38 |   200/  269 batches | lr 0.00015 | ms/batch 239.62 | loss  3.49 | ppl    32.92 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 65.60s | valid loss  3.83 | valid ppl    45.89 | valid bpc    5.520
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 38.0%
| epoch  39 |   100/  269 batches | lr 0.00015 | ms/batch 253.14 | loss  3.50 | ppl    33.18 
| epoch  39 |   200/  269 batches | lr 0.00015 | ms/batch 240.42 | loss  3.47 | ppl    32.15 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 65.62s | valid loss  3.86 | valid ppl    47.39 | valid bpc    5.566
-----------------------------------------------------------------------------------------
PROGRESS: 39.0%
| epoch  40 |   100/  269 batches | lr 0.00015 | ms/batch 253.87 | loss  3.47 | ppl    32.17 
| epoch  40 |   200/  269 batches | lr 0.00015 | ms/batch 240.53 | loss  3.45 | ppl    31.50 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 65.60s | valid loss  3.81 | valid ppl    45.14 | valid bpc    5.496
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 40.0%
| epoch  41 |   100/  269 batches | lr 0.00015 | ms/batch 254.18 | loss  3.46 | ppl    31.77 
| epoch  41 |   200/  269 batches | lr 0.00015 | ms/batch 239.26 | loss  3.41 | ppl    30.37 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 65.95s | valid loss  3.84 | valid ppl    46.54 | valid bpc    5.540
-----------------------------------------------------------------------------------------
PROGRESS: 41.0%
| epoch  42 |   100/  269 batches | lr 0.00015 | ms/batch 253.78 | loss  3.44 | ppl    31.04 
| epoch  42 |   200/  269 batches | lr 0.00015 | ms/batch 239.25 | loss  3.41 | ppl    30.13 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 65.60s | valid loss  3.82 | valid ppl    45.66 | valid bpc    5.513
-----------------------------------------------------------------------------------------
PROGRESS: 42.0%
| epoch  43 |   100/  269 batches | lr 0.00015 | ms/batch 253.87 | loss  3.41 | ppl    30.14 
| epoch  43 |   200/  269 batches | lr 0.00015 | ms/batch 240.50 | loss  3.40 | ppl    30.03 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 65.97s | valid loss  3.86 | valid ppl    47.38 | valid bpc    5.566
-----------------------------------------------------------------------------------------
PROGRESS: 43.0%
| epoch  44 |   100/  269 batches | lr 0.00007 | ms/batch 255.40 | loss  3.37 | ppl    29.03 
| epoch  44 |   200/  269 batches | lr 0.00007 | ms/batch 234.52 | loss  3.33 | ppl    27.88 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 65.31s | valid loss  3.73 | valid ppl    41.80 | valid bpc    5.386
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 44.0%
| epoch  45 |   100/  269 batches | lr 0.00007 | ms/batch 254.47 | loss  3.34 | ppl    28.27 
| epoch  45 |   200/  269 batches | lr 0.00007 | ms/batch 229.39 | loss  3.31 | ppl    27.35 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 65.65s | valid loss  3.80 | valid ppl    44.77 | valid bpc    5.484
-----------------------------------------------------------------------------------------
PROGRESS: 45.0%
| epoch  46 |   100/  269 batches | lr 0.00007 | ms/batch 253.12 | loss  3.34 | ppl    28.15 
| epoch  46 |   200/  269 batches | lr 0.00007 | ms/batch 234.79 | loss  3.28 | ppl    26.70 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 65.98s | valid loss  3.77 | valid ppl    43.39 | valid bpc    5.439
-----------------------------------------------------------------------------------------
PROGRESS: 46.0%
| epoch  47 |   100/  269 batches | lr 0.00007 | ms/batch 255.47 | loss  3.31 | ppl    27.34 
| epoch  47 |   200/  269 batches | lr 0.00007 | ms/batch 228.93 | loss  3.28 | ppl    26.52 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 65.60s | valid loss  3.75 | valid ppl    42.55 | valid bpc    5.411
-----------------------------------------------------------------------------------------
PROGRESS: 47.0%
| epoch  48 |   100/  269 batches | lr 0.00004 | ms/batch 254.11 | loss  3.29 | ppl    26.83 
| epoch  48 |   200/  269 batches | lr 0.00004 | ms/batch 233.15 | loss  3.24 | ppl    25.60 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 66.03s | valid loss  3.77 | valid ppl    43.40 | valid bpc    5.440
-----------------------------------------------------------------------------------------
PROGRESS: 48.0%
| epoch  49 |   100/  269 batches | lr 0.00004 | ms/batch 254.66 | loss  3.26 | ppl    26.05 
| epoch  49 |   200/  269 batches | lr 0.00004 | ms/batch 232.82 | loss  3.24 | ppl    25.41 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 66.27s | valid loss  3.76 | valid ppl    42.96 | valid bpc    5.425
-----------------------------------------------------------------------------------------
PROGRESS: 49.0%
| epoch  50 |   100/  269 batches | lr 0.00004 | ms/batch 250.58 | loss  3.26 | ppl    26.01 
| epoch  50 |   200/  269 batches | lr 0.00004 | ms/batch 235.08 | loss  3.24 | ppl    25.50 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 66.25s | valid loss  3.72 | valid ppl    41.34 | valid bpc    5.370
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 50.0%
| epoch  51 |   100/  269 batches | lr 0.00004 | ms/batch 253.45 | loss  3.23 | ppl    25.31 
| epoch  51 |   200/  269 batches | lr 0.00004 | ms/batch 231.40 | loss  3.24 | ppl    25.43 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 65.82s | valid loss  3.78 | valid ppl    43.89 | valid bpc    5.456
-----------------------------------------------------------------------------------------
PROGRESS: 51.0%
| epoch  52 |   100/  269 batches | lr 0.00004 | ms/batch 249.79 | loss  3.22 | ppl    24.91 
| epoch  52 |   200/  269 batches | lr 0.00004 | ms/batch 234.08 | loss  3.22 | ppl    25.01 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 66.06s | valid loss  3.78 | valid ppl    43.74 | valid bpc    5.451
-----------------------------------------------------------------------------------------
PROGRESS: 52.0%
| epoch  53 |   100/  269 batches | lr 0.00004 | ms/batch 242.82 | loss  3.25 | ppl    25.80 
| epoch  53 |   200/  269 batches | lr 0.00004 | ms/batch 233.48 | loss  3.21 | ppl    24.87 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 65.36s | valid loss  3.77 | valid ppl    43.31 | valid bpc    5.437
-----------------------------------------------------------------------------------------
PROGRESS: 53.0%
| epoch  54 |   100/  269 batches | lr 0.00002 | ms/batch 249.01 | loss  3.24 | ppl    25.61 
| epoch  54 |   200/  269 batches | lr 0.00002 | ms/batch 234.25 | loss  3.18 | ppl    24.08 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 66.00s | valid loss  3.74 | valid ppl    41.91 | valid bpc    5.389
-----------------------------------------------------------------------------------------
PROGRESS: 54.0%
| epoch  55 |   100/  269 batches | lr 0.00002 | ms/batch 247.47 | loss  3.23 | ppl    25.24 
| epoch  55 |   200/  269 batches | lr 0.00002 | ms/batch 232.83 | loss  3.19 | ppl    24.29 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 65.95s | valid loss  3.75 | valid ppl    42.52 | valid bpc    5.410
-----------------------------------------------------------------------------------------
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  269 batches | lr 0.00002 | ms/batch 246.96 | loss  3.23 | ppl    25.22 
| epoch  56 |   200/  269 batches | lr 0.00002 | ms/batch 237.71 | loss  3.19 | ppl    24.38 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 65.99s | valid loss  3.76 | valid ppl    43.09 | valid bpc    5.429
-----------------------------------------------------------------------------------------
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  269 batches | lr 0.00001 | ms/batch 242.80 | loss  3.21 | ppl    24.68 
| epoch  57 |   200/  269 batches | lr 0.00001 | ms/batch 239.21 | loss  3.20 | ppl    24.53 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 65.97s | valid loss  3.76 | valid ppl    42.93 | valid bpc    5.424
-----------------------------------------------------------------------------------------
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  269 batches | lr 0.00001 | ms/batch 242.84 | loss  3.20 | ppl    24.50 
| epoch  58 |   200/  269 batches | lr 0.00001 | ms/batch 239.43 | loss  3.15 | ppl    23.44 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 65.97s | valid loss  3.77 | valid ppl    43.27 | valid bpc    5.435
-----------------------------------------------------------------------------------------
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  269 batches | lr 0.00001 | ms/batch 243.36 | loss  3.22 | ppl    25.14 
| epoch  59 |   200/  269 batches | lr 0.00001 | ms/batch 240.14 | loss  3.17 | ppl    23.86 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 65.99s | valid loss  3.78 | valid ppl    43.98 | valid bpc    5.459
-----------------------------------------------------------------------------------------
PROGRESS: 59.0%
| epoch  60 |   100/  269 batches | lr 0.00000 | ms/batch 242.43 | loss  3.21 | ppl    24.88 
| epoch  60 |   200/  269 batches | lr 0.00000 | ms/batch 238.99 | loss  3.16 | ppl    23.65 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 65.99s | valid loss  3.74 | valid ppl    41.96 | valid bpc    5.391
-----------------------------------------------------------------------------------------
PROGRESS: 60.0%
| epoch  61 |   100/  269 batches | lr 0.00000 | ms/batch 238.48 | loss  3.18 | ppl    24.10 
| epoch  61 |   200/  269 batches | lr 0.00000 | ms/batch 240.57 | loss  3.18 | ppl    24.06 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 65.56s | valid loss  3.72 | valid ppl    41.39 | valid bpc    5.371
-----------------------------------------------------------------------------------------
PROGRESS: 61.0%
| epoch  62 |   100/  269 batches | lr 0.00000 | ms/batch 243.59 | loss  3.20 | ppl    24.43 
| epoch  62 |   200/  269 batches | lr 0.00000 | ms/batch 239.29 | loss  3.15 | ppl    23.41 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 65.95s | valid loss  3.72 | valid ppl    41.34 | valid bpc    5.369
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 62.0%
| epoch  63 |   100/  269 batches | lr 0.00000 | ms/batch 234.72 | loss  3.19 | ppl    24.17 
| epoch  63 |   200/  269 batches | lr 0.00000 | ms/batch 239.26 | loss  3.16 | ppl    23.47 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 65.21s | valid loss  3.72 | valid ppl    41.09 | valid bpc    5.361
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 63.0%
| epoch  64 |   100/  269 batches | lr 0.00000 | ms/batch 241.96 | loss  3.19 | ppl    24.24 
| epoch  64 |   200/  269 batches | lr 0.00000 | ms/batch 240.13 | loss  3.16 | ppl    23.59 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 65.98s | valid loss  3.74 | valid ppl    42.14 | valid bpc    5.397
-----------------------------------------------------------------------------------------
PROGRESS: 64.0%
| epoch  65 |   100/  269 batches | lr 0.00000 | ms/batch 242.21 | loss  3.17 | ppl    23.82 
| epoch  65 |   200/  269 batches | lr 0.00000 | ms/batch 240.24 | loss  3.18 | ppl    24.01 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 66.01s | valid loss  3.73 | valid ppl    41.56 | valid bpc    5.377
-----------------------------------------------------------------------------------------
PROGRESS: 65.0%
| epoch  66 |   100/  269 batches | lr 0.00000 | ms/batch 241.57 | loss  3.20 | ppl    24.49 
| epoch  66 |   200/  269 batches | lr 0.00000 | ms/batch 241.13 | loss  3.17 | ppl    23.70 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 65.95s | valid loss  3.78 | valid ppl    43.81 | valid bpc    5.453
-----------------------------------------------------------------------------------------
PROGRESS: 66.0%
| epoch  67 |   100/  269 batches | lr 0.00000 | ms/batch 238.54 | loss  3.19 | ppl    24.19 
| epoch  67 |   200/  269 batches | lr 0.00000 | ms/batch 241.29 | loss  3.17 | ppl    23.71 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 65.69s | valid loss  3.70 | valid ppl    40.40 | valid bpc    5.336
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 67.0%
| epoch  68 |   100/  269 batches | lr 0.00000 | ms/batch 244.05 | loss  3.19 | ppl    24.22 
| epoch  68 |   200/  269 batches | lr 0.00000 | ms/batch 239.78 | loss  3.16 | ppl    23.67 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 65.52s | valid loss  3.79 | valid ppl    44.23 | valid bpc    5.467
-----------------------------------------------------------------------------------------
PROGRESS: 68.0%
| epoch  69 |   100/  269 batches | lr 0.00000 | ms/batch 248.76 | loss  3.18 | ppl    23.93 
| epoch  69 |   200/  269 batches | lr 0.00000 | ms/batch 240.97 | loss  3.15 | ppl    23.45 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 66.00s | valid loss  3.79 | valid ppl    44.11 | valid bpc    5.463
-----------------------------------------------------------------------------------------
PROGRESS: 69.0%
| epoch  70 |   100/  269 batches | lr 0.00000 | ms/batch 248.40 | loss  3.18 | ppl    24.02 
| epoch  70 |   200/  269 batches | lr 0.00000 | ms/batch 240.46 | loss  3.14 | ppl    23.15 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 65.95s | valid loss  3.76 | valid ppl    42.89 | valid bpc    5.423
-----------------------------------------------------------------------------------------
PROGRESS: 70.0%
| epoch  71 |   100/  269 batches | lr 0.00000 | ms/batch 247.60 | loss  3.18 | ppl    24.15 
| epoch  71 |   200/  269 batches | lr 0.00000 | ms/batch 239.86 | loss  3.13 | ppl    22.76 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 65.95s | valid loss  3.74 | valid ppl    42.05 | valid bpc    5.394
-----------------------------------------------------------------------------------------
PROGRESS: 71.0%
| epoch  72 |   100/  269 batches | lr 0.00000 | ms/batch 248.28 | loss  3.19 | ppl    24.23 
| epoch  72 |   200/  269 batches | lr 0.00000 | ms/batch 240.11 | loss  3.14 | ppl    23.03 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 65.96s | valid loss  3.78 | valid ppl    43.60 | valid bpc    5.446
-----------------------------------------------------------------------------------------
PROGRESS: 72.0%
| epoch  73 |   100/  269 batches | lr 0.00000 | ms/batch 248.92 | loss  3.19 | ppl    24.25 
| epoch  73 |   200/  269 batches | lr 0.00000 | ms/batch 240.11 | loss  3.15 | ppl    23.39 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 65.97s | valid loss  3.79 | valid ppl    44.16 | valid bpc    5.465
-----------------------------------------------------------------------------------------
PROGRESS: 73.0%
| epoch  74 |   100/  269 batches | lr 0.00000 | ms/batch 248.68 | loss  3.17 | ppl    23.92 
| epoch  74 |   200/  269 batches | lr 0.00000 | ms/batch 239.71 | loss  3.17 | ppl    23.83 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 65.91s | valid loss  3.75 | valid ppl    42.39 | valid bpc    5.406
-----------------------------------------------------------------------------------------
PROGRESS: 74.0%
| epoch  75 |   100/  269 batches | lr 0.00000 | ms/batch 248.34 | loss  3.18 | ppl    24.02 
| epoch  75 |   200/  269 batches | lr 0.00000 | ms/batch 239.02 | loss  3.17 | ppl    23.71 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 65.99s | valid loss  3.71 | valid ppl    40.93 | valid bpc    5.355
-----------------------------------------------------------------------------------------
PROGRESS: 75.0%
| epoch  76 |   100/  269 batches | lr 0.00000 | ms/batch 248.96 | loss  3.18 | ppl    24.10 
| epoch  76 |   200/  269 batches | lr 0.00000 | ms/batch 233.26 | loss  3.15 | ppl    23.39 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 66.01s | valid loss  3.75 | valid ppl    42.65 | valid bpc    5.414
-----------------------------------------------------------------------------------------
PROGRESS: 76.0%
| epoch  77 |   100/  269 batches | lr 0.00000 | ms/batch 248.67 | loss  3.19 | ppl    24.38 
| epoch  77 |   200/  269 batches | lr 0.00000 | ms/batch 233.06 | loss  3.13 | ppl    22.91 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 65.93s | valid loss  3.72 | valid ppl    41.18 | valid bpc    5.364
-----------------------------------------------------------------------------------------
PROGRESS: 77.0%
| epoch  78 |   100/  269 batches | lr 0.00000 | ms/batch 248.81 | loss  3.19 | ppl    24.36 
| epoch  78 |   200/  269 batches | lr 0.00000 | ms/batch 233.44 | loss  3.13 | ppl    22.93 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 65.95s | valid loss  3.77 | valid ppl    43.18 | valid bpc    5.432
-----------------------------------------------------------------------------------------
PROGRESS: 78.0%
| epoch  79 |   100/  269 batches | lr 0.00000 | ms/batch 247.14 | loss  3.17 | ppl    23.81 
| epoch  79 |   200/  269 batches | lr 0.00000 | ms/batch 231.37 | loss  3.15 | ppl    23.27 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 65.59s | valid loss  3.80 | valid ppl    44.59 | valid bpc    5.479
-----------------------------------------------------------------------------------------
PROGRESS: 79.0%
| epoch  80 |   100/  269 batches | lr 0.00000 | ms/batch 248.42 | loss  3.19 | ppl    24.28 
| epoch  80 |   200/  269 batches | lr 0.00000 | ms/batch 233.99 | loss  3.17 | ppl    23.73 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 65.95s | valid loss  3.77 | valid ppl    43.22 | valid bpc    5.434
-----------------------------------------------------------------------------------------
PROGRESS: 80.0%
| epoch  81 |   100/  269 batches | lr 0.00000 | ms/batch 248.76 | loss  3.18 | ppl    24.03 
| epoch  81 |   200/  269 batches | lr 0.00000 | ms/batch 233.61 | loss  3.15 | ppl    23.25 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 66.00s | valid loss  3.74 | valid ppl    41.96 | valid bpc    5.391
-----------------------------------------------------------------------------------------
PROGRESS: 81.0%
| epoch  82 |   100/  269 batches | lr 0.00000 | ms/batch 248.49 | loss  3.18 | ppl    24.11 
| epoch  82 |   200/  269 batches | lr 0.00000 | ms/batch 233.29 | loss  3.15 | ppl    23.22 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 66.03s | valid loss  3.80 | valid ppl    44.57 | valid bpc    5.478
-----------------------------------------------------------------------------------------
PROGRESS: 82.0%
| epoch  83 |   100/  269 batches | lr 0.00000 | ms/batch 249.49 | loss  3.18 | ppl    24.03 
| epoch  83 |   200/  269 batches | lr 0.00000 | ms/batch 233.04 | loss  3.14 | ppl    23.02 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 65.97s | valid loss  3.73 | valid ppl    41.51 | valid bpc    5.375
-----------------------------------------------------------------------------------------
PROGRESS: 83.0%
| epoch  84 |   100/  269 batches | lr 0.00000 | ms/batch 252.87 | loss  3.20 | ppl    24.48 
| epoch  84 |   200/  269 batches | lr 0.00000 | ms/batch 227.07 | loss  3.16 | ppl    23.62 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 65.61s | valid loss  3.77 | valid ppl    43.53 | valid bpc    5.444
-----------------------------------------------------------------------------------------
PROGRESS: 84.0%
| epoch  85 |   100/  269 batches | lr 0.00000 | ms/batch 254.06 | loss  3.16 | ppl    23.67 
| epoch  85 |   200/  269 batches | lr 0.00000 | ms/batch 229.29 | loss  3.16 | ppl    23.65 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 65.97s | valid loss  3.79 | valid ppl    44.13 | valid bpc    5.464
-----------------------------------------------------------------------------------------
PROGRESS: 85.0%
| epoch  86 |   100/  269 batches | lr 0.00000 | ms/batch 254.71 | loss  3.17 | ppl    23.86 
| epoch  86 |   200/  269 batches | lr 0.00000 | ms/batch 227.62 | loss  3.14 | ppl    23.10 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 65.99s | valid loss  3.78 | valid ppl    43.69 | valid bpc    5.449
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  269 batches | lr 0.00000 | ms/batch 252.76 | loss  3.19 | ppl    24.40 
| epoch  87 |   200/  269 batches | lr 0.00000 | ms/batch 230.48 | loss  3.15 | ppl    23.26 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 66.00s | valid loss  3.76 | valid ppl    42.90 | valid bpc    5.423
-----------------------------------------------------------------------------------------
PROGRESS: 87.0%
| epoch  88 |   100/  269 batches | lr 0.00000 | ms/batch 250.59 | loss  3.17 | ppl    23.85 
| epoch  88 |   200/  269 batches | lr 0.00000 | ms/batch 231.69 | loss  3.16 | ppl    23.52 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 65.95s | valid loss  3.76 | valid ppl    42.88 | valid bpc    5.422
-----------------------------------------------------------------------------------------
PROGRESS: 88.0%
| epoch  89 |   100/  269 batches | lr 0.00000 | ms/batch 244.62 | loss  3.18 | ppl    24.01 
| epoch  89 |   200/  269 batches | lr 0.00000 | ms/batch 233.79 | loss  3.16 | ppl    23.68 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 65.65s | valid loss  3.76 | valid ppl    43.06 | valid bpc    5.428
-----------------------------------------------------------------------------------------
PROGRESS: 89.0%
| epoch  90 |   100/  269 batches | lr 0.00000 | ms/batch 249.41 | loss  3.18 | ppl    24.04 
| epoch  90 |   200/  269 batches | lr 0.00000 | ms/batch 233.10 | loss  3.13 | ppl    22.98 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 65.99s | valid loss  3.77 | valid ppl    43.17 | valid bpc    5.432
-----------------------------------------------------------------------------------------
PROGRESS: 90.0%
| epoch  91 |   100/  269 batches | lr 0.00000 | ms/batch 246.98 | loss  3.20 | ppl    24.58 
| epoch  91 |   200/  269 batches | lr 0.00000 | ms/batch 233.95 | loss  3.18 | ppl    24.13 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 65.91s | valid loss  3.74 | valid ppl    42.07 | valid bpc    5.395
-----------------------------------------------------------------------------------------
PROGRESS: 91.0%
| epoch  92 |   100/  269 batches | lr 0.00000 | ms/batch 247.82 | loss  3.18 | ppl    23.95 
| epoch  92 |   200/  269 batches | lr 0.00000 | ms/batch 234.61 | loss  3.17 | ppl    23.70 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 65.93s | valid loss  3.73 | valid ppl    41.72 | valid bpc    5.383
-----------------------------------------------------------------------------------------
PROGRESS: 92.0%
| epoch  93 |   100/  269 batches | lr 0.00000 | ms/batch 248.46 | loss  3.18 | ppl    23.93 
| epoch  93 |   200/  269 batches | lr 0.00000 | ms/batch 233.79 | loss  3.15 | ppl    23.23 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 65.94s | valid loss  3.80 | valid ppl    44.66 | valid bpc    5.481
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  269 batches | lr 0.00000 | ms/batch 248.61 | loss  3.19 | ppl    24.32 
| epoch  94 |   200/  269 batches | lr 0.00000 | ms/batch 234.35 | loss  3.15 | ppl    23.29 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 66.02s | valid loss  3.75 | valid ppl    42.42 | valid bpc    5.407
-----------------------------------------------------------------------------------------
PROGRESS: 94.0%
| epoch  95 |   100/  269 batches | lr 0.00000 | ms/batch 247.98 | loss  3.19 | ppl    24.35 
| epoch  95 |   200/  269 batches | lr 0.00000 | ms/batch 234.38 | loss  3.16 | ppl    23.46 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 65.95s | valid loss  3.72 | valid ppl    41.45 | valid bpc    5.373
-----------------------------------------------------------------------------------------
PROGRESS: 95.0%
| epoch  96 |   100/  269 batches | lr 0.00000 | ms/batch 247.55 | loss  3.19 | ppl    24.25 
| epoch  96 |   200/  269 batches | lr 0.00000 | ms/batch 234.46 | loss  3.15 | ppl    23.30 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 65.92s | valid loss  3.76 | valid ppl    42.85 | valid bpc    5.421
-----------------------------------------------------------------------------------------
PROGRESS: 96.0%
| epoch  97 |   100/  269 batches | lr 0.00000 | ms/batch 204.22 | loss  3.18 | ppl    24.04 
| epoch  97 |   200/  269 batches | lr 0.00000 | ms/batch 163.45 | loss  3.15 | ppl    23.37 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 49.43s | valid loss  3.73 | valid ppl    41.81 | valid bpc    5.386
-----------------------------------------------------------------------------------------
PROGRESS: 97.0%
| epoch  98 |   100/  269 batches | lr 0.00000 | ms/batch 179.59 | loss  3.18 | ppl    23.98 
| epoch  98 |   200/  269 batches | lr 0.00000 | ms/batch 127.02 | loss  3.14 | ppl    23.17 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 37.43s | valid loss  3.79 | valid ppl    44.05 | valid bpc    5.461
-----------------------------------------------------------------------------------------
PROGRESS: 98.0%
| epoch  99 |   100/  269 batches | lr 0.00000 | ms/batch 92.13 | loss  3.18 | ppl    24.04 
| epoch  99 |   200/  269 batches | lr 0.00000 | ms/batch 90.87 | loss  3.15 | ppl    23.27 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 25.02s | valid loss  3.75 | valid ppl    42.37 | valid bpc    5.405
-----------------------------------------------------------------------------------------
PROGRESS: 99.0%
| epoch 100 |   100/  269 batches | lr 0.00000 | ms/batch 98.26 | loss  3.19 | ppl    24.19 
| epoch 100 |   200/  269 batches | lr 0.00000 | ms/batch 160.30 | loss  3.16 | ppl    23.48 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 37.74s | valid loss  3.72 | valid ppl    41.28 | valid bpc    5.367
-----------------------------------------------------------------------------------------
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  3.88 | test ppl    48.21 | test bpc    5.591
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.4376, Mean Reca: 0.6174, Mean F1: 0.5078, Mean Subword_Reca: 0.8683
-----------------------------------------------------------------------------------------
=========================================================================================
Loading dataset...
Using subword tokenizer...
Number of tokens:  8000
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer_in_parser', nhid=512, nlayers=8, front_layers=4, rear_layers=4, subword='omarmomen/ptb_filtered_lowcase_bpe_tokenizer_8', n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=2222, nonmono=5, cuda=True, log_interval=100, save='trained_models/subword_structformer_in_parser_2222_44.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 37449092
Model architecture: StructFormer_In_Parser(
  (transformer_front): Transformer_Front(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(8000, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-3): 4 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
  (transformer_rear): Transformer_Rear(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(8000, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-3): 4 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (output_layer): Linear(in_features=512, out_features=8000, bias=True)
  )
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  269 batches | lr 0.00030 | ms/batch 264.48 | loss  7.72 | ppl  2257.19 
| epoch   1 |   200/  269 batches | lr 0.00030 | ms/batch 238.84 | loss  7.34 | ppl  1540.12 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 65.95s | valid loss  7.05 | valid ppl  1158.07 | valid bpc   10.178
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  269 batches | lr 0.00030 | ms/batch 254.32 | loss  7.29 | ppl  1464.33 
| epoch   2 |   200/  269 batches | lr 0.00030 | ms/batch 240.04 | loss  7.17 | ppl  1297.32 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 64.82s | valid loss  6.87 | valid ppl   964.38 | valid bpc    9.913
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  269 batches | lr 0.00030 | ms/batch 253.72 | loss  7.01 | ppl  1109.05 
| epoch   3 |   200/  269 batches | lr 0.00030 | ms/batch 239.53 | loss  6.68 | ppl   797.16 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 65.24s | valid loss  6.20 | valid ppl   491.51 | valid bpc    8.941
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  269 batches | lr 0.00030 | ms/batch 254.46 | loss  6.31 | ppl   552.59 
| epoch   4 |   200/  269 batches | lr 0.00030 | ms/batch 239.37 | loss  6.11 | ppl   451.82 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 65.41s | valid loss  5.78 | valid ppl   324.63 | valid bpc    8.343
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  269 batches | lr 0.00030 | ms/batch 253.30 | loss  5.93 | ppl   375.66 
| epoch   5 |   200/  269 batches | lr 0.00030 | ms/batch 231.48 | loss  5.80 | ppl   329.52 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 65.25s | valid loss  5.55 | valid ppl   256.26 | valid bpc    8.001
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  269 batches | lr 0.00030 | ms/batch 254.41 | loss  5.70 | ppl   298.41 
| epoch   6 |   200/  269 batches | lr 0.00030 | ms/batch 229.46 | loss  5.58 | ppl   265.28 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 65.23s | valid loss  5.37 | valid ppl   215.73 | valid bpc    7.753
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  269 batches | lr 0.00030 | ms/batch 254.16 | loss  5.53 | ppl   251.39 
| epoch   7 |   200/  269 batches | lr 0.00030 | ms/batch 230.00 | loss  5.43 | ppl   227.36 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 65.30s | valid loss  5.19 | valid ppl   179.86 | valid bpc    7.491
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  269 batches | lr 0.00030 | ms/batch 253.93 | loss  5.38 | ppl   216.08 
| epoch   8 |   200/  269 batches | lr 0.00030 | ms/batch 230.76 | loss  5.30 | ppl   199.62 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 65.35s | valid loss  5.08 | valid ppl   159.98 | valid bpc    7.322
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 8.0%
| epoch   9 |   100/  269 batches | lr 0.00030 | ms/batch 252.94 | loss  5.24 | ppl   189.29 
| epoch   9 |   200/  269 batches | lr 0.00030 | ms/batch 230.06 | loss  5.17 | ppl   175.33 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 65.31s | valid loss  5.00 | valid ppl   148.00 | valid bpc    7.209
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  269 batches | lr 0.00030 | ms/batch 254.60 | loss  5.16 | ppl   174.06 
| epoch  10 |   200/  269 batches | lr 0.00030 | ms/batch 230.39 | loss  5.06 | ppl   157.46 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 65.31s | valid loss  4.87 | valid ppl   129.72 | valid bpc    7.019
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  269 batches | lr 0.00030 | ms/batch 254.21 | loss  5.01 | ppl   150.59 
| epoch  11 |   200/  269 batches | lr 0.00030 | ms/batch 230.12 | loss  4.96 | ppl   142.65 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 65.30s | valid loss  4.81 | valid ppl   122.21 | valid bpc    6.933
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  269 batches | lr 0.00030 | ms/batch 252.81 | loss  4.91 | ppl   136.03 
| epoch  12 |   200/  269 batches | lr 0.00030 | ms/batch 230.96 | loss  4.87 | ppl   130.26 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 65.29s | valid loss  4.72 | valid ppl   111.89 | valid bpc    6.806
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 12.0%
| epoch  13 |   100/  269 batches | lr 0.00030 | ms/batch 254.02 | loss  4.84 | ppl   125.96 
| epoch  13 |   200/  269 batches | lr 0.00030 | ms/batch 229.81 | loss  4.77 | ppl   117.94 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 65.30s | valid loss  4.68 | valid ppl   107.34 | valid bpc    6.746
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 13.0%
| epoch  14 |   100/  269 batches | lr 0.00030 | ms/batch 253.88 | loss  4.77 | ppl   117.61 
| epoch  14 |   200/  269 batches | lr 0.00030 | ms/batch 233.83 | loss  4.69 | ppl   108.33 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 65.98s | valid loss  4.58 | valid ppl    97.61 | valid bpc    6.609
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  269 batches | lr 0.00030 | ms/batch 253.36 | loss  4.67 | ppl   106.88 
| epoch  15 |   200/  269 batches | lr 0.00030 | ms/batch 231.57 | loss  4.62 | ppl   100.99 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 65.30s | valid loss  4.48 | valid ppl    88.00 | valid bpc    6.459
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 15.0%
| epoch  16 |   100/  269 batches | lr 0.00030 | ms/batch 246.54 | loss  4.58 | ppl    97.20 
| epoch  16 |   200/  269 batches | lr 0.00030 | ms/batch 238.66 | loss  4.56 | ppl    95.87 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 65.41s | valid loss  4.46 | valid ppl    86.31 | valid bpc    6.432
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 16.0%
| epoch  17 |   100/  269 batches | lr 0.00030 | ms/batch 243.87 | loss  4.49 | ppl    88.84 
| epoch  17 |   200/  269 batches | lr 0.00030 | ms/batch 240.28 | loss  4.48 | ppl    87.93 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 65.60s | valid loss  4.37 | valid ppl    79.16 | valid bpc    6.307
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 17.0%
| epoch  18 |   100/  269 batches | lr 0.00030 | ms/batch 244.75 | loss  4.44 | ppl    84.92 
| epoch  18 |   200/  269 batches | lr 0.00030 | ms/batch 239.84 | loss  4.36 | ppl    78.06 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 65.72s | valid loss  4.37 | valid ppl    79.43 | valid bpc    6.312
-----------------------------------------------------------------------------------------
PROGRESS: 18.0%
| epoch  19 |   100/  269 batches | lr 0.00030 | ms/batch 245.89 | loss  4.37 | ppl    78.91 
| epoch  19 |   200/  269 batches | lr 0.00030 | ms/batch 239.30 | loss  4.32 | ppl    75.32 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 65.94s | valid loss  4.31 | valid ppl    74.31 | valid bpc    6.216
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 19.0%
| epoch  20 |   100/  269 batches | lr 0.00030 | ms/batch 244.57 | loss  4.29 | ppl    73.03 
| epoch  20 |   200/  269 batches | lr 0.00030 | ms/batch 239.78 | loss  4.27 | ppl    71.49 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 65.90s | valid loss  4.29 | valid ppl    73.28 | valid bpc    6.195
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 20.0%
| epoch  21 |   100/  269 batches | lr 0.00030 | ms/batch 247.86 | loss  4.24 | ppl    69.49 
| epoch  21 |   200/  269 batches | lr 0.00030 | ms/batch 238.71 | loss  4.22 | ppl    67.74 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 66.06s | valid loss  4.22 | valid ppl    67.88 | valid bpc    6.085
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 21.0%
| epoch  22 |   100/  269 batches | lr 0.00030 | ms/batch 245.55 | loss  4.17 | ppl    64.42 
| epoch  22 |   200/  269 batches | lr 0.00030 | ms/batch 238.98 | loss  4.16 | ppl    64.26 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 65.62s | valid loss  4.18 | valid ppl    65.53 | valid bpc    6.034
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 22.0%
| epoch  23 |   100/  269 batches | lr 0.00030 | ms/batch 248.42 | loss  4.14 | ppl    62.96 
| epoch  23 |   200/  269 batches | lr 0.00030 | ms/batch 239.70 | loss  4.09 | ppl    59.61 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 66.08s | valid loss  4.16 | valid ppl    64.18 | valid bpc    6.004
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 23.0%
| epoch  24 |   100/  269 batches | lr 0.00030 | ms/batch 245.29 | loss  4.06 | ppl    58.04 
| epoch  24 |   200/  269 batches | lr 0.00030 | ms/batch 239.76 | loss  4.04 | ppl    56.54 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 65.84s | valid loss  4.20 | valid ppl    66.81 | valid bpc    6.062
-----------------------------------------------------------------------------------------
PROGRESS: 24.0%
| epoch  25 |   100/  269 batches | lr 0.00030 | ms/batch 242.44 | loss  4.04 | ppl    56.85 
| epoch  25 |   200/  269 batches | lr 0.00030 | ms/batch 239.60 | loss  3.99 | ppl    53.86 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 65.99s | valid loss  4.11 | valid ppl    61.07 | valid bpc    5.932
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 25.0%
| epoch  26 |   100/  269 batches | lr 0.00030 | ms/batch 246.47 | loss  3.97 | ppl    53.09 
| epoch  26 |   200/  269 batches | lr 0.00030 | ms/batch 239.66 | loss  3.94 | ppl    51.58 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 65.40s | valid loss  4.07 | valid ppl    58.51 | valid bpc    5.871
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 26.0%
| epoch  27 |   100/  269 batches | lr 0.00030 | ms/batch 243.09 | loss  3.95 | ppl    52.01 
| epoch  27 |   200/  269 batches | lr 0.00030 | ms/batch 240.27 | loss  3.89 | ppl    48.72 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 65.38s | valid loss  4.02 | valid ppl    55.92 | valid bpc    5.805
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 27.0%
| epoch  28 |   100/  269 batches | lr 0.00030 | ms/batch 244.74 | loss  3.90 | ppl    49.21 
| epoch  28 |   200/  269 batches | lr 0.00030 | ms/batch 239.88 | loss  3.84 | ppl    46.65 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 65.23s | valid loss  4.03 | valid ppl    56.34 | valid bpc    5.816
-----------------------------------------------------------------------------------------
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  269 batches | lr 0.00030 | ms/batch 244.87 | loss  3.82 | ppl    45.53 
| epoch  29 |   200/  269 batches | lr 0.00030 | ms/batch 240.28 | loss  3.80 | ppl    44.92 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 65.60s | valid loss  4.07 | valid ppl    58.84 | valid bpc    5.879
-----------------------------------------------------------------------------------------
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  269 batches | lr 0.00030 | ms/batch 248.52 | loss  3.80 | ppl    44.61 
| epoch  30 |   200/  269 batches | lr 0.00030 | ms/batch 239.52 | loss  3.77 | ppl    43.39 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 65.62s | valid loss  4.05 | valid ppl    57.17 | valid bpc    5.837
-----------------------------------------------------------------------------------------
PROGRESS: 30.0%
| epoch  31 |   100/  269 batches | lr 0.00015 | ms/batch 249.84 | loss  3.70 | ppl    40.28 
| epoch  31 |   200/  269 batches | lr 0.00015 | ms/batch 239.06 | loss  3.65 | ppl    38.49 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 65.97s | valid loss  3.96 | valid ppl    52.38 | valid bpc    5.711
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 31.0%
| epoch  32 |   100/  269 batches | lr 0.00015 | ms/batch 245.22 | loss  3.66 | ppl    38.80 
| epoch  32 |   200/  269 batches | lr 0.00015 | ms/batch 239.26 | loss  3.60 | ppl    36.54 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 65.27s | valid loss  3.85 | valid ppl    47.07 | valid bpc    5.557
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 32.0%
| epoch  33 |   100/  269 batches | lr 0.00015 | ms/batch 244.67 | loss  3.60 | ppl    36.52 
| epoch  33 |   200/  269 batches | lr 0.00015 | ms/batch 234.66 | loss  3.57 | ppl    35.46 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 65.62s | valid loss  3.89 | valid ppl    48.72 | valid bpc    5.606
-----------------------------------------------------------------------------------------
PROGRESS: 33.0%
| epoch  34 |   100/  269 batches | lr 0.00015 | ms/batch 248.23 | loss  3.58 | ppl    35.90 
| epoch  34 |   200/  269 batches | lr 0.00015 | ms/batch 233.66 | loss  3.57 | ppl    35.35 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 65.94s | valid loss  3.88 | valid ppl    48.58 | valid bpc    5.602
-----------------------------------------------------------------------------------------
PROGRESS: 34.0%
| epoch  35 |   100/  269 batches | lr 0.00015 | ms/batch 248.69 | loss  3.56 | ppl    35.34 
| epoch  35 |   200/  269 batches | lr 0.00015 | ms/batch 233.48 | loss  3.53 | ppl    34.18 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 65.96s | valid loss  3.93 | valid ppl    51.05 | valid bpc    5.674
-----------------------------------------------------------------------------------------
PROGRESS: 35.0%
| epoch  36 |   100/  269 batches | lr 0.00007 | ms/batch 248.37 | loss  3.52 | ppl    33.67 
| epoch  36 |   200/  269 batches | lr 0.00007 | ms/batch 229.97 | loss  3.45 | ppl    31.55 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 65.63s | valid loss  3.87 | valid ppl    47.77 | valid bpc    5.578
-----------------------------------------------------------------------------------------
PROGRESS: 36.0%
| epoch  37 |   100/  269 batches | lr 0.00007 | ms/batch 244.71 | loss  3.46 | ppl    31.85 
| epoch  37 |   200/  269 batches | lr 0.00007 | ms/batch 232.85 | loss  3.43 | ppl    30.93 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 65.59s | valid loss  3.83 | valid ppl    45.93 | valid bpc    5.521
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 37.0%
| epoch  38 |   100/  269 batches | lr 0.00007 | ms/batch 248.33 | loss  3.43 | ppl    31.03 
| epoch  38 |   200/  269 batches | lr 0.00007 | ms/batch 233.81 | loss  3.42 | ppl    30.46 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 65.95s | valid loss  3.83 | valid ppl    45.91 | valid bpc    5.521
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 38.0%
| epoch  39 |   100/  269 batches | lr 0.00007 | ms/batch 246.40 | loss  3.44 | ppl    31.28 
| epoch  39 |   200/  269 batches | lr 0.00007 | ms/batch 229.93 | loss  3.41 | ppl    30.24 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 65.26s | valid loss  3.83 | valid ppl    46.16 | valid bpc    5.529
-----------------------------------------------------------------------------------------
PROGRESS: 39.0%
| epoch  40 |   100/  269 batches | lr 0.00007 | ms/batch 249.02 | loss  3.42 | ppl    30.44 
| epoch  40 |   200/  269 batches | lr 0.00007 | ms/batch 229.70 | loss  3.38 | ppl    29.32 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 65.58s | valid loss  3.85 | valid ppl    47.15 | valid bpc    5.559
-----------------------------------------------------------------------------------------
PROGRESS: 40.0%
| epoch  41 |   100/  269 batches | lr 0.00007 | ms/batch 244.78 | loss  3.40 | ppl    30.06 
| epoch  41 |   200/  269 batches | lr 0.00007 | ms/batch 230.27 | loss  3.38 | ppl    29.37 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 65.28s | valid loss  3.80 | valid ppl    44.89 | valid bpc    5.488
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 41.0%
| epoch  42 |   100/  269 batches | lr 0.00007 | ms/batch 249.05 | loss  3.37 | ppl    29.02 
| epoch  42 |   200/  269 batches | lr 0.00007 | ms/batch 232.42 | loss  3.37 | ppl    29.13 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 65.90s | valid loss  3.81 | valid ppl    45.07 | valid bpc    5.494
-----------------------------------------------------------------------------------------
PROGRESS: 42.0%
| epoch  43 |   100/  269 batches | lr 0.00007 | ms/batch 245.16 | loss  3.38 | ppl    29.27 
| epoch  43 |   200/  269 batches | lr 0.00007 | ms/batch 230.25 | loss  3.36 | ppl    28.87 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 65.23s | valid loss  3.76 | valid ppl    42.99 | valid bpc    5.426
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 43.0%
| epoch  44 |   100/  269 batches | lr 0.00007 | ms/batch 248.39 | loss  3.37 | ppl    29.04 
| epoch  44 |   200/  269 batches | lr 0.00007 | ms/batch 234.64 | loss  3.33 | ppl    27.94 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 65.98s | valid loss  3.79 | valid ppl    44.44 | valid bpc    5.474
-----------------------------------------------------------------------------------------
PROGRESS: 44.0%
| epoch  45 |   100/  269 batches | lr 0.00007 | ms/batch 242.59 | loss  3.35 | ppl    28.56 
| epoch  45 |   200/  269 batches | lr 0.00007 | ms/batch 239.40 | loss  3.33 | ppl    27.96 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 65.93s | valid loss  3.78 | valid ppl    43.83 | valid bpc    5.454
-----------------------------------------------------------------------------------------
PROGRESS: 45.0%
| epoch  46 |   100/  269 batches | lr 0.00007 | ms/batch 242.86 | loss  3.33 | ppl    27.89 
| epoch  46 |   200/  269 batches | lr 0.00007 | ms/batch 240.09 | loss  3.32 | ppl    27.54 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 65.99s | valid loss  3.82 | valid ppl    45.77 | valid bpc    5.516
-----------------------------------------------------------------------------------------
PROGRESS: 46.0%
| epoch  47 |   100/  269 batches | lr 0.00004 | ms/batch 239.93 | loss  3.31 | ppl    27.47 
| epoch  47 |   200/  269 batches | lr 0.00004 | ms/batch 239.63 | loss  3.32 | ppl    27.64 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 65.61s | valid loss  3.81 | valid ppl    45.26 | valid bpc    5.500
-----------------------------------------------------------------------------------------
PROGRESS: 47.0%
| epoch  48 |   100/  269 batches | lr 0.00004 | ms/batch 242.17 | loss  3.30 | ppl    27.21 
| epoch  48 |   200/  269 batches | lr 0.00004 | ms/batch 239.22 | loss  3.26 | ppl    26.13 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 66.02s | valid loss  3.81 | valid ppl    45.11 | valid bpc    5.495
-----------------------------------------------------------------------------------------
PROGRESS: 48.0%
| epoch  49 |   100/  269 batches | lr 0.00004 | ms/batch 238.21 | loss  3.30 | ppl    27.05 
| epoch  49 |   200/  269 batches | lr 0.00004 | ms/batch 239.76 | loss  3.28 | ppl    26.58 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 65.60s | valid loss  3.83 | valid ppl    45.91 | valid bpc    5.521
-----------------------------------------------------------------------------------------
PROGRESS: 49.0%
| epoch  50 |   100/  269 batches | lr 0.00002 | ms/batch 242.94 | loss  3.26 | ppl    26.11 
| epoch  50 |   200/  269 batches | lr 0.00002 | ms/batch 238.99 | loss  3.24 | ppl    25.52 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 65.96s | valid loss  3.79 | valid ppl    44.15 | valid bpc    5.464
-----------------------------------------------------------------------------------------
PROGRESS: 50.0%
| epoch  51 |   100/  269 batches | lr 0.00002 | ms/batch 239.39 | loss  3.26 | ppl    26.06 
| epoch  51 |   200/  269 batches | lr 0.00002 | ms/batch 240.08 | loss  3.27 | ppl    26.23 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 65.64s | valid loss  3.79 | valid ppl    44.10 | valid bpc    5.463
-----------------------------------------------------------------------------------------
PROGRESS: 51.0%
| epoch  52 |   100/  269 batches | lr 0.00002 | ms/batch 239.03 | loss  3.25 | ppl    25.78 
| epoch  52 |   200/  269 batches | lr 0.00002 | ms/batch 240.73 | loss  3.25 | ppl    25.86 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 65.65s | valid loss  3.83 | valid ppl    45.88 | valid bpc    5.520
-----------------------------------------------------------------------------------------
PROGRESS: 52.0%
| epoch  53 |   100/  269 batches | lr 0.00001 | ms/batch 240.63 | loss  3.27 | ppl    26.41 
| epoch  53 |   200/  269 batches | lr 0.00001 | ms/batch 237.76 | loss  3.22 | ppl    25.12 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 65.62s | valid loss  3.78 | valid ppl    43.95 | valid bpc    5.458
-----------------------------------------------------------------------------------------
PROGRESS: 53.0%
| epoch  54 |   100/  269 batches | lr 0.00001 | ms/batch 246.43 | loss  3.25 | ppl    25.80 
| epoch  54 |   200/  269 batches | lr 0.00001 | ms/batch 234.89 | loss  3.23 | ppl    25.38 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 66.00s | valid loss  3.80 | valid ppl    44.57 | valid bpc    5.478
-----------------------------------------------------------------------------------------
PROGRESS: 54.0%
| epoch  55 |   100/  269 batches | lr 0.00001 | ms/batch 248.47 | loss  3.24 | ppl    25.55 
| epoch  55 |   200/  269 batches | lr 0.00001 | ms/batch 234.23 | loss  3.25 | ppl    25.75 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 65.97s | valid loss  3.77 | valid ppl    43.59 | valid bpc    5.446
-----------------------------------------------------------------------------------------
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  269 batches | lr 0.00000 | ms/batch 249.44 | loss  3.26 | ppl    26.09 
| epoch  56 |   200/  269 batches | lr 0.00000 | ms/batch 233.38 | loss  3.21 | ppl    24.67 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 66.02s | valid loss  3.74 | valid ppl    41.91 | valid bpc    5.389
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  269 batches | lr 0.00000 | ms/batch 243.73 | loss  3.24 | ppl    25.61 
| epoch  57 |   200/  269 batches | lr 0.00000 | ms/batch 235.02 | loss  3.22 | ppl    24.93 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 65.57s | valid loss  3.83 | valid ppl    46.20 | valid bpc    5.530
-----------------------------------------------------------------------------------------
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  269 batches | lr 0.00000 | ms/batch 249.36 | loss  3.24 | ppl    25.49 
| epoch  58 |   200/  269 batches | lr 0.00000 | ms/batch 233.23 | loss  3.21 | ppl    24.73 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 65.41s | valid loss  3.77 | valid ppl    43.56 | valid bpc    5.445
-----------------------------------------------------------------------------------------
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  269 batches | lr 0.00000 | ms/batch 254.32 | loss  3.26 | ppl    26.05 
| epoch  59 |   200/  269 batches | lr 0.00000 | ms/batch 234.45 | loss  3.22 | ppl    24.96 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 66.00s | valid loss  3.80 | valid ppl    44.49 | valid bpc    5.475
-----------------------------------------------------------------------------------------
PROGRESS: 59.0%
| epoch  60 |   100/  269 batches | lr 0.00000 | ms/batch 253.71 | loss  3.25 | ppl    25.84 
| epoch  60 |   200/  269 batches | lr 0.00000 | ms/batch 232.84 | loss  3.21 | ppl    24.83 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 65.95s | valid loss  3.75 | valid ppl    42.36 | valid bpc    5.405
-----------------------------------------------------------------------------------------
PROGRESS: 60.0%
| epoch  61 |   100/  269 batches | lr 0.00000 | ms/batch 256.17 | loss  3.25 | ppl    25.66 
| epoch  61 |   200/  269 batches | lr 0.00000 | ms/batch 233.02 | loss  3.22 | ppl    25.03 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 66.04s | valid loss  3.80 | valid ppl    44.80 | valid bpc    5.485
-----------------------------------------------------------------------------------------
PROGRESS: 61.0%
| epoch  62 |   100/  269 batches | lr 0.00000 | ms/batch 254.13 | loss  3.20 | ppl    24.58 
| epoch  62 |   200/  269 batches | lr 0.00000 | ms/batch 235.19 | loss  3.25 | ppl    25.81 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 66.08s | valid loss  3.78 | valid ppl    43.78 | valid bpc    5.452
-----------------------------------------------------------------------------------------
PROGRESS: 62.0%
| epoch  63 |   100/  269 batches | lr 0.00000 | ms/batch 254.33 | loss  3.24 | ppl    25.49 
| epoch  63 |   200/  269 batches | lr 0.00000 | ms/batch 233.39 | loss  3.22 | ppl    24.93 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 65.94s | valid loss  3.79 | valid ppl    44.32 | valid bpc    5.470
-----------------------------------------------------------------------------------------
PROGRESS: 63.0%
| epoch  64 |   100/  269 batches | lr 0.00000 | ms/batch 252.50 | loss  3.21 | ppl    24.85 
| epoch  64 |   200/  269 batches | lr 0.00000 | ms/batch 235.41 | loss  3.23 | ppl    25.23 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 65.98s | valid loss  3.82 | valid ppl    45.47 | valid bpc    5.507
-----------------------------------------------------------------------------------------
PROGRESS: 64.0%
| epoch  65 |   100/  269 batches | lr 0.00000 | ms/batch 253.67 | loss  3.24 | ppl    25.56 
| epoch  65 |   200/  269 batches | lr 0.00000 | ms/batch 235.08 | loss  3.22 | ppl    25.04 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 66.02s | valid loss  3.81 | valid ppl    45.13 | valid bpc    5.496
-----------------------------------------------------------------------------------------
PROGRESS: 65.0%
| epoch  66 |   100/  269 batches | lr 0.00000 | ms/batch 254.87 | loss  3.24 | ppl    25.58 
| epoch  66 |   200/  269 batches | lr 0.00000 | ms/batch 229.08 | loss  3.21 | ppl    24.85 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 66.02s | valid loss  3.80 | valid ppl    44.54 | valid bpc    5.477
-----------------------------------------------------------------------------------------
PROGRESS: 66.0%
| epoch  67 |   100/  269 batches | lr 0.00000 | ms/batch 254.40 | loss  3.24 | ppl    25.42 
| epoch  67 |   200/  269 batches | lr 0.00000 | ms/batch 223.65 | loss  3.19 | ppl    24.39 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 65.61s | valid loss  3.77 | valid ppl    43.42 | valid bpc    5.440
-----------------------------------------------------------------------------------------
PROGRESS: 67.0%
| epoch  68 |   100/  269 batches | lr 0.00000 | ms/batch 254.08 | loss  3.24 | ppl    25.44 
| epoch  68 |   200/  269 batches | lr 0.00000 | ms/batch 228.04 | loss  3.22 | ppl    25.13 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 66.00s | valid loss  3.73 | valid ppl    41.85 | valid bpc    5.387
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 68.0%
| epoch  69 |   100/  269 batches | lr 0.00000 | ms/batch 253.60 | loss  3.24 | ppl    25.52 
| epoch  69 |   200/  269 batches | lr 0.00000 | ms/batch 227.68 | loss  3.20 | ppl    24.57 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 66.00s | valid loss  3.76 | valid ppl    43.09 | valid bpc    5.429
-----------------------------------------------------------------------------------------
PROGRESS: 69.0%
| epoch  70 |   100/  269 batches | lr 0.00000 | ms/batch 253.77 | loss  3.24 | ppl    25.52 
| epoch  70 |   200/  269 batches | lr 0.00000 | ms/batch 228.40 | loss  3.22 | ppl    25.15 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 65.94s | valid loss  3.77 | valid ppl    43.57 | valid bpc    5.445
-----------------------------------------------------------------------------------------
PROGRESS: 70.0%
| epoch  71 |   100/  269 batches | lr 0.00000 | ms/batch 254.22 | loss  3.25 | ppl    25.74 
| epoch  71 |   200/  269 batches | lr 0.00000 | ms/batch 228.36 | loss  3.21 | ppl    24.73 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 66.03s | valid loss  3.76 | valid ppl    42.78 | valid bpc    5.419
-----------------------------------------------------------------------------------------
PROGRESS: 71.0%
| epoch  72 |   100/  269 batches | lr 0.00000 | ms/batch 253.06 | loss  3.23 | ppl    25.38 
| epoch  72 |   200/  269 batches | lr 0.00000 | ms/batch 228.53 | loss  3.21 | ppl    24.77 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 66.03s | valid loss  3.78 | valid ppl    43.67 | valid bpc    5.449
-----------------------------------------------------------------------------------------
PROGRESS: 72.0%
| epoch  73 |   100/  269 batches | lr 0.00000 | ms/batch 253.65 | loss  3.23 | ppl    25.32 
| epoch  73 |   200/  269 batches | lr 0.00000 | ms/batch 224.45 | loss  3.21 | ppl    24.71 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 65.66s | valid loss  3.81 | valid ppl    45.00 | valid bpc    5.492
-----------------------------------------------------------------------------------------
PROGRESS: 73.0%
| epoch  74 |   100/  269 batches | lr 0.00000 | ms/batch 254.74 | loss  3.24 | ppl    25.48 
| epoch  74 |   200/  269 batches | lr 0.00000 | ms/batch 227.24 | loss  3.18 | ppl    24.15 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 65.93s | valid loss  3.81 | valid ppl    44.98 | valid bpc    5.491
-----------------------------------------------------------------------------------------
PROGRESS: 74.0%
| epoch  75 |   100/  269 batches | lr 0.00000 | ms/batch 254.11 | loss  3.25 | ppl    25.69 
| epoch  75 |   200/  269 batches | lr 0.00000 | ms/batch 228.33 | loss  3.21 | ppl    24.72 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 66.01s | valid loss  3.78 | valid ppl    43.67 | valid bpc    5.449
-----------------------------------------------------------------------------------------
PROGRESS: 75.0%
| epoch  76 |   100/  269 batches | lr 0.00000 | ms/batch 253.85 | loss  3.24 | ppl    25.44 
| epoch  76 |   200/  269 batches | lr 0.00000 | ms/batch 227.81 | loss  3.20 | ppl    24.54 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 66.01s | valid loss  3.79 | valid ppl    44.40 | valid bpc    5.472
-----------------------------------------------------------------------------------------
PROGRESS: 76.0%
| epoch  77 |   100/  269 batches | lr 0.00000 | ms/batch 254.47 | loss  3.27 | ppl    26.22 
| epoch  77 |   200/  269 batches | lr 0.00000 | ms/batch 229.32 | loss  3.20 | ppl    24.42 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 65.99s | valid loss  3.78 | valid ppl    43.90 | valid bpc    5.456
-----------------------------------------------------------------------------------------
PROGRESS: 77.0%
| epoch  78 |   100/  269 batches | lr 0.00000 | ms/batch 247.74 | loss  3.25 | ppl    25.81 
| epoch  78 |   200/  269 batches | lr 0.00000 | ms/batch 233.65 | loss  3.21 | ppl    24.90 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 66.03s | valid loss  3.80 | valid ppl    44.74 | valid bpc    5.483
-----------------------------------------------------------------------------------------
PROGRESS: 78.0%
| epoch  79 |   100/  269 batches | lr 0.00000 | ms/batch 247.83 | loss  3.25 | ppl    25.86 
| epoch  79 |   200/  269 batches | lr 0.00000 | ms/batch 234.33 | loss  3.21 | ppl    24.78 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 65.97s | valid loss  3.75 | valid ppl    42.58 | valid bpc    5.412
-----------------------------------------------------------------------------------------
PROGRESS: 79.0%
| epoch  80 |   100/  269 batches | lr 0.00000 | ms/batch 248.40 | loss  3.24 | ppl    25.62 
| epoch  80 |   200/  269 batches | lr 0.00000 | ms/batch 234.71 | loss  3.21 | ppl    24.68 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 66.02s | valid loss  3.74 | valid ppl    42.19 | valid bpc    5.399
-----------------------------------------------------------------------------------------
PROGRESS: 80.0%
| epoch  81 |   100/  269 batches | lr 0.00000 | ms/batch 249.46 | loss  3.22 | ppl    25.02 
| epoch  81 |   200/  269 batches | lr 0.00000 | ms/batch 234.12 | loss  3.21 | ppl    24.79 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 66.01s | valid loss  3.78 | valid ppl    43.86 | valid bpc    5.455
-----------------------------------------------------------------------------------------
PROGRESS: 81.0%
| epoch  82 |   100/  269 batches | lr 0.00000 | ms/batch 248.50 | loss  3.23 | ppl    25.22 
| epoch  82 |   200/  269 batches | lr 0.00000 | ms/batch 234.15 | loss  3.23 | ppl    25.35 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 65.95s | valid loss  3.73 | valid ppl    41.73 | valid bpc    5.383
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 82.0%
| epoch  83 |   100/  269 batches | lr 0.00000 | ms/batch 249.36 | loss  3.24 | ppl    25.55 
| epoch  83 |   200/  269 batches | lr 0.00000 | ms/batch 233.60 | loss  3.19 | ppl    24.36 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 66.02s | valid loss  3.75 | valid ppl    42.42 | valid bpc    5.407
-----------------------------------------------------------------------------------------
PROGRESS: 83.0%
| epoch  84 |   100/  269 batches | lr 0.00000 | ms/batch 249.11 | loss  3.25 | ppl    25.74 
| epoch  84 |   200/  269 batches | lr 0.00000 | ms/batch 233.81 | loss  3.21 | ppl    24.88 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 66.02s | valid loss  3.72 | valid ppl    41.17 | valid bpc    5.364
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 84.0%
| epoch  85 |   100/  269 batches | lr 0.00000 | ms/batch 244.78 | loss  3.24 | ppl    25.65 
| epoch  85 |   200/  269 batches | lr 0.00000 | ms/batch 234.86 | loss  3.20 | ppl    24.49 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 65.63s | valid loss  3.81 | valid ppl    45.18 | valid bpc    5.498
-----------------------------------------------------------------------------------------
PROGRESS: 85.0%
| epoch  86 |   100/  269 batches | lr 0.00000 | ms/batch 248.12 | loss  3.24 | ppl    25.61 
| epoch  86 |   200/  269 batches | lr 0.00000 | ms/batch 233.78 | loss  3.21 | ppl    24.88 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 66.00s | valid loss  3.77 | valid ppl    43.53 | valid bpc    5.444
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  269 batches | lr 0.00000 | ms/batch 248.23 | loss  3.23 | ppl    25.29 
| epoch  87 |   200/  269 batches | lr 0.00000 | ms/batch 233.11 | loss  3.22 | ppl    24.99 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 65.97s | valid loss  3.77 | valid ppl    43.19 | valid bpc    5.432
-----------------------------------------------------------------------------------------
PROGRESS: 87.0%
| epoch  88 |   100/  269 batches | lr 0.00000 | ms/batch 249.06 | loss  3.25 | ppl    25.85 
| epoch  88 |   200/  269 batches | lr 0.00000 | ms/batch 233.89 | loss  3.20 | ppl    24.55 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 65.85s | valid loss  3.79 | valid ppl    44.29 | valid bpc    5.469
-----------------------------------------------------------------------------------------
PROGRESS: 88.0%
| epoch  89 |   100/  269 batches | lr 0.00000 | ms/batch 251.44 | loss  3.24 | ppl    25.61 
| epoch  89 |   200/  269 batches | lr 0.00000 | ms/batch 233.38 | loss  3.21 | ppl    24.90 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 65.62s | valid loss  3.84 | valid ppl    46.31 | valid bpc    5.533
-----------------------------------------------------------------------------------------
PROGRESS: 89.0%
| epoch  90 |   100/  269 batches | lr 0.00000 | ms/batch 254.13 | loss  3.22 | ppl    25.11 
| epoch  90 |   200/  269 batches | lr 0.00000 | ms/batch 235.62 | loss  3.22 | ppl    25.15 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 66.02s | valid loss  3.84 | valid ppl    46.44 | valid bpc    5.537
-----------------------------------------------------------------------------------------
PROGRESS: 90.0%
| epoch  91 |   100/  269 batches | lr 0.00000 | ms/batch 255.05 | loss  3.24 | ppl    25.46 
| epoch  91 |   200/  269 batches | lr 0.00000 | ms/batch 236.24 | loss  3.22 | ppl    25.14 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 65.96s | valid loss  3.81 | valid ppl    45.32 | valid bpc    5.502
-----------------------------------------------------------------------------------------
PROGRESS: 91.0%
| epoch  92 |   100/  269 batches | lr 0.00000 | ms/batch 253.53 | loss  3.24 | ppl    25.57 
| epoch  92 |   200/  269 batches | lr 0.00000 | ms/batch 239.97 | loss  3.21 | ppl    24.69 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 65.97s | valid loss  3.80 | valid ppl    44.85 | valid bpc    5.487
-----------------------------------------------------------------------------------------
PROGRESS: 92.0%
| epoch  93 |   100/  269 batches | lr 0.00000 | ms/batch 253.89 | loss  3.25 | ppl    25.70 
| epoch  93 |   200/  269 batches | lr 0.00000 | ms/batch 240.20 | loss  3.21 | ppl    24.69 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 66.00s | valid loss  3.77 | valid ppl    43.18 | valid bpc    5.432
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  269 batches | lr 0.00000 | ms/batch 253.41 | loss  3.23 | ppl    25.37 
| epoch  94 |   200/  269 batches | lr 0.00000 | ms/batch 240.56 | loss  3.21 | ppl    24.88 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 63.09s | valid loss  3.78 | valid ppl    43.95 | valid bpc    5.458
-----------------------------------------------------------------------------------------
PROGRESS: 94.0%
| epoch  95 |   100/  269 batches | lr 0.00000 | ms/batch 179.44 | loss  3.25 | ppl    25.87 
| epoch  95 |   200/  269 batches | lr 0.00000 | ms/batch 170.25 | loss  3.19 | ppl    24.29 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 46.98s | valid loss  3.79 | valid ppl    44.47 | valid bpc    5.475
-----------------------------------------------------------------------------------------
PROGRESS: 95.0%
| epoch  96 |   100/  269 batches | lr 0.00000 | ms/batch 175.37 | loss  3.24 | ppl    25.64 
| epoch  96 |   200/  269 batches | lr 0.00000 | ms/batch 159.24 | loss  3.21 | ppl    24.84 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 44.69s | valid loss  3.80 | valid ppl    44.68 | valid bpc    5.482
-----------------------------------------------------------------------------------------
PROGRESS: 96.0%
| epoch  97 |   100/  269 batches | lr 0.00000 | ms/batch 197.37 | loss  3.24 | ppl    25.60 
| epoch  97 |   200/  269 batches | lr 0.00000 | ms/batch 238.44 | loss  3.21 | ppl    24.77 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 60.86s | valid loss  3.78 | valid ppl    44.02 | valid bpc    5.460
-----------------------------------------------------------------------------------------
PROGRESS: 97.0%
| epoch  98 |   100/  269 batches | lr 0.00000 | ms/batch 244.99 | loss  3.22 | ppl    25.15 
| epoch  98 |   200/  269 batches | lr 0.00000 | ms/batch 238.83 | loss  3.23 | ppl    25.21 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 65.60s | valid loss  3.78 | valid ppl    43.91 | valid bpc    5.456
-----------------------------------------------------------------------------------------
PROGRESS: 98.0%
| epoch  99 |   100/  269 batches | lr 0.00000 | ms/batch 244.49 | loss  3.25 | ppl    25.91 
| epoch  99 |   200/  269 batches | lr 0.00000 | ms/batch 239.76 | loss  3.20 | ppl    24.63 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 62.72s | valid loss  3.78 | valid ppl    43.88 | valid bpc    5.456
-----------------------------------------------------------------------------------------
PROGRESS: 99.0%
| epoch 100 |   100/  269 batches | lr 0.00000 | ms/batch 167.62 | loss  3.23 | ppl    25.37 
| epoch 100 |   200/  269 batches | lr 0.00000 | ms/batch 171.58 | loss  3.22 | ppl    24.98 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 46.56s | valid loss  3.78 | valid ppl    44.01 | valid bpc    5.460
-----------------------------------------------------------------------------------------
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  3.84 | test ppl    46.63 | test bpc    5.543
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.4726, Mean Reca: 0.6657, Mean F1: 0.5483, Mean Subword_Reca: 0.8585
-----------------------------------------------------------------------------------------
=========================================================================================
Loading dataset...
Using subword tokenizer...
Number of tokens:  8000
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer_in_parser', nhid=512, nlayers=8, front_layers=4, rear_layers=4, subword='omarmomen/ptb_filtered_lowcase_bpe_tokenizer_8', n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=3333, nonmono=5, cuda=True, log_interval=100, save='trained_models/subword_structformer_in_parser_3333_44.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 37449092
Model architecture: StructFormer_In_Parser(
  (transformer_front): Transformer_Front(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(8000, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-3): 4 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
  (transformer_rear): Transformer_Rear(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(8000, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-3): 4 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (output_layer): Linear(in_features=512, out_features=8000, bias=True)
  )
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  269 batches | lr 0.00030 | ms/batch 253.47 | loss  7.73 | ppl  2278.91 
| epoch   1 |   200/  269 batches | lr 0.00030 | ms/batch 229.17 | loss  7.38 | ppl  1600.83 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 66.09s | valid loss  7.33 | valid ppl  1522.06 | valid bpc   10.572
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  269 batches | lr 0.00030 | ms/batch 245.53 | loss  7.40 | ppl  1632.00 
| epoch   2 |   200/  269 batches | lr 0.00030 | ms/batch 227.96 | loss  7.29 | ppl  1464.18 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 65.20s | valid loss  7.05 | valid ppl  1155.93 | valid bpc   10.175
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  269 batches | lr 0.00030 | ms/batch 249.46 | loss  7.26 | ppl  1416.47 
| epoch   3 |   200/  269 batches | lr 0.00030 | ms/batch 226.45 | loss  7.12 | ppl  1238.86 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 65.25s | valid loss  6.94 | valid ppl  1033.64 | valid bpc   10.014
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  269 batches | lr 0.00030 | ms/batch 251.08 | loss  7.14 | ppl  1257.11 
| epoch   4 |   200/  269 batches | lr 0.00030 | ms/batch 223.86 | loss  7.03 | ppl  1127.77 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 65.25s | valid loss  6.70 | valid ppl   808.43 | valid bpc    9.659
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  269 batches | lr 0.00030 | ms/batch 253.82 | loss  6.78 | ppl   877.99 
| epoch   5 |   200/  269 batches | lr 0.00030 | ms/batch 222.70 | loss  6.55 | ppl   695.89 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 65.38s | valid loss  6.10 | valid ppl   446.03 | valid bpc    8.801
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  269 batches | lr 0.00030 | ms/batch 253.92 | loss  6.25 | ppl   518.08 
| epoch   6 |   200/  269 batches | lr 0.00030 | ms/batch 220.08 | loss  6.06 | ppl   426.84 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 65.16s | valid loss  5.76 | valid ppl   317.69 | valid bpc    8.311
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  269 batches | lr 0.00030 | ms/batch 254.60 | loss  5.92 | ppl   373.91 
| epoch   7 |   200/  269 batches | lr 0.00030 | ms/batch 217.50 | loss  5.81 | ppl   333.36 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 64.91s | valid loss  5.58 | valid ppl   263.87 | valid bpc    8.044
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  269 batches | lr 0.00030 | ms/batch 250.88 | loss  5.70 | ppl   299.65 
| epoch   8 |   200/  269 batches | lr 0.00030 | ms/batch 226.02 | loss  5.60 | ppl   271.30 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 65.29s | valid loss  5.40 | valid ppl   220.72 | valid bpc    7.786
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 8.0%
| epoch   9 |   100/  269 batches | lr 0.00030 | ms/batch 245.53 | loss  5.55 | ppl   257.97 
| epoch   9 |   200/  269 batches | lr 0.00030 | ms/batch 229.22 | loss  5.44 | ppl   230.95 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 65.26s | valid loss  5.28 | valid ppl   196.87 | valid bpc    7.621
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  269 batches | lr 0.00030 | ms/batch 244.65 | loss  5.42 | ppl   225.27 
| epoch  10 |   200/  269 batches | lr 0.00030 | ms/batch 229.32 | loss  5.32 | ppl   203.56 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 65.29s | valid loss  5.13 | valid ppl   169.51 | valid bpc    7.405
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  269 batches | lr 0.00030 | ms/batch 245.36 | loss  5.30 | ppl   200.32 
| epoch  11 |   200/  269 batches | lr 0.00030 | ms/batch 230.79 | loss  5.22 | ppl   184.78 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 65.31s | valid loss  5.04 | valid ppl   155.17 | valid bpc    7.278
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  269 batches | lr 0.00030 | ms/batch 244.78 | loss  5.17 | ppl   176.11 
| epoch  12 |   200/  269 batches | lr 0.00030 | ms/batch 231.07 | loss  5.11 | ppl   166.00 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 65.38s | valid loss  4.94 | valid ppl   139.42 | valid bpc    7.123
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 12.0%
| epoch  13 |   100/  269 batches | lr 0.00030 | ms/batch 243.18 | loss  5.08 | ppl   161.12 
| epoch  13 |   200/  269 batches | lr 0.00030 | ms/batch 231.33 | loss  5.03 | ppl   153.30 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 65.23s | valid loss  4.91 | valid ppl   135.80 | valid bpc    7.085
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 13.0%
| epoch  14 |   100/  269 batches | lr 0.00030 | ms/batch 244.57 | loss  4.99 | ppl   146.37 
| epoch  14 |   200/  269 batches | lr 0.00030 | ms/batch 231.31 | loss  4.95 | ppl   141.12 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 65.31s | valid loss  4.83 | valid ppl   125.11 | valid bpc    6.967
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  269 batches | lr 0.00030 | ms/batch 248.29 | loss  4.94 | ppl   139.31 
| epoch  15 |   200/  269 batches | lr 0.00030 | ms/batch 229.69 | loss  4.85 | ppl   127.65 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 65.58s | valid loss  4.75 | valid ppl   115.46 | valid bpc    6.851
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 15.0%
| epoch  16 |   100/  269 batches | lr 0.00030 | ms/batch 243.37 | loss  4.84 | ppl   126.58 
| epoch  16 |   200/  269 batches | lr 0.00030 | ms/batch 231.27 | loss  4.79 | ppl   120.88 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 65.23s | valid loss  4.64 | valid ppl   103.23 | valid bpc    6.690
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 16.0%
| epoch  17 |   100/  269 batches | lr 0.00030 | ms/batch 244.60 | loss  4.76 | ppl   116.36 
| epoch  17 |   200/  269 batches | lr 0.00030 | ms/batch 232.94 | loss  4.72 | ppl   111.77 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 65.65s | valid loss  4.59 | valid ppl    98.55 | valid bpc    6.623
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 17.0%
| epoch  18 |   100/  269 batches | lr 0.00030 | ms/batch 247.57 | loss  4.68 | ppl   107.69 
| epoch  18 |   200/  269 batches | lr 0.00030 | ms/batch 231.17 | loss  4.66 | ppl   105.14 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 65.71s | valid loss  4.55 | valid ppl    94.70 | valid bpc    6.565
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 18.0%
| epoch  19 |   100/  269 batches | lr 0.00030 | ms/batch 247.10 | loss  4.61 | ppl   100.18 
| epoch  19 |   200/  269 batches | lr 0.00030 | ms/batch 230.53 | loss  4.59 | ppl    98.65 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 64.98s | valid loss  4.50 | valid ppl    90.36 | valid bpc    6.498
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 19.0%
| epoch  20 |   100/  269 batches | lr 0.00030 | ms/batch 254.56 | loss  4.53 | ppl    93.04 
| epoch  20 |   200/  269 batches | lr 0.00030 | ms/batch 231.01 | loss  4.50 | ppl    89.94 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 65.40s | valid loss  4.49 | valid ppl    89.28 | valid bpc    6.480
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 20.0%
| epoch  21 |   100/  269 batches | lr 0.00030 | ms/batch 253.34 | loss  4.47 | ppl    87.54 
| epoch  21 |   200/  269 batches | lr 0.00030 | ms/batch 234.15 | loss  4.44 | ppl    84.99 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 65.58s | valid loss  4.42 | valid ppl    83.39 | valid bpc    6.382
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 21.0%
| epoch  22 |   100/  269 batches | lr 0.00030 | ms/batch 254.74 | loss  4.43 | ppl    83.58 
| epoch  22 |   200/  269 batches | lr 0.00030 | ms/batch 230.21 | loss  4.41 | ppl    82.04 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 65.30s | valid loss  4.32 | valid ppl    75.45 | valid bpc    6.237
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 22.0%
| epoch  23 |   100/  269 batches | lr 0.00030 | ms/batch 253.69 | loss  4.36 | ppl    78.40 
| epoch  23 |   200/  269 batches | lr 0.00030 | ms/batch 230.76 | loss  4.33 | ppl    75.75 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 65.26s | valid loss  4.33 | valid ppl    75.71 | valid bpc    6.242
-----------------------------------------------------------------------------------------
PROGRESS: 23.0%
| epoch  24 |   100/  269 batches | lr 0.00030 | ms/batch 253.33 | loss  4.29 | ppl    73.11 
| epoch  24 |   200/  269 batches | lr 0.00030 | ms/batch 231.38 | loss  4.31 | ppl    74.44 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 65.32s | valid loss  4.26 | valid ppl    71.07 | valid bpc    6.151
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 24.0%
| epoch  25 |   100/  269 batches | lr 0.00030 | ms/batch 255.49 | loss  4.25 | ppl    69.96 
| epoch  25 |   200/  269 batches | lr 0.00030 | ms/batch 233.56 | loss  4.22 | ppl    68.36 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 65.65s | valid loss  4.28 | valid ppl    72.12 | valid bpc    6.172
-----------------------------------------------------------------------------------------
PROGRESS: 25.0%
| epoch  26 |   100/  269 batches | lr 0.00030 | ms/batch 254.48 | loss  4.23 | ppl    68.71 
| epoch  26 |   200/  269 batches | lr 0.00030 | ms/batch 230.34 | loss  4.16 | ppl    64.26 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 65.30s | valid loss  4.23 | valid ppl    68.49 | valid bpc    6.098
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 26.0%
| epoch  27 |   100/  269 batches | lr 0.00030 | ms/batch 252.95 | loss  4.18 | ppl    65.34 
| epoch  27 |   200/  269 batches | lr 0.00030 | ms/batch 234.81 | loss  4.13 | ppl    61.89 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 66.02s | valid loss  4.21 | valid ppl    67.24 | valid bpc    6.071
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 27.0%
| epoch  28 |   100/  269 batches | lr 0.00030 | ms/batch 253.87 | loss  4.10 | ppl    60.55 
| epoch  28 |   200/  269 batches | lr 0.00030 | ms/batch 229.44 | loss  4.08 | ppl    59.22 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 66.04s | valid loss  4.16 | valid ppl    64.10 | valid bpc    6.002
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  269 batches | lr 0.00030 | ms/batch 253.57 | loss  4.06 | ppl    58.04 
| epoch  29 |   200/  269 batches | lr 0.00030 | ms/batch 225.44 | loss  4.04 | ppl    57.00 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 65.64s | valid loss  4.11 | valid ppl    60.66 | valid bpc    5.923
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  269 batches | lr 0.00030 | ms/batch 254.70 | loss  4.02 | ppl    55.70 
| epoch  30 |   200/  269 batches | lr 0.00030 | ms/batch 224.58 | loss  3.97 | ppl    53.20 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 65.68s | valid loss  4.11 | valid ppl    61.05 | valid bpc    5.932
-----------------------------------------------------------------------------------------
PROGRESS: 30.0%
| epoch  31 |   100/  269 batches | lr 0.00030 | ms/batch 253.81 | loss  3.97 | ppl    53.17 
| epoch  31 |   200/  269 batches | lr 0.00030 | ms/batch 225.22 | loss  3.94 | ppl    51.50 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 65.62s | valid loss  4.12 | valid ppl    61.29 | valid bpc    5.938
-----------------------------------------------------------------------------------------
PROGRESS: 31.0%
| epoch  32 |   100/  269 batches | lr 0.00030 | ms/batch 253.68 | loss  3.95 | ppl    52.15 
| epoch  32 |   200/  269 batches | lr 0.00030 | ms/batch 222.10 | loss  3.93 | ppl    50.74 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 65.24s | valid loss  4.09 | valid ppl    59.71 | valid bpc    5.900
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 32.0%
| epoch  33 |   100/  269 batches | lr 0.00030 | ms/batch 254.42 | loss  3.89 | ppl    48.89 
| epoch  33 |   200/  269 batches | lr 0.00030 | ms/batch 224.90 | loss  3.89 | ppl    48.69 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 65.65s | valid loss  4.00 | valid ppl    54.33 | valid bpc    5.764
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 33.0%
| epoch  34 |   100/  269 batches | lr 0.00030 | ms/batch 254.02 | loss  3.86 | ppl    47.38 
| epoch  34 |   200/  269 batches | lr 0.00030 | ms/batch 220.44 | loss  3.82 | ppl    45.41 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 65.24s | valid loss  4.00 | valid ppl    54.61 | valid bpc    5.771
-----------------------------------------------------------------------------------------
PROGRESS: 34.0%
| epoch  35 |   100/  269 batches | lr 0.00030 | ms/batch 253.03 | loss  3.83 | ppl    45.96 
| epoch  35 |   200/  269 batches | lr 0.00030 | ms/batch 225.04 | loss  3.80 | ppl    44.63 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 65.59s | valid loss  4.01 | valid ppl    54.99 | valid bpc    5.781
-----------------------------------------------------------------------------------------
PROGRESS: 35.0%
| epoch  36 |   100/  269 batches | lr 0.00030 | ms/batch 253.15 | loss  3.80 | ppl    44.72 
| epoch  36 |   200/  269 batches | lr 0.00030 | ms/batch 228.34 | loss  3.75 | ppl    42.39 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 65.96s | valid loss  3.98 | valid ppl    53.45 | valid bpc    5.740
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 36.0%
| epoch  37 |   100/  269 batches | lr 0.00030 | ms/batch 253.53 | loss  3.73 | ppl    41.65 
| epoch  37 |   200/  269 batches | lr 0.00030 | ms/batch 225.69 | loss  3.74 | ppl    42.07 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 65.66s | valid loss  3.97 | valid ppl    52.77 | valid bpc    5.722
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 37.0%
| epoch  38 |   100/  269 batches | lr 0.00030 | ms/batch 254.55 | loss  3.71 | ppl    40.83 
| epoch  38 |   200/  269 batches | lr 0.00030 | ms/batch 224.35 | loss  3.69 | ppl    40.14 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 65.70s | valid loss  3.92 | valid ppl    50.48 | valid bpc    5.658
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 38.0%
| epoch  39 |   100/  269 batches | lr 0.00030 | ms/batch 248.93 | loss  3.67 | ppl    39.32 
| epoch  39 |   200/  269 batches | lr 0.00030 | ms/batch 233.24 | loss  3.68 | ppl    39.69 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 65.98s | valid loss  3.96 | valid ppl    52.28 | valid bpc    5.708
-----------------------------------------------------------------------------------------
PROGRESS: 39.0%
| epoch  40 |   100/  269 batches | lr 0.00030 | ms/batch 248.11 | loss  3.63 | ppl    37.55 
| epoch  40 |   200/  269 batches | lr 0.00030 | ms/batch 233.46 | loss  3.62 | ppl    37.47 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 65.64s | valid loss  3.90 | valid ppl    49.32 | valid bpc    5.624
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 40.0%
| epoch  41 |   100/  269 batches | lr 0.00030 | ms/batch 247.41 | loss  3.63 | ppl    37.74 
| epoch  41 |   200/  269 batches | lr 0.00030 | ms/batch 236.89 | loss  3.61 | ppl    37.10 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 65.65s | valid loss  4.00 | valid ppl    54.59 | valid bpc    5.771
-----------------------------------------------------------------------------------------
PROGRESS: 41.0%
| epoch  42 |   100/  269 batches | lr 0.00030 | ms/batch 245.15 | loss  3.57 | ppl    35.61 
| epoch  42 |   200/  269 batches | lr 0.00030 | ms/batch 240.68 | loss  3.57 | ppl    35.63 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 65.42s | valid loss  3.88 | valid ppl    48.26 | valid bpc    5.593
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 42.0%
| epoch  43 |   100/  269 batches | lr 0.00030 | ms/batch 248.06 | loss  3.55 | ppl    34.71 
| epoch  43 |   200/  269 batches | lr 0.00030 | ms/batch 240.48 | loss  3.54 | ppl    34.57 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 66.00s | valid loss  3.91 | valid ppl    49.79 | valid bpc    5.638
-----------------------------------------------------------------------------------------
PROGRESS: 43.0%
| epoch  44 |   100/  269 batches | lr 0.00030 | ms/batch 245.97 | loss  3.54 | ppl    34.57 
| epoch  44 |   200/  269 batches | lr 0.00030 | ms/batch 239.13 | loss  3.52 | ppl    33.75 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 65.65s | valid loss  3.93 | valid ppl    51.00 | valid bpc    5.673
-----------------------------------------------------------------------------------------
PROGRESS: 44.0%
| epoch  45 |   100/  269 batches | lr 0.00030 | ms/batch 247.89 | loss  3.48 | ppl    32.42 
| epoch  45 |   200/  269 batches | lr 0.00030 | ms/batch 238.56 | loss  3.50 | ppl    32.96 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 65.95s | valid loss  3.87 | valid ppl    47.84 | valid bpc    5.580
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 45.0%
| epoch  46 |   100/  269 batches | lr 0.00030 | ms/batch 247.57 | loss  3.46 | ppl    31.90 
| epoch  46 |   200/  269 batches | lr 0.00030 | ms/batch 239.70 | loss  3.46 | ppl    31.78 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 65.69s | valid loss  3.85 | valid ppl    46.83 | valid bpc    5.549
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 46.0%
| epoch  47 |   100/  269 batches | lr 0.00030 | ms/batch 243.90 | loss  3.43 | ppl    30.78 
| epoch  47 |   200/  269 batches | lr 0.00030 | ms/batch 240.08 | loss  3.44 | ppl    31.31 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 65.27s | valid loss  3.86 | valid ppl    47.50 | valid bpc    5.570
-----------------------------------------------------------------------------------------
PROGRESS: 47.0%
| epoch  48 |   100/  269 batches | lr 0.00030 | ms/batch 247.63 | loss  3.42 | ppl    30.55 
| epoch  48 |   200/  269 batches | lr 0.00030 | ms/batch 241.34 | loss  3.40 | ppl    29.99 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 66.00s | valid loss  3.88 | valid ppl    48.34 | valid bpc    5.595
-----------------------------------------------------------------------------------------
PROGRESS: 48.0%
| epoch  49 |   100/  269 batches | lr 0.00030 | ms/batch 247.66 | loss  3.38 | ppl    29.51 
| epoch  49 |   200/  269 batches | lr 0.00030 | ms/batch 238.77 | loss  3.38 | ppl    29.29 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 65.89s | valid loss  3.85 | valid ppl    46.94 | valid bpc    5.553
-----------------------------------------------------------------------------------------
PROGRESS: 49.0%
| epoch  50 |   100/  269 batches | lr 0.00015 | ms/batch 250.21 | loss  3.32 | ppl    27.65 
| epoch  50 |   200/  269 batches | lr 0.00015 | ms/batch 240.36 | loss  3.28 | ppl    26.60 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 65.53s | valid loss  3.71 | valid ppl    41.00 | valid bpc    5.358
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 50.0%
| epoch  51 |   100/  269 batches | lr 0.00015 | ms/batch 253.57 | loss  3.25 | ppl    25.91 
| epoch  51 |   200/  269 batches | lr 0.00015 | ms/batch 239.47 | loss  3.25 | ppl    25.74 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 65.62s | valid loss  3.78 | valid ppl    43.91 | valid bpc    5.456
-----------------------------------------------------------------------------------------
PROGRESS: 51.0%
| epoch  52 |   100/  269 batches | lr 0.00015 | ms/batch 253.54 | loss  3.24 | ppl    25.51 
| epoch  52 |   200/  269 batches | lr 0.00015 | ms/batch 240.10 | loss  3.23 | ppl    25.32 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 65.99s | valid loss  3.82 | valid ppl    45.82 | valid bpc    5.518
-----------------------------------------------------------------------------------------
PROGRESS: 52.0%
| epoch  53 |   100/  269 batches | lr 0.00015 | ms/batch 255.31 | loss  3.20 | ppl    24.55 
| epoch  53 |   200/  269 batches | lr 0.00015 | ms/batch 238.47 | loss  3.18 | ppl    23.94 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 65.55s | valid loss  3.79 | valid ppl    44.37 | valid bpc    5.472
-----------------------------------------------------------------------------------------
PROGRESS: 53.0%
| epoch  54 |   100/  269 batches | lr 0.00007 | ms/batch 255.36 | loss  3.17 | ppl    23.82 
| epoch  54 |   200/  269 batches | lr 0.00007 | ms/batch 239.02 | loss  3.15 | ppl    23.29 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 65.58s | valid loss  3.73 | valid ppl    41.56 | valid bpc    5.377
-----------------------------------------------------------------------------------------
PROGRESS: 54.0%
| epoch  55 |   100/  269 batches | lr 0.00007 | ms/batch 253.71 | loss  3.14 | ppl    23.10 
| epoch  55 |   200/  269 batches | lr 0.00007 | ms/batch 239.57 | loss  3.12 | ppl    22.65 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 65.96s | valid loss  3.78 | valid ppl    43.68 | valid bpc    5.449
-----------------------------------------------------------------------------------------
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  269 batches | lr 0.00007 | ms/batch 253.16 | loss  3.12 | ppl    22.71 
| epoch  56 |   200/  269 batches | lr 0.00007 | ms/batch 241.21 | loss  3.10 | ppl    22.16 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 65.98s | valid loss  3.77 | valid ppl    43.50 | valid bpc    5.443
-----------------------------------------------------------------------------------------
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  269 batches | lr 0.00004 | ms/batch 255.11 | loss  3.09 | ppl    21.96 
| epoch  57 |   200/  269 batches | lr 0.00004 | ms/batch 236.80 | loss  3.09 | ppl    22.02 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 66.01s | valid loss  3.75 | valid ppl    42.62 | valid bpc    5.414
-----------------------------------------------------------------------------------------
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  269 batches | lr 0.00004 | ms/batch 255.20 | loss  3.10 | ppl    22.15 
| epoch  58 |   200/  269 batches | lr 0.00004 | ms/batch 233.04 | loss  3.08 | ppl    21.70 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 66.00s | valid loss  3.74 | valid ppl    42.09 | valid bpc    5.395
-----------------------------------------------------------------------------------------
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  269 batches | lr 0.00004 | ms/batch 253.20 | loss  3.07 | ppl    21.62 
| epoch  59 |   200/  269 batches | lr 0.00004 | ms/batch 234.56 | loss  3.06 | ppl    21.42 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 66.14s | valid loss  3.76 | valid ppl    42.75 | valid bpc    5.418
-----------------------------------------------------------------------------------------
PROGRESS: 59.0%
| epoch  60 |   100/  269 batches | lr 0.00002 | ms/batch 253.84 | loss  3.06 | ppl    21.37 
| epoch  60 |   200/  269 batches | lr 0.00002 | ms/batch 233.55 | loss  3.03 | ppl    20.65 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 66.27s | valid loss  3.77 | valid ppl    43.30 | valid bpc    5.436
-----------------------------------------------------------------------------------------
PROGRESS: 60.0%
| epoch  61 |   100/  269 batches | lr 0.00002 | ms/batch 250.53 | loss  3.05 | ppl    21.08 
| epoch  61 |   200/  269 batches | lr 0.00002 | ms/batch 234.06 | loss  3.05 | ppl    21.21 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 66.24s | valid loss  3.72 | valid ppl    41.19 | valid bpc    5.364
-----------------------------------------------------------------------------------------
PROGRESS: 61.0%
| epoch  62 |   100/  269 batches | lr 0.00002 | ms/batch 249.32 | loss  3.07 | ppl    21.64 
| epoch  62 |   200/  269 batches | lr 0.00002 | ms/batch 232.79 | loss  3.05 | ppl    21.03 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 65.97s | valid loss  3.71 | valid ppl    40.93 | valid bpc    5.355
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 62.0%
| epoch  63 |   100/  269 batches | lr 0.00002 | ms/batch 250.84 | loss  3.05 | ppl    21.21 
| epoch  63 |   200/  269 batches | lr 0.00002 | ms/batch 234.17 | loss  3.02 | ppl    20.52 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 66.17s | valid loss  3.75 | valid ppl    42.46 | valid bpc    5.408
-----------------------------------------------------------------------------------------
PROGRESS: 63.0%
| epoch  64 |   100/  269 batches | lr 0.00002 | ms/batch 247.98 | loss  3.04 | ppl    21.00 
| epoch  64 |   200/  269 batches | lr 0.00002 | ms/batch 233.57 | loss  2.99 | ppl    19.94 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 66.00s | valid loss  3.70 | valid ppl    40.57 | valid bpc    5.342
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 64.0%
| epoch  65 |   100/  269 batches | lr 0.00002 | ms/batch 248.58 | loss  3.03 | ppl    20.70 
| epoch  65 |   200/  269 batches | lr 0.00002 | ms/batch 233.59 | loss  3.03 | ppl    20.63 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 66.04s | valid loss  3.71 | valid ppl    41.04 | valid bpc    5.359
-----------------------------------------------------------------------------------------
PROGRESS: 65.0%
| epoch  66 |   100/  269 batches | lr 0.00002 | ms/batch 249.12 | loss  3.06 | ppl    21.37 
| epoch  66 |   200/  269 batches | lr 0.00002 | ms/batch 233.10 | loss  3.02 | ppl    20.44 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 65.93s | valid loss  3.74 | valid ppl    41.89 | valid bpc    5.389
-----------------------------------------------------------------------------------------
PROGRESS: 66.0%
| epoch  67 |   100/  269 batches | lr 0.00002 | ms/batch 246.78 | loss  3.02 | ppl    20.51 
| epoch  67 |   200/  269 batches | lr 0.00002 | ms/batch 234.87 | loss  3.01 | ppl    20.35 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 65.96s | valid loss  3.75 | valid ppl    42.40 | valid bpc    5.406
-----------------------------------------------------------------------------------------
PROGRESS: 67.0%
| epoch  68 |   100/  269 batches | lr 0.00001 | ms/batch 241.79 | loss  3.03 | ppl    20.78 
| epoch  68 |   200/  269 batches | lr 0.00001 | ms/batch 240.15 | loss  3.01 | ppl    20.22 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 66.02s | valid loss  3.70 | valid ppl    40.27 | valid bpc    5.332
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 68.0%
| epoch  69 |   100/  269 batches | lr 0.00001 | ms/batch 242.04 | loss  3.03 | ppl    20.76 
| epoch  69 |   200/  269 batches | lr 0.00001 | ms/batch 239.79 | loss  3.00 | ppl    20.00 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 65.99s | valid loss  3.70 | valid ppl    40.26 | valid bpc    5.331
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 69.0%
| epoch  70 |   100/  269 batches | lr 0.00001 | ms/batch 242.22 | loss  3.02 | ppl    20.56 
| epoch  70 |   200/  269 batches | lr 0.00001 | ms/batch 240.31 | loss  3.00 | ppl    20.14 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 66.04s | valid loss  3.66 | valid ppl    39.04 | valid bpc    5.287
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 70.0%
| epoch  71 |   100/  269 batches | lr 0.00001 | ms/batch 242.12 | loss  3.02 | ppl    20.53 
| epoch  71 |   200/  269 batches | lr 0.00001 | ms/batch 240.08 | loss  3.00 | ppl    20.04 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 65.99s | valid loss  3.78 | valid ppl    43.80 | valid bpc    5.453
-----------------------------------------------------------------------------------------
PROGRESS: 71.0%
| epoch  72 |   100/  269 batches | lr 0.00001 | ms/batch 241.38 | loss  3.04 | ppl    20.86 
| epoch  72 |   200/  269 batches | lr 0.00001 | ms/batch 240.53 | loss  3.01 | ppl    20.20 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 65.98s | valid loss  3.72 | valid ppl    41.10 | valid bpc    5.361
-----------------------------------------------------------------------------------------
PROGRESS: 72.0%
| epoch  73 |   100/  269 batches | lr 0.00001 | ms/batch 238.69 | loss  3.02 | ppl    20.40 
| epoch  73 |   200/  269 batches | lr 0.00001 | ms/batch 239.61 | loss  2.99 | ppl    19.96 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 65.57s | valid loss  3.69 | valid ppl    40.23 | valid bpc    5.330
-----------------------------------------------------------------------------------------
PROGRESS: 73.0%
| epoch  74 |   100/  269 batches | lr 0.00000 | ms/batch 242.37 | loss  3.03 | ppl    20.77 
| epoch  74 |   200/  269 batches | lr 0.00000 | ms/batch 240.08 | loss  2.98 | ppl    19.63 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 66.04s | valid loss  3.70 | valid ppl    40.53 | valid bpc    5.341
-----------------------------------------------------------------------------------------
PROGRESS: 74.0%
| epoch  75 |   100/  269 batches | lr 0.00000 | ms/batch 244.39 | loss  3.02 | ppl    20.49 
| epoch  75 |   200/  269 batches | lr 0.00000 | ms/batch 239.29 | loss  2.97 | ppl    19.57 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 66.08s | valid loss  3.77 | valid ppl    43.26 | valid bpc    5.435
-----------------------------------------------------------------------------------------
PROGRESS: 75.0%
| epoch  76 |   100/  269 batches | lr 0.00000 | ms/batch 242.51 | loss  3.01 | ppl    20.33 
| epoch  76 |   200/  269 batches | lr 0.00000 | ms/batch 240.51 | loss  2.99 | ppl    19.81 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 65.99s | valid loss  3.72 | valid ppl    41.24 | valid bpc    5.366
-----------------------------------------------------------------------------------------
PROGRESS: 76.0%
| epoch  77 |   100/  269 batches | lr 0.00000 | ms/batch 242.97 | loss  3.03 | ppl    20.69 
| epoch  77 |   200/  269 batches | lr 0.00000 | ms/batch 240.13 | loss  2.99 | ppl    19.82 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 65.75s | valid loss  3.72 | valid ppl    41.10 | valid bpc    5.361
-----------------------------------------------------------------------------------------
PROGRESS: 77.0%
| epoch  78 |   100/  269 batches | lr 0.00000 | ms/batch 243.61 | loss  3.01 | ppl    20.36 
| epoch  78 |   200/  269 batches | lr 0.00000 | ms/batch 239.63 | loss  2.98 | ppl    19.67 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 65.58s | valid loss  3.73 | valid ppl    41.83 | valid bpc    5.386
-----------------------------------------------------------------------------------------
PROGRESS: 78.0%
| epoch  79 |   100/  269 batches | lr 0.00000 | ms/batch 247.74 | loss  3.00 | ppl    20.12 
| epoch  79 |   200/  269 batches | lr 0.00000 | ms/batch 240.17 | loss  3.00 | ppl    19.99 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 65.98s | valid loss  3.72 | valid ppl    41.18 | valid bpc    5.364
-----------------------------------------------------------------------------------------
PROGRESS: 79.0%
| epoch  80 |   100/  269 batches | lr 0.00000 | ms/batch 248.76 | loss  3.04 | ppl    20.80 
| epoch  80 |   200/  269 batches | lr 0.00000 | ms/batch 239.04 | loss  2.97 | ppl    19.57 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 65.96s | valid loss  3.73 | valid ppl    41.57 | valid bpc    5.377
-----------------------------------------------------------------------------------------
PROGRESS: 80.0%
| epoch  81 |   100/  269 batches | lr 0.00000 | ms/batch 248.47 | loss  3.00 | ppl    20.00 
| epoch  81 |   200/  269 batches | lr 0.00000 | ms/batch 238.82 | loss  2.99 | ppl    19.96 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 66.01s | valid loss  3.73 | valid ppl    41.83 | valid bpc    5.386
-----------------------------------------------------------------------------------------
PROGRESS: 81.0%
| epoch  82 |   100/  269 batches | lr 0.00000 | ms/batch 248.58 | loss  3.02 | ppl    20.39 
| epoch  82 |   200/  269 batches | lr 0.00000 | ms/batch 239.17 | loss  2.97 | ppl    19.56 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 65.96s | valid loss  3.73 | valid ppl    41.80 | valid bpc    5.385
-----------------------------------------------------------------------------------------
PROGRESS: 82.0%
| epoch  83 |   100/  269 batches | lr 0.00000 | ms/batch 248.83 | loss  3.03 | ppl    20.65 
| epoch  83 |   200/  269 batches | lr 0.00000 | ms/batch 238.13 | loss  2.98 | ppl    19.60 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 65.89s | valid loss  3.77 | valid ppl    43.47 | valid bpc    5.442
-----------------------------------------------------------------------------------------
PROGRESS: 83.0%
| epoch  84 |   100/  269 batches | lr 0.00000 | ms/batch 247.90 | loss  3.01 | ppl    20.30 
| epoch  84 |   200/  269 batches | lr 0.00000 | ms/batch 239.81 | loss  2.99 | ppl    19.97 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 65.98s | valid loss  3.71 | valid ppl    40.80 | valid bpc    5.351
-----------------------------------------------------------------------------------------
PROGRESS: 84.0%
| epoch  85 |   100/  269 batches | lr 0.00000 | ms/batch 247.63 | loss  3.00 | ppl    20.09 
| epoch  85 |   200/  269 batches | lr 0.00000 | ms/batch 239.52 | loss  2.99 | ppl    19.89 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 65.99s | valid loss  3.75 | valid ppl    42.45 | valid bpc    5.408
-----------------------------------------------------------------------------------------
PROGRESS: 85.0%
| epoch  86 |   100/  269 batches | lr 0.00000 | ms/batch 248.77 | loss  3.03 | ppl    20.65 
| epoch  86 |   200/  269 batches | lr 0.00000 | ms/batch 232.16 | loss  2.97 | ppl    19.47 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 65.97s | valid loss  3.73 | valid ppl    41.53 | valid bpc    5.376
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  269 batches | lr 0.00000 | ms/batch 247.75 | loss  3.01 | ppl    20.27 
| epoch  87 |   200/  269 batches | lr 0.00000 | ms/batch 233.89 | loss  2.99 | ppl    19.87 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 65.89s | valid loss  3.76 | valid ppl    43.14 | valid bpc    5.431
-----------------------------------------------------------------------------------------
PROGRESS: 87.0%
| epoch  88 |   100/  269 batches | lr 0.00000 | ms/batch 247.54 | loss  3.01 | ppl    20.27 
| epoch  88 |   200/  269 batches | lr 0.00000 | ms/batch 233.58 | loss  2.98 | ppl    19.71 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 65.97s | valid loss  3.70 | valid ppl    40.48 | valid bpc    5.339
-----------------------------------------------------------------------------------------
PROGRESS: 88.0%
| epoch  89 |   100/  269 batches | lr 0.00000 | ms/batch 249.19 | loss  2.99 | ppl    19.85 
| epoch  89 |   200/  269 batches | lr 0.00000 | ms/batch 233.75 | loss  2.99 | ppl    19.88 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 66.05s | valid loss  3.74 | valid ppl    41.97 | valid bpc    5.391
-----------------------------------------------------------------------------------------
PROGRESS: 89.0%
| epoch  90 |   100/  269 batches | lr 0.00000 | ms/batch 249.08 | loss  3.02 | ppl    20.45 
| epoch  90 |   200/  269 batches | lr 0.00000 | ms/batch 233.42 | loss  2.95 | ppl    19.06 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 66.00s | valid loss  3.72 | valid ppl    41.17 | valid bpc    5.363
-----------------------------------------------------------------------------------------
PROGRESS: 90.0%
| epoch  91 |   100/  269 batches | lr 0.00000 | ms/batch 247.00 | loss  3.01 | ppl    20.19 
| epoch  91 |   200/  269 batches | lr 0.00000 | ms/batch 206.58 | loss  2.97 | ppl    19.49 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 58.13s | valid loss  3.72 | valid ppl    41.42 | valid bpc    5.372
-----------------------------------------------------------------------------------------
PROGRESS: 91.0%
| epoch  92 |   100/  269 batches | lr 0.00000 | ms/batch 173.16 | loss  2.99 | ppl    19.88 
| epoch  92 |   200/  269 batches | lr 0.00000 | ms/batch 170.54 | loss  3.00 | ppl    20.00 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 46.98s | valid loss  3.71 | valid ppl    40.68 | valid bpc    5.346
-----------------------------------------------------------------------------------------
PROGRESS: 92.0%
| epoch  93 |   100/  269 batches | lr 0.00000 | ms/batch 161.54 | loss  3.02 | ppl    20.42 
| epoch  93 |   200/  269 batches | lr 0.00000 | ms/batch 159.80 | loss  2.97 | ppl    19.58 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 44.58s | valid loss  3.73 | valid ppl    41.86 | valid bpc    5.387
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  269 batches | lr 0.00000 | ms/batch 247.77 | loss  3.00 | ppl    20.07 
| epoch  94 |   200/  269 batches | lr 0.00000 | ms/batch 239.43 | loss  2.96 | ppl    19.23 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 65.62s | valid loss  3.71 | valid ppl    40.90 | valid bpc    5.354
-----------------------------------------------------------------------------------------
PROGRESS: 94.0%
| epoch  95 |   100/  269 batches | lr 0.00000 | ms/batch 249.69 | loss  3.03 | ppl    20.67 
| epoch  95 |   200/  269 batches | lr 0.00000 | ms/batch 238.54 | loss  2.99 | ppl    19.97 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 65.60s | valid loss  3.75 | valid ppl    42.47 | valid bpc    5.408
-----------------------------------------------------------------------------------------
PROGRESS: 95.0%
| epoch  96 |   100/  269 batches | lr 0.00000 | ms/batch 248.22 | loss  3.02 | ppl    20.52 
| epoch  96 |   200/  269 batches | lr 0.00000 | ms/batch 239.69 | loss  2.98 | ppl    19.63 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 65.62s | valid loss  3.74 | valid ppl    42.16 | valid bpc    5.398
-----------------------------------------------------------------------------------------
PROGRESS: 96.0%
| epoch  97 |   100/  269 batches | lr 0.00000 | ms/batch 248.47 | loss  3.00 | ppl    20.10 
| epoch  97 |   200/  269 batches | lr 0.00000 | ms/batch 238.97 | loss  2.99 | ppl    19.94 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 65.62s | valid loss  3.77 | valid ppl    43.56 | valid bpc    5.445
-----------------------------------------------------------------------------------------
PROGRESS: 97.0%
| epoch  98 |   100/  269 batches | lr 0.00000 | ms/batch 247.79 | loss  3.01 | ppl    20.27 
| epoch  98 |   200/  269 batches | lr 0.00000 | ms/batch 240.38 | loss  2.96 | ppl    19.24 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 65.63s | valid loss  3.71 | valid ppl    40.78 | valid bpc    5.350
-----------------------------------------------------------------------------------------
PROGRESS: 98.0%
| epoch  99 |   100/  269 batches | lr 0.00000 | ms/batch 247.45 | loss  3.02 | ppl    20.43 
| epoch  99 |   200/  269 batches | lr 0.00000 | ms/batch 239.52 | loss  2.97 | ppl    19.54 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 65.59s | valid loss  3.68 | valid ppl    39.77 | valid bpc    5.313
-----------------------------------------------------------------------------------------
PROGRESS: 99.0%
| epoch 100 |   100/  269 batches | lr 0.00000 | ms/batch 250.44 | loss  3.01 | ppl    20.30 
| epoch 100 |   200/  269 batches | lr 0.00000 | ms/batch 238.53 | loss  2.97 | ppl    19.54 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 65.59s | valid loss  3.76 | valid ppl    43.08 | valid bpc    5.429
-----------------------------------------------------------------------------------------
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  3.84 | test ppl    46.39 | test bpc    5.536
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.3526, Mean Reca: 0.4990, Mean F1: 0.4097, Mean Subword_Reca: 0.7910
-----------------------------------------------------------------------------------------
=========================================================================================
Loading dataset...
Using subword tokenizer...
Number of tokens:  8000
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer_in_parser', nhid=512, nlayers=8, front_layers=4, rear_layers=4, subword='omarmomen/ptb_filtered_lowcase_bpe_tokenizer_8', n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=4444, nonmono=5, cuda=True, log_interval=100, save='trained_models/subword_structformer_in_parser_4444_44.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 37449092
Model architecture: StructFormer_In_Parser(
  (transformer_front): Transformer_Front(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(8000, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-3): 4 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
  (transformer_rear): Transformer_Rear(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(8000, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-3): 4 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (output_layer): Linear(in_features=512, out_features=8000, bias=True)
  )
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  269 batches | lr 0.00030 | ms/batch 202.45 | loss  7.73 | ppl  2281.52 
| epoch   1 |   200/  269 batches | lr 0.00030 | ms/batch 230.97 | loss  7.38 | ppl  1598.12 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 61.00s | valid loss  7.12 | valid ppl  1235.48 | valid bpc   10.271
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  269 batches | lr 0.00030 | ms/batch 244.17 | loss  7.31 | ppl  1494.20 
| epoch   2 |   200/  269 batches | lr 0.00030 | ms/batch 229.94 | loss  7.16 | ppl  1287.39 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 65.16s | valid loss  6.87 | valid ppl   965.60 | valid bpc    9.915
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  269 batches | lr 0.00030 | ms/batch 243.99 | loss  7.04 | ppl  1146.00 
| epoch   3 |   200/  269 batches | lr 0.00030 | ms/batch 230.31 | loss  6.77 | ppl   872.92 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 65.27s | valid loss  6.31 | valid ppl   548.49 | valid bpc    9.099
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  269 batches | lr 0.00030 | ms/batch 245.24 | loss  6.42 | ppl   615.92 
| epoch   4 |   200/  269 batches | lr 0.00030 | ms/batch 229.19 | loss  6.17 | ppl   478.73 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 65.25s | valid loss  5.82 | valid ppl   337.58 | valid bpc    8.399
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  269 batches | lr 0.00030 | ms/batch 241.65 | loss  6.00 | ppl   403.61 
| epoch   5 |   200/  269 batches | lr 0.00030 | ms/batch 232.84 | loss  5.84 | ppl   343.39 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 65.28s | valid loss  5.58 | valid ppl   265.84 | valid bpc    8.054
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  269 batches | lr 0.00030 | ms/batch 235.14 | loss  5.76 | ppl   315.99 
| epoch   6 |   200/  269 batches | lr 0.00030 | ms/batch 239.74 | loss  5.65 | ppl   285.00 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 65.21s | valid loss  5.42 | valid ppl   225.56 | valid bpc    7.817
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  269 batches | lr 0.00030 | ms/batch 234.15 | loss  5.58 | ppl   266.09 
| epoch   7 |   200/  269 batches | lr 0.00030 | ms/batch 240.28 | loss  5.47 | ppl   237.38 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 65.17s | valid loss  5.30 | valid ppl   200.95 | valid bpc    7.651
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  269 batches | lr 0.00030 | ms/batch 226.46 | loss  5.42 | ppl   226.19 
| epoch   8 |   200/  269 batches | lr 0.00030 | ms/batch 238.89 | loss  5.33 | ppl   207.40 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 64.28s | valid loss  5.11 | valid ppl   165.56 | valid bpc    7.371
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 8.0%
| epoch   9 |   100/  269 batches | lr 0.00030 | ms/batch 238.36 | loss  5.31 | ppl   201.56 
| epoch   9 |   200/  269 batches | lr 0.00030 | ms/batch 239.05 | loss  5.21 | ppl   184.01 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 65.59s | valid loss  5.03 | valid ppl   153.06 | valid bpc    7.258
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  269 batches | lr 0.00030 | ms/batch 234.66 | loss  5.17 | ppl   176.45 
| epoch  10 |   200/  269 batches | lr 0.00030 | ms/batch 240.17 | loss  5.12 | ppl   166.77 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 65.26s | valid loss  4.92 | valid ppl   136.44 | valid bpc    7.092
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  269 batches | lr 0.00030 | ms/batch 239.61 | loss  5.09 | ppl   162.00 
| epoch  11 |   200/  269 batches | lr 0.00030 | ms/batch 240.26 | loss  4.99 | ppl   147.40 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 65.64s | valid loss  4.87 | valid ppl   129.68 | valid bpc    7.019
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  269 batches | lr 0.00030 | ms/batch 238.60 | loss  5.00 | ppl   148.03 
| epoch  12 |   200/  269 batches | lr 0.00030 | ms/batch 237.99 | loss  4.89 | ppl   132.62 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 65.29s | valid loss  4.74 | valid ppl   114.63 | valid bpc    6.841
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 12.0%
| epoch  13 |   100/  269 batches | lr 0.00030 | ms/batch 240.25 | loss  4.88 | ppl   131.67 
| epoch  13 |   200/  269 batches | lr 0.00030 | ms/batch 235.99 | loss  4.83 | ppl   125.34 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 65.34s | valid loss  4.63 | valid ppl   102.39 | valid bpc    6.678
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 13.0%
| epoch  14 |   100/  269 batches | lr 0.00030 | ms/batch 246.96 | loss  4.78 | ppl   119.60 
| epoch  14 |   200/  269 batches | lr 0.00030 | ms/batch 232.12 | loss  4.72 | ppl   112.57 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 65.60s | valid loss  4.62 | valid ppl   101.21 | valid bpc    6.661
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  269 batches | lr 0.00030 | ms/batch 247.54 | loss  4.71 | ppl   111.01 
| epoch  15 |   200/  269 batches | lr 0.00030 | ms/batch 231.50 | loss  4.65 | ppl   104.45 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 65.65s | valid loss  4.52 | valid ppl    91.81 | valid bpc    6.521
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 15.0%
| epoch  16 |   100/  269 batches | lr 0.00030 | ms/batch 241.53 | loss  4.63 | ppl   102.63 
| epoch  16 |   200/  269 batches | lr 0.00030 | ms/batch 229.88 | loss  4.60 | ppl    99.20 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 64.87s | valid loss  4.49 | valid ppl    89.00 | valid bpc    6.476
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 16.0%
| epoch  17 |   100/  269 batches | lr 0.00030 | ms/batch 244.32 | loss  4.57 | ppl    96.93 
| epoch  17 |   200/  269 batches | lr 0.00030 | ms/batch 233.44 | loss  4.49 | ppl    89.52 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 64.95s | valid loss  4.43 | valid ppl    83.71 | valid bpc    6.387
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 17.0%
| epoch  18 |   100/  269 batches | lr 0.00030 | ms/batch 253.45 | loss  4.50 | ppl    89.64 
| epoch  18 |   200/  269 batches | lr 0.00030 | ms/batch 231.61 | loss  4.46 | ppl    86.09 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 65.22s | valid loss  4.36 | valid ppl    78.07 | valid bpc    6.287
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 18.0%
| epoch  19 |   100/  269 batches | lr 0.00030 | ms/batch 255.85 | loss  4.44 | ppl    84.99 
| epoch  19 |   200/  269 batches | lr 0.00030 | ms/batch 230.09 | loss  4.36 | ppl    78.56 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 65.28s | valid loss  4.36 | valid ppl    77.97 | valid bpc    6.285
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 19.0%
| epoch  20 |   100/  269 batches | lr 0.00030 | ms/batch 253.74 | loss  4.35 | ppl    77.18 
| epoch  20 |   200/  269 batches | lr 0.00030 | ms/batch 230.68 | loss  4.31 | ppl    74.43 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 65.29s | valid loss  4.26 | valid ppl    70.76 | valid bpc    6.145
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 20.0%
| epoch  21 |   100/  269 batches | lr 0.00030 | ms/batch 253.32 | loss  4.28 | ppl    72.14 
| epoch  21 |   200/  269 batches | lr 0.00030 | ms/batch 230.39 | loss  4.26 | ppl    70.76 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 65.30s | valid loss  4.26 | valid ppl    70.55 | valid bpc    6.141
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 21.0%
| epoch  22 |   100/  269 batches | lr 0.00030 | ms/batch 254.72 | loss  4.23 | ppl    68.78 
| epoch  22 |   200/  269 batches | lr 0.00030 | ms/batch 233.79 | loss  4.21 | ppl    67.02 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 65.56s | valid loss  4.21 | valid ppl    67.22 | valid bpc    6.071
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 22.0%
| epoch  23 |   100/  269 batches | lr 0.00030 | ms/batch 255.22 | loss  4.18 | ppl    65.17 
| epoch  23 |   200/  269 batches | lr 0.00030 | ms/batch 229.24 | loss  4.16 | ppl    64.25 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 65.58s | valid loss  4.18 | valid ppl    65.52 | valid bpc    6.034
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 23.0%
| epoch  24 |   100/  269 batches | lr 0.00030 | ms/batch 254.99 | loss  4.11 | ppl    61.15 
| epoch  24 |   200/  269 batches | lr 0.00030 | ms/batch 231.20 | loss  4.12 | ppl    61.68 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 66.00s | valid loss  4.19 | valid ppl    65.81 | valid bpc    6.040
-----------------------------------------------------------------------------------------
PROGRESS: 24.0%
| epoch  25 |   100/  269 batches | lr 0.00030 | ms/batch 253.03 | loss  4.07 | ppl    58.66 
| epoch  25 |   200/  269 batches | lr 0.00030 | ms/batch 226.01 | loss  4.06 | ppl    57.87 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 65.63s | valid loss  4.12 | valid ppl    61.66 | valid bpc    5.946
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 25.0%
| epoch  26 |   100/  269 batches | lr 0.00030 | ms/batch 254.09 | loss  4.01 | ppl    55.24 
| epoch  26 |   200/  269 batches | lr 0.00030 | ms/batch 220.54 | loss  4.01 | ppl    54.93 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 65.30s | valid loss  4.14 | valid ppl    62.87 | valid bpc    5.974
-----------------------------------------------------------------------------------------
PROGRESS: 26.0%
| epoch  27 |   100/  269 batches | lr 0.00030 | ms/batch 252.80 | loss  3.99 | ppl    54.25 
| epoch  27 |   200/  269 batches | lr 0.00030 | ms/batch 224.16 | loss  3.94 | ppl    51.45 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 65.59s | valid loss  4.06 | valid ppl    57.91 | valid bpc    5.856
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 27.0%
| epoch  28 |   100/  269 batches | lr 0.00030 | ms/batch 253.71 | loss  3.93 | ppl    50.92 
| epoch  28 |   200/  269 batches | lr 0.00030 | ms/batch 225.23 | loss  3.90 | ppl    49.30 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 65.62s | valid loss  4.06 | valid ppl    58.07 | valid bpc    5.860
-----------------------------------------------------------------------------------------
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  269 batches | lr 0.00030 | ms/batch 254.80 | loss  3.88 | ppl    48.32 
| epoch  29 |   200/  269 batches | lr 0.00030 | ms/batch 223.65 | loss  3.87 | ppl    47.71 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 65.60s | valid loss  4.04 | valid ppl    56.67 | valid bpc    5.825
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  269 batches | lr 0.00030 | ms/batch 254.96 | loss  3.85 | ppl    47.13 
| epoch  30 |   200/  269 batches | lr 0.00030 | ms/batch 216.56 | loss  3.82 | ppl    45.55 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 64.83s | valid loss  4.04 | valid ppl    56.89 | valid bpc    5.830
-----------------------------------------------------------------------------------------
PROGRESS: 30.0%
| epoch  31 |   100/  269 batches | lr 0.00030 | ms/batch 253.65 | loss  3.80 | ppl    44.76 
| epoch  31 |   200/  269 batches | lr 0.00030 | ms/batch 228.61 | loss  3.78 | ppl    43.69 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 65.97s | valid loss  4.00 | valid ppl    54.66 | valid bpc    5.772
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 31.0%
| epoch  32 |   100/  269 batches | lr 0.00030 | ms/batch 254.71 | loss  3.76 | ppl    42.92 
| epoch  32 |   200/  269 batches | lr 0.00030 | ms/batch 221.19 | loss  3.74 | ppl    42.23 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 65.30s | valid loss  3.98 | valid ppl    53.39 | valid bpc    5.738
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 32.0%
| epoch  33 |   100/  269 batches | lr 0.00030 | ms/batch 255.23 | loss  3.75 | ppl    42.40 
| epoch  33 |   200/  269 batches | lr 0.00030 | ms/batch 224.25 | loss  3.70 | ppl    40.33 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 65.65s | valid loss  3.90 | valid ppl    49.43 | valid bpc    5.627
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 33.0%
| epoch  34 |   100/  269 batches | lr 0.00030 | ms/batch 253.97 | loss  3.70 | ppl    40.42 
| epoch  34 |   200/  269 batches | lr 0.00030 | ms/batch 224.58 | loss  3.64 | ppl    38.25 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 65.66s | valid loss  3.95 | valid ppl    52.01 | valid bpc    5.701
-----------------------------------------------------------------------------------------
PROGRESS: 34.0%
| epoch  35 |   100/  269 batches | lr 0.00030 | ms/batch 250.81 | loss  3.66 | ppl    38.97 
| epoch  35 |   200/  269 batches | lr 0.00030 | ms/batch 231.98 | loss  3.64 | ppl    38.23 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 65.91s | valid loss  3.96 | valid ppl    52.65 | valid bpc    5.718
-----------------------------------------------------------------------------------------
PROGRESS: 35.0%
| epoch  36 |   100/  269 batches | lr 0.00030 | ms/batch 246.80 | loss  3.61 | ppl    37.02 
| epoch  36 |   200/  269 batches | lr 0.00030 | ms/batch 234.51 | loss  3.61 | ppl    37.01 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 65.97s | valid loss  3.94 | valid ppl    51.53 | valid bpc    5.687
-----------------------------------------------------------------------------------------
PROGRESS: 36.0%
| epoch  37 |   100/  269 batches | lr 0.00015 | ms/batch 244.55 | loss  3.55 | ppl    34.78 
| epoch  37 |   200/  269 batches | lr 0.00015 | ms/batch 233.55 | loss  3.50 | ppl    32.98 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 65.62s | valid loss  3.82 | valid ppl    45.73 | valid bpc    5.515
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 37.0%
| epoch  38 |   100/  269 batches | lr 0.00015 | ms/batch 248.51 | loss  3.47 | ppl    32.07 
| epoch  38 |   200/  269 batches | lr 0.00015 | ms/batch 229.66 | loss  3.46 | ppl    31.66 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 65.61s | valid loss  3.87 | valid ppl    47.90 | valid bpc    5.582
-----------------------------------------------------------------------------------------
PROGRESS: 38.0%
| epoch  39 |   100/  269 batches | lr 0.00015 | ms/batch 247.46 | loss  3.44 | ppl    31.14 
| epoch  39 |   200/  269 batches | lr 0.00015 | ms/batch 231.34 | loss  3.43 | ppl    30.78 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 65.62s | valid loss  3.90 | valid ppl    49.59 | valid bpc    5.632
-----------------------------------------------------------------------------------------
PROGRESS: 39.0%
| epoch  40 |   100/  269 batches | lr 0.00015 | ms/batch 248.12 | loss  3.41 | ppl    30.36 
| epoch  40 |   200/  269 batches | lr 0.00015 | ms/batch 234.50 | loss  3.39 | ppl    29.72 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 65.98s | valid loss  3.82 | valid ppl    45.40 | valid bpc    5.504
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 40.0%
| epoch  41 |   100/  269 batches | lr 0.00015 | ms/batch 248.71 | loss  3.39 | ppl    29.72 
| epoch  41 |   200/  269 batches | lr 0.00015 | ms/batch 234.01 | loss  3.39 | ppl    29.58 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 66.01s | valid loss  3.84 | valid ppl    46.59 | valid bpc    5.542
-----------------------------------------------------------------------------------------
PROGRESS: 41.0%
| epoch  42 |   100/  269 batches | lr 0.00015 | ms/batch 249.98 | loss  3.40 | ppl    30.09 
| epoch  42 |   200/  269 batches | lr 0.00015 | ms/batch 232.77 | loss  3.36 | ppl    28.77 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 65.99s | valid loss  3.77 | valid ppl    43.55 | valid bpc    5.445
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 42.0%
| epoch  43 |   100/  269 batches | lr 0.00015 | ms/batch 244.62 | loss  3.36 | ppl    28.82 
| epoch  43 |   200/  269 batches | lr 0.00015 | ms/batch 230.38 | loss  3.34 | ppl    28.23 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 65.29s | valid loss  3.82 | valid ppl    45.40 | valid bpc    5.505
-----------------------------------------------------------------------------------------
PROGRESS: 43.0%
| epoch  44 |   100/  269 batches | lr 0.00015 | ms/batch 247.13 | loss  3.34 | ppl    28.22 
| epoch  44 |   200/  269 batches | lr 0.00015 | ms/batch 234.88 | loss  3.32 | ppl    27.76 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 65.96s | valid loss  3.83 | valid ppl    46.10 | valid bpc    5.527
-----------------------------------------------------------------------------------------
PROGRESS: 44.0%
| epoch  45 |   100/  269 batches | lr 0.00015 | ms/batch 248.54 | loss  3.30 | ppl    27.00 
| epoch  45 |   200/  269 batches | lr 0.00015 | ms/batch 231.97 | loss  3.30 | ppl    27.15 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 65.62s | valid loss  3.79 | valid ppl    44.37 | valid bpc    5.472
-----------------------------------------------------------------------------------------
PROGRESS: 45.0%
| epoch  46 |   100/  269 batches | lr 0.00007 | ms/batch 244.71 | loss  3.29 | ppl    26.73 
| epoch  46 |   200/  269 batches | lr 0.00007 | ms/batch 238.10 | loss  3.23 | ppl    25.25 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 65.21s | valid loss  3.81 | valid ppl    45.06 | valid bpc    5.494
-----------------------------------------------------------------------------------------
PROGRESS: 46.0%
| epoch  47 |   100/  269 batches | lr 0.00007 | ms/batch 247.53 | loss  3.23 | ppl    25.29 
| epoch  47 |   200/  269 batches | lr 0.00007 | ms/batch 240.64 | loss  3.20 | ppl    24.62 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 65.37s | valid loss  3.80 | valid ppl    44.63 | valid bpc    5.480
-----------------------------------------------------------------------------------------
PROGRESS: 47.0%
| epoch  48 |   100/  269 batches | lr 0.00007 | ms/batch 253.24 | loss  3.21 | ppl    24.78 
| epoch  48 |   200/  269 batches | lr 0.00007 | ms/batch 239.80 | loss  3.21 | ppl    24.89 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 66.03s | valid loss  3.80 | valid ppl    44.70 | valid bpc    5.482
-----------------------------------------------------------------------------------------
PROGRESS: 48.0%
| epoch  49 |   100/  269 batches | lr 0.00004 | ms/batch 255.24 | loss  3.20 | ppl    24.53 
| epoch  49 |   200/  269 batches | lr 0.00004 | ms/batch 239.41 | loss  3.16 | ppl    23.64 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 65.64s | valid loss  3.77 | valid ppl    43.29 | valid bpc    5.436
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 49.0%
| epoch  50 |   100/  269 batches | lr 0.00004 | ms/batch 253.80 | loss  3.18 | ppl    24.00 
| epoch  50 |   200/  269 batches | lr 0.00004 | ms/batch 240.34 | loss  3.15 | ppl    23.22 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 66.00s | valid loss  3.75 | valid ppl    42.41 | valid bpc    5.406
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 50.0%
| epoch  51 |   100/  269 batches | lr 0.00004 | ms/batch 253.49 | loss  3.18 | ppl    23.97 
| epoch  51 |   200/  269 batches | lr 0.00004 | ms/batch 240.29 | loss  3.16 | ppl    23.48 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 65.95s | valid loss  3.72 | valid ppl    41.36 | valid bpc    5.370
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 51.0%
| epoch  52 |   100/  269 batches | lr 0.00004 | ms/batch 253.94 | loss  3.15 | ppl    23.34 
| epoch  52 |   200/  269 batches | lr 0.00004 | ms/batch 240.22 | loss  3.14 | ppl    23.12 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 65.98s | valid loss  3.77 | valid ppl    43.58 | valid bpc    5.446
-----------------------------------------------------------------------------------------
PROGRESS: 52.0%
| epoch  53 |   100/  269 batches | lr 0.00004 | ms/batch 253.90 | loss  3.17 | ppl    23.82 
| epoch  53 |   200/  269 batches | lr 0.00004 | ms/batch 239.67 | loss  3.13 | ppl    22.93 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 65.62s | valid loss  3.79 | valid ppl    44.19 | valid bpc    5.466
-----------------------------------------------------------------------------------------
PROGRESS: 53.0%
| epoch  54 |   100/  269 batches | lr 0.00004 | ms/batch 254.22 | loss  3.14 | ppl    23.07 
| epoch  54 |   200/  269 batches | lr 0.00004 | ms/batch 237.45 | loss  3.12 | ppl    22.75 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 66.01s | valid loss  3.75 | valid ppl    42.41 | valid bpc    5.406
-----------------------------------------------------------------------------------------
PROGRESS: 54.0%
| epoch  55 |   100/  269 batches | lr 0.00002 | ms/batch 253.63 | loss  3.13 | ppl    22.87 
| epoch  55 |   200/  269 batches | lr 0.00002 | ms/batch 233.71 | loss  3.12 | ppl    22.60 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 65.95s | valid loss  3.75 | valid ppl    42.67 | valid bpc    5.415
-----------------------------------------------------------------------------------------
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  269 batches | lr 0.00002 | ms/batch 253.68 | loss  3.12 | ppl    22.62 
| epoch  56 |   200/  269 batches | lr 0.00002 | ms/batch 234.23 | loss  3.09 | ppl    21.98 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 65.96s | valid loss  3.75 | valid ppl    42.46 | valid bpc    5.408
-----------------------------------------------------------------------------------------
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  269 batches | lr 0.00002 | ms/batch 254.59 | loss  3.14 | ppl    23.06 
| epoch  57 |   200/  269 batches | lr 0.00002 | ms/batch 234.27 | loss  3.09 | ppl    22.08 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 65.64s | valid loss  3.74 | valid ppl    41.91 | valid bpc    5.389
-----------------------------------------------------------------------------------------
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  269 batches | lr 0.00001 | ms/batch 253.94 | loss  3.11 | ppl    22.50 
| epoch  58 |   200/  269 batches | lr 0.00001 | ms/batch 233.76 | loss  3.10 | ppl    22.15 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 66.01s | valid loss  3.75 | valid ppl    42.57 | valid bpc    5.412
-----------------------------------------------------------------------------------------
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  269 batches | lr 0.00001 | ms/batch 252.99 | loss  3.12 | ppl    22.68 
| epoch  59 |   200/  269 batches | lr 0.00001 | ms/batch 233.31 | loss  3.09 | ppl    22.08 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 65.95s | valid loss  3.73 | valid ppl    41.65 | valid bpc    5.380
-----------------------------------------------------------------------------------------
PROGRESS: 59.0%
| epoch  60 |   100/  269 batches | lr 0.00001 | ms/batch 254.30 | loss  3.14 | ppl    23.03 
| epoch  60 |   200/  269 batches | lr 0.00001 | ms/batch 234.19 | loss  3.10 | ppl    22.10 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 65.96s | valid loss  3.74 | valid ppl    41.92 | valid bpc    5.390
-----------------------------------------------------------------------------------------
PROGRESS: 60.0%
| epoch  61 |   100/  269 batches | lr 0.00000 | ms/batch 254.31 | loss  3.10 | ppl    22.30 
| epoch  61 |   200/  269 batches | lr 0.00000 | ms/batch 233.36 | loss  3.10 | ppl    22.22 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 66.04s | valid loss  3.74 | valid ppl    42.14 | valid bpc    5.397
-----------------------------------------------------------------------------------------
PROGRESS: 61.0%
| epoch  62 |   100/  269 batches | lr 0.00000 | ms/batch 253.20 | loss  3.11 | ppl    22.39 
| epoch  62 |   200/  269 batches | lr 0.00000 | ms/batch 234.64 | loss  3.10 | ppl    22.20 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 66.04s | valid loss  3.72 | valid ppl    41.44 | valid bpc    5.373
-----------------------------------------------------------------------------------------
PROGRESS: 62.0%
| epoch  63 |   100/  269 batches | lr 0.00000 | ms/batch 255.18 | loss  3.11 | ppl    22.46 
| epoch  63 |   200/  269 batches | lr 0.00000 | ms/batch 229.41 | loss  3.10 | ppl    22.10 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 65.67s | valid loss  3.71 | valid ppl    40.78 | valid bpc    5.350
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 63.0%
| epoch  64 |   100/  269 batches | lr 0.00000 | ms/batch 253.19 | loss  3.12 | ppl    22.70 
| epoch  64 |   200/  269 batches | lr 0.00000 | ms/batch 230.04 | loss  3.08 | ppl    21.80 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 65.55s | valid loss  3.75 | valid ppl    42.50 | valid bpc    5.409
-----------------------------------------------------------------------------------------
PROGRESS: 64.0%
| epoch  65 |   100/  269 batches | lr 0.00000 | ms/batch 253.49 | loss  3.11 | ppl    22.32 
| epoch  65 |   200/  269 batches | lr 0.00000 | ms/batch 234.92 | loss  3.08 | ppl    21.80 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 65.62s | valid loss  3.72 | valid ppl    41.23 | valid bpc    5.366
-----------------------------------------------------------------------------------------
PROGRESS: 65.0%
| epoch  66 |   100/  269 batches | lr 0.00000 | ms/batch 252.11 | loss  3.10 | ppl    22.17 
| epoch  66 |   200/  269 batches | lr 0.00000 | ms/batch 237.60 | loss  3.08 | ppl    21.69 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 65.99s | valid loss  3.72 | valid ppl    41.26 | valid bpc    5.367
-----------------------------------------------------------------------------------------
PROGRESS: 66.0%
| epoch  67 |   100/  269 batches | lr 0.00000 | ms/batch 248.70 | loss  3.12 | ppl    22.55 
| epoch  67 |   200/  269 batches | lr 0.00000 | ms/batch 238.93 | loss  3.07 | ppl    21.50 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 65.96s | valid loss  3.79 | valid ppl    44.07 | valid bpc    5.462
-----------------------------------------------------------------------------------------
PROGRESS: 67.0%
| epoch  68 |   100/  269 batches | lr 0.00000 | ms/batch 247.65 | loss  3.11 | ppl    22.40 
| epoch  68 |   200/  269 batches | lr 0.00000 | ms/batch 239.63 | loss  3.07 | ppl    21.64 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 66.15s | valid loss  3.72 | valid ppl    41.09 | valid bpc    5.361
-----------------------------------------------------------------------------------------
PROGRESS: 68.0%
| epoch  69 |   100/  269 batches | lr 0.00000 | ms/batch 246.33 | loss  3.09 | ppl    22.01 
| epoch  69 |   200/  269 batches | lr 0.00000 | ms/batch 240.12 | loss  3.06 | ppl    21.41 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 66.21s | valid loss  3.68 | valid ppl    39.66 | valid bpc    5.309
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 69.0%
| epoch  70 |   100/  269 batches | lr 0.00000 | ms/batch 248.25 | loss  3.10 | ppl    22.15 
| epoch  70 |   200/  269 batches | lr 0.00000 | ms/batch 240.46 | loss  3.08 | ppl    21.66 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 66.12s | valid loss  3.78 | valid ppl    43.81 | valid bpc    5.453
-----------------------------------------------------------------------------------------
PROGRESS: 70.0%
| epoch  71 |   100/  269 batches | lr 0.00000 | ms/batch 247.76 | loss  3.10 | ppl    22.13 
| epoch  71 |   200/  269 batches | lr 0.00000 | ms/batch 239.74 | loss  3.07 | ppl    21.63 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 66.23s | valid loss  3.77 | valid ppl    43.17 | valid bpc    5.432
-----------------------------------------------------------------------------------------
PROGRESS: 71.0%
| epoch  72 |   100/  269 batches | lr 0.00000 | ms/batch 246.22 | loss  3.13 | ppl    22.85 
| epoch  72 |   200/  269 batches | lr 0.00000 | ms/batch 239.46 | loss  3.05 | ppl    21.17 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 66.24s | valid loss  3.78 | valid ppl    43.63 | valid bpc    5.447
-----------------------------------------------------------------------------------------
PROGRESS: 72.0%
| epoch  73 |   100/  269 batches | lr 0.00000 | ms/batch 242.84 | loss  3.11 | ppl    22.52 
| epoch  73 |   200/  269 batches | lr 0.00000 | ms/batch 239.81 | loss  3.06 | ppl    21.42 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 65.99s | valid loss  3.75 | valid ppl    42.54 | valid bpc    5.411
-----------------------------------------------------------------------------------------
PROGRESS: 73.0%
| epoch  74 |   100/  269 batches | lr 0.00000 | ms/batch 241.04 | loss  3.10 | ppl    22.30 
| epoch  74 |   200/  269 batches | lr 0.00000 | ms/batch 240.12 | loss  3.07 | ppl    21.55 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 66.02s | valid loss  3.76 | valid ppl    43.15 | valid bpc    5.431
-----------------------------------------------------------------------------------------
PROGRESS: 74.0%
| epoch  75 |   100/  269 batches | lr 0.00000 | ms/batch 242.45 | loss  3.09 | ppl    21.90 
| epoch  75 |   200/  269 batches | lr 0.00000 | ms/batch 240.21 | loss  3.09 | ppl    22.01 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 66.00s | valid loss  3.73 | valid ppl    41.80 | valid bpc    5.385
-----------------------------------------------------------------------------------------
PROGRESS: 75.0%
| epoch  76 |   100/  269 batches | lr 0.00000 | ms/batch 243.11 | loss  3.11 | ppl    22.42 
| epoch  76 |   200/  269 batches | lr 0.00000 | ms/batch 239.01 | loss  3.07 | ppl    21.53 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 65.96s | valid loss  3.72 | valid ppl    41.43 | valid bpc    5.373
-----------------------------------------------------------------------------------------
PROGRESS: 76.0%
| epoch  77 |   100/  269 batches | lr 0.00000 | ms/batch 242.99 | loss  3.12 | ppl    22.56 
| epoch  77 |   200/  269 batches | lr 0.00000 | ms/batch 239.38 | loss  3.09 | ppl    21.96 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 65.49s | valid loss  3.67 | valid ppl    39.38 | valid bpc    5.299
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 77.0%
| epoch  78 |   100/  269 batches | lr 0.00000 | ms/batch 249.09 | loss  3.10 | ppl    22.11 
| epoch  78 |   200/  269 batches | lr 0.00000 | ms/batch 238.99 | loss  3.06 | ppl    21.31 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 65.97s | valid loss  3.78 | valid ppl    43.69 | valid bpc    5.449
-----------------------------------------------------------------------------------------
PROGRESS: 78.0%
| epoch  79 |   100/  269 batches | lr 0.00000 | ms/batch 247.58 | loss  3.08 | ppl    21.76 
| epoch  79 |   200/  269 batches | lr 0.00000 | ms/batch 238.83 | loss  3.07 | ppl    21.54 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 65.97s | valid loss  3.71 | valid ppl    40.92 | valid bpc    5.355
-----------------------------------------------------------------------------------------
PROGRESS: 79.0%
| epoch  80 |   100/  269 batches | lr 0.00000 | ms/batch 248.95 | loss  3.10 | ppl    22.18 
| epoch  80 |   200/  269 batches | lr 0.00000 | ms/batch 239.23 | loss  3.07 | ppl    21.49 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 66.02s | valid loss  3.69 | valid ppl    39.89 | valid bpc    5.318
-----------------------------------------------------------------------------------------
PROGRESS: 80.0%
| epoch  81 |   100/  269 batches | lr 0.00000 | ms/batch 247.79 | loss  3.09 | ppl    21.93 
| epoch  81 |   200/  269 batches | lr 0.00000 | ms/batch 240.36 | loss  3.08 | ppl    21.70 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 65.63s | valid loss  3.70 | valid ppl    40.39 | valid bpc    5.336
-----------------------------------------------------------------------------------------
PROGRESS: 81.0%
| epoch  82 |   100/  269 batches | lr 0.00000 | ms/batch 247.76 | loss  3.12 | ppl    22.70 
| epoch  82 |   200/  269 batches | lr 0.00000 | ms/batch 240.13 | loss  3.10 | ppl    22.10 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 65.99s | valid loss  3.69 | valid ppl    39.90 | valid bpc    5.318
-----------------------------------------------------------------------------------------
PROGRESS: 82.0%
| epoch  83 |   100/  269 batches | lr 0.00000 | ms/batch 248.60 | loss  3.10 | ppl    22.13 
| epoch  83 |   200/  269 batches | lr 0.00000 | ms/batch 239.19 | loss  3.06 | ppl    21.27 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 65.96s | valid loss  3.72 | valid ppl    41.37 | valid bpc    5.370
-----------------------------------------------------------------------------------------
PROGRESS: 83.0%
| epoch  84 |   100/  269 batches | lr 0.00000 | ms/batch 248.78 | loss  3.11 | ppl    22.34 
| epoch  84 |   200/  269 batches | lr 0.00000 | ms/batch 239.95 | loss  3.06 | ppl    21.30 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 65.96s | valid loss  3.70 | valid ppl    40.59 | valid bpc    5.343
-----------------------------------------------------------------------------------------
PROGRESS: 84.0%
| epoch  85 |   100/  269 batches | lr 0.00000 | ms/batch 249.04 | loss  3.10 | ppl    22.28 
| epoch  85 |   200/  269 batches | lr 0.00000 | ms/batch 237.49 | loss  3.08 | ppl    21.69 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 65.99s | valid loss  3.73 | valid ppl    41.84 | valid bpc    5.387
-----------------------------------------------------------------------------------------
PROGRESS: 85.0%
| epoch  86 |   100/  269 batches | lr 0.00000 | ms/batch 247.25 | loss  3.08 | ppl    21.77 
| epoch  86 |   200/  269 batches | lr 0.00000 | ms/batch 234.20 | loss  3.07 | ppl    21.46 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 65.99s | valid loss  3.73 | valid ppl    41.81 | valid bpc    5.386
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  269 batches | lr 0.00000 | ms/batch 247.95 | loss  3.11 | ppl    22.36 
| epoch  87 |   200/  269 batches | lr 0.00000 | ms/batch 227.63 | loss  3.07 | ppl    21.47 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 60.38s | valid loss  3.76 | valid ppl    42.95 | valid bpc    5.425
-----------------------------------------------------------------------------------------
PROGRESS: 87.0%
| epoch  88 |   100/  269 batches | lr 0.00000 | ms/batch 173.34 | loss  3.09 | ppl    22.03 
| epoch  88 |   200/  269 batches | lr 0.00000 | ms/batch 170.89 | loss  3.06 | ppl    21.40 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 47.03s | valid loss  3.70 | valid ppl    40.59 | valid bpc    5.343
-----------------------------------------------------------------------------------------
PROGRESS: 88.0%
| epoch  89 |   100/  269 batches | lr 0.00000 | ms/batch 165.76 | loss  3.10 | ppl    22.14 
| epoch  89 |   200/  269 batches | lr 0.00000 | ms/batch 159.08 | loss  3.06 | ppl    21.23 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 44.25s | valid loss  3.74 | valid ppl    42.31 | valid bpc    5.403
-----------------------------------------------------------------------------------------
PROGRESS: 89.0%
| epoch  90 |   100/  269 batches | lr 0.00000 | ms/batch 220.53 | loss  3.09 | ppl    21.95 
| epoch  90 |   200/  269 batches | lr 0.00000 | ms/batch 240.07 | loss  3.08 | ppl    21.65 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 63.86s | valid loss  3.68 | valid ppl    39.60 | valid bpc    5.307
-----------------------------------------------------------------------------------------
PROGRESS: 90.0%
| epoch  91 |   100/  269 batches | lr 0.00000 | ms/batch 239.21 | loss  3.10 | ppl    22.19 
| epoch  91 |   200/  269 batches | lr 0.00000 | ms/batch 239.80 | loss  3.08 | ppl    21.65 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 65.61s | valid loss  3.76 | valid ppl    42.83 | valid bpc    5.421
-----------------------------------------------------------------------------------------
PROGRESS: 91.0%
| epoch  92 |   100/  269 batches | lr 0.00000 | ms/batch 238.54 | loss  3.10 | ppl    22.19 
| epoch  92 |   200/  269 batches | lr 0.00000 | ms/batch 240.64 | loss  3.06 | ppl    21.35 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 65.70s | valid loss  3.78 | valid ppl    43.67 | valid bpc    5.449
-----------------------------------------------------------------------------------------
PROGRESS: 92.0%
| epoch  93 |   100/  269 batches | lr 0.00000 | ms/batch 239.48 | loss  3.10 | ppl    22.18 
| epoch  93 |   200/  269 batches | lr 0.00000 | ms/batch 238.81 | loss  3.07 | ppl    21.46 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 65.62s | valid loss  3.77 | valid ppl    43.38 | valid bpc    5.439
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  269 batches | lr 0.00000 | ms/batch 238.49 | loss  3.08 | ppl    21.77 
| epoch  94 |   200/  269 batches | lr 0.00000 | ms/batch 239.03 | loss  3.07 | ppl    21.48 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 65.51s | valid loss  3.72 | valid ppl    41.21 | valid bpc    5.365
-----------------------------------------------------------------------------------------
PROGRESS: 94.0%
| epoch  95 |   100/  269 batches | lr 0.00000 | ms/batch 237.09 | loss  3.10 | ppl    22.15 
| epoch  95 |   200/  269 batches | lr 0.00000 | ms/batch 239.14 | loss  3.07 | ppl    21.62 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 65.34s | valid loss  3.73 | valid ppl    41.81 | valid bpc    5.386
-----------------------------------------------------------------------------------------
PROGRESS: 95.0%
| epoch  96 |   100/  269 batches | lr 0.00000 | ms/batch 236.96 | loss  3.11 | ppl    22.49 
| epoch  96 |   200/  269 batches | lr 0.00000 | ms/batch 239.36 | loss  3.06 | ppl    21.40 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 65.28s | valid loss  3.78 | valid ppl    43.68 | valid bpc    5.449
-----------------------------------------------------------------------------------------
PROGRESS: 96.0%
| epoch  97 |   100/  269 batches | lr 0.00000 | ms/batch 236.95 | loss  3.09 | ppl    22.02 
| epoch  97 |   200/  269 batches | lr 0.00000 | ms/batch 240.02 | loss  3.07 | ppl    21.61 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 65.28s | valid loss  3.79 | valid ppl    44.06 | valid bpc    5.461
-----------------------------------------------------------------------------------------
PROGRESS: 97.0%
| epoch  98 |   100/  269 batches | lr 0.00000 | ms/batch 235.92 | loss  3.09 | ppl    22.02 
| epoch  98 |   200/  269 batches | lr 0.00000 | ms/batch 240.95 | loss  3.07 | ppl    21.52 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 65.27s | valid loss  3.72 | valid ppl    41.33 | valid bpc    5.369
-----------------------------------------------------------------------------------------
PROGRESS: 98.0%
| epoch  99 |   100/  269 batches | lr 0.00000 | ms/batch 238.16 | loss  3.11 | ppl    22.35 
| epoch  99 |   200/  269 batches | lr 0.00000 | ms/batch 239.84 | loss  3.06 | ppl    21.23 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 65.30s | valid loss  3.76 | valid ppl    42.83 | valid bpc    5.421
-----------------------------------------------------------------------------------------
PROGRESS: 99.0%
| epoch 100 |   100/  269 batches | lr 0.00000 | ms/batch 240.73 | loss  3.10 | ppl    22.24 
| epoch 100 |   200/  269 batches | lr 0.00000 | ms/batch 240.33 | loss  3.08 | ppl    21.85 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 65.28s | valid loss  3.72 | valid ppl    41.43 | valid bpc    5.373
-----------------------------------------------------------------------------------------
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  3.80 | test ppl    44.62 | test bpc    5.480
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.5042, Mean Reca: 0.7083, Mean F1: 0.5845, Mean Subword_Reca: 0.8494
-----------------------------------------------------------------------------------------
=========================================================================================
Loading dataset...
Using subword tokenizer...
Number of tokens:  8000
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer_in_parser', nhid=512, nlayers=8, front_layers=4, rear_layers=4, subword='omarmomen/ptb_filtered_lowcase_bpe_tokenizer_8', n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=5555, nonmono=5, cuda=True, log_interval=100, save='trained_models/subword_structformer_in_parser_5555_44.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 37449092
Model architecture: StructFormer_In_Parser(
  (transformer_front): Transformer_Front(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(8000, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-3): 4 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
  (transformer_rear): Transformer_Rear(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(8000, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-3): 4 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (output_layer): Linear(in_features=512, out_features=8000, bias=True)
  )
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  269 batches | lr 0.00030 | ms/batch 173.56 | loss  7.77 | ppl  2362.71 
| epoch   1 |   200/  269 batches | lr 0.00030 | ms/batch 164.89 | loss  7.37 | ppl  1581.11 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 50.61s | valid loss  7.08 | valid ppl  1183.47 | valid bpc   10.209
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  269 batches | lr 0.00030 | ms/batch 254.01 | loss  7.27 | ppl  1432.62 
| epoch   2 |   200/  269 batches | lr 0.00030 | ms/batch 228.84 | loss  7.16 | ppl  1285.67 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 65.28s | valid loss  6.91 | valid ppl   998.87 | valid bpc    9.964
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  269 batches | lr 0.00030 | ms/batch 253.69 | loss  7.09 | ppl  1199.07 
| epoch   3 |   200/  269 batches | lr 0.00030 | ms/batch 221.32 | loss  6.83 | ppl   922.00 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 63.63s | valid loss  6.38 | valid ppl   591.94 | valid bpc    9.209
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  269 batches | lr 0.00030 | ms/batch 253.15 | loss  6.45 | ppl   634.86 
| epoch   4 |   200/  269 batches | lr 0.00030 | ms/batch 232.74 | loss  6.20 | ppl   491.01 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 65.28s | valid loss  5.84 | valid ppl   344.47 | valid bpc    8.428
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  269 batches | lr 0.00030 | ms/batch 255.26 | loss  6.02 | ppl   411.12 
| epoch   5 |   200/  269 batches | lr 0.00030 | ms/batch 230.38 | loss  5.85 | ppl   346.74 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 65.31s | valid loss  5.55 | valid ppl   255.97 | valid bpc    8.000
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  269 batches | lr 0.00030 | ms/batch 255.95 | loss  5.73 | ppl   309.45 
| epoch   6 |   200/  269 batches | lr 0.00030 | ms/batch 230.34 | loss  5.61 | ppl   274.03 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 65.36s | valid loss  5.43 | valid ppl   227.20 | valid bpc    7.828
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  269 batches | lr 0.00030 | ms/batch 253.40 | loss  5.56 | ppl   259.13 
| epoch   7 |   200/  269 batches | lr 0.00030 | ms/batch 231.46 | loss  5.43 | ppl   227.87 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 65.35s | valid loss  5.24 | valid ppl   189.01 | valid bpc    7.562
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  269 batches | lr 0.00030 | ms/batch 253.69 | loss  5.39 | ppl   219.66 
| epoch   8 |   200/  269 batches | lr 0.00030 | ms/batch 230.04 | loss  5.29 | ppl   199.04 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 65.31s | valid loss  5.10 | valid ppl   163.23 | valid bpc    7.351
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 8.0%
| epoch   9 |   100/  269 batches | lr 0.00030 | ms/batch 255.05 | loss  5.27 | ppl   193.98 
| epoch   9 |   200/  269 batches | lr 0.00030 | ms/batch 230.14 | loss  5.15 | ppl   172.07 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 65.34s | valid loss  5.00 | valid ppl   147.76 | valid bpc    7.207
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  269 batches | lr 0.00030 | ms/batch 254.29 | loss  5.14 | ppl   170.96 
| epoch  10 |   200/  269 batches | lr 0.00030 | ms/batch 231.00 | loss  5.06 | ppl   158.18 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 65.39s | valid loss  4.91 | valid ppl   135.93 | valid bpc    7.087
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  269 batches | lr 0.00030 | ms/batch 254.40 | loss  5.06 | ppl   157.12 
| epoch  11 |   200/  269 batches | lr 0.00030 | ms/batch 234.55 | loss  4.94 | ppl   139.15 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 65.82s | valid loss  4.80 | valid ppl   121.94 | valid bpc    6.930
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  269 batches | lr 0.00030 | ms/batch 255.07 | loss  4.93 | ppl   138.21 
| epoch  12 |   200/  269 batches | lr 0.00030 | ms/batch 231.97 | loss  4.85 | ppl   128.31 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 65.44s | valid loss  4.69 | valid ppl   108.44 | valid bpc    6.761
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 12.0%
| epoch  13 |   100/  269 batches | lr 0.00030 | ms/batch 255.22 | loss  4.85 | ppl   127.27 
| epoch  13 |   200/  269 batches | lr 0.00030 | ms/batch 230.36 | loss  4.76 | ppl   116.79 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 65.40s | valid loss  4.61 | valid ppl   100.88 | valid bpc    6.656
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 13.0%
| epoch  14 |   100/  269 batches | lr 0.00030 | ms/batch 251.64 | loss  4.76 | ppl   116.43 
| epoch  14 |   200/  269 batches | lr 0.00030 | ms/batch 236.74 | loss  4.68 | ppl   107.56 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 65.63s | valid loss  4.57 | valid ppl    96.12 | valid bpc    6.587
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  269 batches | lr 0.00030 | ms/batch 245.97 | loss  4.67 | ppl   106.59 
| epoch  15 |   200/  269 batches | lr 0.00030 | ms/batch 239.63 | loss  4.58 | ppl    97.72 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 65.36s | valid loss  4.50 | valid ppl    89.62 | valid bpc    6.486
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 15.0%
| epoch  16 |   100/  269 batches | lr 0.00030 | ms/batch 244.92 | loss  4.57 | ppl    96.84 
| epoch  16 |   200/  269 batches | lr 0.00030 | ms/batch 240.03 | loss  4.51 | ppl    90.78 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 65.37s | valid loss  4.47 | valid ppl    87.60 | valid bpc    6.453
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 16.0%
| epoch  17 |   100/  269 batches | lr 0.00030 | ms/batch 244.66 | loss  4.49 | ppl    88.96 
| epoch  17 |   200/  269 batches | lr 0.00030 | ms/batch 241.04 | loss  4.48 | ppl    88.19 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 65.34s | valid loss  4.39 | valid ppl    80.58 | valid bpc    6.332
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 17.0%
| epoch  18 |   100/  269 batches | lr 0.00030 | ms/batch 249.18 | loss  4.44 | ppl    85.16 
| epoch  18 |   200/  269 batches | lr 0.00030 | ms/batch 239.17 | loss  4.37 | ppl    79.07 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 65.68s | valid loss  4.37 | valid ppl    78.98 | valid bpc    6.303
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 18.0%
| epoch  19 |   100/  269 batches | lr 0.00030 | ms/batch 244.95 | loss  4.36 | ppl    78.30 
| epoch  19 |   200/  269 batches | lr 0.00030 | ms/batch 240.05 | loss  4.32 | ppl    75.08 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 65.72s | valid loss  4.26 | valid ppl    70.96 | valid bpc    6.149
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 19.0%
| epoch  20 |   100/  269 batches | lr 0.00030 | ms/batch 245.21 | loss  4.28 | ppl    72.36 
| epoch  20 |   200/  269 batches | lr 0.00030 | ms/batch 239.85 | loss  4.24 | ppl    69.37 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 65.43s | valid loss  4.27 | valid ppl    71.56 | valid bpc    6.161
-----------------------------------------------------------------------------------------
PROGRESS: 20.0%
| epoch  21 |   100/  269 batches | lr 0.00030 | ms/batch 244.72 | loss  4.24 | ppl    69.24 
| epoch  21 |   200/  269 batches | lr 0.00030 | ms/batch 239.38 | loss  4.19 | ppl    66.18 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 65.39s | valid loss  4.22 | valid ppl    67.97 | valid bpc    6.087
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 21.0%
| epoch  22 |   100/  269 batches | lr 0.00030 | ms/batch 248.44 | loss  4.18 | ppl    65.14 
| epoch  22 |   200/  269 batches | lr 0.00030 | ms/batch 240.92 | loss  4.14 | ppl    62.84 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 65.70s | valid loss  4.20 | valid ppl    66.80 | valid bpc    6.062
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 22.0%
| epoch  23 |   100/  269 batches | lr 0.00030 | ms/batch 249.25 | loss  4.11 | ppl    61.04 
| epoch  23 |   200/  269 batches | lr 0.00030 | ms/batch 240.50 | loss  4.10 | ppl    60.04 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 66.07s | valid loss  4.12 | valid ppl    61.36 | valid bpc    5.939
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 23.0%
| epoch  24 |   100/  269 batches | lr 0.00030 | ms/batch 247.66 | loss  4.04 | ppl    56.62 
| epoch  24 |   200/  269 batches | lr 0.00030 | ms/batch 240.49 | loss  4.03 | ppl    56.50 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 65.01s | valid loss  4.17 | valid ppl    64.61 | valid bpc    6.014
-----------------------------------------------------------------------------------------
PROGRESS: 24.0%
| epoch  25 |   100/  269 batches | lr 0.00030 | ms/batch 251.22 | loss  3.99 | ppl    54.31 
| epoch  25 |   200/  269 batches | lr 0.00030 | ms/batch 240.74 | loss  4.01 | ppl    54.89 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 64.76s | valid loss  4.12 | valid ppl    61.83 | valid bpc    5.950
-----------------------------------------------------------------------------------------
PROGRESS: 25.0%
| epoch  26 |   100/  269 batches | lr 0.00030 | ms/batch 249.11 | loss  3.94 | ppl    51.58 
| epoch  26 |   200/  269 batches | lr 0.00030 | ms/batch 238.83 | loss  3.95 | ppl    52.09 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 65.94s | valid loss  4.05 | valid ppl    57.52 | valid bpc    5.846
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 26.0%
| epoch  27 |   100/  269 batches | lr 0.00030 | ms/batch 248.11 | loss  3.91 | ppl    49.78 
| epoch  27 |   200/  269 batches | lr 0.00030 | ms/batch 238.86 | loss  3.88 | ppl    48.30 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 65.85s | valid loss  4.05 | valid ppl    57.32 | valid bpc    5.841
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 27.0%
| epoch  28 |   100/  269 batches | lr 0.00030 | ms/batch 243.30 | loss  3.85 | ppl    46.88 
| epoch  28 |   200/  269 batches | lr 0.00030 | ms/batch 240.02 | loss  3.82 | ppl    45.64 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 65.11s | valid loss  4.03 | valid ppl    56.35 | valid bpc    5.816
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  269 batches | lr 0.00030 | ms/batch 247.54 | loss  3.81 | ppl    45.23 
| epoch  29 |   200/  269 batches | lr 0.00030 | ms/batch 239.98 | loss  3.77 | ppl    43.52 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 65.95s | valid loss  3.98 | valid ppl    53.75 | valid bpc    5.748
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  269 batches | lr 0.00030 | ms/batch 248.87 | loss  3.78 | ppl    43.61 
| epoch  30 |   200/  269 batches | lr 0.00030 | ms/batch 240.31 | loss  3.75 | ppl    42.48 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 66.09s | valid loss  3.99 | valid ppl    54.20 | valid bpc    5.760
-----------------------------------------------------------------------------------------
PROGRESS: 30.0%
| epoch  31 |   100/  269 batches | lr 0.00030 | ms/batch 246.02 | loss  3.71 | ppl    41.05 
| epoch  31 |   200/  269 batches | lr 0.00030 | ms/batch 236.98 | loss  3.73 | ppl    41.70 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 65.34s | valid loss  4.00 | valid ppl    54.48 | valid bpc    5.768
-----------------------------------------------------------------------------------------
PROGRESS: 31.0%
| epoch  32 |   100/  269 batches | lr 0.00030 | ms/batch 245.84 | loss  3.69 | ppl    40.05 
| epoch  32 |   200/  269 batches | lr 0.00030 | ms/batch 234.12 | loss  3.68 | ppl    39.67 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 65.68s | valid loss  3.99 | valid ppl    54.12 | valid bpc    5.758
-----------------------------------------------------------------------------------------
PROGRESS: 32.0%
| epoch  33 |   100/  269 batches | lr 0.00015 | ms/batch 248.21 | loss  3.61 | ppl    36.79 
| epoch  33 |   200/  269 batches | lr 0.00015 | ms/batch 233.65 | loss  3.57 | ppl    35.58 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 66.01s | valid loss  3.84 | valid ppl    46.67 | valid bpc    5.544
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 33.0%
| epoch  34 |   100/  269 batches | lr 0.00015 | ms/batch 249.03 | loss  3.55 | ppl    34.80 
| epoch  34 |   200/  269 batches | lr 0.00015 | ms/batch 233.64 | loss  3.54 | ppl    34.53 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 66.05s | valid loss  3.88 | valid ppl    48.40 | valid bpc    5.597
-----------------------------------------------------------------------------------------
PROGRESS: 34.0%
| epoch  35 |   100/  269 batches | lr 0.00015 | ms/batch 245.91 | loss  3.52 | ppl    33.65 
| epoch  35 |   200/  269 batches | lr 0.00015 | ms/batch 235.21 | loss  3.50 | ppl    33.04 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 65.80s | valid loss  3.88 | valid ppl    48.62 | valid bpc    5.603
-----------------------------------------------------------------------------------------
PROGRESS: 35.0%
| epoch  36 |   100/  269 batches | lr 0.00015 | ms/batch 247.76 | loss  3.50 | ppl    32.95 
| epoch  36 |   200/  269 batches | lr 0.00015 | ms/batch 234.21 | loss  3.45 | ppl    31.50 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 66.09s | valid loss  3.88 | valid ppl    48.31 | valid bpc    5.594
-----------------------------------------------------------------------------------------
PROGRESS: 36.0%
| epoch  37 |   100/  269 batches | lr 0.00007 | ms/batch 248.60 | loss  3.43 | ppl    30.76 
| epoch  37 |   200/  269 batches | lr 0.00007 | ms/batch 234.79 | loss  3.43 | ppl    30.73 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 66.07s | valid loss  3.80 | valid ppl    44.62 | valid bpc    5.480
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 37.0%
| epoch  38 |   100/  269 batches | lr 0.00007 | ms/batch 245.20 | loss  3.42 | ppl    30.69 
| epoch  38 |   200/  269 batches | lr 0.00007 | ms/batch 235.50 | loss  3.35 | ppl    28.55 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 65.71s | valid loss  3.85 | valid ppl    47.22 | valid bpc    5.561
-----------------------------------------------------------------------------------------
PROGRESS: 38.0%
| epoch  39 |   100/  269 batches | lr 0.00007 | ms/batch 248.26 | loss  3.40 | ppl    30.01 
| epoch  39 |   200/  269 batches | lr 0.00007 | ms/batch 235.19 | loss  3.35 | ppl    28.55 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 66.00s | valid loss  3.84 | valid ppl    46.48 | valid bpc    5.539
-----------------------------------------------------------------------------------------
PROGRESS: 39.0%
| epoch  40 |   100/  269 batches | lr 0.00007 | ms/batch 248.25 | loss  3.36 | ppl    28.92 
| epoch  40 |   200/  269 batches | lr 0.00007 | ms/batch 233.56 | loss  3.36 | ppl    28.80 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 66.03s | valid loss  3.85 | valid ppl    47.09 | valid bpc    5.557
-----------------------------------------------------------------------------------------
PROGRESS: 40.0%
| epoch  41 |   100/  269 batches | lr 0.00004 | ms/batch 245.27 | loss  3.35 | ppl    28.53 
| epoch  41 |   200/  269 batches | lr 0.00004 | ms/batch 234.06 | loss  3.30 | ppl    27.22 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 65.66s | valid loss  3.81 | valid ppl    45.37 | valid bpc    5.504
-----------------------------------------------------------------------------------------
PROGRESS: 41.0%
| epoch  42 |   100/  269 batches | lr 0.00004 | ms/batch 241.62 | loss  3.35 | ppl    28.64 
| epoch  42 |   200/  269 batches | lr 0.00004 | ms/batch 238.35 | loss  3.29 | ppl    26.80 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 65.67s | valid loss  3.87 | valid ppl    47.81 | valid bpc    5.579
-----------------------------------------------------------------------------------------
PROGRESS: 42.0%
| epoch  43 |   100/  269 batches | lr 0.00004 | ms/batch 242.38 | loss  3.32 | ppl    27.70 
| epoch  43 |   200/  269 batches | lr 0.00004 | ms/batch 240.82 | loss  3.29 | ppl    26.86 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 65.99s | valid loss  3.81 | valid ppl    45.06 | valid bpc    5.494
-----------------------------------------------------------------------------------------
PROGRESS: 43.0%
| epoch  44 |   100/  269 batches | lr 0.00002 | ms/batch 238.68 | loss  3.30 | ppl    26.98 
| epoch  44 |   200/  269 batches | lr 0.00002 | ms/batch 238.98 | loss  3.26 | ppl    26.10 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 65.66s | valid loss  3.76 | valid ppl    42.81 | valid bpc    5.420
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 44.0%
| epoch  45 |   100/  269 batches | lr 0.00002 | ms/batch 235.21 | loss  3.29 | ppl    26.84 
| epoch  45 |   200/  269 batches | lr 0.00002 | ms/batch 239.28 | loss  3.26 | ppl    26.03 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 65.34s | valid loss  3.84 | valid ppl    46.63 | valid bpc    5.543
-----------------------------------------------------------------------------------------
PROGRESS: 45.0%
| epoch  46 |   100/  269 batches | lr 0.00002 | ms/batch 242.52 | loss  3.29 | ppl    26.77 
| epoch  46 |   200/  269 batches | lr 0.00002 | ms/batch 240.78 | loss  3.27 | ppl    26.25 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 66.03s | valid loss  3.74 | valid ppl    42.04 | valid bpc    5.394
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 46.0%
| epoch  47 |   100/  269 batches | lr 0.00002 | ms/batch 242.26 | loss  3.28 | ppl    26.49 
| epoch  47 |   200/  269 batches | lr 0.00002 | ms/batch 240.84 | loss  3.27 | ppl    26.30 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 66.00s | valid loss  3.80 | valid ppl    44.53 | valid bpc    5.477
-----------------------------------------------------------------------------------------
PROGRESS: 47.0%
| epoch  48 |   100/  269 batches | lr 0.00002 | ms/batch 238.15 | loss  3.28 | ppl    26.56 
| epoch  48 |   200/  269 batches | lr 0.00002 | ms/batch 240.23 | loss  3.23 | ppl    25.25 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 65.67s | valid loss  3.82 | valid ppl    45.54 | valid bpc    5.509
-----------------------------------------------------------------------------------------
PROGRESS: 48.0%
| epoch  49 |   100/  269 batches | lr 0.00002 | ms/batch 242.21 | loss  3.26 | ppl    26.02 
| epoch  49 |   200/  269 batches | lr 0.00002 | ms/batch 240.48 | loss  3.28 | ppl    26.58 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 66.03s | valid loss  3.79 | valid ppl    44.41 | valid bpc    5.473
-----------------------------------------------------------------------------------------
PROGRESS: 49.0%
| epoch  50 |   100/  269 batches | lr 0.00001 | ms/batch 242.77 | loss  3.26 | ppl    25.99 
| epoch  50 |   200/  269 batches | lr 0.00001 | ms/batch 240.92 | loss  3.23 | ppl    25.17 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 66.02s | valid loss  3.77 | valid ppl    43.39 | valid bpc    5.439
-----------------------------------------------------------------------------------------
PROGRESS: 50.0%
| epoch  51 |   100/  269 batches | lr 0.00001 | ms/batch 243.39 | loss  3.28 | ppl    26.63 
| epoch  51 |   200/  269 batches | lr 0.00001 | ms/batch 239.52 | loss  3.24 | ppl    25.43 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 66.02s | valid loss  3.79 | valid ppl    44.15 | valid bpc    5.464
-----------------------------------------------------------------------------------------
PROGRESS: 51.0%
| epoch  52 |   100/  269 batches | lr 0.00001 | ms/batch 243.22 | loss  3.27 | ppl    26.23 
| epoch  52 |   200/  269 batches | lr 0.00001 | ms/batch 240.19 | loss  3.23 | ppl    25.29 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 66.10s | valid loss  3.77 | valid ppl    43.18 | valid bpc    5.432
-----------------------------------------------------------------------------------------
PROGRESS: 52.0%
| epoch  53 |   100/  269 batches | lr 0.00000 | ms/batch 239.67 | loss  3.26 | ppl    25.98 
| epoch  53 |   200/  269 batches | lr 0.00000 | ms/batch 240.19 | loss  3.22 | ppl    25.00 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 65.38s | valid loss  3.79 | valid ppl    44.24 | valid bpc    5.467
-----------------------------------------------------------------------------------------
PROGRESS: 53.0%
| epoch  54 |   100/  269 batches | lr 0.00000 | ms/batch 242.93 | loss  3.28 | ppl    26.64 
| epoch  54 |   200/  269 batches | lr 0.00000 | ms/batch 238.71 | loss  3.21 | ppl    24.80 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 65.40s | valid loss  3.79 | valid ppl    44.12 | valid bpc    5.463
-----------------------------------------------------------------------------------------
PROGRESS: 54.0%
| epoch  55 |   100/  269 batches | lr 0.00000 | ms/batch 252.55 | loss  3.26 | ppl    25.97 
| epoch  55 |   200/  269 batches | lr 0.00000 | ms/batch 236.78 | loss  3.22 | ppl    25.02 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 66.06s | valid loss  3.79 | valid ppl    44.12 | valid bpc    5.463
-----------------------------------------------------------------------------------------
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  269 batches | lr 0.00000 | ms/batch 254.54 | loss  3.25 | ppl    25.76 
| epoch  56 |   200/  269 batches | lr 0.00000 | ms/batch 234.16 | loss  3.22 | ppl    25.07 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 66.02s | valid loss  3.78 | valid ppl    43.63 | valid bpc    5.447
-----------------------------------------------------------------------------------------
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  269 batches | lr 0.00000 | ms/batch 254.14 | loss  3.24 | ppl    25.49 
| epoch  57 |   200/  269 batches | lr 0.00000 | ms/batch 234.22 | loss  3.22 | ppl    25.10 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 66.10s | valid loss  3.84 | valid ppl    46.31 | valid bpc    5.533
-----------------------------------------------------------------------------------------
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  269 batches | lr 0.00000 | ms/batch 254.40 | loss  3.26 | ppl    25.92 
| epoch  58 |   200/  269 batches | lr 0.00000 | ms/batch 230.77 | loss  3.22 | ppl    25.09 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 65.66s | valid loss  3.79 | valid ppl    44.19 | valid bpc    5.466
-----------------------------------------------------------------------------------------
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  269 batches | lr 0.00000 | ms/batch 253.32 | loss  3.26 | ppl    26.07 
| epoch  59 |   200/  269 batches | lr 0.00000 | ms/batch 234.45 | loss  3.21 | ppl    24.77 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 66.05s | valid loss  3.80 | valid ppl    44.68 | valid bpc    5.482
-----------------------------------------------------------------------------------------
PROGRESS: 59.0%
| epoch  60 |   100/  269 batches | lr 0.00000 | ms/batch 254.56 | loss  3.24 | ppl    25.48 
| epoch  60 |   200/  269 batches | lr 0.00000 | ms/batch 234.80 | loss  3.22 | ppl    25.01 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 66.05s | valid loss  3.76 | valid ppl    42.99 | valid bpc    5.426
-----------------------------------------------------------------------------------------
PROGRESS: 60.0%
| epoch  61 |   100/  269 batches | lr 0.00000 | ms/batch 254.30 | loss  3.26 | ppl    26.04 
| epoch  61 |   200/  269 batches | lr 0.00000 | ms/batch 232.76 | loss  3.21 | ppl    24.85 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 66.05s | valid loss  3.74 | valid ppl    42.13 | valid bpc    5.397
-----------------------------------------------------------------------------------------
PROGRESS: 61.0%
| epoch  62 |   100/  269 batches | lr 0.00000 | ms/batch 254.25 | loss  3.26 | ppl    26.02 
| epoch  62 |   200/  269 batches | lr 0.00000 | ms/batch 226.11 | loss  3.22 | ppl    25.02 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 65.72s | valid loss  3.82 | valid ppl    45.59 | valid bpc    5.511
-----------------------------------------------------------------------------------------
PROGRESS: 62.0%
| epoch  63 |   100/  269 batches | lr 0.00000 | ms/batch 254.50 | loss  3.27 | ppl    26.34 
| epoch  63 |   200/  269 batches | lr 0.00000 | ms/batch 227.82 | loss  3.21 | ppl    24.87 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 65.97s | valid loss  3.80 | valid ppl    44.71 | valid bpc    5.482
-----------------------------------------------------------------------------------------
PROGRESS: 63.0%
| epoch  64 |   100/  269 batches | lr 0.00000 | ms/batch 254.45 | loss  3.25 | ppl    25.83 
| epoch  64 |   200/  269 batches | lr 0.00000 | ms/batch 227.92 | loss  3.24 | ppl    25.44 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 66.03s | valid loss  3.85 | valid ppl    46.87 | valid bpc    5.550
-----------------------------------------------------------------------------------------
PROGRESS: 64.0%
| epoch  65 |   100/  269 batches | lr 0.00000 | ms/batch 254.31 | loss  3.23 | ppl    25.40 
| epoch  65 |   200/  269 batches | lr 0.00000 | ms/batch 228.78 | loss  3.24 | ppl    25.66 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 66.04s | valid loss  3.77 | valid ppl    43.40 | valid bpc    5.440
-----------------------------------------------------------------------------------------
PROGRESS: 65.0%
| epoch  66 |   100/  269 batches | lr 0.00000 | ms/batch 253.86 | loss  3.25 | ppl    25.67 
| epoch  66 |   200/  269 batches | lr 0.00000 | ms/batch 229.76 | loss  3.24 | ppl    25.42 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 66.06s | valid loss  3.79 | valid ppl    44.16 | valid bpc    5.465
-----------------------------------------------------------------------------------------
PROGRESS: 66.0%
| epoch  67 |   100/  269 batches | lr 0.00000 | ms/batch 254.60 | loss  3.27 | ppl    26.24 
| epoch  67 |   200/  269 batches | lr 0.00000 | ms/batch 228.66 | loss  3.22 | ppl    25.11 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 66.08s | valid loss  3.79 | valid ppl    44.46 | valid bpc    5.475
-----------------------------------------------------------------------------------------
PROGRESS: 67.0%
| epoch  68 |   100/  269 batches | lr 0.00000 | ms/batch 253.06 | loss  3.27 | ppl    26.35 
| epoch  68 |   200/  269 batches | lr 0.00000 | ms/batch 229.11 | loss  3.23 | ppl    25.37 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 66.06s | valid loss  3.80 | valid ppl    44.92 | valid bpc    5.489
-----------------------------------------------------------------------------------------
PROGRESS: 68.0%
| epoch  69 |   100/  269 batches | lr 0.00000 | ms/batch 255.13 | loss  3.25 | ppl    25.70 
| epoch  69 |   200/  269 batches | lr 0.00000 | ms/batch 227.40 | loss  3.22 | ppl    25.05 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 65.99s | valid loss  3.82 | valid ppl    45.57 | valid bpc    5.510
-----------------------------------------------------------------------------------------
PROGRESS: 69.0%
| epoch  70 |   100/  269 batches | lr 0.00000 | ms/batch 253.54 | loss  3.25 | ppl    25.70 
| epoch  70 |   200/  269 batches | lr 0.00000 | ms/batch 229.13 | loss  3.24 | ppl    25.57 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 66.02s | valid loss  3.82 | valid ppl    45.58 | valid bpc    5.510
-----------------------------------------------------------------------------------------
PROGRESS: 70.0%
| epoch  71 |   100/  269 batches | lr 0.00000 | ms/batch 255.29 | loss  3.27 | ppl    26.37 
| epoch  71 |   200/  269 batches | lr 0.00000 | ms/batch 227.52 | loss  3.21 | ppl    24.77 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 66.05s | valid loss  3.79 | valid ppl    44.32 | valid bpc    5.470
-----------------------------------------------------------------------------------------
PROGRESS: 71.0%
| epoch  72 |   100/  269 batches | lr 0.00000 | ms/batch 254.76 | loss  3.26 | ppl    26.00 
| epoch  72 |   200/  269 batches | lr 0.00000 | ms/batch 228.96 | loss  3.23 | ppl    25.30 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 66.02s | valid loss  3.79 | valid ppl    44.33 | valid bpc    5.470
-----------------------------------------------------------------------------------------
PROGRESS: 72.0%
| epoch  73 |   100/  269 batches | lr 0.00000 | ms/batch 248.08 | loss  3.25 | ppl    25.71 
| epoch  73 |   200/  269 batches | lr 0.00000 | ms/batch 231.50 | loss  3.22 | ppl    25.08 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 65.73s | valid loss  3.72 | valid ppl    41.08 | valid bpc    5.360
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 73.0%
| epoch  74 |   100/  269 batches | lr 0.00000 | ms/batch 248.90 | loss  3.29 | ppl    26.97 
| epoch  74 |   200/  269 batches | lr 0.00000 | ms/batch 233.46 | loss  3.21 | ppl    24.73 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 66.01s | valid loss  3.78 | valid ppl    43.82 | valid bpc    5.454
-----------------------------------------------------------------------------------------
PROGRESS: 74.0%
| epoch  75 |   100/  269 batches | lr 0.00000 | ms/batch 248.01 | loss  3.25 | ppl    25.76 
| epoch  75 |   200/  269 batches | lr 0.00000 | ms/batch 235.53 | loss  3.21 | ppl    24.78 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 65.98s | valid loss  3.79 | valid ppl    44.16 | valid bpc    5.465
-----------------------------------------------------------------------------------------
PROGRESS: 75.0%
| epoch  76 |   100/  269 batches | lr 0.00000 | ms/batch 248.55 | loss  3.26 | ppl    25.98 
| epoch  76 |   200/  269 batches | lr 0.00000 | ms/batch 234.18 | loss  3.21 | ppl    24.70 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 66.01s | valid loss  3.78 | valid ppl    43.78 | valid bpc    5.452
-----------------------------------------------------------------------------------------
PROGRESS: 76.0%
| epoch  77 |   100/  269 batches | lr 0.00000 | ms/batch 249.11 | loss  3.26 | ppl    26.01 
| epoch  77 |   200/  269 batches | lr 0.00000 | ms/batch 234.04 | loss  3.21 | ppl    24.82 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 66.03s | valid loss  3.80 | valid ppl    44.61 | valid bpc    5.479
-----------------------------------------------------------------------------------------
PROGRESS: 77.0%
| epoch  78 |   100/  269 batches | lr 0.00000 | ms/batch 249.48 | loss  3.24 | ppl    25.53 
| epoch  78 |   200/  269 batches | lr 0.00000 | ms/batch 232.69 | loss  3.21 | ppl    24.80 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 66.02s | valid loss  3.83 | valid ppl    46.04 | valid bpc    5.525
-----------------------------------------------------------------------------------------
PROGRESS: 78.0%
| epoch  79 |   100/  269 batches | lr 0.00000 | ms/batch 249.32 | loss  3.27 | ppl    26.23 
| epoch  79 |   200/  269 batches | lr 0.00000 | ms/batch 232.55 | loss  3.20 | ppl    24.65 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 66.05s | valid loss  3.77 | valid ppl    43.50 | valid bpc    5.443
-----------------------------------------------------------------------------------------
PROGRESS: 79.0%
| epoch  80 |   100/  269 batches | lr 0.00000 | ms/batch 247.89 | loss  3.26 | ppl    25.92 
| epoch  80 |   200/  269 batches | lr 0.00000 | ms/batch 234.25 | loss  3.22 | ppl    24.94 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 66.03s | valid loss  3.75 | valid ppl    42.42 | valid bpc    5.407
-----------------------------------------------------------------------------------------
PROGRESS: 80.0%
| epoch  81 |   100/  269 batches | lr 0.00000 | ms/batch 247.70 | loss  3.25 | ppl    25.67 
| epoch  81 |   200/  269 batches | lr 0.00000 | ms/batch 233.93 | loss  3.21 | ppl    24.81 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 66.02s | valid loss  3.79 | valid ppl    44.06 | valid bpc    5.461
-----------------------------------------------------------------------------------------
PROGRESS: 81.0%
| epoch  82 |   100/  269 batches | lr 0.00000 | ms/batch 248.46 | loss  3.26 | ppl    26.16 
| epoch  82 |   200/  269 batches | lr 0.00000 | ms/batch 233.65 | loss  3.21 | ppl    24.83 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 66.03s | valid loss  3.73 | valid ppl    41.60 | valid bpc    5.378
-----------------------------------------------------------------------------------------
PROGRESS: 82.0%
| epoch  83 |   100/  269 batches | lr 0.00000 | ms/batch 248.59 | loss  3.27 | ppl    26.37 
| epoch  83 |   200/  269 batches | lr 0.00000 | ms/batch 230.47 | loss  3.22 | ppl    25.00 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 65.44s | valid loss  3.76 | valid ppl    43.09 | valid bpc    5.429
-----------------------------------------------------------------------------------------
PROGRESS: 83.0%
| epoch  84 |   100/  269 batches | lr 0.00000 | ms/batch 181.68 | loss  3.26 | ppl    25.93 
| epoch  84 |   200/  269 batches | lr 0.00000 | ms/batch 165.23 | loss  3.22 | ppl    24.96 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 47.35s | valid loss  3.77 | valid ppl    43.32 | valid bpc    5.437
-----------------------------------------------------------------------------------------
PROGRESS: 84.0%
| epoch  85 |   100/  269 batches | lr 0.00000 | ms/batch 179.48 | loss  3.26 | ppl    26.10 
| epoch  85 |   200/  269 batches | lr 0.00000 | ms/batch 156.58 | loss  3.20 | ppl    24.50 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 45.29s | valid loss  3.78 | valid ppl    44.03 | valid bpc    5.460
-----------------------------------------------------------------------------------------
PROGRESS: 85.0%
| epoch  86 |   100/  269 batches | lr 0.00000 | ms/batch 166.95 | loss  3.26 | ppl    26.15 
| epoch  86 |   200/  269 batches | lr 0.00000 | ms/batch 226.32 | loss  3.22 | ppl    25.14 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 56.64s | valid loss  3.75 | valid ppl    42.56 | valid bpc    5.411
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  269 batches | lr 0.00000 | ms/batch 253.77 | loss  3.24 | ppl    25.54 
| epoch  87 |   200/  269 batches | lr 0.00000 | ms/batch 231.49 | loss  3.24 | ppl    25.54 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 65.63s | valid loss  3.84 | valid ppl    46.52 | valid bpc    5.540
-----------------------------------------------------------------------------------------
PROGRESS: 87.0%
| epoch  88 |   100/  269 batches | lr 0.00000 | ms/batch 250.04 | loss  3.24 | ppl    25.57 
| epoch  88 |   200/  269 batches | lr 0.00000 | ms/batch 235.62 | loss  3.24 | ppl    25.61 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 65.63s | valid loss  3.77 | valid ppl    43.18 | valid bpc    5.432
-----------------------------------------------------------------------------------------
PROGRESS: 88.0%
| epoch  89 |   100/  269 batches | lr 0.00000 | ms/batch 246.51 | loss  3.25 | ppl    25.76 
| epoch  89 |   200/  269 batches | lr 0.00000 | ms/batch 240.03 | loss  3.23 | ppl    25.24 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 65.66s | valid loss  3.81 | valid ppl    45.04 | valid bpc    5.493
-----------------------------------------------------------------------------------------
PROGRESS: 89.0%
| epoch  90 |   100/  269 batches | lr 0.00000 | ms/batch 244.91 | loss  3.26 | ppl    26.07 
| epoch  90 |   200/  269 batches | lr 0.00000 | ms/batch 240.61 | loss  3.22 | ppl    25.09 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 65.64s | valid loss  3.82 | valid ppl    45.45 | valid bpc    5.506
-----------------------------------------------------------------------------------------
PROGRESS: 90.0%
| epoch  91 |   100/  269 batches | lr 0.00000 | ms/batch 244.00 | loss  3.26 | ppl    26.05 
| epoch  91 |   200/  269 batches | lr 0.00000 | ms/batch 240.19 | loss  3.22 | ppl    25.07 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 65.60s | valid loss  3.78 | valid ppl    44.00 | valid bpc    5.460
-----------------------------------------------------------------------------------------
PROGRESS: 91.0%
| epoch  92 |   100/  269 batches | lr 0.00000 | ms/batch 244.93 | loss  3.26 | ppl    25.97 
| epoch  92 |   200/  269 batches | lr 0.00000 | ms/batch 240.92 | loss  3.22 | ppl    24.95 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 65.66s | valid loss  3.80 | valid ppl    44.78 | valid bpc    5.485
-----------------------------------------------------------------------------------------
PROGRESS: 92.0%
| epoch  93 |   100/  269 batches | lr 0.00000 | ms/batch 243.14 | loss  3.23 | ppl    25.31 
| epoch  93 |   200/  269 batches | lr 0.00000 | ms/batch 242.94 | loss  3.22 | ppl    24.95 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 65.69s | valid loss  3.78 | valid ppl    43.89 | valid bpc    5.456
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  269 batches | lr 0.00000 | ms/batch 244.45 | loss  3.26 | ppl    26.00 
| epoch  94 |   200/  269 batches | lr 0.00000 | ms/batch 240.27 | loss  3.22 | ppl    25.14 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 65.67s | valid loss  3.79 | valid ppl    44.19 | valid bpc    5.466
-----------------------------------------------------------------------------------------
PROGRESS: 94.0%
| epoch  95 |   100/  269 batches | lr 0.00000 | ms/batch 244.41 | loss  3.25 | ppl    25.75 
| epoch  95 |   200/  269 batches | lr 0.00000 | ms/batch 240.06 | loss  3.23 | ppl    25.28 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 65.63s | valid loss  3.79 | valid ppl    44.46 | valid bpc    5.474
-----------------------------------------------------------------------------------------
PROGRESS: 95.0%
| epoch  96 |   100/  269 batches | lr 0.00000 | ms/batch 245.26 | loss  3.25 | ppl    25.67 
| epoch  96 |   200/  269 batches | lr 0.00000 | ms/batch 239.65 | loss  3.20 | ppl    24.55 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 65.74s | valid loss  3.79 | valid ppl    44.27 | valid bpc    5.468
-----------------------------------------------------------------------------------------
PROGRESS: 96.0%
| epoch  97 |   100/  269 batches | lr 0.00000 | ms/batch 244.68 | loss  3.26 | ppl    25.98 
| epoch  97 |   200/  269 batches | lr 0.00000 | ms/batch 240.22 | loss  3.23 | ppl    25.34 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 65.61s | valid loss  3.80 | valid ppl    44.89 | valid bpc    5.488
-----------------------------------------------------------------------------------------
PROGRESS: 97.0%
| epoch  98 |   100/  269 batches | lr 0.00000 | ms/batch 246.49 | loss  3.25 | ppl    25.75 
| epoch  98 |   200/  269 batches | lr 0.00000 | ms/batch 240.11 | loss  3.21 | ppl    24.82 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 65.79s | valid loss  3.81 | valid ppl    45.24 | valid bpc    5.500
-----------------------------------------------------------------------------------------
PROGRESS: 98.0%
| epoch  99 |   100/  269 batches | lr 0.00000 | ms/batch 244.84 | loss  3.25 | ppl    25.74 
| epoch  99 |   200/  269 batches | lr 0.00000 | ms/batch 240.55 | loss  3.22 | ppl    24.93 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 65.71s | valid loss  3.82 | valid ppl    45.38 | valid bpc    5.504
-----------------------------------------------------------------------------------------
PROGRESS: 99.0%
| epoch 100 |   100/  269 batches | lr 0.00000 | ms/batch 243.86 | loss  3.25 | ppl    25.74 
| epoch 100 |   200/  269 batches | lr 0.00000 | ms/batch 239.01 | loss  3.24 | ppl    25.47 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 65.69s | valid loss  3.79 | valid ppl    44.12 | valid bpc    5.463
-----------------------------------------------------------------------------------------
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  3.83 | test ppl    45.86 | test bpc    5.519
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.4658, Mean Reca: 0.6538, Mean F1: 0.5399, Mean Subword_Reca: 0.8194
-----------------------------------------------------------------------------------------
=========================================================================================
