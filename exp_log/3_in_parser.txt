Loading dataset...
Loading dictionary...
Number of tokens:  10001
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer_in_parser', nhid=512, nlayers=8, front_layers=1, rear_layers=7, n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=1111, nonmono=5, cuda=True, log_interval=100, save='trained_models/structformer_in_parser_1111_17.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 38475653
Model architecture: StructFormer_In_Parser(
  (transformer_front): Transformer_Front(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(10001, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0): TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
  (transformer_rear): Transformer_Rear(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(10001, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-6): 7 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (output_layer): Linear(in_features=512, out_features=10001, bias=True)
  )
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  216 batches | lr 0.00030 | ms/batch 79.06 | loss  7.27 | ppl  1440.19 
| epoch   1 |   200/  216 batches | lr 0.00030 | ms/batch 74.70 | loss  6.76 | ppl   861.04 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 17.05s | valid loss  6.50 | valid ppl   662.01 | valid bpc    9.371
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  216 batches | lr 0.00030 | ms/batch 75.77 | loss  6.54 | ppl   689.80 
| epoch   2 |   200/  216 batches | lr 0.00030 | ms/batch 75.29 | loss  6.20 | ppl   491.03 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 16.80s | valid loss  5.98 | valid ppl   395.90 | valid bpc    8.629
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  216 batches | lr 0.00030 | ms/batch 76.76 | loss  5.96 | ppl   388.23 
| epoch   3 |   200/  216 batches | lr 0.00030 | ms/batch 75.09 | loss  5.72 | ppl   304.35 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 16.89s | valid loss  5.55 | valid ppl   256.27 | valid bpc    8.002
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  216 batches | lr 0.00030 | ms/batch 77.03 | loss  5.56 | ppl   260.19 
| epoch   4 |   200/  216 batches | lr 0.00030 | ms/batch 75.55 | loss  5.41 | ppl   223.17 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 16.95s | valid loss  5.34 | valid ppl   208.73 | valid bpc    7.705
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  216 batches | lr 0.00030 | ms/batch 77.53 | loss  5.31 | ppl   202.32 
| epoch   5 |   200/  216 batches | lr 0.00030 | ms/batch 75.98 | loss  5.18 | ppl   177.05 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 17.02s | valid loss  5.14 | valid ppl   170.17 | valid bpc    7.411
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  216 batches | lr 0.00030 | ms/batch 77.12 | loss  5.11 | ppl   165.35 
| epoch   6 |   200/  216 batches | lr 0.00030 | ms/batch 76.26 | loss  5.02 | ppl   152.10 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 17.04s | valid loss  5.04 | valid ppl   154.51 | valid bpc    7.272
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  216 batches | lr 0.00030 | ms/batch 77.18 | loss  4.97 | ppl   144.44 
| epoch   7 |   200/  216 batches | lr 0.00030 | ms/batch 76.64 | loss  4.89 | ppl   132.49 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 17.08s | valid loss  4.92 | valid ppl   137.41 | valid bpc    7.102
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  216 batches | lr 0.00030 | ms/batch 77.33 | loss  4.80 | ppl   121.95 
| epoch   8 |   200/  216 batches | lr 0.00030 | ms/batch 76.55 | loss  4.74 | ppl   114.69 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 17.10s | valid loss  4.84 | valid ppl   126.01 | valid bpc    6.977
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 8.0%
| epoch   9 |   100/  216 batches | lr 0.00030 | ms/batch 77.64 | loss  4.69 | ppl   109.26 
| epoch   9 |   200/  216 batches | lr 0.00030 | ms/batch 76.42 | loss  4.66 | ppl   105.16 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 17.14s | valid loss  4.73 | valid ppl   112.80 | valid bpc    6.818
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  216 batches | lr 0.00030 | ms/batch 77.53 | loss  4.58 | ppl    97.53 
| epoch  10 |   200/  216 batches | lr 0.00030 | ms/batch 77.05 | loss  4.53 | ppl    93.19 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 17.16s | valid loss  4.71 | valid ppl   110.75 | valid bpc    6.791
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  216 batches | lr 0.00030 | ms/batch 77.73 | loss  4.47 | ppl    87.36 
| epoch  11 |   200/  216 batches | lr 0.00030 | ms/batch 76.92 | loss  4.45 | ppl    85.65 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 17.18s | valid loss  4.61 | valid ppl   100.15 | valid bpc    6.646
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  216 batches | lr 0.00030 | ms/batch 78.15 | loss  4.40 | ppl    81.56 
| epoch  12 |   200/  216 batches | lr 0.00030 | ms/batch 76.16 | loss  4.35 | ppl    77.51 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 17.16s | valid loss  4.57 | valid ppl    96.61 | valid bpc    6.594
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 12.0%
| epoch  13 |   100/  216 batches | lr 0.00030 | ms/batch 77.56 | loss  4.32 | ppl    75.12 
| epoch  13 |   200/  216 batches | lr 0.00030 | ms/batch 77.28 | loss  4.25 | ppl    70.00 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 17.20s | valid loss  4.51 | valid ppl    90.83 | valid bpc    6.505
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 13.0%
| epoch  14 |   100/  216 batches | lr 0.00030 | ms/batch 77.87 | loss  4.22 | ppl    68.29 
| epoch  14 |   200/  216 batches | lr 0.00030 | ms/batch 76.91 | loss  4.19 | ppl    66.32 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 17.19s | valid loss  4.52 | valid ppl    91.92 | valid bpc    6.522
-----------------------------------------------------------------------------------------
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  216 batches | lr 0.00030 | ms/batch 77.60 | loss  4.15 | ppl    63.37 
| epoch  15 |   200/  216 batches | lr 0.00030 | ms/batch 76.94 | loss  4.14 | ppl    62.52 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 17.16s | valid loss  4.48 | valid ppl    88.52 | valid bpc    6.468
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 15.0%
| epoch  16 |   100/  216 batches | lr 0.00030 | ms/batch 77.66 | loss  4.10 | ppl    60.42 
| epoch  16 |   200/  216 batches | lr 0.00030 | ms/batch 77.22 | loss  4.07 | ppl    58.73 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 17.20s | valid loss  4.43 | valid ppl    84.17 | valid bpc    6.395
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 16.0%
| epoch  17 |   100/  216 batches | lr 0.00030 | ms/batch 77.95 | loss  4.01 | ppl    55.00 
| epoch  17 |   200/  216 batches | lr 0.00030 | ms/batch 77.13 | loss  4.00 | ppl    54.46 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 17.21s | valid loss  4.44 | valid ppl    84.76 | valid bpc    6.405
-----------------------------------------------------------------------------------------
PROGRESS: 17.0%
| epoch  18 |   100/  216 batches | lr 0.00030 | ms/batch 77.70 | loss  3.97 | ppl    52.96 
| epoch  18 |   200/  216 batches | lr 0.00030 | ms/batch 76.59 | loss  3.93 | ppl    51.10 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 17.17s | valid loss  4.36 | valid ppl    78.39 | valid bpc    6.293
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 18.0%
| epoch  19 |   100/  216 batches | lr 0.00030 | ms/batch 77.92 | loss  3.87 | ppl    47.87 
| epoch  19 |   200/  216 batches | lr 0.00030 | ms/batch 77.17 | loss  3.91 | ppl    50.12 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 17.22s | valid loss  4.37 | valid ppl    78.91 | valid bpc    6.302
-----------------------------------------------------------------------------------------
PROGRESS: 19.0%
| epoch  20 |   100/  216 batches | lr 0.00030 | ms/batch 78.21 | loss  3.84 | ppl    46.69 
| epoch  20 |   200/  216 batches | lr 0.00030 | ms/batch 76.95 | loss  3.84 | ppl    46.51 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 17.22s | valid loss  4.38 | valid ppl    79.52 | valid bpc    6.313
-----------------------------------------------------------------------------------------
PROGRESS: 20.0%
| epoch  21 |   100/  216 batches | lr 0.00030 | ms/batch 78.02 | loss  3.82 | ppl    45.73 
| epoch  21 |   200/  216 batches | lr 0.00030 | ms/batch 76.65 | loss  3.77 | ppl    43.33 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 17.18s | valid loss  4.30 | valid ppl    73.72 | valid bpc    6.204
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 21.0%
| epoch  22 |   100/  216 batches | lr 0.00030 | ms/batch 78.40 | loss  3.75 | ppl    42.66 
| epoch  22 |   200/  216 batches | lr 0.00030 | ms/batch 76.66 | loss  3.73 | ppl    41.59 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 17.22s | valid loss  4.31 | valid ppl    74.49 | valid bpc    6.219
-----------------------------------------------------------------------------------------
PROGRESS: 22.0%
| epoch  23 |   100/  216 batches | lr 0.00030 | ms/batch 78.53 | loss  3.70 | ppl    40.52 
| epoch  23 |   200/  216 batches | lr 0.00030 | ms/batch 76.87 | loss  3.68 | ppl    39.62 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 17.25s | valid loss  4.35 | valid ppl    77.73 | valid bpc    6.280
-----------------------------------------------------------------------------------------
PROGRESS: 23.0%
| epoch  24 |   100/  216 batches | lr 0.00030 | ms/batch 80.37 | loss  3.67 | ppl    39.16 
| epoch  24 |   200/  216 batches | lr 0.00030 | ms/batch 85.11 | loss  3.64 | ppl    38.16 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 18.46s | valid loss  4.33 | valid ppl    75.91 | valid bpc    6.246
-----------------------------------------------------------------------------------------
PROGRESS: 24.0%
| epoch  25 |   100/  216 batches | lr 0.00015 | ms/batch 78.54 | loss  3.55 | ppl    34.80 
| epoch  25 |   200/  216 batches | lr 0.00015 | ms/batch 78.37 | loss  3.51 | ppl    33.54 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 17.52s | valid loss  4.26 | valid ppl    70.83 | valid bpc    6.146
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 25.0%
| epoch  26 |   100/  216 batches | lr 0.00015 | ms/batch 78.27 | loss  3.49 | ppl    32.92 
| epoch  26 |   200/  216 batches | lr 0.00015 | ms/batch 76.64 | loss  3.46 | ppl    31.75 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 17.22s | valid loss  4.27 | valid ppl    71.22 | valid bpc    6.154
-----------------------------------------------------------------------------------------
PROGRESS: 26.0%
| epoch  27 |   100/  216 batches | lr 0.00015 | ms/batch 77.99 | loss  3.44 | ppl    31.13 
| epoch  27 |   200/  216 batches | lr 0.00015 | ms/batch 76.79 | loss  3.40 | ppl    30.09 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 17.20s | valid loss  4.22 | valid ppl    68.04 | valid bpc    6.088
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 27.0%
| epoch  28 |   100/  216 batches | lr 0.00015 | ms/batch 77.99 | loss  3.39 | ppl    29.65 
| epoch  28 |   200/  216 batches | lr 0.00015 | ms/batch 77.18 | loss  3.37 | ppl    29.21 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 17.24s | valid loss  4.23 | valid ppl    68.58 | valid bpc    6.100
-----------------------------------------------------------------------------------------
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  216 batches | lr 0.00015 | ms/batch 77.83 | loss  3.36 | ppl    28.83 
| epoch  29 |   200/  216 batches | lr 0.00015 | ms/batch 77.19 | loss  3.36 | ppl    28.74 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 17.20s | valid loss  4.29 | valid ppl    72.78 | valid bpc    6.185
-----------------------------------------------------------------------------------------
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  216 batches | lr 0.00015 | ms/batch 77.68 | loss  3.35 | ppl    28.52 
| epoch  30 |   200/  216 batches | lr 0.00015 | ms/batch 77.25 | loss  3.31 | ppl    27.51 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 17.20s | valid loss  4.22 | valid ppl    68.03 | valid bpc    6.088
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 30.0%
| epoch  31 |   100/  216 batches | lr 0.00015 | ms/batch 78.52 | loss  3.32 | ppl    27.67 
| epoch  31 |   200/  216 batches | lr 0.00015 | ms/batch 76.90 | loss  3.29 | ppl    26.83 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 17.26s | valid loss  4.26 | valid ppl    70.81 | valid bpc    6.146
-----------------------------------------------------------------------------------------
PROGRESS: 31.0%
| epoch  32 |   100/  216 batches | lr 0.00015 | ms/batch 77.99 | loss  3.28 | ppl    26.65 
| epoch  32 |   200/  216 batches | lr 0.00015 | ms/batch 76.92 | loss  3.29 | ppl    26.86 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 17.20s | valid loss  4.25 | valid ppl    70.26 | valid bpc    6.135
-----------------------------------------------------------------------------------------
PROGRESS: 32.0%
| epoch  33 |   100/  216 batches | lr 0.00015 | ms/batch 78.21 | loss  3.25 | ppl    25.81 
| epoch  33 |   200/  216 batches | lr 0.00015 | ms/batch 76.64 | loss  3.26 | ppl    26.04 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 17.21s | valid loss  4.23 | valid ppl    68.82 | valid bpc    6.105
-----------------------------------------------------------------------------------------
PROGRESS: 33.0%
| epoch  34 |   100/  216 batches | lr 0.00007 | ms/batch 78.00 | loss  3.23 | ppl    25.35 
| epoch  34 |   200/  216 batches | lr 0.00007 | ms/batch 76.76 | loss  3.16 | ppl    23.67 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 17.20s | valid loss  4.22 | valid ppl    68.31 | valid bpc    6.094
-----------------------------------------------------------------------------------------
PROGRESS: 34.0%
| epoch  35 |   100/  216 batches | lr 0.00007 | ms/batch 78.12 | loss  3.17 | ppl    23.73 
| epoch  35 |   200/  216 batches | lr 0.00007 | ms/batch 76.80 | loss  3.17 | ppl    23.81 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 17.20s | valid loss  4.19 | valid ppl    65.92 | valid bpc    6.043
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 35.0%
| epoch  36 |   100/  216 batches | lr 0.00007 | ms/batch 77.62 | loss  3.17 | ppl    23.84 
| epoch  36 |   200/  216 batches | lr 0.00007 | ms/batch 77.67 | loss  3.10 | ppl    22.24 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 17.24s | valid loss  4.24 | valid ppl    69.19 | valid bpc    6.112
-----------------------------------------------------------------------------------------
PROGRESS: 36.0%
| epoch  37 |   100/  216 batches | lr 0.00007 | ms/batch 77.99 | loss  3.12 | ppl    22.61 
| epoch  37 |   200/  216 batches | lr 0.00007 | ms/batch 76.96 | loss  3.14 | ppl    23.15 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 17.20s | valid loss  4.21 | valid ppl    67.35 | valid bpc    6.074
-----------------------------------------------------------------------------------------
PROGRESS: 37.0%
| epoch  38 |   100/  216 batches | lr 0.00007 | ms/batch 78.79 | loss  3.11 | ppl    22.36 
| epoch  38 |   200/  216 batches | lr 0.00007 | ms/batch 76.64 | loss  3.11 | ppl    22.38 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 17.26s | valid loss  4.21 | valid ppl    67.35 | valid bpc    6.074
-----------------------------------------------------------------------------------------
PROGRESS: 38.0%
| epoch  39 |   100/  216 batches | lr 0.00004 | ms/batch 78.07 | loss  3.11 | ppl    22.34 
| epoch  39 |   200/  216 batches | lr 0.00004 | ms/batch 76.85 | loss  3.06 | ppl    21.38 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 17.20s | valid loss  4.22 | valid ppl    68.25 | valid bpc    6.093
-----------------------------------------------------------------------------------------
PROGRESS: 39.0%
| epoch  40 |   100/  216 batches | lr 0.00004 | ms/batch 78.40 | loss  3.07 | ppl    21.52 
| epoch  40 |   200/  216 batches | lr 0.00004 | ms/batch 76.38 | loss  3.05 | ppl    21.19 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 17.20s | valid loss  4.23 | valid ppl    68.54 | valid bpc    6.099
-----------------------------------------------------------------------------------------
PROGRESS: 40.0%
| epoch  41 |   100/  216 batches | lr 0.00004 | ms/batch 77.82 | loss  3.03 | ppl    20.60 
| epoch  41 |   200/  216 batches | lr 0.00004 | ms/batch 77.13 | loss  3.05 | ppl    21.17 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 17.20s | valid loss  4.21 | valid ppl    67.44 | valid bpc    6.075
-----------------------------------------------------------------------------------------
PROGRESS: 41.0%
| epoch  42 |   100/  216 batches | lr 0.00002 | ms/batch 77.98 | loss  3.04 | ppl    21.01 
| epoch  42 |   200/  216 batches | lr 0.00002 | ms/batch 76.71 | loss  3.02 | ppl    20.45 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 17.20s | valid loss  4.20 | valid ppl    66.87 | valid bpc    6.063
-----------------------------------------------------------------------------------------
PROGRESS: 42.0%
| epoch  43 |   100/  216 batches | lr 0.00002 | ms/batch 78.24 | loss  3.03 | ppl    20.79 
| epoch  43 |   200/  216 batches | lr 0.00002 | ms/batch 76.68 | loss  3.00 | ppl    20.12 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 17.20s | valid loss  4.21 | valid ppl    67.46 | valid bpc    6.076
-----------------------------------------------------------------------------------------
PROGRESS: 43.0%
| epoch  44 |   100/  216 batches | lr 0.00002 | ms/batch 77.98 | loss  3.04 | ppl    20.80 
| epoch  44 |   200/  216 batches | lr 0.00002 | ms/batch 77.10 | loss  2.99 | ppl    19.97 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 17.21s | valid loss  4.21 | valid ppl    67.37 | valid bpc    6.074
-----------------------------------------------------------------------------------------
PROGRESS: 44.0%
| epoch  45 |   100/  216 batches | lr 0.00001 | ms/batch 78.39 | loss  3.03 | ppl    20.76 
| epoch  45 |   200/  216 batches | lr 0.00001 | ms/batch 76.57 | loss  2.99 | ppl    19.83 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 17.20s | valid loss  4.20 | valid ppl    66.86 | valid bpc    6.063
-----------------------------------------------------------------------------------------
PROGRESS: 45.0%
| epoch  46 |   100/  216 batches | lr 0.00001 | ms/batch 77.75 | loss  3.02 | ppl    20.56 
| epoch  46 |   200/  216 batches | lr 0.00001 | ms/batch 77.00 | loss  2.99 | ppl    19.85 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 17.20s | valid loss  4.22 | valid ppl    67.80 | valid bpc    6.083
-----------------------------------------------------------------------------------------
PROGRESS: 46.0%
| epoch  47 |   100/  216 batches | lr 0.00001 | ms/batch 78.35 | loss  3.02 | ppl    20.43 
| epoch  47 |   200/  216 batches | lr 0.00001 | ms/batch 76.62 | loss  2.98 | ppl    19.74 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 17.21s | valid loss  4.28 | valid ppl    71.97 | valid bpc    6.169
-----------------------------------------------------------------------------------------
PROGRESS: 47.0%
| epoch  48 |   100/  216 batches | lr 0.00000 | ms/batch 78.02 | loss  3.02 | ppl    20.54 
| epoch  48 |   200/  216 batches | lr 0.00000 | ms/batch 76.87 | loss  2.97 | ppl    19.52 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 17.20s | valid loss  4.21 | valid ppl    67.03 | valid bpc    6.067
-----------------------------------------------------------------------------------------
PROGRESS: 48.0%
| epoch  49 |   100/  216 batches | lr 0.00000 | ms/batch 78.57 | loss  3.03 | ppl    20.65 
| epoch  49 |   200/  216 batches | lr 0.00000 | ms/batch 76.37 | loss  2.97 | ppl    19.55 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 17.21s | valid loss  4.25 | valid ppl    70.18 | valid bpc    6.133
-----------------------------------------------------------------------------------------
PROGRESS: 49.0%
| epoch  50 |   100/  216 batches | lr 0.00000 | ms/batch 78.28 | loss  3.03 | ppl    20.68 
| epoch  50 |   200/  216 batches | lr 0.00000 | ms/batch 76.73 | loss  2.98 | ppl    19.66 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 17.21s | valid loss  4.22 | valid ppl    67.87 | valid bpc    6.085
-----------------------------------------------------------------------------------------
PROGRESS: 50.0%
| epoch  51 |   100/  216 batches | lr 0.00000 | ms/batch 77.72 | loss  3.00 | ppl    20.06 
| epoch  51 |   200/  216 batches | lr 0.00000 | ms/batch 77.32 | loss  2.98 | ppl    19.67 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 17.21s | valid loss  4.18 | valid ppl    65.66 | valid bpc    6.037
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 51.0%
| epoch  52 |   100/  216 batches | lr 0.00000 | ms/batch 78.12 | loss  3.00 | ppl    20.18 
| epoch  52 |   200/  216 batches | lr 0.00000 | ms/batch 77.13 | loss  2.99 | ppl    19.96 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 17.23s | valid loss  4.22 | valid ppl    67.91 | valid bpc    6.086
-----------------------------------------------------------------------------------------
PROGRESS: 52.0%
| epoch  53 |   100/  216 batches | lr 0.00000 | ms/batch 78.43 | loss  3.01 | ppl    20.36 
| epoch  53 |   200/  216 batches | lr 0.00000 | ms/batch 76.47 | loss  2.96 | ppl    19.27 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 17.19s | valid loss  4.20 | valid ppl    67.00 | valid bpc    6.066
-----------------------------------------------------------------------------------------
PROGRESS: 53.0%
| epoch  54 |   100/  216 batches | lr 0.00000 | ms/batch 78.23 | loss  2.98 | ppl    19.78 
| epoch  54 |   200/  216 batches | lr 0.00000 | ms/batch 76.63 | loss  2.98 | ppl    19.62 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 17.20s | valid loss  4.26 | valid ppl    70.79 | valid bpc    6.145
-----------------------------------------------------------------------------------------
PROGRESS: 54.0%
| epoch  55 |   100/  216 batches | lr 0.00000 | ms/batch 78.11 | loss  3.00 | ppl    20.13 
| epoch  55 |   200/  216 batches | lr 0.00000 | ms/batch 76.85 | loss  3.00 | ppl    20.17 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 17.21s | valid loss  4.21 | valid ppl    67.24 | valid bpc    6.071
-----------------------------------------------------------------------------------------
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  216 batches | lr 0.00000 | ms/batch 78.02 | loss  2.98 | ppl    19.78 
| epoch  56 |   200/  216 batches | lr 0.00000 | ms/batch 76.93 | loss  2.98 | ppl    19.64 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 17.22s | valid loss  4.22 | valid ppl    68.06 | valid bpc    6.089
-----------------------------------------------------------------------------------------
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  216 batches | lr 0.00000 | ms/batch 77.87 | loss  3.00 | ppl    20.16 
| epoch  57 |   200/  216 batches | lr 0.00000 | ms/batch 77.04 | loss  2.97 | ppl    19.56 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 17.21s | valid loss  4.18 | valid ppl    65.54 | valid bpc    6.034
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  216 batches | lr 0.00000 | ms/batch 78.37 | loss  3.00 | ppl    20.14 
| epoch  58 |   200/  216 batches | lr 0.00000 | ms/batch 76.80 | loss  2.98 | ppl    19.59 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 17.26s | valid loss  4.19 | valid ppl    66.23 | valid bpc    6.049
-----------------------------------------------------------------------------------------
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  216 batches | lr 0.00000 | ms/batch 78.02 | loss  3.00 | ppl    20.08 
| epoch  59 |   200/  216 batches | lr 0.00000 | ms/batch 76.87 | loss  3.00 | ppl    20.02 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 17.20s | valid loss  4.19 | valid ppl    66.17 | valid bpc    6.048
-----------------------------------------------------------------------------------------
PROGRESS: 59.0%
| epoch  60 |   100/  216 batches | lr 0.00000 | ms/batch 77.94 | loss  2.99 | ppl    19.96 
| epoch  60 |   200/  216 batches | lr 0.00000 | ms/batch 77.03 | loss  2.96 | ppl    19.34 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 17.20s | valid loss  4.21 | valid ppl    67.44 | valid bpc    6.075
-----------------------------------------------------------------------------------------
PROGRESS: 60.0%
| epoch  61 |   100/  216 batches | lr 0.00000 | ms/batch 78.51 | loss  2.99 | ppl    19.89 
| epoch  61 |   200/  216 batches | lr 0.00000 | ms/batch 76.72 | loss  2.97 | ppl    19.52 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 17.25s | valid loss  4.22 | valid ppl    68.37 | valid bpc    6.095
-----------------------------------------------------------------------------------------
PROGRESS: 61.0%
| epoch  62 |   100/  216 batches | lr 0.00000 | ms/batch 78.08 | loss  3.01 | ppl    20.21 
| epoch  62 |   200/  216 batches | lr 0.00000 | ms/batch 76.90 | loss  2.97 | ppl    19.47 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 17.20s | valid loss  4.19 | valid ppl    65.84 | valid bpc    6.041
-----------------------------------------------------------------------------------------
PROGRESS: 62.0%
| epoch  63 |   100/  216 batches | lr 0.00000 | ms/batch 78.03 | loss  3.03 | ppl    20.67 
| epoch  63 |   200/  216 batches | lr 0.00000 | ms/batch 76.97 | loss  2.96 | ppl    19.29 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 17.20s | valid loss  4.21 | valid ppl    67.05 | valid bpc    6.067
-----------------------------------------------------------------------------------------
PROGRESS: 63.0%
| epoch  64 |   100/  216 batches | lr 0.00000 | ms/batch 78.26 | loss  3.00 | ppl    20.06 
| epoch  64 |   200/  216 batches | lr 0.00000 | ms/batch 76.71 | loss  2.96 | ppl    19.39 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 17.21s | valid loss  4.23 | valid ppl    68.55 | valid bpc    6.099
-----------------------------------------------------------------------------------------
PROGRESS: 64.0%
| epoch  65 |   100/  216 batches | lr 0.00000 | ms/batch 78.15 | loss  2.99 | ppl    19.82 
| epoch  65 |   200/  216 batches | lr 0.00000 | ms/batch 76.80 | loss  2.95 | ppl    19.19 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 17.21s | valid loss  4.23 | valid ppl    68.41 | valid bpc    6.096
-----------------------------------------------------------------------------------------
PROGRESS: 65.0%
| epoch  66 |   100/  216 batches | lr 0.00000 | ms/batch 78.47 | loss  3.02 | ppl    20.58 
| epoch  66 |   200/  216 batches | lr 0.00000 | ms/batch 76.40 | loss  2.98 | ppl    19.63 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 17.20s | valid loss  4.18 | valid ppl    65.45 | valid bpc    6.032
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 66.0%
| epoch  67 |   100/  216 batches | lr 0.00000 | ms/batch 78.10 | loss  3.00 | ppl    20.06 
| epoch  67 |   200/  216 batches | lr 0.00000 | ms/batch 77.17 | loss  2.99 | ppl    19.90 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 17.24s | valid loss  4.17 | valid ppl    64.84 | valid bpc    6.019
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 67.0%
| epoch  68 |   100/  216 batches | lr 0.00000 | ms/batch 78.40 | loss  3.01 | ppl    20.27 
| epoch  68 |   200/  216 batches | lr 0.00000 | ms/batch 76.47 | loss  2.95 | ppl    19.13 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 17.20s | valid loss  4.19 | valid ppl    66.28 | valid bpc    6.050
-----------------------------------------------------------------------------------------
PROGRESS: 68.0%
| epoch  69 |   100/  216 batches | lr 0.00000 | ms/batch 77.97 | loss  3.01 | ppl    20.25 
| epoch  69 |   200/  216 batches | lr 0.00000 | ms/batch 76.89 | loss  2.96 | ppl    19.38 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 17.20s | valid loss  4.17 | valid ppl    64.69 | valid bpc    6.016
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 69.0%
| epoch  70 |   100/  216 batches | lr 0.00000 | ms/batch 78.03 | loss  3.01 | ppl    20.22 
| epoch  70 |   200/  216 batches | lr 0.00000 | ms/batch 77.12 | loss  2.97 | ppl    19.44 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 17.24s | valid loss  4.24 | valid ppl    69.57 | valid bpc    6.120
-----------------------------------------------------------------------------------------
PROGRESS: 70.0%
| epoch  71 |   100/  216 batches | lr 0.00000 | ms/batch 78.13 | loss  3.01 | ppl    20.34 
| epoch  71 |   200/  216 batches | lr 0.00000 | ms/batch 76.82 | loss  2.97 | ppl    19.40 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 17.20s | valid loss  4.19 | valid ppl    66.26 | valid bpc    6.050
-----------------------------------------------------------------------------------------
PROGRESS: 71.0%
| epoch  72 |   100/  216 batches | lr 0.00000 | ms/batch 78.07 | loss  3.02 | ppl    20.50 
| epoch  72 |   200/  216 batches | lr 0.00000 | ms/batch 76.71 | loss  2.97 | ppl    19.50 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 17.20s | valid loss  4.17 | valid ppl    64.71 | valid bpc    6.016
-----------------------------------------------------------------------------------------
PROGRESS: 72.0%
| epoch  73 |   100/  216 batches | lr 0.00000 | ms/batch 78.12 | loss  3.00 | ppl    20.05 
| epoch  73 |   200/  216 batches | lr 0.00000 | ms/batch 76.84 | loss  2.98 | ppl    19.73 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 17.21s | valid loss  4.18 | valid ppl    65.51 | valid bpc    6.034
-----------------------------------------------------------------------------------------
PROGRESS: 73.0%
| epoch  74 |   100/  216 batches | lr 0.00000 | ms/batch 77.83 | loss  3.01 | ppl    20.25 
| epoch  74 |   200/  216 batches | lr 0.00000 | ms/batch 77.18 | loss  2.98 | ppl    19.78 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 17.20s | valid loss  4.21 | valid ppl    67.12 | valid bpc    6.069
-----------------------------------------------------------------------------------------
PROGRESS: 74.0%
| epoch  75 |   100/  216 batches | lr 0.00000 | ms/batch 78.09 | loss  3.01 | ppl    20.33 
| epoch  75 |   200/  216 batches | lr 0.00000 | ms/batch 76.91 | loss  2.99 | ppl    19.82 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 17.21s | valid loss  4.21 | valid ppl    67.47 | valid bpc    6.076
-----------------------------------------------------------------------------------------
PROGRESS: 75.0%
| epoch  76 |   100/  216 batches | lr 0.00000 | ms/batch 78.24 | loss  2.99 | ppl    19.91 
| epoch  76 |   200/  216 batches | lr 0.00000 | ms/batch 76.76 | loss  2.98 | ppl    19.72 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 17.21s | valid loss  4.23 | valid ppl    68.74 | valid bpc    6.103
-----------------------------------------------------------------------------------------
PROGRESS: 76.0%
| epoch  77 |   100/  216 batches | lr 0.00000 | ms/batch 78.41 | loss  3.01 | ppl    20.23 
| epoch  77 |   200/  216 batches | lr 0.00000 | ms/batch 76.53 | loss  2.95 | ppl    19.11 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 17.20s | valid loss  4.21 | valid ppl    67.27 | valid bpc    6.072
-----------------------------------------------------------------------------------------
PROGRESS: 77.0%
| epoch  78 |   100/  216 batches | lr 0.00000 | ms/batch 77.64 | loss  2.99 | ppl    19.84 
| epoch  78 |   200/  216 batches | lr 0.00000 | ms/batch 77.18 | loss  2.97 | ppl    19.43 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 17.21s | valid loss  4.23 | valid ppl    68.53 | valid bpc    6.099
-----------------------------------------------------------------------------------------
PROGRESS: 78.0%
| epoch  79 |   100/  216 batches | lr 0.00000 | ms/batch 78.48 | loss  2.99 | ppl    19.81 
| epoch  79 |   200/  216 batches | lr 0.00000 | ms/batch 76.60 | loss  2.96 | ppl    19.39 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 17.23s | valid loss  4.26 | valid ppl    70.60 | valid bpc    6.142
-----------------------------------------------------------------------------------------
PROGRESS: 79.0%
| epoch  80 |   100/  216 batches | lr 0.00000 | ms/batch 77.72 | loss  3.00 | ppl    20.00 
| epoch  80 |   200/  216 batches | lr 0.00000 | ms/batch 77.40 | loss  2.97 | ppl    19.47 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 17.22s | valid loss  4.24 | valid ppl    69.12 | valid bpc    6.111
-----------------------------------------------------------------------------------------
PROGRESS: 80.0%
| epoch  81 |   100/  216 batches | lr 0.00000 | ms/batch 78.25 | loss  3.01 | ppl    20.28 
| epoch  81 |   200/  216 batches | lr 0.00000 | ms/batch 76.95 | loss  2.97 | ppl    19.53 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 17.23s | valid loss  4.20 | valid ppl    66.52 | valid bpc    6.056
-----------------------------------------------------------------------------------------
PROGRESS: 81.0%
| epoch  82 |   100/  216 batches | lr 0.00000 | ms/batch 78.05 | loss  3.01 | ppl    20.32 
| epoch  82 |   200/  216 batches | lr 0.00000 | ms/batch 76.97 | loss  2.96 | ppl    19.27 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 17.22s | valid loss  4.22 | valid ppl    67.85 | valid bpc    6.084
-----------------------------------------------------------------------------------------
PROGRESS: 82.0%
| epoch  83 |   100/  216 batches | lr 0.00000 | ms/batch 78.20 | loss  3.00 | ppl    20.16 
| epoch  83 |   200/  216 batches | lr 0.00000 | ms/batch 76.77 | loss  2.98 | ppl    19.69 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 17.25s | valid loss  4.23 | valid ppl    68.75 | valid bpc    6.103
-----------------------------------------------------------------------------------------
PROGRESS: 83.0%
| epoch  84 |   100/  216 batches | lr 0.00000 | ms/batch 78.47 | loss  3.02 | ppl    20.46 
| epoch  84 |   200/  216 batches | lr 0.00000 | ms/batch 76.47 | loss  2.96 | ppl    19.32 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 17.21s | valid loss  4.22 | valid ppl    67.90 | valid bpc    6.085
-----------------------------------------------------------------------------------------
PROGRESS: 84.0%
| epoch  85 |   100/  216 batches | lr 0.00000 | ms/batch 78.28 | loss  3.02 | ppl    20.55 
| epoch  85 |   200/  216 batches | lr 0.00000 | ms/batch 76.72 | loss  2.95 | ppl    19.13 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 17.21s | valid loss  4.18 | valid ppl    65.26 | valid bpc    6.028
-----------------------------------------------------------------------------------------
PROGRESS: 85.0%
| epoch  86 |   100/  216 batches | lr 0.00000 | ms/batch 77.94 | loss  3.01 | ppl    20.21 
| epoch  86 |   200/  216 batches | lr 0.00000 | ms/batch 77.13 | loss  2.96 | ppl    19.32 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 17.22s | valid loss  4.23 | valid ppl    68.94 | valid bpc    6.107
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  216 batches | lr 0.00000 | ms/batch 78.06 | loss  2.99 | ppl    19.91 
| epoch  87 |   200/  216 batches | lr 0.00000 | ms/batch 77.03 | loss  2.97 | ppl    19.52 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 17.21s | valid loss  4.20 | valid ppl    66.69 | valid bpc    6.059
-----------------------------------------------------------------------------------------
PROGRESS: 87.0%
| epoch  88 |   100/  216 batches | lr 0.00000 | ms/batch 77.84 | loss  2.99 | ppl    19.89 
| epoch  88 |   200/  216 batches | lr 0.00000 | ms/batch 77.11 | loss  2.96 | ppl    19.36 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 17.21s | valid loss  4.24 | valid ppl    69.74 | valid bpc    6.124
-----------------------------------------------------------------------------------------
PROGRESS: 88.0%
| epoch  89 |   100/  216 batches | lr 0.00000 | ms/batch 77.95 | loss  3.00 | ppl    20.10 
| epoch  89 |   200/  216 batches | lr 0.00000 | ms/batch 76.66 | loss  2.97 | ppl    19.43 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 17.21s | valid loss  4.21 | valid ppl    67.25 | valid bpc    6.071
-----------------------------------------------------------------------------------------
PROGRESS: 89.0%
| epoch  90 |   100/  216 batches | lr 0.00000 | ms/batch 78.02 | loss  3.02 | ppl    20.49 
| epoch  90 |   200/  216 batches | lr 0.00000 | ms/batch 76.92 | loss  2.96 | ppl    19.37 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 17.21s | valid loss  4.25 | valid ppl    70.11 | valid bpc    6.131
-----------------------------------------------------------------------------------------
PROGRESS: 90.0%
| epoch  91 |   100/  216 batches | lr 0.00000 | ms/batch 77.65 | loss  3.02 | ppl    20.52 
| epoch  91 |   200/  216 batches | lr 0.00000 | ms/batch 77.38 | loss  2.97 | ppl    19.44 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 17.21s | valid loss  4.17 | valid ppl    64.71 | valid bpc    6.016
-----------------------------------------------------------------------------------------
PROGRESS: 91.0%
| epoch  92 |   100/  216 batches | lr 0.00000 | ms/batch 77.86 | loss  3.00 | ppl    20.18 
| epoch  92 |   200/  216 batches | lr 0.00000 | ms/batch 77.11 | loss  2.97 | ppl    19.42 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 17.22s | valid loss  4.22 | valid ppl    67.70 | valid bpc    6.081
-----------------------------------------------------------------------------------------
PROGRESS: 92.0%
| epoch  93 |   100/  216 batches | lr 0.00000 | ms/batch 77.99 | loss  3.03 | ppl    20.66 
| epoch  93 |   200/  216 batches | lr 0.00000 | ms/batch 77.38 | loss  2.95 | ppl    19.03 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 17.25s | valid loss  4.22 | valid ppl    67.74 | valid bpc    6.082
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  216 batches | lr 0.00000 | ms/batch 78.20 | loss  2.99 | ppl    19.89 
| epoch  94 |   200/  216 batches | lr 0.00000 | ms/batch 76.78 | loss  2.94 | ppl    19.00 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 17.21s | valid loss  4.18 | valid ppl    65.13 | valid bpc    6.025
-----------------------------------------------------------------------------------------
PROGRESS: 94.0%
| epoch  95 |   100/  216 batches | lr 0.00000 | ms/batch 77.91 | loss  2.99 | ppl    19.83 
| epoch  95 |   200/  216 batches | lr 0.00000 | ms/batch 77.09 | loss  2.98 | ppl    19.62 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 17.21s | valid loss  4.19 | valid ppl    66.29 | valid bpc    6.051
-----------------------------------------------------------------------------------------
PROGRESS: 95.0%
| epoch  96 |   100/  216 batches | lr 0.00000 | ms/batch 77.79 | loss  3.00 | ppl    20.12 
| epoch  96 |   200/  216 batches | lr 0.00000 | ms/batch 77.26 | loss  2.99 | ppl    19.86 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 17.21s | valid loss  4.19 | valid ppl    66.14 | valid bpc    6.047
-----------------------------------------------------------------------------------------
PROGRESS: 96.0%
| epoch  97 |   100/  216 batches | lr 0.00000 | ms/batch 77.81 | loss  2.97 | ppl    19.54 
| epoch  97 |   200/  216 batches | lr 0.00000 | ms/batch 77.28 | loss  2.95 | ppl    19.18 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 17.22s | valid loss  4.24 | valid ppl    69.12 | valid bpc    6.111
-----------------------------------------------------------------------------------------
PROGRESS: 97.0%
| epoch  98 |   100/  216 batches | lr 0.00000 | ms/batch 78.07 | loss  2.99 | ppl    19.84 
| epoch  98 |   200/  216 batches | lr 0.00000 | ms/batch 76.77 | loss  2.98 | ppl    19.62 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 17.21s | valid loss  4.20 | valid ppl    66.87 | valid bpc    6.063
-----------------------------------------------------------------------------------------
PROGRESS: 98.0%
| epoch  99 |   100/  216 batches | lr 0.00000 | ms/batch 78.22 | loss  3.02 | ppl    20.43 
| epoch  99 |   200/  216 batches | lr 0.00000 | ms/batch 76.80 | loss  2.96 | ppl    19.28 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 17.20s | valid loss  4.27 | valid ppl    71.33 | valid bpc    6.156
-----------------------------------------------------------------------------------------
PROGRESS: 99.0%
| epoch 100 |   100/  216 batches | lr 0.00000 | ms/batch 78.03 | loss  2.99 | ppl    19.80 
| epoch 100 |   200/  216 batches | lr 0.00000 | ms/batch 77.32 | loss  2.99 | ppl    19.86 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 17.25s | valid loss  4.16 | valid ppl    64.31 | valid bpc    6.007
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  4.15 | test ppl    63.67 | test bpc    5.993
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.4205, Mean Reca: 0.5794, Mean F1: 0.4791
Counter({'NP': 8450, 'PP': 4025, 'VP': 3360, 'S': 3236, 'SBAR': 568, 'ADJP': 291, 'QP': 238, 'ADVP': 177, 'SINV': 151, 'PRN': 46, 'FRAG': 34, 'WHNP': 24, 'SQ': 16, 'UCP': 10, 'WHPP': 9, 'SBARQ': 9, 'NAC': 8, 'CONJP': 6, 'NX': 4, 'X': 4, 'WHADVP': 2})
Counter({'NP': 14432, 'VP': 8130, 'S': 5620, 'PP': 5484, 'SBAR': 1796, 'ADJP': 649, 'QP': 490, 'ADVP': 286, 'SINV': 157, 'PRN': 128, 'NX': 95, 'FRAG': 42, 'WHNP': 37, 'UCP': 32, 'NAC': 30, 'WHPP': 25, 'CONJP': 21, 'SQ': 18, 'SBARQ': 10, 'WHADVP': 9, 'X': 6, 'WHADJP': 4, 'INTJ': 1})
SBAR: 0.3163
NP: 0.5855
VP: 0.4133
PP: 0.7340
ADJP: 0.4484
ADVP: 0.6189
4.909407743688923
-----------------------------------------------------------------------------------------
Dependency parsing performance:
Conll-U Style:
DDA: 0.379
UDA: 0.530
=========================================================================================
Loading dataset...
Loading dictionary...
Number of tokens:  10001
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer_in_parser', nhid=512, nlayers=8, front_layers=1, rear_layers=7, n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=2222, nonmono=5, cuda=True, log_interval=100, save='trained_models/structformer_in_parser_2222_17.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 38475653
Model architecture: StructFormer_In_Parser(
  (transformer_front): Transformer_Front(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(10001, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0): TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
  (transformer_rear): Transformer_Rear(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(10001, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-6): 7 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (output_layer): Linear(in_features=512, out_features=10001, bias=True)
  )
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  216 batches | lr 0.00030 | ms/batch 81.79 | loss  7.26 | ppl  1416.05 
| epoch   1 |   200/  216 batches | lr 0.00030 | ms/batch 76.32 | loss  6.82 | ppl   914.74 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 17.49s | valid loss  6.56 | valid ppl   707.65 | valid bpc    9.467
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  216 batches | lr 0.00030 | ms/batch 77.78 | loss  6.55 | ppl   698.59 
| epoch   2 |   200/  216 batches | lr 0.00030 | ms/batch 76.22 | loss  6.19 | ppl   488.23 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 17.10s | valid loss  5.96 | valid ppl   387.80 | valid bpc    8.599
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  216 batches | lr 0.00030 | ms/batch 77.87 | loss  5.95 | ppl   383.75 
| epoch   3 |   200/  216 batches | lr 0.00030 | ms/batch 76.52 | loss  5.69 | ppl   295.69 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 17.14s | valid loss  5.58 | valid ppl   264.03 | valid bpc    8.045
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  216 batches | lr 0.00030 | ms/batch 77.81 | loss  5.55 | ppl   257.08 
| epoch   4 |   200/  216 batches | lr 0.00030 | ms/batch 76.71 | loss  5.38 | ppl   217.19 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 17.16s | valid loss  5.28 | valid ppl   197.31 | valid bpc    7.624
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  216 batches | lr 0.00030 | ms/batch 78.31 | loss  5.28 | ppl   195.77 
| epoch   5 |   200/  216 batches | lr 0.00030 | ms/batch 76.34 | loss  5.16 | ppl   174.12 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 17.18s | valid loss  5.13 | valid ppl   169.14 | valid bpc    7.402
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  216 batches | lr 0.00030 | ms/batch 78.05 | loss  5.09 | ppl   162.07 
| epoch   6 |   200/  216 batches | lr 0.00030 | ms/batch 76.77 | loss  4.98 | ppl   145.61 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 17.19s | valid loss  5.04 | valid ppl   153.77 | valid bpc    7.265
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  216 batches | lr 0.00030 | ms/batch 77.83 | loss  4.94 | ppl   139.64 
| epoch   7 |   200/  216 batches | lr 0.00030 | ms/batch 77.09 | loss  4.85 | ppl   127.88 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 17.20s | valid loss  4.88 | valid ppl   131.07 | valid bpc    7.034
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  216 batches | lr 0.00030 | ms/batch 78.04 | loss  4.80 | ppl   121.49 
| epoch   8 |   200/  216 batches | lr 0.00030 | ms/batch 76.76 | loss  4.71 | ppl   111.02 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 17.21s | valid loss  4.84 | valid ppl   126.23 | valid bpc    6.980
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 8.0%
| epoch   9 |   100/  216 batches | lr 0.00030 | ms/batch 77.70 | loss  4.67 | ppl   106.26 
| epoch   9 |   200/  216 batches | lr 0.00030 | ms/batch 77.25 | loss  4.60 | ppl    99.75 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 17.21s | valid loss  4.72 | valid ppl   112.41 | valid bpc    6.813
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  216 batches | lr 0.00030 | ms/batch 78.21 | loss  4.56 | ppl    95.90 
| epoch  10 |   200/  216 batches | lr 0.00030 | ms/batch 76.80 | loss  4.52 | ppl    91.84 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 17.21s | valid loss  4.67 | valid ppl   106.72 | valid bpc    6.738
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  216 batches | lr 0.00030 | ms/batch 77.74 | loss  4.46 | ppl    86.78 
| epoch  11 |   200/  216 batches | lr 0.00030 | ms/batch 77.17 | loss  4.44 | ppl    84.90 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 17.21s | valid loss  4.58 | valid ppl    97.94 | valid bpc    6.614
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  216 batches | lr 0.00030 | ms/batch 78.07 | loss  4.37 | ppl    78.93 
| epoch  12 |   200/  216 batches | lr 0.00030 | ms/batch 76.93 | loss  4.34 | ppl    76.86 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 17.21s | valid loss  4.59 | valid ppl    98.45 | valid bpc    6.621
-----------------------------------------------------------------------------------------
PROGRESS: 12.0%
| epoch  13 |   100/  216 batches | lr 0.00030 | ms/batch 78.29 | loss  4.28 | ppl    72.34 
| epoch  13 |   200/  216 batches | lr 0.00030 | ms/batch 76.65 | loss  4.25 | ppl    70.11 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 17.21s | valid loss  4.58 | valid ppl    97.73 | valid bpc    6.611
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 13.0%
| epoch  14 |   100/  216 batches | lr 0.00030 | ms/batch 77.86 | loss  4.21 | ppl    67.55 
| epoch  14 |   200/  216 batches | lr 0.00030 | ms/batch 77.02 | loss  4.19 | ppl    65.92 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 17.21s | valid loss  4.50 | valid ppl    89.86 | valid bpc    6.490
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  216 batches | lr 0.00030 | ms/batch 78.17 | loss  4.16 | ppl    63.97 
| epoch  15 |   200/  216 batches | lr 0.00030 | ms/batch 76.51 | loss  4.08 | ppl    59.23 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 17.21s | valid loss  4.46 | valid ppl    86.81 | valid bpc    6.440
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 15.0%
| epoch  16 |   100/  216 batches | lr 0.00030 | ms/batch 77.85 | loss  4.07 | ppl    58.79 
| epoch  16 |   200/  216 batches | lr 0.00030 | ms/batch 77.09 | loss  4.03 | ppl    56.31 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 17.20s | valid loss  4.41 | valid ppl    82.02 | valid bpc    6.358
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 16.0%
| epoch  17 |   100/  216 batches | lr 0.00030 | ms/batch 78.28 | loss  4.02 | ppl    55.56 
| epoch  17 |   200/  216 batches | lr 0.00030 | ms/batch 76.64 | loss  3.97 | ppl    53.07 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 17.21s | valid loss  4.40 | valid ppl    81.18 | valid bpc    6.343
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 17.0%
| epoch  18 |   100/  216 batches | lr 0.00030 | ms/batch 78.22 | loss  3.95 | ppl    51.73 
| epoch  18 |   200/  216 batches | lr 0.00030 | ms/batch 76.66 | loss  3.93 | ppl    50.81 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 17.20s | valid loss  4.40 | valid ppl    81.86 | valid bpc    6.355
-----------------------------------------------------------------------------------------
PROGRESS: 18.0%
| epoch  19 |   100/  216 batches | lr 0.00030 | ms/batch 78.20 | loss  3.90 | ppl    49.19 
| epoch  19 |   200/  216 batches | lr 0.00030 | ms/batch 76.78 | loss  3.86 | ppl    47.70 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 17.21s | valid loss  4.38 | valid ppl    79.94 | valid bpc    6.321
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 19.0%
| epoch  20 |   100/  216 batches | lr 0.00030 | ms/batch 78.15 | loss  3.83 | ppl    46.15 
| epoch  20 |   200/  216 batches | lr 0.00030 | ms/batch 76.94 | loss  3.82 | ppl    45.66 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 17.22s | valid loss  4.38 | valid ppl    79.53 | valid bpc    6.313
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 20.0%
| epoch  21 |   100/  216 batches | lr 0.00030 | ms/batch 77.37 | loss  3.80 | ppl    44.54 
| epoch  21 |   200/  216 batches | lr 0.00030 | ms/batch 77.50 | loss  3.77 | ppl    43.25 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 17.20s | valid loss  4.32 | valid ppl    75.02 | valid bpc    6.229
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 21.0%
| epoch  22 |   100/  216 batches | lr 0.00030 | ms/batch 78.03 | loss  3.72 | ppl    41.08 
| epoch  22 |   200/  216 batches | lr 0.00030 | ms/batch 77.12 | loss  3.74 | ppl    42.12 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 17.21s | valid loss  4.34 | valid ppl    76.38 | valid bpc    6.255
-----------------------------------------------------------------------------------------
PROGRESS: 22.0%
| epoch  23 |   100/  216 batches | lr 0.00030 | ms/batch 78.54 | loss  3.69 | ppl    40.00 
| epoch  23 |   200/  216 batches | lr 0.00030 | ms/batch 76.53 | loss  3.65 | ppl    38.57 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 17.21s | valid loss  4.37 | valid ppl    79.15 | valid bpc    6.306
-----------------------------------------------------------------------------------------
PROGRESS: 23.0%
| epoch  24 |   100/  216 batches | lr 0.00030 | ms/batch 78.29 | loss  3.62 | ppl    37.33 
| epoch  24 |   200/  216 batches | lr 0.00030 | ms/batch 76.46 | loss  3.60 | ppl    36.50 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 17.21s | valid loss  4.33 | valid ppl    75.97 | valid bpc    6.247
-----------------------------------------------------------------------------------------
PROGRESS: 24.0%
| epoch  25 |   100/  216 batches | lr 0.00015 | ms/batch 78.24 | loss  3.52 | ppl    33.87 
| epoch  25 |   200/  216 batches | lr 0.00015 | ms/batch 76.88 | loss  3.48 | ppl    32.54 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 17.21s | valid loss  4.24 | valid ppl    69.39 | valid bpc    6.117
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 25.0%
| epoch  26 |   100/  216 batches | lr 0.00015 | ms/batch 77.86 | loss  3.48 | ppl    32.36 
| epoch  26 |   200/  216 batches | lr 0.00015 | ms/batch 77.08 | loss  3.43 | ppl    30.99 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 17.21s | valid loss  4.27 | valid ppl    71.54 | valid bpc    6.161
-----------------------------------------------------------------------------------------
PROGRESS: 26.0%
| epoch  27 |   100/  216 batches | lr 0.00015 | ms/batch 78.20 | loss  3.41 | ppl    30.40 
| epoch  27 |   200/  216 batches | lr 0.00015 | ms/batch 76.88 | loss  3.41 | ppl    30.31 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 17.21s | valid loss  4.24 | valid ppl    69.18 | valid bpc    6.112
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 27.0%
| epoch  28 |   100/  216 batches | lr 0.00015 | ms/batch 77.98 | loss  3.41 | ppl    30.13 
| epoch  28 |   200/  216 batches | lr 0.00015 | ms/batch 76.69 | loss  3.36 | ppl    28.86 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 17.21s | valid loss  4.24 | valid ppl    69.22 | valid bpc    6.113
-----------------------------------------------------------------------------------------
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  216 batches | lr 0.00015 | ms/batch 77.96 | loss  3.34 | ppl    28.32 
| epoch  29 |   200/  216 batches | lr 0.00015 | ms/batch 77.03 | loss  3.35 | ppl    28.49 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 17.22s | valid loss  4.24 | valid ppl    69.16 | valid bpc    6.112
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  216 batches | lr 0.00015 | ms/batch 78.42 | loss  3.35 | ppl    28.42 
| epoch  30 |   200/  216 batches | lr 0.00015 | ms/batch 76.57 | loss  3.31 | ppl    27.31 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 17.21s | valid loss  4.24 | valid ppl    69.22 | valid bpc    6.113
-----------------------------------------------------------------------------------------
PROGRESS: 30.0%
| epoch  31 |   100/  216 batches | lr 0.00015 | ms/batch 78.45 | loss  3.30 | ppl    27.18 
| epoch  31 |   200/  216 batches | lr 0.00015 | ms/batch 76.53 | loss  3.30 | ppl    27.04 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 17.21s | valid loss  4.24 | valid ppl    69.54 | valid bpc    6.120
-----------------------------------------------------------------------------------------
PROGRESS: 31.0%
| epoch  32 |   100/  216 batches | lr 0.00015 | ms/batch 78.46 | loss  3.26 | ppl    26.01 
| epoch  32 |   200/  216 batches | lr 0.00015 | ms/batch 76.57 | loss  3.27 | ppl    26.38 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 17.22s | valid loss  4.25 | valid ppl    70.29 | valid bpc    6.135
-----------------------------------------------------------------------------------------
PROGRESS: 32.0%
| epoch  33 |   100/  216 batches | lr 0.00007 | ms/batch 78.10 | loss  3.22 | ppl    24.93 
| epoch  33 |   200/  216 batches | lr 0.00007 | ms/batch 76.93 | loss  3.20 | ppl    24.63 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 17.22s | valid loss  4.22 | valid ppl    67.81 | valid bpc    6.083
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 33.0%
| epoch  34 |   100/  216 batches | lr 0.00007 | ms/batch 77.93 | loss  3.20 | ppl    24.49 
| epoch  34 |   200/  216 batches | lr 0.00007 | ms/batch 77.09 | loss  3.18 | ppl    24.09 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 17.21s | valid loss  4.18 | valid ppl    65.30 | valid bpc    6.029
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 34.0%
| epoch  35 |   100/  216 batches | lr 0.00007 | ms/batch 77.87 | loss  3.16 | ppl    23.48 
| epoch  35 |   200/  216 batches | lr 0.00007 | ms/batch 76.70 | loss  3.13 | ppl    22.91 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 17.21s | valid loss  4.25 | valid ppl    70.10 | valid bpc    6.131
-----------------------------------------------------------------------------------------
PROGRESS: 35.0%
| epoch  36 |   100/  216 batches | lr 0.00007 | ms/batch 77.81 | loss  3.14 | ppl    23.22 
| epoch  36 |   200/  216 batches | lr 0.00007 | ms/batch 77.02 | loss  3.14 | ppl    23.14 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 17.20s | valid loss  4.26 | valid ppl    70.53 | valid bpc    6.140
-----------------------------------------------------------------------------------------
PROGRESS: 36.0%
| epoch  37 |   100/  216 batches | lr 0.00007 | ms/batch 78.43 | loss  3.12 | ppl    22.63 
| epoch  37 |   200/  216 batches | lr 0.00007 | ms/batch 76.68 | loss  3.12 | ppl    22.58 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 17.22s | valid loss  4.25 | valid ppl    70.09 | valid bpc    6.131
-----------------------------------------------------------------------------------------
PROGRESS: 37.0%
| epoch  38 |   100/  216 batches | lr 0.00004 | ms/batch 77.99 | loss  3.12 | ppl    22.57 
| epoch  38 |   200/  216 batches | lr 0.00004 | ms/batch 76.90 | loss  3.09 | ppl    22.01 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 17.20s | valid loss  4.19 | valid ppl    66.03 | valid bpc    6.045
-----------------------------------------------------------------------------------------
PROGRESS: 38.0%
| epoch  39 |   100/  216 batches | lr 0.00004 | ms/batch 77.54 | loss  3.09 | ppl    21.93 
| epoch  39 |   200/  216 batches | lr 0.00004 | ms/batch 77.27 | loss  3.07 | ppl    21.53 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 17.21s | valid loss  4.20 | valid ppl    66.64 | valid bpc    6.058
-----------------------------------------------------------------------------------------
PROGRESS: 39.0%
| epoch  40 |   100/  216 batches | lr 0.00004 | ms/batch 78.25 | loss  3.08 | ppl    21.69 
| epoch  40 |   200/  216 batches | lr 0.00004 | ms/batch 76.92 | loss  3.04 | ppl    20.98 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 17.22s | valid loss  4.24 | valid ppl    69.57 | valid bpc    6.120
-----------------------------------------------------------------------------------------
PROGRESS: 40.0%
| epoch  41 |   100/  216 batches | lr 0.00002 | ms/batch 78.02 | loss  3.06 | ppl    21.35 
| epoch  41 |   200/  216 batches | lr 0.00002 | ms/batch 77.03 | loss  3.04 | ppl    20.87 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 17.22s | valid loss  4.27 | valid ppl    71.32 | valid bpc    6.156
-----------------------------------------------------------------------------------------
PROGRESS: 41.0%
| epoch  42 |   100/  216 batches | lr 0.00002 | ms/batch 78.27 | loss  3.05 | ppl    21.07 
| epoch  42 |   200/  216 batches | lr 0.00002 | ms/batch 76.80 | loss  3.04 | ppl    20.85 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 17.23s | valid loss  4.24 | valid ppl    69.47 | valid bpc    6.118
-----------------------------------------------------------------------------------------
PROGRESS: 42.0%
| epoch  43 |   100/  216 batches | lr 0.00002 | ms/batch 78.38 | loss  3.04 | ppl    21.00 
| epoch  43 |   200/  216 batches | lr 0.00002 | ms/batch 76.51 | loss  3.00 | ppl    20.16 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 17.20s | valid loss  4.23 | valid ppl    68.52 | valid bpc    6.099
-----------------------------------------------------------------------------------------
PROGRESS: 43.0%
| epoch  44 |   100/  216 batches | lr 0.00001 | ms/batch 78.41 | loss  3.03 | ppl    20.59 
| epoch  44 |   200/  216 batches | lr 0.00001 | ms/batch 76.78 | loss  3.00 | ppl    20.17 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 17.22s | valid loss  4.19 | valid ppl    66.29 | valid bpc    6.051
-----------------------------------------------------------------------------------------
PROGRESS: 44.0%
| epoch  45 |   100/  216 batches | lr 0.00001 | ms/batch 77.55 | loss  3.03 | ppl    20.71 
| epoch  45 |   200/  216 batches | lr 0.00001 | ms/batch 77.45 | loss  3.00 | ppl    20.08 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 17.22s | valid loss  4.20 | valid ppl    66.45 | valid bpc    6.054
-----------------------------------------------------------------------------------------
PROGRESS: 45.0%
| epoch  46 |   100/  216 batches | lr 0.00001 | ms/batch 77.52 | loss  3.02 | ppl    20.49 
| epoch  46 |   200/  216 batches | lr 0.00001 | ms/batch 77.24 | loss  2.99 | ppl    19.79 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 17.19s | valid loss  4.24 | valid ppl    69.42 | valid bpc    6.117
-----------------------------------------------------------------------------------------
PROGRESS: 46.0%
| epoch  47 |   100/  216 batches | lr 0.00000 | ms/batch 78.34 | loss  3.06 | ppl    21.32 
| epoch  47 |   200/  216 batches | lr 0.00000 | ms/batch 76.57 | loss  2.98 | ppl    19.70 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 17.20s | valid loss  4.22 | valid ppl    68.20 | valid bpc    6.092
-----------------------------------------------------------------------------------------
PROGRESS: 47.0%
| epoch  48 |   100/  216 batches | lr 0.00000 | ms/batch 77.73 | loss  3.02 | ppl    20.50 
| epoch  48 |   200/  216 batches | lr 0.00000 | ms/batch 77.07 | loss  2.99 | ppl    19.91 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 17.20s | valid loss  4.23 | valid ppl    68.85 | valid bpc    6.105
-----------------------------------------------------------------------------------------
PROGRESS: 48.0%
| epoch  49 |   100/  216 batches | lr 0.00000 | ms/batch 77.64 | loss  3.05 | ppl    21.01 
| epoch  49 |   200/  216 batches | lr 0.00000 | ms/batch 77.39 | loss  2.98 | ppl    19.73 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 17.22s | valid loss  4.19 | valid ppl    65.76 | valid bpc    6.039
-----------------------------------------------------------------------------------------
PROGRESS: 49.0%
| epoch  50 |   100/  216 batches | lr 0.00000 | ms/batch 78.30 | loss  3.02 | ppl    20.58 
| epoch  50 |   200/  216 batches | lr 0.00000 | ms/batch 76.64 | loss  2.99 | ppl    19.93 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 17.22s | valid loss  4.21 | valid ppl    67.25 | valid bpc    6.071
-----------------------------------------------------------------------------------------
PROGRESS: 50.0%
| epoch  51 |   100/  216 batches | lr 0.00000 | ms/batch 77.92 | loss  3.01 | ppl    20.30 
| epoch  51 |   200/  216 batches | lr 0.00000 | ms/batch 76.97 | loss  3.02 | ppl    20.49 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 17.21s | valid loss  4.21 | valid ppl    67.34 | valid bpc    6.073
-----------------------------------------------------------------------------------------
PROGRESS: 51.0%
| epoch  52 |   100/  216 batches | lr 0.00000 | ms/batch 77.72 | loss  3.02 | ppl    20.56 
| epoch  52 |   200/  216 batches | lr 0.00000 | ms/batch 77.36 | loss  2.99 | ppl    19.93 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 17.22s | valid loss  4.21 | valid ppl    67.07 | valid bpc    6.068
-----------------------------------------------------------------------------------------
PROGRESS: 52.0%
| epoch  53 |   100/  216 batches | lr 0.00000 | ms/batch 78.48 | loss  3.01 | ppl    20.37 
| epoch  53 |   200/  216 batches | lr 0.00000 | ms/batch 76.33 | loss  2.97 | ppl    19.57 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 17.20s | valid loss  4.20 | valid ppl    66.40 | valid bpc    6.053
-----------------------------------------------------------------------------------------
PROGRESS: 53.0%
| epoch  54 |   100/  216 batches | lr 0.00000 | ms/batch 77.69 | loss  3.02 | ppl    20.56 
| epoch  54 |   200/  216 batches | lr 0.00000 | ms/batch 77.09 | loss  2.97 | ppl    19.56 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 17.20s | valid loss  4.21 | valid ppl    67.27 | valid bpc    6.072
-----------------------------------------------------------------------------------------
PROGRESS: 54.0%
| epoch  55 |   100/  216 batches | lr 0.00000 | ms/batch 78.11 | loss  3.01 | ppl    20.20 
| epoch  55 |   200/  216 batches | lr 0.00000 | ms/batch 77.12 | loss  2.98 | ppl    19.70 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 17.22s | valid loss  4.19 | valid ppl    65.86 | valid bpc    6.041
-----------------------------------------------------------------------------------------
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  216 batches | lr 0.00000 | ms/batch 78.24 | loss  3.03 | ppl    20.64 
| epoch  56 |   200/  216 batches | lr 0.00000 | ms/batch 76.78 | loss  3.01 | ppl    20.34 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 17.21s | valid loss  4.22 | valid ppl    67.77 | valid bpc    6.083
-----------------------------------------------------------------------------------------
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  216 batches | lr 0.00000 | ms/batch 78.17 | loss  3.02 | ppl    20.58 
| epoch  57 |   200/  216 batches | lr 0.00000 | ms/batch 76.94 | loss  2.97 | ppl    19.48 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 17.23s | valid loss  4.21 | valid ppl    67.68 | valid bpc    6.081
-----------------------------------------------------------------------------------------
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  216 batches | lr 0.00000 | ms/batch 78.49 | loss  3.03 | ppl    20.70 
| epoch  58 |   200/  216 batches | lr 0.00000 | ms/batch 76.33 | loss  2.98 | ppl    19.73 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 17.22s | valid loss  4.20 | valid ppl    66.78 | valid bpc    6.061
-----------------------------------------------------------------------------------------
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  216 batches | lr 0.00000 | ms/batch 78.13 | loss  3.01 | ppl    20.30 
| epoch  59 |   200/  216 batches | lr 0.00000 | ms/batch 76.81 | loss  3.00 | ppl    20.00 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 17.20s | valid loss  4.24 | valid ppl    69.65 | valid bpc    6.122
-----------------------------------------------------------------------------------------
PROGRESS: 59.0%
| epoch  60 |   100/  216 batches | lr 0.00000 | ms/batch 78.40 | loss  3.03 | ppl    20.76 
| epoch  60 |   200/  216 batches | lr 0.00000 | ms/batch 76.55 | loss  2.99 | ppl    19.86 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 17.21s | valid loss  4.21 | valid ppl    67.14 | valid bpc    6.069
-----------------------------------------------------------------------------------------
PROGRESS: 60.0%
| epoch  61 |   100/  216 batches | lr 0.00000 | ms/batch 78.00 | loss  3.01 | ppl    20.32 
| epoch  61 |   200/  216 batches | lr 0.00000 | ms/batch 76.83 | loss  2.99 | ppl    19.91 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 17.20s | valid loss  4.21 | valid ppl    67.32 | valid bpc    6.073
-----------------------------------------------------------------------------------------
PROGRESS: 61.0%
| epoch  62 |   100/  216 batches | lr 0.00000 | ms/batch 78.39 | loss  3.01 | ppl    20.37 
| epoch  62 |   200/  216 batches | lr 0.00000 | ms/batch 76.57 | loss  3.00 | ppl    20.03 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 17.20s | valid loss  4.21 | valid ppl    67.38 | valid bpc    6.074
-----------------------------------------------------------------------------------------
PROGRESS: 62.0%
| epoch  63 |   100/  216 batches | lr 0.00000 | ms/batch 78.54 | loss  3.02 | ppl    20.44 
| epoch  63 |   200/  216 batches | lr 0.00000 | ms/batch 76.54 | loss  2.97 | ppl    19.49 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 17.21s | valid loss  4.23 | valid ppl    68.82 | valid bpc    6.105
-----------------------------------------------------------------------------------------
PROGRESS: 63.0%
| epoch  64 |   100/  216 batches | lr 0.00000 | ms/batch 77.83 | loss  3.00 | ppl    20.14 
| epoch  64 |   200/  216 batches | lr 0.00000 | ms/batch 76.96 | loss  2.98 | ppl    19.77 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 17.22s | valid loss  4.22 | valid ppl    67.99 | valid bpc    6.087
-----------------------------------------------------------------------------------------
PROGRESS: 64.0%
| epoch  65 |   100/  216 batches | lr 0.00000 | ms/batch 77.87 | loss  3.02 | ppl    20.57 
| epoch  65 |   200/  216 batches | lr 0.00000 | ms/batch 76.93 | loss  2.99 | ppl    19.89 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 17.22s | valid loss  4.26 | valid ppl    70.99 | valid bpc    6.150
-----------------------------------------------------------------------------------------
PROGRESS: 65.0%
| epoch  66 |   100/  216 batches | lr 0.00000 | ms/batch 77.84 | loss  3.01 | ppl    20.34 
| epoch  66 |   200/  216 batches | lr 0.00000 | ms/batch 76.94 | loss  2.99 | ppl    19.85 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 17.20s | valid loss  4.22 | valid ppl    68.06 | valid bpc    6.089
-----------------------------------------------------------------------------------------
PROGRESS: 66.0%
| epoch  67 |   100/  216 batches | lr 0.00000 | ms/batch 78.26 | loss  3.04 | ppl    20.97 
| epoch  67 |   200/  216 batches | lr 0.00000 | ms/batch 76.75 | loss  2.97 | ppl    19.50 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 17.21s | valid loss  4.22 | valid ppl    67.94 | valid bpc    6.086
-----------------------------------------------------------------------------------------
PROGRESS: 67.0%
| epoch  68 |   100/  216 batches | lr 0.00000 | ms/batch 77.63 | loss  3.00 | ppl    20.10 
| epoch  68 |   200/  216 batches | lr 0.00000 | ms/batch 77.16 | loss  2.99 | ppl    19.89 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 17.19s | valid loss  4.22 | valid ppl    68.17 | valid bpc    6.091
-----------------------------------------------------------------------------------------
PROGRESS: 68.0%
| epoch  69 |   100/  216 batches | lr 0.00000 | ms/batch 78.43 | loss  3.05 | ppl    21.04 
| epoch  69 |   200/  216 batches | lr 0.00000 | ms/batch 76.61 | loss  2.99 | ppl    19.90 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 17.21s | valid loss  4.22 | valid ppl    67.78 | valid bpc    6.083
-----------------------------------------------------------------------------------------
PROGRESS: 69.0%
| epoch  70 |   100/  216 batches | lr 0.00000 | ms/batch 78.13 | loss  3.02 | ppl    20.43 
| epoch  70 |   200/  216 batches | lr 0.00000 | ms/batch 76.96 | loss  2.99 | ppl    19.89 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 17.23s | valid loss  4.20 | valid ppl    66.40 | valid bpc    6.053
-----------------------------------------------------------------------------------------
PROGRESS: 70.0%
| epoch  71 |   100/  216 batches | lr 0.00000 | ms/batch 78.20 | loss  3.03 | ppl    20.64 
| epoch  71 |   200/  216 batches | lr 0.00000 | ms/batch 76.88 | loss  2.97 | ppl    19.49 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 17.22s | valid loss  4.23 | valid ppl    68.73 | valid bpc    6.103
-----------------------------------------------------------------------------------------
PROGRESS: 71.0%
| epoch  72 |   100/  216 batches | lr 0.00000 | ms/batch 77.83 | loss  3.03 | ppl    20.69 
| epoch  72 |   200/  216 batches | lr 0.00000 | ms/batch 76.60 | loss  2.98 | ppl    19.76 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 17.20s | valid loss  4.25 | valid ppl    69.80 | valid bpc    6.125
-----------------------------------------------------------------------------------------
PROGRESS: 72.0%
| epoch  73 |   100/  216 batches | lr 0.00000 | ms/batch 77.92 | loss  3.01 | ppl    20.27 
| epoch  73 |   200/  216 batches | lr 0.00000 | ms/batch 76.66 | loss  2.98 | ppl    19.63 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 17.20s | valid loss  4.23 | valid ppl    68.93 | valid bpc    6.107
-----------------------------------------------------------------------------------------
PROGRESS: 73.0%
| epoch  74 |   100/  216 batches | lr 0.00000 | ms/batch 77.91 | loss  3.01 | ppl    20.37 
| epoch  74 |   200/  216 batches | lr 0.00000 | ms/batch 76.59 | loss  2.99 | ppl    19.87 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 17.20s | valid loss  4.19 | valid ppl    66.19 | valid bpc    6.049
-----------------------------------------------------------------------------------------
PROGRESS: 74.0%
| epoch  75 |   100/  216 batches | lr 0.00000 | ms/batch 77.97 | loss  3.03 | ppl    20.69 
| epoch  75 |   200/  216 batches | lr 0.00000 | ms/batch 76.89 | loss  2.97 | ppl    19.57 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 17.20s | valid loss  4.18 | valid ppl    65.46 | valid bpc    6.032
-----------------------------------------------------------------------------------------
PROGRESS: 75.0%
| epoch  76 |   100/  216 batches | lr 0.00000 | ms/batch 78.07 | loss  2.99 | ppl    19.96 
| epoch  76 |   200/  216 batches | lr 0.00000 | ms/batch 77.06 | loss  3.01 | ppl    20.26 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 17.22s | valid loss  4.21 | valid ppl    67.15 | valid bpc    6.069
-----------------------------------------------------------------------------------------
PROGRESS: 76.0%
| epoch  77 |   100/  216 batches | lr 0.00000 | ms/batch 78.52 | loss  3.00 | ppl    20.08 
| epoch  77 |   200/  216 batches | lr 0.00000 | ms/batch 76.66 | loss  2.97 | ppl    19.48 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 17.22s | valid loss  4.21 | valid ppl    67.23 | valid bpc    6.071
-----------------------------------------------------------------------------------------
PROGRESS: 77.0%
| epoch  78 |   100/  216 batches | lr 0.00000 | ms/batch 78.24 | loss  3.00 | ppl    20.16 
| epoch  78 |   200/  216 batches | lr 0.00000 | ms/batch 76.83 | loss  3.00 | ppl    20.03 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 17.21s | valid loss  4.18 | valid ppl    65.55 | valid bpc    6.035
-----------------------------------------------------------------------------------------
PROGRESS: 78.0%
| epoch  79 |   100/  216 batches | lr 0.00000 | ms/batch 77.88 | loss  3.02 | ppl    20.54 
| epoch  79 |   200/  216 batches | lr 0.00000 | ms/batch 77.16 | loss  2.97 | ppl    19.51 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 17.23s | valid loss  4.24 | valid ppl    69.72 | valid bpc    6.123
-----------------------------------------------------------------------------------------
PROGRESS: 79.0%
| epoch  80 |   100/  216 batches | lr 0.00000 | ms/batch 78.74 | loss  3.01 | ppl    20.26 
| epoch  80 |   200/  216 batches | lr 0.00000 | ms/batch 76.30 | loss  2.99 | ppl    19.83 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 17.22s | valid loss  4.21 | valid ppl    67.03 | valid bpc    6.067
-----------------------------------------------------------------------------------------
PROGRESS: 80.0%
| epoch  81 |   100/  216 batches | lr 0.00000 | ms/batch 78.25 | loss  3.01 | ppl    20.27 
| epoch  81 |   200/  216 batches | lr 0.00000 | ms/batch 76.60 | loss  3.00 | ppl    20.00 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 17.20s | valid loss  4.22 | valid ppl    68.02 | valid bpc    6.088
-----------------------------------------------------------------------------------------
PROGRESS: 81.0%
| epoch  82 |   100/  216 batches | lr 0.00000 | ms/batch 77.89 | loss  3.02 | ppl    20.50 
| epoch  82 |   200/  216 batches | lr 0.00000 | ms/batch 76.75 | loss  3.00 | ppl    20.10 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 17.21s | valid loss  4.24 | valid ppl    69.16 | valid bpc    6.112
-----------------------------------------------------------------------------------------
PROGRESS: 82.0%
| epoch  83 |   100/  216 batches | lr 0.00000 | ms/batch 78.05 | loss  3.01 | ppl    20.33 
| epoch  83 |   200/  216 batches | lr 0.00000 | ms/batch 76.77 | loss  2.97 | ppl    19.42 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 17.19s | valid loss  4.18 | valid ppl    65.09 | valid bpc    6.024
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 83.0%
| epoch  84 |   100/  216 batches | lr 0.00000 | ms/batch 77.90 | loss  3.02 | ppl    20.45 
| epoch  84 |   200/  216 batches | lr 0.00000 | ms/batch 77.10 | loss  2.99 | ppl    19.86 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 17.21s | valid loss  4.24 | valid ppl    69.42 | valid bpc    6.117
-----------------------------------------------------------------------------------------
PROGRESS: 84.0%
| epoch  85 |   100/  216 batches | lr 0.00000 | ms/batch 77.87 | loss  3.02 | ppl    20.50 
| epoch  85 |   200/  216 batches | lr 0.00000 | ms/batch 77.06 | loss  2.99 | ppl    19.92 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 17.21s | valid loss  4.25 | valid ppl    70.39 | valid bpc    6.137
-----------------------------------------------------------------------------------------
PROGRESS: 85.0%
| epoch  86 |   100/  216 batches | lr 0.00000 | ms/batch 77.86 | loss  3.01 | ppl    20.33 
| epoch  86 |   200/  216 batches | lr 0.00000 | ms/batch 77.18 | loss  2.97 | ppl    19.50 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 17.21s | valid loss  4.19 | valid ppl    65.76 | valid bpc    6.039
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  216 batches | lr 0.00000 | ms/batch 77.93 | loss  3.00 | ppl    20.06 
| epoch  87 |   200/  216 batches | lr 0.00000 | ms/batch 77.07 | loss  2.99 | ppl    19.87 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 17.21s | valid loss  4.21 | valid ppl    67.29 | valid bpc    6.072
-----------------------------------------------------------------------------------------
PROGRESS: 87.0%
| epoch  88 |   100/  216 batches | lr 0.00000 | ms/batch 77.75 | loss  3.02 | ppl    20.56 
| epoch  88 |   200/  216 batches | lr 0.00000 | ms/batch 77.08 | loss  2.98 | ppl    19.71 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 17.20s | valid loss  4.22 | valid ppl    67.77 | valid bpc    6.082
-----------------------------------------------------------------------------------------
PROGRESS: 88.0%
| epoch  89 |   100/  216 batches | lr 0.00000 | ms/batch 78.27 | loss  3.03 | ppl    20.73 
| epoch  89 |   200/  216 batches | lr 0.00000 | ms/batch 76.73 | loss  2.96 | ppl    19.39 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 17.22s | valid loss  4.21 | valid ppl    67.22 | valid bpc    6.071
-----------------------------------------------------------------------------------------
PROGRESS: 89.0%
| epoch  90 |   100/  216 batches | lr 0.00000 | ms/batch 78.04 | loss  3.02 | ppl    20.55 
| epoch  90 |   200/  216 batches | lr 0.00000 | ms/batch 76.95 | loss  2.97 | ppl    19.52 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 17.21s | valid loss  4.19 | valid ppl    66.02 | valid bpc    6.045
-----------------------------------------------------------------------------------------
PROGRESS: 90.0%
| epoch  91 |   100/  216 batches | lr 0.00000 | ms/batch 78.11 | loss  3.04 | ppl    20.96 
| epoch  91 |   200/  216 batches | lr 0.00000 | ms/batch 76.86 | loss  2.99 | ppl    19.89 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 17.22s | valid loss  4.19 | valid ppl    66.04 | valid bpc    6.045
-----------------------------------------------------------------------------------------
PROGRESS: 91.0%
| epoch  92 |   100/  216 batches | lr 0.00000 | ms/batch 77.68 | loss  3.03 | ppl    20.59 
| epoch  92 |   200/  216 batches | lr 0.00000 | ms/batch 76.79 | loss  2.99 | ppl    19.94 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 17.21s | valid loss  4.23 | valid ppl    68.62 | valid bpc    6.100
-----------------------------------------------------------------------------------------
PROGRESS: 92.0%
| epoch  93 |   100/  216 batches | lr 0.00000 | ms/batch 78.20 | loss  3.00 | ppl    20.13 
| epoch  93 |   200/  216 batches | lr 0.00000 | ms/batch 76.83 | loss  2.98 | ppl    19.62 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 17.22s | valid loss  4.20 | valid ppl    66.91 | valid bpc    6.064
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  216 batches | lr 0.00000 | ms/batch 78.40 | loss  3.01 | ppl    20.19 
| epoch  94 |   200/  216 batches | lr 0.00000 | ms/batch 76.79 | loss  2.99 | ppl    19.92 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 17.22s | valid loss  4.20 | valid ppl    66.89 | valid bpc    6.064
-----------------------------------------------------------------------------------------
PROGRESS: 94.0%
| epoch  95 |   100/  216 batches | lr 0.00000 | ms/batch 77.93 | loss  3.00 | ppl    20.18 
| epoch  95 |   200/  216 batches | lr 0.00000 | ms/batch 77.06 | loss  3.01 | ppl    20.29 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 17.20s | valid loss  4.26 | valid ppl    70.65 | valid bpc    6.143
-----------------------------------------------------------------------------------------
PROGRESS: 95.0%
| epoch  96 |   100/  216 batches | lr 0.00000 | ms/batch 78.10 | loss  2.99 | ppl    19.96 
| epoch  96 |   200/  216 batches | lr 0.00000 | ms/batch 77.01 | loss  2.98 | ppl    19.76 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 17.22s | valid loss  4.24 | valid ppl    69.19 | valid bpc    6.112
-----------------------------------------------------------------------------------------
PROGRESS: 96.0%
| epoch  97 |   100/  216 batches | lr 0.00000 | ms/batch 78.07 | loss  3.00 | ppl    20.17 
| epoch  97 |   200/  216 batches | lr 0.00000 | ms/batch 76.91 | loss  2.99 | ppl    19.80 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 17.22s | valid loss  4.20 | valid ppl    66.41 | valid bpc    6.053
-----------------------------------------------------------------------------------------
PROGRESS: 97.0%
| epoch  98 |   100/  216 batches | lr 0.00000 | ms/batch 78.10 | loss  3.02 | ppl    20.46 
| epoch  98 |   200/  216 batches | lr 0.00000 | ms/batch 76.60 | loss  2.97 | ppl    19.51 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 17.21s | valid loss  4.19 | valid ppl    65.90 | valid bpc    6.042
-----------------------------------------------------------------------------------------
PROGRESS: 98.0%
| epoch  99 |   100/  216 batches | lr 0.00000 | ms/batch 78.06 | loss  3.01 | ppl    20.30 
| epoch  99 |   200/  216 batches | lr 0.00000 | ms/batch 76.90 | loss  2.99 | ppl    19.86 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 17.21s | valid loss  4.23 | valid ppl    68.98 | valid bpc    6.108
-----------------------------------------------------------------------------------------
PROGRESS: 99.0%
| epoch 100 |   100/  216 batches | lr 0.00000 | ms/batch 77.80 | loss  3.01 | ppl    20.37 
| epoch 100 |   200/  216 batches | lr 0.00000 | ms/batch 76.78 | loss  2.99 | ppl    19.96 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 17.20s | valid loss  4.19 | valid ppl    66.11 | valid bpc    6.047
-----------------------------------------------------------------------------------------
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  4.18 | test ppl    65.17 | test bpc    6.026
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.4394, Mean Reca: 0.6047, Mean F1: 0.5006
Counter({'NP': 8712, 'PP': 4207, 'S': 3493, 'VP': 3468, 'SBAR': 730, 'QP': 296, 'ADJP': 275, 'ADVP': 162, 'SINV': 150, 'PRN': 54, 'FRAG': 35, 'WHNP': 31, 'NX': 19, 'SQ': 14, 'NAC': 12, 'UCP': 10, 'SBARQ': 9, 'CONJP': 7, 'WHPP': 6, 'X': 3})
Counter({'NP': 14432, 'VP': 8130, 'S': 5620, 'PP': 5484, 'SBAR': 1796, 'ADJP': 649, 'QP': 490, 'ADVP': 286, 'SINV': 157, 'PRN': 128, 'NX': 95, 'FRAG': 42, 'WHNP': 37, 'UCP': 32, 'NAC': 30, 'WHPP': 25, 'CONJP': 21, 'SQ': 18, 'SBARQ': 10, 'WHADVP': 9, 'X': 6, 'WHADJP': 4, 'INTJ': 1})
SBAR: 0.4065
NP: 0.6037
VP: 0.4266
PP: 0.7671
ADJP: 0.4237
ADVP: 0.5664
4.884020875509089
-----------------------------------------------------------------------------------------
Dependency parsing performance:
Conll-U Style:
DDA: 0.415
UDA: 0.597
=========================================================================================
Loading dataset...
Loading dictionary...
Number of tokens:  10001
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer_in_parser', nhid=512, nlayers=8, front_layers=1, rear_layers=7, n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=3333, nonmono=5, cuda=True, log_interval=100, save='trained_models/structformer_in_parser_3333_17.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 38475653
Model architecture: StructFormer_In_Parser(
  (transformer_front): Transformer_Front(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(10001, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0): TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
  (transformer_rear): Transformer_Rear(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(10001, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-6): 7 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (output_layer): Linear(in_features=512, out_features=10001, bias=True)
  )
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  216 batches | lr 0.00030 | ms/batch 81.01 | loss  7.26 | ppl  1423.33 
| epoch   1 |   200/  216 batches | lr 0.00030 | ms/batch 76.30 | loss  6.75 | ppl   852.53 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 17.42s | valid loss  6.43 | valid ppl   621.07 | valid bpc    9.279
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  216 batches | lr 0.00030 | ms/batch 77.26 | loss  6.42 | ppl   614.56 
| epoch   2 |   200/  216 batches | lr 0.00030 | ms/batch 76.87 | loss  6.08 | ppl   436.73 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 17.12s | valid loss  5.85 | valid ppl   348.05 | valid bpc    8.443
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  216 batches | lr 0.00030 | ms/batch 77.72 | loss  5.80 | ppl   330.89 
| epoch   3 |   200/  216 batches | lr 0.00030 | ms/batch 76.74 | loss  5.63 | ppl   278.93 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 17.16s | valid loss  5.46 | valid ppl   234.68 | valid bpc    7.875
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  216 batches | lr 0.00030 | ms/batch 77.96 | loss  5.47 | ppl   237.06 
| epoch   4 |   200/  216 batches | lr 0.00030 | ms/batch 76.66 | loss  5.32 | ppl   204.83 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 17.18s | valid loss  5.23 | valid ppl   186.33 | valid bpc    7.542
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  216 batches | lr 0.00030 | ms/batch 77.83 | loss  5.21 | ppl   183.29 
| epoch   5 |   200/  216 batches | lr 0.00030 | ms/batch 77.10 | loss  5.12 | ppl   167.84 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 17.20s | valid loss  5.09 | valid ppl   163.06 | valid bpc    7.349
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  216 batches | lr 0.00030 | ms/batch 78.27 | loss  5.07 | ppl   159.48 
| epoch   6 |   200/  216 batches | lr 0.00030 | ms/batch 76.65 | loss  4.92 | ppl   137.43 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 17.20s | valid loss  4.96 | valid ppl   142.27 | valid bpc    7.153
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  216 batches | lr 0.00030 | ms/batch 78.23 | loss  4.87 | ppl   130.86 
| epoch   7 |   200/  216 batches | lr 0.00030 | ms/batch 76.66 | loss  4.81 | ppl   123.29 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 17.21s | valid loss  4.84 | valid ppl   126.79 | valid bpc    6.986
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  216 batches | lr 0.00030 | ms/batch 77.80 | loss  4.73 | ppl   113.61 
| epoch   8 |   200/  216 batches | lr 0.00030 | ms/batch 77.18 | loss  4.71 | ppl   111.03 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 17.21s | valid loss  4.80 | valid ppl   121.40 | valid bpc    6.924
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 8.0%
| epoch   9 |   100/  216 batches | lr 0.00030 | ms/batch 78.17 | loss  4.63 | ppl   102.27 
| epoch   9 |   200/  216 batches | lr 0.00030 | ms/batch 76.83 | loss  4.58 | ppl    97.06 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 17.21s | valid loss  4.68 | valid ppl   108.22 | valid bpc    6.758
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  216 batches | lr 0.00030 | ms/batch 78.03 | loss  4.53 | ppl    92.67 
| epoch  10 |   200/  216 batches | lr 0.00030 | ms/batch 76.99 | loss  4.48 | ppl    88.56 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 17.22s | valid loss  4.63 | valid ppl   102.82 | valid bpc    6.684
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  216 batches | lr 0.00030 | ms/batch 78.25 | loss  4.42 | ppl    83.10 
| epoch  11 |   200/  216 batches | lr 0.00030 | ms/batch 76.58 | loss  4.38 | ppl    79.74 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 17.21s | valid loss  4.59 | valid ppl    98.52 | valid bpc    6.622
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  216 batches | lr 0.00030 | ms/batch 78.03 | loss  4.35 | ppl    77.41 
| epoch  12 |   200/  216 batches | lr 0.00030 | ms/batch 77.10 | loss  4.29 | ppl    73.11 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 17.22s | valid loss  4.52 | valid ppl    92.18 | valid bpc    6.526
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 12.0%
| epoch  13 |   100/  216 batches | lr 0.00030 | ms/batch 78.41 | loss  4.25 | ppl    70.06 
| epoch  13 |   200/  216 batches | lr 0.00030 | ms/batch 76.71 | loss  4.24 | ppl    69.53 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 17.22s | valid loss  4.48 | valid ppl    88.51 | valid bpc    6.468
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 13.0%
| epoch  14 |   100/  216 batches | lr 0.00030 | ms/batch 77.86 | loss  4.17 | ppl    64.79 
| epoch  14 |   200/  216 batches | lr 0.00030 | ms/batch 77.28 | loss  4.16 | ppl    64.17 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 17.22s | valid loss  4.50 | valid ppl    89.81 | valid bpc    6.489
-----------------------------------------------------------------------------------------
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  216 batches | lr 0.00030 | ms/batch 78.68 | loss  4.11 | ppl    60.65 
| epoch  15 |   200/  216 batches | lr 0.00030 | ms/batch 76.88 | loss  4.11 | ppl    61.03 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 17.28s | valid loss  4.44 | valid ppl    84.74 | valid bpc    6.405
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 15.0%
| epoch  16 |   100/  216 batches | lr 0.00030 | ms/batch 78.42 | loss  4.05 | ppl    57.60 
| epoch  16 |   200/  216 batches | lr 0.00030 | ms/batch 76.67 | loss  4.02 | ppl    55.80 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 17.22s | valid loss  4.42 | valid ppl    83.40 | valid bpc    6.382
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 16.0%
| epoch  17 |   100/  216 batches | lr 0.00030 | ms/batch 77.79 | loss  3.98 | ppl    53.46 
| epoch  17 |   200/  216 batches | lr 0.00030 | ms/batch 77.09 | loss  3.97 | ppl    52.90 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 17.22s | valid loss  4.40 | valid ppl    81.35 | valid bpc    6.346
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 17.0%
| epoch  18 |   100/  216 batches | lr 0.00030 | ms/batch 78.10 | loss  3.96 | ppl    52.45 
| epoch  18 |   200/  216 batches | lr 0.00030 | ms/batch 76.88 | loss  3.92 | ppl    50.17 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 17.22s | valid loss  4.38 | valid ppl    79.90 | valid bpc    6.320
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 18.0%
| epoch  19 |   100/  216 batches | lr 0.00030 | ms/batch 77.75 | loss  3.87 | ppl    47.78 
| epoch  19 |   200/  216 batches | lr 0.00030 | ms/batch 77.24 | loss  3.84 | ppl    46.33 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 17.22s | valid loss  4.32 | valid ppl    75.18 | valid bpc    6.232
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 19.0%
| epoch  20 |   100/  216 batches | lr 0.00030 | ms/batch 77.77 | loss  3.80 | ppl    44.80 
| epoch  20 |   200/  216 batches | lr 0.00030 | ms/batch 77.19 | loss  3.80 | ppl    44.49 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 17.22s | valid loss  4.34 | valid ppl    76.41 | valid bpc    6.256
-----------------------------------------------------------------------------------------
PROGRESS: 20.0%
| epoch  21 |   100/  216 batches | lr 0.00030 | ms/batch 78.01 | loss  3.76 | ppl    42.96 
| epoch  21 |   200/  216 batches | lr 0.00030 | ms/batch 76.85 | loss  3.74 | ppl    42.27 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 17.22s | valid loss  4.35 | valid ppl    77.82 | valid bpc    6.282
-----------------------------------------------------------------------------------------
PROGRESS: 21.0%
| epoch  22 |   100/  216 batches | lr 0.00030 | ms/batch 78.16 | loss  3.72 | ppl    41.32 
| epoch  22 |   200/  216 batches | lr 0.00030 | ms/batch 76.89 | loss  3.71 | ppl    40.67 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 17.22s | valid loss  4.33 | valid ppl    76.18 | valid bpc    6.251
-----------------------------------------------------------------------------------------
PROGRESS: 22.0%
| epoch  23 |   100/  216 batches | lr 0.00015 | ms/batch 77.85 | loss  3.60 | ppl    36.75 
| epoch  23 |   200/  216 batches | lr 0.00015 | ms/batch 77.25 | loss  3.56 | ppl    35.29 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 17.21s | valid loss  4.28 | valid ppl    72.16 | valid bpc    6.173
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 23.0%
| epoch  24 |   100/  216 batches | lr 0.00015 | ms/batch 77.88 | loss  3.54 | ppl    34.48 
| epoch  24 |   200/  216 batches | lr 0.00015 | ms/batch 77.14 | loss  3.51 | ppl    33.38 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 17.22s | valid loss  4.27 | valid ppl    71.67 | valid bpc    6.163
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 24.0%
| epoch  25 |   100/  216 batches | lr 0.00015 | ms/batch 78.10 | loss  3.51 | ppl    33.33 
| epoch  25 |   200/  216 batches | lr 0.00015 | ms/batch 76.90 | loss  3.47 | ppl    32.26 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 17.21s | valid loss  4.28 | valid ppl    72.24 | valid bpc    6.175
-----------------------------------------------------------------------------------------
PROGRESS: 25.0%
| epoch  26 |   100/  216 batches | lr 0.00015 | ms/batch 78.14 | loss  3.44 | ppl    31.34 
| epoch  26 |   200/  216 batches | lr 0.00015 | ms/batch 76.56 | loss  3.45 | ppl    31.55 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 17.22s | valid loss  4.28 | valid ppl    72.38 | valid bpc    6.178
-----------------------------------------------------------------------------------------
PROGRESS: 26.0%
| epoch  27 |   100/  216 batches | lr 0.00015 | ms/batch 78.17 | loss  3.43 | ppl    30.92 
| epoch  27 |   200/  216 batches | lr 0.00015 | ms/batch 76.76 | loss  3.40 | ppl    29.91 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 17.23s | valid loss  4.25 | valid ppl    70.25 | valid bpc    6.134
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 27.0%
| epoch  28 |   100/  216 batches | lr 0.00015 | ms/batch 78.43 | loss  3.40 | ppl    29.96 
| epoch  28 |   200/  216 batches | lr 0.00015 | ms/batch 76.52 | loss  3.39 | ppl    29.61 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 17.22s | valid loss  4.26 | valid ppl    70.85 | valid bpc    6.147
-----------------------------------------------------------------------------------------
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  216 batches | lr 0.00015 | ms/batch 78.37 | loss  3.37 | ppl    29.00 
| epoch  29 |   200/  216 batches | lr 0.00015 | ms/batch 76.82 | loss  3.34 | ppl    28.31 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 17.22s | valid loss  4.27 | valid ppl    71.34 | valid bpc    6.157
-----------------------------------------------------------------------------------------
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  216 batches | lr 0.00015 | ms/batch 78.29 | loss  3.34 | ppl    28.30 
| epoch  30 |   200/  216 batches | lr 0.00015 | ms/batch 76.74 | loss  3.35 | ppl    28.47 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 17.22s | valid loss  4.24 | valid ppl    69.31 | valid bpc    6.115
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 30.0%
| epoch  31 |   100/  216 batches | lr 0.00015 | ms/batch 78.18 | loss  3.32 | ppl    27.80 
| epoch  31 |   200/  216 batches | lr 0.00015 | ms/batch 77.06 | loss  3.30 | ppl    27.20 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 17.23s | valid loss  4.25 | valid ppl    70.37 | valid bpc    6.137
-----------------------------------------------------------------------------------------
PROGRESS: 31.0%
| epoch  32 |   100/  216 batches | lr 0.00015 | ms/batch 78.49 | loss  3.30 | ppl    27.22 
| epoch  32 |   200/  216 batches | lr 0.00015 | ms/batch 76.71 | loss  3.27 | ppl    26.19 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 17.23s | valid loss  4.24 | valid ppl    69.51 | valid bpc    6.119
-----------------------------------------------------------------------------------------
PROGRESS: 32.0%
| epoch  33 |   100/  216 batches | lr 0.00015 | ms/batch 78.18 | loss  3.27 | ppl    26.24 
| epoch  33 |   200/  216 batches | lr 0.00015 | ms/batch 76.80 | loss  3.25 | ppl    25.78 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 17.22s | valid loss  4.23 | valid ppl    68.97 | valid bpc    6.108
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 33.0%
| epoch  34 |   100/  216 batches | lr 0.00015 | ms/batch 78.05 | loss  3.23 | ppl    25.35 
| epoch  34 |   200/  216 batches | lr 0.00015 | ms/batch 77.04 | loss  3.23 | ppl    25.33 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 17.23s | valid loss  4.22 | valid ppl    67.72 | valid bpc    6.081
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 34.0%
| epoch  35 |   100/  216 batches | lr 0.00015 | ms/batch 78.03 | loss  3.22 | ppl    24.97 
| epoch  35 |   200/  216 batches | lr 0.00015 | ms/batch 77.01 | loss  3.18 | ppl    24.13 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 17.22s | valid loss  4.20 | valid ppl    66.95 | valid bpc    6.065
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 35.0%
| epoch  36 |   100/  216 batches | lr 0.00015 | ms/batch 78.40 | loss  3.17 | ppl    23.83 
| epoch  36 |   200/  216 batches | lr 0.00015 | ms/batch 76.73 | loss  3.15 | ppl    23.35 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 17.22s | valid loss  4.27 | valid ppl    71.61 | valid bpc    6.162
-----------------------------------------------------------------------------------------
PROGRESS: 36.0%
| epoch  37 |   100/  216 batches | lr 0.00015 | ms/batch 78.15 | loss  3.14 | ppl    23.14 
| epoch  37 |   200/  216 batches | lr 0.00015 | ms/batch 76.77 | loss  3.16 | ppl    23.48 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 17.22s | valid loss  4.28 | valid ppl    72.10 | valid bpc    6.172
-----------------------------------------------------------------------------------------
PROGRESS: 37.0%
| epoch  38 |   100/  216 batches | lr 0.00015 | ms/batch 78.21 | loss  3.13 | ppl    22.84 
| epoch  38 |   200/  216 batches | lr 0.00015 | ms/batch 76.71 | loss  3.11 | ppl    22.53 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 17.21s | valid loss  4.25 | valid ppl    70.41 | valid bpc    6.138
-----------------------------------------------------------------------------------------
PROGRESS: 38.0%
| epoch  39 |   100/  216 batches | lr 0.00007 | ms/batch 78.11 | loss  3.08 | ppl    21.75 
| epoch  39 |   200/  216 batches | lr 0.00007 | ms/batch 76.93 | loss  3.05 | ppl    21.11 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 17.23s | valid loss  4.26 | valid ppl    70.88 | valid bpc    6.147
-----------------------------------------------------------------------------------------
PROGRESS: 39.0%
| epoch  40 |   100/  216 batches | lr 0.00007 | ms/batch 77.75 | loss  3.02 | ppl    20.57 
| epoch  40 |   200/  216 batches | lr 0.00007 | ms/batch 77.14 | loss  3.04 | ppl    20.90 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 17.20s | valid loss  4.27 | valid ppl    71.83 | valid bpc    6.167
-----------------------------------------------------------------------------------------
PROGRESS: 40.0%
| epoch  41 |   100/  216 batches | lr 0.00007 | ms/batch 77.91 | loss  3.01 | ppl    20.19 
| epoch  41 |   200/  216 batches | lr 0.00007 | ms/batch 77.06 | loss  3.02 | ppl    20.46 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 17.22s | valid loss  4.23 | valid ppl    68.51 | valid bpc    6.098
-----------------------------------------------------------------------------------------
PROGRESS: 41.0%
| epoch  42 |   100/  216 batches | lr 0.00004 | ms/batch 78.32 | loss  3.00 | ppl    20.02 
| epoch  42 |   200/  216 batches | lr 0.00004 | ms/batch 76.75 | loss  2.95 | ppl    19.10 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 17.23s | valid loss  4.19 | valid ppl    66.17 | valid bpc    6.048
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 42.0%
| epoch  43 |   100/  216 batches | lr 0.00004 | ms/batch 78.19 | loss  2.95 | ppl    19.12 
| epoch  43 |   200/  216 batches | lr 0.00004 | ms/batch 76.77 | loss  2.97 | ppl    19.40 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 17.21s | valid loss  4.21 | valid ppl    67.12 | valid bpc    6.069
-----------------------------------------------------------------------------------------
PROGRESS: 43.0%
| epoch  44 |   100/  216 batches | lr 0.00004 | ms/batch 78.17 | loss  2.96 | ppl    19.39 
| epoch  44 |   200/  216 batches | lr 0.00004 | ms/batch 76.83 | loss  2.94 | ppl    18.88 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 17.21s | valid loss  4.20 | valid ppl    66.61 | valid bpc    6.058
-----------------------------------------------------------------------------------------
PROGRESS: 44.0%
| epoch  45 |   100/  216 batches | lr 0.00004 | ms/batch 78.05 | loss  2.94 | ppl    18.93 
| epoch  45 |   200/  216 batches | lr 0.00004 | ms/batch 77.07 | loss  2.91 | ppl    18.38 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 17.22s | valid loss  4.20 | valid ppl    66.88 | valid bpc    6.063
-----------------------------------------------------------------------------------------
PROGRESS: 45.0%
| epoch  46 |   100/  216 batches | lr 0.00002 | ms/batch 78.54 | loss  2.91 | ppl    18.39 
| epoch  46 |   200/  216 batches | lr 0.00002 | ms/batch 77.04 | loss  2.91 | ppl    18.40 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 17.28s | valid loss  4.19 | valid ppl    66.21 | valid bpc    6.049
-----------------------------------------------------------------------------------------
PROGRESS: 46.0%
| epoch  47 |   100/  216 batches | lr 0.00002 | ms/batch 78.25 | loss  2.96 | ppl    19.28 
| epoch  47 |   200/  216 batches | lr 0.00002 | ms/batch 76.77 | loss  2.88 | ppl    17.86 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 17.22s | valid loss  4.24 | valid ppl    69.72 | valid bpc    6.123
-----------------------------------------------------------------------------------------
PROGRESS: 47.0%
| epoch  48 |   100/  216 batches | lr 0.00002 | ms/batch 78.37 | loss  2.91 | ppl    18.29 
| epoch  48 |   200/  216 batches | lr 0.00002 | ms/batch 76.81 | loss  2.91 | ppl    18.43 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 17.23s | valid loss  4.21 | valid ppl    67.04 | valid bpc    6.067
-----------------------------------------------------------------------------------------
PROGRESS: 48.0%
| epoch  49 |   100/  216 batches | lr 0.00001 | ms/batch 77.98 | loss  2.91 | ppl    18.40 
| epoch  49 |   200/  216 batches | lr 0.00001 | ms/batch 76.69 | loss  2.89 | ppl    17.99 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 17.22s | valid loss  4.22 | valid ppl    67.94 | valid bpc    6.086
-----------------------------------------------------------------------------------------
PROGRESS: 49.0%
| epoch  50 |   100/  216 batches | lr 0.00001 | ms/batch 77.78 | loss  2.90 | ppl    18.14 
| epoch  50 |   200/  216 batches | lr 0.00001 | ms/batch 77.29 | loss  2.89 | ppl    18.07 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 17.22s | valid loss  4.22 | valid ppl    67.72 | valid bpc    6.081
-----------------------------------------------------------------------------------------
PROGRESS: 50.0%
| epoch  51 |   100/  216 batches | lr 0.00001 | ms/batch 77.90 | loss  2.92 | ppl    18.62 
| epoch  51 |   200/  216 batches | lr 0.00001 | ms/batch 76.77 | loss  2.86 | ppl    17.46 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 17.22s | valid loss  4.23 | valid ppl    68.95 | valid bpc    6.107
-----------------------------------------------------------------------------------------
PROGRESS: 51.0%
| epoch  52 |   100/  216 batches | lr 0.00000 | ms/batch 78.40 | loss  2.91 | ppl    18.39 
| epoch  52 |   200/  216 batches | lr 0.00000 | ms/batch 76.67 | loss  2.90 | ppl    18.18 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 17.22s | valid loss  4.19 | valid ppl    66.29 | valid bpc    6.051
-----------------------------------------------------------------------------------------
PROGRESS: 52.0%
| epoch  53 |   100/  216 batches | lr 0.00000 | ms/batch 78.04 | loss  2.92 | ppl    18.55 
| epoch  53 |   200/  216 batches | lr 0.00000 | ms/batch 76.84 | loss  2.85 | ppl    17.21 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 17.22s | valid loss  4.20 | valid ppl    66.46 | valid bpc    6.054
-----------------------------------------------------------------------------------------
PROGRESS: 53.0%
| epoch  54 |   100/  216 batches | lr 0.00000 | ms/batch 78.73 | loss  2.89 | ppl    17.96 
| epoch  54 |   200/  216 batches | lr 0.00000 | ms/batch 76.43 | loss  2.89 | ppl    18.00 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 17.23s | valid loss  4.24 | valid ppl    69.53 | valid bpc    6.119
-----------------------------------------------------------------------------------------
PROGRESS: 54.0%
| epoch  55 |   100/  216 batches | lr 0.00000 | ms/batch 78.46 | loss  2.89 | ppl    17.92 
| epoch  55 |   200/  216 batches | lr 0.00000 | ms/batch 76.62 | loss  2.86 | ppl    17.53 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 17.22s | valid loss  4.27 | valid ppl    71.29 | valid bpc    6.156
-----------------------------------------------------------------------------------------
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  216 batches | lr 0.00000 | ms/batch 77.84 | loss  2.89 | ppl    17.95 
| epoch  56 |   200/  216 batches | lr 0.00000 | ms/batch 76.79 | loss  2.87 | ppl    17.63 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 17.22s | valid loss  4.22 | valid ppl    67.72 | valid bpc    6.082
-----------------------------------------------------------------------------------------
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  216 batches | lr 0.00000 | ms/batch 78.30 | loss  2.89 | ppl    18.00 
| epoch  57 |   200/  216 batches | lr 0.00000 | ms/batch 76.82 | loss  2.86 | ppl    17.46 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 17.22s | valid loss  4.23 | valid ppl    68.68 | valid bpc    6.102
-----------------------------------------------------------------------------------------
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  216 batches | lr 0.00000 | ms/batch 78.11 | loss  2.90 | ppl    18.19 
| epoch  58 |   200/  216 batches | lr 0.00000 | ms/batch 77.03 | loss  2.87 | ppl    17.57 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 17.23s | valid loss  4.20 | valid ppl    66.62 | valid bpc    6.058
-----------------------------------------------------------------------------------------
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  216 batches | lr 0.00000 | ms/batch 78.09 | loss  2.88 | ppl    17.85 
| epoch  59 |   200/  216 batches | lr 0.00000 | ms/batch 76.85 | loss  2.87 | ppl    17.70 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 17.22s | valid loss  4.22 | valid ppl    67.88 | valid bpc    6.085
-----------------------------------------------------------------------------------------
PROGRESS: 59.0%
| epoch  60 |   100/  216 batches | lr 0.00000 | ms/batch 77.92 | loss  2.88 | ppl    17.83 
| epoch  60 |   200/  216 batches | lr 0.00000 | ms/batch 76.88 | loss  2.87 | ppl    17.69 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 17.20s | valid loss  4.26 | valid ppl    70.86 | valid bpc    6.147
-----------------------------------------------------------------------------------------
PROGRESS: 60.0%
| epoch  61 |   100/  216 batches | lr 0.00000 | ms/batch 78.42 | loss  2.89 | ppl    18.03 
| epoch  61 |   200/  216 batches | lr 0.00000 | ms/batch 76.65 | loss  2.87 | ppl    17.57 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 17.22s | valid loss  4.22 | valid ppl    67.97 | valid bpc    6.087
-----------------------------------------------------------------------------------------
PROGRESS: 61.0%
| epoch  62 |   100/  216 batches | lr 0.00000 | ms/batch 77.99 | loss  2.88 | ppl    17.80 
| epoch  62 |   200/  216 batches | lr 0.00000 | ms/batch 77.06 | loss  2.86 | ppl    17.51 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 17.22s | valid loss  4.20 | valid ppl    66.95 | valid bpc    6.065
-----------------------------------------------------------------------------------------
PROGRESS: 62.0%
| epoch  63 |   100/  216 batches | lr 0.00000 | ms/batch 77.83 | loss  2.90 | ppl    18.21 
| epoch  63 |   200/  216 batches | lr 0.00000 | ms/batch 77.11 | loss  2.87 | ppl    17.56 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 17.22s | valid loss  4.19 | valid ppl    65.74 | valid bpc    6.039
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 63.0%
| epoch  64 |   100/  216 batches | lr 0.00000 | ms/batch 77.64 | loss  2.89 | ppl    17.98 
| epoch  64 |   200/  216 batches | lr 0.00000 | ms/batch 77.36 | loss  2.87 | ppl    17.62 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 17.22s | valid loss  4.21 | valid ppl    67.08 | valid bpc    6.068
-----------------------------------------------------------------------------------------
PROGRESS: 64.0%
| epoch  65 |   100/  216 batches | lr 0.00000 | ms/batch 78.05 | loss  2.88 | ppl    17.84 
| epoch  65 |   200/  216 batches | lr 0.00000 | ms/batch 76.93 | loss  2.88 | ppl    17.82 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 17.21s | valid loss  4.24 | valid ppl    69.30 | valid bpc    6.115
-----------------------------------------------------------------------------------------
PROGRESS: 65.0%
| epoch  66 |   100/  216 batches | lr 0.00000 | ms/batch 78.09 | loss  2.90 | ppl    18.22 
| epoch  66 |   200/  216 batches | lr 0.00000 | ms/batch 76.90 | loss  2.85 | ppl    17.26 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 17.22s | valid loss  4.22 | valid ppl    67.84 | valid bpc    6.084
-----------------------------------------------------------------------------------------
PROGRESS: 66.0%
| epoch  67 |   100/  216 batches | lr 0.00000 | ms/batch 78.32 | loss  2.88 | ppl    17.83 
| epoch  67 |   200/  216 batches | lr 0.00000 | ms/batch 76.67 | loss  2.87 | ppl    17.71 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 17.22s | valid loss  4.22 | valid ppl    68.24 | valid bpc    6.092
-----------------------------------------------------------------------------------------
PROGRESS: 67.0%
| epoch  68 |   100/  216 batches | lr 0.00000 | ms/batch 78.31 | loss  2.90 | ppl    18.15 
| epoch  68 |   200/  216 batches | lr 0.00000 | ms/batch 76.78 | loss  2.87 | ppl    17.60 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 17.23s | valid loss  4.22 | valid ppl    67.71 | valid bpc    6.081
-----------------------------------------------------------------------------------------
PROGRESS: 68.0%
| epoch  69 |   100/  216 batches | lr 0.00000 | ms/batch 78.39 | loss  2.90 | ppl    18.13 
| epoch  69 |   200/  216 batches | lr 0.00000 | ms/batch 76.60 | loss  2.87 | ppl    17.58 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 17.21s | valid loss  4.20 | valid ppl    66.92 | valid bpc    6.064
-----------------------------------------------------------------------------------------
PROGRESS: 69.0%
| epoch  70 |   100/  216 batches | lr 0.00000 | ms/batch 78.04 | loss  2.91 | ppl    18.38 
| epoch  70 |   200/  216 batches | lr 0.00000 | ms/batch 76.81 | loss  2.86 | ppl    17.50 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 17.22s | valid loss  4.22 | valid ppl    67.86 | valid bpc    6.085
-----------------------------------------------------------------------------------------
PROGRESS: 70.0%
| epoch  71 |   100/  216 batches | lr 0.00000 | ms/batch 77.92 | loss  2.89 | ppl    17.95 
| epoch  71 |   200/  216 batches | lr 0.00000 | ms/batch 76.97 | loss  2.87 | ppl    17.58 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 17.22s | valid loss  4.18 | valid ppl    65.59 | valid bpc    6.035
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 71.0%
| epoch  72 |   100/  216 batches | lr 0.00000 | ms/batch 77.74 | loss  2.90 | ppl    18.17 
| epoch  72 |   200/  216 batches | lr 0.00000 | ms/batch 77.38 | loss  2.85 | ppl    17.21 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 17.22s | valid loss  4.21 | valid ppl    67.61 | valid bpc    6.079
-----------------------------------------------------------------------------------------
PROGRESS: 72.0%
| epoch  73 |   100/  216 batches | lr 0.00000 | ms/batch 77.77 | loss  2.91 | ppl    18.31 
| epoch  73 |   200/  216 batches | lr 0.00000 | ms/batch 77.34 | loss  2.87 | ppl    17.61 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 17.23s | valid loss  4.27 | valid ppl    71.51 | valid bpc    6.160
-----------------------------------------------------------------------------------------
PROGRESS: 73.0%
| epoch  74 |   100/  216 batches | lr 0.00000 | ms/batch 78.04 | loss  2.87 | ppl    17.70 
| epoch  74 |   200/  216 batches | lr 0.00000 | ms/batch 77.09 | loss  2.88 | ppl    17.89 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 17.23s | valid loss  4.19 | valid ppl    66.27 | valid bpc    6.050
-----------------------------------------------------------------------------------------
PROGRESS: 74.0%
| epoch  75 |   100/  216 batches | lr 0.00000 | ms/batch 78.50 | loss  2.89 | ppl    17.93 
| epoch  75 |   200/  216 batches | lr 0.00000 | ms/batch 76.70 | loss  2.87 | ppl    17.66 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 17.23s | valid loss  4.27 | valid ppl    71.73 | valid bpc    6.165
-----------------------------------------------------------------------------------------
PROGRESS: 75.0%
| epoch  76 |   100/  216 batches | lr 0.00000 | ms/batch 77.71 | loss  2.88 | ppl    17.74 
| epoch  76 |   200/  216 batches | lr 0.00000 | ms/batch 77.40 | loss  2.88 | ppl    17.79 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 17.23s | valid loss  4.19 | valid ppl    65.98 | valid bpc    6.044
-----------------------------------------------------------------------------------------
PROGRESS: 76.0%
| epoch  77 |   100/  216 batches | lr 0.00000 | ms/batch 78.62 | loss  2.89 | ppl    18.08 
| epoch  77 |   200/  216 batches | lr 0.00000 | ms/batch 77.12 | loss  2.85 | ppl    17.30 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 17.27s | valid loss  4.24 | valid ppl    69.07 | valid bpc    6.110
-----------------------------------------------------------------------------------------
PROGRESS: 77.0%
| epoch  78 |   100/  216 batches | lr 0.00000 | ms/batch 78.01 | loss  2.89 | ppl    18.03 
| epoch  78 |   200/  216 batches | lr 0.00000 | ms/batch 77.08 | loss  2.88 | ppl    17.80 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 17.23s | valid loss  4.21 | valid ppl    67.65 | valid bpc    6.080
-----------------------------------------------------------------------------------------
PROGRESS: 78.0%
| epoch  79 |   100/  216 batches | lr 0.00000 | ms/batch 77.94 | loss  2.91 | ppl    18.43 
| epoch  79 |   200/  216 batches | lr 0.00000 | ms/batch 77.19 | loss  2.87 | ppl    17.64 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 17.23s | valid loss  4.19 | valid ppl    66.11 | valid bpc    6.047
-----------------------------------------------------------------------------------------
PROGRESS: 79.0%
| epoch  80 |   100/  216 batches | lr 0.00000 | ms/batch 78.31 | loss  2.89 | ppl    17.96 
| epoch  80 |   200/  216 batches | lr 0.00000 | ms/batch 76.65 | loss  2.86 | ppl    17.39 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 17.21s | valid loss  4.22 | valid ppl    67.74 | valid bpc    6.082
-----------------------------------------------------------------------------------------
PROGRESS: 80.0%
| epoch  81 |   100/  216 batches | lr 0.00000 | ms/batch 77.88 | loss  2.89 | ppl    17.98 
| epoch  81 |   200/  216 batches | lr 0.00000 | ms/batch 76.97 | loss  2.87 | ppl    17.59 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 17.22s | valid loss  4.21 | valid ppl    67.15 | valid bpc    6.069
-----------------------------------------------------------------------------------------
PROGRESS: 81.0%
| epoch  82 |   100/  216 batches | lr 0.00000 | ms/batch 78.46 | loss  2.87 | ppl    17.59 
| epoch  82 |   200/  216 batches | lr 0.00000 | ms/batch 76.55 | loss  2.87 | ppl    17.63 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 17.23s | valid loss  4.22 | valid ppl    68.32 | valid bpc    6.094
-----------------------------------------------------------------------------------------
PROGRESS: 82.0%
| epoch  83 |   100/  216 batches | lr 0.00000 | ms/batch 78.19 | loss  2.89 | ppl    17.99 
| epoch  83 |   200/  216 batches | lr 0.00000 | ms/batch 76.80 | loss  2.86 | ppl    17.43 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 17.23s | valid loss  4.19 | valid ppl    65.72 | valid bpc    6.038
-----------------------------------------------------------------------------------------
PROGRESS: 83.0%
| epoch  84 |   100/  216 batches | lr 0.00000 | ms/batch 78.30 | loss  2.88 | ppl    17.87 
| epoch  84 |   200/  216 batches | lr 0.00000 | ms/batch 76.72 | loss  2.86 | ppl    17.48 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 17.23s | valid loss  4.26 | valid ppl    70.93 | valid bpc    6.148
-----------------------------------------------------------------------------------------
PROGRESS: 84.0%
| epoch  85 |   100/  216 batches | lr 0.00000 | ms/batch 77.50 | loss  2.90 | ppl    18.18 
| epoch  85 |   200/  216 batches | lr 0.00000 | ms/batch 77.34 | loss  2.84 | ppl    17.19 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 17.21s | valid loss  4.26 | valid ppl    70.62 | valid bpc    6.142
-----------------------------------------------------------------------------------------
PROGRESS: 85.0%
| epoch  86 |   100/  216 batches | lr 0.00000 | ms/batch 78.22 | loss  2.91 | ppl    18.36 
| epoch  86 |   200/  216 batches | lr 0.00000 | ms/batch 76.91 | loss  2.85 | ppl    17.29 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 17.23s | valid loss  4.22 | valid ppl    68.22 | valid bpc    6.092
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  216 batches | lr 0.00000 | ms/batch 78.13 | loss  2.90 | ppl    18.16 
| epoch  87 |   200/  216 batches | lr 0.00000 | ms/batch 77.01 | loss  2.87 | ppl    17.68 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 17.24s | valid loss  4.22 | valid ppl    68.37 | valid bpc    6.095
-----------------------------------------------------------------------------------------
PROGRESS: 87.0%
| epoch  88 |   100/  216 batches | lr 0.00000 | ms/batch 78.00 | loss  2.88 | ppl    17.87 
| epoch  88 |   200/  216 batches | lr 0.00000 | ms/batch 77.03 | loss  2.88 | ppl    17.80 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 17.23s | valid loss  4.22 | valid ppl    68.00 | valid bpc    6.087
-----------------------------------------------------------------------------------------
PROGRESS: 88.0%
| epoch  89 |   100/  216 batches | lr 0.00000 | ms/batch 78.42 | loss  2.89 | ppl    17.91 
| epoch  89 |   200/  216 batches | lr 0.00000 | ms/batch 76.70 | loss  2.87 | ppl    17.57 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 17.23s | valid loss  4.25 | valid ppl    70.45 | valid bpc    6.139
-----------------------------------------------------------------------------------------
PROGRESS: 89.0%
| epoch  90 |   100/  216 batches | lr 0.00000 | ms/batch 78.39 | loss  2.87 | ppl    17.62 
| epoch  90 |   200/  216 batches | lr 0.00000 | ms/batch 76.58 | loss  2.86 | ppl    17.54 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 17.20s | valid loss  4.23 | valid ppl    68.97 | valid bpc    6.108
-----------------------------------------------------------------------------------------
PROGRESS: 90.0%
| epoch  91 |   100/  216 batches | lr 0.00000 | ms/batch 77.88 | loss  2.90 | ppl    18.16 
| epoch  91 |   200/  216 batches | lr 0.00000 | ms/batch 77.28 | loss  2.86 | ppl    17.43 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 17.23s | valid loss  4.20 | valid ppl    66.37 | valid bpc    6.053
-----------------------------------------------------------------------------------------
PROGRESS: 91.0%
| epoch  92 |   100/  216 batches | lr 0.00000 | ms/batch 77.87 | loss  2.88 | ppl    17.80 
| epoch  92 |   200/  216 batches | lr 0.00000 | ms/batch 77.11 | loss  2.87 | ppl    17.63 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 17.21s | valid loss  4.24 | valid ppl    69.26 | valid bpc    6.114
-----------------------------------------------------------------------------------------
PROGRESS: 92.0%
| epoch  93 |   100/  216 batches | lr 0.00000 | ms/batch 78.36 | loss  2.90 | ppl    18.16 
| epoch  93 |   200/  216 batches | lr 0.00000 | ms/batch 76.80 | loss  2.86 | ppl    17.40 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 17.24s | valid loss  4.23 | valid ppl    68.39 | valid bpc    6.096
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  216 batches | lr 0.00000 | ms/batch 78.06 | loss  2.89 | ppl    18.01 
| epoch  94 |   200/  216 batches | lr 0.00000 | ms/batch 76.91 | loss  2.87 | ppl    17.63 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 17.23s | valid loss  4.20 | valid ppl    66.73 | valid bpc    6.060
-----------------------------------------------------------------------------------------
PROGRESS: 94.0%
| epoch  95 |   100/  216 batches | lr 0.00000 | ms/batch 78.33 | loss  2.89 | ppl    18.00 
| epoch  95 |   200/  216 batches | lr 0.00000 | ms/batch 76.74 | loss  2.89 | ppl    17.91 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 17.23s | valid loss  4.24 | valid ppl    69.64 | valid bpc    6.122
-----------------------------------------------------------------------------------------
PROGRESS: 95.0%
| epoch  96 |   100/  216 batches | lr 0.00000 | ms/batch 78.11 | loss  2.88 | ppl    17.82 
| epoch  96 |   200/  216 batches | lr 0.00000 | ms/batch 76.86 | loss  2.88 | ppl    17.86 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 17.23s | valid loss  4.18 | valid ppl    65.13 | valid bpc    6.025
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 96.0%
| epoch  97 |   100/  216 batches | lr 0.00000 | ms/batch 77.97 | loss  2.89 | ppl    18.01 
| epoch  97 |   200/  216 batches | lr 0.00000 | ms/batch 77.07 | loss  2.86 | ppl    17.49 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 17.22s | valid loss  4.24 | valid ppl    69.22 | valid bpc    6.113
-----------------------------------------------------------------------------------------
PROGRESS: 97.0%
| epoch  98 |   100/  216 batches | lr 0.00000 | ms/batch 78.27 | loss  2.90 | ppl    18.17 
| epoch  98 |   200/  216 batches | lr 0.00000 | ms/batch 76.83 | loss  2.84 | ppl    17.15 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 17.22s | valid loss  4.24 | valid ppl    69.65 | valid bpc    6.122
-----------------------------------------------------------------------------------------
PROGRESS: 98.0%
| epoch  99 |   100/  216 batches | lr 0.00000 | ms/batch 78.08 | loss  2.88 | ppl    17.83 
| epoch  99 |   200/  216 batches | lr 0.00000 | ms/batch 76.97 | loss  2.87 | ppl    17.63 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 17.22s | valid loss  4.24 | valid ppl    69.11 | valid bpc    6.111
-----------------------------------------------------------------------------------------
PROGRESS: 99.0%
| epoch 100 |   100/  216 batches | lr 0.00000 | ms/batch 78.08 | loss  2.89 | ppl    18.03 
| epoch 100 |   200/  216 batches | lr 0.00000 | ms/batch 76.81 | loss  2.83 | ppl    16.99 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 17.21s | valid loss  4.19 | valid ppl    66.25 | valid bpc    6.050
-----------------------------------------------------------------------------------------
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  4.15 | test ppl    63.70 | test bpc    5.993
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.4436, Mean Reca: 0.6114, Mean F1: 0.5058
Counter({'NP': 8997, 'PP': 4226, 'S': 3703, 'VP': 3307, 'SBAR': 684, 'ADJP': 291, 'QP': 267, 'ADVP': 161, 'SINV': 150, 'PRN': 53, 'FRAG': 34, 'WHNP': 28, 'NX': 21, 'SQ': 13, 'NAC': 12, 'UCP': 12, 'SBARQ': 9, 'CONJP': 6, 'WHPP': 5, 'X': 3, 'WHADVP': 1})
Counter({'NP': 14432, 'VP': 8130, 'S': 5620, 'PP': 5484, 'SBAR': 1796, 'ADJP': 649, 'QP': 490, 'ADVP': 286, 'SINV': 157, 'PRN': 128, 'NX': 95, 'FRAG': 42, 'WHNP': 37, 'UCP': 32, 'NAC': 30, 'WHPP': 25, 'CONJP': 21, 'SQ': 18, 'SBARQ': 10, 'WHADVP': 9, 'X': 6, 'WHADJP': 4, 'INTJ': 1})
SBAR: 0.3808
NP: 0.6234
VP: 0.4068
PP: 0.7706
ADJP: 0.4484
ADVP: 0.5629
4.901649495691312
-----------------------------------------------------------------------------------------
Dependency parsing performance:
Conll-U Style:
DDA: 0.401
UDA: 0.581
=========================================================================================
Loading dataset...
Loading dictionary...
Number of tokens:  10001
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer_in_parser', nhid=512, nlayers=8, front_layers=1, rear_layers=7, n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=4444, nonmono=5, cuda=True, log_interval=100, save='trained_models/structformer_in_parser_4444_17.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 38475653
Model architecture: StructFormer_In_Parser(
  (transformer_front): Transformer_Front(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(10001, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0): TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
  (transformer_rear): Transformer_Rear(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(10001, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-6): 7 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (output_layer): Linear(in_features=512, out_features=10001, bias=True)
  )
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  216 batches | lr 0.00030 | ms/batch 80.34 | loss  7.25 | ppl  1402.52 
| epoch   1 |   200/  216 batches | lr 0.00030 | ms/batch 76.56 | loss  6.74 | ppl   844.84 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 17.39s | valid loss  6.46 | valid ppl   637.13 | valid bpc    9.315
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  216 batches | lr 0.00030 | ms/batch 77.73 | loss  6.44 | ppl   628.49 
| epoch   2 |   200/  216 batches | lr 0.00030 | ms/batch 76.34 | loss  6.13 | ppl   457.81 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 17.12s | valid loss  5.85 | valid ppl   348.48 | valid bpc    8.445
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  216 batches | lr 0.00030 | ms/batch 77.79 | loss  5.87 | ppl   355.82 
| epoch   3 |   200/  216 batches | lr 0.00030 | ms/batch 76.49 | loss  5.65 | ppl   283.92 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 17.16s | valid loss  5.48 | valid ppl   240.70 | valid bpc    7.911
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  216 batches | lr 0.00030 | ms/batch 77.85 | loss  5.51 | ppl   247.44 
| epoch   4 |   200/  216 batches | lr 0.00030 | ms/batch 76.86 | loss  5.37 | ppl   213.86 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 17.18s | valid loss  5.28 | valid ppl   196.31 | valid bpc    7.617
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  216 batches | lr 0.00030 | ms/batch 77.97 | loss  5.27 | ppl   193.63 
| epoch   5 |   200/  216 batches | lr 0.00030 | ms/batch 76.85 | loss  5.14 | ppl   170.19 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 17.20s | valid loss  5.12 | valid ppl   166.59 | valid bpc    7.380
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  216 batches | lr 0.00030 | ms/batch 77.90 | loss  5.05 | ppl   156.80 
| epoch   6 |   200/  216 batches | lr 0.00030 | ms/batch 76.92 | loss  4.97 | ppl   144.53 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 17.20s | valid loss  4.98 | valid ppl   145.04 | valid bpc    7.180
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  216 batches | lr 0.00030 | ms/batch 77.88 | loss  4.90 | ppl   134.55 
| epoch   7 |   200/  216 batches | lr 0.00030 | ms/batch 77.11 | loss  4.84 | ppl   127.03 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 17.21s | valid loss  4.85 | valid ppl   127.54 | valid bpc    6.995
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  216 batches | lr 0.00030 | ms/batch 77.96 | loss  4.76 | ppl   116.76 
| epoch   8 |   200/  216 batches | lr 0.00030 | ms/batch 76.99 | loss  4.72 | ppl   112.00 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 17.21s | valid loss  4.77 | valid ppl   117.39 | valid bpc    6.875
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 8.0%
| epoch   9 |   100/  216 batches | lr 0.00030 | ms/batch 78.12 | loss  4.67 | ppl   106.90 
| epoch   9 |   200/  216 batches | lr 0.00030 | ms/batch 76.85 | loss  4.59 | ppl    98.21 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 17.22s | valid loss  4.76 | valid ppl   116.21 | valid bpc    6.861
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  216 batches | lr 0.00030 | ms/batch 77.75 | loss  4.54 | ppl    93.57 
| epoch  10 |   200/  216 batches | lr 0.00030 | ms/batch 77.16 | loss  4.49 | ppl    89.42 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 17.21s | valid loss  4.65 | valid ppl   104.18 | valid bpc    6.703
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  216 batches | lr 0.00030 | ms/batch 78.41 | loss  4.47 | ppl    87.64 
| epoch  11 |   200/  216 batches | lr 0.00030 | ms/batch 76.64 | loss  4.38 | ppl    79.59 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 17.22s | valid loss  4.60 | valid ppl    99.77 | valid bpc    6.641
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  216 batches | lr 0.00030 | ms/batch 78.39 | loss  4.34 | ppl    76.46 
| epoch  12 |   200/  216 batches | lr 0.00030 | ms/batch 76.66 | loss  4.33 | ppl    75.77 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 17.22s | valid loss  4.57 | valid ppl    96.50 | valid bpc    6.592
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 12.0%
| epoch  13 |   100/  216 batches | lr 0.00030 | ms/batch 77.71 | loss  4.26 | ppl    70.76 
| epoch  13 |   200/  216 batches | lr 0.00030 | ms/batch 77.38 | loss  4.24 | ppl    69.65 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 17.23s | valid loss  4.51 | valid ppl    91.24 | valid bpc    6.512
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 13.0%
| epoch  14 |   100/  216 batches | lr 0.00030 | ms/batch 78.11 | loss  4.20 | ppl    66.73 
| epoch  14 |   200/  216 batches | lr 0.00030 | ms/batch 77.02 | loss  4.15 | ppl    63.49 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 17.22s | valid loss  4.49 | valid ppl    89.09 | valid bpc    6.477
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  216 batches | lr 0.00030 | ms/batch 78.37 | loss  4.14 | ppl    62.58 
| epoch  15 |   200/  216 batches | lr 0.00030 | ms/batch 76.70 | loss  4.09 | ppl    59.86 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 17.21s | valid loss  4.44 | valid ppl    85.07 | valid bpc    6.411
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 15.0%
| epoch  16 |   100/  216 batches | lr 0.00030 | ms/batch 78.00 | loss  4.06 | ppl    58.26 
| epoch  16 |   200/  216 batches | lr 0.00030 | ms/batch 77.09 | loss  4.02 | ppl    55.84 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 17.23s | valid loss  4.42 | valid ppl    82.80 | valid bpc    6.371
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 16.0%
| epoch  17 |   100/  216 batches | lr 0.00030 | ms/batch 77.93 | loss  3.97 | ppl    53.22 
| epoch  17 |   200/  216 batches | lr 0.00030 | ms/batch 77.11 | loss  3.99 | ppl    53.87 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 17.22s | valid loss  4.42 | valid ppl    83.34 | valid bpc    6.381
-----------------------------------------------------------------------------------------
PROGRESS: 17.0%
| epoch  18 |   100/  216 batches | lr 0.00030 | ms/batch 77.77 | loss  3.93 | ppl    50.83 
| epoch  18 |   200/  216 batches | lr 0.00030 | ms/batch 77.17 | loss  3.92 | ppl    50.43 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 17.20s | valid loss  4.40 | valid ppl    81.15 | valid bpc    6.343
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 18.0%
| epoch  19 |   100/  216 batches | lr 0.00030 | ms/batch 78.29 | loss  3.88 | ppl    48.34 
| epoch  19 |   200/  216 batches | lr 0.00030 | ms/batch 76.66 | loss  3.85 | ppl    46.76 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 17.22s | valid loss  4.36 | valid ppl    78.47 | valid bpc    6.294
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 19.0%
| epoch  20 |   100/  216 batches | lr 0.00030 | ms/batch 78.33 | loss  3.82 | ppl    45.52 
| epoch  20 |   200/  216 batches | lr 0.00030 | ms/batch 76.66 | loss  3.79 | ppl    44.20 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 17.22s | valid loss  4.36 | valid ppl    77.97 | valid bpc    6.285
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 20.0%
| epoch  21 |   100/  216 batches | lr 0.00030 | ms/batch 78.00 | loss  3.78 | ppl    43.62 
| epoch  21 |   200/  216 batches | lr 0.00030 | ms/batch 77.08 | loss  3.75 | ppl    42.51 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 17.21s | valid loss  4.30 | valid ppl    73.73 | valid bpc    6.204
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 21.0%
| epoch  22 |   100/  216 batches | lr 0.00030 | ms/batch 78.18 | loss  3.69 | ppl    40.11 
| epoch  22 |   200/  216 batches | lr 0.00030 | ms/batch 76.88 | loss  3.68 | ppl    39.68 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 17.21s | valid loss  4.32 | valid ppl    75.10 | valid bpc    6.231
-----------------------------------------------------------------------------------------
PROGRESS: 22.0%
| epoch  23 |   100/  216 batches | lr 0.00030 | ms/batch 77.89 | loss  3.66 | ppl    38.89 
| epoch  23 |   200/  216 batches | lr 0.00030 | ms/batch 77.18 | loss  3.67 | ppl    39.06 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 17.22s | valid loss  4.30 | valid ppl    73.98 | valid bpc    6.209
-----------------------------------------------------------------------------------------
PROGRESS: 23.0%
| epoch  24 |   100/  216 batches | lr 0.00030 | ms/batch 78.15 | loss  3.64 | ppl    37.91 
| epoch  24 |   200/  216 batches | lr 0.00030 | ms/batch 76.76 | loss  3.59 | ppl    36.13 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 17.23s | valid loss  4.28 | valid ppl    72.53 | valid bpc    6.180
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 24.0%
| epoch  25 |   100/  216 batches | lr 0.00030 | ms/batch 77.93 | loss  3.55 | ppl    34.98 
| epoch  25 |   200/  216 batches | lr 0.00030 | ms/batch 77.18 | loss  3.56 | ppl    35.15 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 17.22s | valid loss  4.29 | valid ppl    72.84 | valid bpc    6.187
-----------------------------------------------------------------------------------------
PROGRESS: 25.0%
| epoch  26 |   100/  216 batches | lr 0.00030 | ms/batch 77.98 | loss  3.53 | ppl    34.20 
| epoch  26 |   200/  216 batches | lr 0.00030 | ms/batch 76.75 | loss  3.51 | ppl    33.29 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 17.22s | valid loss  4.30 | valid ppl    73.36 | valid bpc    6.197
-----------------------------------------------------------------------------------------
PROGRESS: 26.0%
| epoch  27 |   100/  216 batches | lr 0.00030 | ms/batch 78.37 | loss  3.50 | ppl    33.26 
| epoch  27 |   200/  216 batches | lr 0.00030 | ms/batch 76.72 | loss  3.47 | ppl    31.98 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 17.22s | valid loss  4.30 | valid ppl    73.79 | valid bpc    6.205
-----------------------------------------------------------------------------------------
PROGRESS: 27.0%
| epoch  28 |   100/  216 batches | lr 0.00015 | ms/batch 77.97 | loss  3.37 | ppl    29.09 
| epoch  28 |   200/  216 batches | lr 0.00015 | ms/batch 77.08 | loss  3.33 | ppl    27.92 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 17.23s | valid loss  4.27 | valid ppl    71.86 | valid bpc    6.167
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  216 batches | lr 0.00015 | ms/batch 78.13 | loss  3.32 | ppl    27.75 
| epoch  29 |   200/  216 batches | lr 0.00015 | ms/batch 76.92 | loss  3.30 | ppl    27.12 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 17.22s | valid loss  4.27 | valid ppl    71.39 | valid bpc    6.158
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  216 batches | lr 0.00015 | ms/batch 77.72 | loss  3.27 | ppl    26.37 
| epoch  30 |   200/  216 batches | lr 0.00015 | ms/batch 77.23 | loss  3.27 | ppl    26.20 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 17.22s | valid loss  4.25 | valid ppl    70.32 | valid bpc    6.136
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 30.0%
| epoch  31 |   100/  216 batches | lr 0.00015 | ms/batch 78.48 | loss  3.25 | ppl    25.70 
| epoch  31 |   200/  216 batches | lr 0.00015 | ms/batch 76.53 | loss  3.19 | ppl    24.20 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 17.22s | valid loss  4.26 | valid ppl    70.47 | valid bpc    6.139
-----------------------------------------------------------------------------------------
PROGRESS: 31.0%
| epoch  32 |   100/  216 batches | lr 0.00015 | ms/batch 77.85 | loss  3.21 | ppl    24.87 
| epoch  32 |   200/  216 batches | lr 0.00015 | ms/batch 77.13 | loss  3.20 | ppl    24.62 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 17.22s | valid loss  4.20 | valid ppl    66.97 | valid bpc    6.065
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 32.0%
| epoch  33 |   100/  216 batches | lr 0.00015 | ms/batch 78.11 | loss  3.17 | ppl    23.78 
| epoch  33 |   200/  216 batches | lr 0.00015 | ms/batch 76.88 | loss  3.17 | ppl    23.83 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 17.21s | valid loss  4.25 | valid ppl    70.24 | valid bpc    6.134
-----------------------------------------------------------------------------------------
PROGRESS: 33.0%
| epoch  34 |   100/  216 batches | lr 0.00015 | ms/batch 77.82 | loss  3.17 | ppl    23.74 
| epoch  34 |   200/  216 batches | lr 0.00015 | ms/batch 77.40 | loss  3.14 | ppl    23.05 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 17.23s | valid loss  4.24 | valid ppl    69.33 | valid bpc    6.115
-----------------------------------------------------------------------------------------
PROGRESS: 34.0%
| epoch  35 |   100/  216 batches | lr 0.00015 | ms/batch 77.80 | loss  3.14 | ppl    23.14 
| epoch  35 |   200/  216 batches | lr 0.00015 | ms/batch 77.23 | loss  3.11 | ppl    22.45 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 17.23s | valid loss  4.25 | valid ppl    69.98 | valid bpc    6.129
-----------------------------------------------------------------------------------------
PROGRESS: 35.0%
| epoch  36 |   100/  216 batches | lr 0.00007 | ms/batch 78.31 | loss  3.06 | ppl    21.38 
| epoch  36 |   200/  216 batches | lr 0.00007 | ms/batch 76.86 | loss  3.05 | ppl    21.14 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 17.23s | valid loss  4.23 | valid ppl    68.61 | valid bpc    6.100
-----------------------------------------------------------------------------------------
PROGRESS: 36.0%
| epoch  37 |   100/  216 batches | lr 0.00007 | ms/batch 78.40 | loss  3.07 | ppl    21.60 
| epoch  37 |   200/  216 batches | lr 0.00007 | ms/batch 76.76 | loss  3.02 | ppl    20.50 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 17.23s | valid loss  4.22 | valid ppl    68.33 | valid bpc    6.095
-----------------------------------------------------------------------------------------
PROGRESS: 37.0%
| epoch  38 |   100/  216 batches | lr 0.00007 | ms/batch 78.00 | loss  3.01 | ppl    20.20 
| epoch  38 |   200/  216 batches | lr 0.00007 | ms/batch 77.15 | loss  3.02 | ppl    20.54 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 17.23s | valid loss  4.23 | valid ppl    68.63 | valid bpc    6.101
-----------------------------------------------------------------------------------------
PROGRESS: 38.0%
| epoch  39 |   100/  216 batches | lr 0.00004 | ms/batch 77.69 | loss  2.98 | ppl    19.68 
| epoch  39 |   200/  216 batches | lr 0.00004 | ms/batch 76.88 | loss  2.97 | ppl    19.54 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 17.20s | valid loss  4.24 | valid ppl    69.28 | valid bpc    6.114
-----------------------------------------------------------------------------------------
PROGRESS: 39.0%
| epoch  40 |   100/  216 batches | lr 0.00004 | ms/batch 78.36 | loss  2.99 | ppl    19.96 
| epoch  40 |   200/  216 batches | lr 0.00004 | ms/batch 76.74 | loss  2.94 | ppl    18.87 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 17.22s | valid loss  4.20 | valid ppl    66.81 | valid bpc    6.062
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 40.0%
| epoch  41 |   100/  216 batches | lr 0.00004 | ms/batch 77.93 | loss  2.97 | ppl    19.51 
| epoch  41 |   200/  216 batches | lr 0.00004 | ms/batch 77.08 | loss  2.95 | ppl    19.15 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 17.22s | valid loss  4.22 | valid ppl    68.03 | valid bpc    6.088
-----------------------------------------------------------------------------------------
PROGRESS: 41.0%
| epoch  42 |   100/  216 batches | lr 0.00004 | ms/batch 78.15 | loss  2.93 | ppl    18.77 
| epoch  42 |   200/  216 batches | lr 0.00004 | ms/batch 76.50 | loss  2.95 | ppl    19.13 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 17.23s | valid loss  4.23 | valid ppl    68.73 | valid bpc    6.103
-----------------------------------------------------------------------------------------
PROGRESS: 42.0%
| epoch  43 |   100/  216 batches | lr 0.00004 | ms/batch 77.84 | loss  2.95 | ppl    19.03 
| epoch  43 |   200/  216 batches | lr 0.00004 | ms/batch 77.33 | loss  2.92 | ppl    18.49 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 17.22s | valid loss  4.23 | valid ppl    68.57 | valid bpc    6.099
-----------------------------------------------------------------------------------------
PROGRESS: 43.0%
| epoch  44 |   100/  216 batches | lr 0.00002 | ms/batch 78.52 | loss  2.92 | ppl    18.52 
| epoch  44 |   200/  216 batches | lr 0.00002 | ms/batch 76.66 | loss  2.91 | ppl    18.38 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 17.23s | valid loss  4.25 | valid ppl    70.20 | valid bpc    6.133
-----------------------------------------------------------------------------------------
PROGRESS: 44.0%
| epoch  45 |   100/  216 batches | lr 0.00002 | ms/batch 77.65 | loss  2.94 | ppl    18.88 
| epoch  45 |   200/  216 batches | lr 0.00002 | ms/batch 77.07 | loss  2.91 | ppl    18.34 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 17.20s | valid loss  4.26 | valid ppl    70.86 | valid bpc    6.147
-----------------------------------------------------------------------------------------
PROGRESS: 45.0%
| epoch  46 |   100/  216 batches | lr 0.00002 | ms/batch 77.82 | loss  2.92 | ppl    18.54 
| epoch  46 |   200/  216 batches | lr 0.00002 | ms/batch 76.93 | loss  2.89 | ppl    18.01 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 17.23s | valid loss  4.21 | valid ppl    67.55 | valid bpc    6.078
-----------------------------------------------------------------------------------------
PROGRESS: 46.0%
| epoch  47 |   100/  216 batches | lr 0.00001 | ms/batch 78.16 | loss  2.91 | ppl    18.35 
| epoch  47 |   200/  216 batches | lr 0.00001 | ms/batch 76.76 | loss  2.88 | ppl    17.82 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 17.23s | valid loss  4.24 | valid ppl    69.18 | valid bpc    6.112
-----------------------------------------------------------------------------------------
PROGRESS: 47.0%
| epoch  48 |   100/  216 batches | lr 0.00001 | ms/batch 78.43 | loss  2.92 | ppl    18.48 
| epoch  48 |   200/  216 batches | lr 0.00001 | ms/batch 76.42 | loss  2.87 | ppl    17.58 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 17.21s | valid loss  4.22 | valid ppl    68.13 | valid bpc    6.090
-----------------------------------------------------------------------------------------
PROGRESS: 48.0%
| epoch  49 |   100/  216 batches | lr 0.00001 | ms/batch 78.43 | loss  2.89 | ppl    17.96 
| epoch  49 |   200/  216 batches | lr 0.00001 | ms/batch 76.83 | loss  2.87 | ppl    17.55 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 17.23s | valid loss  4.26 | valid ppl    70.84 | valid bpc    6.146
-----------------------------------------------------------------------------------------
PROGRESS: 49.0%
| epoch  50 |   100/  216 batches | lr 0.00000 | ms/batch 78.19 | loss  2.90 | ppl    18.23 
| epoch  50 |   200/  216 batches | lr 0.00000 | ms/batch 77.43 | loss  2.86 | ppl    17.52 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 17.28s | valid loss  4.20 | valid ppl    66.72 | valid bpc    6.060
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 50.0%
| epoch  51 |   100/  216 batches | lr 0.00000 | ms/batch 78.30 | loss  2.88 | ppl    17.88 
| epoch  51 |   200/  216 batches | lr 0.00000 | ms/batch 76.77 | loss  2.86 | ppl    17.47 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 17.22s | valid loss  4.27 | valid ppl    71.36 | valid bpc    6.157
-----------------------------------------------------------------------------------------
PROGRESS: 51.0%
| epoch  52 |   100/  216 batches | lr 0.00000 | ms/batch 78.26 | loss  2.91 | ppl    18.40 
| epoch  52 |   200/  216 batches | lr 0.00000 | ms/batch 76.83 | loss  2.85 | ppl    17.29 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 17.22s | valid loss  4.24 | valid ppl    69.69 | valid bpc    6.123
-----------------------------------------------------------------------------------------
PROGRESS: 52.0%
| epoch  53 |   100/  216 batches | lr 0.00000 | ms/batch 78.01 | loss  2.90 | ppl    18.13 
| epoch  53 |   200/  216 batches | lr 0.00000 | ms/batch 77.00 | loss  2.87 | ppl    17.62 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 17.22s | valid loss  4.24 | valid ppl    69.27 | valid bpc    6.114
-----------------------------------------------------------------------------------------
PROGRESS: 53.0%
| epoch  54 |   100/  216 batches | lr 0.00000 | ms/batch 77.90 | loss  2.89 | ppl    18.03 
| epoch  54 |   200/  216 batches | lr 0.00000 | ms/batch 77.15 | loss  2.87 | ppl    17.70 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 17.22s | valid loss  4.23 | valid ppl    68.82 | valid bpc    6.105
-----------------------------------------------------------------------------------------
PROGRESS: 54.0%
| epoch  55 |   100/  216 batches | lr 0.00000 | ms/batch 78.28 | loss  2.89 | ppl    18.06 
| epoch  55 |   200/  216 batches | lr 0.00000 | ms/batch 76.70 | loss  2.87 | ppl    17.56 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 17.22s | valid loss  4.21 | valid ppl    67.64 | valid bpc    6.080
-----------------------------------------------------------------------------------------
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  216 batches | lr 0.00000 | ms/batch 78.07 | loss  2.90 | ppl    18.26 
| epoch  56 |   200/  216 batches | lr 0.00000 | ms/batch 77.13 | loss  2.83 | ppl    17.00 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 17.23s | valid loss  4.26 | valid ppl    70.61 | valid bpc    6.142
-----------------------------------------------------------------------------------------
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  216 batches | lr 0.00000 | ms/batch 77.96 | loss  2.88 | ppl    17.84 
| epoch  57 |   200/  216 batches | lr 0.00000 | ms/batch 77.10 | loss  2.87 | ppl    17.56 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 17.22s | valid loss  4.24 | valid ppl    69.23 | valid bpc    6.113
-----------------------------------------------------------------------------------------
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  216 batches | lr 0.00000 | ms/batch 78.10 | loss  2.90 | ppl    18.15 
| epoch  58 |   200/  216 batches | lr 0.00000 | ms/batch 76.79 | loss  2.85 | ppl    17.30 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 17.20s | valid loss  4.22 | valid ppl    68.12 | valid bpc    6.090
-----------------------------------------------------------------------------------------
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  216 batches | lr 0.00000 | ms/batch 78.20 | loss  2.91 | ppl    18.32 
| epoch  59 |   200/  216 batches | lr 0.00000 | ms/batch 76.43 | loss  2.85 | ppl    17.33 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 17.20s | valid loss  4.24 | valid ppl    69.41 | valid bpc    6.117
-----------------------------------------------------------------------------------------
PROGRESS: 59.0%
| epoch  60 |   100/  216 batches | lr 0.00000 | ms/batch 77.89 | loss  2.87 | ppl    17.72 
| epoch  60 |   200/  216 batches | lr 0.00000 | ms/batch 77.13 | loss  2.87 | ppl    17.58 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 17.22s | valid loss  4.29 | valid ppl    72.72 | valid bpc    6.184
-----------------------------------------------------------------------------------------
PROGRESS: 60.0%
| epoch  61 |   100/  216 batches | lr 0.00000 | ms/batch 78.34 | loss  2.90 | ppl    18.12 
| epoch  61 |   200/  216 batches | lr 0.00000 | ms/batch 76.57 | loss  2.85 | ppl    17.24 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 17.20s | valid loss  4.19 | valid ppl    66.25 | valid bpc    6.050
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 61.0%
| epoch  62 |   100/  216 batches | lr 0.00000 | ms/batch 78.15 | loss  2.88 | ppl    17.79 
| epoch  62 |   200/  216 batches | lr 0.00000 | ms/batch 76.75 | loss  2.85 | ppl    17.33 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 17.21s | valid loss  4.30 | valid ppl    73.88 | valid bpc    6.207
-----------------------------------------------------------------------------------------
PROGRESS: 62.0%
| epoch  63 |   100/  216 batches | lr 0.00000 | ms/batch 77.72 | loss  2.90 | ppl    18.12 
| epoch  63 |   200/  216 batches | lr 0.00000 | ms/batch 77.23 | loss  2.86 | ppl    17.42 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 17.20s | valid loss  4.21 | valid ppl    67.48 | valid bpc    6.076
-----------------------------------------------------------------------------------------
PROGRESS: 63.0%
| epoch  64 |   100/  216 batches | lr 0.00000 | ms/batch 78.12 | loss  2.88 | ppl    17.80 
| epoch  64 |   200/  216 batches | lr 0.00000 | ms/batch 76.88 | loss  2.86 | ppl    17.54 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 17.22s | valid loss  4.25 | valid ppl    69.80 | valid bpc    6.125
-----------------------------------------------------------------------------------------
PROGRESS: 64.0%
| epoch  65 |   100/  216 batches | lr 0.00000 | ms/batch 78.52 | loss  2.87 | ppl    17.64 
| epoch  65 |   200/  216 batches | lr 0.00000 | ms/batch 76.51 | loss  2.85 | ppl    17.25 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 17.22s | valid loss  4.28 | valid ppl    72.40 | valid bpc    6.178
-----------------------------------------------------------------------------------------
PROGRESS: 65.0%
| epoch  66 |   100/  216 batches | lr 0.00000 | ms/batch 78.36 | loss  2.88 | ppl    17.79 
| epoch  66 |   200/  216 batches | lr 0.00000 | ms/batch 76.62 | loss  2.84 | ppl    17.09 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 17.20s | valid loss  4.22 | valid ppl    68.04 | valid bpc    6.088
-----------------------------------------------------------------------------------------
PROGRESS: 66.0%
| epoch  67 |   100/  216 batches | lr 0.00000 | ms/batch 78.35 | loss  2.88 | ppl    17.82 
| epoch  67 |   200/  216 batches | lr 0.00000 | ms/batch 76.59 | loss  2.86 | ppl    17.52 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 17.22s | valid loss  4.23 | valid ppl    68.69 | valid bpc    6.102
-----------------------------------------------------------------------------------------
PROGRESS: 67.0%
| epoch  68 |   100/  216 batches | lr 0.00000 | ms/batch 77.97 | loss  2.88 | ppl    17.76 
| epoch  68 |   200/  216 batches | lr 0.00000 | ms/batch 77.09 | loss  2.87 | ppl    17.57 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 17.22s | valid loss  4.27 | valid ppl    71.67 | valid bpc    6.163
-----------------------------------------------------------------------------------------
PROGRESS: 68.0%
| epoch  69 |   100/  216 batches | lr 0.00000 | ms/batch 77.76 | loss  2.89 | ppl    18.06 
| epoch  69 |   200/  216 batches | lr 0.00000 | ms/batch 77.22 | loss  2.87 | ppl    17.56 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 17.21s | valid loss  4.24 | valid ppl    69.08 | valid bpc    6.110
-----------------------------------------------------------------------------------------
PROGRESS: 69.0%
| epoch  70 |   100/  216 batches | lr 0.00000 | ms/batch 77.84 | loss  2.88 | ppl    17.82 
| epoch  70 |   200/  216 batches | lr 0.00000 | ms/batch 76.85 | loss  2.87 | ppl    17.70 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 17.22s | valid loss  4.20 | valid ppl    66.95 | valid bpc    6.065
-----------------------------------------------------------------------------------------
PROGRESS: 70.0%
| epoch  71 |   100/  216 batches | lr 0.00000 | ms/batch 78.16 | loss  2.89 | ppl    17.97 
| epoch  71 |   200/  216 batches | lr 0.00000 | ms/batch 76.76 | loss  2.85 | ppl    17.31 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 17.21s | valid loss  4.23 | valid ppl    68.69 | valid bpc    6.102
-----------------------------------------------------------------------------------------
PROGRESS: 71.0%
| epoch  72 |   100/  216 batches | lr 0.00000 | ms/batch 78.03 | loss  2.87 | ppl    17.60 
| epoch  72 |   200/  216 batches | lr 0.00000 | ms/batch 76.96 | loss  2.85 | ppl    17.31 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 17.22s | valid loss  4.26 | valid ppl    70.52 | valid bpc    6.140
-----------------------------------------------------------------------------------------
PROGRESS: 72.0%
| epoch  73 |   100/  216 batches | lr 0.00000 | ms/batch 78.34 | loss  2.90 | ppl    18.11 
| epoch  73 |   200/  216 batches | lr 0.00000 | ms/batch 76.54 | loss  2.84 | ppl    17.04 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 17.22s | valid loss  4.24 | valid ppl    69.38 | valid bpc    6.116
-----------------------------------------------------------------------------------------
PROGRESS: 73.0%
| epoch  74 |   100/  216 batches | lr 0.00000 | ms/batch 77.61 | loss  2.88 | ppl    17.86 
| epoch  74 |   200/  216 batches | lr 0.00000 | ms/batch 77.22 | loss  2.85 | ppl    17.37 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 17.20s | valid loss  4.20 | valid ppl    66.84 | valid bpc    6.063
-----------------------------------------------------------------------------------------
PROGRESS: 74.0%
| epoch  75 |   100/  216 batches | lr 0.00000 | ms/batch 77.73 | loss  2.87 | ppl    17.61 
| epoch  75 |   200/  216 batches | lr 0.00000 | ms/batch 77.34 | loss  2.86 | ppl    17.45 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 17.22s | valid loss  4.26 | valid ppl    70.80 | valid bpc    6.146
-----------------------------------------------------------------------------------------
PROGRESS: 75.0%
| epoch  76 |   100/  216 batches | lr 0.00000 | ms/batch 77.95 | loss  2.87 | ppl    17.61 
| epoch  76 |   200/  216 batches | lr 0.00000 | ms/batch 77.10 | loss  2.86 | ppl    17.43 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 17.22s | valid loss  4.22 | valid ppl    68.09 | valid bpc    6.089
-----------------------------------------------------------------------------------------
PROGRESS: 76.0%
| epoch  77 |   100/  216 batches | lr 0.00000 | ms/batch 78.07 | loss  2.89 | ppl    17.92 
| epoch  77 |   200/  216 batches | lr 0.00000 | ms/batch 77.01 | loss  2.85 | ppl    17.23 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 17.22s | valid loss  4.21 | valid ppl    67.13 | valid bpc    6.069
-----------------------------------------------------------------------------------------
PROGRESS: 77.0%
| epoch  78 |   100/  216 batches | lr 0.00000 | ms/batch 78.09 | loss  2.88 | ppl    17.89 
| epoch  78 |   200/  216 batches | lr 0.00000 | ms/batch 76.74 | loss  2.88 | ppl    17.82 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 17.20s | valid loss  4.28 | valid ppl    72.47 | valid bpc    6.179
-----------------------------------------------------------------------------------------
PROGRESS: 78.0%
| epoch  79 |   100/  216 batches | lr 0.00000 | ms/batch 77.69 | loss  2.88 | ppl    17.85 
| epoch  79 |   200/  216 batches | lr 0.00000 | ms/batch 76.85 | loss  2.86 | ppl    17.46 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 17.20s | valid loss  4.27 | valid ppl    71.54 | valid bpc    6.161
-----------------------------------------------------------------------------------------
PROGRESS: 79.0%
| epoch  80 |   100/  216 batches | lr 0.00000 | ms/batch 78.34 | loss  2.89 | ppl    18.04 
| epoch  80 |   200/  216 batches | lr 0.00000 | ms/batch 76.86 | loss  2.86 | ppl    17.49 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 17.23s | valid loss  4.22 | valid ppl    68.24 | valid bpc    6.093
-----------------------------------------------------------------------------------------
PROGRESS: 80.0%
| epoch  81 |   100/  216 batches | lr 0.00000 | ms/batch 78.16 | loss  2.88 | ppl    17.89 
| epoch  81 |   200/  216 batches | lr 0.00000 | ms/batch 76.86 | loss  2.85 | ppl    17.27 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 17.22s | valid loss  4.22 | valid ppl    67.81 | valid bpc    6.083
-----------------------------------------------------------------------------------------
PROGRESS: 81.0%
| epoch  82 |   100/  216 batches | lr 0.00000 | ms/batch 77.80 | loss  2.89 | ppl    18.05 
| epoch  82 |   200/  216 batches | lr 0.00000 | ms/batch 77.35 | loss  2.85 | ppl    17.26 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 17.22s | valid loss  4.22 | valid ppl    67.86 | valid bpc    6.084
-----------------------------------------------------------------------------------------
PROGRESS: 82.0%
| epoch  83 |   100/  216 batches | lr 0.00000 | ms/batch 77.95 | loss  2.89 | ppl    17.96 
| epoch  83 |   200/  216 batches | lr 0.00000 | ms/batch 77.04 | loss  2.86 | ppl    17.42 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 17.21s | valid loss  4.26 | valid ppl    70.63 | valid bpc    6.142
-----------------------------------------------------------------------------------------
PROGRESS: 83.0%
| epoch  84 |   100/  216 batches | lr 0.00000 | ms/batch 78.43 | loss  2.87 | ppl    17.56 
| epoch  84 |   200/  216 batches | lr 0.00000 | ms/batch 76.61 | loss  2.85 | ppl    17.25 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 17.22s | valid loss  4.22 | valid ppl    67.77 | valid bpc    6.083
-----------------------------------------------------------------------------------------
PROGRESS: 84.0%
| epoch  85 |   100/  216 batches | lr 0.00000 | ms/batch 77.87 | loss  2.88 | ppl    17.76 
| epoch  85 |   200/  216 batches | lr 0.00000 | ms/batch 76.71 | loss  2.84 | ppl    17.09 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 17.20s | valid loss  4.25 | valid ppl    70.09 | valid bpc    6.131
-----------------------------------------------------------------------------------------
PROGRESS: 85.0%
| epoch  86 |   100/  216 batches | lr 0.00000 | ms/batch 77.88 | loss  2.88 | ppl    17.76 
| epoch  86 |   200/  216 batches | lr 0.00000 | ms/batch 76.67 | loss  2.85 | ppl    17.37 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 17.20s | valid loss  4.24 | valid ppl    69.41 | valid bpc    6.117
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  216 batches | lr 0.00000 | ms/batch 77.80 | loss  2.88 | ppl    17.75 
| epoch  87 |   200/  216 batches | lr 0.00000 | ms/batch 77.02 | loss  2.87 | ppl    17.57 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 17.22s | valid loss  4.24 | valid ppl    69.24 | valid bpc    6.114
-----------------------------------------------------------------------------------------
PROGRESS: 87.0%
| epoch  88 |   100/  216 batches | lr 0.00000 | ms/batch 77.64 | loss  2.89 | ppl    17.96 
| epoch  88 |   200/  216 batches | lr 0.00000 | ms/batch 77.38 | loss  2.84 | ppl    17.17 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 17.21s | valid loss  4.23 | valid ppl    68.57 | valid bpc    6.099
-----------------------------------------------------------------------------------------
PROGRESS: 88.0%
| epoch  89 |   100/  216 batches | lr 0.00000 | ms/batch 77.81 | loss  2.87 | ppl    17.70 
| epoch  89 |   200/  216 batches | lr 0.00000 | ms/batch 77.01 | loss  2.86 | ppl    17.41 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 17.22s | valid loss  4.21 | valid ppl    67.07 | valid bpc    6.068
-----------------------------------------------------------------------------------------
PROGRESS: 89.0%
| epoch  90 |   100/  216 batches | lr 0.00000 | ms/batch 78.35 | loss  2.88 | ppl    17.82 
| epoch  90 |   200/  216 batches | lr 0.00000 | ms/batch 76.61 | loss  2.86 | ppl    17.55 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 17.21s | valid loss  4.25 | valid ppl    69.95 | valid bpc    6.128
-----------------------------------------------------------------------------------------
PROGRESS: 90.0%
| epoch  91 |   100/  216 batches | lr 0.00000 | ms/batch 77.69 | loss  2.90 | ppl    18.15 
| epoch  91 |   200/  216 batches | lr 0.00000 | ms/batch 77.01 | loss  2.85 | ppl    17.24 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 17.21s | valid loss  4.25 | valid ppl    70.24 | valid bpc    6.134
-----------------------------------------------------------------------------------------
PROGRESS: 91.0%
| epoch  92 |   100/  216 batches | lr 0.00000 | ms/batch 77.73 | loss  2.89 | ppl    18.00 
| epoch  92 |   200/  216 batches | lr 0.00000 | ms/batch 77.19 | loss  2.83 | ppl    17.01 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 17.21s | valid loss  4.20 | valid ppl    66.83 | valid bpc    6.062
-----------------------------------------------------------------------------------------
PROGRESS: 92.0%
| epoch  93 |   100/  216 batches | lr 0.00000 | ms/batch 77.88 | loss  2.89 | ppl    17.98 
| epoch  93 |   200/  216 batches | lr 0.00000 | ms/batch 77.13 | loss  2.86 | ppl    17.53 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 17.22s | valid loss  4.28 | valid ppl    72.59 | valid bpc    6.182
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  216 batches | lr 0.00000 | ms/batch 78.07 | loss  2.89 | ppl    18.02 
| epoch  94 |   200/  216 batches | lr 0.00000 | ms/batch 76.69 | loss  2.86 | ppl    17.52 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 17.20s | valid loss  4.22 | valid ppl    68.37 | valid bpc    6.095
-----------------------------------------------------------------------------------------
PROGRESS: 94.0%
| epoch  95 |   100/  216 batches | lr 0.00000 | ms/batch 78.13 | loss  2.90 | ppl    18.25 
| epoch  95 |   200/  216 batches | lr 0.00000 | ms/batch 77.01 | loss  2.84 | ppl    17.11 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 17.22s | valid loss  4.21 | valid ppl    67.65 | valid bpc    6.080
-----------------------------------------------------------------------------------------
PROGRESS: 95.0%
| epoch  96 |   100/  216 batches | lr 0.00000 | ms/batch 78.12 | loss  2.85 | ppl    17.34 
| epoch  96 |   200/  216 batches | lr 0.00000 | ms/batch 76.93 | loss  2.89 | ppl    17.91 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 17.22s | valid loss  4.22 | valid ppl    68.31 | valid bpc    6.094
-----------------------------------------------------------------------------------------
PROGRESS: 96.0%
| epoch  97 |   100/  216 batches | lr 0.00000 | ms/batch 77.77 | loss  2.87 | ppl    17.68 
| epoch  97 |   200/  216 batches | lr 0.00000 | ms/batch 77.15 | loss  2.87 | ppl    17.55 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 17.21s | valid loss  4.25 | valid ppl    70.33 | valid bpc    6.136
-----------------------------------------------------------------------------------------
PROGRESS: 97.0%
| epoch  98 |   100/  216 batches | lr 0.00000 | ms/batch 78.57 | loss  2.88 | ppl    17.79 
| epoch  98 |   200/  216 batches | lr 0.00000 | ms/batch 76.55 | loss  2.87 | ppl    17.62 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 17.22s | valid loss  4.23 | valid ppl    68.58 | valid bpc    6.100
-----------------------------------------------------------------------------------------
PROGRESS: 98.0%
| epoch  99 |   100/  216 batches | lr 0.00000 | ms/batch 78.07 | loss  2.87 | ppl    17.72 
| epoch  99 |   200/  216 batches | lr 0.00000 | ms/batch 76.77 | loss  2.87 | ppl    17.66 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 17.22s | valid loss  4.24 | valid ppl    69.52 | valid bpc    6.119
-----------------------------------------------------------------------------------------
PROGRESS: 99.0%
| epoch 100 |   100/  216 batches | lr 0.00000 | ms/batch 77.92 | loss  2.87 | ppl    17.62 
| epoch 100 |   200/  216 batches | lr 0.00000 | ms/batch 76.97 | loss  2.88 | ppl    17.88 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 17.21s | valid loss  4.24 | valid ppl    69.68 | valid bpc    6.123
-----------------------------------------------------------------------------------------
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  4.20 | test ppl    66.41 | test bpc    6.053
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.4216, Mean Reca: 0.5815, Mean F1: 0.4806
Counter({'NP': 9037, 'PP': 4101, 'S': 3384, 'VP': 2575, 'SBAR': 565, 'ADJP': 326, 'QP': 261, 'ADVP': 175, 'SINV': 150, 'PRN': 50, 'FRAG': 35, 'WHNP': 29, 'NX': 14, 'SQ': 14, 'WHPP': 11, 'NAC': 11, 'UCP': 11, 'CONJP': 10, 'SBARQ': 9, 'WHADVP': 3, 'X': 3, 'WHADJP': 1})
Counter({'NP': 14432, 'VP': 8130, 'S': 5620, 'PP': 5484, 'SBAR': 1796, 'ADJP': 649, 'QP': 490, 'ADVP': 286, 'SINV': 157, 'PRN': 128, 'NX': 95, 'FRAG': 42, 'WHNP': 37, 'UCP': 32, 'NAC': 30, 'WHPP': 25, 'CONJP': 21, 'SQ': 18, 'SBARQ': 10, 'WHADVP': 9, 'X': 6, 'WHADJP': 4, 'INTJ': 1})
SBAR: 0.3146
NP: 0.6262
VP: 0.3167
PP: 0.7478
ADJP: 0.5023
ADVP: 0.6119
4.906029032061413
-----------------------------------------------------------------------------------------
Dependency parsing performance:
Conll-U Style:
DDA: 0.402
UDA: 0.556
=========================================================================================
Loading dataset...
Loading dictionary...
Number of tokens:  10001
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer_in_parser', nhid=512, nlayers=8, front_layers=1, rear_layers=7, n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=5555, nonmono=5, cuda=True, log_interval=100, save='trained_models/structformer_in_parser_5555_17.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 38475653
Model architecture: StructFormer_In_Parser(
  (transformer_front): Transformer_Front(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(10001, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0): TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
  (transformer_rear): Transformer_Rear(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(10001, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-6): 7 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (output_layer): Linear(in_features=512, out_features=10001, bias=True)
  )
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  216 batches | lr 0.00030 | ms/batch 81.01 | loss  7.27 | ppl  1429.72 
| epoch   1 |   200/  216 batches | lr 0.00030 | ms/batch 75.91 | loss  6.78 | ppl   879.75 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 17.38s | valid loss  6.48 | valid ppl   652.32 | valid bpc    9.349
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  216 batches | lr 0.00030 | ms/batch 77.86 | loss  6.49 | ppl   658.79 
| epoch   2 |   200/  216 batches | lr 0.00030 | ms/batch 76.09 | loss  6.08 | ppl   437.13 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 17.11s | valid loss  5.88 | valid ppl   357.83 | valid bpc    8.483
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  216 batches | lr 0.00030 | ms/batch 77.73 | loss  5.85 | ppl   347.13 
| epoch   3 |   200/  216 batches | lr 0.00030 | ms/batch 76.72 | loss  5.67 | ppl   288.82 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 17.16s | valid loss  5.49 | valid ppl   242.76 | valid bpc    7.923
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  216 batches | lr 0.00030 | ms/batch 77.75 | loss  5.47 | ppl   236.65 
| epoch   4 |   200/  216 batches | lr 0.00030 | ms/batch 76.87 | loss  5.35 | ppl   210.37 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 17.18s | valid loss  5.22 | valid ppl   185.51 | valid bpc    7.535
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  216 batches | lr 0.00030 | ms/batch 78.31 | loss  5.25 | ppl   190.91 
| epoch   5 |   200/  216 batches | lr 0.00030 | ms/batch 76.47 | loss  5.11 | ppl   165.68 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 17.19s | valid loss  5.11 | valid ppl   166.15 | valid bpc    7.376
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  216 batches | lr 0.00030 | ms/batch 78.34 | loss  5.05 | ppl   156.32 
| epoch   6 |   200/  216 batches | lr 0.00030 | ms/batch 76.64 | loss  4.99 | ppl   146.40 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 17.21s | valid loss  4.99 | valid ppl   146.83 | valid bpc    7.198
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  216 batches | lr 0.00030 | ms/batch 78.42 | loss  4.92 | ppl   137.09 
| epoch   7 |   200/  216 batches | lr 0.00030 | ms/batch 76.55 | loss  4.80 | ppl   121.33 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 17.21s | valid loss  4.88 | valid ppl   131.56 | valid bpc    7.040
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  216 batches | lr 0.00030 | ms/batch 77.67 | loss  4.75 | ppl   116.15 
| epoch   8 |   200/  216 batches | lr 0.00030 | ms/batch 77.37 | loss  4.69 | ppl   108.68 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 17.21s | valid loss  4.81 | valid ppl   122.59 | valid bpc    6.938
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 8.0%
| epoch   9 |   100/  216 batches | lr 0.00030 | ms/batch 78.33 | loss  4.67 | ppl   106.71 
| epoch   9 |   200/  216 batches | lr 0.00030 | ms/batch 76.59 | loss  4.57 | ppl    96.99 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 17.21s | valid loss  4.69 | valid ppl   108.69 | valid bpc    6.764
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  216 batches | lr 0.00030 | ms/batch 77.83 | loss  4.54 | ppl    93.69 
| epoch  10 |   200/  216 batches | lr 0.00030 | ms/batch 77.14 | loss  4.48 | ppl    87.97 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 17.21s | valid loss  4.66 | valid ppl   105.47 | valid bpc    6.721
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  216 batches | lr 0.00030 | ms/batch 78.29 | loss  4.43 | ppl    84.00 
| epoch  11 |   200/  216 batches | lr 0.00030 | ms/batch 76.76 | loss  4.40 | ppl    81.79 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 17.22s | valid loss  4.58 | valid ppl    97.18 | valid bpc    6.603
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  216 batches | lr 0.00030 | ms/batch 78.00 | loss  4.35 | ppl    77.17 
| epoch  12 |   200/  216 batches | lr 0.00030 | ms/batch 76.99 | loss  4.31 | ppl    74.45 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 17.22s | valid loss  4.56 | valid ppl    95.11 | valid bpc    6.572
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 12.0%
| epoch  13 |   100/  216 batches | lr 0.00030 | ms/batch 78.36 | loss  4.24 | ppl    69.36 
| epoch  13 |   200/  216 batches | lr 0.00030 | ms/batch 76.62 | loss  4.25 | ppl    69.83 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 17.22s | valid loss  4.52 | valid ppl    91.74 | valid bpc    6.519
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 13.0%
| epoch  14 |   100/  216 batches | lr 0.00030 | ms/batch 78.21 | loss  4.19 | ppl    66.26 
| epoch  14 |   200/  216 batches | lr 0.00030 | ms/batch 76.79 | loss  4.16 | ppl    64.20 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 17.22s | valid loss  4.49 | valid ppl    89.22 | valid bpc    6.479
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  216 batches | lr 0.00030 | ms/batch 77.73 | loss  4.11 | ppl    60.75 
| epoch  15 |   200/  216 batches | lr 0.00030 | ms/batch 77.06 | loss  4.12 | ppl    61.26 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 17.22s | valid loss  4.44 | valid ppl    84.74 | valid bpc    6.405
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 15.0%
| epoch  16 |   100/  216 batches | lr 0.00030 | ms/batch 78.57 | loss  4.06 | ppl    57.99 
| epoch  16 |   200/  216 batches | lr 0.00030 | ms/batch 76.68 | loss  4.02 | ppl    55.94 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 17.23s | valid loss  4.45 | valid ppl    85.22 | valid bpc    6.413
-----------------------------------------------------------------------------------------
PROGRESS: 16.0%
| epoch  17 |   100/  216 batches | lr 0.00030 | ms/batch 78.44 | loss  3.98 | ppl    53.63 
| epoch  17 |   200/  216 batches | lr 0.00030 | ms/batch 76.56 | loss  3.98 | ppl    53.55 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 17.23s | valid loss  4.41 | valid ppl    82.15 | valid bpc    6.360
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 17.0%
| epoch  18 |   100/  216 batches | lr 0.00030 | ms/batch 77.96 | loss  3.92 | ppl    50.43 
| epoch  18 |   200/  216 batches | lr 0.00030 | ms/batch 76.75 | loss  3.93 | ppl    51.11 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 17.22s | valid loss  4.38 | valid ppl    79.52 | valid bpc    6.313
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 18.0%
| epoch  19 |   100/  216 batches | lr 0.00030 | ms/batch 78.35 | loss  3.90 | ppl    49.26 
| epoch  19 |   200/  216 batches | lr 0.00030 | ms/batch 76.71 | loss  3.82 | ppl    45.73 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 17.22s | valid loss  4.40 | valid ppl    81.52 | valid bpc    6.349
-----------------------------------------------------------------------------------------
PROGRESS: 19.0%
| epoch  20 |   100/  216 batches | lr 0.00030 | ms/batch 78.20 | loss  3.83 | ppl    46.01 
| epoch  20 |   200/  216 batches | lr 0.00030 | ms/batch 76.81 | loss  3.78 | ppl    43.65 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 17.20s | valid loss  4.39 | valid ppl    80.39 | valid bpc    6.329
-----------------------------------------------------------------------------------------
PROGRESS: 20.0%
| epoch  21 |   100/  216 batches | lr 0.00030 | ms/batch 77.69 | loss  3.78 | ppl    43.68 
| epoch  21 |   200/  216 batches | lr 0.00030 | ms/batch 76.96 | loss  3.74 | ppl    42.17 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 17.21s | valid loss  4.39 | valid ppl    80.55 | valid bpc    6.332
-----------------------------------------------------------------------------------------
PROGRESS: 21.0%
| epoch  22 |   100/  216 batches | lr 0.00015 | ms/batch 78.31 | loss  3.66 | ppl    38.89 
| epoch  22 |   200/  216 batches | lr 0.00015 | ms/batch 76.77 | loss  3.63 | ppl    37.53 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 17.22s | valid loss  4.28 | valid ppl    72.08 | valid bpc    6.172
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 22.0%
| epoch  23 |   100/  216 batches | lr 0.00015 | ms/batch 78.17 | loss  3.58 | ppl    35.87 
| epoch  23 |   200/  216 batches | lr 0.00015 | ms/batch 76.94 | loss  3.59 | ppl    36.08 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 17.22s | valid loss  4.29 | valid ppl    73.19 | valid bpc    6.193
-----------------------------------------------------------------------------------------
PROGRESS: 23.0%
| epoch  24 |   100/  216 batches | lr 0.00015 | ms/batch 77.82 | loss  3.56 | ppl    35.23 
| epoch  24 |   200/  216 batches | lr 0.00015 | ms/batch 77.29 | loss  3.53 | ppl    33.98 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 17.22s | valid loss  4.31 | valid ppl    74.54 | valid bpc    6.220
-----------------------------------------------------------------------------------------
PROGRESS: 24.0%
| epoch  25 |   100/  216 batches | lr 0.00015 | ms/batch 78.24 | loss  3.53 | ppl    34.20 
| epoch  25 |   200/  216 batches | lr 0.00015 | ms/batch 76.64 | loss  3.49 | ppl    32.71 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 17.22s | valid loss  4.24 | valid ppl    69.45 | valid bpc    6.118
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 25.0%
| epoch  26 |   100/  216 batches | lr 0.00015 | ms/batch 78.35 | loss  3.46 | ppl    31.91 
| epoch  26 |   200/  216 batches | lr 0.00015 | ms/batch 76.68 | loss  3.47 | ppl    31.99 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 17.22s | valid loss  4.27 | valid ppl    71.47 | valid bpc    6.159
-----------------------------------------------------------------------------------------
PROGRESS: 26.0%
| epoch  27 |   100/  216 batches | lr 0.00015 | ms/batch 77.94 | loss  3.45 | ppl    31.52 
| epoch  27 |   200/  216 batches | lr 0.00015 | ms/batch 77.21 | loss  3.43 | ppl    30.84 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 17.22s | valid loss  4.23 | valid ppl    68.95 | valid bpc    6.107
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 27.0%
| epoch  28 |   100/  216 batches | lr 0.00015 | ms/batch 78.30 | loss  3.42 | ppl    30.55 
| epoch  28 |   200/  216 batches | lr 0.00015 | ms/batch 76.79 | loss  3.41 | ppl    30.15 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 17.22s | valid loss  4.25 | valid ppl    69.78 | valid bpc    6.125
-----------------------------------------------------------------------------------------
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  216 batches | lr 0.00015 | ms/batch 78.31 | loss  3.38 | ppl    29.46 
| epoch  29 |   200/  216 batches | lr 0.00015 | ms/batch 76.75 | loss  3.38 | ppl    29.36 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 17.22s | valid loss  4.28 | valid ppl    72.40 | valid bpc    6.178
-----------------------------------------------------------------------------------------
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  216 batches | lr 0.00015 | ms/batch 78.08 | loss  3.36 | ppl    28.91 
| epoch  30 |   200/  216 batches | lr 0.00015 | ms/batch 77.02 | loss  3.33 | ppl    27.83 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 17.22s | valid loss  4.23 | valid ppl    69.00 | valid bpc    6.108
-----------------------------------------------------------------------------------------
PROGRESS: 30.0%
| epoch  31 |   100/  216 batches | lr 0.00007 | ms/batch 77.85 | loss  3.28 | ppl    26.45 
| epoch  31 |   200/  216 batches | lr 0.00007 | ms/batch 77.19 | loss  3.30 | ppl    27.10 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 17.22s | valid loss  4.19 | valid ppl    66.31 | valid bpc    6.051
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 31.0%
| epoch  32 |   100/  216 batches | lr 0.00007 | ms/batch 78.01 | loss  3.28 | ppl    26.52 
| epoch  32 |   200/  216 batches | lr 0.00007 | ms/batch 77.27 | loss  3.25 | ppl    25.82 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 17.23s | valid loss  4.20 | valid ppl    66.86 | valid bpc    6.063
-----------------------------------------------------------------------------------------
PROGRESS: 32.0%
| epoch  33 |   100/  216 batches | lr 0.00007 | ms/batch 78.32 | loss  3.23 | ppl    25.30 
| epoch  33 |   200/  216 batches | lr 0.00007 | ms/batch 76.69 | loss  3.24 | ppl    25.44 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 17.22s | valid loss  4.23 | valid ppl    68.62 | valid bpc    6.101
-----------------------------------------------------------------------------------------
PROGRESS: 33.0%
| epoch  34 |   100/  216 batches | lr 0.00007 | ms/batch 78.33 | loss  3.24 | ppl    25.41 
| epoch  34 |   200/  216 batches | lr 0.00007 | ms/batch 76.78 | loss  3.19 | ppl    24.39 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 17.23s | valid loss  4.22 | valid ppl    67.81 | valid bpc    6.084
-----------------------------------------------------------------------------------------
PROGRESS: 34.0%
| epoch  35 |   100/  216 batches | lr 0.00004 | ms/batch 77.66 | loss  3.20 | ppl    24.60 
| epoch  35 |   200/  216 batches | lr 0.00004 | ms/batch 77.25 | loss  3.17 | ppl    23.77 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 17.21s | valid loss  4.19 | valid ppl    65.87 | valid bpc    6.042
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 35.0%
| epoch  36 |   100/  216 batches | lr 0.00004 | ms/batch 77.62 | loss  3.18 | ppl    24.13 
| epoch  36 |   200/  216 batches | lr 0.00004 | ms/batch 77.20 | loss  3.15 | ppl    23.34 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 17.21s | valid loss  4.22 | valid ppl    67.92 | valid bpc    6.086
-----------------------------------------------------------------------------------------
PROGRESS: 36.0%
| epoch  37 |   100/  216 batches | lr 0.00004 | ms/batch 78.27 | loss  3.17 | ppl    23.89 
| epoch  37 |   200/  216 batches | lr 0.00004 | ms/batch 76.79 | loss  3.15 | ppl    23.23 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 17.22s | valid loss  4.25 | valid ppl    69.79 | valid bpc    6.125
-----------------------------------------------------------------------------------------
PROGRESS: 37.0%
| epoch  38 |   100/  216 batches | lr 0.00004 | ms/batch 78.19 | loss  3.17 | ppl    23.72 
| epoch  38 |   200/  216 batches | lr 0.00004 | ms/batch 76.57 | loss  3.13 | ppl    22.85 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 17.23s | valid loss  4.17 | valid ppl    64.88 | valid bpc    6.020
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 38.0%
| epoch  39 |   100/  216 batches | lr 0.00004 | ms/batch 77.55 | loss  3.15 | ppl    23.43 
| epoch  39 |   200/  216 batches | lr 0.00004 | ms/batch 77.56 | loss  3.11 | ppl    22.47 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 17.23s | valid loss  4.18 | valid ppl    65.52 | valid bpc    6.034
-----------------------------------------------------------------------------------------
PROGRESS: 39.0%
| epoch  40 |   100/  216 batches | lr 0.00004 | ms/batch 78.07 | loss  3.17 | ppl    23.75 
| epoch  40 |   200/  216 batches | lr 0.00004 | ms/batch 76.67 | loss  3.10 | ppl    22.20 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 17.22s | valid loss  4.25 | valid ppl    70.12 | valid bpc    6.132
-----------------------------------------------------------------------------------------
PROGRESS: 40.0%
| epoch  41 |   100/  216 batches | lr 0.00004 | ms/batch 78.34 | loss  3.14 | ppl    23.08 
| epoch  41 |   200/  216 batches | lr 0.00004 | ms/batch 76.67 | loss  3.09 | ppl    22.05 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 17.21s | valid loss  4.16 | valid ppl    64.23 | valid bpc    6.005
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 41.0%
| epoch  42 |   100/  216 batches | lr 0.00004 | ms/batch 78.11 | loss  3.09 | ppl    22.03 
| epoch  42 |   200/  216 batches | lr 0.00004 | ms/batch 76.96 | loss  3.12 | ppl    22.66 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 17.22s | valid loss  4.20 | valid ppl    66.82 | valid bpc    6.062
-----------------------------------------------------------------------------------------
PROGRESS: 42.0%
| epoch  43 |   100/  216 batches | lr 0.00004 | ms/batch 78.07 | loss  3.12 | ppl    22.56 
| epoch  43 |   200/  216 batches | lr 0.00004 | ms/batch 76.96 | loss  3.11 | ppl    22.52 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 17.22s | valid loss  4.23 | valid ppl    68.49 | valid bpc    6.098
-----------------------------------------------------------------------------------------
PROGRESS: 43.0%
| epoch  44 |   100/  216 batches | lr 0.00004 | ms/batch 77.99 | loss  3.12 | ppl    22.75 
| epoch  44 |   200/  216 batches | lr 0.00004 | ms/batch 77.05 | loss  3.06 | ppl    21.35 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 17.20s | valid loss  4.21 | valid ppl    67.15 | valid bpc    6.069
-----------------------------------------------------------------------------------------
PROGRESS: 44.0%
| epoch  45 |   100/  216 batches | lr 0.00002 | ms/batch 78.29 | loss  3.09 | ppl    22.00 
| epoch  45 |   200/  216 batches | lr 0.00002 | ms/batch 76.83 | loss  3.06 | ppl    21.43 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 17.23s | valid loss  4.21 | valid ppl    67.50 | valid bpc    6.077
-----------------------------------------------------------------------------------------
PROGRESS: 45.0%
| epoch  46 |   100/  216 batches | lr 0.00002 | ms/batch 77.97 | loss  3.10 | ppl    22.16 
| epoch  46 |   200/  216 batches | lr 0.00002 | ms/batch 77.18 | loss  3.06 | ppl    21.39 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 17.23s | valid loss  4.20 | valid ppl    66.42 | valid bpc    6.054
-----------------------------------------------------------------------------------------
PROGRESS: 46.0%
| epoch  47 |   100/  216 batches | lr 0.00002 | ms/batch 78.24 | loss  3.07 | ppl    21.56 
| epoch  47 |   200/  216 batches | lr 0.00002 | ms/batch 77.01 | loss  3.05 | ppl    21.11 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 17.23s | valid loss  4.21 | valid ppl    67.41 | valid bpc    6.075
-----------------------------------------------------------------------------------------
PROGRESS: 47.0%
| epoch  48 |   100/  216 batches | lr 0.00001 | ms/batch 78.32 | loss  3.08 | ppl    21.83 
| epoch  48 |   200/  216 batches | lr 0.00001 | ms/batch 76.72 | loss  3.03 | ppl    20.69 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 17.22s | valid loss  4.20 | valid ppl    66.74 | valid bpc    6.061
-----------------------------------------------------------------------------------------
PROGRESS: 48.0%
| epoch  49 |   100/  216 batches | lr 0.00001 | ms/batch 78.09 | loss  3.07 | ppl    21.44 
| epoch  49 |   200/  216 batches | lr 0.00001 | ms/batch 76.86 | loss  3.02 | ppl    20.59 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 17.21s | valid loss  4.20 | valid ppl    66.72 | valid bpc    6.060
-----------------------------------------------------------------------------------------
PROGRESS: 49.0%
| epoch  50 |   100/  216 batches | lr 0.00001 | ms/batch 77.92 | loss  3.05 | ppl    21.19 
| epoch  50 |   200/  216 batches | lr 0.00001 | ms/batch 77.20 | loss  3.03 | ppl    20.69 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 17.23s | valid loss  4.20 | valid ppl    66.36 | valid bpc    6.052
-----------------------------------------------------------------------------------------
PROGRESS: 50.0%
| epoch  51 |   100/  216 batches | lr 0.00000 | ms/batch 78.33 | loss  3.06 | ppl    21.27 
| epoch  51 |   200/  216 batches | lr 0.00000 | ms/batch 76.86 | loss  3.03 | ppl    20.76 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 17.23s | valid loss  4.22 | valid ppl    68.04 | valid bpc    6.088
-----------------------------------------------------------------------------------------
PROGRESS: 51.0%
| epoch  52 |   100/  216 batches | lr 0.00000 | ms/batch 78.46 | loss  3.06 | ppl    21.23 
| epoch  52 |   200/  216 batches | lr 0.00000 | ms/batch 76.74 | loss  3.02 | ppl    20.44 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 17.23s | valid loss  4.22 | valid ppl    68.27 | valid bpc    6.093
-----------------------------------------------------------------------------------------
PROGRESS: 52.0%
| epoch  53 |   100/  216 batches | lr 0.00000 | ms/batch 77.88 | loss  3.06 | ppl    21.24 
| epoch  53 |   200/  216 batches | lr 0.00000 | ms/batch 77.24 | loss  3.01 | ppl    20.22 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 17.23s | valid loss  4.21 | valid ppl    67.59 | valid bpc    6.079
-----------------------------------------------------------------------------------------
PROGRESS: 53.0%
| epoch  54 |   100/  216 batches | lr 0.00000 | ms/batch 78.47 | loss  3.05 | ppl    21.13 
| epoch  54 |   200/  216 batches | lr 0.00000 | ms/batch 76.53 | loss  3.03 | ppl    20.60 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 17.23s | valid loss  4.23 | valid ppl    68.76 | valid bpc    6.103
-----------------------------------------------------------------------------------------
PROGRESS: 54.0%
| epoch  55 |   100/  216 batches | lr 0.00000 | ms/batch 77.98 | loss  3.06 | ppl    21.26 
| epoch  55 |   200/  216 batches | lr 0.00000 | ms/batch 77.02 | loss  3.04 | ppl    20.85 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 17.23s | valid loss  4.21 | valid ppl    67.47 | valid bpc    6.076
-----------------------------------------------------------------------------------------
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  216 batches | lr 0.00000 | ms/batch 77.90 | loss  3.06 | ppl    21.31 
| epoch  56 |   200/  216 batches | lr 0.00000 | ms/batch 76.57 | loss  3.03 | ppl    20.78 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 17.21s | valid loss  4.19 | valid ppl    66.24 | valid bpc    6.050
-----------------------------------------------------------------------------------------
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  216 batches | lr 0.00000 | ms/batch 77.92 | loss  3.07 | ppl    21.51 
| epoch  57 |   200/  216 batches | lr 0.00000 | ms/batch 77.12 | loss  3.02 | ppl    20.47 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 17.22s | valid loss  4.21 | valid ppl    67.14 | valid bpc    6.069
-----------------------------------------------------------------------------------------
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  216 batches | lr 0.00000 | ms/batch 77.95 | loss  3.03 | ppl    20.64 
| epoch  58 |   200/  216 batches | lr 0.00000 | ms/batch 77.17 | loss  3.04 | ppl    20.87 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 17.23s | valid loss  4.19 | valid ppl    65.95 | valid bpc    6.043
-----------------------------------------------------------------------------------------
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  216 batches | lr 0.00000 | ms/batch 78.33 | loss  3.05 | ppl    21.07 
| epoch  59 |   200/  216 batches | lr 0.00000 | ms/batch 76.70 | loss  3.01 | ppl    20.24 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 17.22s | valid loss  4.20 | valid ppl    66.92 | valid bpc    6.064
-----------------------------------------------------------------------------------------
PROGRESS: 59.0%
| epoch  60 |   100/  216 batches | lr 0.00000 | ms/batch 78.48 | loss  3.08 | ppl    21.76 
| epoch  60 |   200/  216 batches | lr 0.00000 | ms/batch 76.58 | loss  3.02 | ppl    20.56 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 17.23s | valid loss  4.18 | valid ppl    65.37 | valid bpc    6.031
-----------------------------------------------------------------------------------------
PROGRESS: 60.0%
| epoch  61 |   100/  216 batches | lr 0.00000 | ms/batch 78.55 | loss  3.05 | ppl    21.22 
| epoch  61 |   200/  216 batches | lr 0.00000 | ms/batch 76.54 | loss  3.02 | ppl    20.42 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 17.22s | valid loss  4.21 | valid ppl    67.69 | valid bpc    6.081
-----------------------------------------------------------------------------------------
PROGRESS: 61.0%
| epoch  62 |   100/  216 batches | lr 0.00000 | ms/batch 78.33 | loss  3.04 | ppl    20.81 
| epoch  62 |   200/  216 batches | lr 0.00000 | ms/batch 76.67 | loss  3.00 | ppl    20.17 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 17.21s | valid loss  4.18 | valid ppl    65.28 | valid bpc    6.029
-----------------------------------------------------------------------------------------
PROGRESS: 62.0%
| epoch  63 |   100/  216 batches | lr 0.00000 | ms/batch 78.50 | loss  3.06 | ppl    21.25 
| epoch  63 |   200/  216 batches | lr 0.00000 | ms/batch 77.16 | loss  3.00 | ppl    20.18 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 17.28s | valid loss  4.19 | valid ppl    65.80 | valid bpc    6.040
-----------------------------------------------------------------------------------------
PROGRESS: 63.0%
| epoch  64 |   100/  216 batches | lr 0.00000 | ms/batch 77.98 | loss  3.03 | ppl    20.73 
| epoch  64 |   200/  216 batches | lr 0.00000 | ms/batch 76.95 | loss  3.03 | ppl    20.61 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 17.22s | valid loss  4.21 | valid ppl    67.44 | valid bpc    6.076
-----------------------------------------------------------------------------------------
PROGRESS: 64.0%
| epoch  65 |   100/  216 batches | lr 0.00000 | ms/batch 78.11 | loss  3.06 | ppl    21.28 
| epoch  65 |   200/  216 batches | lr 0.00000 | ms/batch 76.89 | loss  3.02 | ppl    20.47 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 17.22s | valid loss  4.23 | valid ppl    68.43 | valid bpc    6.097
-----------------------------------------------------------------------------------------
PROGRESS: 65.0%
| epoch  66 |   100/  216 batches | lr 0.00000 | ms/batch 78.37 | loss  3.03 | ppl    20.73 
| epoch  66 |   200/  216 batches | lr 0.00000 | ms/batch 76.75 | loss  3.04 | ppl    21.01 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 17.23s | valid loss  4.20 | valid ppl    66.85 | valid bpc    6.063
-----------------------------------------------------------------------------------------
PROGRESS: 66.0%
| epoch  67 |   100/  216 batches | lr 0.00000 | ms/batch 78.41 | loss  3.06 | ppl    21.26 
| epoch  67 |   200/  216 batches | lr 0.00000 | ms/batch 76.62 | loss  3.01 | ppl    20.37 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 17.21s | valid loss  4.21 | valid ppl    67.07 | valid bpc    6.068
-----------------------------------------------------------------------------------------
PROGRESS: 67.0%
| epoch  68 |   100/  216 batches | lr 0.00000 | ms/batch 78.12 | loss  3.05 | ppl    21.20 
| epoch  68 |   200/  216 batches | lr 0.00000 | ms/batch 76.93 | loss  3.01 | ppl    20.29 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 17.23s | valid loss  4.21 | valid ppl    67.54 | valid bpc    6.078
-----------------------------------------------------------------------------------------
PROGRESS: 68.0%
| epoch  69 |   100/  216 batches | lr 0.00000 | ms/batch 77.81 | loss  3.06 | ppl    21.28 
| epoch  69 |   200/  216 batches | lr 0.00000 | ms/batch 76.89 | loss  3.02 | ppl    20.43 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 17.22s | valid loss  4.21 | valid ppl    67.54 | valid bpc    6.078
-----------------------------------------------------------------------------------------
PROGRESS: 69.0%
| epoch  70 |   100/  216 batches | lr 0.00000 | ms/batch 77.72 | loss  3.05 | ppl    21.18 
| epoch  70 |   200/  216 batches | lr 0.00000 | ms/batch 77.28 | loss  3.02 | ppl    20.55 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 17.23s | valid loss  4.19 | valid ppl    66.30 | valid bpc    6.051
-----------------------------------------------------------------------------------------
PROGRESS: 70.0%
| epoch  71 |   100/  216 batches | lr 0.00000 | ms/batch 78.02 | loss  3.05 | ppl    21.15 
| epoch  71 |   200/  216 batches | lr 0.00000 | ms/batch 77.08 | loss  3.02 | ppl    20.50 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 17.22s | valid loss  4.26 | valid ppl    70.79 | valid bpc    6.145
-----------------------------------------------------------------------------------------
PROGRESS: 71.0%
| epoch  72 |   100/  216 batches | lr 0.00000 | ms/batch 78.40 | loss  3.06 | ppl    21.34 
| epoch  72 |   200/  216 batches | lr 0.00000 | ms/batch 76.79 | loss  3.03 | ppl    20.74 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 17.23s | valid loss  4.19 | valid ppl    66.35 | valid bpc    6.052
-----------------------------------------------------------------------------------------
PROGRESS: 72.0%
| epoch  73 |   100/  216 batches | lr 0.00000 | ms/batch 78.12 | loss  3.06 | ppl    21.23 
| epoch  73 |   200/  216 batches | lr 0.00000 | ms/batch 77.11 | loss  3.01 | ppl    20.39 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 17.23s | valid loss  4.19 | valid ppl    65.90 | valid bpc    6.042
-----------------------------------------------------------------------------------------
PROGRESS: 73.0%
| epoch  74 |   100/  216 batches | lr 0.00000 | ms/batch 77.78 | loss  3.06 | ppl    21.35 
| epoch  74 |   200/  216 batches | lr 0.00000 | ms/batch 77.13 | loss  3.01 | ppl    20.22 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 17.20s | valid loss  4.22 | valid ppl    67.94 | valid bpc    6.086
-----------------------------------------------------------------------------------------
PROGRESS: 74.0%
| epoch  75 |   100/  216 batches | lr 0.00000 | ms/batch 77.84 | loss  3.04 | ppl    20.97 
| epoch  75 |   200/  216 batches | lr 0.00000 | ms/batch 77.13 | loss  3.02 | ppl    20.41 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 17.22s | valid loss  4.23 | valid ppl    68.41 | valid bpc    6.096
-----------------------------------------------------------------------------------------
PROGRESS: 75.0%
| epoch  76 |   100/  216 batches | lr 0.00000 | ms/batch 77.81 | loss  3.07 | ppl    21.54 
| epoch  76 |   200/  216 batches | lr 0.00000 | ms/batch 77.09 | loss  3.00 | ppl    20.01 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 17.22s | valid loss  4.22 | valid ppl    67.75 | valid bpc    6.082
-----------------------------------------------------------------------------------------
PROGRESS: 76.0%
| epoch  77 |   100/  216 batches | lr 0.00000 | ms/batch 78.06 | loss  3.03 | ppl    20.75 
| epoch  77 |   200/  216 batches | lr 0.00000 | ms/batch 76.96 | loss  3.03 | ppl    20.68 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 17.22s | valid loss  4.23 | valid ppl    68.51 | valid bpc    6.098
-----------------------------------------------------------------------------------------
PROGRESS: 77.0%
| epoch  78 |   100/  216 batches | lr 0.00000 | ms/batch 78.16 | loss  3.03 | ppl    20.63 
| epoch  78 |   200/  216 batches | lr 0.00000 | ms/batch 76.98 | loss  3.03 | ppl    20.64 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 17.22s | valid loss  4.23 | valid ppl    68.81 | valid bpc    6.104
-----------------------------------------------------------------------------------------
PROGRESS: 78.0%
| epoch  79 |   100/  216 batches | lr 0.00000 | ms/batch 78.46 | loss  3.05 | ppl    21.03 
| epoch  79 |   200/  216 batches | lr 0.00000 | ms/batch 76.63 | loss  3.01 | ppl    20.24 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 17.22s | valid loss  4.17 | valid ppl    64.41 | valid bpc    6.009
-----------------------------------------------------------------------------------------
PROGRESS: 79.0%
| epoch  80 |   100/  216 batches | lr 0.00000 | ms/batch 78.19 | loss  3.06 | ppl    21.25 
| epoch  80 |   200/  216 batches | lr 0.00000 | ms/batch 76.77 | loss  3.00 | ppl    20.10 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 17.22s | valid loss  4.18 | valid ppl    65.21 | valid bpc    6.027
-----------------------------------------------------------------------------------------
PROGRESS: 80.0%
| epoch  81 |   100/  216 batches | lr 0.00000 | ms/batch 78.36 | loss  3.04 | ppl    20.99 
| epoch  81 |   200/  216 batches | lr 0.00000 | ms/batch 76.68 | loss  3.01 | ppl    20.20 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 17.22s | valid loss  4.21 | valid ppl    67.23 | valid bpc    6.071
-----------------------------------------------------------------------------------------
PROGRESS: 81.0%
| epoch  82 |   100/  216 batches | lr 0.00000 | ms/batch 78.45 | loss  3.06 | ppl    21.41 
| epoch  82 |   200/  216 batches | lr 0.00000 | ms/batch 76.61 | loss  3.01 | ppl    20.35 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 17.22s | valid loss  4.20 | valid ppl    67.02 | valid bpc    6.066
-----------------------------------------------------------------------------------------
PROGRESS: 82.0%
| epoch  83 |   100/  216 batches | lr 0.00000 | ms/batch 78.20 | loss  3.04 | ppl    20.98 
| epoch  83 |   200/  216 batches | lr 0.00000 | ms/batch 76.71 | loss  3.02 | ppl    20.50 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 17.22s | valid loss  4.24 | valid ppl    69.45 | valid bpc    6.118
-----------------------------------------------------------------------------------------
PROGRESS: 83.0%
| epoch  84 |   100/  216 batches | lr 0.00000 | ms/batch 78.31 | loss  3.04 | ppl    20.97 
| epoch  84 |   200/  216 batches | lr 0.00000 | ms/batch 76.67 | loss  3.02 | ppl    20.45 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 17.22s | valid loss  4.18 | valid ppl    65.54 | valid bpc    6.034
-----------------------------------------------------------------------------------------
PROGRESS: 84.0%
| epoch  85 |   100/  216 batches | lr 0.00000 | ms/batch 78.14 | loss  3.05 | ppl    21.03 
| epoch  85 |   200/  216 batches | lr 0.00000 | ms/batch 76.99 | loss  3.01 | ppl    20.25 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 17.22s | valid loss  4.23 | valid ppl    68.97 | valid bpc    6.108
-----------------------------------------------------------------------------------------
PROGRESS: 85.0%
| epoch  86 |   100/  216 batches | lr 0.00000 | ms/batch 77.86 | loss  3.06 | ppl    21.39 
| epoch  86 |   200/  216 batches | lr 0.00000 | ms/batch 77.04 | loss  3.00 | ppl    20.14 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 17.20s | valid loss  4.19 | valid ppl    66.00 | valid bpc    6.044
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  216 batches | lr 0.00000 | ms/batch 77.83 | loss  3.05 | ppl    21.14 
| epoch  87 |   200/  216 batches | lr 0.00000 | ms/batch 77.14 | loss  3.02 | ppl    20.49 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 17.23s | valid loss  4.21 | valid ppl    67.10 | valid bpc    6.068
-----------------------------------------------------------------------------------------
PROGRESS: 87.0%
| epoch  88 |   100/  216 batches | lr 0.00000 | ms/batch 78.31 | loss  3.05 | ppl    21.19 
| epoch  88 |   200/  216 batches | lr 0.00000 | ms/batch 76.56 | loss  3.01 | ppl    20.20 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 17.21s | valid loss  4.20 | valid ppl    66.78 | valid bpc    6.061
-----------------------------------------------------------------------------------------
PROGRESS: 88.0%
| epoch  89 |   100/  216 batches | lr 0.00000 | ms/batch 78.12 | loss  3.06 | ppl    21.39 
| epoch  89 |   200/  216 batches | lr 0.00000 | ms/batch 76.75 | loss  3.01 | ppl    20.38 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 17.21s | valid loss  4.22 | valid ppl    67.79 | valid bpc    6.083
-----------------------------------------------------------------------------------------
PROGRESS: 89.0%
| epoch  90 |   100/  216 batches | lr 0.00000 | ms/batch 78.36 | loss  3.06 | ppl    21.29 
| epoch  90 |   200/  216 batches | lr 0.00000 | ms/batch 76.81 | loss  3.02 | ppl    20.41 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 17.23s | valid loss  4.20 | valid ppl    66.85 | valid bpc    6.063
-----------------------------------------------------------------------------------------
PROGRESS: 90.0%
| epoch  91 |   100/  216 batches | lr 0.00000 | ms/batch 78.27 | loss  3.04 | ppl    20.99 
| epoch  91 |   200/  216 batches | lr 0.00000 | ms/batch 76.64 | loss  3.03 | ppl    20.70 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 17.20s | valid loss  4.20 | valid ppl    66.43 | valid bpc    6.054
-----------------------------------------------------------------------------------------
PROGRESS: 91.0%
| epoch  92 |   100/  216 batches | lr 0.00000 | ms/batch 77.93 | loss  3.03 | ppl    20.73 
| epoch  92 |   200/  216 batches | lr 0.00000 | ms/batch 77.01 | loss  3.04 | ppl    20.94 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 17.20s | valid loss  4.23 | valid ppl    68.91 | valid bpc    6.107
-----------------------------------------------------------------------------------------
PROGRESS: 92.0%
| epoch  93 |   100/  216 batches | lr 0.00000 | ms/batch 77.79 | loss  3.04 | ppl    21.01 
| epoch  93 |   200/  216 batches | lr 0.00000 | ms/batch 77.32 | loss  3.03 | ppl    20.64 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 17.22s | valid loss  4.22 | valid ppl    67.78 | valid bpc    6.083
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  216 batches | lr 0.00000 | ms/batch 77.86 | loss  3.05 | ppl    21.10 
| epoch  94 |   200/  216 batches | lr 0.00000 | ms/batch 77.37 | loss  3.02 | ppl    20.48 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 17.23s | valid loss  4.20 | valid ppl    66.93 | valid bpc    6.065
-----------------------------------------------------------------------------------------
PROGRESS: 94.0%
| epoch  95 |   100/  216 batches | lr 0.00000 | ms/batch 78.14 | loss  3.05 | ppl    21.08 
| epoch  95 |   200/  216 batches | lr 0.00000 | ms/batch 76.90 | loss  3.02 | ppl    20.47 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 17.22s | valid loss  4.20 | valid ppl    66.99 | valid bpc    6.066
-----------------------------------------------------------------------------------------
PROGRESS: 95.0%
| epoch  96 |   100/  216 batches | lr 0.00000 | ms/batch 78.11 | loss  3.04 | ppl    20.99 
| epoch  96 |   200/  216 batches | lr 0.00000 | ms/batch 77.03 | loss  3.01 | ppl    20.31 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 17.23s | valid loss  4.21 | valid ppl    67.54 | valid bpc    6.078
-----------------------------------------------------------------------------------------
PROGRESS: 96.0%
| epoch  97 |   100/  216 batches | lr 0.00000 | ms/batch 77.89 | loss  3.05 | ppl    21.05 
| epoch  97 |   200/  216 batches | lr 0.00000 | ms/batch 77.01 | loss  3.02 | ppl    20.55 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 17.22s | valid loss  4.22 | valid ppl    67.97 | valid bpc    6.087
-----------------------------------------------------------------------------------------
PROGRESS: 97.0%
| epoch  98 |   100/  216 batches | lr 0.00000 | ms/batch 78.04 | loss  3.03 | ppl    20.67 
| epoch  98 |   200/  216 batches | lr 0.00000 | ms/batch 76.70 | loss  3.02 | ppl    20.58 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 17.20s | valid loss  4.22 | valid ppl    68.33 | valid bpc    6.094
-----------------------------------------------------------------------------------------
PROGRESS: 98.0%
| epoch  99 |   100/  216 batches | lr 0.00000 | ms/batch 77.94 | loss  3.04 | ppl    20.82 
| epoch  99 |   200/  216 batches | lr 0.00000 | ms/batch 76.82 | loss  3.01 | ppl    20.30 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 17.20s | valid loss  4.26 | valid ppl    70.69 | valid bpc    6.144
-----------------------------------------------------------------------------------------
PROGRESS: 99.0%
| epoch 100 |   100/  216 batches | lr 0.00000 | ms/batch 78.34 | loss  3.04 | ppl    20.84 
| epoch 100 |   200/  216 batches | lr 0.00000 | ms/batch 76.75 | loss  3.03 | ppl    20.65 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 17.22s | valid loss  4.23 | valid ppl    68.83 | valid bpc    6.105
-----------------------------------------------------------------------------------------
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  4.21 | test ppl    67.32 | test bpc    6.073
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.4339, Mean Reca: 0.5978, Mean F1: 0.4946
Counter({'NP': 9063, 'PP': 4210, 'S': 3493, 'VP': 3124, 'SBAR': 683, 'ADJP': 282, 'QP': 253, 'ADVP': 155, 'SINV': 150, 'PRN': 50, 'FRAG': 34, 'WHNP': 32, 'NX': 17, 'SQ': 15, 'NAC': 9, 'SBARQ': 9, 'WHPP': 8, 'UCP': 6, 'CONJP': 5, 'X': 3, 'WHADJP': 1})
Counter({'NP': 14432, 'VP': 8130, 'S': 5620, 'PP': 5484, 'SBAR': 1796, 'ADJP': 649, 'QP': 490, 'ADVP': 286, 'SINV': 157, 'PRN': 128, 'NX': 95, 'FRAG': 42, 'WHNP': 37, 'UCP': 32, 'NAC': 30, 'WHPP': 25, 'CONJP': 21, 'SQ': 18, 'SBARQ': 10, 'WHADVP': 9, 'X': 6, 'WHADJP': 4, 'INTJ': 1})
SBAR: 0.3803
NP: 0.6280
VP: 0.3843
PP: 0.7677
ADJP: 0.4345
ADVP: 0.5420
4.844994980787629
-----------------------------------------------------------------------------------------
Dependency parsing performance:
Conll-U Style:
DDA: 0.421
UDA: 0.580
=========================================================================================
Loading dataset...
Loading dictionary...
Number of tokens:  10001
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer_in_parser', nhid=512, nlayers=8, front_layers=2, rear_layers=6, n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=1111, nonmono=5, cuda=True, log_interval=100, save='trained_models/structformer_in_parser_1111_26.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 38475637
Model architecture: StructFormer_In_Parser(
  (transformer_front): Transformer_Front(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(10001, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-1): 2 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
  (transformer_rear): Transformer_Rear(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(10001, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-5): 6 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (output_layer): Linear(in_features=512, out_features=10001, bias=True)
  )
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  216 batches | lr 0.00030 | ms/batch 80.67 | loss  7.25 | ppl  1412.96 
| epoch   1 |   200/  216 batches | lr 0.00030 | ms/batch 75.55 | loss  6.83 | ppl   929.30 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 17.31s | valid loss  6.66 | valid ppl   784.05 | valid bpc    9.615
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  216 batches | lr 0.00030 | ms/batch 77.04 | loss  6.69 | ppl   801.51 
| epoch   2 |   200/  216 batches | lr 0.00030 | ms/batch 76.31 | loss  6.35 | ppl   573.08 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 17.04s | valid loss  6.10 | valid ppl   447.29 | valid bpc    8.805
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  216 batches | lr 0.00030 | ms/batch 77.49 | loss  6.11 | ppl   448.28 
| epoch   3 |   200/  216 batches | lr 0.00030 | ms/batch 76.20 | loss  5.81 | ppl   332.18 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 17.08s | valid loss  5.66 | valid ppl   285.86 | valid bpc    8.159
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  216 batches | lr 0.00030 | ms/batch 78.00 | loss  5.68 | ppl   292.07 
| epoch   4 |   200/  216 batches | lr 0.00030 | ms/batch 75.93 | loss  5.48 | ppl   239.38 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 17.10s | valid loss  5.39 | valid ppl   219.48 | valid bpc    7.778
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  216 batches | lr 0.00030 | ms/batch 77.53 | loss  5.39 | ppl   218.50 
| epoch   5 |   200/  216 batches | lr 0.00030 | ms/batch 76.31 | loss  5.24 | ppl   188.50 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 17.11s | valid loss  5.21 | valid ppl   182.63 | valid bpc    7.513
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  216 batches | lr 0.00030 | ms/batch 77.77 | loss  5.20 | ppl   180.63 
| epoch   6 |   200/  216 batches | lr 0.00030 | ms/batch 76.32 | loss  5.10 | ppl   164.52 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 17.12s | valid loss  5.09 | valid ppl   161.66 | valid bpc    7.337
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  216 batches | lr 0.00030 | ms/batch 77.68 | loss  5.04 | ppl   154.56 
| epoch   7 |   200/  216 batches | lr 0.00030 | ms/batch 76.61 | loss  4.95 | ppl   141.27 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 17.13s | valid loss  4.95 | valid ppl   140.93 | valid bpc    7.139
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  216 batches | lr 0.00030 | ms/batch 77.76 | loss  4.90 | ppl   134.60 
| epoch   8 |   200/  216 batches | lr 0.00030 | ms/batch 76.67 | loss  4.81 | ppl   122.96 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 17.14s | valid loss  4.85 | valid ppl   127.12 | valid bpc    6.990
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 8.0%
| epoch   9 |   100/  216 batches | lr 0.00030 | ms/batch 77.41 | loss  4.74 | ppl   114.73 
| epoch   9 |   200/  216 batches | lr 0.00030 | ms/batch 76.81 | loss  4.71 | ppl   110.92 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 17.13s | valid loss  4.76 | valid ppl   116.54 | valid bpc    6.865
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  216 batches | lr 0.00030 | ms/batch 77.64 | loss  4.65 | ppl   104.52 
| epoch  10 |   200/  216 batches | lr 0.00030 | ms/batch 76.73 | loss  4.62 | ppl   101.04 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 17.13s | valid loss  4.73 | valid ppl   112.79 | valid bpc    6.818
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  216 batches | lr 0.00030 | ms/batch 77.76 | loss  4.57 | ppl    96.94 
| epoch  11 |   200/  216 batches | lr 0.00030 | ms/batch 76.43 | loss  4.50 | ppl    90.35 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 17.13s | valid loss  4.64 | valid ppl   103.10 | valid bpc    6.688
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  216 batches | lr 0.00030 | ms/batch 77.92 | loss  4.47 | ppl    87.48 
| epoch  12 |   200/  216 batches | lr 0.00030 | ms/batch 76.38 | loss  4.41 | ppl    82.65 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 17.14s | valid loss  4.56 | valid ppl    96.00 | valid bpc    6.585
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 12.0%
| epoch  13 |   100/  216 batches | lr 0.00030 | ms/batch 77.74 | loss  4.38 | ppl    79.89 
| epoch  13 |   200/  216 batches | lr 0.00030 | ms/batch 76.69 | loss  4.34 | ppl    76.72 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 17.14s | valid loss  4.53 | valid ppl    92.93 | valid bpc    6.538
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 13.0%
| epoch  14 |   100/  216 batches | lr 0.00030 | ms/batch 77.64 | loss  4.30 | ppl    73.59 
| epoch  14 |   200/  216 batches | lr 0.00030 | ms/batch 76.71 | loss  4.26 | ppl    70.64 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 17.14s | valid loss  4.52 | valid ppl    91.42 | valid bpc    6.514
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  216 batches | lr 0.00030 | ms/batch 77.66 | loss  4.22 | ppl    67.99 
| epoch  15 |   200/  216 batches | lr 0.00030 | ms/batch 76.66 | loss  4.20 | ppl    66.71 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 17.14s | valid loss  4.49 | valid ppl    89.18 | valid bpc    6.479
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 15.0%
| epoch  16 |   100/  216 batches | lr 0.00030 | ms/batch 78.09 | loss  4.15 | ppl    63.68 
| epoch  16 |   200/  216 batches | lr 0.00030 | ms/batch 76.26 | loss  4.11 | ppl    60.85 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 17.14s | valid loss  4.45 | valid ppl    85.92 | valid bpc    6.425
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 16.0%
| epoch  17 |   100/  216 batches | lr 0.00030 | ms/batch 77.76 | loss  4.07 | ppl    58.81 
| epoch  17 |   200/  216 batches | lr 0.00030 | ms/batch 76.33 | loss  4.07 | ppl    58.37 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 17.14s | valid loss  4.43 | valid ppl    83.56 | valid bpc    6.385
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 17.0%
| epoch  18 |   100/  216 batches | lr 0.00030 | ms/batch 77.63 | loss  4.00 | ppl    54.76 
| epoch  18 |   200/  216 batches | lr 0.00030 | ms/batch 76.79 | loss  4.02 | ppl    55.44 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 17.14s | valid loss  4.41 | valid ppl    81.92 | valid bpc    6.356
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 18.0%
| epoch  19 |   100/  216 batches | lr 0.00030 | ms/batch 77.90 | loss  3.95 | ppl    51.99 
| epoch  19 |   200/  216 batches | lr 0.00030 | ms/batch 76.38 | loss  3.95 | ppl    52.03 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 17.13s | valid loss  4.31 | valid ppl    74.59 | valid bpc    6.221
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 19.0%
| epoch  20 |   100/  216 batches | lr 0.00030 | ms/batch 77.53 | loss  3.91 | ppl    50.05 
| epoch  20 |   200/  216 batches | lr 0.00030 | ms/batch 76.72 | loss  3.90 | ppl    49.21 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 17.13s | valid loss  4.37 | valid ppl    78.97 | valid bpc    6.303
-----------------------------------------------------------------------------------------
PROGRESS: 20.0%
| epoch  21 |   100/  216 batches | lr 0.00030 | ms/batch 77.43 | loss  3.83 | ppl    45.91 
| epoch  21 |   200/  216 batches | lr 0.00030 | ms/batch 76.92 | loss  3.85 | ppl    47.12 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 17.14s | valid loss  4.32 | valid ppl    75.31 | valid bpc    6.235
-----------------------------------------------------------------------------------------
PROGRESS: 21.0%
| epoch  22 |   100/  216 batches | lr 0.00030 | ms/batch 78.15 | loss  3.79 | ppl    44.38 
| epoch  22 |   200/  216 batches | lr 0.00030 | ms/batch 76.21 | loss  3.77 | ppl    43.58 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 17.14s | valid loss  4.31 | valid ppl    74.52 | valid bpc    6.220
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 22.0%
| epoch  23 |   100/  216 batches | lr 0.00030 | ms/batch 77.49 | loss  3.72 | ppl    41.10 
| epoch  23 |   200/  216 batches | lr 0.00030 | ms/batch 76.74 | loss  3.76 | ppl    42.80 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 17.14s | valid loss  4.33 | valid ppl    75.59 | valid bpc    6.240
-----------------------------------------------------------------------------------------
PROGRESS: 23.0%
| epoch  24 |   100/  216 batches | lr 0.00030 | ms/batch 77.97 | loss  3.71 | ppl    41.02 
| epoch  24 |   200/  216 batches | lr 0.00030 | ms/batch 76.42 | loss  3.71 | ppl    40.82 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 17.14s | valid loss  4.30 | valid ppl    73.82 | valid bpc    6.206
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 24.0%
| epoch  25 |   100/  216 batches | lr 0.00030 | ms/batch 77.76 | loss  3.66 | ppl    39.01 
| epoch  25 |   200/  216 batches | lr 0.00030 | ms/batch 76.63 | loss  3.66 | ppl    38.75 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 17.15s | valid loss  4.29 | valid ppl    72.75 | valid bpc    6.185
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 25.0%
| epoch  26 |   100/  216 batches | lr 0.00030 | ms/batch 77.45 | loss  3.60 | ppl    36.75 
| epoch  26 |   200/  216 batches | lr 0.00030 | ms/batch 76.88 | loss  3.61 | ppl    36.90 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 17.14s | valid loss  4.27 | valid ppl    71.23 | valid bpc    6.154
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 26.0%
| epoch  27 |   100/  216 batches | lr 0.00030 | ms/batch 77.76 | loss  3.57 | ppl    35.44 
| epoch  27 |   200/  216 batches | lr 0.00030 | ms/batch 76.51 | loss  3.55 | ppl    34.74 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 17.14s | valid loss  4.29 | valid ppl    72.91 | valid bpc    6.188
-----------------------------------------------------------------------------------------
PROGRESS: 27.0%
| epoch  28 |   100/  216 batches | lr 0.00030 | ms/batch 77.68 | loss  3.51 | ppl    33.46 
| epoch  28 |   200/  216 batches | lr 0.00030 | ms/batch 76.75 | loss  3.52 | ppl    33.86 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 17.14s | valid loss  4.29 | valid ppl    73.17 | valid bpc    6.193
-----------------------------------------------------------------------------------------
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  216 batches | lr 0.00030 | ms/batch 77.57 | loss  3.47 | ppl    32.20 
| epoch  29 |   200/  216 batches | lr 0.00030 | ms/batch 76.78 | loss  3.47 | ppl    32.25 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 17.15s | valid loss  4.27 | valid ppl    71.69 | valid bpc    6.164
-----------------------------------------------------------------------------------------
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  216 batches | lr 0.00015 | ms/batch 78.05 | loss  3.38 | ppl    29.38 
| epoch  30 |   200/  216 batches | lr 0.00015 | ms/batch 76.20 | loss  3.34 | ppl    28.11 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 17.15s | valid loss  4.21 | valid ppl    67.36 | valid bpc    6.074
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 30.0%
| epoch  31 |   100/  216 batches | lr 0.00015 | ms/batch 78.04 | loss  3.33 | ppl    27.90 
| epoch  31 |   200/  216 batches | lr 0.00015 | ms/batch 76.44 | loss  3.30 | ppl    27.13 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 17.15s | valid loss  4.22 | valid ppl    67.97 | valid bpc    6.087
-----------------------------------------------------------------------------------------
PROGRESS: 31.0%
| epoch  32 |   100/  216 batches | lr 0.00015 | ms/batch 77.74 | loss  3.27 | ppl    26.21 
| epoch  32 |   200/  216 batches | lr 0.00015 | ms/batch 76.64 | loss  3.28 | ppl    26.62 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 17.14s | valid loss  4.20 | valid ppl    66.41 | valid bpc    6.053
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 32.0%
| epoch  33 |   100/  216 batches | lr 0.00015 | ms/batch 77.95 | loss  3.25 | ppl    25.88 
| epoch  33 |   200/  216 batches | lr 0.00015 | ms/batch 76.37 | loss  3.23 | ppl    25.41 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 17.14s | valid loss  4.21 | valid ppl    67.31 | valid bpc    6.073
-----------------------------------------------------------------------------------------
PROGRESS: 33.0%
| epoch  34 |   100/  216 batches | lr 0.00015 | ms/batch 77.78 | loss  3.23 | ppl    25.35 
| epoch  34 |   200/  216 batches | lr 0.00015 | ms/batch 76.48 | loss  3.21 | ppl    24.77 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 17.14s | valid loss  4.21 | valid ppl    67.57 | valid bpc    6.078
-----------------------------------------------------------------------------------------
PROGRESS: 34.0%
| epoch  35 |   100/  216 batches | lr 0.00015 | ms/batch 77.91 | loss  3.18 | ppl    24.06 
| epoch  35 |   200/  216 batches | lr 0.00015 | ms/batch 76.50 | loss  3.18 | ppl    24.06 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 17.14s | valid loss  4.24 | valid ppl    69.73 | valid bpc    6.124
-----------------------------------------------------------------------------------------
PROGRESS: 35.0%
| epoch  36 |   100/  216 batches | lr 0.00007 | ms/batch 77.70 | loss  3.12 | ppl    22.69 
| epoch  36 |   200/  216 batches | lr 0.00007 | ms/batch 76.59 | loss  3.13 | ppl    22.92 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 17.14s | valid loss  4.21 | valid ppl    67.20 | valid bpc    6.070
-----------------------------------------------------------------------------------------
PROGRESS: 36.0%
| epoch  37 |   100/  216 batches | lr 0.00007 | ms/batch 78.06 | loss  3.12 | ppl    22.66 
| epoch  37 |   200/  216 batches | lr 0.00007 | ms/batch 76.41 | loss  3.10 | ppl    22.13 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 17.15s | valid loss  4.19 | valid ppl    65.74 | valid bpc    6.039
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 37.0%
| epoch  38 |   100/  216 batches | lr 0.00007 | ms/batch 78.03 | loss  3.10 | ppl    22.16 
| epoch  38 |   200/  216 batches | lr 0.00007 | ms/batch 76.32 | loss  3.07 | ppl    21.55 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 17.14s | valid loss  4.20 | valid ppl    66.41 | valid bpc    6.053
-----------------------------------------------------------------------------------------
PROGRESS: 38.0%
| epoch  39 |   100/  216 batches | lr 0.00007 | ms/batch 78.06 | loss  3.07 | ppl    21.57 
| epoch  39 |   200/  216 batches | lr 0.00007 | ms/batch 76.33 | loss  3.06 | ppl    21.38 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 17.14s | valid loss  4.19 | valid ppl    66.18 | valid bpc    6.048
-----------------------------------------------------------------------------------------
PROGRESS: 39.0%
| epoch  40 |   100/  216 batches | lr 0.00007 | ms/batch 77.69 | loss  3.06 | ppl    21.24 
| epoch  40 |   200/  216 batches | lr 0.00007 | ms/batch 76.65 | loss  3.03 | ppl    20.69 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 17.15s | valid loss  4.23 | valid ppl    69.04 | valid bpc    6.109
-----------------------------------------------------------------------------------------
PROGRESS: 40.0%
| epoch  41 |   100/  216 batches | lr 0.00004 | ms/batch 77.62 | loss  3.04 | ppl    20.97 
| epoch  41 |   200/  216 batches | lr 0.00004 | ms/batch 76.72 | loss  3.00 | ppl    20.00 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 17.15s | valid loss  4.21 | valid ppl    67.54 | valid bpc    6.078
-----------------------------------------------------------------------------------------
PROGRESS: 41.0%
| epoch  42 |   100/  216 batches | lr 0.00004 | ms/batch 77.31 | loss  3.02 | ppl    20.44 
| epoch  42 |   200/  216 batches | lr 0.00004 | ms/batch 76.65 | loss  2.98 | ppl    19.69 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 17.15s | valid loss  4.20 | valid ppl    66.81 | valid bpc    6.062
-----------------------------------------------------------------------------------------
PROGRESS: 42.0%
| epoch  43 |   100/  216 batches | lr 0.00004 | ms/batch 78.18 | loss  3.01 | ppl    20.35 
| epoch  43 |   200/  216 batches | lr 0.00004 | ms/batch 76.08 | loss  2.97 | ppl    19.47 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 17.14s | valid loss  4.22 | valid ppl    68.22 | valid bpc    6.092
-----------------------------------------------------------------------------------------
PROGRESS: 43.0%
| epoch  44 |   100/  216 batches | lr 0.00002 | ms/batch 77.40 | loss  2.99 | ppl    19.94 
| epoch  44 |   200/  216 batches | lr 0.00002 | ms/batch 77.00 | loss  2.93 | ppl    18.81 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 17.14s | valid loss  4.19 | valid ppl    65.98 | valid bpc    6.044
-----------------------------------------------------------------------------------------
PROGRESS: 44.0%
| epoch  45 |   100/  216 batches | lr 0.00002 | ms/batch 77.92 | loss  2.97 | ppl    19.49 
| epoch  45 |   200/  216 batches | lr 0.00002 | ms/batch 76.39 | loss  2.95 | ppl    19.09 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 17.14s | valid loss  4.19 | valid ppl    65.80 | valid bpc    6.040
-----------------------------------------------------------------------------------------
PROGRESS: 45.0%
| epoch  46 |   100/  216 batches | lr 0.00002 | ms/batch 77.89 | loss  2.97 | ppl    19.46 
| epoch  46 |   200/  216 batches | lr 0.00002 | ms/batch 76.47 | loss  2.97 | ppl    19.40 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 17.14s | valid loss  4.19 | valid ppl    66.01 | valid bpc    6.045
-----------------------------------------------------------------------------------------
PROGRESS: 46.0%
| epoch  47 |   100/  216 batches | lr 0.00001 | ms/batch 77.67 | loss  2.97 | ppl    19.49 
| epoch  47 |   200/  216 batches | lr 0.00001 | ms/batch 76.58 | loss  2.93 | ppl    18.65 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 17.13s | valid loss  4.19 | valid ppl    66.01 | valid bpc    6.045
-----------------------------------------------------------------------------------------
PROGRESS: 47.0%
| epoch  48 |   100/  216 batches | lr 0.00001 | ms/batch 78.16 | loss  2.96 | ppl    19.34 
| epoch  48 |   200/  216 batches | lr 0.00001 | ms/batch 76.12 | loss  2.93 | ppl    18.78 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 17.13s | valid loss  4.17 | valid ppl    65.03 | valid bpc    6.023
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 48.0%
| epoch  49 |   100/  216 batches | lr 0.00001 | ms/batch 78.15 | loss  2.97 | ppl    19.51 
| epoch  49 |   200/  216 batches | lr 0.00001 | ms/batch 76.14 | loss  2.92 | ppl    18.46 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 17.14s | valid loss  4.19 | valid ppl    66.14 | valid bpc    6.047
-----------------------------------------------------------------------------------------
PROGRESS: 49.0%
| epoch  50 |   100/  216 batches | lr 0.00001 | ms/batch 77.67 | loss  2.95 | ppl    19.18 
| epoch  50 |   200/  216 batches | lr 0.00001 | ms/batch 76.58 | loss  2.91 | ppl    18.29 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 17.14s | valid loss  4.14 | valid ppl    62.86 | valid bpc    5.974
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 50.0%
| epoch  51 |   100/  216 batches | lr 0.00001 | ms/batch 77.64 | loss  2.96 | ppl    19.23 
| epoch  51 |   200/  216 batches | lr 0.00001 | ms/batch 76.70 | loss  2.91 | ppl    18.44 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 17.13s | valid loss  4.21 | valid ppl    67.21 | valid bpc    6.071
-----------------------------------------------------------------------------------------
PROGRESS: 51.0%
| epoch  52 |   100/  216 batches | lr 0.00001 | ms/batch 77.53 | loss  2.95 | ppl    19.15 
| epoch  52 |   200/  216 batches | lr 0.00001 | ms/batch 76.84 | loss  2.91 | ppl    18.42 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 17.14s | valid loss  4.16 | valid ppl    64.02 | valid bpc    6.000
-----------------------------------------------------------------------------------------
PROGRESS: 52.0%
| epoch  53 |   100/  216 batches | lr 0.00001 | ms/batch 77.33 | loss  2.94 | ppl    18.98 
| epoch  53 |   200/  216 batches | lr 0.00001 | ms/batch 77.01 | loss  2.91 | ppl    18.36 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 17.14s | valid loss  4.17 | valid ppl    64.41 | valid bpc    6.009
-----------------------------------------------------------------------------------------
PROGRESS: 53.0%
| epoch  54 |   100/  216 batches | lr 0.00000 | ms/batch 77.87 | loss  2.93 | ppl    18.70 
| epoch  54 |   200/  216 batches | lr 0.00000 | ms/batch 76.49 | loss  2.92 | ppl    18.55 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 17.15s | valid loss  4.21 | valid ppl    67.10 | valid bpc    6.068
-----------------------------------------------------------------------------------------
PROGRESS: 54.0%
| epoch  55 |   100/  216 batches | lr 0.00000 | ms/batch 77.87 | loss  2.93 | ppl    18.78 
| epoch  55 |   200/  216 batches | lr 0.00000 | ms/batch 76.49 | loss  2.93 | ppl    18.65 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 17.14s | valid loss  4.18 | valid ppl    65.25 | valid bpc    6.028
-----------------------------------------------------------------------------------------
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  216 batches | lr 0.00000 | ms/batch 77.87 | loss  2.91 | ppl    18.41 
| epoch  56 |   200/  216 batches | lr 0.00000 | ms/batch 76.61 | loss  2.93 | ppl    18.65 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 17.15s | valid loss  4.17 | valid ppl    64.40 | valid bpc    6.009
-----------------------------------------------------------------------------------------
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  216 batches | lr 0.00000 | ms/batch 77.46 | loss  2.92 | ppl    18.49 
| epoch  57 |   200/  216 batches | lr 0.00000 | ms/batch 76.95 | loss  2.92 | ppl    18.46 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 17.14s | valid loss  4.25 | valid ppl    70.27 | valid bpc    6.135
-----------------------------------------------------------------------------------------
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  216 batches | lr 0.00000 | ms/batch 77.48 | loss  2.94 | ppl    18.92 
| epoch  58 |   200/  216 batches | lr 0.00000 | ms/batch 76.77 | loss  2.91 | ppl    18.37 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 17.13s | valid loss  4.19 | valid ppl    66.05 | valid bpc    6.045
-----------------------------------------------------------------------------------------
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  216 batches | lr 0.00000 | ms/batch 77.96 | loss  2.93 | ppl    18.74 
| epoch  59 |   200/  216 batches | lr 0.00000 | ms/batch 76.40 | loss  2.90 | ppl    18.23 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 17.15s | valid loss  4.20 | valid ppl    66.59 | valid bpc    6.057
-----------------------------------------------------------------------------------------
PROGRESS: 59.0%
| epoch  60 |   100/  216 batches | lr 0.00000 | ms/batch 78.06 | loss  2.93 | ppl    18.80 
| epoch  60 |   200/  216 batches | lr 0.00000 | ms/batch 76.32 | loss  2.91 | ppl    18.33 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 17.15s | valid loss  4.20 | valid ppl    66.89 | valid bpc    6.064
-----------------------------------------------------------------------------------------
PROGRESS: 60.0%
| epoch  61 |   100/  216 batches | lr 0.00000 | ms/batch 77.74 | loss  2.94 | ppl    18.84 
| epoch  61 |   200/  216 batches | lr 0.00000 | ms/batch 76.72 | loss  2.91 | ppl    18.35 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 17.16s | valid loss  4.21 | valid ppl    67.33 | valid bpc    6.073
-----------------------------------------------------------------------------------------
PROGRESS: 61.0%
| epoch  62 |   100/  216 batches | lr 0.00000 | ms/batch 77.89 | loss  2.93 | ppl    18.82 
| epoch  62 |   200/  216 batches | lr 0.00000 | ms/batch 76.41 | loss  2.91 | ppl    18.29 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 17.14s | valid loss  4.15 | valid ppl    63.74 | valid bpc    5.994
-----------------------------------------------------------------------------------------
PROGRESS: 62.0%
| epoch  63 |   100/  216 batches | lr 0.00000 | ms/batch 77.65 | loss  2.93 | ppl    18.72 
| epoch  63 |   200/  216 batches | lr 0.00000 | ms/batch 76.63 | loss  2.90 | ppl    18.20 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 17.15s | valid loss  4.20 | valid ppl    66.75 | valid bpc    6.061
-----------------------------------------------------------------------------------------
PROGRESS: 63.0%
| epoch  64 |   100/  216 batches | lr 0.00000 | ms/batch 77.34 | loss  2.91 | ppl    18.41 
| epoch  64 |   200/  216 batches | lr 0.00000 | ms/batch 77.00 | loss  2.89 | ppl    18.08 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 17.14s | valid loss  4.17 | valid ppl    64.85 | valid bpc    6.019
-----------------------------------------------------------------------------------------
PROGRESS: 64.0%
| epoch  65 |   100/  216 batches | lr 0.00000 | ms/batch 78.12 | loss  2.94 | ppl    18.97 
| epoch  65 |   200/  216 batches | lr 0.00000 | ms/batch 76.15 | loss  2.89 | ppl    18.01 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 17.14s | valid loss  4.23 | valid ppl    69.05 | valid bpc    6.110
-----------------------------------------------------------------------------------------
PROGRESS: 65.0%
| epoch  66 |   100/  216 batches | lr 0.00000 | ms/batch 77.73 | loss  2.95 | ppl    19.06 
| epoch  66 |   200/  216 batches | lr 0.00000 | ms/batch 76.58 | loss  2.90 | ppl    18.23 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 17.14s | valid loss  4.21 | valid ppl    67.69 | valid bpc    6.081
-----------------------------------------------------------------------------------------
PROGRESS: 66.0%
| epoch  67 |   100/  216 batches | lr 0.00000 | ms/batch 78.08 | loss  2.93 | ppl    18.66 
| epoch  67 |   200/  216 batches | lr 0.00000 | ms/batch 76.27 | loss  2.91 | ppl    18.30 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 17.14s | valid loss  4.19 | valid ppl    65.74 | valid bpc    6.039
-----------------------------------------------------------------------------------------
PROGRESS: 67.0%
| epoch  68 |   100/  216 batches | lr 0.00000 | ms/batch 77.98 | loss  2.95 | ppl    19.03 
| epoch  68 |   200/  216 batches | lr 0.00000 | ms/batch 76.47 | loss  2.89 | ppl    17.99 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 17.14s | valid loss  4.18 | valid ppl    65.47 | valid bpc    6.033
-----------------------------------------------------------------------------------------
PROGRESS: 68.0%
| epoch  69 |   100/  216 batches | lr 0.00000 | ms/batch 78.41 | loss  2.92 | ppl    18.58 
| epoch  69 |   200/  216 batches | lr 0.00000 | ms/batch 76.31 | loss  2.91 | ppl    18.34 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 17.19s | valid loss  4.18 | valid ppl    65.14 | valid bpc    6.025
-----------------------------------------------------------------------------------------
PROGRESS: 69.0%
| epoch  70 |   100/  216 batches | lr 0.00000 | ms/batch 77.44 | loss  2.92 | ppl    18.59 
| epoch  70 |   200/  216 batches | lr 0.00000 | ms/batch 76.93 | loss  2.91 | ppl    18.42 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 17.14s | valid loss  4.22 | valid ppl    68.04 | valid bpc    6.088
-----------------------------------------------------------------------------------------
PROGRESS: 70.0%
| epoch  71 |   100/  216 batches | lr 0.00000 | ms/batch 77.52 | loss  2.93 | ppl    18.69 
| epoch  71 |   200/  216 batches | lr 0.00000 | ms/batch 76.74 | loss  2.92 | ppl    18.63 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 17.14s | valid loss  4.20 | valid ppl    66.74 | valid bpc    6.061
-----------------------------------------------------------------------------------------
PROGRESS: 71.0%
| epoch  72 |   100/  216 batches | lr 0.00000 | ms/batch 78.10 | loss  2.93 | ppl    18.66 
| epoch  72 |   200/  216 batches | lr 0.00000 | ms/batch 76.34 | loss  2.89 | ppl    17.98 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 17.14s | valid loss  4.17 | valid ppl    64.64 | valid bpc    6.014
-----------------------------------------------------------------------------------------
PROGRESS: 72.0%
| epoch  73 |   100/  216 batches | lr 0.00000 | ms/batch 78.04 | loss  2.92 | ppl    18.55 
| epoch  73 |   200/  216 batches | lr 0.00000 | ms/batch 76.82 | loss  2.91 | ppl    18.29 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 17.19s | valid loss  4.18 | valid ppl    65.18 | valid bpc    6.026
-----------------------------------------------------------------------------------------
PROGRESS: 73.0%
| epoch  74 |   100/  216 batches | lr 0.00000 | ms/batch 77.86 | loss  2.95 | ppl    19.15 
| epoch  74 |   200/  216 batches | lr 0.00000 | ms/batch 76.45 | loss  2.90 | ppl    18.22 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 17.14s | valid loss  4.23 | valid ppl    68.83 | valid bpc    6.105
-----------------------------------------------------------------------------------------
PROGRESS: 74.0%
| epoch  75 |   100/  216 batches | lr 0.00000 | ms/batch 77.77 | loss  2.93 | ppl    18.73 
| epoch  75 |   200/  216 batches | lr 0.00000 | ms/batch 76.64 | loss  2.92 | ppl    18.62 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 17.15s | valid loss  4.17 | valid ppl    64.46 | valid bpc    6.010
-----------------------------------------------------------------------------------------
PROGRESS: 75.0%
| epoch  76 |   100/  216 batches | lr 0.00000 | ms/batch 77.72 | loss  2.92 | ppl    18.62 
| epoch  76 |   200/  216 batches | lr 0.00000 | ms/batch 76.75 | loss  2.89 | ppl    18.00 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 17.15s | valid loss  4.26 | valid ppl    70.70 | valid bpc    6.144
-----------------------------------------------------------------------------------------
PROGRESS: 76.0%
| epoch  77 |   100/  216 batches | lr 0.00000 | ms/batch 77.64 | loss  2.94 | ppl    18.86 
| epoch  77 |   200/  216 batches | lr 0.00000 | ms/batch 76.66 | loss  2.90 | ppl    18.25 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 17.13s | valid loss  4.20 | valid ppl    66.53 | valid bpc    6.056
-----------------------------------------------------------------------------------------
PROGRESS: 77.0%
| epoch  78 |   100/  216 batches | lr 0.00000 | ms/batch 78.10 | loss  2.94 | ppl    19.01 
| epoch  78 |   200/  216 batches | lr 0.00000 | ms/batch 76.31 | loss  2.89 | ppl    18.01 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 17.14s | valid loss  4.22 | valid ppl    68.23 | valid bpc    6.092
-----------------------------------------------------------------------------------------
PROGRESS: 78.0%
| epoch  79 |   100/  216 batches | lr 0.00000 | ms/batch 77.88 | loss  2.93 | ppl    18.71 
| epoch  79 |   200/  216 batches | lr 0.00000 | ms/batch 76.58 | loss  2.92 | ppl    18.57 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 17.15s | valid loss  4.20 | valid ppl    66.73 | valid bpc    6.060
-----------------------------------------------------------------------------------------
PROGRESS: 79.0%
| epoch  80 |   100/  216 batches | lr 0.00000 | ms/batch 78.10 | loss  2.94 | ppl    18.87 
| epoch  80 |   200/  216 batches | lr 0.00000 | ms/batch 76.27 | loss  2.90 | ppl    18.22 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 17.14s | valid loss  4.17 | valid ppl    65.01 | valid bpc    6.023
-----------------------------------------------------------------------------------------
PROGRESS: 80.0%
| epoch  81 |   100/  216 batches | lr 0.00000 | ms/batch 77.93 | loss  2.95 | ppl    19.13 
| epoch  81 |   200/  216 batches | lr 0.00000 | ms/batch 76.41 | loss  2.90 | ppl    18.14 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 17.15s | valid loss  4.16 | valid ppl    63.81 | valid bpc    5.996
-----------------------------------------------------------------------------------------
PROGRESS: 81.0%
| epoch  82 |   100/  216 batches | lr 0.00000 | ms/batch 77.92 | loss  2.94 | ppl    18.97 
| epoch  82 |   200/  216 batches | lr 0.00000 | ms/batch 76.47 | loss  2.92 | ppl    18.45 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 17.14s | valid loss  4.17 | valid ppl    64.47 | valid bpc    6.011
-----------------------------------------------------------------------------------------
PROGRESS: 82.0%
| epoch  83 |   100/  216 batches | lr 0.00000 | ms/batch 77.90 | loss  2.94 | ppl    18.94 
| epoch  83 |   200/  216 batches | lr 0.00000 | ms/batch 76.46 | loss  2.88 | ppl    17.81 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 17.14s | valid loss  4.25 | valid ppl    70.14 | valid bpc    6.132
-----------------------------------------------------------------------------------------
PROGRESS: 83.0%
| epoch  84 |   100/  216 batches | lr 0.00000 | ms/batch 77.82 | loss  2.93 | ppl    18.75 
| epoch  84 |   200/  216 batches | lr 0.00000 | ms/batch 76.33 | loss  2.90 | ppl    18.20 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 17.14s | valid loss  4.21 | valid ppl    67.50 | valid bpc    6.077
-----------------------------------------------------------------------------------------
PROGRESS: 84.0%
| epoch  85 |   100/  216 batches | lr 0.00000 | ms/batch 77.95 | loss  2.92 | ppl    18.63 
| epoch  85 |   200/  216 batches | lr 0.00000 | ms/batch 76.41 | loss  2.91 | ppl    18.34 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 17.14s | valid loss  4.16 | valid ppl    64.07 | valid bpc    6.002
-----------------------------------------------------------------------------------------
PROGRESS: 85.0%
| epoch  86 |   100/  216 batches | lr 0.00000 | ms/batch 77.78 | loss  2.94 | ppl    18.89 
| epoch  86 |   200/  216 batches | lr 0.00000 | ms/batch 76.58 | loss  2.91 | ppl    18.30 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 17.14s | valid loss  4.17 | valid ppl    64.48 | valid bpc    6.011
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  216 batches | lr 0.00000 | ms/batch 77.46 | loss  2.92 | ppl    18.61 
| epoch  87 |   200/  216 batches | lr 0.00000 | ms/batch 76.96 | loss  2.92 | ppl    18.59 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 17.15s | valid loss  4.17 | valid ppl    64.42 | valid bpc    6.009
-----------------------------------------------------------------------------------------
PROGRESS: 87.0%
| epoch  88 |   100/  216 batches | lr 0.00000 | ms/batch 77.97 | loss  2.92 | ppl    18.46 
| epoch  88 |   200/  216 batches | lr 0.00000 | ms/batch 76.41 | loss  2.88 | ppl    17.88 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 17.15s | valid loss  4.20 | valid ppl    66.46 | valid bpc    6.054
-----------------------------------------------------------------------------------------
PROGRESS: 88.0%
| epoch  89 |   100/  216 batches | lr 0.00000 | ms/batch 77.27 | loss  2.93 | ppl    18.71 
| epoch  89 |   200/  216 batches | lr 0.00000 | ms/batch 77.11 | loss  2.90 | ppl    18.13 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 17.15s | valid loss  4.19 | valid ppl    66.31 | valid bpc    6.051
-----------------------------------------------------------------------------------------
PROGRESS: 89.0%
| epoch  90 |   100/  216 batches | lr 0.00000 | ms/batch 77.59 | loss  2.94 | ppl    18.93 
| epoch  90 |   200/  216 batches | lr 0.00000 | ms/batch 76.78 | loss  2.89 | ppl    17.91 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 17.15s | valid loss  4.24 | valid ppl    69.36 | valid bpc    6.116
-----------------------------------------------------------------------------------------
PROGRESS: 90.0%
| epoch  91 |   100/  216 batches | lr 0.00000 | ms/batch 78.03 | loss  2.95 | ppl    19.17 
| epoch  91 |   200/  216 batches | lr 0.00000 | ms/batch 76.27 | loss  2.88 | ppl    17.86 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 17.14s | valid loss  4.19 | valid ppl    66.28 | valid bpc    6.050
-----------------------------------------------------------------------------------------
PROGRESS: 91.0%
| epoch  92 |   100/  216 batches | lr 0.00000 | ms/batch 77.86 | loss  2.92 | ppl    18.49 
| epoch  92 |   200/  216 batches | lr 0.00000 | ms/batch 76.56 | loss  2.93 | ppl    18.64 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 17.15s | valid loss  4.22 | valid ppl    67.77 | valid bpc    6.083
-----------------------------------------------------------------------------------------
PROGRESS: 92.0%
| epoch  93 |   100/  216 batches | lr 0.00000 | ms/batch 78.02 | loss  2.93 | ppl    18.69 
| epoch  93 |   200/  216 batches | lr 0.00000 | ms/batch 76.31 | loss  2.91 | ppl    18.27 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 17.14s | valid loss  4.17 | valid ppl    64.49 | valid bpc    6.011
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  216 batches | lr 0.00000 | ms/batch 77.70 | loss  2.94 | ppl    18.97 
| epoch  94 |   200/  216 batches | lr 0.00000 | ms/batch 76.73 | loss  2.91 | ppl    18.38 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 17.15s | valid loss  4.12 | valid ppl    61.50 | valid bpc    5.943
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 94.0%
| epoch  95 |   100/  216 batches | lr 0.00000 | ms/batch 77.75 | loss  2.93 | ppl    18.76 
| epoch  95 |   200/  216 batches | lr 0.00000 | ms/batch 76.41 | loss  2.89 | ppl    18.05 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 17.15s | valid loss  4.22 | valid ppl    68.27 | valid bpc    6.093
-----------------------------------------------------------------------------------------
PROGRESS: 95.0%
| epoch  96 |   100/  216 batches | lr 0.00000 | ms/batch 77.72 | loss  2.95 | ppl    19.20 
| epoch  96 |   200/  216 batches | lr 0.00000 | ms/batch 76.69 | loss  2.87 | ppl    17.69 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 17.15s | valid loss  4.22 | valid ppl    67.80 | valid bpc    6.083
-----------------------------------------------------------------------------------------
PROGRESS: 96.0%
| epoch  97 |   100/  216 batches | lr 0.00000 | ms/batch 77.98 | loss  2.93 | ppl    18.66 
| epoch  97 |   200/  216 batches | lr 0.00000 | ms/batch 76.47 | loss  2.88 | ppl    17.89 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 17.15s | valid loss  4.22 | valid ppl    67.83 | valid bpc    6.084
-----------------------------------------------------------------------------------------
PROGRESS: 97.0%
| epoch  98 |   100/  216 batches | lr 0.00000 | ms/batch 77.72 | loss  2.94 | ppl    18.93 
| epoch  98 |   200/  216 batches | lr 0.00000 | ms/batch 76.49 | loss  2.89 | ppl    18.07 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 17.14s | valid loss  4.19 | valid ppl    66.05 | valid bpc    6.045
-----------------------------------------------------------------------------------------
PROGRESS: 98.0%
| epoch  99 |   100/  216 batches | lr 0.00000 | ms/batch 78.09 | loss  2.94 | ppl    18.98 
| epoch  99 |   200/  216 batches | lr 0.00000 | ms/batch 76.41 | loss  2.90 | ppl    18.23 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 17.15s | valid loss  4.18 | valid ppl    65.42 | valid bpc    6.032
-----------------------------------------------------------------------------------------
PROGRESS: 99.0%
| epoch 100 |   100/  216 batches | lr 0.00000 | ms/batch 77.59 | loss  2.93 | ppl    18.66 
| epoch 100 |   200/  216 batches | lr 0.00000 | ms/batch 76.76 | loss  2.89 | ppl    18.07 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 17.14s | valid loss  4.19 | valid ppl    66.01 | valid bpc    6.045
-----------------------------------------------------------------------------------------
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  4.14 | test ppl    62.88 | test bpc    5.974
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.3953, Mean Reca: 0.5451, Mean F1: 0.4503
Counter({'NP': 10231, 'S': 3249, 'PP': 2876, 'VP': 2199, 'SBAR': 384, 'QP': 319, 'ADJP': 302, 'SINV': 149, 'ADVP': 143, 'FRAG': 34, 'PRN': 29, 'WHNP': 24, 'NX': 24, 'UCP': 13, 'NAC': 12, 'SQ': 11, 'SBARQ': 8, 'CONJP': 4, 'WHPP': 2, 'X': 2, 'WHADVP': 1})
Counter({'NP': 14432, 'VP': 8130, 'S': 5620, 'PP': 5484, 'SBAR': 1796, 'ADJP': 649, 'QP': 490, 'ADVP': 286, 'SINV': 157, 'PRN': 128, 'NX': 95, 'FRAG': 42, 'WHNP': 37, 'UCP': 32, 'NAC': 30, 'WHPP': 25, 'CONJP': 21, 'SQ': 18, 'SBARQ': 10, 'WHADVP': 9, 'X': 6, 'WHADJP': 4, 'INTJ': 1})
SBAR: 0.2138
NP: 0.7089
VP: 0.2705
PP: 0.5244
ADJP: 0.4653
ADVP: 0.5000
4.941503679474039
-----------------------------------------------------------------------------------------
Dependency parsing performance:
Conll-U Style:
DDA: 0.403
UDA: 0.542
=========================================================================================
Loading dataset...
Loading dictionary...
Number of tokens:  10001
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer_in_parser', nhid=512, nlayers=8, front_layers=2, rear_layers=6, n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=2222, nonmono=5, cuda=True, log_interval=100, save='trained_models/structformer_in_parser_2222_26.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 38475637
Model architecture: StructFormer_In_Parser(
  (transformer_front): Transformer_Front(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(10001, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-1): 2 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
  (transformer_rear): Transformer_Rear(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(10001, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-5): 6 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (output_layer): Linear(in_features=512, out_features=10001, bias=True)
  )
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  216 batches | lr 0.00030 | ms/batch 81.30 | loss  7.32 | ppl  1507.85 
| epoch   1 |   200/  216 batches | lr 0.00030 | ms/batch 75.43 | loss  6.84 | ppl   932.91 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 17.34s | valid loss  6.65 | valid ppl   775.11 | valid bpc    9.598
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  216 batches | lr 0.00030 | ms/batch 76.77 | loss  6.68 | ppl   792.80 
| epoch   2 |   200/  216 batches | lr 0.00030 | ms/batch 76.35 | loss  6.36 | ppl   575.49 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 17.02s | valid loss  6.11 | valid ppl   450.34 | valid bpc    8.815
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  216 batches | lr 0.00030 | ms/batch 76.96 | loss  6.11 | ppl   450.29 
| epoch   3 |   200/  216 batches | lr 0.00030 | ms/batch 76.44 | loss  5.85 | ppl   348.91 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 17.06s | valid loss  5.66 | valid ppl   285.73 | valid bpc    8.159
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  216 batches | lr 0.00030 | ms/batch 77.20 | loss  5.71 | ppl   301.70 
| epoch   4 |   200/  216 batches | lr 0.00030 | ms/batch 76.67 | loss  5.51 | ppl   246.58 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 17.09s | valid loss  5.43 | valid ppl   228.97 | valid bpc    7.839
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  216 batches | lr 0.00030 | ms/batch 77.57 | loss  5.39 | ppl   220.13 
| epoch   5 |   200/  216 batches | lr 0.00030 | ms/batch 76.49 | loss  5.31 | ppl   201.35 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 17.10s | valid loss  5.22 | valid ppl   184.99 | valid bpc    7.531
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  216 batches | lr 0.00030 | ms/batch 77.44 | loss  5.21 | ppl   182.99 
| epoch   6 |   200/  216 batches | lr 0.00030 | ms/batch 76.72 | loss  5.13 | ppl   169.06 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 17.12s | valid loss  5.09 | valid ppl   162.96 | valid bpc    7.348
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  216 batches | lr 0.00030 | ms/batch 77.18 | loss  5.04 | ppl   154.85 
| epoch   7 |   200/  216 batches | lr 0.00030 | ms/batch 76.65 | loss  4.96 | ppl   142.26 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 17.14s | valid loss  4.98 | valid ppl   146.10 | valid bpc    7.191
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  216 batches | lr 0.00030 | ms/batch 77.46 | loss  4.93 | ppl   138.24 
| epoch   8 |   200/  216 batches | lr 0.00030 | ms/batch 76.94 | loss  4.85 | ppl   127.57 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 17.14s | valid loss  4.89 | valid ppl   132.90 | valid bpc    7.054
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 8.0%
| epoch   9 |   100/  216 batches | lr 0.00030 | ms/batch 77.42 | loss  4.80 | ppl   121.15 
| epoch   9 |   200/  216 batches | lr 0.00030 | ms/batch 76.54 | loss  4.74 | ppl   114.41 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 17.13s | valid loss  4.81 | valid ppl   122.87 | valid bpc    6.941
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  216 batches | lr 0.00030 | ms/batch 77.63 | loss  4.68 | ppl   107.80 
| epoch  10 |   200/  216 batches | lr 0.00030 | ms/batch 76.60 | loss  4.63 | ppl   102.13 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 17.13s | valid loss  4.73 | valid ppl   112.86 | valid bpc    6.818
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  216 batches | lr 0.00030 | ms/batch 78.20 | loss  4.59 | ppl    98.03 
| epoch  11 |   200/  216 batches | lr 0.00030 | ms/batch 76.06 | loss  4.52 | ppl    91.96 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 17.13s | valid loss  4.65 | valid ppl   104.72 | valid bpc    6.710
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  216 batches | lr 0.00030 | ms/batch 77.58 | loss  4.50 | ppl    90.03 
| epoch  12 |   200/  216 batches | lr 0.00030 | ms/batch 76.58 | loss  4.44 | ppl    85.14 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 17.12s | valid loss  4.58 | valid ppl    97.95 | valid bpc    6.614
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 12.0%
| epoch  13 |   100/  216 batches | lr 0.00030 | ms/batch 77.31 | loss  4.40 | ppl    81.70 
| epoch  13 |   200/  216 batches | lr 0.00030 | ms/batch 77.01 | loss  4.38 | ppl    79.91 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 17.14s | valid loss  4.58 | valid ppl    97.44 | valid bpc    6.607
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 13.0%
| epoch  14 |   100/  216 batches | lr 0.00030 | ms/batch 77.77 | loss  4.31 | ppl    74.39 
| epoch  14 |   200/  216 batches | lr 0.00030 | ms/batch 76.60 | loss  4.29 | ppl    72.78 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 17.15s | valid loss  4.52 | valid ppl    91.72 | valid bpc    6.519
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  216 batches | lr 0.00030 | ms/batch 78.10 | loss  4.25 | ppl    69.78 
| epoch  15 |   200/  216 batches | lr 0.00030 | ms/batch 76.16 | loss  4.19 | ppl    65.96 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 17.14s | valid loss  4.49 | valid ppl    88.93 | valid bpc    6.475
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 15.0%
| epoch  16 |   100/  216 batches | lr 0.00030 | ms/batch 77.78 | loss  4.19 | ppl    66.14 
| epoch  16 |   200/  216 batches | lr 0.00030 | ms/batch 76.45 | loss  4.15 | ppl    63.60 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 17.13s | valid loss  4.48 | valid ppl    88.13 | valid bpc    6.462
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 16.0%
| epoch  17 |   100/  216 batches | lr 0.00030 | ms/batch 77.80 | loss  4.13 | ppl    62.04 
| epoch  17 |   200/  216 batches | lr 0.00030 | ms/batch 76.62 | loss  4.10 | ppl    60.42 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 17.15s | valid loss  4.44 | valid ppl    84.43 | valid bpc    6.400
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 17.0%
| epoch  18 |   100/  216 batches | lr 0.00030 | ms/batch 77.53 | loss  4.02 | ppl    55.80 
| epoch  18 |   200/  216 batches | lr 0.00030 | ms/batch 76.77 | loss  4.06 | ppl    58.13 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 17.14s | valid loss  4.41 | valid ppl    82.05 | valid bpc    6.358
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 18.0%
| epoch  19 |   100/  216 batches | lr 0.00030 | ms/batch 77.78 | loss  4.00 | ppl    54.38 
| epoch  19 |   200/  216 batches | lr 0.00030 | ms/batch 76.47 | loss  3.97 | ppl    53.05 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 17.13s | valid loss  4.39 | valid ppl    80.85 | valid bpc    6.337
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 19.0%
| epoch  20 |   100/  216 batches | lr 0.00030 | ms/batch 77.94 | loss  3.94 | ppl    51.41 
| epoch  20 |   200/  216 batches | lr 0.00030 | ms/batch 76.22 | loss  3.91 | ppl    49.96 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 17.14s | valid loss  4.35 | valid ppl    77.83 | valid bpc    6.282
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 20.0%
| epoch  21 |   100/  216 batches | lr 0.00030 | ms/batch 77.51 | loss  3.88 | ppl    48.56 
| epoch  21 |   200/  216 batches | lr 0.00030 | ms/batch 76.99 | loss  3.85 | ppl    47.08 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 17.16s | valid loss  4.35 | valid ppl    77.39 | valid bpc    6.274
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 21.0%
| epoch  22 |   100/  216 batches | lr 0.00030 | ms/batch 77.65 | loss  3.85 | ppl    47.22 
| epoch  22 |   200/  216 batches | lr 0.00030 | ms/batch 76.66 | loss  3.81 | ppl    45.05 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 17.13s | valid loss  4.31 | valid ppl    74.25 | valid bpc    6.214
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 22.0%
| epoch  23 |   100/  216 batches | lr 0.00030 | ms/batch 77.81 | loss  3.77 | ppl    43.58 
| epoch  23 |   200/  216 batches | lr 0.00030 | ms/batch 76.53 | loss  3.77 | ppl    43.35 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 17.13s | valid loss  4.31 | valid ppl    74.76 | valid bpc    6.224
-----------------------------------------------------------------------------------------
PROGRESS: 23.0%
| epoch  24 |   100/  216 batches | lr 0.00030 | ms/batch 77.60 | loss  3.73 | ppl    41.87 
| epoch  24 |   200/  216 batches | lr 0.00030 | ms/batch 76.66 | loss  3.70 | ppl    40.62 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 17.14s | valid loss  4.26 | valid ppl    71.13 | valid bpc    6.152
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 24.0%
| epoch  25 |   100/  216 batches | lr 0.00030 | ms/batch 78.23 | loss  3.71 | ppl    40.88 
| epoch  25 |   200/  216 batches | lr 0.00030 | ms/batch 76.07 | loss  3.66 | ppl    38.81 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 17.13s | valid loss  4.31 | valid ppl    74.12 | valid bpc    6.212
-----------------------------------------------------------------------------------------
PROGRESS: 25.0%
| epoch  26 |   100/  216 batches | lr 0.00030 | ms/batch 77.87 | loss  3.62 | ppl    37.46 
| epoch  26 |   200/  216 batches | lr 0.00030 | ms/batch 75.99 | loss  3.61 | ppl    37.14 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 17.14s | valid loss  4.31 | valid ppl    74.21 | valid bpc    6.214
-----------------------------------------------------------------------------------------
PROGRESS: 26.0%
| epoch  27 |   100/  216 batches | lr 0.00030 | ms/batch 77.42 | loss  3.60 | ppl    36.53 
| epoch  27 |   200/  216 batches | lr 0.00030 | ms/batch 76.78 | loss  3.57 | ppl    35.56 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 17.14s | valid loss  4.29 | valid ppl    73.05 | valid bpc    6.191
-----------------------------------------------------------------------------------------
PROGRESS: 27.0%
| epoch  28 |   100/  216 batches | lr 0.00015 | ms/batch 77.67 | loss  3.49 | ppl    32.75 
| epoch  28 |   200/  216 batches | lr 0.00015 | ms/batch 76.78 | loss  3.45 | ppl    31.46 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 17.14s | valid loss  4.22 | valid ppl    68.11 | valid bpc    6.090
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  216 batches | lr 0.00015 | ms/batch 77.71 | loss  3.42 | ppl    30.61 
| epoch  29 |   200/  216 batches | lr 0.00015 | ms/batch 76.67 | loss  3.41 | ppl    30.37 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 17.13s | valid loss  4.23 | valid ppl    68.59 | valid bpc    6.100
-----------------------------------------------------------------------------------------
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  216 batches | lr 0.00015 | ms/batch 77.71 | loss  3.38 | ppl    29.33 
| epoch  30 |   200/  216 batches | lr 0.00015 | ms/batch 76.56 | loss  3.37 | ppl    29.21 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 17.14s | valid loss  4.20 | valid ppl    66.62 | valid bpc    6.058
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 30.0%
| epoch  31 |   100/  216 batches | lr 0.00015 | ms/batch 77.99 | loss  3.37 | ppl    29.19 
| epoch  31 |   200/  216 batches | lr 0.00015 | ms/batch 76.27 | loss  3.34 | ppl    28.35 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 17.14s | valid loss  4.23 | valid ppl    68.67 | valid bpc    6.102
-----------------------------------------------------------------------------------------
PROGRESS: 31.0%
| epoch  32 |   100/  216 batches | lr 0.00015 | ms/batch 77.95 | loss  3.31 | ppl    27.48 
| epoch  32 |   200/  216 batches | lr 0.00015 | ms/batch 76.37 | loss  3.33 | ppl    27.84 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 17.14s | valid loss  4.26 | valid ppl    70.77 | valid bpc    6.145
-----------------------------------------------------------------------------------------
PROGRESS: 32.0%
| epoch  33 |   100/  216 batches | lr 0.00015 | ms/batch 78.04 | loss  3.28 | ppl    26.68 
| epoch  33 |   200/  216 batches | lr 0.00015 | ms/batch 76.35 | loss  3.30 | ppl    27.07 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 17.14s | valid loss  4.22 | valid ppl    68.10 | valid bpc    6.090
-----------------------------------------------------------------------------------------
PROGRESS: 33.0%
| epoch  34 |   100/  216 batches | lr 0.00007 | ms/batch 77.49 | loss  3.24 | ppl    25.48 
| epoch  34 |   200/  216 batches | lr 0.00007 | ms/batch 76.88 | loss  3.22 | ppl    25.00 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 17.14s | valid loss  4.24 | valid ppl    69.63 | valid bpc    6.122
-----------------------------------------------------------------------------------------
PROGRESS: 34.0%
| epoch  35 |   100/  216 batches | lr 0.00007 | ms/batch 77.79 | loss  3.22 | ppl    25.02 
| epoch  35 |   200/  216 batches | lr 0.00007 | ms/batch 76.48 | loss  3.21 | ppl    24.83 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 17.14s | valid loss  4.19 | valid ppl    65.98 | valid bpc    6.044
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 35.0%
| epoch  36 |   100/  216 batches | lr 0.00007 | ms/batch 77.93 | loss  3.19 | ppl    24.27 
| epoch  36 |   200/  216 batches | lr 0.00007 | ms/batch 76.19 | loss  3.19 | ppl    24.23 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 17.14s | valid loss  4.20 | valid ppl    66.64 | valid bpc    6.058
-----------------------------------------------------------------------------------------
PROGRESS: 36.0%
| epoch  37 |   100/  216 batches | lr 0.00007 | ms/batch 78.09 | loss  3.18 | ppl    23.98 
| epoch  37 |   200/  216 batches | lr 0.00007 | ms/batch 76.43 | loss  3.14 | ppl    23.13 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 17.15s | valid loss  4.17 | valid ppl    64.98 | valid bpc    6.022
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 37.0%
| epoch  38 |   100/  216 batches | lr 0.00007 | ms/batch 77.69 | loss  3.15 | ppl    23.42 
| epoch  38 |   200/  216 batches | lr 0.00007 | ms/batch 76.77 | loss  3.13 | ppl    22.98 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 17.13s | valid loss  4.17 | valid ppl    64.97 | valid bpc    6.022
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 38.0%
| epoch  39 |   100/  216 batches | lr 0.00007 | ms/batch 77.84 | loss  3.13 | ppl    22.94 
| epoch  39 |   200/  216 batches | lr 0.00007 | ms/batch 76.58 | loss  3.15 | ppl    23.25 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 17.14s | valid loss  4.21 | valid ppl    67.16 | valid bpc    6.069
-----------------------------------------------------------------------------------------
PROGRESS: 39.0%
| epoch  40 |   100/  216 batches | lr 0.00007 | ms/batch 77.23 | loss  3.09 | ppl    22.06 
| epoch  40 |   200/  216 batches | lr 0.00007 | ms/batch 76.99 | loss  3.13 | ppl    22.79 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 17.14s | valid loss  4.22 | valid ppl    68.02 | valid bpc    6.088
-----------------------------------------------------------------------------------------
PROGRESS: 40.0%
| epoch  41 |   100/  216 batches | lr 0.00007 | ms/batch 77.88 | loss  3.13 | ppl    22.81 
| epoch  41 |   200/  216 batches | lr 0.00007 | ms/batch 76.50 | loss  3.09 | ppl    21.87 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 17.14s | valid loss  4.21 | valid ppl    67.69 | valid bpc    6.081
-----------------------------------------------------------------------------------------
PROGRESS: 41.0%
| epoch  42 |   100/  216 batches | lr 0.00004 | ms/batch 77.68 | loss  3.08 | ppl    21.76 
| epoch  42 |   200/  216 batches | lr 0.00004 | ms/batch 76.58 | loss  3.06 | ppl    21.36 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 17.14s | valid loss  4.22 | valid ppl    67.72 | valid bpc    6.081
-----------------------------------------------------------------------------------------
PROGRESS: 42.0%
| epoch  43 |   100/  216 batches | lr 0.00004 | ms/batch 77.90 | loss  3.08 | ppl    21.66 
| epoch  43 |   200/  216 batches | lr 0.00004 | ms/batch 76.42 | loss  3.05 | ppl    21.03 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 17.14s | valid loss  4.19 | valid ppl    65.92 | valid bpc    6.043
-----------------------------------------------------------------------------------------
PROGRESS: 43.0%
| epoch  44 |   100/  216 batches | lr 0.00004 | ms/batch 77.84 | loss  3.06 | ppl    21.26 
| epoch  44 |   200/  216 batches | lr 0.00004 | ms/batch 76.22 | loss  3.04 | ppl    20.84 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 17.14s | valid loss  4.19 | valid ppl    65.85 | valid bpc    6.041
-----------------------------------------------------------------------------------------
PROGRESS: 44.0%
| epoch  45 |   100/  216 batches | lr 0.00002 | ms/batch 78.07 | loss  3.06 | ppl    21.24 
| epoch  45 |   200/  216 batches | lr 0.00002 | ms/batch 76.30 | loss  3.02 | ppl    20.56 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 17.15s | valid loss  4.20 | valid ppl    66.87 | valid bpc    6.063
-----------------------------------------------------------------------------------------
PROGRESS: 45.0%
| epoch  46 |   100/  216 batches | lr 0.00002 | ms/batch 77.96 | loss  3.05 | ppl    21.07 
| epoch  46 |   200/  216 batches | lr 0.00002 | ms/batch 76.39 | loss  2.99 | ppl    19.85 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 17.14s | valid loss  4.21 | valid ppl    67.50 | valid bpc    6.077
-----------------------------------------------------------------------------------------
PROGRESS: 46.0%
| epoch  47 |   100/  216 batches | lr 0.00002 | ms/batch 77.89 | loss  3.04 | ppl    20.82 
| epoch  47 |   200/  216 batches | lr 0.00002 | ms/batch 76.43 | loss  3.02 | ppl    20.47 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 17.14s | valid loss  4.20 | valid ppl    66.44 | valid bpc    6.054
-----------------------------------------------------------------------------------------
PROGRESS: 47.0%
| epoch  48 |   100/  216 batches | lr 0.00001 | ms/batch 77.76 | loss  3.05 | ppl    21.10 
| epoch  48 |   200/  216 batches | lr 0.00001 | ms/batch 76.53 | loss  2.98 | ppl    19.71 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 17.14s | valid loss  4.18 | valid ppl    65.16 | valid bpc    6.026
-----------------------------------------------------------------------------------------
PROGRESS: 48.0%
| epoch  49 |   100/  216 batches | lr 0.00001 | ms/batch 77.68 | loss  3.00 | ppl    20.18 
| epoch  49 |   200/  216 batches | lr 0.00001 | ms/batch 76.78 | loss  3.01 | ppl    20.26 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 17.16s | valid loss  4.22 | valid ppl    68.18 | valid bpc    6.091
-----------------------------------------------------------------------------------------
PROGRESS: 49.0%
| epoch  50 |   100/  216 batches | lr 0.00001 | ms/batch 77.73 | loss  3.02 | ppl    20.53 
| epoch  50 |   200/  216 batches | lr 0.00001 | ms/batch 76.72 | loss  2.99 | ppl    19.92 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 17.15s | valid loss  4.17 | valid ppl    64.64 | valid bpc    6.014
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 50.0%
| epoch  51 |   100/  216 batches | lr 0.00001 | ms/batch 77.87 | loss  3.01 | ppl    20.34 
| epoch  51 |   200/  216 batches | lr 0.00001 | ms/batch 76.40 | loss  3.00 | ppl    20.01 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 17.14s | valid loss  4.19 | valid ppl    65.98 | valid bpc    6.044
-----------------------------------------------------------------------------------------
PROGRESS: 51.0%
| epoch  52 |   100/  216 batches | lr 0.00001 | ms/batch 77.56 | loss  3.02 | ppl    20.48 
| epoch  52 |   200/  216 batches | lr 0.00001 | ms/batch 76.65 | loss  2.97 | ppl    19.40 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 17.13s | valid loss  4.15 | valid ppl    63.50 | valid bpc    5.989
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 52.0%
| epoch  53 |   100/  216 batches | lr 0.00001 | ms/batch 77.60 | loss  2.99 | ppl    19.96 
| epoch  53 |   200/  216 batches | lr 0.00001 | ms/batch 76.72 | loss  2.98 | ppl    19.67 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 17.14s | valid loss  4.20 | valid ppl    66.60 | valid bpc    6.058
-----------------------------------------------------------------------------------------
PROGRESS: 53.0%
| epoch  54 |   100/  216 batches | lr 0.00001 | ms/batch 77.87 | loss  3.01 | ppl    20.33 
| epoch  54 |   200/  216 batches | lr 0.00001 | ms/batch 76.48 | loss  2.98 | ppl    19.70 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 17.14s | valid loss  4.14 | valid ppl    63.03 | valid bpc    5.978
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 54.0%
| epoch  55 |   100/  216 batches | lr 0.00001 | ms/batch 77.47 | loss  2.98 | ppl    19.64 
| epoch  55 |   200/  216 batches | lr 0.00001 | ms/batch 76.86 | loss  2.98 | ppl    19.66 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 17.14s | valid loss  4.16 | valid ppl    63.77 | valid bpc    5.995
-----------------------------------------------------------------------------------------
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  216 batches | lr 0.00001 | ms/batch 77.94 | loss  3.00 | ppl    20.13 
| epoch  56 |   200/  216 batches | lr 0.00001 | ms/batch 76.43 | loss  3.00 | ppl    20.10 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 17.13s | valid loss  4.20 | valid ppl    66.51 | valid bpc    6.055
-----------------------------------------------------------------------------------------
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  216 batches | lr 0.00001 | ms/batch 78.00 | loss  2.99 | ppl    19.84 
| epoch  57 |   200/  216 batches | lr 0.00001 | ms/batch 76.30 | loss  2.96 | ppl    19.36 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 17.14s | valid loss  4.23 | valid ppl    68.53 | valid bpc    6.099
-----------------------------------------------------------------------------------------
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  216 batches | lr 0.00000 | ms/batch 77.72 | loss  3.01 | ppl    20.38 
| epoch  58 |   200/  216 batches | lr 0.00000 | ms/batch 76.61 | loss  2.95 | ppl    19.10 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 17.14s | valid loss  4.17 | valid ppl    64.53 | valid bpc    6.012
-----------------------------------------------------------------------------------------
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  216 batches | lr 0.00000 | ms/batch 77.45 | loss  2.99 | ppl    19.93 
| epoch  59 |   200/  216 batches | lr 0.00000 | ms/batch 76.87 | loss  2.97 | ppl    19.59 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 17.14s | valid loss  4.14 | valid ppl    62.72 | valid bpc    5.971
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 59.0%
| epoch  60 |   100/  216 batches | lr 0.00000 | ms/batch 78.12 | loss  2.99 | ppl    19.88 
| epoch  60 |   200/  216 batches | lr 0.00000 | ms/batch 76.14 | loss  2.98 | ppl    19.78 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 17.13s | valid loss  4.17 | valid ppl    64.91 | valid bpc    6.020
-----------------------------------------------------------------------------------------
PROGRESS: 60.0%
| epoch  61 |   100/  216 batches | lr 0.00000 | ms/batch 78.06 | loss  3.00 | ppl    20.18 
| epoch  61 |   200/  216 batches | lr 0.00000 | ms/batch 76.27 | loss  2.97 | ppl    19.55 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 17.14s | valid loss  4.21 | valid ppl    67.06 | valid bpc    6.067
-----------------------------------------------------------------------------------------
PROGRESS: 61.0%
| epoch  62 |   100/  216 batches | lr 0.00000 | ms/batch 78.20 | loss  2.98 | ppl    19.68 
| epoch  62 |   200/  216 batches | lr 0.00000 | ms/batch 76.10 | loss  2.98 | ppl    19.70 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 17.14s | valid loss  4.18 | valid ppl    65.32 | valid bpc    6.030
-----------------------------------------------------------------------------------------
PROGRESS: 62.0%
| epoch  63 |   100/  216 batches | lr 0.00000 | ms/batch 77.85 | loss  2.99 | ppl    19.80 
| epoch  63 |   200/  216 batches | lr 0.00000 | ms/batch 76.27 | loss  2.98 | ppl    19.62 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 17.12s | valid loss  4.20 | valid ppl    66.72 | valid bpc    6.060
-----------------------------------------------------------------------------------------
PROGRESS: 63.0%
| epoch  64 |   100/  216 batches | lr 0.00000 | ms/batch 77.36 | loss  2.98 | ppl    19.73 
| epoch  64 |   200/  216 batches | lr 0.00000 | ms/batch 77.03 | loss  2.98 | ppl    19.76 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 17.14s | valid loss  4.18 | valid ppl    65.32 | valid bpc    6.030
-----------------------------------------------------------------------------------------
PROGRESS: 64.0%
| epoch  65 |   100/  216 batches | lr 0.00000 | ms/batch 77.32 | loss  2.98 | ppl    19.68 
| epoch  65 |   200/  216 batches | lr 0.00000 | ms/batch 76.99 | loss  2.97 | ppl    19.47 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 17.14s | valid loss  4.21 | valid ppl    67.42 | valid bpc    6.075
-----------------------------------------------------------------------------------------
PROGRESS: 65.0%
| epoch  66 |   100/  216 batches | lr 0.00000 | ms/batch 77.50 | loss  3.00 | ppl    20.17 
| epoch  66 |   200/  216 batches | lr 0.00000 | ms/batch 76.78 | loss  2.97 | ppl    19.47 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 17.14s | valid loss  4.21 | valid ppl    67.26 | valid bpc    6.072
-----------------------------------------------------------------------------------------
PROGRESS: 66.0%
| epoch  67 |   100/  216 batches | lr 0.00000 | ms/batch 77.99 | loss  2.96 | ppl    19.34 
| epoch  67 |   200/  216 batches | lr 0.00000 | ms/batch 76.31 | loss  2.98 | ppl    19.60 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 17.14s | valid loss  4.18 | valid ppl    65.66 | valid bpc    6.037
-----------------------------------------------------------------------------------------
PROGRESS: 67.0%
| epoch  68 |   100/  216 batches | lr 0.00000 | ms/batch 77.59 | loss  3.00 | ppl    20.06 
| epoch  68 |   200/  216 batches | lr 0.00000 | ms/batch 76.37 | loss  2.96 | ppl    19.25 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 17.13s | valid loss  4.18 | valid ppl    65.18 | valid bpc    6.026
-----------------------------------------------------------------------------------------
PROGRESS: 68.0%
| epoch  69 |   100/  216 batches | lr 0.00000 | ms/batch 77.91 | loss  3.01 | ppl    20.23 
| epoch  69 |   200/  216 batches | lr 0.00000 | ms/batch 76.51 | loss  2.95 | ppl    19.08 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 17.14s | valid loss  4.18 | valid ppl    65.33 | valid bpc    6.030
-----------------------------------------------------------------------------------------
PROGRESS: 69.0%
| epoch  70 |   100/  216 batches | lr 0.00000 | ms/batch 77.57 | loss  3.00 | ppl    20.02 
| epoch  70 |   200/  216 batches | lr 0.00000 | ms/batch 76.68 | loss  2.96 | ppl    19.23 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 17.14s | valid loss  4.18 | valid ppl    65.33 | valid bpc    6.030
-----------------------------------------------------------------------------------------
PROGRESS: 70.0%
| epoch  71 |   100/  216 batches | lr 0.00000 | ms/batch 77.41 | loss  2.98 | ppl    19.62 
| epoch  71 |   200/  216 batches | lr 0.00000 | ms/batch 76.83 | loss  2.95 | ppl    19.19 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 17.14s | valid loss  4.16 | valid ppl    64.29 | valid bpc    6.006
-----------------------------------------------------------------------------------------
PROGRESS: 71.0%
| epoch  72 |   100/  216 batches | lr 0.00000 | ms/batch 78.15 | loss  3.00 | ppl    20.14 
| epoch  72 |   200/  216 batches | lr 0.00000 | ms/batch 76.23 | loss  2.95 | ppl    19.09 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 17.14s | valid loss  4.17 | valid ppl    64.57 | valid bpc    6.013
-----------------------------------------------------------------------------------------
PROGRESS: 72.0%
| epoch  73 |   100/  216 batches | lr 0.00000 | ms/batch 77.70 | loss  2.99 | ppl    19.88 
| epoch  73 |   200/  216 batches | lr 0.00000 | ms/batch 76.66 | loss  2.97 | ppl    19.50 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 17.14s | valid loss  4.22 | valid ppl    68.30 | valid bpc    6.094
-----------------------------------------------------------------------------------------
PROGRESS: 73.0%
| epoch  74 |   100/  216 batches | lr 0.00000 | ms/batch 77.95 | loss  3.00 | ppl    20.16 
| epoch  74 |   200/  216 batches | lr 0.00000 | ms/batch 76.34 | loss  2.95 | ppl    19.18 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 17.14s | valid loss  4.21 | valid ppl    67.23 | valid bpc    6.071
-----------------------------------------------------------------------------------------
PROGRESS: 74.0%
| epoch  75 |   100/  216 batches | lr 0.00000 | ms/batch 77.62 | loss  3.00 | ppl    20.06 
| epoch  75 |   200/  216 batches | lr 0.00000 | ms/batch 76.50 | loss  2.93 | ppl    18.67 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 17.13s | valid loss  4.16 | valid ppl    64.34 | valid bpc    6.008
-----------------------------------------------------------------------------------------
PROGRESS: 75.0%
| epoch  76 |   100/  216 batches | lr 0.00000 | ms/batch 77.87 | loss  2.97 | ppl    19.58 
| epoch  76 |   200/  216 batches | lr 0.00000 | ms/batch 76.49 | loss  2.94 | ppl    19.00 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 17.14s | valid loss  4.20 | valid ppl    66.48 | valid bpc    6.055
-----------------------------------------------------------------------------------------
PROGRESS: 76.0%
| epoch  77 |   100/  216 batches | lr 0.00000 | ms/batch 77.78 | loss  3.00 | ppl    20.04 
| epoch  77 |   200/  216 batches | lr 0.00000 | ms/batch 76.53 | loss  2.94 | ppl    18.95 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 17.14s | valid loss  4.18 | valid ppl    65.54 | valid bpc    6.034
-----------------------------------------------------------------------------------------
PROGRESS: 77.0%
| epoch  78 |   100/  216 batches | lr 0.00000 | ms/batch 77.85 | loss  2.98 | ppl    19.60 
| epoch  78 |   200/  216 batches | lr 0.00000 | ms/batch 76.61 | loss  2.96 | ppl    19.29 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 17.16s | valid loss  4.20 | valid ppl    66.92 | valid bpc    6.064
-----------------------------------------------------------------------------------------
PROGRESS: 78.0%
| epoch  79 |   100/  216 batches | lr 0.00000 | ms/batch 77.98 | loss  2.99 | ppl    19.96 
| epoch  79 |   200/  216 batches | lr 0.00000 | ms/batch 76.45 | loss  2.93 | ppl    18.80 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 17.15s | valid loss  4.18 | valid ppl    65.64 | valid bpc    6.037
-----------------------------------------------------------------------------------------
PROGRESS: 79.0%
| epoch  80 |   100/  216 batches | lr 0.00000 | ms/batch 77.80 | loss  2.99 | ppl    19.86 
| epoch  80 |   200/  216 batches | lr 0.00000 | ms/batch 76.63 | loss  2.96 | ppl    19.26 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 17.15s | valid loss  4.18 | valid ppl    65.64 | valid bpc    6.036
-----------------------------------------------------------------------------------------
PROGRESS: 80.0%
| epoch  81 |   100/  216 batches | lr 0.00000 | ms/batch 77.39 | loss  2.97 | ppl    19.48 
| epoch  81 |   200/  216 batches | lr 0.00000 | ms/batch 76.69 | loss  2.97 | ppl    19.48 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 17.15s | valid loss  4.12 | valid ppl    61.66 | valid bpc    5.946
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 81.0%
| epoch  82 |   100/  216 batches | lr 0.00000 | ms/batch 77.69 | loss  2.98 | ppl    19.76 
| epoch  82 |   200/  216 batches | lr 0.00000 | ms/batch 76.78 | loss  2.98 | ppl    19.61 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 17.15s | valid loss  4.16 | valid ppl    64.15 | valid bpc    6.003
-----------------------------------------------------------------------------------------
PROGRESS: 82.0%
| epoch  83 |   100/  216 batches | lr 0.00000 | ms/batch 77.82 | loss  2.99 | ppl    19.93 
| epoch  83 |   200/  216 batches | lr 0.00000 | ms/batch 76.48 | loss  2.93 | ppl    18.68 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 17.15s | valid loss  4.16 | valid ppl    64.16 | valid bpc    6.004
-----------------------------------------------------------------------------------------
PROGRESS: 83.0%
| epoch  84 |   100/  216 batches | lr 0.00000 | ms/batch 78.13 | loss  2.99 | ppl    19.93 
| epoch  84 |   200/  216 batches | lr 0.00000 | ms/batch 76.27 | loss  2.96 | ppl    19.34 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 17.15s | valid loss  4.17 | valid ppl    64.68 | valid bpc    6.015
-----------------------------------------------------------------------------------------
PROGRESS: 84.0%
| epoch  85 |   100/  216 batches | lr 0.00000 | ms/batch 77.67 | loss  2.98 | ppl    19.76 
| epoch  85 |   200/  216 batches | lr 0.00000 | ms/batch 76.82 | loss  2.96 | ppl    19.36 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 17.16s | valid loss  4.18 | valid ppl    65.32 | valid bpc    6.029
-----------------------------------------------------------------------------------------
PROGRESS: 85.0%
| epoch  86 |   100/  216 batches | lr 0.00000 | ms/batch 77.50 | loss  2.98 | ppl    19.66 
| epoch  86 |   200/  216 batches | lr 0.00000 | ms/batch 76.95 | loss  2.96 | ppl    19.37 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 17.15s | valid loss  4.16 | valid ppl    64.16 | valid bpc    6.004
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  216 batches | lr 0.00000 | ms/batch 77.82 | loss  3.01 | ppl    20.28 
| epoch  87 |   200/  216 batches | lr 0.00000 | ms/batch 76.40 | loss  2.95 | ppl    19.10 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 17.14s | valid loss  4.21 | valid ppl    67.30 | valid bpc    6.073
-----------------------------------------------------------------------------------------
PROGRESS: 87.0%
| epoch  88 |   100/  216 batches | lr 0.00000 | ms/batch 77.71 | loss  2.99 | ppl    19.89 
| epoch  88 |   200/  216 batches | lr 0.00000 | ms/batch 76.78 | loss  2.97 | ppl    19.42 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 17.16s | valid loss  4.18 | valid ppl    65.26 | valid bpc    6.028
-----------------------------------------------------------------------------------------
PROGRESS: 88.0%
| epoch  89 |   100/  216 batches | lr 0.00000 | ms/batch 78.25 | loss  2.97 | ppl    19.58 
| epoch  89 |   200/  216 batches | lr 0.00000 | ms/batch 76.16 | loss  2.95 | ppl    19.03 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 17.15s | valid loss  4.17 | valid ppl    64.93 | valid bpc    6.021
-----------------------------------------------------------------------------------------
PROGRESS: 89.0%
| epoch  90 |   100/  216 batches | lr 0.00000 | ms/batch 77.88 | loss  2.98 | ppl    19.65 
| epoch  90 |   200/  216 batches | lr 0.00000 | ms/batch 76.47 | loss  2.96 | ppl    19.39 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 17.15s | valid loss  4.14 | valid ppl    63.09 | valid bpc    5.979
-----------------------------------------------------------------------------------------
PROGRESS: 90.0%
| epoch  91 |   100/  216 batches | lr 0.00000 | ms/batch 77.31 | loss  3.00 | ppl    20.06 
| epoch  91 |   200/  216 batches | lr 0.00000 | ms/batch 76.84 | loss  2.94 | ppl    19.00 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 17.13s | valid loss  4.21 | valid ppl    67.54 | valid bpc    6.078
-----------------------------------------------------------------------------------------
PROGRESS: 91.0%
| epoch  92 |   100/  216 batches | lr 0.00000 | ms/batch 77.47 | loss  2.98 | ppl    19.63 
| epoch  92 |   200/  216 batches | lr 0.00000 | ms/batch 76.87 | loss  2.96 | ppl    19.25 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 17.15s | valid loss  4.16 | valid ppl    63.76 | valid bpc    5.995
-----------------------------------------------------------------------------------------
PROGRESS: 92.0%
| epoch  93 |   100/  216 batches | lr 0.00000 | ms/batch 77.71 | loss  2.98 | ppl    19.74 
| epoch  93 |   200/  216 batches | lr 0.00000 | ms/batch 76.76 | loss  2.96 | ppl    19.34 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 17.15s | valid loss  4.16 | valid ppl    63.83 | valid bpc    5.996
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  216 batches | lr 0.00000 | ms/batch 77.81 | loss  2.96 | ppl    19.20 
| epoch  94 |   200/  216 batches | lr 0.00000 | ms/batch 76.53 | loss  2.96 | ppl    19.27 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 17.14s | valid loss  4.17 | valid ppl    64.50 | valid bpc    6.011
-----------------------------------------------------------------------------------------
PROGRESS: 94.0%
| epoch  95 |   100/  216 batches | lr 0.00000 | ms/batch 77.93 | loss  2.98 | ppl    19.59 
| epoch  95 |   200/  216 batches | lr 0.00000 | ms/batch 76.23 | loss  2.97 | ppl    19.52 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 17.13s | valid loss  4.17 | valid ppl    64.64 | valid bpc    6.014
-----------------------------------------------------------------------------------------
PROGRESS: 95.0%
| epoch  96 |   100/  216 batches | lr 0.00000 | ms/batch 78.07 | loss  2.98 | ppl    19.64 
| epoch  96 |   200/  216 batches | lr 0.00000 | ms/batch 76.25 | loss  2.95 | ppl    19.10 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 17.14s | valid loss  4.13 | valid ppl    62.15 | valid bpc    5.958
-----------------------------------------------------------------------------------------
PROGRESS: 96.0%
| epoch  97 |   100/  216 batches | lr 0.00000 | ms/batch 77.66 | loss  2.98 | ppl    19.64 
| epoch  97 |   200/  216 batches | lr 0.00000 | ms/batch 77.08 | loss  2.96 | ppl    19.25 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 17.19s | valid loss  4.16 | valid ppl    64.22 | valid bpc    6.005
-----------------------------------------------------------------------------------------
PROGRESS: 97.0%
| epoch  98 |   100/  216 batches | lr 0.00000 | ms/batch 77.96 | loss  3.01 | ppl    20.25 
| epoch  98 |   200/  216 batches | lr 0.00000 | ms/batch 76.58 | loss  2.95 | ppl    19.12 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 17.14s | valid loss  4.22 | valid ppl    67.72 | valid bpc    6.081
-----------------------------------------------------------------------------------------
PROGRESS: 98.0%
| epoch  99 |   100/  216 batches | lr 0.00000 | ms/batch 78.04 | loss  2.99 | ppl    19.82 
| epoch  99 |   200/  216 batches | lr 0.00000 | ms/batch 76.24 | loss  2.96 | ppl    19.32 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 17.14s | valid loss  4.18 | valid ppl    65.33 | valid bpc    6.030
-----------------------------------------------------------------------------------------
PROGRESS: 99.0%
| epoch 100 |   100/  216 batches | lr 0.00000 | ms/batch 78.07 | loss  2.98 | ppl    19.60 
| epoch 100 |   200/  216 batches | lr 0.00000 | ms/batch 76.12 | loss  2.98 | ppl    19.67 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 17.15s | valid loss  4.18 | valid ppl    65.45 | valid bpc    6.032
-----------------------------------------------------------------------------------------
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  4.14 | test ppl    63.03 | test bpc    5.978
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.4223, Mean Reca: 0.5820, Mean F1: 0.4813
Counter({'NP': 8711, 'PP': 4251, 'S': 3363, 'VP': 2965, 'SBAR': 536, 'QP': 269, 'ADJP': 266, 'ADVP': 177, 'SINV': 149, 'PRN': 58, 'FRAG': 34, 'WHNP': 30, 'NX': 20, 'WHPP': 15, 'NAC': 10, 'SQ': 10, 'SBARQ': 8, 'UCP': 6, 'X': 3, 'CONJP': 2, 'WHADVP': 1})
Counter({'NP': 14432, 'VP': 8130, 'S': 5620, 'PP': 5484, 'SBAR': 1796, 'ADJP': 649, 'QP': 490, 'ADVP': 286, 'SINV': 157, 'PRN': 128, 'NX': 95, 'FRAG': 42, 'WHNP': 37, 'UCP': 32, 'NAC': 30, 'WHPP': 25, 'CONJP': 21, 'SQ': 18, 'SBARQ': 10, 'WHADVP': 9, 'X': 6, 'WHADJP': 4, 'INTJ': 1})
SBAR: 0.2984
NP: 0.6036
VP: 0.3647
PP: 0.7752
ADJP: 0.4099
ADVP: 0.6189
4.7823935189970035
-----------------------------------------------------------------------------------------
Dependency parsing performance:
Conll-U Style:
DDA: 0.436
UDA: 0.598
=========================================================================================
Loading dataset...
Loading dictionary...
Number of tokens:  10001
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer_in_parser', nhid=512, nlayers=8, front_layers=2, rear_layers=6, n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=3333, nonmono=5, cuda=True, log_interval=100, save='trained_models/structformer_in_parser_3333_26.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 38475637
Model architecture: StructFormer_In_Parser(
  (transformer_front): Transformer_Front(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(10001, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-1): 2 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
  (transformer_rear): Transformer_Rear(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(10001, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-5): 6 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (output_layer): Linear(in_features=512, out_features=10001, bias=True)
  )
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  216 batches | lr 0.00030 | ms/batch 80.99 | loss  7.28 | ppl  1456.30 
| epoch   1 |   200/  216 batches | lr 0.00030 | ms/batch 75.75 | loss  6.83 | ppl   927.31 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 17.37s | valid loss  6.68 | valid ppl   797.29 | valid bpc    9.639
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  216 batches | lr 0.00030 | ms/batch 77.61 | loss  6.68 | ppl   797.99 
| epoch   2 |   200/  216 batches | lr 0.00030 | ms/batch 75.79 | loss  6.32 | ppl   555.14 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 17.03s | valid loss  6.06 | valid ppl   428.35 | valid bpc    8.743
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  216 batches | lr 0.00030 | ms/batch 77.62 | loss  6.06 | ppl   427.34 
| epoch   3 |   200/  216 batches | lr 0.00030 | ms/batch 76.17 | loss  5.79 | ppl   327.84 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 17.08s | valid loss  5.60 | valid ppl   269.42 | valid bpc    8.074
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  216 batches | lr 0.00030 | ms/batch 77.77 | loss  5.64 | ppl   281.74 
| epoch   4 |   200/  216 batches | lr 0.00030 | ms/batch 76.30 | loss  5.47 | ppl   236.85 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 17.11s | valid loss  5.37 | valid ppl   215.14 | valid bpc    7.749
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  216 batches | lr 0.00030 | ms/batch 77.88 | loss  5.36 | ppl   212.86 
| epoch   5 |   200/  216 batches | lr 0.00030 | ms/batch 76.28 | loss  5.24 | ppl   188.06 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 17.12s | valid loss  5.18 | valid ppl   178.11 | valid bpc    7.477
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  216 batches | lr 0.00030 | ms/batch 77.55 | loss  5.15 | ppl   173.18 
| epoch   6 |   200/  216 batches | lr 0.00030 | ms/batch 76.66 | loss  5.08 | ppl   161.56 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 17.13s | valid loss  5.03 | valid ppl   153.17 | valid bpc    7.259
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  216 batches | lr 0.00030 | ms/batch 77.44 | loss  5.00 | ppl   148.91 
| epoch   7 |   200/  216 batches | lr 0.00030 | ms/batch 76.69 | loss  4.93 | ppl   138.94 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 17.14s | valid loss  4.92 | valid ppl   137.34 | valid bpc    7.102
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  216 batches | lr 0.00030 | ms/batch 77.93 | loss  4.89 | ppl   132.99 
| epoch   8 |   200/  216 batches | lr 0.00030 | ms/batch 76.42 | loss  4.79 | ppl   119.94 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 17.15s | valid loss  4.87 | valid ppl   130.46 | valid bpc    7.028
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 8.0%
| epoch   9 |   100/  216 batches | lr 0.00030 | ms/batch 77.85 | loss  4.77 | ppl   118.06 
| epoch   9 |   200/  216 batches | lr 0.00030 | ms/batch 76.49 | loss  4.68 | ppl   108.03 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 17.15s | valid loss  4.79 | valid ppl   120.20 | valid bpc    6.909
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  216 batches | lr 0.00030 | ms/batch 77.96 | loss  4.65 | ppl   104.12 
| epoch  10 |   200/  216 batches | lr 0.00030 | ms/batch 76.43 | loss  4.58 | ppl    97.07 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 17.14s | valid loss  4.72 | valid ppl   112.54 | valid bpc    6.814
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  216 batches | lr 0.00030 | ms/batch 77.53 | loss  4.56 | ppl    95.65 
| epoch  11 |   200/  216 batches | lr 0.00030 | ms/batch 76.52 | loss  4.49 | ppl    89.25 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 17.15s | valid loss  4.66 | valid ppl   105.69 | valid bpc    6.724
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  216 batches | lr 0.00030 | ms/batch 77.67 | loss  4.43 | ppl    83.86 
| epoch  12 |   200/  216 batches | lr 0.00030 | ms/batch 76.68 | loss  4.42 | ppl    83.21 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 17.15s | valid loss  4.57 | valid ppl    96.38 | valid bpc    6.591
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 12.0%
| epoch  13 |   100/  216 batches | lr 0.00030 | ms/batch 77.72 | loss  4.34 | ppl    76.85 
| epoch  13 |   200/  216 batches | lr 0.00030 | ms/batch 76.64 | loss  4.35 | ppl    77.56 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 17.14s | valid loss  4.52 | valid ppl    92.02 | valid bpc    6.524
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 13.0%
| epoch  14 |   100/  216 batches | lr 0.00030 | ms/batch 77.57 | loss  4.25 | ppl    70.24 
| epoch  14 |   200/  216 batches | lr 0.00030 | ms/batch 76.77 | loss  4.27 | ppl    71.43 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 17.15s | valid loss  4.48 | valid ppl    87.99 | valid bpc    6.459
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  216 batches | lr 0.00030 | ms/batch 77.46 | loss  4.20 | ppl    66.69 
| epoch  15 |   200/  216 batches | lr 0.00030 | ms/batch 76.84 | loss  4.16 | ppl    63.90 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 17.15s | valid loss  4.48 | valid ppl    88.42 | valid bpc    6.466
-----------------------------------------------------------------------------------------
PROGRESS: 15.0%
| epoch  16 |   100/  216 batches | lr 0.00030 | ms/batch 78.37 | loss  4.16 | ppl    64.34 
| epoch  16 |   200/  216 batches | lr 0.00030 | ms/batch 76.02 | loss  4.10 | ppl    60.07 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 17.15s | valid loss  4.41 | valid ppl    82.00 | valid bpc    6.358
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 16.0%
| epoch  17 |   100/  216 batches | lr 0.00030 | ms/batch 77.81 | loss  4.09 | ppl    59.84 
| epoch  17 |   200/  216 batches | lr 0.00030 | ms/batch 76.64 | loss  4.03 | ppl    56.50 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 17.15s | valid loss  4.42 | valid ppl    82.77 | valid bpc    6.371
-----------------------------------------------------------------------------------------
PROGRESS: 17.0%
| epoch  18 |   100/  216 batches | lr 0.00030 | ms/batch 77.78 | loss  4.00 | ppl    54.75 
| epoch  18 |   200/  216 batches | lr 0.00030 | ms/batch 76.70 | loss  3.99 | ppl    54.10 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 17.16s | valid loss  4.40 | valid ppl    81.08 | valid bpc    6.341
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 18.0%
| epoch  19 |   100/  216 batches | lr 0.00030 | ms/batch 77.99 | loss  3.95 | ppl    51.88 
| epoch  19 |   200/  216 batches | lr 0.00030 | ms/batch 76.51 | loss  3.92 | ppl    50.43 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 17.16s | valid loss  4.38 | valid ppl    79.87 | valid bpc    6.320
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 19.0%
| epoch  20 |   100/  216 batches | lr 0.00030 | ms/batch 77.69 | loss  3.88 | ppl    48.27 
| epoch  20 |   200/  216 batches | lr 0.00030 | ms/batch 76.72 | loss  3.89 | ppl    49.08 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 17.15s | valid loss  4.38 | valid ppl    80.14 | valid bpc    6.324
-----------------------------------------------------------------------------------------
PROGRESS: 20.0%
| epoch  21 |   100/  216 batches | lr 0.00030 | ms/batch 77.32 | loss  3.84 | ppl    46.49 
| epoch  21 |   200/  216 batches | lr 0.00030 | ms/batch 77.03 | loss  3.82 | ppl    45.69 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 17.15s | valid loss  4.35 | valid ppl    77.14 | valid bpc    6.269
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 21.0%
| epoch  22 |   100/  216 batches | lr 0.00030 | ms/batch 78.05 | loss  3.78 | ppl    43.96 
| epoch  22 |   200/  216 batches | lr 0.00030 | ms/batch 76.26 | loss  3.76 | ppl    43.01 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 17.14s | valid loss  4.34 | valid ppl    76.58 | valid bpc    6.259
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 22.0%
| epoch  23 |   100/  216 batches | lr 0.00030 | ms/batch 78.21 | loss  3.74 | ppl    42.18 
| epoch  23 |   200/  216 batches | lr 0.00030 | ms/batch 76.28 | loss  3.74 | ppl    42.04 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 17.15s | valid loss  4.32 | valid ppl    75.06 | valid bpc    6.230
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 23.0%
| epoch  24 |   100/  216 batches | lr 0.00030 | ms/batch 77.72 | loss  3.67 | ppl    39.14 
| epoch  24 |   200/  216 batches | lr 0.00030 | ms/batch 76.69 | loss  3.69 | ppl    40.03 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 17.15s | valid loss  4.30 | valid ppl    73.61 | valid bpc    6.202
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 24.0%
| epoch  25 |   100/  216 batches | lr 0.00030 | ms/batch 78.13 | loss  3.65 | ppl    38.41 
| epoch  25 |   200/  216 batches | lr 0.00030 | ms/batch 76.37 | loss  3.62 | ppl    37.32 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 17.15s | valid loss  4.28 | valid ppl    72.17 | valid bpc    6.173
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 25.0%
| epoch  26 |   100/  216 batches | lr 0.00030 | ms/batch 77.72 | loss  3.58 | ppl    35.93 
| epoch  26 |   200/  216 batches | lr 0.00030 | ms/batch 76.67 | loss  3.58 | ppl    36.03 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 17.16s | valid loss  4.31 | valid ppl    74.40 | valid bpc    6.217
-----------------------------------------------------------------------------------------
PROGRESS: 26.0%
| epoch  27 |   100/  216 batches | lr 0.00030 | ms/batch 78.06 | loss  3.56 | ppl    35.22 
| epoch  27 |   200/  216 batches | lr 0.00030 | ms/batch 76.42 | loss  3.55 | ppl    34.92 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 17.16s | valid loss  4.28 | valid ppl    72.36 | valid bpc    6.177
-----------------------------------------------------------------------------------------
PROGRESS: 27.0%
| epoch  28 |   100/  216 batches | lr 0.00030 | ms/batch 77.90 | loss  3.50 | ppl    33.10 
| epoch  28 |   200/  216 batches | lr 0.00030 | ms/batch 76.60 | loss  3.50 | ppl    33.10 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 17.16s | valid loss  4.26 | valid ppl    70.77 | valid bpc    6.145
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  216 batches | lr 0.00030 | ms/batch 77.79 | loss  3.47 | ppl    32.13 
| epoch  29 |   200/  216 batches | lr 0.00030 | ms/batch 76.61 | loss  3.46 | ppl    31.69 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 17.15s | valid loss  4.28 | valid ppl    72.20 | valid bpc    6.174
-----------------------------------------------------------------------------------------
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  216 batches | lr 0.00030 | ms/batch 77.89 | loss  3.42 | ppl    30.67 
| epoch  30 |   200/  216 batches | lr 0.00030 | ms/batch 77.02 | loss  3.41 | ppl    30.40 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 17.20s | valid loss  4.27 | valid ppl    71.44 | valid bpc    6.159
-----------------------------------------------------------------------------------------
PROGRESS: 30.0%
| epoch  31 |   100/  216 batches | lr 0.00030 | ms/batch 77.60 | loss  3.36 | ppl    28.80 
| epoch  31 |   200/  216 batches | lr 0.00030 | ms/batch 76.87 | loss  3.40 | ppl    29.89 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 17.16s | valid loss  4.27 | valid ppl    71.57 | valid bpc    6.161
-----------------------------------------------------------------------------------------
PROGRESS: 31.0%
| epoch  32 |   100/  216 batches | lr 0.00015 | ms/batch 77.82 | loss  3.30 | ppl    27.04 
| epoch  32 |   200/  216 batches | lr 0.00015 | ms/batch 76.73 | loss  3.25 | ppl    25.89 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 17.16s | valid loss  4.24 | valid ppl    69.14 | valid bpc    6.111
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 32.0%
| epoch  33 |   100/  216 batches | lr 0.00015 | ms/batch 78.29 | loss  3.22 | ppl    25.05 
| epoch  33 |   200/  216 batches | lr 0.00015 | ms/batch 76.21 | loss  3.19 | ppl    24.30 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 17.15s | valid loss  4.25 | valid ppl    70.26 | valid bpc    6.135
-----------------------------------------------------------------------------------------
PROGRESS: 33.0%
| epoch  34 |   100/  216 batches | lr 0.00015 | ms/batch 78.09 | loss  3.19 | ppl    24.38 
| epoch  34 |   200/  216 batches | lr 0.00015 | ms/batch 76.29 | loss  3.18 | ppl    24.05 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 17.15s | valid loss  4.19 | valid ppl    65.74 | valid bpc    6.039
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 34.0%
| epoch  35 |   100/  216 batches | lr 0.00015 | ms/batch 77.66 | loss  3.16 | ppl    23.48 
| epoch  35 |   200/  216 batches | lr 0.00015 | ms/batch 76.76 | loss  3.15 | ppl    23.32 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 17.15s | valid loss  4.23 | valid ppl    68.73 | valid bpc    6.103
-----------------------------------------------------------------------------------------
PROGRESS: 35.0%
| epoch  36 |   100/  216 batches | lr 0.00015 | ms/batch 78.06 | loss  3.13 | ppl    22.91 
| epoch  36 |   200/  216 batches | lr 0.00015 | ms/batch 76.22 | loss  3.11 | ppl    22.43 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 17.15s | valid loss  4.19 | valid ppl    66.10 | valid bpc    6.047
-----------------------------------------------------------------------------------------
PROGRESS: 36.0%
| epoch  37 |   100/  216 batches | lr 0.00015 | ms/batch 77.71 | loss  3.08 | ppl    21.84 
| epoch  37 |   200/  216 batches | lr 0.00015 | ms/batch 76.56 | loss  3.09 | ppl    21.90 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 17.14s | valid loss  4.23 | valid ppl    68.96 | valid bpc    6.108
-----------------------------------------------------------------------------------------
PROGRESS: 37.0%
| epoch  38 |   100/  216 batches | lr 0.00007 | ms/batch 77.77 | loss  3.06 | ppl    21.25 
| epoch  38 |   200/  216 batches | lr 0.00007 | ms/batch 76.99 | loss  3.01 | ppl    20.32 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 17.19s | valid loss  4.19 | valid ppl    66.03 | valid bpc    6.045
-----------------------------------------------------------------------------------------
PROGRESS: 38.0%
| epoch  39 |   100/  216 batches | lr 0.00007 | ms/batch 78.17 | loss  2.99 | ppl    19.90 
| epoch  39 |   200/  216 batches | lr 0.00007 | ms/batch 76.22 | loss  2.97 | ppl    19.57 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 17.15s | valid loss  4.22 | valid ppl    67.94 | valid bpc    6.086
-----------------------------------------------------------------------------------------
PROGRESS: 39.0%
| epoch  40 |   100/  216 batches | lr 0.00007 | ms/batch 77.56 | loss  2.98 | ppl    19.73 
| epoch  40 |   200/  216 batches | lr 0.00007 | ms/batch 76.83 | loss  2.98 | ppl    19.62 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 17.14s | valid loss  4.24 | valid ppl    69.30 | valid bpc    6.115
-----------------------------------------------------------------------------------------
PROGRESS: 40.0%
| epoch  41 |   100/  216 batches | lr 0.00004 | ms/batch 77.75 | loss  2.97 | ppl    19.53 
| epoch  41 |   200/  216 batches | lr 0.00004 | ms/batch 76.54 | loss  2.94 | ppl    18.90 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 17.14s | valid loss  4.21 | valid ppl    67.03 | valid bpc    6.067
-----------------------------------------------------------------------------------------
PROGRESS: 41.0%
| epoch  42 |   100/  216 batches | lr 0.00004 | ms/batch 77.85 | loss  2.95 | ppl    19.11 
| epoch  42 |   200/  216 batches | lr 0.00004 | ms/batch 76.98 | loss  2.92 | ppl    18.48 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 17.20s | valid loss  4.21 | valid ppl    67.04 | valid bpc    6.067
-----------------------------------------------------------------------------------------
PROGRESS: 42.0%
| epoch  43 |   100/  216 batches | lr 0.00004 | ms/batch 77.95 | loss  2.94 | ppl    18.90 
| epoch  43 |   200/  216 batches | lr 0.00004 | ms/batch 76.46 | loss  2.92 | ppl    18.51 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 17.15s | valid loss  4.18 | valid ppl    65.46 | valid bpc    6.033
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 43.0%
| epoch  44 |   100/  216 batches | lr 0.00004 | ms/batch 77.69 | loss  2.92 | ppl    18.60 
| epoch  44 |   200/  216 batches | lr 0.00004 | ms/batch 76.40 | loss  2.90 | ppl    18.14 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 17.15s | valid loss  4.19 | valid ppl    65.99 | valid bpc    6.044
-----------------------------------------------------------------------------------------
PROGRESS: 44.0%
| epoch  45 |   100/  216 batches | lr 0.00004 | ms/batch 77.69 | loss  2.94 | ppl    18.94 
| epoch  45 |   200/  216 batches | lr 0.00004 | ms/batch 76.75 | loss  2.88 | ppl    17.90 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 17.14s | valid loss  4.21 | valid ppl    67.31 | valid bpc    6.073
-----------------------------------------------------------------------------------------
PROGRESS: 45.0%
| epoch  46 |   100/  216 batches | lr 0.00004 | ms/batch 77.42 | loss  2.91 | ppl    18.44 
| epoch  46 |   200/  216 batches | lr 0.00004 | ms/batch 76.60 | loss  2.88 | ppl    17.78 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 17.14s | valid loss  4.20 | valid ppl    66.53 | valid bpc    6.056
-----------------------------------------------------------------------------------------
PROGRESS: 46.0%
| epoch  47 |   100/  216 batches | lr 0.00002 | ms/batch 77.77 | loss  2.90 | ppl    18.20 
| epoch  47 |   200/  216 batches | lr 0.00002 | ms/batch 76.41 | loss  2.88 | ppl    17.81 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 17.14s | valid loss  4.20 | valid ppl    66.41 | valid bpc    6.053
-----------------------------------------------------------------------------------------
PROGRESS: 47.0%
| epoch  48 |   100/  216 batches | lr 0.00002 | ms/batch 77.33 | loss  2.86 | ppl    17.53 
| epoch  48 |   200/  216 batches | lr 0.00002 | ms/batch 76.84 | loss  2.87 | ppl    17.60 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 17.13s | valid loss  4.17 | valid ppl    64.84 | valid bpc    6.019
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 48.0%
| epoch  49 |   100/  216 batches | lr 0.00002 | ms/batch 77.66 | loss  2.86 | ppl    17.51 
| epoch  49 |   200/  216 batches | lr 0.00002 | ms/batch 76.72 | loss  2.86 | ppl    17.53 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 17.14s | valid loss  4.20 | valid ppl    66.87 | valid bpc    6.063
-----------------------------------------------------------------------------------------
PROGRESS: 49.0%
| epoch  50 |   100/  216 batches | lr 0.00002 | ms/batch 77.60 | loss  2.86 | ppl    17.44 
| epoch  50 |   200/  216 batches | lr 0.00002 | ms/batch 76.64 | loss  2.84 | ppl    17.08 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 17.14s | valid loss  4.20 | valid ppl    66.75 | valid bpc    6.061
-----------------------------------------------------------------------------------------
PROGRESS: 50.0%
| epoch  51 |   100/  216 batches | lr 0.00002 | ms/batch 77.63 | loss  2.88 | ppl    17.79 
| epoch  51 |   200/  216 batches | lr 0.00002 | ms/batch 76.65 | loss  2.85 | ppl    17.25 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 17.14s | valid loss  4.20 | valid ppl    66.37 | valid bpc    6.053
-----------------------------------------------------------------------------------------
PROGRESS: 51.0%
| epoch  52 |   100/  216 batches | lr 0.00001 | ms/batch 77.90 | loss  2.87 | ppl    17.62 
| epoch  52 |   200/  216 batches | lr 0.00001 | ms/batch 76.41 | loss  2.83 | ppl    16.88 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 17.14s | valid loss  4.18 | valid ppl    65.23 | valid bpc    6.028
-----------------------------------------------------------------------------------------
PROGRESS: 52.0%
| epoch  53 |   100/  216 batches | lr 0.00001 | ms/batch 77.46 | loss  2.86 | ppl    17.54 
| epoch  53 |   200/  216 batches | lr 0.00001 | ms/batch 76.55 | loss  2.83 | ppl    16.94 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 17.14s | valid loss  4.16 | valid ppl    64.36 | valid bpc    6.008
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 53.0%
| epoch  54 |   100/  216 batches | lr 0.00001 | ms/batch 77.47 | loss  2.85 | ppl    17.37 
| epoch  54 |   200/  216 batches | lr 0.00001 | ms/batch 76.76 | loss  2.83 | ppl    16.93 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 17.13s | valid loss  4.20 | valid ppl    66.71 | valid bpc    6.060
-----------------------------------------------------------------------------------------
PROGRESS: 54.0%
| epoch  55 |   100/  216 batches | lr 0.00001 | ms/batch 77.66 | loss  2.86 | ppl    17.39 
| epoch  55 |   200/  216 batches | lr 0.00001 | ms/batch 76.59 | loss  2.82 | ppl    16.78 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 17.13s | valid loss  4.17 | valid ppl    64.84 | valid bpc    6.019
-----------------------------------------------------------------------------------------
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  216 batches | lr 0.00001 | ms/batch 77.99 | loss  2.85 | ppl    17.27 
| epoch  56 |   200/  216 batches | lr 0.00001 | ms/batch 76.78 | loss  2.83 | ppl    16.97 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 17.19s | valid loss  4.21 | valid ppl    67.11 | valid bpc    6.068
-----------------------------------------------------------------------------------------
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  216 batches | lr 0.00000 | ms/batch 77.82 | loss  2.84 | ppl    17.07 
| epoch  57 |   200/  216 batches | lr 0.00000 | ms/batch 76.50 | loss  2.83 | ppl    16.86 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 17.13s | valid loss  4.19 | valid ppl    66.26 | valid bpc    6.050
-----------------------------------------------------------------------------------------
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  216 batches | lr 0.00000 | ms/batch 77.75 | loss  2.83 | ppl    16.88 
| epoch  58 |   200/  216 batches | lr 0.00000 | ms/batch 76.44 | loss  2.83 | ppl    16.87 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 17.14s | valid loss  4.23 | valid ppl    68.74 | valid bpc    6.103
-----------------------------------------------------------------------------------------
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  216 batches | lr 0.00000 | ms/batch 77.78 | loss  2.84 | ppl    17.13 
| epoch  59 |   200/  216 batches | lr 0.00000 | ms/batch 76.33 | loss  2.82 | ppl    16.76 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 17.12s | valid loss  4.23 | valid ppl    68.78 | valid bpc    6.104
-----------------------------------------------------------------------------------------
PROGRESS: 59.0%
| epoch  60 |   100/  216 batches | lr 0.00000 | ms/batch 77.42 | loss  2.82 | ppl    16.85 
| epoch  60 |   200/  216 batches | lr 0.00000 | ms/batch 76.73 | loss  2.81 | ppl    16.63 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 17.13s | valid loss  4.15 | valid ppl    63.59 | valid bpc    5.991
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 60.0%
| epoch  61 |   100/  216 batches | lr 0.00000 | ms/batch 77.47 | loss  2.83 | ppl    16.91 
| epoch  61 |   200/  216 batches | lr 0.00000 | ms/batch 76.83 | loss  2.82 | ppl    16.71 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 17.14s | valid loss  4.19 | valid ppl    65.93 | valid bpc    6.043
-----------------------------------------------------------------------------------------
PROGRESS: 61.0%
| epoch  62 |   100/  216 batches | lr 0.00000 | ms/batch 77.70 | loss  2.86 | ppl    17.40 
| epoch  62 |   200/  216 batches | lr 0.00000 | ms/batch 76.58 | loss  2.78 | ppl    16.15 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 17.13s | valid loss  4.23 | valid ppl    68.93 | valid bpc    6.107
-----------------------------------------------------------------------------------------
PROGRESS: 62.0%
| epoch  63 |   100/  216 batches | lr 0.00000 | ms/batch 77.39 | loss  2.85 | ppl    17.36 
| epoch  63 |   200/  216 batches | lr 0.00000 | ms/batch 76.84 | loss  2.81 | ppl    16.59 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 17.13s | valid loss  4.19 | valid ppl    65.86 | valid bpc    6.041
-----------------------------------------------------------------------------------------
PROGRESS: 63.0%
| epoch  64 |   100/  216 batches | lr 0.00000 | ms/batch 77.49 | loss  2.85 | ppl    17.23 
| epoch  64 |   200/  216 batches | lr 0.00000 | ms/batch 76.67 | loss  2.80 | ppl    16.40 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 17.14s | valid loss  4.19 | valid ppl    65.92 | valid bpc    6.043
-----------------------------------------------------------------------------------------
PROGRESS: 64.0%
| epoch  65 |   100/  216 batches | lr 0.00000 | ms/batch 77.80 | loss  2.84 | ppl    17.12 
| epoch  65 |   200/  216 batches | lr 0.00000 | ms/batch 76.35 | loss  2.81 | ppl    16.62 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 17.14s | valid loss  4.21 | valid ppl    67.16 | valid bpc    6.070
-----------------------------------------------------------------------------------------
PROGRESS: 65.0%
| epoch  66 |   100/  216 batches | lr 0.00000 | ms/batch 77.68 | loss  2.83 | ppl    16.95 
| epoch  66 |   200/  216 batches | lr 0.00000 | ms/batch 76.60 | loss  2.80 | ppl    16.51 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 17.13s | valid loss  4.22 | valid ppl    67.83 | valid bpc    6.084
-----------------------------------------------------------------------------------------
PROGRESS: 66.0%
| epoch  67 |   100/  216 batches | lr 0.00000 | ms/batch 77.82 | loss  2.85 | ppl    17.22 
| epoch  67 |   200/  216 batches | lr 0.00000 | ms/batch 76.50 | loss  2.81 | ppl    16.68 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 17.14s | valid loss  4.22 | valid ppl    67.88 | valid bpc    6.085
-----------------------------------------------------------------------------------------
PROGRESS: 67.0%
| epoch  68 |   100/  216 batches | lr 0.00000 | ms/batch 78.09 | loss  2.81 | ppl    16.65 
| epoch  68 |   200/  216 batches | lr 0.00000 | ms/batch 76.44 | loss  2.83 | ppl    16.97 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 17.15s | valid loss  4.18 | valid ppl    65.50 | valid bpc    6.033
-----------------------------------------------------------------------------------------
PROGRESS: 68.0%
| epoch  69 |   100/  216 batches | lr 0.00000 | ms/batch 77.94 | loss  2.85 | ppl    17.24 
| epoch  69 |   200/  216 batches | lr 0.00000 | ms/batch 76.50 | loss  2.80 | ppl    16.49 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 17.14s | valid loss  4.26 | valid ppl    70.60 | valid bpc    6.142
-----------------------------------------------------------------------------------------
PROGRESS: 69.0%
| epoch  70 |   100/  216 batches | lr 0.00000 | ms/batch 77.75 | loss  2.84 | ppl    17.06 
| epoch  70 |   200/  216 batches | lr 0.00000 | ms/batch 76.52 | loss  2.82 | ppl    16.85 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 17.14s | valid loss  4.17 | valid ppl    64.75 | valid bpc    6.017
-----------------------------------------------------------------------------------------
PROGRESS: 70.0%
| epoch  71 |   100/  216 batches | lr 0.00000 | ms/batch 77.59 | loss  2.83 | ppl    17.02 
| epoch  71 |   200/  216 batches | lr 0.00000 | ms/batch 76.69 | loss  2.82 | ppl    16.71 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 17.15s | valid loss  4.24 | valid ppl    69.61 | valid bpc    6.121
-----------------------------------------------------------------------------------------
PROGRESS: 71.0%
| epoch  72 |   100/  216 batches | lr 0.00000 | ms/batch 77.81 | loss  2.83 | ppl    17.01 
| epoch  72 |   200/  216 batches | lr 0.00000 | ms/batch 76.64 | loss  2.79 | ppl    16.23 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 17.15s | valid loss  4.18 | valid ppl    65.07 | valid bpc    6.024
-----------------------------------------------------------------------------------------
PROGRESS: 72.0%
| epoch  73 |   100/  216 batches | lr 0.00000 | ms/batch 77.63 | loss  2.83 | ppl    16.95 
| epoch  73 |   200/  216 batches | lr 0.00000 | ms/batch 76.71 | loss  2.82 | ppl    16.78 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 17.15s | valid loss  4.26 | valid ppl    70.99 | valid bpc    6.150
-----------------------------------------------------------------------------------------
PROGRESS: 73.0%
| epoch  74 |   100/  216 batches | lr 0.00000 | ms/batch 77.94 | loss  2.82 | ppl    16.84 
| epoch  74 |   200/  216 batches | lr 0.00000 | ms/batch 76.55 | loss  2.82 | ppl    16.75 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 17.15s | valid loss  4.18 | valid ppl    65.21 | valid bpc    6.027
-----------------------------------------------------------------------------------------
PROGRESS: 74.0%
| epoch  75 |   100/  216 batches | lr 0.00000 | ms/batch 77.58 | loss  2.83 | ppl    16.89 
| epoch  75 |   200/  216 batches | lr 0.00000 | ms/batch 76.76 | loss  2.83 | ppl    16.93 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 17.14s | valid loss  4.20 | valid ppl    66.58 | valid bpc    6.057
-----------------------------------------------------------------------------------------
PROGRESS: 75.0%
| epoch  76 |   100/  216 batches | lr 0.00000 | ms/batch 78.15 | loss  2.85 | ppl    17.34 
| epoch  76 |   200/  216 batches | lr 0.00000 | ms/batch 76.39 | loss  2.80 | ppl    16.44 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 17.16s | valid loss  4.21 | valid ppl    67.22 | valid bpc    6.071
-----------------------------------------------------------------------------------------
PROGRESS: 76.0%
| epoch  77 |   100/  216 batches | lr 0.00000 | ms/batch 78.06 | loss  2.85 | ppl    17.29 
| epoch  77 |   200/  216 batches | lr 0.00000 | ms/batch 76.36 | loss  2.80 | ppl    16.52 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 17.15s | valid loss  4.22 | valid ppl    67.85 | valid bpc    6.084
-----------------------------------------------------------------------------------------
PROGRESS: 77.0%
| epoch  78 |   100/  216 batches | lr 0.00000 | ms/batch 77.59 | loss  2.83 | ppl    16.93 
| epoch  78 |   200/  216 batches | lr 0.00000 | ms/batch 76.74 | loss  2.83 | ppl    16.99 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 17.14s | valid loss  4.14 | valid ppl    62.71 | valid bpc    5.971
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 78.0%
| epoch  79 |   100/  216 batches | lr 0.00000 | ms/batch 77.77 | loss  2.84 | ppl    17.17 
| epoch  79 |   200/  216 batches | lr 0.00000 | ms/batch 76.50 | loss  2.80 | ppl    16.39 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 17.14s | valid loss  4.19 | valid ppl    66.15 | valid bpc    6.048
-----------------------------------------------------------------------------------------
PROGRESS: 79.0%
| epoch  80 |   100/  216 batches | lr 0.00000 | ms/batch 77.77 | loss  2.83 | ppl    16.98 
| epoch  80 |   200/  216 batches | lr 0.00000 | ms/batch 76.65 | loss  2.80 | ppl    16.50 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 17.14s | valid loss  4.23 | valid ppl    68.93 | valid bpc    6.107
-----------------------------------------------------------------------------------------
PROGRESS: 80.0%
| epoch  81 |   100/  216 batches | lr 0.00000 | ms/batch 77.84 | loss  2.85 | ppl    17.37 
| epoch  81 |   200/  216 batches | lr 0.00000 | ms/batch 76.60 | loss  2.80 | ppl    16.46 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 17.13s | valid loss  4.19 | valid ppl    65.72 | valid bpc    6.038
-----------------------------------------------------------------------------------------
PROGRESS: 81.0%
| epoch  82 |   100/  216 batches | lr 0.00000 | ms/batch 77.59 | loss  2.81 | ppl    16.68 
| epoch  82 |   200/  216 batches | lr 0.00000 | ms/batch 76.82 | loss  2.83 | ppl    17.01 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 17.14s | valid loss  4.20 | valid ppl    66.98 | valid bpc    6.066
-----------------------------------------------------------------------------------------
PROGRESS: 82.0%
| epoch  83 |   100/  216 batches | lr 0.00000 | ms/batch 77.54 | loss  2.84 | ppl    17.07 
| epoch  83 |   200/  216 batches | lr 0.00000 | ms/batch 76.45 | loss  2.82 | ppl    16.77 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 17.14s | valid loss  4.17 | valid ppl    64.89 | valid bpc    6.020
-----------------------------------------------------------------------------------------
PROGRESS: 83.0%
| epoch  84 |   100/  216 batches | lr 0.00000 | ms/batch 77.91 | loss  2.83 | ppl    17.01 
| epoch  84 |   200/  216 batches | lr 0.00000 | ms/batch 76.47 | loss  2.80 | ppl    16.51 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 17.14s | valid loss  4.21 | valid ppl    67.36 | valid bpc    6.074
-----------------------------------------------------------------------------------------
PROGRESS: 84.0%
| epoch  85 |   100/  216 batches | lr 0.00000 | ms/batch 77.57 | loss  2.82 | ppl    16.84 
| epoch  85 |   200/  216 batches | lr 0.00000 | ms/batch 76.69 | loss  2.82 | ppl    16.76 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 17.13s | valid loss  4.16 | valid ppl    63.88 | valid bpc    5.997
-----------------------------------------------------------------------------------------
PROGRESS: 85.0%
| epoch  86 |   100/  216 batches | lr 0.00000 | ms/batch 77.26 | loss  2.84 | ppl    17.13 
| epoch  86 |   200/  216 batches | lr 0.00000 | ms/batch 76.87 | loss  2.82 | ppl    16.73 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 17.13s | valid loss  4.21 | valid ppl    67.40 | valid bpc    6.075
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  216 batches | lr 0.00000 | ms/batch 77.73 | loss  2.83 | ppl    16.94 
| epoch  87 |   200/  216 batches | lr 0.00000 | ms/batch 76.75 | loss  2.80 | ppl    16.40 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 17.14s | valid loss  4.18 | valid ppl    65.37 | valid bpc    6.031
-----------------------------------------------------------------------------------------
PROGRESS: 87.0%
| epoch  88 |   100/  216 batches | lr 0.00000 | ms/batch 77.54 | loss  2.85 | ppl    17.33 
| epoch  88 |   200/  216 batches | lr 0.00000 | ms/batch 76.41 | loss  2.79 | ppl    16.28 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 17.14s | valid loss  4.21 | valid ppl    67.65 | valid bpc    6.080
-----------------------------------------------------------------------------------------
PROGRESS: 88.0%
| epoch  89 |   100/  216 batches | lr 0.00000 | ms/batch 77.45 | loss  2.84 | ppl    17.05 
| epoch  89 |   200/  216 batches | lr 0.00000 | ms/batch 76.77 | loss  2.80 | ppl    16.39 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 17.13s | valid loss  4.19 | valid ppl    66.15 | valid bpc    6.048
-----------------------------------------------------------------------------------------
PROGRESS: 89.0%
| epoch  90 |   100/  216 batches | lr 0.00000 | ms/batch 77.75 | loss  2.83 | ppl    16.99 
| epoch  90 |   200/  216 batches | lr 0.00000 | ms/batch 76.63 | loss  2.80 | ppl    16.51 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 17.14s | valid loss  4.18 | valid ppl    65.59 | valid bpc    6.035
-----------------------------------------------------------------------------------------
PROGRESS: 90.0%
| epoch  91 |   100/  216 batches | lr 0.00000 | ms/batch 77.87 | loss  2.84 | ppl    17.13 
| epoch  91 |   200/  216 batches | lr 0.00000 | ms/batch 76.66 | loss  2.80 | ppl    16.48 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 17.16s | valid loss  4.21 | valid ppl    67.15 | valid bpc    6.069
-----------------------------------------------------------------------------------------
PROGRESS: 91.0%
| epoch  92 |   100/  216 batches | lr 0.00000 | ms/batch 77.38 | loss  2.83 | ppl    16.95 
| epoch  92 |   200/  216 batches | lr 0.00000 | ms/batch 77.03 | loss  2.80 | ppl    16.45 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 17.14s | valid loss  4.18 | valid ppl    65.65 | valid bpc    6.037
-----------------------------------------------------------------------------------------
PROGRESS: 92.0%
| epoch  93 |   100/  216 batches | lr 0.00000 | ms/batch 78.09 | loss  2.82 | ppl    16.79 
| epoch  93 |   200/  216 batches | lr 0.00000 | ms/batch 76.37 | loss  2.82 | ppl    16.78 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 17.14s | valid loss  4.18 | valid ppl    65.52 | valid bpc    6.034
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  216 batches | lr 0.00000 | ms/batch 78.07 | loss  2.84 | ppl    17.18 
| epoch  94 |   200/  216 batches | lr 0.00000 | ms/batch 76.42 | loss  2.79 | ppl    16.34 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 17.16s | valid loss  4.20 | valid ppl    66.66 | valid bpc    6.059
-----------------------------------------------------------------------------------------
PROGRESS: 94.0%
| epoch  95 |   100/  216 batches | lr 0.00000 | ms/batch 77.74 | loss  2.83 | ppl    16.94 
| epoch  95 |   200/  216 batches | lr 0.00000 | ms/batch 76.64 | loss  2.81 | ppl    16.58 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 17.15s | valid loss  4.19 | valid ppl    65.93 | valid bpc    6.043
-----------------------------------------------------------------------------------------
PROGRESS: 95.0%
| epoch  96 |   100/  216 batches | lr 0.00000 | ms/batch 77.29 | loss  2.82 | ppl    16.82 
| epoch  96 |   200/  216 batches | lr 0.00000 | ms/batch 76.92 | loss  2.82 | ppl    16.72 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 17.13s | valid loss  4.17 | valid ppl    65.03 | valid bpc    6.023
-----------------------------------------------------------------------------------------
PROGRESS: 96.0%
| epoch  97 |   100/  216 batches | lr 0.00000 | ms/batch 77.32 | loss  2.82 | ppl    16.71 
| epoch  97 |   200/  216 batches | lr 0.00000 | ms/batch 76.64 | loss  2.81 | ppl    16.65 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 17.14s | valid loss  4.19 | valid ppl    66.32 | valid bpc    6.051
-----------------------------------------------------------------------------------------
PROGRESS: 97.0%
| epoch  98 |   100/  216 batches | lr 0.00000 | ms/batch 77.93 | loss  2.83 | ppl    16.92 
| epoch  98 |   200/  216 batches | lr 0.00000 | ms/batch 76.26 | loss  2.81 | ppl    16.57 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 17.13s | valid loss  4.23 | valid ppl    69.02 | valid bpc    6.109
-----------------------------------------------------------------------------------------
PROGRESS: 98.0%
| epoch  99 |   100/  216 batches | lr 0.00000 | ms/batch 77.53 | loss  2.84 | ppl    17.05 
| epoch  99 |   200/  216 batches | lr 0.00000 | ms/batch 76.82 | loss  2.79 | ppl    16.35 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 17.14s | valid loss  4.24 | valid ppl    69.51 | valid bpc    6.119
-----------------------------------------------------------------------------------------
PROGRESS: 99.0%
| epoch 100 |   100/  216 batches | lr 0.00000 | ms/batch 78.08 | loss  2.84 | ppl    17.16 
| epoch 100 |   200/  216 batches | lr 0.00000 | ms/batch 76.26 | loss  2.81 | ppl    16.61 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 17.15s | valid loss  4.17 | valid ppl    64.93 | valid bpc    6.021
-----------------------------------------------------------------------------------------
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  4.13 | test ppl    62.30 | test bpc    5.961
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.3568, Mean Reca: 0.4922, Mean F1: 0.4061
Counter({'NP': 8794, 'PP': 3656, 'S': 3097, 'VP': 1367, 'SBAR': 291, 'QP': 288, 'ADJP': 232, 'SINV': 146, 'ADVP': 141, 'FRAG': 35, 'PRN': 34, 'WHNP': 27, 'NX': 19, 'SQ': 10, 'NAC': 9, 'SBARQ': 8, 'UCP': 7, 'WHPP': 6, 'CONJP': 3, 'X': 3, 'WHADVP': 1})
Counter({'NP': 14432, 'VP': 8130, 'S': 5620, 'PP': 5484, 'SBAR': 1796, 'ADJP': 649, 'QP': 490, 'ADVP': 286, 'SINV': 157, 'PRN': 128, 'NX': 95, 'FRAG': 42, 'WHNP': 37, 'UCP': 32, 'NAC': 30, 'WHPP': 25, 'CONJP': 21, 'SQ': 18, 'SBARQ': 10, 'WHADVP': 9, 'X': 6, 'WHADJP': 4, 'INTJ': 1})
SBAR: 0.1620
NP: 0.6093
VP: 0.1681
PP: 0.6667
ADJP: 0.3575
ADVP: 0.4930
5.296144469677398
-----------------------------------------------------------------------------------------
Dependency parsing performance:
Conll-U Style:
DDA: 0.428
UDA: 0.563
=========================================================================================
Loading dataset...
Loading dictionary...
Number of tokens:  10001
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer_in_parser', nhid=512, nlayers=8, front_layers=2, rear_layers=6, n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=4444, nonmono=5, cuda=True, log_interval=100, save='trained_models/structformer_in_parser_4444_26.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 38475637
Model architecture: StructFormer_In_Parser(
  (transformer_front): Transformer_Front(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(10001, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-1): 2 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
  (transformer_rear): Transformer_Rear(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(10001, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-5): 6 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (output_layer): Linear(in_features=512, out_features=10001, bias=True)
  )
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  216 batches | lr 0.00030 | ms/batch 80.23 | loss  7.25 | ppl  1408.82 
| epoch   1 |   200/  216 batches | lr 0.00030 | ms/batch 75.81 | loss  6.85 | ppl   947.74 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 17.29s | valid loss  6.59 | valid ppl   728.29 | valid bpc    9.508
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  216 batches | lr 0.00030 | ms/batch 77.10 | loss  6.65 | ppl   770.05 
| epoch   2 |   200/  216 batches | lr 0.00030 | ms/batch 76.15 | loss  6.30 | ppl   543.50 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 17.02s | valid loss  6.05 | valid ppl   425.43 | valid bpc    8.733
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  216 batches | lr 0.00030 | ms/batch 77.19 | loss  6.06 | ppl   427.37 
| epoch   3 |   200/  216 batches | lr 0.00030 | ms/batch 76.58 | loss  5.78 | ppl   322.18 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 17.07s | valid loss  5.61 | valid ppl   273.66 | valid bpc    8.096
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  216 batches | lr 0.00030 | ms/batch 77.31 | loss  5.62 | ppl   275.93 
| epoch   4 |   200/  216 batches | lr 0.00030 | ms/batch 76.73 | loss  5.48 | ppl   239.75 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 17.10s | valid loss  5.39 | valid ppl   218.65 | valid bpc    7.773
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  216 batches | lr 0.00030 | ms/batch 77.77 | loss  5.36 | ppl   213.32 
| epoch   5 |   200/  216 batches | lr 0.00030 | ms/batch 76.32 | loss  5.24 | ppl   188.11 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 17.11s | valid loss  5.20 | valid ppl   180.45 | valid bpc    7.495
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  216 batches | lr 0.00030 | ms/batch 77.61 | loss  5.17 | ppl   175.79 
| epoch   6 |   200/  216 batches | lr 0.00030 | ms/batch 76.47 | loss  5.06 | ppl   158.32 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 17.11s | valid loss  5.01 | valid ppl   150.35 | valid bpc    7.232
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  216 batches | lr 0.00030 | ms/batch 77.79 | loss  5.00 | ppl   148.85 
| epoch   7 |   200/  216 batches | lr 0.00030 | ms/batch 76.31 | loss  4.95 | ppl   141.57 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 17.12s | valid loss  4.96 | valid ppl   142.90 | valid bpc    7.159
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  216 batches | lr 0.00030 | ms/batch 77.60 | loss  4.87 | ppl   130.27 
| epoch   8 |   200/  216 batches | lr 0.00030 | ms/batch 76.54 | loss  4.80 | ppl   121.41 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 17.13s | valid loss  4.87 | valid ppl   130.22 | valid bpc    7.025
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 8.0%
| epoch   9 |   100/  216 batches | lr 0.00030 | ms/batch 78.02 | loss  4.77 | ppl   118.40 
| epoch   9 |   200/  216 batches | lr 0.00030 | ms/batch 76.35 | loss  4.68 | ppl   108.28 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 17.14s | valid loss  4.75 | valid ppl   115.65 | valid bpc    6.854
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  216 batches | lr 0.00030 | ms/batch 77.77 | loss  4.64 | ppl   103.60 
| epoch  10 |   200/  216 batches | lr 0.00030 | ms/batch 76.19 | loss  4.58 | ppl    97.60 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 17.13s | valid loss  4.69 | valid ppl   108.51 | valid bpc    6.762
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  216 batches | lr 0.00030 | ms/batch 78.09 | loss  4.53 | ppl    92.87 
| epoch  11 |   200/  216 batches | lr 0.00030 | ms/batch 76.21 | loss  4.50 | ppl    89.90 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 17.13s | valid loss  4.62 | valid ppl   101.59 | valid bpc    6.667
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  216 batches | lr 0.00030 | ms/batch 77.34 | loss  4.44 | ppl    84.49 
| epoch  12 |   200/  216 batches | lr 0.00030 | ms/batch 77.02 | loss  4.41 | ppl    82.38 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 17.14s | valid loss  4.58 | valid ppl    97.81 | valid bpc    6.612
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 12.0%
| epoch  13 |   100/  216 batches | lr 0.00030 | ms/batch 77.83 | loss  4.36 | ppl    78.38 
| epoch  13 |   200/  216 batches | lr 0.00030 | ms/batch 76.25 | loss  4.34 | ppl    76.55 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 17.15s | valid loss  4.58 | valid ppl    97.88 | valid bpc    6.613
-----------------------------------------------------------------------------------------
PROGRESS: 13.0%
| epoch  14 |   100/  216 batches | lr 0.00030 | ms/batch 77.94 | loss  4.28 | ppl    72.38 
| epoch  14 |   200/  216 batches | lr 0.00030 | ms/batch 76.48 | loss  4.26 | ppl    70.61 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 17.14s | valid loss  4.51 | valid ppl    90.99 | valid bpc    6.508
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  216 batches | lr 0.00030 | ms/batch 77.72 | loss  4.20 | ppl    66.99 
| epoch  15 |   200/  216 batches | lr 0.00030 | ms/batch 76.73 | loss  4.18 | ppl    65.04 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 17.16s | valid loss  4.48 | valid ppl    87.81 | valid bpc    6.456
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 15.0%
| epoch  16 |   100/  216 batches | lr 0.00030 | ms/batch 77.43 | loss  4.13 | ppl    62.04 
| epoch  16 |   200/  216 batches | lr 0.00030 | ms/batch 76.81 | loss  4.13 | ppl    62.39 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 17.13s | valid loss  4.44 | valid ppl    85.18 | valid bpc    6.412
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 16.0%
| epoch  17 |   100/  216 batches | lr 0.00030 | ms/batch 77.63 | loss  4.08 | ppl    59.13 
| epoch  17 |   200/  216 batches | lr 0.00030 | ms/batch 76.70 | loss  4.04 | ppl    56.80 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 17.14s | valid loss  4.39 | valid ppl    80.81 | valid bpc    6.337
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 17.0%
| epoch  18 |   100/  216 batches | lr 0.00030 | ms/batch 77.95 | loss  4.02 | ppl    55.90 
| epoch  18 |   200/  216 batches | lr 0.00030 | ms/batch 76.32 | loss  3.98 | ppl    53.37 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 17.14s | valid loss  4.39 | valid ppl    80.60 | valid bpc    6.333
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 18.0%
| epoch  19 |   100/  216 batches | lr 0.00030 | ms/batch 77.68 | loss  3.96 | ppl    52.44 
| epoch  19 |   200/  216 batches | lr 0.00030 | ms/batch 76.61 | loss  3.95 | ppl    51.71 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 17.13s | valid loss  4.35 | valid ppl    77.57 | valid bpc    6.277
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 19.0%
| epoch  20 |   100/  216 batches | lr 0.00030 | ms/batch 77.49 | loss  3.91 | ppl    49.71 
| epoch  20 |   200/  216 batches | lr 0.00030 | ms/batch 76.75 | loss  3.88 | ppl    48.57 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 17.14s | valid loss  4.35 | valid ppl    77.67 | valid bpc    6.279
-----------------------------------------------------------------------------------------
PROGRESS: 20.0%
| epoch  21 |   100/  216 batches | lr 0.00030 | ms/batch 77.62 | loss  3.84 | ppl    46.59 
| epoch  21 |   200/  216 batches | lr 0.00030 | ms/batch 76.87 | loss  3.85 | ppl    46.92 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 17.14s | valid loss  4.33 | valid ppl    75.81 | valid bpc    6.244
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 21.0%
| epoch  22 |   100/  216 batches | lr 0.00030 | ms/batch 78.14 | loss  3.79 | ppl    44.20 
| epoch  22 |   200/  216 batches | lr 0.00030 | ms/batch 76.28 | loss  3.77 | ppl    43.44 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 17.13s | valid loss  4.35 | valid ppl    77.34 | valid bpc    6.273
-----------------------------------------------------------------------------------------
PROGRESS: 22.0%
| epoch  23 |   100/  216 batches | lr 0.00030 | ms/batch 78.06 | loss  3.74 | ppl    42.05 
| epoch  23 |   200/  216 batches | lr 0.00030 | ms/batch 76.22 | loss  3.72 | ppl    41.21 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 17.14s | valid loss  4.31 | valid ppl    74.56 | valid bpc    6.220
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 23.0%
| epoch  24 |   100/  216 batches | lr 0.00030 | ms/batch 77.81 | loss  3.66 | ppl    38.84 
| epoch  24 |   200/  216 batches | lr 0.00030 | ms/batch 76.03 | loss  3.70 | ppl    40.37 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 17.13s | valid loss  4.31 | valid ppl    74.56 | valid bpc    6.220
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 24.0%
| epoch  25 |   100/  216 batches | lr 0.00030 | ms/batch 77.45 | loss  3.64 | ppl    38.00 
| epoch  25 |   200/  216 batches | lr 0.00030 | ms/batch 76.45 | loss  3.62 | ppl    37.31 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 17.13s | valid loss  4.30 | valid ppl    73.72 | valid bpc    6.204
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 25.0%
| epoch  26 |   100/  216 batches | lr 0.00030 | ms/batch 77.53 | loss  3.60 | ppl    36.71 
| epoch  26 |   200/  216 batches | lr 0.00030 | ms/batch 76.67 | loss  3.60 | ppl    36.57 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 17.13s | valid loss  4.29 | valid ppl    73.04 | valid bpc    6.191
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 26.0%
| epoch  27 |   100/  216 batches | lr 0.00030 | ms/batch 77.43 | loss  3.54 | ppl    34.41 
| epoch  27 |   200/  216 batches | lr 0.00030 | ms/batch 76.92 | loss  3.56 | ppl    35.04 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 17.14s | valid loss  4.28 | valid ppl    72.42 | valid bpc    6.178
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 27.0%
| epoch  28 |   100/  216 batches | lr 0.00030 | ms/batch 77.50 | loss  3.51 | ppl    33.50 
| epoch  28 |   200/  216 batches | lr 0.00030 | ms/batch 76.72 | loss  3.48 | ppl    32.58 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 17.13s | valid loss  4.35 | valid ppl    77.34 | valid bpc    6.273
-----------------------------------------------------------------------------------------
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  216 batches | lr 0.00030 | ms/batch 77.21 | loss  3.44 | ppl    31.28 
| epoch  29 |   200/  216 batches | lr 0.00030 | ms/batch 76.91 | loss  3.45 | ppl    31.50 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 17.12s | valid loss  4.29 | valid ppl    72.92 | valid bpc    6.188
-----------------------------------------------------------------------------------------
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  216 batches | lr 0.00030 | ms/batch 77.71 | loss  3.39 | ppl    29.59 
| epoch  30 |   200/  216 batches | lr 0.00030 | ms/batch 76.54 | loss  3.43 | ppl    30.89 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 17.12s | valid loss  4.28 | valid ppl    72.05 | valid bpc    6.171
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 30.0%
| epoch  31 |   100/  216 batches | lr 0.00030 | ms/batch 77.74 | loss  3.37 | ppl    29.05 
| epoch  31 |   200/  216 batches | lr 0.00030 | ms/batch 76.58 | loss  3.36 | ppl    28.79 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 17.14s | valid loss  4.23 | valid ppl    68.48 | valid bpc    6.098
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 31.0%
| epoch  32 |   100/  216 batches | lr 0.00030 | ms/batch 77.41 | loss  3.33 | ppl    27.98 
| epoch  32 |   200/  216 batches | lr 0.00030 | ms/batch 76.97 | loss  3.35 | ppl    28.39 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 17.13s | valid loss  4.26 | valid ppl    70.52 | valid bpc    6.140
-----------------------------------------------------------------------------------------
PROGRESS: 32.0%
| epoch  33 |   100/  216 batches | lr 0.00030 | ms/batch 77.28 | loss  3.30 | ppl    27.07 
| epoch  33 |   200/  216 batches | lr 0.00030 | ms/batch 76.94 | loss  3.28 | ppl    26.63 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 17.13s | valid loss  4.24 | valid ppl    69.74 | valid bpc    6.124
-----------------------------------------------------------------------------------------
PROGRESS: 33.0%
| epoch  34 |   100/  216 batches | lr 0.00030 | ms/batch 77.90 | loss  3.25 | ppl    25.89 
| epoch  34 |   200/  216 batches | lr 0.00030 | ms/batch 76.38 | loss  3.26 | ppl    26.07 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 17.14s | valid loss  4.25 | valid ppl    70.09 | valid bpc    6.131
-----------------------------------------------------------------------------------------
PROGRESS: 34.0%
| epoch  35 |   100/  216 batches | lr 0.00015 | ms/batch 77.66 | loss  3.17 | ppl    23.88 
| epoch  35 |   200/  216 batches | lr 0.00015 | ms/batch 76.58 | loss  3.13 | ppl    22.77 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 17.13s | valid loss  4.25 | valid ppl    70.27 | valid bpc    6.135
-----------------------------------------------------------------------------------------
PROGRESS: 35.0%
| epoch  36 |   100/  216 batches | lr 0.00015 | ms/batch 78.18 | loss  3.12 | ppl    22.64 
| epoch  36 |   200/  216 batches | lr 0.00015 | ms/batch 76.23 | loss  3.07 | ppl    21.64 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 17.15s | valid loss  4.22 | valid ppl    68.20 | valid bpc    6.092
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 36.0%
| epoch  37 |   100/  216 batches | lr 0.00015 | ms/batch 77.51 | loss  3.08 | ppl    21.65 
| epoch  37 |   200/  216 batches | lr 0.00015 | ms/batch 76.88 | loss  3.07 | ppl    21.48 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 17.14s | valid loss  4.24 | valid ppl    69.29 | valid bpc    6.115
-----------------------------------------------------------------------------------------
PROGRESS: 37.0%
| epoch  38 |   100/  216 batches | lr 0.00015 | ms/batch 77.51 | loss  3.02 | ppl    20.55 
| epoch  38 |   200/  216 batches | lr 0.00015 | ms/batch 76.83 | loss  3.03 | ppl    20.60 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 17.14s | valid loss  4.27 | valid ppl    71.83 | valid bpc    6.166
-----------------------------------------------------------------------------------------
PROGRESS: 38.0%
| epoch  39 |   100/  216 batches | lr 0.00015 | ms/batch 77.75 | loss  3.01 | ppl    20.33 
| epoch  39 |   200/  216 batches | lr 0.00015 | ms/batch 76.72 | loss  2.98 | ppl    19.65 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 17.14s | valid loss  4.21 | valid ppl    67.21 | valid bpc    6.071
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 39.0%
| epoch  40 |   100/  216 batches | lr 0.00015 | ms/batch 77.64 | loss  2.98 | ppl    19.77 
| epoch  40 |   200/  216 batches | lr 0.00015 | ms/batch 76.50 | loss  2.96 | ppl    19.35 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 17.13s | valid loss  4.21 | valid ppl    67.13 | valid bpc    6.069
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 40.0%
| epoch  41 |   100/  216 batches | lr 0.00015 | ms/batch 77.47 | loss  2.96 | ppl    19.36 
| epoch  41 |   200/  216 batches | lr 0.00015 | ms/batch 76.39 | loss  2.93 | ppl    18.64 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 17.13s | valid loss  4.24 | valid ppl    69.58 | valid bpc    6.121
-----------------------------------------------------------------------------------------
PROGRESS: 41.0%
| epoch  42 |   100/  216 batches | lr 0.00015 | ms/batch 77.56 | loss  2.92 | ppl    18.51 
| epoch  42 |   200/  216 batches | lr 0.00015 | ms/batch 76.49 | loss  2.92 | ppl    18.62 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 17.14s | valid loss  4.22 | valid ppl    67.91 | valid bpc    6.086
-----------------------------------------------------------------------------------------
PROGRESS: 42.0%
| epoch  43 |   100/  216 batches | lr 0.00015 | ms/batch 77.77 | loss  2.92 | ppl    18.51 
| epoch  43 |   200/  216 batches | lr 0.00015 | ms/batch 76.44 | loss  2.89 | ppl    18.08 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 17.13s | valid loss  4.29 | valid ppl    73.09 | valid bpc    6.192
-----------------------------------------------------------------------------------------
PROGRESS: 43.0%
| epoch  44 |   100/  216 batches | lr 0.00007 | ms/batch 77.52 | loss  2.86 | ppl    17.46 
| epoch  44 |   200/  216 batches | lr 0.00007 | ms/batch 76.78 | loss  2.83 | ppl    16.92 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 17.14s | valid loss  4.25 | valid ppl    70.04 | valid bpc    6.130
-----------------------------------------------------------------------------------------
PROGRESS: 44.0%
| epoch  45 |   100/  216 batches | lr 0.00007 | ms/batch 77.67 | loss  2.81 | ppl    16.59 
| epoch  45 |   200/  216 batches | lr 0.00007 | ms/batch 76.54 | loss  2.80 | ppl    16.40 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 17.14s | valid loss  4.24 | valid ppl    69.08 | valid bpc    6.110
-----------------------------------------------------------------------------------------
PROGRESS: 45.0%
| epoch  46 |   100/  216 batches | lr 0.00007 | ms/batch 77.44 | loss  2.79 | ppl    16.21 
| epoch  46 |   200/  216 batches | lr 0.00007 | ms/batch 77.03 | loss  2.78 | ppl    16.10 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 17.14s | valid loss  4.27 | valid ppl    71.32 | valid bpc    6.156
-----------------------------------------------------------------------------------------
PROGRESS: 46.0%
| epoch  47 |   100/  216 batches | lr 0.00004 | ms/batch 77.68 | loss  2.79 | ppl    16.24 
| epoch  47 |   200/  216 batches | lr 0.00004 | ms/batch 76.79 | loss  2.74 | ppl    15.54 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 17.16s | valid loss  4.24 | valid ppl    69.33 | valid bpc    6.115
-----------------------------------------------------------------------------------------
PROGRESS: 47.0%
| epoch  48 |   100/  216 batches | lr 0.00004 | ms/batch 77.94 | loss  2.77 | ppl    15.93 
| epoch  48 |   200/  216 batches | lr 0.00004 | ms/batch 76.33 | loss  2.71 | ppl    15.06 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 17.14s | valid loss  4.27 | valid ppl    71.24 | valid bpc    6.155
-----------------------------------------------------------------------------------------
PROGRESS: 48.0%
| epoch  49 |   100/  216 batches | lr 0.00004 | ms/batch 77.80 | loss  2.73 | ppl    15.26 
| epoch  49 |   200/  216 batches | lr 0.00004 | ms/batch 76.69 | loss  2.72 | ppl    15.25 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 17.15s | valid loss  4.24 | valid ppl    69.17 | valid bpc    6.112
-----------------------------------------------------------------------------------------
PROGRESS: 49.0%
| epoch  50 |   100/  216 batches | lr 0.00002 | ms/batch 78.01 | loss  2.73 | ppl    15.38 
| epoch  50 |   200/  216 batches | lr 0.00002 | ms/batch 76.44 | loss  2.70 | ppl    14.84 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 17.14s | valid loss  4.28 | valid ppl    71.99 | valid bpc    6.170
-----------------------------------------------------------------------------------------
PROGRESS: 50.0%
| epoch  51 |   100/  216 batches | lr 0.00002 | ms/batch 77.63 | loss  2.70 | ppl    14.89 
| epoch  51 |   200/  216 batches | lr 0.00002 | ms/batch 76.73 | loss  2.71 | ppl    14.99 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 17.14s | valid loss  4.25 | valid ppl    70.39 | valid bpc    6.137
-----------------------------------------------------------------------------------------
PROGRESS: 51.0%
| epoch  52 |   100/  216 batches | lr 0.00002 | ms/batch 78.19 | loss  2.72 | ppl    15.14 
| epoch  52 |   200/  216 batches | lr 0.00002 | ms/batch 76.28 | loss  2.69 | ppl    14.67 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 17.14s | valid loss  4.25 | valid ppl    70.20 | valid bpc    6.133
-----------------------------------------------------------------------------------------
PROGRESS: 52.0%
| epoch  53 |   100/  216 batches | lr 0.00001 | ms/batch 77.59 | loss  2.70 | ppl    14.89 
| epoch  53 |   200/  216 batches | lr 0.00001 | ms/batch 76.47 | loss  2.68 | ppl    14.55 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 17.15s | valid loss  4.22 | valid ppl    68.00 | valid bpc    6.088
-----------------------------------------------------------------------------------------
PROGRESS: 53.0%
| epoch  54 |   100/  216 batches | lr 0.00001 | ms/batch 77.71 | loss  2.71 | ppl    15.05 
| epoch  54 |   200/  216 batches | lr 0.00001 | ms/batch 76.69 | loss  2.68 | ppl    14.64 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 17.16s | valid loss  4.26 | valid ppl    70.49 | valid bpc    6.139
-----------------------------------------------------------------------------------------
PROGRESS: 54.0%
| epoch  55 |   100/  216 batches | lr 0.00001 | ms/batch 77.75 | loss  2.71 | ppl    15.10 
| epoch  55 |   200/  216 batches | lr 0.00001 | ms/batch 76.74 | loss  2.67 | ppl    14.46 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 17.16s | valid loss  4.25 | valid ppl    70.19 | valid bpc    6.133
-----------------------------------------------------------------------------------------
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  216 batches | lr 0.00000 | ms/batch 77.90 | loss  2.70 | ppl    14.85 
| epoch  56 |   200/  216 batches | lr 0.00000 | ms/batch 76.29 | loss  2.66 | ppl    14.34 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 17.14s | valid loss  4.25 | valid ppl    69.95 | valid bpc    6.128
-----------------------------------------------------------------------------------------
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  216 batches | lr 0.00000 | ms/batch 77.42 | loss  2.71 | ppl    15.02 
| epoch  57 |   200/  216 batches | lr 0.00000 | ms/batch 76.97 | loss  2.66 | ppl    14.25 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 17.14s | valid loss  4.22 | valid ppl    68.05 | valid bpc    6.089
-----------------------------------------------------------------------------------------
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  216 batches | lr 0.00000 | ms/batch 77.62 | loss  2.70 | ppl    14.94 
| epoch  58 |   200/  216 batches | lr 0.00000 | ms/batch 76.94 | loss  2.65 | ppl    14.22 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 17.16s | valid loss  4.22 | valid ppl    68.14 | valid bpc    6.091
-----------------------------------------------------------------------------------------
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  216 batches | lr 0.00000 | ms/batch 77.98 | loss  2.70 | ppl    14.95 
| epoch  59 |   200/  216 batches | lr 0.00000 | ms/batch 76.40 | loss  2.65 | ppl    14.09 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 17.15s | valid loss  4.23 | valid ppl    68.98 | valid bpc    6.108
-----------------------------------------------------------------------------------------
PROGRESS: 59.0%
| epoch  60 |   100/  216 batches | lr 0.00000 | ms/batch 77.81 | loss  2.68 | ppl    14.54 
| epoch  60 |   200/  216 batches | lr 0.00000 | ms/batch 76.49 | loss  2.67 | ppl    14.46 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 17.15s | valid loss  4.24 | valid ppl    69.75 | valid bpc    6.124
-----------------------------------------------------------------------------------------
PROGRESS: 60.0%
| epoch  61 |   100/  216 batches | lr 0.00000 | ms/batch 78.21 | loss  2.68 | ppl    14.64 
| epoch  61 |   200/  216 batches | lr 0.00000 | ms/batch 76.14 | loss  2.68 | ppl    14.60 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 17.14s | valid loss  4.24 | valid ppl    69.31 | valid bpc    6.115
-----------------------------------------------------------------------------------------
PROGRESS: 61.0%
| epoch  62 |   100/  216 batches | lr 0.00000 | ms/batch 77.87 | loss  2.68 | ppl    14.61 
| epoch  62 |   200/  216 batches | lr 0.00000 | ms/batch 76.38 | loss  2.67 | ppl    14.43 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 17.14s | valid loss  4.27 | valid ppl    71.54 | valid bpc    6.161
-----------------------------------------------------------------------------------------
PROGRESS: 62.0%
| epoch  63 |   100/  216 batches | lr 0.00000 | ms/batch 77.94 | loss  2.69 | ppl    14.66 
| epoch  63 |   200/  216 batches | lr 0.00000 | ms/batch 76.39 | loss  2.68 | ppl    14.55 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 17.14s | valid loss  4.21 | valid ppl    67.45 | valid bpc    6.076
-----------------------------------------------------------------------------------------
PROGRESS: 63.0%
| epoch  64 |   100/  216 batches | lr 0.00000 | ms/batch 77.78 | loss  2.70 | ppl    14.81 
| epoch  64 |   200/  216 batches | lr 0.00000 | ms/batch 76.57 | loss  2.66 | ppl    14.36 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 17.14s | valid loss  4.24 | valid ppl    69.32 | valid bpc    6.115
-----------------------------------------------------------------------------------------
PROGRESS: 64.0%
| epoch  65 |   100/  216 batches | lr 0.00000 | ms/batch 77.53 | loss  2.69 | ppl    14.66 
| epoch  65 |   200/  216 batches | lr 0.00000 | ms/batch 77.17 | loss  2.66 | ppl    14.31 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 17.19s | valid loss  4.23 | valid ppl    68.38 | valid bpc    6.096
-----------------------------------------------------------------------------------------
PROGRESS: 65.0%
| epoch  66 |   100/  216 batches | lr 0.00000 | ms/batch 77.97 | loss  2.69 | ppl    14.67 
| epoch  66 |   200/  216 batches | lr 0.00000 | ms/batch 76.28 | loss  2.67 | ppl    14.48 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 17.14s | valid loss  4.22 | valid ppl    67.76 | valid bpc    6.082
-----------------------------------------------------------------------------------------
PROGRESS: 66.0%
| epoch  67 |   100/  216 batches | lr 0.00000 | ms/batch 77.81 | loss  2.70 | ppl    14.86 
| epoch  67 |   200/  216 batches | lr 0.00000 | ms/batch 76.58 | loss  2.64 | ppl    14.02 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 17.14s | valid loss  4.21 | valid ppl    67.37 | valid bpc    6.074
-----------------------------------------------------------------------------------------
PROGRESS: 67.0%
| epoch  68 |   100/  216 batches | lr 0.00000 | ms/batch 77.62 | loss  2.69 | ppl    14.76 
| epoch  68 |   200/  216 batches | lr 0.00000 | ms/batch 76.70 | loss  2.65 | ppl    14.13 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 17.14s | valid loss  4.20 | valid ppl    66.40 | valid bpc    6.053
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 68.0%
| epoch  69 |   100/  216 batches | lr 0.00000 | ms/batch 77.31 | loss  2.70 | ppl    14.89 
| epoch  69 |   200/  216 batches | lr 0.00000 | ms/batch 76.83 | loss  2.65 | ppl    14.19 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 17.15s | valid loss  4.21 | valid ppl    67.41 | valid bpc    6.075
-----------------------------------------------------------------------------------------
PROGRESS: 69.0%
| epoch  70 |   100/  216 batches | lr 0.00000 | ms/batch 78.10 | loss  2.69 | ppl    14.66 
| epoch  70 |   200/  216 batches | lr 0.00000 | ms/batch 76.21 | loss  2.65 | ppl    14.18 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 17.14s | valid loss  4.24 | valid ppl    69.26 | valid bpc    6.114
-----------------------------------------------------------------------------------------
PROGRESS: 70.0%
| epoch  71 |   100/  216 batches | lr 0.00000 | ms/batch 77.59 | loss  2.66 | ppl    14.33 
| epoch  71 |   200/  216 batches | lr 0.00000 | ms/batch 76.86 | loss  2.67 | ppl    14.44 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 17.14s | valid loss  4.24 | valid ppl    69.75 | valid bpc    6.124
-----------------------------------------------------------------------------------------
PROGRESS: 71.0%
| epoch  72 |   100/  216 batches | lr 0.00000 | ms/batch 77.72 | loss  2.71 | ppl    15.03 
| epoch  72 |   200/  216 batches | lr 0.00000 | ms/batch 76.52 | loss  2.64 | ppl    14.02 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 17.13s | valid loss  4.24 | valid ppl    69.49 | valid bpc    6.119
-----------------------------------------------------------------------------------------
PROGRESS: 72.0%
| epoch  73 |   100/  216 batches | lr 0.00000 | ms/batch 77.46 | loss  2.67 | ppl    14.43 
| epoch  73 |   200/  216 batches | lr 0.00000 | ms/batch 76.63 | loss  2.66 | ppl    14.24 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 17.15s | valid loss  4.24 | valid ppl    69.39 | valid bpc    6.117
-----------------------------------------------------------------------------------------
PROGRESS: 73.0%
| epoch  74 |   100/  216 batches | lr 0.00000 | ms/batch 77.99 | loss  2.70 | ppl    14.84 
| epoch  74 |   200/  216 batches | lr 0.00000 | ms/batch 76.50 | loss  2.66 | ppl    14.36 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 17.15s | valid loss  4.26 | valid ppl    71.11 | valid bpc    6.152
-----------------------------------------------------------------------------------------
PROGRESS: 74.0%
| epoch  75 |   100/  216 batches | lr 0.00000 | ms/batch 77.70 | loss  2.70 | ppl    14.88 
| epoch  75 |   200/  216 batches | lr 0.00000 | ms/batch 76.55 | loss  2.65 | ppl    14.14 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 17.15s | valid loss  4.25 | valid ppl    70.24 | valid bpc    6.134
-----------------------------------------------------------------------------------------
PROGRESS: 75.0%
| epoch  76 |   100/  216 batches | lr 0.00000 | ms/batch 77.63 | loss  2.69 | ppl    14.71 
| epoch  76 |   200/  216 batches | lr 0.00000 | ms/batch 76.85 | loss  2.67 | ppl    14.41 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 17.15s | valid loss  4.23 | valid ppl    68.58 | valid bpc    6.100
-----------------------------------------------------------------------------------------
PROGRESS: 76.0%
| epoch  77 |   100/  216 batches | lr 0.00000 | ms/batch 77.96 | loss  2.69 | ppl    14.72 
| epoch  77 |   200/  216 batches | lr 0.00000 | ms/batch 76.32 | loss  2.64 | ppl    14.02 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 17.15s | valid loss  4.25 | valid ppl    69.98 | valid bpc    6.129
-----------------------------------------------------------------------------------------
PROGRESS: 77.0%
| epoch  78 |   100/  216 batches | lr 0.00000 | ms/batch 78.27 | loss  2.69 | ppl    14.77 
| epoch  78 |   200/  216 batches | lr 0.00000 | ms/batch 76.36 | loss  2.66 | ppl    14.24 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 17.16s | valid loss  4.21 | valid ppl    67.59 | valid bpc    6.079
-----------------------------------------------------------------------------------------
PROGRESS: 78.0%
| epoch  79 |   100/  216 batches | lr 0.00000 | ms/batch 77.85 | loss  2.67 | ppl    14.39 
| epoch  79 |   200/  216 batches | lr 0.00000 | ms/batch 76.56 | loss  2.67 | ppl    14.42 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 17.15s | valid loss  4.24 | valid ppl    69.75 | valid bpc    6.124
-----------------------------------------------------------------------------------------
PROGRESS: 79.0%
| epoch  80 |   100/  216 batches | lr 0.00000 | ms/batch 77.33 | loss  2.69 | ppl    14.78 
| epoch  80 |   200/  216 batches | lr 0.00000 | ms/batch 76.98 | loss  2.66 | ppl    14.37 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 17.14s | valid loss  4.25 | valid ppl    69.84 | valid bpc    6.126
-----------------------------------------------------------------------------------------
PROGRESS: 80.0%
| epoch  81 |   100/  216 batches | lr 0.00000 | ms/batch 77.69 | loss  2.66 | ppl    14.23 
| epoch  81 |   200/  216 batches | lr 0.00000 | ms/batch 76.77 | loss  2.68 | ppl    14.53 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 17.14s | valid loss  4.25 | valid ppl    69.90 | valid bpc    6.127
-----------------------------------------------------------------------------------------
PROGRESS: 81.0%
| epoch  82 |   100/  216 batches | lr 0.00000 | ms/batch 77.63 | loss  2.69 | ppl    14.76 
| epoch  82 |   200/  216 batches | lr 0.00000 | ms/batch 76.46 | loss  2.64 | ppl    14.08 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 17.15s | valid loss  4.23 | valid ppl    68.76 | valid bpc    6.104
-----------------------------------------------------------------------------------------
PROGRESS: 82.0%
| epoch  83 |   100/  216 batches | lr 0.00000 | ms/batch 77.20 | loss  2.68 | ppl    14.60 
| epoch  83 |   200/  216 batches | lr 0.00000 | ms/batch 77.07 | loss  2.65 | ppl    14.11 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 17.14s | valid loss  4.21 | valid ppl    67.17 | valid bpc    6.070
-----------------------------------------------------------------------------------------
PROGRESS: 83.0%
| epoch  84 |   100/  216 batches | lr 0.00000 | ms/batch 78.01 | loss  2.67 | ppl    14.49 
| epoch  84 |   200/  216 batches | lr 0.00000 | ms/batch 76.32 | loss  2.68 | ppl    14.57 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 17.15s | valid loss  4.22 | valid ppl    68.30 | valid bpc    6.094
-----------------------------------------------------------------------------------------
PROGRESS: 84.0%
| epoch  85 |   100/  216 batches | lr 0.00000 | ms/batch 77.73 | loss  2.69 | ppl    14.75 
| epoch  85 |   200/  216 batches | lr 0.00000 | ms/batch 76.68 | loss  2.65 | ppl    14.21 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 17.15s | valid loss  4.25 | valid ppl    70.35 | valid bpc    6.137
-----------------------------------------------------------------------------------------
PROGRESS: 85.0%
| epoch  86 |   100/  216 batches | lr 0.00000 | ms/batch 77.55 | loss  2.70 | ppl    14.84 
| epoch  86 |   200/  216 batches | lr 0.00000 | ms/batch 76.59 | loss  2.67 | ppl    14.38 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 17.15s | valid loss  4.26 | valid ppl    70.92 | valid bpc    6.148
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  216 batches | lr 0.00000 | ms/batch 77.43 | loss  2.71 | ppl    15.06 
| epoch  87 |   200/  216 batches | lr 0.00000 | ms/batch 76.83 | loss  2.65 | ppl    14.22 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 17.15s | valid loss  4.27 | valid ppl    71.75 | valid bpc    6.165
-----------------------------------------------------------------------------------------
PROGRESS: 87.0%
| epoch  88 |   100/  216 batches | lr 0.00000 | ms/batch 77.54 | loss  2.68 | ppl    14.63 
| epoch  88 |   200/  216 batches | lr 0.00000 | ms/batch 76.91 | loss  2.66 | ppl    14.36 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 17.14s | valid loss  4.23 | valid ppl    68.96 | valid bpc    6.108
-----------------------------------------------------------------------------------------
PROGRESS: 88.0%
| epoch  89 |   100/  216 batches | lr 0.00000 | ms/batch 77.33 | loss  2.69 | ppl    14.76 
| epoch  89 |   200/  216 batches | lr 0.00000 | ms/batch 77.01 | loss  2.66 | ppl    14.34 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 17.15s | valid loss  4.29 | valid ppl    72.93 | valid bpc    6.188
-----------------------------------------------------------------------------------------
PROGRESS: 89.0%
| epoch  90 |   100/  216 batches | lr 0.00000 | ms/batch 77.54 | loss  2.65 | ppl    14.22 
| epoch  90 |   200/  216 batches | lr 0.00000 | ms/batch 76.29 | loss  2.65 | ppl    14.16 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 17.15s | valid loss  4.23 | valid ppl    68.44 | valid bpc    6.097
-----------------------------------------------------------------------------------------
PROGRESS: 90.0%
| epoch  91 |   100/  216 batches | lr 0.00000 | ms/batch 78.32 | loss  2.69 | ppl    14.77 
| epoch  91 |   200/  216 batches | lr 0.00000 | ms/batch 76.66 | loss  2.65 | ppl    14.18 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 17.21s | valid loss  4.22 | valid ppl    67.87 | valid bpc    6.085
-----------------------------------------------------------------------------------------
PROGRESS: 91.0%
| epoch  92 |   100/  216 batches | lr 0.00000 | ms/batch 77.78 | loss  2.71 | ppl    14.98 
| epoch  92 |   200/  216 batches | lr 0.00000 | ms/batch 76.53 | loss  2.66 | ppl    14.28 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 17.15s | valid loss  4.22 | valid ppl    68.11 | valid bpc    6.090
-----------------------------------------------------------------------------------------
PROGRESS: 92.0%
| epoch  93 |   100/  216 batches | lr 0.00000 | ms/batch 77.75 | loss  2.69 | ppl    14.79 
| epoch  93 |   200/  216 batches | lr 0.00000 | ms/batch 76.58 | loss  2.66 | ppl    14.33 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 17.15s | valid loss  4.20 | valid ppl    66.86 | valid bpc    6.063
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  216 batches | lr 0.00000 | ms/batch 77.57 | loss  2.70 | ppl    14.92 
| epoch  94 |   200/  216 batches | lr 0.00000 | ms/batch 76.53 | loss  2.66 | ppl    14.29 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 17.13s | valid loss  4.23 | valid ppl    68.50 | valid bpc    6.098
-----------------------------------------------------------------------------------------
PROGRESS: 94.0%
| epoch  95 |   100/  216 batches | lr 0.00000 | ms/batch 77.74 | loss  2.69 | ppl    14.71 
| epoch  95 |   200/  216 batches | lr 0.00000 | ms/batch 76.74 | loss  2.66 | ppl    14.26 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 17.15s | valid loss  4.23 | valid ppl    68.47 | valid bpc    6.097
-----------------------------------------------------------------------------------------
PROGRESS: 95.0%
| epoch  96 |   100/  216 batches | lr 0.00000 | ms/batch 77.83 | loss  2.68 | ppl    14.54 
| epoch  96 |   200/  216 batches | lr 0.00000 | ms/batch 76.72 | loss  2.67 | ppl    14.41 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 17.15s | valid loss  4.24 | valid ppl    69.54 | valid bpc    6.120
-----------------------------------------------------------------------------------------
PROGRESS: 96.0%
| epoch  97 |   100/  216 batches | lr 0.00000 | ms/batch 77.92 | loss  2.68 | ppl    14.61 
| epoch  97 |   200/  216 batches | lr 0.00000 | ms/batch 76.56 | loss  2.66 | ppl    14.31 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 17.15s | valid loss  4.19 | valid ppl    66.09 | valid bpc    6.046
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 97.0%
| epoch  98 |   100/  216 batches | lr 0.00000 | ms/batch 77.27 | loss  2.69 | ppl    14.69 
| epoch  98 |   200/  216 batches | lr 0.00000 | ms/batch 77.12 | loss  2.65 | ppl    14.12 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 17.14s | valid loss  4.20 | valid ppl    66.70 | valid bpc    6.060
-----------------------------------------------------------------------------------------
PROGRESS: 98.0%
| epoch  99 |   100/  216 batches | lr 0.00000 | ms/batch 77.81 | loss  2.70 | ppl    14.84 
| epoch  99 |   200/  216 batches | lr 0.00000 | ms/batch 76.51 | loss  2.66 | ppl    14.27 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 17.14s | valid loss  4.21 | valid ppl    67.28 | valid bpc    6.072
-----------------------------------------------------------------------------------------
PROGRESS: 99.0%
| epoch 100 |   100/  216 batches | lr 0.00000 | ms/batch 77.49 | loss  2.68 | ppl    14.63 
| epoch 100 |   200/  216 batches | lr 0.00000 | ms/batch 76.90 | loss  2.64 | ppl    14.06 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 17.14s | valid loss  4.28 | valid ppl    72.48 | valid bpc    6.180
-----------------------------------------------------------------------------------------
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  4.19 | test ppl    66.02 | test bpc    6.045
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.3661, Mean Reca: 0.5055, Mean F1: 0.4169
Counter({'NP': 9178, 'PP': 3567, 'S': 3038, 'VP': 1421, 'QP': 301, 'SBAR': 262, 'ADJP': 232, 'SINV': 147, 'ADVP': 138, 'PRN': 36, 'FRAG': 34, 'WHNP': 26, 'NX': 18, 'NAC': 12, 'SQ': 10, 'SBARQ': 8, 'UCP': 5, 'CONJP': 4, 'WHPP': 3, 'X': 2, 'WHADVP': 1})
Counter({'NP': 14432, 'VP': 8130, 'S': 5620, 'PP': 5484, 'SBAR': 1796, 'ADJP': 649, 'QP': 490, 'ADVP': 286, 'SINV': 157, 'PRN': 128, 'NX': 95, 'FRAG': 42, 'WHNP': 37, 'UCP': 32, 'NAC': 30, 'WHPP': 25, 'CONJP': 21, 'SQ': 18, 'SBARQ': 10, 'WHADVP': 9, 'X': 6, 'WHADJP': 4, 'INTJ': 1})
SBAR: 0.1459
NP: 0.6359
VP: 0.1748
PP: 0.6504
ADJP: 0.3575
ADVP: 0.4825
5.332850827072502
-----------------------------------------------------------------------------------------
Dependency parsing performance:
Conll-U Style:
DDA: 0.423
UDA: 0.558
=========================================================================================
Loading dataset...
Loading dictionary...
Number of tokens:  10001
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer_in_parser', nhid=512, nlayers=8, front_layers=2, rear_layers=6, n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=5555, nonmono=5, cuda=True, log_interval=100, save='trained_models/structformer_in_parser_5555_26.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 38475637
Model architecture: StructFormer_In_Parser(
  (transformer_front): Transformer_Front(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(10001, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-1): 2 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
  (transformer_rear): Transformer_Rear(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(10001, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-5): 6 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (output_layer): Linear(in_features=512, out_features=10001, bias=True)
  )
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  216 batches | lr 0.00030 | ms/batch 79.96 | loss  7.28 | ppl  1452.20 
| epoch   1 |   200/  216 batches | lr 0.00030 | ms/batch 76.10 | loss  6.83 | ppl   921.20 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 17.30s | valid loss  6.57 | valid ppl   710.85 | valid bpc    9.473
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  216 batches | lr 0.00030 | ms/batch 77.24 | loss  6.67 | ppl   791.81 
| epoch   2 |   200/  216 batches | lr 0.00030 | ms/batch 75.96 | loss  6.35 | ppl   574.24 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 17.02s | valid loss  6.12 | valid ppl   455.28 | valid bpc    8.831
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  216 batches | lr 0.00030 | ms/batch 77.22 | loss  6.14 | ppl   462.95 
| epoch   3 |   200/  216 batches | lr 0.00030 | ms/batch 76.56 | loss  5.88 | ppl   356.79 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 17.08s | valid loss  5.72 | valid ppl   303.80 | valid bpc    8.247
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  216 batches | lr 0.00030 | ms/batch 77.84 | loss  5.73 | ppl   307.16 
| epoch   4 |   200/  216 batches | lr 0.00030 | ms/batch 76.02 | loss  5.53 | ppl   252.75 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 17.09s | valid loss  5.42 | valid ppl   226.60 | valid bpc    7.824
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  216 batches | lr 0.00030 | ms/batch 77.16 | loss  5.42 | ppl   226.82 
| epoch   5 |   200/  216 batches | lr 0.00030 | ms/batch 76.77 | loss  5.29 | ppl   197.77 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 17.11s | valid loss  5.22 | valid ppl   184.36 | valid bpc    7.526
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  216 batches | lr 0.00030 | ms/batch 77.24 | loss  5.21 | ppl   183.12 
| epoch   6 |   200/  216 batches | lr 0.00030 | ms/batch 76.80 | loss  5.13 | ppl   169.11 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 17.11s | valid loss  5.10 | valid ppl   164.55 | valid bpc    7.362
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  216 batches | lr 0.00030 | ms/batch 77.33 | loss  5.02 | ppl   151.56 
| epoch   7 |   200/  216 batches | lr 0.00030 | ms/batch 76.45 | loss  4.96 | ppl   142.40 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 17.13s | valid loss  4.94 | valid ppl   139.89 | valid bpc    7.128
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  216 batches | lr 0.00030 | ms/batch 78.03 | loss  4.92 | ppl   136.61 
| epoch   8 |   200/  216 batches | lr 0.00030 | ms/batch 76.34 | loss  4.83 | ppl   124.68 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 17.14s | valid loss  4.84 | valid ppl   126.82 | valid bpc    6.987
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 8.0%
| epoch   9 |   100/  216 batches | lr 0.00030 | ms/batch 77.45 | loss  4.78 | ppl   119.23 
| epoch   9 |   200/  216 batches | lr 0.00030 | ms/batch 76.79 | loss  4.70 | ppl   110.08 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 17.14s | valid loss  4.78 | valid ppl   118.88 | valid bpc    6.893
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  216 batches | lr 0.00030 | ms/batch 77.51 | loss  4.67 | ppl   106.56 
| epoch  10 |   200/  216 batches | lr 0.00030 | ms/batch 76.82 | loss  4.62 | ppl   101.43 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 17.14s | valid loss  4.75 | valid ppl   115.66 | valid bpc    6.854
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  216 batches | lr 0.00030 | ms/batch 78.00 | loss  4.58 | ppl    97.29 
| epoch  11 |   200/  216 batches | lr 0.00030 | ms/batch 76.26 | loss  4.51 | ppl    90.78 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 17.14s | valid loss  4.63 | valid ppl   102.68 | valid bpc    6.682
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  216 batches | lr 0.00030 | ms/batch 77.79 | loss  4.46 | ppl    86.42 
| epoch  12 |   200/  216 batches | lr 0.00030 | ms/batch 76.06 | loss  4.44 | ppl    84.40 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 17.13s | valid loss  4.64 | valid ppl   103.34 | valid bpc    6.691
-----------------------------------------------------------------------------------------
PROGRESS: 12.0%
| epoch  13 |   100/  216 batches | lr 0.00030 | ms/batch 77.83 | loss  4.39 | ppl    80.30 
| epoch  13 |   200/  216 batches | lr 0.00030 | ms/batch 76.24 | loss  4.35 | ppl    77.74 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 17.14s | valid loss  4.55 | valid ppl    94.60 | valid bpc    6.564
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 13.0%
| epoch  14 |   100/  216 batches | lr 0.00030 | ms/batch 77.65 | loss  4.30 | ppl    73.68 
| epoch  14 |   200/  216 batches | lr 0.00030 | ms/batch 76.73 | loss  4.28 | ppl    71.94 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 17.16s | valid loss  4.54 | valid ppl    94.10 | valid bpc    6.556
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  216 batches | lr 0.00030 | ms/batch 77.88 | loss  4.20 | ppl    67.00 
| epoch  15 |   200/  216 batches | lr 0.00030 | ms/batch 76.39 | loss  4.22 | ppl    68.37 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 17.15s | valid loss  4.50 | valid ppl    89.57 | valid bpc    6.485
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 15.0%
| epoch  16 |   100/  216 batches | lr 0.00030 | ms/batch 77.40 | loss  4.16 | ppl    64.13 
| epoch  16 |   200/  216 batches | lr 0.00030 | ms/batch 76.86 | loss  4.17 | ppl    64.65 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 17.15s | valid loss  4.46 | valid ppl    86.25 | valid bpc    6.430
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 16.0%
| epoch  17 |   100/  216 batches | lr 0.00030 | ms/batch 77.51 | loss  4.11 | ppl    61.00 
| epoch  17 |   200/  216 batches | lr 0.00030 | ms/batch 76.85 | loss  4.07 | ppl    58.82 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 17.14s | valid loss  4.43 | valid ppl    83.59 | valid bpc    6.385
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 17.0%
| epoch  18 |   100/  216 batches | lr 0.00030 | ms/batch 77.64 | loss  4.03 | ppl    56.22 
| epoch  18 |   200/  216 batches | lr 0.00030 | ms/batch 76.56 | loss  4.02 | ppl    55.53 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 17.15s | valid loss  4.40 | valid ppl    81.53 | valid bpc    6.349
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 18.0%
| epoch  19 |   100/  216 batches | lr 0.00030 | ms/batch 77.94 | loss  4.00 | ppl    54.76 
| epoch  19 |   200/  216 batches | lr 0.00030 | ms/batch 76.36 | loss  3.93 | ppl    51.06 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 17.14s | valid loss  4.40 | valid ppl    81.51 | valid bpc    6.349
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 19.0%
| epoch  20 |   100/  216 batches | lr 0.00030 | ms/batch 77.85 | loss  3.92 | ppl    50.46 
| epoch  20 |   200/  216 batches | lr 0.00030 | ms/batch 76.37 | loss  3.89 | ppl    49.14 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 17.14s | valid loss  4.40 | valid ppl    81.45 | valid bpc    6.348
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 20.0%
| epoch  21 |   100/  216 batches | lr 0.00030 | ms/batch 77.39 | loss  3.88 | ppl    48.21 
| epoch  21 |   200/  216 batches | lr 0.00030 | ms/batch 76.97 | loss  3.86 | ppl    47.43 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 17.14s | valid loss  4.37 | valid ppl    79.29 | valid bpc    6.309
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 21.0%
| epoch  22 |   100/  216 batches | lr 0.00030 | ms/batch 77.65 | loss  3.82 | ppl    45.43 
| epoch  22 |   200/  216 batches | lr 0.00030 | ms/batch 76.57 | loss  3.81 | ppl    44.94 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 17.14s | valid loss  4.36 | valid ppl    78.55 | valid bpc    6.296
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 22.0%
| epoch  23 |   100/  216 batches | lr 0.00030 | ms/batch 77.94 | loss  3.78 | ppl    43.90 
| epoch  23 |   200/  216 batches | lr 0.00030 | ms/batch 76.38 | loss  3.74 | ppl    42.03 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 17.14s | valid loss  4.29 | valid ppl    72.98 | valid bpc    6.189
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 23.0%
| epoch  24 |   100/  216 batches | lr 0.00030 | ms/batch 77.72 | loss  3.71 | ppl    41.06 
| epoch  24 |   200/  216 batches | lr 0.00030 | ms/batch 76.17 | loss  3.71 | ppl    40.98 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 17.13s | valid loss  4.32 | valid ppl    75.28 | valid bpc    6.234
-----------------------------------------------------------------------------------------
PROGRESS: 24.0%
| epoch  25 |   100/  216 batches | lr 0.00030 | ms/batch 77.58 | loss  3.67 | ppl    39.11 
| epoch  25 |   200/  216 batches | lr 0.00030 | ms/batch 76.66 | loss  3.66 | ppl    38.88 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 17.14s | valid loss  4.31 | valid ppl    74.64 | valid bpc    6.222
-----------------------------------------------------------------------------------------
PROGRESS: 25.0%
| epoch  26 |   100/  216 batches | lr 0.00030 | ms/batch 77.86 | loss  3.63 | ppl    37.72 
| epoch  26 |   200/  216 batches | lr 0.00030 | ms/batch 76.53 | loss  3.63 | ppl    37.55 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 17.14s | valid loss  4.29 | valid ppl    73.07 | valid bpc    6.191
-----------------------------------------------------------------------------------------
PROGRESS: 26.0%
| epoch  27 |   100/  216 batches | lr 0.00015 | ms/batch 77.57 | loss  3.54 | ppl    34.43 
| epoch  27 |   200/  216 batches | lr 0.00015 | ms/batch 76.58 | loss  3.50 | ppl    33.06 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 17.13s | valid loss  4.26 | valid ppl    71.08 | valid bpc    6.151
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 27.0%
| epoch  28 |   100/  216 batches | lr 0.00015 | ms/batch 77.77 | loss  3.48 | ppl    32.33 
| epoch  28 |   200/  216 batches | lr 0.00015 | ms/batch 76.69 | loss  3.46 | ppl    31.66 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 17.14s | valid loss  4.25 | valid ppl    70.39 | valid bpc    6.137
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  216 batches | lr 0.00015 | ms/batch 77.42 | loss  3.44 | ppl    31.13 
| epoch  29 |   200/  216 batches | lr 0.00015 | ms/batch 76.84 | loss  3.43 | ppl    30.77 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 17.14s | valid loss  4.24 | valid ppl    69.14 | valid bpc    6.112
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  216 batches | lr 0.00015 | ms/batch 78.00 | loss  3.40 | ppl    30.07 
| epoch  30 |   200/  216 batches | lr 0.00015 | ms/batch 76.44 | loss  3.38 | ppl    29.41 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 17.15s | valid loss  4.24 | valid ppl    69.10 | valid bpc    6.111
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 30.0%
| epoch  31 |   100/  216 batches | lr 0.00015 | ms/batch 77.67 | loss  3.38 | ppl    29.29 
| epoch  31 |   200/  216 batches | lr 0.00015 | ms/batch 76.55 | loss  3.35 | ppl    28.47 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 17.13s | valid loss  4.23 | valid ppl    68.84 | valid bpc    6.105
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 31.0%
| epoch  32 |   100/  216 batches | lr 0.00015 | ms/batch 78.16 | loss  3.34 | ppl    28.27 
| epoch  32 |   200/  216 batches | lr 0.00015 | ms/batch 76.09 | loss  3.33 | ppl    28.02 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 17.13s | valid loss  4.23 | valid ppl    68.75 | valid bpc    6.103
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 32.0%
| epoch  33 |   100/  216 batches | lr 0.00015 | ms/batch 77.76 | loss  3.33 | ppl    27.87 
| epoch  33 |   200/  216 batches | lr 0.00015 | ms/batch 76.56 | loss  3.30 | ppl    27.07 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 17.14s | valid loss  4.19 | valid ppl    66.07 | valid bpc    6.046
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 33.0%
| epoch  34 |   100/  216 batches | lr 0.00015 | ms/batch 77.55 | loss  3.28 | ppl    26.65 
| epoch  34 |   200/  216 batches | lr 0.00015 | ms/batch 76.68 | loss  3.30 | ppl    27.12 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 17.13s | valid loss  4.22 | valid ppl    67.73 | valid bpc    6.082
-----------------------------------------------------------------------------------------
PROGRESS: 34.0%
| epoch  35 |   100/  216 batches | lr 0.00015 | ms/batch 78.22 | loss  3.26 | ppl    26.16 
| epoch  35 |   200/  216 batches | lr 0.00015 | ms/batch 76.10 | loss  3.27 | ppl    26.22 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 17.14s | valid loss  4.21 | valid ppl    67.24 | valid bpc    6.071
-----------------------------------------------------------------------------------------
PROGRESS: 35.0%
| epoch  36 |   100/  216 batches | lr 0.00015 | ms/batch 77.59 | loss  3.24 | ppl    25.53 
| epoch  36 |   200/  216 batches | lr 0.00015 | ms/batch 76.51 | loss  3.21 | ppl    24.85 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 17.15s | valid loss  4.23 | valid ppl    68.79 | valid bpc    6.104
-----------------------------------------------------------------------------------------
PROGRESS: 36.0%
| epoch  37 |   100/  216 batches | lr 0.00007 | ms/batch 77.93 | loss  3.19 | ppl    24.32 
| epoch  37 |   200/  216 batches | lr 0.00007 | ms/batch 76.49 | loss  3.16 | ppl    23.66 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 17.14s | valid loss  4.21 | valid ppl    67.13 | valid bpc    6.069
-----------------------------------------------------------------------------------------
PROGRESS: 37.0%
| epoch  38 |   100/  216 batches | lr 0.00007 | ms/batch 77.94 | loss  3.14 | ppl    23.02 
| epoch  38 |   200/  216 batches | lr 0.00007 | ms/batch 76.21 | loss  3.13 | ppl    22.95 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 17.14s | valid loss  4.17 | valid ppl    64.56 | valid bpc    6.013
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 38.0%
| epoch  39 |   100/  216 batches | lr 0.00007 | ms/batch 77.90 | loss  3.13 | ppl    22.88 
| epoch  39 |   200/  216 batches | lr 0.00007 | ms/batch 76.33 | loss  3.11 | ppl    22.38 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 17.13s | valid loss  4.19 | valid ppl    65.78 | valid bpc    6.040
-----------------------------------------------------------------------------------------
PROGRESS: 39.0%
| epoch  40 |   100/  216 batches | lr 0.00007 | ms/batch 77.79 | loss  3.11 | ppl    22.44 
| epoch  40 |   200/  216 batches | lr 0.00007 | ms/batch 76.47 | loss  3.12 | ppl    22.56 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 17.13s | valid loss  4.22 | valid ppl    67.73 | valid bpc    6.082
-----------------------------------------------------------------------------------------
PROGRESS: 40.0%
| epoch  41 |   100/  216 batches | lr 0.00007 | ms/batch 77.85 | loss  3.09 | ppl    22.06 
| epoch  41 |   200/  216 batches | lr 0.00007 | ms/batch 76.41 | loss  3.07 | ppl    21.60 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 17.14s | valid loss  4.20 | valid ppl    66.49 | valid bpc    6.055
-----------------------------------------------------------------------------------------
PROGRESS: 41.0%
| epoch  42 |   100/  216 batches | lr 0.00004 | ms/batch 77.46 | loss  3.08 | ppl    21.67 
| epoch  42 |   200/  216 batches | lr 0.00004 | ms/batch 76.97 | loss  3.06 | ppl    21.25 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 17.15s | valid loss  4.25 | valid ppl    69.79 | valid bpc    6.125
-----------------------------------------------------------------------------------------
PROGRESS: 42.0%
| epoch  43 |   100/  216 batches | lr 0.00004 | ms/batch 78.07 | loss  3.07 | ppl    21.44 
| epoch  43 |   200/  216 batches | lr 0.00004 | ms/batch 76.23 | loss  3.06 | ppl    21.25 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 17.14s | valid loss  4.20 | valid ppl    66.66 | valid bpc    6.059
-----------------------------------------------------------------------------------------
PROGRESS: 43.0%
| epoch  44 |   100/  216 batches | lr 0.00004 | ms/batch 77.88 | loss  3.06 | ppl    21.29 
| epoch  44 |   200/  216 batches | lr 0.00004 | ms/batch 76.37 | loss  3.01 | ppl    20.30 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 17.14s | valid loss  4.17 | valid ppl    64.73 | valid bpc    6.016
-----------------------------------------------------------------------------------------
PROGRESS: 44.0%
| epoch  45 |   100/  216 batches | lr 0.00002 | ms/batch 77.94 | loss  3.02 | ppl    20.55 
| epoch  45 |   200/  216 batches | lr 0.00002 | ms/batch 76.25 | loss  3.01 | ppl    20.35 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 17.13s | valid loss  4.15 | valid ppl    63.66 | valid bpc    5.992
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 45.0%
| epoch  46 |   100/  216 batches | lr 0.00002 | ms/batch 77.52 | loss  3.02 | ppl    20.56 
| epoch  46 |   200/  216 batches | lr 0.00002 | ms/batch 76.86 | loss  3.01 | ppl    20.20 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 17.14s | valid loss  4.20 | valid ppl    66.49 | valid bpc    6.055
-----------------------------------------------------------------------------------------
PROGRESS: 46.0%
| epoch  47 |   100/  216 batches | lr 0.00002 | ms/batch 77.51 | loss  3.00 | ppl    20.17 
| epoch  47 |   200/  216 batches | lr 0.00002 | ms/batch 76.51 | loss  3.01 | ppl    20.37 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 17.14s | valid loss  4.18 | valid ppl    65.11 | valid bpc    6.025
-----------------------------------------------------------------------------------------
PROGRESS: 47.0%
| epoch  48 |   100/  216 batches | lr 0.00002 | ms/batch 77.87 | loss  3.01 | ppl    20.23 
| epoch  48 |   200/  216 batches | lr 0.00002 | ms/batch 76.44 | loss  2.99 | ppl    19.88 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 17.14s | valid loss  4.20 | valid ppl    66.41 | valid bpc    6.053
-----------------------------------------------------------------------------------------
PROGRESS: 48.0%
| epoch  49 |   100/  216 batches | lr 0.00001 | ms/batch 77.83 | loss  2.99 | ppl    19.82 
| epoch  49 |   200/  216 batches | lr 0.00001 | ms/batch 76.51 | loss  2.99 | ppl    19.87 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 17.15s | valid loss  4.21 | valid ppl    67.62 | valid bpc    6.079
-----------------------------------------------------------------------------------------
PROGRESS: 49.0%
| epoch  50 |   100/  216 batches | lr 0.00001 | ms/batch 77.88 | loss  2.99 | ppl    19.83 
| epoch  50 |   200/  216 batches | lr 0.00001 | ms/batch 76.57 | loss  2.97 | ppl    19.51 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 17.15s | valid loss  4.19 | valid ppl    65.70 | valid bpc    6.038
-----------------------------------------------------------------------------------------
PROGRESS: 50.0%
| epoch  51 |   100/  216 batches | lr 0.00001 | ms/batch 77.72 | loss  3.01 | ppl    20.21 
| epoch  51 |   200/  216 batches | lr 0.00001 | ms/batch 76.68 | loss  2.97 | ppl    19.45 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 17.14s | valid loss  4.21 | valid ppl    67.56 | valid bpc    6.078
-----------------------------------------------------------------------------------------
PROGRESS: 51.0%
| epoch  52 |   100/  216 batches | lr 0.00000 | ms/batch 77.86 | loss  3.01 | ppl    20.31 
| epoch  52 |   200/  216 batches | lr 0.00000 | ms/batch 76.43 | loss  2.94 | ppl    18.93 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 17.13s | valid loss  4.18 | valid ppl    65.49 | valid bpc    6.033
-----------------------------------------------------------------------------------------
PROGRESS: 52.0%
| epoch  53 |   100/  216 batches | lr 0.00000 | ms/batch 77.53 | loss  2.98 | ppl    19.67 
| epoch  53 |   200/  216 batches | lr 0.00000 | ms/batch 76.87 | loss  2.98 | ppl    19.63 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 17.14s | valid loss  4.19 | valid ppl    66.27 | valid bpc    6.050
-----------------------------------------------------------------------------------------
PROGRESS: 53.0%
| epoch  54 |   100/  216 batches | lr 0.00000 | ms/batch 77.53 | loss  2.98 | ppl    19.62 
| epoch  54 |   200/  216 batches | lr 0.00000 | ms/batch 76.89 | loss  2.96 | ppl    19.24 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 17.15s | valid loss  4.16 | valid ppl    63.88 | valid bpc    5.997
-----------------------------------------------------------------------------------------
PROGRESS: 54.0%
| epoch  55 |   100/  216 batches | lr 0.00000 | ms/batch 77.86 | loss  2.98 | ppl    19.76 
| epoch  55 |   200/  216 batches | lr 0.00000 | ms/batch 76.46 | loss  2.98 | ppl    19.66 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 17.15s | valid loss  4.16 | valid ppl    64.13 | valid bpc    6.003
-----------------------------------------------------------------------------------------
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  216 batches | lr 0.00000 | ms/batch 77.51 | loss  2.98 | ppl    19.75 
| epoch  56 |   200/  216 batches | lr 0.00000 | ms/batch 76.83 | loss  2.98 | ppl    19.69 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 17.14s | valid loss  4.23 | valid ppl    68.38 | valid bpc    6.096
-----------------------------------------------------------------------------------------
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  216 batches | lr 0.00000 | ms/batch 77.57 | loss  2.98 | ppl    19.79 
| epoch  57 |   200/  216 batches | lr 0.00000 | ms/batch 76.86 | loss  2.97 | ppl    19.52 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 17.14s | valid loss  4.21 | valid ppl    67.16 | valid bpc    6.070
-----------------------------------------------------------------------------------------
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  216 batches | lr 0.00000 | ms/batch 77.99 | loss  2.99 | ppl    19.97 
| epoch  58 |   200/  216 batches | lr 0.00000 | ms/batch 76.17 | loss  2.95 | ppl    19.06 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 17.14s | valid loss  4.19 | valid ppl    66.14 | valid bpc    6.047
-----------------------------------------------------------------------------------------
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  216 batches | lr 0.00000 | ms/batch 77.62 | loss  2.98 | ppl    19.66 
| epoch  59 |   200/  216 batches | lr 0.00000 | ms/batch 76.64 | loss  2.95 | ppl    19.07 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 17.14s | valid loss  4.18 | valid ppl    65.56 | valid bpc    6.035
-----------------------------------------------------------------------------------------
PROGRESS: 59.0%
| epoch  60 |   100/  216 batches | lr 0.00000 | ms/batch 77.89 | loss  3.00 | ppl    20.10 
| epoch  60 |   200/  216 batches | lr 0.00000 | ms/batch 76.45 | loss  2.97 | ppl    19.42 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 17.14s | valid loss  4.26 | valid ppl    70.86 | valid bpc    6.147
-----------------------------------------------------------------------------------------
PROGRESS: 60.0%
| epoch  61 |   100/  216 batches | lr 0.00000 | ms/batch 77.69 | loss  3.00 | ppl    20.09 
| epoch  61 |   200/  216 batches | lr 0.00000 | ms/batch 76.55 | loss  2.94 | ppl    19.00 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 17.13s | valid loss  4.17 | valid ppl    65.03 | valid bpc    6.023
-----------------------------------------------------------------------------------------
PROGRESS: 61.0%
| epoch  62 |   100/  216 batches | lr 0.00000 | ms/batch 77.44 | loss  3.00 | ppl    20.04 
| epoch  62 |   200/  216 batches | lr 0.00000 | ms/batch 77.03 | loss  2.95 | ppl    19.14 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 17.15s | valid loss  4.18 | valid ppl    65.62 | valid bpc    6.036
-----------------------------------------------------------------------------------------
PROGRESS: 62.0%
| epoch  63 |   100/  216 batches | lr 0.00000 | ms/batch 77.75 | loss  2.99 | ppl    19.86 
| epoch  63 |   200/  216 batches | lr 0.00000 | ms/batch 76.75 | loss  2.96 | ppl    19.22 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 17.15s | valid loss  4.19 | valid ppl    65.87 | valid bpc    6.042
-----------------------------------------------------------------------------------------
PROGRESS: 63.0%
| epoch  64 |   100/  216 batches | lr 0.00000 | ms/batch 77.93 | loss  2.97 | ppl    19.44 
| epoch  64 |   200/  216 batches | lr 0.00000 | ms/batch 76.38 | loss  2.96 | ppl    19.38 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 17.14s | valid loss  4.22 | valid ppl    67.91 | valid bpc    6.086
-----------------------------------------------------------------------------------------
PROGRESS: 64.0%
| epoch  65 |   100/  216 batches | lr 0.00000 | ms/batch 77.51 | loss  2.98 | ppl    19.70 
| epoch  65 |   200/  216 batches | lr 0.00000 | ms/batch 76.38 | loss  2.96 | ppl    19.25 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 17.15s | valid loss  4.18 | valid ppl    65.15 | valid bpc    6.026
-----------------------------------------------------------------------------------------
PROGRESS: 65.0%
| epoch  66 |   100/  216 batches | lr 0.00000 | ms/batch 78.11 | loss  3.00 | ppl    20.02 
| epoch  66 |   200/  216 batches | lr 0.00000 | ms/batch 76.22 | loss  2.95 | ppl    19.18 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 17.15s | valid loss  4.22 | valid ppl    67.71 | valid bpc    6.081
-----------------------------------------------------------------------------------------
PROGRESS: 66.0%
| epoch  67 |   100/  216 batches | lr 0.00000 | ms/batch 77.71 | loss  2.97 | ppl    19.52 
| epoch  67 |   200/  216 batches | lr 0.00000 | ms/batch 76.75 | loss  2.97 | ppl    19.49 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 17.15s | valid loss  4.22 | valid ppl    68.31 | valid bpc    6.094
-----------------------------------------------------------------------------------------
PROGRESS: 67.0%
| epoch  68 |   100/  216 batches | lr 0.00000 | ms/batch 77.72 | loss  2.98 | ppl    19.65 
| epoch  68 |   200/  216 batches | lr 0.00000 | ms/batch 76.57 | loss  2.96 | ppl    19.33 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 17.14s | valid loss  4.17 | valid ppl    64.56 | valid bpc    6.013
-----------------------------------------------------------------------------------------
PROGRESS: 68.0%
| epoch  69 |   100/  216 batches | lr 0.00000 | ms/batch 78.15 | loss  2.99 | ppl    19.84 
| epoch  69 |   200/  216 batches | lr 0.00000 | ms/batch 76.16 | loss  2.95 | ppl    19.13 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 17.15s | valid loss  4.15 | valid ppl    63.60 | valid bpc    5.991
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 69.0%
| epoch  70 |   100/  216 batches | lr 0.00000 | ms/batch 77.89 | loss  3.00 | ppl    20.01 
| epoch  70 |   200/  216 batches | lr 0.00000 | ms/batch 76.36 | loss  2.96 | ppl    19.21 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 17.14s | valid loss  4.17 | valid ppl    64.90 | valid bpc    6.020
-----------------------------------------------------------------------------------------
PROGRESS: 70.0%
| epoch  71 |   100/  216 batches | lr 0.00000 | ms/batch 77.59 | loss  2.99 | ppl    19.83 
| epoch  71 |   200/  216 batches | lr 0.00000 | ms/batch 76.74 | loss  2.98 | ppl    19.64 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 17.14s | valid loss  4.20 | valid ppl    66.61 | valid bpc    6.058
-----------------------------------------------------------------------------------------
PROGRESS: 71.0%
| epoch  72 |   100/  216 batches | lr 0.00000 | ms/batch 77.65 | loss  3.00 | ppl    19.99 
| epoch  72 |   200/  216 batches | lr 0.00000 | ms/batch 76.29 | loss  2.94 | ppl    18.87 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 17.13s | valid loss  4.21 | valid ppl    67.08 | valid bpc    6.068
-----------------------------------------------------------------------------------------
PROGRESS: 72.0%
| epoch  73 |   100/  216 batches | lr 0.00000 | ms/batch 78.01 | loss  2.98 | ppl    19.60 
| epoch  73 |   200/  216 batches | lr 0.00000 | ms/batch 76.35 | loss  2.98 | ppl    19.68 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 17.13s | valid loss  4.19 | valid ppl    66.28 | valid bpc    6.050
-----------------------------------------------------------------------------------------
PROGRESS: 73.0%
| epoch  74 |   100/  216 batches | lr 0.00000 | ms/batch 77.56 | loss  3.00 | ppl    20.03 
| epoch  74 |   200/  216 batches | lr 0.00000 | ms/batch 76.71 | loss  2.98 | ppl    19.66 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 17.14s | valid loss  4.24 | valid ppl    69.71 | valid bpc    6.123
-----------------------------------------------------------------------------------------
PROGRESS: 74.0%
| epoch  75 |   100/  216 batches | lr 0.00000 | ms/batch 77.52 | loss  2.98 | ppl    19.72 
| epoch  75 |   200/  216 batches | lr 0.00000 | ms/batch 76.73 | loss  2.96 | ppl    19.30 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 17.14s | valid loss  4.20 | valid ppl    67.02 | valid bpc    6.066
-----------------------------------------------------------------------------------------
PROGRESS: 75.0%
| epoch  76 |   100/  216 batches | lr 0.00000 | ms/batch 77.53 | loss  2.99 | ppl    19.82 
| epoch  76 |   200/  216 batches | lr 0.00000 | ms/batch 76.80 | loss  2.96 | ppl    19.35 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 17.14s | valid loss  4.22 | valid ppl    68.21 | valid bpc    6.092
-----------------------------------------------------------------------------------------
PROGRESS: 76.0%
| epoch  77 |   100/  216 batches | lr 0.00000 | ms/batch 77.53 | loss  2.98 | ppl    19.76 
| epoch  77 |   200/  216 batches | lr 0.00000 | ms/batch 76.73 | loss  2.95 | ppl    19.16 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 17.13s | valid loss  4.17 | valid ppl    64.96 | valid bpc    6.021
-----------------------------------------------------------------------------------------
PROGRESS: 77.0%
| epoch  78 |   100/  216 batches | lr 0.00000 | ms/batch 77.77 | loss  2.95 | ppl    19.02 
| epoch  78 |   200/  216 batches | lr 0.00000 | ms/batch 76.53 | loss  2.98 | ppl    19.60 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 17.17s | valid loss  4.17 | valid ppl    64.40 | valid bpc    6.009
-----------------------------------------------------------------------------------------
PROGRESS: 78.0%
| epoch  79 |   100/  216 batches | lr 0.00000 | ms/batch 78.08 | loss  2.97 | ppl    19.58 
| epoch  79 |   200/  216 batches | lr 0.00000 | ms/batch 76.18 | loss  2.96 | ppl    19.33 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 17.14s | valid loss  4.18 | valid ppl    65.50 | valid bpc    6.033
-----------------------------------------------------------------------------------------
PROGRESS: 79.0%
| epoch  80 |   100/  216 batches | lr 0.00000 | ms/batch 77.44 | loss  3.00 | ppl    20.05 
| epoch  80 |   200/  216 batches | lr 0.00000 | ms/batch 76.86 | loss  2.95 | ppl    19.05 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 17.14s | valid loss  4.18 | valid ppl    65.08 | valid bpc    6.024
-----------------------------------------------------------------------------------------
PROGRESS: 80.0%
| epoch  81 |   100/  216 batches | lr 0.00000 | ms/batch 77.76 | loss  2.98 | ppl    19.61 
| epoch  81 |   200/  216 batches | lr 0.00000 | ms/batch 76.53 | loss  2.96 | ppl    19.33 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 17.14s | valid loss  4.21 | valid ppl    67.02 | valid bpc    6.067
-----------------------------------------------------------------------------------------
PROGRESS: 81.0%
| epoch  82 |   100/  216 batches | lr 0.00000 | ms/batch 77.46 | loss  3.00 | ppl    20.04 
| epoch  82 |   200/  216 batches | lr 0.00000 | ms/batch 76.77 | loss  2.94 | ppl    18.98 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 17.14s | valid loss  4.23 | valid ppl    68.45 | valid bpc    6.097
-----------------------------------------------------------------------------------------
PROGRESS: 82.0%
| epoch  83 |   100/  216 batches | lr 0.00000 | ms/batch 77.85 | loss  2.99 | ppl    19.88 
| epoch  83 |   200/  216 batches | lr 0.00000 | ms/batch 76.22 | loss  2.96 | ppl    19.39 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 17.14s | valid loss  4.20 | valid ppl    66.36 | valid bpc    6.052
-----------------------------------------------------------------------------------------
PROGRESS: 83.0%
| epoch  84 |   100/  216 batches | lr 0.00000 | ms/batch 77.73 | loss  2.98 | ppl    19.70 
| epoch  84 |   200/  216 batches | lr 0.00000 | ms/batch 76.58 | loss  2.95 | ppl    19.08 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 17.14s | valid loss  4.11 | valid ppl    60.83 | valid bpc    5.927
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 84.0%
| epoch  85 |   100/  216 batches | lr 0.00000 | ms/batch 77.39 | loss  2.97 | ppl    19.54 
| epoch  85 |   200/  216 batches | lr 0.00000 | ms/batch 76.70 | loss  2.95 | ppl    19.20 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 17.14s | valid loss  4.24 | valid ppl    69.19 | valid bpc    6.113
-----------------------------------------------------------------------------------------
PROGRESS: 85.0%
| epoch  86 |   100/  216 batches | lr 0.00000 | ms/batch 77.92 | loss  2.99 | ppl    19.83 
| epoch  86 |   200/  216 batches | lr 0.00000 | ms/batch 76.31 | loss  2.94 | ppl    19.00 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 17.14s | valid loss  4.16 | valid ppl    63.79 | valid bpc    5.995
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  216 batches | lr 0.00000 | ms/batch 77.59 | loss  3.00 | ppl    19.99 
| epoch  87 |   200/  216 batches | lr 0.00000 | ms/batch 76.72 | loss  2.96 | ppl    19.30 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 17.14s | valid loss  4.18 | valid ppl    65.61 | valid bpc    6.036
-----------------------------------------------------------------------------------------
PROGRESS: 87.0%
| epoch  88 |   100/  216 batches | lr 0.00000 | ms/batch 77.64 | loss  2.98 | ppl    19.77 
| epoch  88 |   200/  216 batches | lr 0.00000 | ms/batch 76.63 | loss  2.97 | ppl    19.57 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 17.13s | valid loss  4.15 | valid ppl    63.13 | valid bpc    5.980
-----------------------------------------------------------------------------------------
PROGRESS: 88.0%
| epoch  89 |   100/  216 batches | lr 0.00000 | ms/batch 77.54 | loss  3.00 | ppl    20.10 
| epoch  89 |   200/  216 batches | lr 0.00000 | ms/batch 76.83 | loss  2.95 | ppl    19.01 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 17.14s | valid loss  4.13 | valid ppl    62.42 | valid bpc    5.964
-----------------------------------------------------------------------------------------
PROGRESS: 89.0%
| epoch  90 |   100/  216 batches | lr 0.00000 | ms/batch 78.00 | loss  3.00 | ppl    20.13 
| epoch  90 |   200/  216 batches | lr 0.00000 | ms/batch 76.42 | loss  2.95 | ppl    19.15 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 17.15s | valid loss  4.20 | valid ppl    66.75 | valid bpc    6.061
-----------------------------------------------------------------------------------------
PROGRESS: 90.0%
| epoch  91 |   100/  216 batches | lr 0.00000 | ms/batch 77.58 | loss  2.96 | ppl    19.39 
| epoch  91 |   200/  216 batches | lr 0.00000 | ms/batch 76.58 | loss  2.98 | ppl    19.67 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 17.13s | valid loss  4.21 | valid ppl    67.34 | valid bpc    6.073
-----------------------------------------------------------------------------------------
PROGRESS: 91.0%
| epoch  92 |   100/  216 batches | lr 0.00000 | ms/batch 78.03 | loss  2.98 | ppl    19.63 
| epoch  92 |   200/  216 batches | lr 0.00000 | ms/batch 76.25 | loss  2.95 | ppl    19.11 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 17.14s | valid loss  4.18 | valid ppl    65.20 | valid bpc    6.027
-----------------------------------------------------------------------------------------
PROGRESS: 92.0%
| epoch  93 |   100/  216 batches | lr 0.00000 | ms/batch 77.76 | loss  3.00 | ppl    20.13 
| epoch  93 |   200/  216 batches | lr 0.00000 | ms/batch 76.70 | loss  2.97 | ppl    19.51 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 17.14s | valid loss  4.19 | valid ppl    66.04 | valid bpc    6.045
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  216 batches | lr 0.00000 | ms/batch 77.64 | loss  2.99 | ppl    19.87 
| epoch  94 |   200/  216 batches | lr 0.00000 | ms/batch 76.96 | loss  2.95 | ppl    19.11 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 17.15s | valid loss  4.21 | valid ppl    67.28 | valid bpc    6.072
-----------------------------------------------------------------------------------------
PROGRESS: 94.0%
| epoch  95 |   100/  216 batches | lr 0.00000 | ms/batch 77.79 | loss  2.99 | ppl    19.83 
| epoch  95 |   200/  216 batches | lr 0.00000 | ms/batch 76.37 | loss  2.95 | ppl    19.02 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 17.14s | valid loss  4.17 | valid ppl    64.80 | valid bpc    6.018
-----------------------------------------------------------------------------------------
PROGRESS: 95.0%
| epoch  96 |   100/  216 batches | lr 0.00000 | ms/batch 77.34 | loss  2.99 | ppl    19.79 
| epoch  96 |   200/  216 batches | lr 0.00000 | ms/batch 76.68 | loss  2.93 | ppl    18.82 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 17.14s | valid loss  4.16 | valid ppl    63.75 | valid bpc    5.994
-----------------------------------------------------------------------------------------
PROGRESS: 96.0%
| epoch  97 |   100/  216 batches | lr 0.00000 | ms/batch 77.64 | loss  2.98 | ppl    19.63 
| epoch  97 |   200/  216 batches | lr 0.00000 | ms/batch 76.70 | loss  2.99 | ppl    19.79 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 17.13s | valid loss  4.15 | valid ppl    63.55 | valid bpc    5.990
-----------------------------------------------------------------------------------------
PROGRESS: 97.0%
| epoch  98 |   100/  216 batches | lr 0.00000 | ms/batch 77.26 | loss  2.99 | ppl    19.97 
| epoch  98 |   200/  216 batches | lr 0.00000 | ms/batch 76.74 | loss  2.94 | ppl    18.91 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 17.13s | valid loss  4.19 | valid ppl    65.87 | valid bpc    6.041
-----------------------------------------------------------------------------------------
PROGRESS: 98.0%
| epoch  99 |   100/  216 batches | lr 0.00000 | ms/batch 77.79 | loss  2.96 | ppl    19.33 
| epoch  99 |   200/  216 batches | lr 0.00000 | ms/batch 76.59 | loss  2.97 | ppl    19.50 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 17.12s | valid loss  4.16 | valid ppl    63.86 | valid bpc    5.997
-----------------------------------------------------------------------------------------
PROGRESS: 99.0%
| epoch 100 |   100/  216 batches | lr 0.00000 | ms/batch 77.55 | loss  2.98 | ppl    19.62 
| epoch 100 |   200/  216 batches | lr 0.00000 | ms/batch 76.70 | loss  2.96 | ppl    19.36 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 17.14s | valid loss  4.21 | valid ppl    67.40 | valid bpc    6.075
-----------------------------------------------------------------------------------------
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  4.12 | test ppl    61.61 | test bpc    5.945
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.3958, Mean Reca: 0.5467, Mean F1: 0.4510
Counter({'NP': 8843, 'PP': 3706, 'S': 3148, 'VP': 2276, 'SBAR': 448, 'ADJP': 319, 'QP': 313, 'ADVP': 165, 'SINV': 146, 'PRN': 52, 'FRAG': 34, 'WHNP': 29, 'NAC': 13, 'UCP': 13, 'SQ': 12, 'WHPP': 11, 'CONJP': 10, 'NX': 9, 'SBARQ': 9, 'X': 3, 'WHADVP': 1})
Counter({'NP': 14432, 'VP': 8130, 'S': 5620, 'PP': 5484, 'SBAR': 1796, 'ADJP': 649, 'QP': 490, 'ADVP': 286, 'SINV': 157, 'PRN': 128, 'NX': 95, 'FRAG': 42, 'WHNP': 37, 'UCP': 32, 'NAC': 30, 'WHPP': 25, 'CONJP': 21, 'SQ': 18, 'SBARQ': 10, 'WHADVP': 9, 'X': 6, 'WHADJP': 4, 'INTJ': 1})
SBAR: 0.2494
NP: 0.6127
VP: 0.2800
PP: 0.6758
ADJP: 0.4915
ADVP: 0.5769
4.923192948232217
-----------------------------------------------------------------------------------------
Dependency parsing performance:
Conll-U Style:
DDA: 0.394
UDA: 0.526
=========================================================================================
Loading dataset...
Loading dictionary...
Number of tokens:  10001
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer_in_parser', nhid=512, nlayers=8, front_layers=3, rear_layers=5, n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=1111, nonmono=5, cuda=True, log_interval=100, save='trained_models/structformer_in_parser_1111_35.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 38475621
Model architecture: StructFormer_In_Parser(
  (transformer_front): Transformer_Front(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(10001, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-2): 3 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
  (transformer_rear): Transformer_Rear(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(10001, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-4): 5 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (output_layer): Linear(in_features=512, out_features=10001, bias=True)
  )
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  216 batches | lr 0.00030 | ms/batch 80.75 | loss  7.30 | ppl  1475.84 
| epoch   1 |   200/  216 batches | lr 0.00030 | ms/batch 75.03 | loss  6.85 | ppl   940.12 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 17.25s | valid loss  6.69 | valid ppl   804.33 | valid bpc    9.652
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  216 batches | lr 0.00030 | ms/batch 76.48 | loss  6.74 | ppl   842.40 
| epoch   2 |   200/  216 batches | lr 0.00030 | ms/batch 76.08 | loss  6.47 | ppl   647.34 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 16.95s | valid loss  6.24 | valid ppl   514.76 | valid bpc    9.008
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  216 batches | lr 0.00030 | ms/batch 77.51 | loss  6.22 | ppl   501.32 
| epoch   3 |   200/  216 batches | lr 0.00030 | ms/batch 75.59 | loss  5.97 | ppl   389.80 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 17.00s | valid loss  5.82 | valid ppl   337.85 | valid bpc    8.400
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  216 batches | lr 0.00030 | ms/batch 76.86 | loss  5.81 | ppl   332.28 
| epoch   4 |   200/  216 batches | lr 0.00030 | ms/batch 76.54 | loss  5.64 | ppl   280.86 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 17.04s | valid loss  5.51 | valid ppl   246.52 | valid bpc    7.946
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  216 batches | lr 0.00030 | ms/batch 76.86 | loss  5.52 | ppl   249.31 
| epoch   5 |   200/  216 batches | lr 0.00030 | ms/batch 76.31 | loss  5.39 | ppl   220.04 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 17.04s | valid loss  5.33 | valid ppl   205.61 | valid bpc    7.684
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  216 batches | lr 0.00030 | ms/batch 76.98 | loss  5.31 | ppl   202.44 
| epoch   6 |   200/  216 batches | lr 0.00030 | ms/batch 76.34 | loss  5.23 | ppl   186.74 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 17.05s | valid loss  5.19 | valid ppl   179.34 | valid bpc    7.487
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  216 batches | lr 0.00030 | ms/batch 77.30 | loss  5.14 | ppl   171.28 
| epoch   7 |   200/  216 batches | lr 0.00030 | ms/batch 75.99 | loss  5.07 | ppl   159.12 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 17.07s | valid loss  5.06 | valid ppl   158.22 | valid bpc    7.306
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  216 batches | lr 0.00030 | ms/batch 77.71 | loss  5.01 | ppl   149.88 
| epoch   8 |   200/  216 batches | lr 0.00030 | ms/batch 75.97 | loss  4.92 | ppl   137.35 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 17.06s | valid loss  4.96 | valid ppl   142.26 | valid bpc    7.152
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 8.0%
| epoch   9 |   100/  216 batches | lr 0.00030 | ms/batch 77.60 | loss  4.87 | ppl   130.75 
| epoch   9 |   200/  216 batches | lr 0.00030 | ms/batch 76.10 | loss  4.83 | ppl   124.87 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 17.07s | valid loss  4.87 | valid ppl   130.10 | valid bpc    7.023
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  216 batches | lr 0.00030 | ms/batch 77.20 | loss  4.79 | ppl   120.54 
| epoch  10 |   200/  216 batches | lr 0.00030 | ms/batch 76.52 | loss  4.70 | ppl   110.04 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 17.07s | valid loss  4.82 | valid ppl   124.57 | valid bpc    6.961
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  216 batches | lr 0.00030 | ms/batch 77.18 | loss  4.67 | ppl   106.72 
| epoch  11 |   200/  216 batches | lr 0.00030 | ms/batch 76.47 | loss  4.62 | ppl   101.59 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 17.06s | valid loss  4.72 | valid ppl   111.85 | valid bpc    6.805
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  216 batches | lr 0.00030 | ms/batch 77.65 | loss  4.56 | ppl    96.04 
| epoch  12 |   200/  216 batches | lr 0.00030 | ms/batch 76.01 | loss  4.53 | ppl    92.56 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 17.06s | valid loss  4.65 | valid ppl   104.86 | valid bpc    6.712
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 12.0%
| epoch  13 |   100/  216 batches | lr 0.00030 | ms/batch 77.00 | loss  4.47 | ppl    87.32 
| epoch  13 |   200/  216 batches | lr 0.00030 | ms/batch 76.66 | loss  4.47 | ppl    87.36 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 17.06s | valid loss  4.62 | valid ppl   101.46 | valid bpc    6.665
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 13.0%
| epoch  14 |   100/  216 batches | lr 0.00030 | ms/batch 77.24 | loss  4.42 | ppl    83.01 
| epoch  14 |   200/  216 batches | lr 0.00030 | ms/batch 76.48 | loss  4.36 | ppl    78.45 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 17.06s | valid loss  4.50 | valid ppl    90.38 | valid bpc    6.498
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  216 batches | lr 0.00030 | ms/batch 77.56 | loss  4.33 | ppl    75.98 
| epoch  15 |   200/  216 batches | lr 0.00030 | ms/batch 76.05 | loss  4.27 | ppl    71.19 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 17.06s | valid loss  4.52 | valid ppl    92.07 | valid bpc    6.525
-----------------------------------------------------------------------------------------
PROGRESS: 15.0%
| epoch  16 |   100/  216 batches | lr 0.00030 | ms/batch 77.14 | loss  4.27 | ppl    71.27 
| epoch  16 |   200/  216 batches | lr 0.00030 | ms/batch 76.29 | loss  4.21 | ppl    67.32 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 17.07s | valid loss  4.50 | valid ppl    89.83 | valid bpc    6.489
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 16.0%
| epoch  17 |   100/  216 batches | lr 0.00030 | ms/batch 76.88 | loss  4.16 | ppl    64.05 
| epoch  17 |   200/  216 batches | lr 0.00030 | ms/batch 76.79 | loss  4.15 | ppl    63.40 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 17.06s | valid loss  4.45 | valid ppl    85.45 | valid bpc    6.417
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 17.0%
| epoch  18 |   100/  216 batches | lr 0.00030 | ms/batch 77.45 | loss  4.11 | ppl    60.89 
| epoch  18 |   200/  216 batches | lr 0.00030 | ms/batch 76.09 | loss  4.08 | ppl    59.09 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 17.06s | valid loss  4.44 | valid ppl    84.77 | valid bpc    6.405
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 18.0%
| epoch  19 |   100/  216 batches | lr 0.00030 | ms/batch 77.44 | loss  4.07 | ppl    58.47 
| epoch  19 |   200/  216 batches | lr 0.00030 | ms/batch 75.99 | loss  4.00 | ppl    54.34 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 17.07s | valid loss  4.40 | valid ppl    81.09 | valid bpc    6.342
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 19.0%
| epoch  20 |   100/  216 batches | lr 0.00030 | ms/batch 77.42 | loss  3.99 | ppl    54.28 
| epoch  20 |   200/  216 batches | lr 0.00030 | ms/batch 76.43 | loss  3.96 | ppl    52.62 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 17.07s | valid loss  4.38 | valid ppl    79.85 | valid bpc    6.319
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 20.0%
| epoch  21 |   100/  216 batches | lr 0.00030 | ms/batch 77.47 | loss  3.94 | ppl    51.50 
| epoch  21 |   200/  216 batches | lr 0.00030 | ms/batch 76.26 | loss  3.91 | ppl    50.06 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 17.06s | valid loss  4.38 | valid ppl    79.49 | valid bpc    6.313
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 21.0%
| epoch  22 |   100/  216 batches | lr 0.00030 | ms/batch 77.67 | loss  3.88 | ppl    48.23 
| epoch  22 |   200/  216 batches | lr 0.00030 | ms/batch 75.77 | loss  3.86 | ppl    47.40 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 17.06s | valid loss  4.36 | valid ppl    78.24 | valid bpc    6.290
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 22.0%
| epoch  23 |   100/  216 batches | lr 0.00030 | ms/batch 77.76 | loss  3.81 | ppl    45.05 
| epoch  23 |   200/  216 batches | lr 0.00030 | ms/batch 76.08 | loss  3.83 | ppl    46.11 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 17.09s | valid loss  4.33 | valid ppl    75.96 | valid bpc    6.247
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 23.0%
| epoch  24 |   100/  216 batches | lr 0.00030 | ms/batch 77.42 | loss  3.77 | ppl    43.47 
| epoch  24 |   200/  216 batches | lr 0.00030 | ms/batch 76.31 | loss  3.77 | ppl    43.56 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 17.06s | valid loss  4.34 | valid ppl    76.52 | valid bpc    6.258
-----------------------------------------------------------------------------------------
PROGRESS: 24.0%
| epoch  25 |   100/  216 batches | lr 0.00030 | ms/batch 77.79 | loss  3.73 | ppl    41.55 
| epoch  25 |   200/  216 batches | lr 0.00030 | ms/batch 76.04 | loss  3.72 | ppl    41.31 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 17.08s | valid loss  4.34 | valid ppl    76.51 | valid bpc    6.257
-----------------------------------------------------------------------------------------
PROGRESS: 25.0%
| epoch  26 |   100/  216 batches | lr 0.00030 | ms/batch 77.64 | loss  3.68 | ppl    39.59 
| epoch  26 |   200/  216 batches | lr 0.00030 | ms/batch 76.13 | loss  3.68 | ppl    39.46 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 17.06s | valid loss  4.28 | valid ppl    72.39 | valid bpc    6.178
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 26.0%
| epoch  27 |   100/  216 batches | lr 0.00030 | ms/batch 77.46 | loss  3.63 | ppl    37.88 
| epoch  27 |   200/  216 batches | lr 0.00030 | ms/batch 76.12 | loss  3.61 | ppl    37.03 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 17.07s | valid loss  4.29 | valid ppl    72.74 | valid bpc    6.185
-----------------------------------------------------------------------------------------
PROGRESS: 27.0%
| epoch  28 |   100/  216 batches | lr 0.00030 | ms/batch 77.38 | loss  3.61 | ppl    36.97 
| epoch  28 |   200/  216 batches | lr 0.00030 | ms/batch 76.41 | loss  3.58 | ppl    35.91 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 17.08s | valid loss  4.28 | valid ppl    71.92 | valid bpc    6.168
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  216 batches | lr 0.00030 | ms/batch 77.89 | loss  3.54 | ppl    34.44 
| epoch  29 |   200/  216 batches | lr 0.00030 | ms/batch 75.92 | loss  3.53 | ppl    34.10 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 17.07s | valid loss  4.26 | valid ppl    70.79 | valid bpc    6.145
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  216 batches | lr 0.00030 | ms/batch 77.80 | loss  3.53 | ppl    34.20 
| epoch  30 |   200/  216 batches | lr 0.00030 | ms/batch 76.04 | loss  3.48 | ppl    32.44 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 17.07s | valid loss  4.28 | valid ppl    71.92 | valid bpc    6.168
-----------------------------------------------------------------------------------------
PROGRESS: 30.0%
| epoch  31 |   100/  216 batches | lr 0.00030 | ms/batch 77.35 | loss  3.46 | ppl    31.97 
| epoch  31 |   200/  216 batches | lr 0.00030 | ms/batch 76.51 | loss  3.47 | ppl    32.23 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 17.08s | valid loss  4.27 | valid ppl    71.42 | valid bpc    6.158
-----------------------------------------------------------------------------------------
PROGRESS: 31.0%
| epoch  32 |   100/  216 batches | lr 0.00030 | ms/batch 77.36 | loss  3.45 | ppl    31.48 
| epoch  32 |   200/  216 batches | lr 0.00030 | ms/batch 76.53 | loss  3.43 | ppl    30.99 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 17.08s | valid loss  4.25 | valid ppl    70.16 | valid bpc    6.132
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 32.0%
| epoch  33 |   100/  216 batches | lr 0.00030 | ms/batch 77.94 | loss  3.40 | ppl    29.96 
| epoch  33 |   200/  216 batches | lr 0.00030 | ms/batch 75.78 | loss  3.38 | ppl    29.45 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 17.07s | valid loss  4.25 | valid ppl    70.39 | valid bpc    6.137
-----------------------------------------------------------------------------------------
PROGRESS: 33.0%
| epoch  34 |   100/  216 batches | lr 0.00030 | ms/batch 77.62 | loss  3.34 | ppl    28.30 
| epoch  34 |   200/  216 batches | lr 0.00030 | ms/batch 76.00 | loss  3.35 | ppl    28.47 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 17.07s | valid loss  4.27 | valid ppl    71.39 | valid bpc    6.158
-----------------------------------------------------------------------------------------
PROGRESS: 34.0%
| epoch  35 |   100/  216 batches | lr 0.00030 | ms/batch 77.18 | loss  3.32 | ppl    27.62 
| epoch  35 |   200/  216 batches | lr 0.00030 | ms/batch 76.44 | loss  3.33 | ppl    27.84 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 17.07s | valid loss  4.20 | valid ppl    66.92 | valid bpc    6.064
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 35.0%
| epoch  36 |   100/  216 batches | lr 0.00030 | ms/batch 77.52 | loss  3.26 | ppl    26.03 
| epoch  36 |   200/  216 batches | lr 0.00030 | ms/batch 76.23 | loss  3.27 | ppl    26.19 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 17.08s | valid loss  4.22 | valid ppl    68.24 | valid bpc    6.092
-----------------------------------------------------------------------------------------
PROGRESS: 36.0%
| epoch  37 |   100/  216 batches | lr 0.00030 | ms/batch 77.49 | loss  3.24 | ppl    25.59 
| epoch  37 |   200/  216 batches | lr 0.00030 | ms/batch 76.30 | loss  3.23 | ppl    25.24 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 17.07s | valid loss  4.25 | valid ppl    69.78 | valid bpc    6.125
-----------------------------------------------------------------------------------------
PROGRESS: 37.0%
| epoch  38 |   100/  216 batches | lr 0.00030 | ms/batch 77.85 | loss  3.20 | ppl    24.64 
| epoch  38 |   200/  216 batches | lr 0.00030 | ms/batch 76.02 | loss  3.22 | ppl    24.94 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 17.08s | valid loss  4.29 | valid ppl    72.73 | valid bpc    6.185
-----------------------------------------------------------------------------------------
PROGRESS: 38.0%
| epoch  39 |   100/  216 batches | lr 0.00015 | ms/batch 77.69 | loss  3.11 | ppl    22.50 
| epoch  39 |   200/  216 batches | lr 0.00015 | ms/batch 76.24 | loss  3.09 | ppl    21.97 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 17.08s | valid loss  4.20 | valid ppl    66.67 | valid bpc    6.059
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 39.0%
| epoch  40 |   100/  216 batches | lr 0.00015 | ms/batch 77.53 | loss  3.05 | ppl    21.17 
| epoch  40 |   200/  216 batches | lr 0.00015 | ms/batch 76.47 | loss  3.07 | ppl    21.56 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 17.08s | valid loss  4.26 | valid ppl    70.59 | valid bpc    6.141
-----------------------------------------------------------------------------------------
PROGRESS: 40.0%
| epoch  41 |   100/  216 batches | lr 0.00015 | ms/batch 77.50 | loss  3.03 | ppl    20.63 
| epoch  41 |   200/  216 batches | lr 0.00015 | ms/batch 76.32 | loss  2.98 | ppl    19.72 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 17.08s | valid loss  4.24 | valid ppl    69.49 | valid bpc    6.119
-----------------------------------------------------------------------------------------
PROGRESS: 41.0%
| epoch  42 |   100/  216 batches | lr 0.00015 | ms/batch 77.37 | loss  2.98 | ppl    19.68 
| epoch  42 |   200/  216 batches | lr 0.00015 | ms/batch 76.34 | loss  2.99 | ppl    19.93 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 17.07s | valid loss  4.23 | valid ppl    68.72 | valid bpc    6.103
-----------------------------------------------------------------------------------------
PROGRESS: 42.0%
| epoch  43 |   100/  216 batches | lr 0.00007 | ms/batch 77.67 | loss  2.94 | ppl    18.87 
| epoch  43 |   200/  216 batches | lr 0.00007 | ms/batch 76.03 | loss  2.91 | ppl    18.44 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 17.07s | valid loss  4.19 | valid ppl    66.03 | valid bpc    6.045
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 43.0%
| epoch  44 |   100/  216 batches | lr 0.00007 | ms/batch 77.74 | loss  2.89 | ppl    18.08 
| epoch  44 |   200/  216 batches | lr 0.00007 | ms/batch 75.95 | loss  2.88 | ppl    17.73 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 17.07s | valid loss  4.22 | valid ppl    68.23 | valid bpc    6.092
-----------------------------------------------------------------------------------------
PROGRESS: 44.0%
| epoch  45 |   100/  216 batches | lr 0.00007 | ms/batch 77.21 | loss  2.88 | ppl    17.73 
| epoch  45 |   200/  216 batches | lr 0.00007 | ms/batch 76.58 | loss  2.87 | ppl    17.65 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 17.08s | valid loss  4.22 | valid ppl    67.90 | valid bpc    6.085
-----------------------------------------------------------------------------------------
PROGRESS: 45.0%
| epoch  46 |   100/  216 batches | lr 0.00007 | ms/batch 77.54 | loss  2.86 | ppl    17.50 
| epoch  46 |   200/  216 batches | lr 0.00007 | ms/batch 76.24 | loss  2.85 | ppl    17.20 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 17.08s | valid loss  4.21 | valid ppl    67.53 | valid bpc    6.077
-----------------------------------------------------------------------------------------
PROGRESS: 46.0%
| epoch  47 |   100/  216 batches | lr 0.00004 | ms/batch 77.14 | loss  2.85 | ppl    17.21 
| epoch  47 |   200/  216 batches | lr 0.00004 | ms/batch 76.23 | loss  2.79 | ppl    16.24 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 17.08s | valid loss  4.22 | valid ppl    67.97 | valid bpc    6.087
-----------------------------------------------------------------------------------------
PROGRESS: 47.0%
| epoch  48 |   100/  216 batches | lr 0.00004 | ms/batch 77.63 | loss  2.83 | ppl    16.98 
| epoch  48 |   200/  216 batches | lr 0.00004 | ms/batch 75.98 | loss  2.81 | ppl    16.60 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 17.07s | valid loss  4.17 | valid ppl    65.02 | valid bpc    6.023
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 48.0%
| epoch  49 |   100/  216 batches | lr 0.00004 | ms/batch 77.79 | loss  2.79 | ppl    16.33 
| epoch  49 |   200/  216 batches | lr 0.00004 | ms/batch 75.95 | loss  2.80 | ppl    16.43 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 17.07s | valid loss  4.23 | valid ppl    68.53 | valid bpc    6.099
-----------------------------------------------------------------------------------------
PROGRESS: 49.0%
| epoch  50 |   100/  216 batches | lr 0.00004 | ms/batch 77.66 | loss  2.81 | ppl    16.55 
| epoch  50 |   200/  216 batches | lr 0.00004 | ms/batch 76.13 | loss  2.78 | ppl    16.10 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 17.08s | valid loss  4.25 | valid ppl    69.99 | valid bpc    6.129
-----------------------------------------------------------------------------------------
PROGRESS: 50.0%
| epoch  51 |   100/  216 batches | lr 0.00004 | ms/batch 77.63 | loss  2.78 | ppl    16.18 
| epoch  51 |   200/  216 batches | lr 0.00004 | ms/batch 76.21 | loss  2.75 | ppl    15.71 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 17.08s | valid loss  4.25 | valid ppl    69.90 | valid bpc    6.127
-----------------------------------------------------------------------------------------
PROGRESS: 51.0%
| epoch  52 |   100/  216 batches | lr 0.00002 | ms/batch 77.48 | loss  2.77 | ppl    15.98 
| epoch  52 |   200/  216 batches | lr 0.00002 | ms/batch 76.46 | loss  2.78 | ppl    16.06 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 17.09s | valid loss  4.23 | valid ppl    68.39 | valid bpc    6.096
-----------------------------------------------------------------------------------------
PROGRESS: 52.0%
| epoch  53 |   100/  216 batches | lr 0.00002 | ms/batch 77.66 | loss  2.77 | ppl    15.95 
| epoch  53 |   200/  216 batches | lr 0.00002 | ms/batch 76.17 | loss  2.75 | ppl    15.63 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 17.08s | valid loss  4.22 | valid ppl    68.24 | valid bpc    6.093
-----------------------------------------------------------------------------------------
PROGRESS: 53.0%
| epoch  54 |   100/  216 batches | lr 0.00002 | ms/batch 77.46 | loss  2.75 | ppl    15.65 
| epoch  54 |   200/  216 batches | lr 0.00002 | ms/batch 76.46 | loss  2.74 | ppl    15.48 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 17.08s | valid loss  4.23 | valid ppl    68.55 | valid bpc    6.099
-----------------------------------------------------------------------------------------
PROGRESS: 54.0%
| epoch  55 |   100/  216 batches | lr 0.00001 | ms/batch 77.46 | loss  2.76 | ppl    15.85 
| epoch  55 |   200/  216 batches | lr 0.00001 | ms/batch 76.31 | loss  2.75 | ppl    15.69 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 17.08s | valid loss  4.23 | valid ppl    68.91 | valid bpc    6.107
-----------------------------------------------------------------------------------------
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  216 batches | lr 0.00001 | ms/batch 77.61 | loss  2.74 | ppl    15.46 
| epoch  56 |   200/  216 batches | lr 0.00001 | ms/batch 76.11 | loss  2.74 | ppl    15.55 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 17.07s | valid loss  4.24 | valid ppl    69.73 | valid bpc    6.124
-----------------------------------------------------------------------------------------
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  216 batches | lr 0.00001 | ms/batch 77.48 | loss  2.75 | ppl    15.71 
| epoch  57 |   200/  216 batches | lr 0.00001 | ms/batch 76.31 | loss  2.73 | ppl    15.30 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 17.08s | valid loss  4.20 | valid ppl    66.86 | valid bpc    6.063
-----------------------------------------------------------------------------------------
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  216 batches | lr 0.00000 | ms/batch 77.30 | loss  2.75 | ppl    15.63 
| epoch  58 |   200/  216 batches | lr 0.00000 | ms/batch 76.51 | loss  2.72 | ppl    15.20 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 17.08s | valid loss  4.22 | valid ppl    68.03 | valid bpc    6.088
-----------------------------------------------------------------------------------------
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  216 batches | lr 0.00000 | ms/batch 77.53 | loss  2.75 | ppl    15.56 
| epoch  59 |   200/  216 batches | lr 0.00000 | ms/batch 76.34 | loss  2.69 | ppl    14.71 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 17.09s | valid loss  4.20 | valid ppl    66.90 | valid bpc    6.064
-----------------------------------------------------------------------------------------
PROGRESS: 59.0%
| epoch  60 |   100/  216 batches | lr 0.00000 | ms/batch 77.41 | loss  2.73 | ppl    15.34 
| epoch  60 |   200/  216 batches | lr 0.00000 | ms/batch 76.39 | loss  2.73 | ppl    15.31 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 17.08s | valid loss  4.19 | valid ppl    65.91 | valid bpc    6.042
-----------------------------------------------------------------------------------------
PROGRESS: 60.0%
| epoch  61 |   100/  216 batches | lr 0.00000 | ms/batch 77.62 | loss  2.72 | ppl    15.25 
| epoch  61 |   200/  216 batches | lr 0.00000 | ms/batch 76.29 | loss  2.73 | ppl    15.40 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 17.08s | valid loss  4.23 | valid ppl    68.60 | valid bpc    6.100
-----------------------------------------------------------------------------------------
PROGRESS: 61.0%
| epoch  62 |   100/  216 batches | lr 0.00000 | ms/batch 77.26 | loss  2.76 | ppl    15.83 
| epoch  62 |   200/  216 batches | lr 0.00000 | ms/batch 76.59 | loss  2.70 | ppl    14.91 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 17.07s | valid loss  4.20 | valid ppl    66.40 | valid bpc    6.053
-----------------------------------------------------------------------------------------
PROGRESS: 62.0%
| epoch  63 |   100/  216 batches | lr 0.00000 | ms/batch 77.49 | loss  2.74 | ppl    15.48 
| epoch  63 |   200/  216 batches | lr 0.00000 | ms/batch 76.04 | loss  2.74 | ppl    15.51 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 17.08s | valid loss  4.22 | valid ppl    68.19 | valid bpc    6.092
-----------------------------------------------------------------------------------------
PROGRESS: 63.0%
| epoch  64 |   100/  216 batches | lr 0.00000 | ms/batch 77.42 | loss  2.73 | ppl    15.29 
| epoch  64 |   200/  216 batches | lr 0.00000 | ms/batch 76.37 | loss  2.70 | ppl    14.92 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 17.08s | valid loss  4.19 | valid ppl    66.14 | valid bpc    6.047
-----------------------------------------------------------------------------------------
PROGRESS: 64.0%
| epoch  65 |   100/  216 batches | lr 0.00000 | ms/batch 77.85 | loss  2.74 | ppl    15.53 
| epoch  65 |   200/  216 batches | lr 0.00000 | ms/batch 76.12 | loss  2.71 | ppl    15.08 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 17.09s | valid loss  4.21 | valid ppl    67.49 | valid bpc    6.077
-----------------------------------------------------------------------------------------
PROGRESS: 65.0%
| epoch  66 |   100/  216 batches | lr 0.00000 | ms/batch 77.34 | loss  2.75 | ppl    15.72 
| epoch  66 |   200/  216 batches | lr 0.00000 | ms/batch 76.45 | loss  2.72 | ppl    15.21 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 17.08s | valid loss  4.24 | valid ppl    69.08 | valid bpc    6.110
-----------------------------------------------------------------------------------------
PROGRESS: 66.0%
| epoch  67 |   100/  216 batches | lr 0.00000 | ms/batch 77.56 | loss  2.74 | ppl    15.50 
| epoch  67 |   200/  216 batches | lr 0.00000 | ms/batch 76.35 | loss  2.71 | ppl    14.96 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 17.08s | valid loss  4.20 | valid ppl    66.57 | valid bpc    6.057
-----------------------------------------------------------------------------------------
PROGRESS: 67.0%
| epoch  68 |   100/  216 batches | lr 0.00000 | ms/batch 77.38 | loss  2.74 | ppl    15.51 
| epoch  68 |   200/  216 batches | lr 0.00000 | ms/batch 76.42 | loss  2.73 | ppl    15.26 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 17.08s | valid loss  4.18 | valid ppl    65.50 | valid bpc    6.033
-----------------------------------------------------------------------------------------
PROGRESS: 68.0%
| epoch  69 |   100/  216 batches | lr 0.00000 | ms/batch 77.43 | loss  2.75 | ppl    15.57 
| epoch  69 |   200/  216 batches | lr 0.00000 | ms/batch 76.52 | loss  2.70 | ppl    14.89 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 17.08s | valid loss  4.23 | valid ppl    68.89 | valid bpc    6.106
-----------------------------------------------------------------------------------------
PROGRESS: 69.0%
| epoch  70 |   100/  216 batches | lr 0.00000 | ms/batch 77.25 | loss  2.74 | ppl    15.55 
| epoch  70 |   200/  216 batches | lr 0.00000 | ms/batch 76.54 | loss  2.69 | ppl    14.73 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 17.07s | valid loss  4.18 | valid ppl    65.32 | valid bpc    6.029
-----------------------------------------------------------------------------------------
PROGRESS: 70.0%
| epoch  71 |   100/  216 batches | lr 0.00000 | ms/batch 77.87 | loss  2.74 | ppl    15.48 
| epoch  71 |   200/  216 batches | lr 0.00000 | ms/batch 75.92 | loss  2.73 | ppl    15.26 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 17.07s | valid loss  4.19 | valid ppl    66.12 | valid bpc    6.047
-----------------------------------------------------------------------------------------
PROGRESS: 71.0%
| epoch  72 |   100/  216 batches | lr 0.00000 | ms/batch 77.34 | loss  2.75 | ppl    15.67 
| epoch  72 |   200/  216 batches | lr 0.00000 | ms/batch 76.40 | loss  2.71 | ppl    15.01 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 17.08s | valid loss  4.21 | valid ppl    67.29 | valid bpc    6.072
-----------------------------------------------------------------------------------------
PROGRESS: 72.0%
| epoch  73 |   100/  216 batches | lr 0.00000 | ms/batch 77.42 | loss  2.73 | ppl    15.37 
| epoch  73 |   200/  216 batches | lr 0.00000 | ms/batch 76.52 | loss  2.71 | ppl    15.09 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 17.10s | valid loss  4.19 | valid ppl    66.03 | valid bpc    6.045
-----------------------------------------------------------------------------------------
PROGRESS: 73.0%
| epoch  74 |   100/  216 batches | lr 0.00000 | ms/batch 77.42 | loss  2.74 | ppl    15.47 
| epoch  74 |   200/  216 batches | lr 0.00000 | ms/batch 76.39 | loss  2.72 | ppl    15.14 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 17.08s | valid loss  4.21 | valid ppl    67.47 | valid bpc    6.076
-----------------------------------------------------------------------------------------
PROGRESS: 74.0%
| epoch  75 |   100/  216 batches | lr 0.00000 | ms/batch 77.66 | loss  2.74 | ppl    15.42 
| epoch  75 |   200/  216 batches | lr 0.00000 | ms/batch 76.01 | loss  2.72 | ppl    15.20 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 17.08s | valid loss  4.22 | valid ppl    67.88 | valid bpc    6.085
-----------------------------------------------------------------------------------------
PROGRESS: 75.0%
| epoch  76 |   100/  216 batches | lr 0.00000 | ms/batch 77.41 | loss  2.75 | ppl    15.62 
| epoch  76 |   200/  216 batches | lr 0.00000 | ms/batch 76.41 | loss  2.70 | ppl    14.84 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 17.07s | valid loss  4.20 | valid ppl    66.82 | valid bpc    6.062
-----------------------------------------------------------------------------------------
PROGRESS: 76.0%
| epoch  77 |   100/  216 batches | lr 0.00000 | ms/batch 77.56 | loss  2.75 | ppl    15.69 
| epoch  77 |   200/  216 batches | lr 0.00000 | ms/batch 76.31 | loss  2.70 | ppl    14.83 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 17.08s | valid loss  4.23 | valid ppl    68.97 | valid bpc    6.108
-----------------------------------------------------------------------------------------
PROGRESS: 77.0%
| epoch  78 |   100/  216 batches | lr 0.00000 | ms/batch 77.17 | loss  2.73 | ppl    15.28 
| epoch  78 |   200/  216 batches | lr 0.00000 | ms/batch 76.33 | loss  2.71 | ppl    15.00 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 17.09s | valid loss  4.20 | valid ppl    66.75 | valid bpc    6.061
-----------------------------------------------------------------------------------------
PROGRESS: 78.0%
| epoch  79 |   100/  216 batches | lr 0.00000 | ms/batch 77.43 | loss  2.74 | ppl    15.41 
| epoch  79 |   200/  216 batches | lr 0.00000 | ms/batch 76.57 | loss  2.70 | ppl    14.90 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 17.09s | valid loss  4.23 | valid ppl    68.59 | valid bpc    6.100
-----------------------------------------------------------------------------------------
PROGRESS: 79.0%
| epoch  80 |   100/  216 batches | lr 0.00000 | ms/batch 77.31 | loss  2.74 | ppl    15.46 
| epoch  80 |   200/  216 batches | lr 0.00000 | ms/batch 76.30 | loss  2.72 | ppl    15.16 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 17.08s | valid loss  4.16 | valid ppl    64.24 | valid bpc    6.005
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 80.0%
| epoch  81 |   100/  216 batches | lr 0.00000 | ms/batch 77.75 | loss  2.74 | ppl    15.54 
| epoch  81 |   200/  216 batches | lr 0.00000 | ms/batch 76.15 | loss  2.69 | ppl    14.76 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 17.07s | valid loss  4.15 | valid ppl    63.68 | valid bpc    5.993
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 81.0%
| epoch  82 |   100/  216 batches | lr 0.00000 | ms/batch 77.61 | loss  2.74 | ppl    15.50 
| epoch  82 |   200/  216 batches | lr 0.00000 | ms/batch 76.13 | loss  2.70 | ppl    14.94 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 17.07s | valid loss  4.24 | valid ppl    69.23 | valid bpc    6.113
-----------------------------------------------------------------------------------------
PROGRESS: 82.0%
| epoch  83 |   100/  216 batches | lr 0.00000 | ms/batch 76.95 | loss  2.76 | ppl    15.76 
| epoch  83 |   200/  216 batches | lr 0.00000 | ms/batch 76.93 | loss  2.69 | ppl    14.76 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 17.08s | valid loss  4.24 | valid ppl    69.16 | valid bpc    6.112
-----------------------------------------------------------------------------------------
PROGRESS: 83.0%
| epoch  84 |   100/  216 batches | lr 0.00000 | ms/batch 77.41 | loss  2.74 | ppl    15.46 
| epoch  84 |   200/  216 batches | lr 0.00000 | ms/batch 76.40 | loss  2.70 | ppl    14.93 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 17.08s | valid loss  4.21 | valid ppl    67.05 | valid bpc    6.067
-----------------------------------------------------------------------------------------
PROGRESS: 84.0%
| epoch  85 |   100/  216 batches | lr 0.00000 | ms/batch 77.27 | loss  2.72 | ppl    15.22 
| epoch  85 |   200/  216 batches | lr 0.00000 | ms/batch 76.51 | loss  2.72 | ppl    15.25 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 17.08s | valid loss  4.19 | valid ppl    66.00 | valid bpc    6.044
-----------------------------------------------------------------------------------------
PROGRESS: 85.0%
| epoch  86 |   100/  216 batches | lr 0.00000 | ms/batch 77.14 | loss  2.76 | ppl    15.84 
| epoch  86 |   200/  216 batches | lr 0.00000 | ms/batch 76.57 | loss  2.73 | ppl    15.37 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 17.07s | valid loss  4.24 | valid ppl    69.20 | valid bpc    6.113
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  216 batches | lr 0.00000 | ms/batch 77.31 | loss  2.75 | ppl    15.69 
| epoch  87 |   200/  216 batches | lr 0.00000 | ms/batch 76.08 | loss  2.70 | ppl    14.88 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 17.07s | valid loss  4.24 | valid ppl    69.49 | valid bpc    6.119
-----------------------------------------------------------------------------------------
PROGRESS: 87.0%
| epoch  88 |   100/  216 batches | lr 0.00000 | ms/batch 77.07 | loss  2.73 | ppl    15.38 
| epoch  88 |   200/  216 batches | lr 0.00000 | ms/batch 76.59 | loss  2.71 | ppl    15.03 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 17.06s | valid loss  4.23 | valid ppl    68.46 | valid bpc    6.097
-----------------------------------------------------------------------------------------
PROGRESS: 88.0%
| epoch  89 |   100/  216 batches | lr 0.00000 | ms/batch 77.14 | loss  2.74 | ppl    15.53 
| epoch  89 |   200/  216 batches | lr 0.00000 | ms/batch 76.64 | loss  2.72 | ppl    15.17 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 17.07s | valid loss  4.21 | valid ppl    67.40 | valid bpc    6.075
-----------------------------------------------------------------------------------------
PROGRESS: 89.0%
| epoch  90 |   100/  216 batches | lr 0.00000 | ms/batch 77.32 | loss  2.71 | ppl    15.10 
| epoch  90 |   200/  216 batches | lr 0.00000 | ms/batch 76.47 | loss  2.72 | ppl    15.15 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 17.07s | valid loss  4.20 | valid ppl    66.42 | valid bpc    6.054
-----------------------------------------------------------------------------------------
PROGRESS: 90.0%
| epoch  91 |   100/  216 batches | lr 0.00000 | ms/batch 77.41 | loss  2.76 | ppl    15.78 
| epoch  91 |   200/  216 batches | lr 0.00000 | ms/batch 76.22 | loss  2.70 | ppl    14.90 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 17.07s | valid loss  4.21 | valid ppl    67.62 | valid bpc    6.079
-----------------------------------------------------------------------------------------
PROGRESS: 91.0%
| epoch  92 |   100/  216 batches | lr 0.00000 | ms/batch 77.64 | loss  2.73 | ppl    15.36 
| epoch  92 |   200/  216 batches | lr 0.00000 | ms/batch 76.20 | loss  2.70 | ppl    14.88 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 17.07s | valid loss  4.22 | valid ppl    67.84 | valid bpc    6.084
-----------------------------------------------------------------------------------------
PROGRESS: 92.0%
| epoch  93 |   100/  216 batches | lr 0.00000 | ms/batch 77.71 | loss  2.76 | ppl    15.77 
| epoch  93 |   200/  216 batches | lr 0.00000 | ms/batch 76.09 | loss  2.71 | ppl    14.98 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 17.07s | valid loss  4.16 | valid ppl    63.80 | valid bpc    5.996
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  216 batches | lr 0.00000 | ms/batch 77.73 | loss  2.74 | ppl    15.54 
| epoch  94 |   200/  216 batches | lr 0.00000 | ms/batch 76.06 | loss  2.68 | ppl    14.65 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 17.07s | valid loss  4.20 | valid ppl    66.39 | valid bpc    6.053
-----------------------------------------------------------------------------------------
PROGRESS: 94.0%
| epoch  95 |   100/  216 batches | lr 0.00000 | ms/batch 77.25 | loss  2.73 | ppl    15.38 
| epoch  95 |   200/  216 batches | lr 0.00000 | ms/batch 76.57 | loss  2.73 | ppl    15.27 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 17.07s | valid loss  4.17 | valid ppl    64.81 | valid bpc    6.018
-----------------------------------------------------------------------------------------
PROGRESS: 95.0%
| epoch  96 |   100/  216 batches | lr 0.00000 | ms/batch 77.23 | loss  2.74 | ppl    15.46 
| epoch  96 |   200/  216 batches | lr 0.00000 | ms/batch 76.27 | loss  2.70 | ppl    14.87 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 17.08s | valid loss  4.20 | valid ppl    66.82 | valid bpc    6.062
-----------------------------------------------------------------------------------------
PROGRESS: 96.0%
| epoch  97 |   100/  216 batches | lr 0.00000 | ms/batch 77.09 | loss  2.72 | ppl    15.19 
| epoch  97 |   200/  216 batches | lr 0.00000 | ms/batch 76.33 | loss  2.71 | ppl    15.00 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 17.08s | valid loss  4.19 | valid ppl    65.98 | valid bpc    6.044
-----------------------------------------------------------------------------------------
PROGRESS: 97.0%
| epoch  98 |   100/  216 batches | lr 0.00000 | ms/batch 77.61 | loss  2.73 | ppl    15.34 
| epoch  98 |   200/  216 batches | lr 0.00000 | ms/batch 76.21 | loss  2.71 | ppl    15.03 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 17.07s | valid loss  4.22 | valid ppl    67.78 | valid bpc    6.083
-----------------------------------------------------------------------------------------
PROGRESS: 98.0%
| epoch  99 |   100/  216 batches | lr 0.00000 | ms/batch 77.71 | loss  2.73 | ppl    15.40 
| epoch  99 |   200/  216 batches | lr 0.00000 | ms/batch 76.13 | loss  2.70 | ppl    14.85 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 17.08s | valid loss  4.25 | valid ppl    69.91 | valid bpc    6.127
-----------------------------------------------------------------------------------------
PROGRESS: 99.0%
| epoch 100 |   100/  216 batches | lr 0.00000 | ms/batch 77.41 | loss  2.74 | ppl    15.42 
| epoch 100 |   200/  216 batches | lr 0.00000 | ms/batch 76.34 | loss  2.71 | ppl    15.05 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 17.08s | valid loss  4.21 | valid ppl    67.58 | valid bpc    6.079
-----------------------------------------------------------------------------------------
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  4.15 | test ppl    63.74 | test bpc    5.994
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.3147, Mean Reca: 0.4343, Mean F1: 0.3575
Counter({'NP': 8615, 'S': 2788, 'PP': 2504, 'VP': 858, 'QP': 291, 'ADJP': 213, 'SINV': 147, 'SBAR': 139, 'ADVP': 109, 'FRAG': 34, 'NX': 23, 'WHNP': 21, 'PRN': 21, 'NAC': 17, 'SQ': 11, 'SBARQ': 8, 'UCP': 5, 'X': 4, 'WHPP': 1, 'CONJP': 1})
Counter({'NP': 14432, 'VP': 8130, 'S': 5620, 'PP': 5484, 'SBAR': 1796, 'ADJP': 649, 'QP': 490, 'ADVP': 286, 'SINV': 157, 'PRN': 128, 'NX': 95, 'FRAG': 42, 'WHNP': 37, 'UCP': 32, 'NAC': 30, 'WHPP': 25, 'CONJP': 21, 'SQ': 18, 'SBARQ': 10, 'WHADVP': 9, 'X': 6, 'WHADJP': 4, 'INTJ': 1})
SBAR: 0.0774
NP: 0.5969
VP: 0.1055
PP: 0.4566
ADJP: 0.3282
ADVP: 0.3811
6.290854451033538
-----------------------------------------------------------------------------------------
Dependency parsing performance:
Conll-U Style:
DDA: 0.436
UDA: 0.568
=========================================================================================
Loading dataset...
Loading dictionary...
Number of tokens:  10001
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer_in_parser', nhid=512, nlayers=8, front_layers=3, rear_layers=5, n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=2222, nonmono=5, cuda=True, log_interval=100, save='trained_models/structformer_in_parser_2222_35.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 38475621
Model architecture: StructFormer_In_Parser(
  (transformer_front): Transformer_Front(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(10001, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-2): 3 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
  (transformer_rear): Transformer_Rear(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(10001, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-4): 5 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (output_layer): Linear(in_features=512, out_features=10001, bias=True)
  )
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  216 batches | lr 0.00030 | ms/batch 80.32 | loss  7.36 | ppl  1565.54 
| epoch   1 |   200/  216 batches | lr 0.00030 | ms/batch 75.26 | loss  6.87 | ppl   958.52 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 17.24s | valid loss  6.67 | valid ppl   791.03 | valid bpc    9.628
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  216 batches | lr 0.00030 | ms/batch 76.48 | loss  6.79 | ppl   887.67 
| epoch   2 |   200/  216 batches | lr 0.00030 | ms/batch 76.26 | loss  6.58 | ppl   724.12 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 16.96s | valid loss  6.29 | valid ppl   541.24 | valid bpc    9.080
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  216 batches | lr 0.00030 | ms/batch 76.86 | loss  6.32 | ppl   555.46 
| epoch   3 |   200/  216 batches | lr 0.00030 | ms/batch 76.26 | loss  6.03 | ppl   415.19 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 17.00s | valid loss  5.81 | valid ppl   334.52 | valid bpc    8.386
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  216 batches | lr 0.00030 | ms/batch 77.05 | loss  5.83 | ppl   340.02 
| epoch   4 |   200/  216 batches | lr 0.00030 | ms/batch 76.32 | loss  5.64 | ppl   281.59 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 17.03s | valid loss  5.53 | valid ppl   250.91 | valid bpc    7.971
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  216 batches | lr 0.00030 | ms/batch 77.56 | loss  5.54 | ppl   255.37 
| epoch   5 |   200/  216 batches | lr 0.00030 | ms/batch 75.85 | loss  5.42 | ppl   225.12 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 17.05s | valid loss  5.35 | valid ppl   209.71 | valid bpc    7.712
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  216 batches | lr 0.00030 | ms/batch 77.53 | loss  5.34 | ppl   208.47 
| epoch   6 |   200/  216 batches | lr 0.00030 | ms/batch 75.97 | loss  5.20 | ppl   181.84 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 17.06s | valid loss  5.15 | valid ppl   171.81 | valid bpc    7.425
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  216 batches | lr 0.00030 | ms/batch 77.21 | loss  5.15 | ppl   172.25 
| epoch   7 |   200/  216 batches | lr 0.00030 | ms/batch 76.17 | loss  5.07 | ppl   159.61 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 17.07s | valid loss  5.04 | valid ppl   153.79 | valid bpc    7.265
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  216 batches | lr 0.00030 | ms/batch 77.68 | loss  5.02 | ppl   151.11 
| epoch   8 |   200/  216 batches | lr 0.00030 | ms/batch 75.96 | loss  4.94 | ppl   140.24 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 17.06s | valid loss  4.92 | valid ppl   137.36 | valid bpc    7.102
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 8.0%
| epoch   9 |   100/  216 batches | lr 0.00030 | ms/batch 77.22 | loss  4.90 | ppl   134.13 
| epoch   9 |   200/  216 batches | lr 0.00030 | ms/batch 76.43 | loss  4.82 | ppl   124.52 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 17.06s | valid loss  4.88 | valid ppl   130.99 | valid bpc    7.033
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  216 batches | lr 0.00030 | ms/batch 77.28 | loss  4.77 | ppl   118.18 
| epoch  10 |   200/  216 batches | lr 0.00030 | ms/batch 76.35 | loss  4.71 | ppl   110.92 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 17.07s | valid loss  4.81 | valid ppl   122.52 | valid bpc    6.937
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  216 batches | lr 0.00030 | ms/batch 77.59 | loss  4.66 | ppl   105.63 
| epoch  11 |   200/  216 batches | lr 0.00030 | ms/batch 76.06 | loss  4.63 | ppl   102.86 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 17.07s | valid loss  4.74 | valid ppl   114.23 | valid bpc    6.836
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  216 batches | lr 0.00030 | ms/batch 77.10 | loss  4.57 | ppl    96.10 
| epoch  12 |   200/  216 batches | lr 0.00030 | ms/batch 76.38 | loss  4.52 | ppl    91.51 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 17.08s | valid loss  4.67 | valid ppl   107.06 | valid bpc    6.742
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 12.0%
| epoch  13 |   100/  216 batches | lr 0.00030 | ms/batch 77.66 | loss  4.49 | ppl    88.89 
| epoch  13 |   200/  216 batches | lr 0.00030 | ms/batch 76.10 | loss  4.42 | ppl    83.22 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 17.08s | valid loss  4.65 | valid ppl   104.60 | valid bpc    6.709
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 13.0%
| epoch  14 |   100/  216 batches | lr 0.00030 | ms/batch 77.09 | loss  4.40 | ppl    81.76 
| epoch  14 |   200/  216 batches | lr 0.00030 | ms/batch 76.69 | loss  4.37 | ppl    79.27 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 17.08s | valid loss  4.58 | valid ppl    97.08 | valid bpc    6.601
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  216 batches | lr 0.00030 | ms/batch 77.58 | loss  4.33 | ppl    76.00 
| epoch  15 |   200/  216 batches | lr 0.00030 | ms/batch 76.10 | loss  4.28 | ppl    72.18 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 17.07s | valid loss  4.54 | valid ppl    93.24 | valid bpc    6.543
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 15.0%
| epoch  16 |   100/  216 batches | lr 0.00030 | ms/batch 77.89 | loss  4.26 | ppl    70.92 
| epoch  16 |   200/  216 batches | lr 0.00030 | ms/batch 76.00 | loss  4.21 | ppl    67.61 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 17.08s | valid loss  4.48 | valid ppl    88.64 | valid bpc    6.470
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 16.0%
| epoch  17 |   100/  216 batches | lr 0.00030 | ms/batch 77.37 | loss  4.19 | ppl    65.94 
| epoch  17 |   200/  216 batches | lr 0.00030 | ms/batch 76.26 | loss  4.19 | ppl    65.88 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 17.07s | valid loss  4.47 | valid ppl    87.21 | valid bpc    6.446
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 17.0%
| epoch  18 |   100/  216 batches | lr 0.00030 | ms/batch 77.32 | loss  4.15 | ppl    63.21 
| epoch  18 |   200/  216 batches | lr 0.00030 | ms/batch 76.32 | loss  4.10 | ppl    60.45 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 17.07s | valid loss  4.47 | valid ppl    87.19 | valid bpc    6.446
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 18.0%
| epoch  19 |   100/  216 batches | lr 0.00030 | ms/batch 77.53 | loss  4.09 | ppl    59.48 
| epoch  19 |   200/  216 batches | lr 0.00030 | ms/batch 76.21 | loss  4.05 | ppl    57.56 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 17.07s | valid loss  4.39 | valid ppl    80.95 | valid bpc    6.339
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 19.0%
| epoch  20 |   100/  216 batches | lr 0.00030 | ms/batch 77.26 | loss  4.00 | ppl    54.69 
| epoch  20 |   200/  216 batches | lr 0.00030 | ms/batch 76.55 | loss  4.00 | ppl    54.78 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 17.08s | valid loss  4.40 | valid ppl    81.08 | valid bpc    6.341
-----------------------------------------------------------------------------------------
PROGRESS: 20.0%
| epoch  21 |   100/  216 batches | lr 0.00030 | ms/batch 77.48 | loss  3.96 | ppl    52.66 
| epoch  21 |   200/  216 batches | lr 0.00030 | ms/batch 76.46 | loss  3.93 | ppl    50.72 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 17.09s | valid loss  4.35 | valid ppl    77.53 | valid bpc    6.277
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 21.0%
| epoch  22 |   100/  216 batches | lr 0.00030 | ms/batch 77.43 | loss  3.90 | ppl    49.44 
| epoch  22 |   200/  216 batches | lr 0.00030 | ms/batch 76.33 | loss  3.89 | ppl    49.00 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 17.08s | valid loss  4.34 | valid ppl    76.39 | valid bpc    6.255
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 22.0%
| epoch  23 |   100/  216 batches | lr 0.00030 | ms/batch 76.99 | loss  3.85 | ppl    46.86 
| epoch  23 |   200/  216 batches | lr 0.00030 | ms/batch 76.78 | loss  3.84 | ppl    46.53 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 17.07s | valid loss  4.32 | valid ppl    75.47 | valid bpc    6.238
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 23.0%
| epoch  24 |   100/  216 batches | lr 0.00030 | ms/batch 77.73 | loss  3.81 | ppl    45.04 
| epoch  24 |   200/  216 batches | lr 0.00030 | ms/batch 75.92 | loss  3.78 | ppl    43.95 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 17.07s | valid loss  4.34 | valid ppl    76.33 | valid bpc    6.254
-----------------------------------------------------------------------------------------
PROGRESS: 24.0%
| epoch  25 |   100/  216 batches | lr 0.00030 | ms/batch 77.17 | loss  3.75 | ppl    42.36 
| epoch  25 |   200/  216 batches | lr 0.00030 | ms/batch 76.56 | loss  3.76 | ppl    43.09 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 17.08s | valid loss  4.33 | valid ppl    76.22 | valid bpc    6.252
-----------------------------------------------------------------------------------------
PROGRESS: 25.0%
| epoch  26 |   100/  216 batches | lr 0.00030 | ms/batch 77.34 | loss  3.69 | ppl    40.16 
| epoch  26 |   200/  216 batches | lr 0.00030 | ms/batch 76.50 | loss  3.71 | ppl    40.71 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 17.08s | valid loss  4.29 | valid ppl    72.93 | valid bpc    6.188
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 26.0%
| epoch  27 |   100/  216 batches | lr 0.00030 | ms/batch 77.64 | loss  3.65 | ppl    38.54 
| epoch  27 |   200/  216 batches | lr 0.00030 | ms/batch 76.28 | loss  3.65 | ppl    38.46 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 17.08s | valid loss  4.28 | valid ppl    72.56 | valid bpc    6.181
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 27.0%
| epoch  28 |   100/  216 batches | lr 0.00030 | ms/batch 77.52 | loss  3.63 | ppl    37.55 
| epoch  28 |   200/  216 batches | lr 0.00030 | ms/batch 76.16 | loss  3.61 | ppl    36.86 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 17.08s | valid loss  4.30 | valid ppl    73.83 | valid bpc    6.206
-----------------------------------------------------------------------------------------
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  216 batches | lr 0.00030 | ms/batch 77.47 | loss  3.59 | ppl    36.08 
| epoch  29 |   200/  216 batches | lr 0.00030 | ms/batch 76.29 | loss  3.56 | ppl    35.32 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 17.08s | valid loss  4.26 | valid ppl    71.13 | valid bpc    6.152
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  216 batches | lr 0.00030 | ms/batch 77.72 | loss  3.54 | ppl    34.33 
| epoch  30 |   200/  216 batches | lr 0.00030 | ms/batch 76.15 | loss  3.52 | ppl    33.85 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 17.07s | valid loss  4.28 | valid ppl    72.12 | valid bpc    6.172
-----------------------------------------------------------------------------------------
PROGRESS: 30.0%
| epoch  31 |   100/  216 batches | lr 0.00030 | ms/batch 77.63 | loss  3.49 | ppl    32.70 
| epoch  31 |   200/  216 batches | lr 0.00030 | ms/batch 76.06 | loss  3.51 | ppl    33.29 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 17.08s | valid loss  4.24 | valid ppl    69.39 | valid bpc    6.117
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 31.0%
| epoch  32 |   100/  216 batches | lr 0.00030 | ms/batch 77.47 | loss  3.45 | ppl    31.43 
| epoch  32 |   200/  216 batches | lr 0.00030 | ms/batch 76.00 | loss  3.46 | ppl    31.68 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 17.07s | valid loss  4.25 | valid ppl    69.89 | valid bpc    6.127
-----------------------------------------------------------------------------------------
PROGRESS: 32.0%
| epoch  33 |   100/  216 batches | lr 0.00030 | ms/batch 77.51 | loss  3.40 | ppl    30.01 
| epoch  33 |   200/  216 batches | lr 0.00030 | ms/batch 76.31 | loss  3.41 | ppl    30.35 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 17.08s | valid loss  4.22 | valid ppl    68.09 | valid bpc    6.089
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 33.0%
| epoch  34 |   100/  216 batches | lr 0.00030 | ms/batch 77.35 | loss  3.37 | ppl    29.10 
| epoch  34 |   200/  216 batches | lr 0.00030 | ms/batch 76.33 | loss  3.38 | ppl    29.26 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 17.08s | valid loss  4.27 | valid ppl    71.66 | valid bpc    6.163
-----------------------------------------------------------------------------------------
PROGRESS: 34.0%
| epoch  35 |   100/  216 batches | lr 0.00030 | ms/batch 77.31 | loss  3.31 | ppl    27.34 
| epoch  35 |   200/  216 batches | lr 0.00030 | ms/batch 76.44 | loss  3.36 | ppl    28.78 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 17.08s | valid loss  4.28 | valid ppl    72.13 | valid bpc    6.172
-----------------------------------------------------------------------------------------
PROGRESS: 35.0%
| epoch  36 |   100/  216 batches | lr 0.00030 | ms/batch 77.29 | loss  3.29 | ppl    26.90 
| epoch  36 |   200/  216 batches | lr 0.00030 | ms/batch 76.53 | loss  3.30 | ppl    27.04 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 17.08s | valid loss  4.29 | valid ppl    73.31 | valid bpc    6.196
-----------------------------------------------------------------------------------------
PROGRESS: 36.0%
| epoch  37 |   100/  216 batches | lr 0.00015 | ms/batch 77.41 | loss  3.20 | ppl    24.56 
| epoch  37 |   200/  216 batches | lr 0.00015 | ms/batch 76.08 | loss  3.19 | ppl    24.35 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 17.08s | valid loss  4.23 | valid ppl    68.81 | valid bpc    6.105
-----------------------------------------------------------------------------------------
PROGRESS: 37.0%
| epoch  38 |   100/  216 batches | lr 0.00015 | ms/batch 77.61 | loss  3.15 | ppl    23.28 
| epoch  38 |   200/  216 batches | lr 0.00015 | ms/batch 76.27 | loss  3.13 | ppl    22.80 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 17.08s | valid loss  4.21 | valid ppl    67.36 | valid bpc    6.074
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 38.0%
| epoch  39 |   100/  216 batches | lr 0.00015 | ms/batch 77.40 | loss  3.12 | ppl    22.55 
| epoch  39 |   200/  216 batches | lr 0.00015 | ms/batch 76.38 | loss  3.10 | ppl    22.16 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 17.07s | valid loss  4.25 | valid ppl    69.98 | valid bpc    6.129
-----------------------------------------------------------------------------------------
PROGRESS: 39.0%
| epoch  40 |   100/  216 batches | lr 0.00015 | ms/batch 77.30 | loss  3.07 | ppl    21.54 
| epoch  40 |   200/  216 batches | lr 0.00015 | ms/batch 76.34 | loss  3.07 | ppl    21.56 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 17.08s | valid loss  4.20 | valid ppl    66.60 | valid bpc    6.058
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 40.0%
| epoch  41 |   100/  216 batches | lr 0.00015 | ms/batch 77.60 | loss  3.03 | ppl    20.74 
| epoch  41 |   200/  216 batches | lr 0.00015 | ms/batch 76.34 | loss  3.05 | ppl    21.19 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 17.11s | valid loss  4.19 | valid ppl    66.14 | valid bpc    6.048
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 41.0%
| epoch  42 |   100/  216 batches | lr 0.00015 | ms/batch 77.27 | loss  3.04 | ppl    20.86 
| epoch  42 |   200/  216 batches | lr 0.00015 | ms/batch 76.11 | loss  3.02 | ppl    20.56 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 17.07s | valid loss  4.22 | valid ppl    68.21 | valid bpc    6.092
-----------------------------------------------------------------------------------------
PROGRESS: 42.0%
| epoch  43 |   100/  216 batches | lr 0.00015 | ms/batch 77.63 | loss  3.04 | ppl    20.95 
| epoch  43 |   200/  216 batches | lr 0.00015 | ms/batch 76.03 | loss  2.95 | ppl    19.04 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 17.07s | valid loss  4.21 | valid ppl    67.54 | valid bpc    6.078
-----------------------------------------------------------------------------------------
PROGRESS: 43.0%
| epoch  44 |   100/  216 batches | lr 0.00015 | ms/batch 77.04 | loss  3.01 | ppl    20.31 
| epoch  44 |   200/  216 batches | lr 0.00015 | ms/batch 76.33 | loss  2.96 | ppl    19.36 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 17.08s | valid loss  4.23 | valid ppl    68.57 | valid bpc    6.100
-----------------------------------------------------------------------------------------
PROGRESS: 44.0%
| epoch  45 |   100/  216 batches | lr 0.00007 | ms/batch 77.64 | loss  2.94 | ppl    18.84 
| epoch  45 |   200/  216 batches | lr 0.00007 | ms/batch 76.24 | loss  2.90 | ppl    18.14 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 17.09s | valid loss  4.18 | valid ppl    65.29 | valid bpc    6.029
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 45.0%
| epoch  46 |   100/  216 batches | lr 0.00007 | ms/batch 77.25 | loss  2.90 | ppl    18.15 
| epoch  46 |   200/  216 batches | lr 0.00007 | ms/batch 76.61 | loss  2.89 | ppl    17.91 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 17.07s | valid loss  4.25 | valid ppl    70.42 | valid bpc    6.138
-----------------------------------------------------------------------------------------
PROGRESS: 46.0%
| epoch  47 |   100/  216 batches | lr 0.00007 | ms/batch 77.26 | loss  2.89 | ppl    17.93 
| epoch  47 |   200/  216 batches | lr 0.00007 | ms/batch 76.41 | loss  2.87 | ppl    17.57 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 17.08s | valid loss  4.25 | valid ppl    70.00 | valid bpc    6.129
-----------------------------------------------------------------------------------------
PROGRESS: 47.0%
| epoch  48 |   100/  216 batches | lr 0.00007 | ms/batch 77.08 | loss  2.88 | ppl    17.85 
| epoch  48 |   200/  216 batches | lr 0.00007 | ms/batch 76.77 | loss  2.84 | ppl    17.10 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 17.08s | valid loss  4.21 | valid ppl    67.68 | valid bpc    6.081
-----------------------------------------------------------------------------------------
PROGRESS: 48.0%
| epoch  49 |   100/  216 batches | lr 0.00004 | ms/batch 77.22 | loss  2.85 | ppl    17.21 
| epoch  49 |   200/  216 batches | lr 0.00004 | ms/batch 76.31 | loss  2.81 | ppl    16.60 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 17.08s | valid loss  4.22 | valid ppl    67.75 | valid bpc    6.082
-----------------------------------------------------------------------------------------
PROGRESS: 49.0%
| epoch  50 |   100/  216 batches | lr 0.00004 | ms/batch 77.37 | loss  2.80 | ppl    16.47 
| epoch  50 |   200/  216 batches | lr 0.00004 | ms/batch 76.11 | loss  2.81 | ppl    16.65 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 17.08s | valid loss  4.20 | valid ppl    66.69 | valid bpc    6.059
-----------------------------------------------------------------------------------------
PROGRESS: 50.0%
| epoch  51 |   100/  216 batches | lr 0.00004 | ms/batch 77.43 | loss  2.79 | ppl    16.31 
| epoch  51 |   200/  216 batches | lr 0.00004 | ms/batch 76.28 | loss  2.81 | ppl    16.63 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 17.09s | valid loss  4.21 | valid ppl    67.31 | valid bpc    6.073
-----------------------------------------------------------------------------------------
PROGRESS: 51.0%
| epoch  52 |   100/  216 batches | lr 0.00002 | ms/batch 77.85 | loss  2.80 | ppl    16.46 
| epoch  52 |   200/  216 batches | lr 0.00002 | ms/batch 75.96 | loss  2.79 | ppl    16.34 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 17.09s | valid loss  4.22 | valid ppl    68.00 | valid bpc    6.087
-----------------------------------------------------------------------------------------
PROGRESS: 52.0%
| epoch  53 |   100/  216 batches | lr 0.00002 | ms/batch 77.27 | loss  2.79 | ppl    16.30 
| epoch  53 |   200/  216 batches | lr 0.00002 | ms/batch 76.39 | loss  2.76 | ppl    15.82 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 17.08s | valid loss  4.21 | valid ppl    67.40 | valid bpc    6.075
-----------------------------------------------------------------------------------------
PROGRESS: 53.0%
| epoch  54 |   100/  216 batches | lr 0.00002 | ms/batch 77.16 | loss  2.79 | ppl    16.28 
| epoch  54 |   200/  216 batches | lr 0.00002 | ms/batch 76.29 | loss  2.77 | ppl    15.92 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 17.08s | valid loss  4.20 | valid ppl    66.66 | valid bpc    6.059
-----------------------------------------------------------------------------------------
PROGRESS: 54.0%
| epoch  55 |   100/  216 batches | lr 0.00001 | ms/batch 77.95 | loss  2.78 | ppl    16.17 
| epoch  55 |   200/  216 batches | lr 0.00001 | ms/batch 75.87 | loss  2.73 | ppl    15.41 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 17.09s | valid loss  4.20 | valid ppl    66.40 | valid bpc    6.053
-----------------------------------------------------------------------------------------
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  216 batches | lr 0.00001 | ms/batch 77.50 | loss  2.78 | ppl    16.18 
| epoch  56 |   200/  216 batches | lr 0.00001 | ms/batch 76.06 | loss  2.76 | ppl    15.82 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 17.10s | valid loss  4.20 | valid ppl    66.58 | valid bpc    6.057
-----------------------------------------------------------------------------------------
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  216 batches | lr 0.00001 | ms/batch 77.08 | loss  2.77 | ppl    15.95 
| epoch  57 |   200/  216 batches | lr 0.00001 | ms/batch 76.75 | loss  2.74 | ppl    15.45 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 17.08s | valid loss  4.25 | valid ppl    70.10 | valid bpc    6.131
-----------------------------------------------------------------------------------------
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  216 batches | lr 0.00000 | ms/batch 77.67 | loss  2.75 | ppl    15.69 
| epoch  58 |   200/  216 batches | lr 0.00000 | ms/batch 76.15 | loss  2.74 | ppl    15.55 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 17.09s | valid loss  4.16 | valid ppl    64.27 | valid bpc    6.006
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  216 batches | lr 0.00000 | ms/batch 77.24 | loss  2.78 | ppl    16.09 
| epoch  59 |   200/  216 batches | lr 0.00000 | ms/batch 76.16 | loss  2.75 | ppl    15.67 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 17.08s | valid loss  4.22 | valid ppl    67.98 | valid bpc    6.087
-----------------------------------------------------------------------------------------
PROGRESS: 59.0%
| epoch  60 |   100/  216 batches | lr 0.00000 | ms/batch 77.40 | loss  2.78 | ppl    16.04 
| epoch  60 |   200/  216 batches | lr 0.00000 | ms/batch 76.43 | loss  2.74 | ppl    15.49 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 17.08s | valid loss  4.21 | valid ppl    67.19 | valid bpc    6.070
-----------------------------------------------------------------------------------------
PROGRESS: 60.0%
| epoch  61 |   100/  216 batches | lr 0.00000 | ms/batch 77.62 | loss  2.77 | ppl    16.00 
| epoch  61 |   200/  216 batches | lr 0.00000 | ms/batch 76.13 | loss  2.73 | ppl    15.32 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 17.08s | valid loss  4.18 | valid ppl    65.47 | valid bpc    6.033
-----------------------------------------------------------------------------------------
PROGRESS: 61.0%
| epoch  62 |   100/  216 batches | lr 0.00000 | ms/batch 77.78 | loss  2.76 | ppl    15.86 
| epoch  62 |   200/  216 batches | lr 0.00000 | ms/batch 76.15 | loss  2.72 | ppl    15.25 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 17.10s | valid loss  4.17 | valid ppl    64.82 | valid bpc    6.018
-----------------------------------------------------------------------------------------
PROGRESS: 62.0%
| epoch  63 |   100/  216 batches | lr 0.00000 | ms/batch 77.36 | loss  2.75 | ppl    15.71 
| epoch  63 |   200/  216 batches | lr 0.00000 | ms/batch 76.30 | loss  2.73 | ppl    15.36 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 17.10s | valid loss  4.24 | valid ppl    69.52 | valid bpc    6.119
-----------------------------------------------------------------------------------------
PROGRESS: 63.0%
| epoch  64 |   100/  216 batches | lr 0.00000 | ms/batch 77.69 | loss  2.79 | ppl    16.20 
| epoch  64 |   200/  216 batches | lr 0.00000 | ms/batch 76.13 | loss  2.70 | ppl    14.91 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 17.09s | valid loss  4.20 | valid ppl    66.71 | valid bpc    6.060
-----------------------------------------------------------------------------------------
PROGRESS: 64.0%
| epoch  65 |   100/  216 batches | lr 0.00000 | ms/batch 77.74 | loss  2.78 | ppl    16.16 
| epoch  65 |   200/  216 batches | lr 0.00000 | ms/batch 76.00 | loss  2.73 | ppl    15.32 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 17.08s | valid loss  4.19 | valid ppl    66.11 | valid bpc    6.047
-----------------------------------------------------------------------------------------
PROGRESS: 65.0%
| epoch  66 |   100/  216 batches | lr 0.00000 | ms/batch 77.14 | loss  2.76 | ppl    15.75 
| epoch  66 |   200/  216 batches | lr 0.00000 | ms/batch 76.70 | loss  2.73 | ppl    15.31 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 17.09s | valid loss  4.20 | valid ppl    66.48 | valid bpc    6.055
-----------------------------------------------------------------------------------------
PROGRESS: 66.0%
| epoch  67 |   100/  216 batches | lr 0.00000 | ms/batch 77.83 | loss  2.77 | ppl    15.91 
| epoch  67 |   200/  216 batches | lr 0.00000 | ms/batch 76.07 | loss  2.74 | ppl    15.48 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 17.08s | valid loss  4.17 | valid ppl    64.79 | valid bpc    6.018
-----------------------------------------------------------------------------------------
PROGRESS: 67.0%
| epoch  68 |   100/  216 batches | lr 0.00000 | ms/batch 77.16 | loss  2.77 | ppl    15.91 
| epoch  68 |   200/  216 batches | lr 0.00000 | ms/batch 76.49 | loss  2.75 | ppl    15.63 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 17.08s | valid loss  4.22 | valid ppl    68.00 | valid bpc    6.087
-----------------------------------------------------------------------------------------
PROGRESS: 68.0%
| epoch  69 |   100/  216 batches | lr 0.00000 | ms/batch 77.92 | loss  2.77 | ppl    15.91 
| epoch  69 |   200/  216 batches | lr 0.00000 | ms/batch 75.97 | loss  2.75 | ppl    15.58 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 17.08s | valid loss  4.17 | valid ppl    64.99 | valid bpc    6.022
-----------------------------------------------------------------------------------------
PROGRESS: 69.0%
| epoch  70 |   100/  216 batches | lr 0.00000 | ms/batch 77.54 | loss  2.77 | ppl    16.00 
| epoch  70 |   200/  216 batches | lr 0.00000 | ms/batch 76.21 | loss  2.72 | ppl    15.17 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 17.08s | valid loss  4.25 | valid ppl    70.39 | valid bpc    6.137
-----------------------------------------------------------------------------------------
PROGRESS: 70.0%
| epoch  71 |   100/  216 batches | lr 0.00000 | ms/batch 77.21 | loss  2.76 | ppl    15.76 
| epoch  71 |   200/  216 batches | lr 0.00000 | ms/batch 76.70 | loss  2.73 | ppl    15.40 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 17.07s | valid loss  4.22 | valid ppl    68.03 | valid bpc    6.088
-----------------------------------------------------------------------------------------
PROGRESS: 71.0%
| epoch  72 |   100/  216 batches | lr 0.00000 | ms/batch 77.31 | loss  2.76 | ppl    15.77 
| epoch  72 |   200/  216 batches | lr 0.00000 | ms/batch 76.40 | loss  2.73 | ppl    15.40 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 17.08s | valid loss  4.20 | valid ppl    66.73 | valid bpc    6.060
-----------------------------------------------------------------------------------------
PROGRESS: 72.0%
| epoch  73 |   100/  216 batches | lr 0.00000 | ms/batch 77.60 | loss  2.78 | ppl    16.05 
| epoch  73 |   200/  216 batches | lr 0.00000 | ms/batch 76.06 | loss  2.72 | ppl    15.23 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 17.08s | valid loss  4.20 | valid ppl    66.92 | valid bpc    6.064
-----------------------------------------------------------------------------------------
PROGRESS: 73.0%
| epoch  74 |   100/  216 batches | lr 0.00000 | ms/batch 77.54 | loss  2.77 | ppl    15.98 
| epoch  74 |   200/  216 batches | lr 0.00000 | ms/batch 76.24 | loss  2.74 | ppl    15.51 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 17.08s | valid loss  4.19 | valid ppl    65.78 | valid bpc    6.040
-----------------------------------------------------------------------------------------
PROGRESS: 74.0%
| epoch  75 |   100/  216 batches | lr 0.00000 | ms/batch 77.54 | loss  2.75 | ppl    15.72 
| epoch  75 |   200/  216 batches | lr 0.00000 | ms/batch 76.26 | loss  2.72 | ppl    15.17 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 17.07s | valid loss  4.18 | valid ppl    65.39 | valid bpc    6.031
-----------------------------------------------------------------------------------------
PROGRESS: 75.0%
| epoch  76 |   100/  216 batches | lr 0.00000 | ms/batch 77.41 | loss  2.77 | ppl    15.96 
| epoch  76 |   200/  216 batches | lr 0.00000 | ms/batch 76.37 | loss  2.72 | ppl    15.21 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 17.08s | valid loss  4.19 | valid ppl    65.88 | valid bpc    6.042
-----------------------------------------------------------------------------------------
PROGRESS: 76.0%
| epoch  77 |   100/  216 batches | lr 0.00000 | ms/batch 77.64 | loss  2.75 | ppl    15.72 
| epoch  77 |   200/  216 batches | lr 0.00000 | ms/batch 76.12 | loss  2.73 | ppl    15.31 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 17.08s | valid loss  4.18 | valid ppl    65.12 | valid bpc    6.025
-----------------------------------------------------------------------------------------
PROGRESS: 77.0%
| epoch  78 |   100/  216 batches | lr 0.00000 | ms/batch 77.31 | loss  2.75 | ppl    15.69 
| epoch  78 |   200/  216 batches | lr 0.00000 | ms/batch 76.39 | loss  2.73 | ppl    15.33 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 17.08s | valid loss  4.21 | valid ppl    67.29 | valid bpc    6.072
-----------------------------------------------------------------------------------------
PROGRESS: 78.0%
| epoch  79 |   100/  216 batches | lr 0.00000 | ms/batch 77.51 | loss  2.77 | ppl    15.93 
| epoch  79 |   200/  216 batches | lr 0.00000 | ms/batch 76.20 | loss  2.72 | ppl    15.21 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 17.08s | valid loss  4.18 | valid ppl    65.51 | valid bpc    6.034
-----------------------------------------------------------------------------------------
PROGRESS: 79.0%
| epoch  80 |   100/  216 batches | lr 0.00000 | ms/batch 77.33 | loss  2.74 | ppl    15.51 
| epoch  80 |   200/  216 batches | lr 0.00000 | ms/batch 76.49 | loss  2.75 | ppl    15.58 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 17.08s | valid loss  4.20 | valid ppl    66.69 | valid bpc    6.059
-----------------------------------------------------------------------------------------
PROGRESS: 80.0%
| epoch  81 |   100/  216 batches | lr 0.00000 | ms/batch 77.46 | loss  2.78 | ppl    16.04 
| epoch  81 |   200/  216 batches | lr 0.00000 | ms/batch 76.25 | loss  2.73 | ppl    15.38 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 17.07s | valid loss  4.20 | valid ppl    66.68 | valid bpc    6.059
-----------------------------------------------------------------------------------------
PROGRESS: 81.0%
| epoch  82 |   100/  216 batches | lr 0.00000 | ms/batch 77.43 | loss  2.76 | ppl    15.87 
| epoch  82 |   200/  216 batches | lr 0.00000 | ms/batch 76.35 | loss  2.75 | ppl    15.61 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 17.08s | valid loss  4.23 | valid ppl    68.46 | valid bpc    6.097
-----------------------------------------------------------------------------------------
PROGRESS: 82.0%
| epoch  83 |   100/  216 batches | lr 0.00000 | ms/batch 77.26 | loss  2.76 | ppl    15.82 
| epoch  83 |   200/  216 batches | lr 0.00000 | ms/batch 76.54 | loss  2.73 | ppl    15.26 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 17.08s | valid loss  4.18 | valid ppl    65.28 | valid bpc    6.029
-----------------------------------------------------------------------------------------
PROGRESS: 83.0%
| epoch  84 |   100/  216 batches | lr 0.00000 | ms/batch 77.70 | loss  2.74 | ppl    15.46 
| epoch  84 |   200/  216 batches | lr 0.00000 | ms/batch 76.17 | loss  2.73 | ppl    15.40 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 17.08s | valid loss  4.21 | valid ppl    67.13 | valid bpc    6.069
-----------------------------------------------------------------------------------------
PROGRESS: 84.0%
| epoch  85 |   100/  216 batches | lr 0.00000 | ms/batch 77.17 | loss  2.76 | ppl    15.77 
| epoch  85 |   200/  216 batches | lr 0.00000 | ms/batch 76.70 | loss  2.74 | ppl    15.43 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 17.09s | valid loss  4.23 | valid ppl    68.52 | valid bpc    6.098
-----------------------------------------------------------------------------------------
PROGRESS: 85.0%
| epoch  86 |   100/  216 batches | lr 0.00000 | ms/batch 77.58 | loss  2.75 | ppl    15.71 
| epoch  86 |   200/  216 batches | lr 0.00000 | ms/batch 76.27 | loss  2.72 | ppl    15.20 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 17.08s | valid loss  4.21 | valid ppl    67.24 | valid bpc    6.071
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  216 batches | lr 0.00000 | ms/batch 77.80 | loss  2.76 | ppl    15.78 
| epoch  87 |   200/  216 batches | lr 0.00000 | ms/batch 76.16 | loss  2.73 | ppl    15.34 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 17.08s | valid loss  4.20 | valid ppl    66.46 | valid bpc    6.054
-----------------------------------------------------------------------------------------
PROGRESS: 87.0%
| epoch  88 |   100/  216 batches | lr 0.00000 | ms/batch 77.69 | loss  2.76 | ppl    15.76 
| epoch  88 |   200/  216 batches | lr 0.00000 | ms/batch 76.08 | loss  2.73 | ppl    15.34 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 17.08s | valid loss  4.18 | valid ppl    65.59 | valid bpc    6.035
-----------------------------------------------------------------------------------------
PROGRESS: 88.0%
| epoch  89 |   100/  216 batches | lr 0.00000 | ms/batch 77.67 | loss  2.75 | ppl    15.59 
| epoch  89 |   200/  216 batches | lr 0.00000 | ms/batch 76.15 | loss  2.73 | ppl    15.30 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 17.08s | valid loss  4.20 | valid ppl    66.37 | valid bpc    6.052
-----------------------------------------------------------------------------------------
PROGRESS: 89.0%
| epoch  90 |   100/  216 batches | lr 0.00000 | ms/batch 77.65 | loss  2.76 | ppl    15.77 
| epoch  90 |   200/  216 batches | lr 0.00000 | ms/batch 76.27 | loss  2.73 | ppl    15.32 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 17.10s | valid loss  4.19 | valid ppl    65.89 | valid bpc    6.042
-----------------------------------------------------------------------------------------
PROGRESS: 90.0%
| epoch  91 |   100/  216 batches | lr 0.00000 | ms/batch 77.84 | loss  2.79 | ppl    16.29 
| epoch  91 |   200/  216 batches | lr 0.00000 | ms/batch 75.98 | loss  2.72 | ppl    15.21 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 17.08s | valid loss  4.26 | valid ppl    70.46 | valid bpc    6.139
-----------------------------------------------------------------------------------------
PROGRESS: 91.0%
| epoch  92 |   100/  216 batches | lr 0.00000 | ms/batch 77.49 | loss  2.76 | ppl    15.86 
| epoch  92 |   200/  216 batches | lr 0.00000 | ms/batch 76.39 | loss  2.72 | ppl    15.13 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 17.08s | valid loss  4.20 | valid ppl    66.68 | valid bpc    6.059
-----------------------------------------------------------------------------------------
PROGRESS: 92.0%
| epoch  93 |   100/  216 batches | lr 0.00000 | ms/batch 77.25 | loss  2.76 | ppl    15.81 
| epoch  93 |   200/  216 batches | lr 0.00000 | ms/batch 76.45 | loss  2.73 | ppl    15.28 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 17.07s | valid loss  4.20 | valid ppl    66.93 | valid bpc    6.065
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  216 batches | lr 0.00000 | ms/batch 77.67 | loss  2.76 | ppl    15.78 
| epoch  94 |   200/  216 batches | lr 0.00000 | ms/batch 76.12 | loss  2.72 | ppl    15.25 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 17.07s | valid loss  4.20 | valid ppl    66.48 | valid bpc    6.055
-----------------------------------------------------------------------------------------
PROGRESS: 94.0%
| epoch  95 |   100/  216 batches | lr 0.00000 | ms/batch 77.24 | loss  2.75 | ppl    15.68 
| epoch  95 |   200/  216 batches | lr 0.00000 | ms/batch 76.53 | loss  2.77 | ppl    15.99 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 17.07s | valid loss  4.18 | valid ppl    65.62 | valid bpc    6.036
-----------------------------------------------------------------------------------------
PROGRESS: 95.0%
| epoch  96 |   100/  216 batches | lr 0.00000 | ms/batch 77.64 | loss  2.78 | ppl    16.04 
| epoch  96 |   200/  216 batches | lr 0.00000 | ms/batch 76.04 | loss  2.72 | ppl    15.21 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 17.08s | valid loss  4.22 | valid ppl    68.13 | valid bpc    6.090
-----------------------------------------------------------------------------------------
PROGRESS: 96.0%
| epoch  97 |   100/  216 batches | lr 0.00000 | ms/batch 77.00 | loss  2.76 | ppl    15.77 
| epoch  97 |   200/  216 batches | lr 0.00000 | ms/batch 76.82 | loss  2.74 | ppl    15.54 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 17.08s | valid loss  4.22 | valid ppl    68.28 | valid bpc    6.093
-----------------------------------------------------------------------------------------
PROGRESS: 97.0%
| epoch  98 |   100/  216 batches | lr 0.00000 | ms/batch 77.67 | loss  2.75 | ppl    15.71 
| epoch  98 |   200/  216 batches | lr 0.00000 | ms/batch 76.18 | loss  2.72 | ppl    15.16 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 17.07s | valid loss  4.21 | valid ppl    67.40 | valid bpc    6.075
-----------------------------------------------------------------------------------------
PROGRESS: 98.0%
| epoch  99 |   100/  216 batches | lr 0.00000 | ms/batch 77.85 | loss  2.77 | ppl    16.01 
| epoch  99 |   200/  216 batches | lr 0.00000 | ms/batch 75.92 | loss  2.74 | ppl    15.43 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 17.08s | valid loss  4.19 | valid ppl    66.15 | valid bpc    6.048
-----------------------------------------------------------------------------------------
PROGRESS: 99.0%
| epoch 100 |   100/  216 batches | lr 0.00000 | ms/batch 77.17 | loss  2.75 | ppl    15.68 
| epoch 100 |   200/  216 batches | lr 0.00000 | ms/batch 76.54 | loss  2.73 | ppl    15.40 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 17.07s | valid loss  4.18 | valid ppl    65.62 | valid bpc    6.036
-----------------------------------------------------------------------------------------
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  4.13 | test ppl    62.05 | test bpc    5.955
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.4560, Mean Reca: 0.6283, Mean F1: 0.5201
Counter({'NP': 9685, 'PP': 4256, 'S': 3636, 'VP': 3184, 'SBAR': 672, 'QP': 295, 'ADJP': 290, 'ADVP': 186, 'SINV': 149, 'PRN': 52, 'FRAG': 35, 'WHNP': 29, 'NX': 22, 'NAC': 15, 'SQ': 13, 'UCP': 9, 'SBARQ': 8, 'WHPP': 5, 'CONJP': 3, 'X': 2})
Counter({'NP': 14432, 'VP': 8130, 'S': 5620, 'PP': 5484, 'SBAR': 1796, 'ADJP': 649, 'QP': 490, 'ADVP': 286, 'SINV': 157, 'PRN': 128, 'NX': 95, 'FRAG': 42, 'WHNP': 37, 'UCP': 32, 'NAC': 30, 'WHPP': 25, 'CONJP': 21, 'SQ': 18, 'SBARQ': 10, 'WHADVP': 9, 'X': 6, 'WHADJP': 4, 'INTJ': 1})
SBAR: 0.3742
NP: 0.6711
VP: 0.3916
PP: 0.7761
ADJP: 0.4468
ADVP: 0.6503
4.867514866064297
-----------------------------------------------------------------------------------------
Dependency parsing performance:
Conll-U Style:
DDA: 0.426
UDA: 0.589
=========================================================================================
Loading dataset...
Loading dictionary...
Number of tokens:  10001
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer_in_parser', nhid=512, nlayers=8, front_layers=3, rear_layers=5, n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=3333, nonmono=5, cuda=True, log_interval=100, save='trained_models/structformer_in_parser_3333_35.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 38475621
Model architecture: StructFormer_In_Parser(
  (transformer_front): Transformer_Front(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(10001, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-2): 3 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
  (transformer_rear): Transformer_Rear(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(10001, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-4): 5 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (output_layer): Linear(in_features=512, out_features=10001, bias=True)
  )
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  216 batches | lr 0.00030 | ms/batch 79.95 | loss  7.30 | ppl  1478.52 
| epoch   1 |   200/  216 batches | lr 0.00030 | ms/batch 75.38 | loss  6.86 | ppl   951.50 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 17.23s | valid loss  6.71 | valid ppl   823.48 | valid bpc    9.686
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  216 batches | lr 0.00030 | ms/batch 76.35 | loss  6.82 | ppl   917.93 
| epoch   2 |   200/  216 batches | lr 0.00030 | ms/batch 76.04 | loss  6.59 | ppl   725.54 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 16.95s | valid loss  6.34 | valid ppl   568.40 | valid bpc    9.151
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  216 batches | lr 0.00030 | ms/batch 77.38 | loss  6.36 | ppl   580.01 
| epoch   3 |   200/  216 batches | lr 0.00030 | ms/batch 75.68 | loss  6.10 | ppl   447.54 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 17.00s | valid loss  5.88 | valid ppl   357.81 | valid bpc    8.483
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  216 batches | lr 0.00030 | ms/batch 77.13 | loss  5.90 | ppl   364.00 
| epoch   4 |   200/  216 batches | lr 0.00030 | ms/batch 76.18 | loss  5.66 | ppl   287.79 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 17.03s | valid loss  5.56 | valid ppl   258.83 | valid bpc    8.016
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  216 batches | lr 0.00030 | ms/batch 77.30 | loss  5.54 | ppl   254.33 
| epoch   5 |   200/  216 batches | lr 0.00030 | ms/batch 76.14 | loss  5.45 | ppl   232.05 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 17.04s | valid loss  5.32 | valid ppl   205.31 | valid bpc    7.682
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  216 batches | lr 0.00030 | ms/batch 77.07 | loss  5.30 | ppl   200.75 
| epoch   6 |   200/  216 batches | lr 0.00030 | ms/batch 76.48 | loss  5.26 | ppl   191.80 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 17.06s | valid loss  5.18 | valid ppl   177.05 | valid bpc    7.468
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  216 batches | lr 0.00030 | ms/batch 77.35 | loss  5.17 | ppl   175.59 
| epoch   7 |   200/  216 batches | lr 0.00030 | ms/batch 75.90 | loss  5.07 | ppl   159.52 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 17.06s | valid loss  5.06 | valid ppl   156.92 | valid bpc    7.294
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  216 batches | lr 0.00030 | ms/batch 77.19 | loss  5.02 | ppl   151.63 
| epoch   8 |   200/  216 batches | lr 0.00030 | ms/batch 76.49 | loss  4.94 | ppl   139.21 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 17.07s | valid loss  4.96 | valid ppl   142.15 | valid bpc    7.151
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 8.0%
| epoch   9 |   100/  216 batches | lr 0.00030 | ms/batch 76.89 | loss  4.89 | ppl   133.22 
| epoch   9 |   200/  216 batches | lr 0.00030 | ms/batch 76.73 | loss  4.83 | ppl   125.76 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 17.07s | valid loss  4.84 | valid ppl   126.24 | valid bpc    6.980
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  216 batches | lr 0.00030 | ms/batch 77.39 | loss  4.77 | ppl   118.19 
| epoch  10 |   200/  216 batches | lr 0.00030 | ms/batch 76.40 | loss  4.74 | ppl   114.46 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 17.08s | valid loss  4.81 | valid ppl   122.32 | valid bpc    6.934
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  216 batches | lr 0.00030 | ms/batch 77.55 | loss  4.71 | ppl   110.85 
| epoch  11 |   200/  216 batches | lr 0.00030 | ms/batch 76.25 | loss  4.61 | ppl   100.09 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 17.08s | valid loss  4.72 | valid ppl   111.82 | valid bpc    6.805
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  216 batches | lr 0.00030 | ms/batch 77.13 | loss  4.57 | ppl    96.60 
| epoch  12 |   200/  216 batches | lr 0.00030 | ms/batch 76.45 | loss  4.55 | ppl    94.22 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 17.08s | valid loss  4.66 | valid ppl   105.21 | valid bpc    6.717
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 12.0%
| epoch  13 |   100/  216 batches | lr 0.00030 | ms/batch 77.15 | loss  4.50 | ppl    89.97 
| epoch  13 |   200/  216 batches | lr 0.00030 | ms/batch 76.51 | loss  4.48 | ppl    87.92 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 17.07s | valid loss  4.60 | valid ppl    99.06 | valid bpc    6.630
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 13.0%
| epoch  14 |   100/  216 batches | lr 0.00030 | ms/batch 77.57 | loss  4.43 | ppl    83.79 
| epoch  14 |   200/  216 batches | lr 0.00030 | ms/batch 76.01 | loss  4.37 | ppl    78.84 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 17.08s | valid loss  4.57 | valid ppl    96.87 | valid bpc    6.598
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  216 batches | lr 0.00030 | ms/batch 77.69 | loss  4.34 | ppl    76.51 
| epoch  15 |   200/  216 batches | lr 0.00030 | ms/batch 75.96 | loss  4.32 | ppl    75.25 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 17.07s | valid loss  4.53 | valid ppl    92.69 | valid bpc    6.534
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 15.0%
| epoch  16 |   100/  216 batches | lr 0.00030 | ms/batch 77.57 | loss  4.27 | ppl    71.70 
| epoch  16 |   200/  216 batches | lr 0.00030 | ms/batch 76.21 | loss  4.22 | ppl    67.72 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 17.07s | valid loss  4.48 | valid ppl    88.55 | valid bpc    6.468
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 16.0%
| epoch  17 |   100/  216 batches | lr 0.00030 | ms/batch 77.70 | loss  4.22 | ppl    67.88 
| epoch  17 |   200/  216 batches | lr 0.00030 | ms/batch 76.00 | loss  4.17 | ppl    64.69 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 17.07s | valid loss  4.50 | valid ppl    89.89 | valid bpc    6.490
-----------------------------------------------------------------------------------------
PROGRESS: 17.0%
| epoch  18 |   100/  216 batches | lr 0.00030 | ms/batch 77.21 | loss  4.14 | ppl    62.73 
| epoch  18 |   200/  216 batches | lr 0.00030 | ms/batch 76.67 | loss  4.09 | ppl    59.98 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 17.07s | valid loss  4.42 | valid ppl    83.15 | valid bpc    6.378
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 18.0%
| epoch  19 |   100/  216 batches | lr 0.00030 | ms/batch 77.84 | loss  4.09 | ppl    59.92 
| epoch  19 |   200/  216 batches | lr 0.00030 | ms/batch 76.03 | loss  4.04 | ppl    56.61 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 17.08s | valid loss  4.41 | valid ppl    82.20 | valid bpc    6.361
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 19.0%
| epoch  20 |   100/  216 batches | lr 0.00030 | ms/batch 77.52 | loss  4.04 | ppl    57.07 
| epoch  20 |   200/  216 batches | lr 0.00030 | ms/batch 76.21 | loss  4.00 | ppl    54.53 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 17.08s | valid loss  4.37 | valid ppl    79.43 | valid bpc    6.312
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 20.0%
| epoch  21 |   100/  216 batches | lr 0.00030 | ms/batch 77.54 | loss  3.96 | ppl    52.24 
| epoch  21 |   200/  216 batches | lr 0.00030 | ms/batch 76.14 | loss  3.95 | ppl    51.73 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 17.08s | valid loss  4.40 | valid ppl    81.12 | valid bpc    6.342
-----------------------------------------------------------------------------------------
PROGRESS: 21.0%
| epoch  22 |   100/  216 batches | lr 0.00030 | ms/batch 77.32 | loss  3.90 | ppl    49.51 
| epoch  22 |   200/  216 batches | lr 0.00030 | ms/batch 76.42 | loss  3.92 | ppl    50.18 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 17.08s | valid loss  4.31 | valid ppl    74.60 | valid bpc    6.221
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 22.0%
| epoch  23 |   100/  216 batches | lr 0.00030 | ms/batch 77.58 | loss  3.87 | ppl    48.15 
| epoch  23 |   200/  216 batches | lr 0.00030 | ms/batch 76.09 | loss  3.83 | ppl    46.03 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 17.08s | valid loss  4.38 | valid ppl    79.61 | valid bpc    6.315
-----------------------------------------------------------------------------------------
PROGRESS: 23.0%
| epoch  24 |   100/  216 batches | lr 0.00030 | ms/batch 77.56 | loss  3.81 | ppl    45.15 
| epoch  24 |   200/  216 batches | lr 0.00030 | ms/batch 76.26 | loss  3.80 | ppl    44.79 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 17.08s | valid loss  4.29 | valid ppl    72.97 | valid bpc    6.189
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 24.0%
| epoch  25 |   100/  216 batches | lr 0.00030 | ms/batch 77.83 | loss  3.77 | ppl    43.50 
| epoch  25 |   200/  216 batches | lr 0.00030 | ms/batch 75.91 | loss  3.74 | ppl    42.21 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 17.08s | valid loss  4.35 | valid ppl    77.10 | valid bpc    6.269
-----------------------------------------------------------------------------------------
PROGRESS: 25.0%
| epoch  26 |   100/  216 batches | lr 0.00030 | ms/batch 77.37 | loss  3.70 | ppl    40.62 
| epoch  26 |   200/  216 batches | lr 0.00030 | ms/batch 76.52 | loss  3.71 | ppl    40.66 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 17.09s | valid loss  4.30 | valid ppl    73.95 | valid bpc    6.209
-----------------------------------------------------------------------------------------
PROGRESS: 26.0%
| epoch  27 |   100/  216 batches | lr 0.00030 | ms/batch 77.75 | loss  3.68 | ppl    39.51 
| epoch  27 |   200/  216 batches | lr 0.00030 | ms/batch 76.09 | loss  3.66 | ppl    38.73 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 17.08s | valid loss  4.31 | valid ppl    74.32 | valid bpc    6.216
-----------------------------------------------------------------------------------------
PROGRESS: 27.0%
| epoch  28 |   100/  216 batches | lr 0.00015 | ms/batch 77.77 | loss  3.58 | ppl    35.72 
| epoch  28 |   200/  216 batches | lr 0.00015 | ms/batch 76.13 | loss  3.54 | ppl    34.38 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 17.08s | valid loss  4.23 | valid ppl    68.72 | valid bpc    6.103
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  216 batches | lr 0.00015 | ms/batch 77.24 | loss  3.52 | ppl    33.74 
| epoch  29 |   200/  216 batches | lr 0.00015 | ms/batch 76.46 | loss  3.51 | ppl    33.29 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 17.08s | valid loss  4.23 | valid ppl    68.97 | valid bpc    6.108
-----------------------------------------------------------------------------------------
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  216 batches | lr 0.00015 | ms/batch 77.79 | loss  3.48 | ppl    32.33 
| epoch  30 |   200/  216 batches | lr 0.00015 | ms/batch 75.87 | loss  3.44 | ppl    31.15 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 17.08s | valid loss  4.20 | valid ppl    66.92 | valid bpc    6.064
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 30.0%
| epoch  31 |   100/  216 batches | lr 0.00015 | ms/batch 77.39 | loss  3.45 | ppl    31.57 
| epoch  31 |   200/  216 batches | lr 0.00015 | ms/batch 76.40 | loss  3.41 | ppl    30.35 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 17.08s | valid loss  4.20 | valid ppl    66.72 | valid bpc    6.060
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 31.0%
| epoch  32 |   100/  216 batches | lr 0.00015 | ms/batch 77.20 | loss  3.40 | ppl    29.94 
| epoch  32 |   200/  216 batches | lr 0.00015 | ms/batch 76.61 | loss  3.41 | ppl    30.22 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 17.08s | valid loss  4.24 | valid ppl    69.11 | valid bpc    6.111
-----------------------------------------------------------------------------------------
PROGRESS: 32.0%
| epoch  33 |   100/  216 batches | lr 0.00015 | ms/batch 77.12 | loss  3.39 | ppl    29.70 
| epoch  33 |   200/  216 batches | lr 0.00015 | ms/batch 76.68 | loss  3.38 | ppl    29.29 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 17.07s | valid loss  4.23 | valid ppl    68.73 | valid bpc    6.103
-----------------------------------------------------------------------------------------
PROGRESS: 33.0%
| epoch  34 |   100/  216 batches | lr 0.00015 | ms/batch 77.67 | loss  3.36 | ppl    28.73 
| epoch  34 |   200/  216 batches | lr 0.00015 | ms/batch 75.85 | loss  3.32 | ppl    27.58 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 17.08s | valid loss  4.20 | valid ppl    66.39 | valid bpc    6.053
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 34.0%
| epoch  35 |   100/  216 batches | lr 0.00015 | ms/batch 77.15 | loss  3.34 | ppl    28.22 
| epoch  35 |   200/  216 batches | lr 0.00015 | ms/batch 76.45 | loss  3.31 | ppl    27.52 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 17.07s | valid loss  4.23 | valid ppl    68.50 | valid bpc    6.098
-----------------------------------------------------------------------------------------
PROGRESS: 35.0%
| epoch  36 |   100/  216 batches | lr 0.00015 | ms/batch 77.69 | loss  3.31 | ppl    27.41 
| epoch  36 |   200/  216 batches | lr 0.00015 | ms/batch 76.05 | loss  3.27 | ppl    26.44 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 17.08s | valid loss  4.17 | valid ppl    64.55 | valid bpc    6.012
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 36.0%
| epoch  37 |   100/  216 batches | lr 0.00015 | ms/batch 77.83 | loss  3.27 | ppl    26.27 
| epoch  37 |   200/  216 batches | lr 0.00015 | ms/batch 75.97 | loss  3.28 | ppl    26.47 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 17.09s | valid loss  4.24 | valid ppl    69.37 | valid bpc    6.116
-----------------------------------------------------------------------------------------
PROGRESS: 37.0%
| epoch  38 |   100/  216 batches | lr 0.00015 | ms/batch 77.79 | loss  3.26 | ppl    26.01 
| epoch  38 |   200/  216 batches | lr 0.00015 | ms/batch 76.12 | loss  3.24 | ppl    25.47 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 17.08s | valid loss  4.19 | valid ppl    66.11 | valid bpc    6.047
-----------------------------------------------------------------------------------------
PROGRESS: 38.0%
| epoch  39 |   100/  216 batches | lr 0.00015 | ms/batch 77.16 | loss  3.24 | ppl    25.46 
| epoch  39 |   200/  216 batches | lr 0.00015 | ms/batch 76.23 | loss  3.22 | ppl    24.98 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 17.08s | valid loss  4.19 | valid ppl    66.21 | valid bpc    6.049
-----------------------------------------------------------------------------------------
PROGRESS: 39.0%
| epoch  40 |   100/  216 batches | lr 0.00007 | ms/batch 77.40 | loss  3.18 | ppl    23.95 
| epoch  40 |   200/  216 batches | lr 0.00007 | ms/batch 76.36 | loss  3.15 | ppl    23.25 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 17.08s | valid loss  4.17 | valid ppl    64.87 | valid bpc    6.019
-----------------------------------------------------------------------------------------
PROGRESS: 40.0%
| epoch  41 |   100/  216 batches | lr 0.00007 | ms/batch 77.84 | loss  3.14 | ppl    23.19 
| epoch  41 |   200/  216 batches | lr 0.00007 | ms/batch 76.03 | loss  3.12 | ppl    22.60 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 17.08s | valid loss  4.22 | valid ppl    67.89 | valid bpc    6.085
-----------------------------------------------------------------------------------------
PROGRESS: 41.0%
| epoch  42 |   100/  216 batches | lr 0.00007 | ms/batch 77.46 | loss  3.12 | ppl    22.69 
| epoch  42 |   200/  216 batches | lr 0.00007 | ms/batch 76.38 | loss  3.12 | ppl    22.56 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 17.09s | valid loss  4.15 | valid ppl    63.25 | valid bpc    5.983
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 42.0%
| epoch  43 |   100/  216 batches | lr 0.00007 | ms/batch 77.44 | loss  3.11 | ppl    22.43 
| epoch  43 |   200/  216 batches | lr 0.00007 | ms/batch 76.41 | loss  3.08 | ppl    21.78 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 17.09s | valid loss  4.21 | valid ppl    67.26 | valid bpc    6.072
-----------------------------------------------------------------------------------------
PROGRESS: 43.0%
| epoch  44 |   100/  216 batches | lr 0.00007 | ms/batch 77.14 | loss  3.11 | ppl    22.44 
| epoch  44 |   200/  216 batches | lr 0.00007 | ms/batch 76.39 | loss  3.09 | ppl    21.89 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 17.09s | valid loss  4.18 | valid ppl    65.34 | valid bpc    6.030
-----------------------------------------------------------------------------------------
PROGRESS: 44.0%
| epoch  45 |   100/  216 batches | lr 0.00007 | ms/batch 77.78 | loss  3.09 | ppl    21.99 
| epoch  45 |   200/  216 batches | lr 0.00007 | ms/batch 76.11 | loss  3.06 | ppl    21.35 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 17.09s | valid loss  4.18 | valid ppl    65.54 | valid bpc    6.034
-----------------------------------------------------------------------------------------
PROGRESS: 45.0%
| epoch  46 |   100/  216 batches | lr 0.00004 | ms/batch 77.70 | loss  3.05 | ppl    21.20 
| epoch  46 |   200/  216 batches | lr 0.00004 | ms/batch 76.15 | loss  3.03 | ppl    20.69 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 17.09s | valid loss  4.19 | valid ppl    66.05 | valid bpc    6.045
-----------------------------------------------------------------------------------------
PROGRESS: 46.0%
| epoch  47 |   100/  216 batches | lr 0.00004 | ms/batch 77.80 | loss  3.05 | ppl    21.09 
| epoch  47 |   200/  216 batches | lr 0.00004 | ms/batch 76.09 | loss  3.02 | ppl    20.50 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 17.09s | valid loss  4.19 | valid ppl    66.28 | valid bpc    6.051
-----------------------------------------------------------------------------------------
PROGRESS: 47.0%
| epoch  48 |   100/  216 batches | lr 0.00004 | ms/batch 78.01 | loss  3.03 | ppl    20.71 
| epoch  48 |   200/  216 batches | lr 0.00004 | ms/batch 75.95 | loss  2.98 | ppl    19.67 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 17.09s | valid loss  4.20 | valid ppl    66.92 | valid bpc    6.064
-----------------------------------------------------------------------------------------
PROGRESS: 48.0%
| epoch  49 |   100/  216 batches | lr 0.00002 | ms/batch 77.52 | loss  3.03 | ppl    20.65 
| epoch  49 |   200/  216 batches | lr 0.00002 | ms/batch 76.33 | loss  2.97 | ppl    19.57 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 17.09s | valid loss  4.20 | valid ppl    66.76 | valid bpc    6.061
-----------------------------------------------------------------------------------------
PROGRESS: 49.0%
| epoch  50 |   100/  216 batches | lr 0.00002 | ms/batch 77.61 | loss  3.00 | ppl    20.13 
| epoch  50 |   200/  216 batches | lr 0.00002 | ms/batch 76.12 | loss  2.97 | ppl    19.57 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 17.08s | valid loss  4.19 | valid ppl    66.32 | valid bpc    6.051
-----------------------------------------------------------------------------------------
PROGRESS: 50.0%
| epoch  51 |   100/  216 batches | lr 0.00002 | ms/batch 77.75 | loss  3.03 | ppl    20.66 
| epoch  51 |   200/  216 batches | lr 0.00002 | ms/batch 76.21 | loss  2.94 | ppl    18.95 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 17.09s | valid loss  4.20 | valid ppl    66.42 | valid bpc    6.053
-----------------------------------------------------------------------------------------
PROGRESS: 51.0%
| epoch  52 |   100/  216 batches | lr 0.00001 | ms/batch 77.33 | loss  2.99 | ppl    19.81 
| epoch  52 |   200/  216 batches | lr 0.00001 | ms/batch 76.58 | loss  2.98 | ppl    19.67 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 17.09s | valid loss  4.16 | valid ppl    63.76 | valid bpc    5.995
-----------------------------------------------------------------------------------------
PROGRESS: 52.0%
| epoch  53 |   100/  216 batches | lr 0.00001 | ms/batch 77.80 | loss  2.97 | ppl    19.42 
| epoch  53 |   200/  216 batches | lr 0.00001 | ms/batch 76.04 | loss  2.98 | ppl    19.76 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 17.09s | valid loss  4.17 | valid ppl    64.94 | valid bpc    6.021
-----------------------------------------------------------------------------------------
PROGRESS: 53.0%
| epoch  54 |   100/  216 batches | lr 0.00001 | ms/batch 77.58 | loss  2.99 | ppl    19.89 
| epoch  54 |   200/  216 batches | lr 0.00001 | ms/batch 76.33 | loss  2.97 | ppl    19.40 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 17.10s | valid loss  4.17 | valid ppl    64.76 | valid bpc    6.017
-----------------------------------------------------------------------------------------
PROGRESS: 54.0%
| epoch  55 |   100/  216 batches | lr 0.00000 | ms/batch 77.92 | loss  2.99 | ppl    19.94 
| epoch  55 |   200/  216 batches | lr 0.00000 | ms/batch 75.92 | loss  2.94 | ppl    18.94 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 17.09s | valid loss  4.20 | valid ppl    66.87 | valid bpc    6.063
-----------------------------------------------------------------------------------------
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  216 batches | lr 0.00000 | ms/batch 77.47 | loss  2.98 | ppl    19.72 
| epoch  56 |   200/  216 batches | lr 0.00000 | ms/batch 76.64 | loss  2.94 | ppl    19.00 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 17.11s | valid loss  4.17 | valid ppl    64.65 | valid bpc    6.015
-----------------------------------------------------------------------------------------
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  216 batches | lr 0.00000 | ms/batch 77.11 | loss  2.97 | ppl    19.40 
| epoch  57 |   200/  216 batches | lr 0.00000 | ms/batch 76.66 | loss  2.94 | ppl    18.95 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 17.09s | valid loss  4.16 | valid ppl    64.25 | valid bpc    6.006
-----------------------------------------------------------------------------------------
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  216 batches | lr 0.00000 | ms/batch 77.53 | loss  2.96 | ppl    19.38 
| epoch  58 |   200/  216 batches | lr 0.00000 | ms/batch 76.35 | loss  2.94 | ppl    18.97 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 17.08s | valid loss  4.19 | valid ppl    66.03 | valid bpc    6.045
-----------------------------------------------------------------------------------------
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  216 batches | lr 0.00000 | ms/batch 77.92 | loss  2.98 | ppl    19.60 
| epoch  59 |   200/  216 batches | lr 0.00000 | ms/batch 75.92 | loss  2.96 | ppl    19.21 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 17.09s | valid loss  4.18 | valid ppl    65.37 | valid bpc    6.031
-----------------------------------------------------------------------------------------
PROGRESS: 59.0%
| epoch  60 |   100/  216 batches | lr 0.00000 | ms/batch 77.42 | loss  2.97 | ppl    19.46 
| epoch  60 |   200/  216 batches | lr 0.00000 | ms/batch 76.34 | loss  2.95 | ppl    19.19 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 17.08s | valid loss  4.16 | valid ppl    64.10 | valid bpc    6.002
-----------------------------------------------------------------------------------------
PROGRESS: 60.0%
| epoch  61 |   100/  216 batches | lr 0.00000 | ms/batch 77.53 | loss  2.97 | ppl    19.43 
| epoch  61 |   200/  216 batches | lr 0.00000 | ms/batch 75.97 | loss  2.93 | ppl    18.70 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 17.08s | valid loss  4.14 | valid ppl    62.59 | valid bpc    5.968
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 61.0%
| epoch  62 |   100/  216 batches | lr 0.00000 | ms/batch 77.28 | loss  2.98 | ppl    19.63 
| epoch  62 |   200/  216 batches | lr 0.00000 | ms/batch 76.45 | loss  2.93 | ppl    18.64 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 17.07s | valid loss  4.17 | valid ppl    64.84 | valid bpc    6.019
-----------------------------------------------------------------------------------------
PROGRESS: 62.0%
| epoch  63 |   100/  216 batches | lr 0.00000 | ms/batch 77.55 | loss  3.00 | ppl    20.03 
| epoch  63 |   200/  216 batches | lr 0.00000 | ms/batch 76.14 | loss  2.94 | ppl    18.83 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 17.08s | valid loss  4.17 | valid ppl    64.65 | valid bpc    6.015
-----------------------------------------------------------------------------------------
PROGRESS: 63.0%
| epoch  64 |   100/  216 batches | lr 0.00000 | ms/batch 77.18 | loss  2.97 | ppl    19.55 
| epoch  64 |   200/  216 batches | lr 0.00000 | ms/batch 76.65 | loss  2.96 | ppl    19.30 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 17.08s | valid loss  4.19 | valid ppl    66.05 | valid bpc    6.045
-----------------------------------------------------------------------------------------
PROGRESS: 64.0%
| epoch  65 |   100/  216 batches | lr 0.00000 | ms/batch 77.70 | loss  2.96 | ppl    19.25 
| epoch  65 |   200/  216 batches | lr 0.00000 | ms/batch 76.07 | loss  2.96 | ppl    19.27 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 17.08s | valid loss  4.18 | valid ppl    65.26 | valid bpc    6.028
-----------------------------------------------------------------------------------------
PROGRESS: 65.0%
| epoch  66 |   100/  216 batches | lr 0.00000 | ms/batch 77.73 | loss  2.99 | ppl    19.84 
| epoch  66 |   200/  216 batches | lr 0.00000 | ms/batch 76.22 | loss  2.92 | ppl    18.52 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 17.08s | valid loss  4.14 | valid ppl    63.00 | valid bpc    5.977
-----------------------------------------------------------------------------------------
PROGRESS: 66.0%
| epoch  67 |   100/  216 batches | lr 0.00000 | ms/batch 77.49 | loss  2.99 | ppl    19.83 
| epoch  67 |   200/  216 batches | lr 0.00000 | ms/batch 76.10 | loss  2.94 | ppl    18.92 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 17.08s | valid loss  4.18 | valid ppl    65.40 | valid bpc    6.031
-----------------------------------------------------------------------------------------
PROGRESS: 67.0%
| epoch  68 |   100/  216 batches | lr 0.00000 | ms/batch 77.36 | loss  2.97 | ppl    19.45 
| epoch  68 |   200/  216 batches | lr 0.00000 | ms/batch 76.54 | loss  2.95 | ppl    19.08 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 17.08s | valid loss  4.14 | valid ppl    62.51 | valid bpc    5.966
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 68.0%
| epoch  69 |   100/  216 batches | lr 0.00000 | ms/batch 77.70 | loss  2.98 | ppl    19.71 
| epoch  69 |   200/  216 batches | lr 0.00000 | ms/batch 76.08 | loss  2.93 | ppl    18.80 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 17.08s | valid loss  4.22 | valid ppl    68.20 | valid bpc    6.092
-----------------------------------------------------------------------------------------
PROGRESS: 69.0%
| epoch  70 |   100/  216 batches | lr 0.00000 | ms/batch 77.38 | loss  2.96 | ppl    19.35 
| epoch  70 |   200/  216 batches | lr 0.00000 | ms/batch 76.30 | loss  2.95 | ppl    19.14 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 17.08s | valid loss  4.19 | valid ppl    66.02 | valid bpc    6.045
-----------------------------------------------------------------------------------------
PROGRESS: 70.0%
| epoch  71 |   100/  216 batches | lr 0.00000 | ms/batch 77.34 | loss  2.95 | ppl    19.17 
| epoch  71 |   200/  216 batches | lr 0.00000 | ms/batch 76.48 | loss  2.95 | ppl    19.14 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 17.09s | valid loss  4.22 | valid ppl    68.28 | valid bpc    6.093
-----------------------------------------------------------------------------------------
PROGRESS: 71.0%
| epoch  72 |   100/  216 batches | lr 0.00000 | ms/batch 77.64 | loss  2.97 | ppl    19.40 
| epoch  72 |   200/  216 batches | lr 0.00000 | ms/batch 76.03 | loss  2.95 | ppl    19.10 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 17.07s | valid loss  4.18 | valid ppl    65.24 | valid bpc    6.028
-----------------------------------------------------------------------------------------
PROGRESS: 72.0%
| epoch  73 |   100/  216 batches | lr 0.00000 | ms/batch 77.30 | loss  2.97 | ppl    19.58 
| epoch  73 |   200/  216 batches | lr 0.00000 | ms/batch 76.49 | loss  2.93 | ppl    18.81 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 17.08s | valid loss  4.20 | valid ppl    66.63 | valid bpc    6.058
-----------------------------------------------------------------------------------------
PROGRESS: 73.0%
| epoch  74 |   100/  216 batches | lr 0.00000 | ms/batch 77.44 | loss  2.97 | ppl    19.40 
| epoch  74 |   200/  216 batches | lr 0.00000 | ms/batch 76.34 | loss  2.93 | ppl    18.67 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 17.08s | valid loss  4.14 | valid ppl    62.50 | valid bpc    5.966
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 74.0%
| epoch  75 |   100/  216 batches | lr 0.00000 | ms/batch 77.62 | loss  2.97 | ppl    19.45 
| epoch  75 |   200/  216 batches | lr 0.00000 | ms/batch 76.10 | loss  2.94 | ppl    18.92 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 17.07s | valid loss  4.19 | valid ppl    66.21 | valid bpc    6.049
-----------------------------------------------------------------------------------------
PROGRESS: 75.0%
| epoch  76 |   100/  216 batches | lr 0.00000 | ms/batch 77.47 | loss  2.95 | ppl    19.16 
| epoch  76 |   200/  216 batches | lr 0.00000 | ms/batch 76.36 | loss  2.95 | ppl    19.18 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 17.08s | valid loss  4.20 | valid ppl    66.78 | valid bpc    6.061
-----------------------------------------------------------------------------------------
PROGRESS: 76.0%
| epoch  77 |   100/  216 batches | lr 0.00000 | ms/batch 77.71 | loss  2.98 | ppl    19.76 
| epoch  77 |   200/  216 batches | lr 0.00000 | ms/batch 76.07 | loss  2.94 | ppl    18.94 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 17.08s | valid loss  4.16 | valid ppl    64.16 | valid bpc    6.004
-----------------------------------------------------------------------------------------
PROGRESS: 77.0%
| epoch  78 |   100/  216 batches | lr 0.00000 | ms/batch 77.95 | loss  3.00 | ppl    20.08 
| epoch  78 |   200/  216 batches | lr 0.00000 | ms/batch 75.71 | loss  2.95 | ppl    19.06 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 17.08s | valid loss  4.20 | valid ppl    66.67 | valid bpc    6.059
-----------------------------------------------------------------------------------------
PROGRESS: 78.0%
| epoch  79 |   100/  216 batches | lr 0.00000 | ms/batch 77.38 | loss  2.97 | ppl    19.57 
| epoch  79 |   200/  216 batches | lr 0.00000 | ms/batch 76.39 | loss  2.97 | ppl    19.50 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 17.08s | valid loss  4.20 | valid ppl    66.40 | valid bpc    6.053
-----------------------------------------------------------------------------------------
PROGRESS: 79.0%
| epoch  80 |   100/  216 batches | lr 0.00000 | ms/batch 77.51 | loss  2.99 | ppl    19.79 
| epoch  80 |   200/  216 batches | lr 0.00000 | ms/batch 76.21 | loss  2.92 | ppl    18.51 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 17.08s | valid loss  4.18 | valid ppl    65.43 | valid bpc    6.032
-----------------------------------------------------------------------------------------
PROGRESS: 80.0%
| epoch  81 |   100/  216 batches | lr 0.00000 | ms/batch 77.24 | loss  2.98 | ppl    19.66 
| epoch  81 |   200/  216 batches | lr 0.00000 | ms/batch 76.46 | loss  2.94 | ppl    19.00 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 17.08s | valid loss  4.17 | valid ppl    64.57 | valid bpc    6.013
-----------------------------------------------------------------------------------------
PROGRESS: 81.0%
| epoch  82 |   100/  216 batches | lr 0.00000 | ms/batch 77.92 | loss  2.96 | ppl    19.27 
| epoch  82 |   200/  216 batches | lr 0.00000 | ms/batch 75.93 | loss  2.95 | ppl    19.07 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 17.08s | valid loss  4.18 | valid ppl    65.17 | valid bpc    6.026
-----------------------------------------------------------------------------------------
PROGRESS: 82.0%
| epoch  83 |   100/  216 batches | lr 0.00000 | ms/batch 77.20 | loss  2.96 | ppl    19.30 
| epoch  83 |   200/  216 batches | lr 0.00000 | ms/batch 76.67 | loss  2.95 | ppl    19.03 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 17.08s | valid loss  4.21 | valid ppl    67.54 | valid bpc    6.078
-----------------------------------------------------------------------------------------
PROGRESS: 83.0%
| epoch  84 |   100/  216 batches | lr 0.00000 | ms/batch 77.96 | loss  2.97 | ppl    19.41 
| epoch  84 |   200/  216 batches | lr 0.00000 | ms/batch 75.83 | loss  2.93 | ppl    18.81 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 17.08s | valid loss  4.14 | valid ppl    62.49 | valid bpc    5.966
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 84.0%
| epoch  85 |   100/  216 batches | lr 0.00000 | ms/batch 77.26 | loss  2.98 | ppl    19.60 
| epoch  85 |   200/  216 batches | lr 0.00000 | ms/batch 76.39 | loss  2.94 | ppl    18.84 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 17.07s | valid loss  4.19 | valid ppl    66.10 | valid bpc    6.047
-----------------------------------------------------------------------------------------
PROGRESS: 85.0%
| epoch  86 |   100/  216 batches | lr 0.00000 | ms/batch 77.62 | loss  2.97 | ppl    19.49 
| epoch  86 |   200/  216 batches | lr 0.00000 | ms/batch 76.05 | loss  2.93 | ppl    18.82 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 17.07s | valid loss  4.21 | valid ppl    67.22 | valid bpc    6.071
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  216 batches | lr 0.00000 | ms/batch 77.39 | loss  2.96 | ppl    19.24 
| epoch  87 |   200/  216 batches | lr 0.00000 | ms/batch 76.31 | loss  2.94 | ppl    18.94 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 17.08s | valid loss  4.19 | valid ppl    66.17 | valid bpc    6.048
-----------------------------------------------------------------------------------------
PROGRESS: 87.0%
| epoch  88 |   100/  216 batches | lr 0.00000 | ms/batch 77.30 | loss  2.96 | ppl    19.32 
| epoch  88 |   200/  216 batches | lr 0.00000 | ms/batch 76.42 | loss  2.94 | ppl    18.88 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 17.08s | valid loss  4.19 | valid ppl    66.21 | valid bpc    6.049
-----------------------------------------------------------------------------------------
PROGRESS: 88.0%
| epoch  89 |   100/  216 batches | lr 0.00000 | ms/batch 77.66 | loss  2.97 | ppl    19.57 
| epoch  89 |   200/  216 batches | lr 0.00000 | ms/batch 76.14 | loss  2.93 | ppl    18.63 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 17.08s | valid loss  4.19 | valid ppl    66.15 | valid bpc    6.048
-----------------------------------------------------------------------------------------
PROGRESS: 89.0%
| epoch  90 |   100/  216 batches | lr 0.00000 | ms/batch 77.46 | loss  2.98 | ppl    19.61 
| epoch  90 |   200/  216 batches | lr 0.00000 | ms/batch 76.27 | loss  2.95 | ppl    19.12 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 17.08s | valid loss  4.16 | valid ppl    64.29 | valid bpc    6.006
-----------------------------------------------------------------------------------------
PROGRESS: 90.0%
| epoch  91 |   100/  216 batches | lr 0.00000 | ms/batch 77.52 | loss  2.97 | ppl    19.48 
| epoch  91 |   200/  216 batches | lr 0.00000 | ms/batch 76.43 | loss  2.95 | ppl    19.12 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 17.09s | valid loss  4.19 | valid ppl    65.70 | valid bpc    6.038
-----------------------------------------------------------------------------------------
PROGRESS: 91.0%
| epoch  92 |   100/  216 batches | lr 0.00000 | ms/batch 77.13 | loss  2.97 | ppl    19.46 
| epoch  92 |   200/  216 batches | lr 0.00000 | ms/batch 76.69 | loss  2.95 | ppl    19.10 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 17.08s | valid loss  4.15 | valid ppl    63.63 | valid bpc    5.992
-----------------------------------------------------------------------------------------
PROGRESS: 92.0%
| epoch  93 |   100/  216 batches | lr 0.00000 | ms/batch 77.75 | loss  2.97 | ppl    19.55 
| epoch  93 |   200/  216 batches | lr 0.00000 | ms/batch 76.02 | loss  2.95 | ppl    19.09 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 17.08s | valid loss  4.17 | valid ppl    65.04 | valid bpc    6.023
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  216 batches | lr 0.00000 | ms/batch 77.82 | loss  2.99 | ppl    19.94 
| epoch  94 |   200/  216 batches | lr 0.00000 | ms/batch 76.03 | loss  2.93 | ppl    18.69 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 17.08s | valid loss  4.18 | valid ppl    65.26 | valid bpc    6.028
-----------------------------------------------------------------------------------------
PROGRESS: 94.0%
| epoch  95 |   100/  216 batches | lr 0.00000 | ms/batch 77.27 | loss  2.96 | ppl    19.28 
| epoch  95 |   200/  216 batches | lr 0.00000 | ms/batch 76.24 | loss  2.96 | ppl    19.21 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 17.08s | valid loss  4.17 | valid ppl    64.96 | valid bpc    6.021
-----------------------------------------------------------------------------------------
PROGRESS: 95.0%
| epoch  96 |   100/  216 batches | lr 0.00000 | ms/batch 77.39 | loss  2.97 | ppl    19.46 
| epoch  96 |   200/  216 batches | lr 0.00000 | ms/batch 76.40 | loss  2.94 | ppl    18.85 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 17.08s | valid loss  4.16 | valid ppl    63.88 | valid bpc    5.997
-----------------------------------------------------------------------------------------
PROGRESS: 96.0%
| epoch  97 |   100/  216 batches | lr 0.00000 | ms/batch 77.57 | loss  2.97 | ppl    19.44 
| epoch  97 |   200/  216 batches | lr 0.00000 | ms/batch 76.20 | loss  2.97 | ppl    19.42 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 17.08s | valid loss  4.21 | valid ppl    67.27 | valid bpc    6.072
-----------------------------------------------------------------------------------------
PROGRESS: 97.0%
| epoch  98 |   100/  216 batches | lr 0.00000 | ms/batch 77.82 | loss  2.96 | ppl    19.39 
| epoch  98 |   200/  216 batches | lr 0.00000 | ms/batch 76.08 | loss  2.92 | ppl    18.63 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 17.09s | valid loss  4.17 | valid ppl    64.88 | valid bpc    6.020
-----------------------------------------------------------------------------------------
PROGRESS: 98.0%
| epoch  99 |   100/  216 batches | lr 0.00000 | ms/batch 77.55 | loss  2.95 | ppl    19.19 
| epoch  99 |   200/  216 batches | lr 0.00000 | ms/batch 75.95 | loss  2.96 | ppl    19.36 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 17.08s | valid loss  4.20 | valid ppl    66.67 | valid bpc    6.059
-----------------------------------------------------------------------------------------
PROGRESS: 99.0%
| epoch 100 |   100/  216 batches | lr 0.00000 | ms/batch 77.25 | loss  2.96 | ppl    19.31 
| epoch 100 |   200/  216 batches | lr 0.00000 | ms/batch 76.22 | loss  2.92 | ppl    18.62 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 17.08s | valid loss  4.16 | valid ppl    63.79 | valid bpc    5.995
-----------------------------------------------------------------------------------------
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  4.13 | test ppl    62.00 | test bpc    5.954
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.4929, Mean Reca: 0.6756, Mean F1: 0.5614
Counter({'NP': 9595, 'VP': 4634, 'PP': 4427, 'S': 3831, 'SBAR': 1043, 'QP': 280, 'ADJP': 245, 'ADVP': 158, 'SINV': 149, 'PRN': 61, 'NX': 45, 'FRAG': 34, 'WHNP': 27, 'SQ': 15, 'NAC': 13, 'WHPP': 11, 'UCP': 9, 'SBARQ': 9, 'CONJP': 3, 'X': 2, 'WHADVP': 1})
Counter({'NP': 14432, 'VP': 8130, 'S': 5620, 'PP': 5484, 'SBAR': 1796, 'ADJP': 649, 'QP': 490, 'ADVP': 286, 'SINV': 157, 'PRN': 128, 'NX': 95, 'FRAG': 42, 'WHNP': 37, 'UCP': 32, 'NAC': 30, 'WHPP': 25, 'CONJP': 21, 'SQ': 18, 'SBARQ': 10, 'WHADVP': 9, 'X': 6, 'WHADJP': 4, 'INTJ': 1})
SBAR: 0.5807
NP: 0.6648
VP: 0.5700
PP: 0.8073
ADJP: 0.3775
ADVP: 0.5524
5.219699324192544
-----------------------------------------------------------------------------------------
Dependency parsing performance:
Conll-U Style:
DDA: 0.051
UDA: 0.316
=========================================================================================
Loading dataset...
Loading dictionary...
Number of tokens:  10001
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer_in_parser', nhid=512, nlayers=8, front_layers=3, rear_layers=5, n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=4444, nonmono=5, cuda=True, log_interval=100, save='trained_models/structformer_in_parser_4444_35.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 38475621
Model architecture: StructFormer_In_Parser(
  (transformer_front): Transformer_Front(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(10001, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-2): 3 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
  (transformer_rear): Transformer_Rear(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(10001, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-4): 5 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (output_layer): Linear(in_features=512, out_features=10001, bias=True)
  )
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  216 batches | lr 0.00030 | ms/batch 79.82 | loss  7.29 | ppl  1469.40 
| epoch   1 |   200/  216 batches | lr 0.00030 | ms/batch 75.68 | loss  6.85 | ppl   939.29 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 17.23s | valid loss  6.66 | valid ppl   780.46 | valid bpc    9.608
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  216 batches | lr 0.00030 | ms/batch 76.66 | loss  6.71 | ppl   819.39 
| epoch   2 |   200/  216 batches | lr 0.00030 | ms/batch 75.87 | loss  6.46 | ppl   640.39 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 16.95s | valid loss  6.26 | valid ppl   522.20 | valid bpc    9.028
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  216 batches | lr 0.00030 | ms/batch 77.37 | loss  6.28 | ppl   532.24 
| epoch   3 |   200/  216 batches | lr 0.00030 | ms/batch 75.55 | loss  5.98 | ppl   396.67 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 16.99s | valid loss  5.77 | valid ppl   321.02 | valid bpc    8.327
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  216 batches | lr 0.00030 | ms/batch 77.05 | loss  5.81 | ppl   332.62 
| epoch   4 |   200/  216 batches | lr 0.00030 | ms/batch 75.93 | loss  5.63 | ppl   279.33 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 17.02s | valid loss  5.51 | valid ppl   248.37 | valid bpc    7.956
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  216 batches | lr 0.00030 | ms/batch 77.01 | loss  5.51 | ppl   246.82 
| epoch   5 |   200/  216 batches | lr 0.00030 | ms/batch 76.41 | loss  5.39 | ppl   218.67 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 17.04s | valid loss  5.29 | valid ppl   198.96 | valid bpc    7.636
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  216 batches | lr 0.00030 | ms/batch 77.25 | loss  5.30 | ppl   200.77 
| epoch   6 |   200/  216 batches | lr 0.00030 | ms/batch 76.42 | loss  5.21 | ppl   183.81 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 17.07s | valid loss  5.15 | valid ppl   172.84 | valid bpc    7.433
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  216 batches | lr 0.00030 | ms/batch 77.77 | loss  5.17 | ppl   176.18 
| epoch   7 |   200/  216 batches | lr 0.00030 | ms/batch 76.13 | loss  5.06 | ppl   157.04 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 17.07s | valid loss  5.05 | valid ppl   156.08 | valid bpc    7.286
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  216 batches | lr 0.00030 | ms/batch 77.65 | loss  5.00 | ppl   148.65 
| epoch   8 |   200/  216 batches | lr 0.00030 | ms/batch 75.91 | loss  4.93 | ppl   137.75 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 17.06s | valid loss  4.95 | valid ppl   140.50 | valid bpc    7.134
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 8.0%
| epoch   9 |   100/  216 batches | lr 0.00030 | ms/batch 77.45 | loss  4.92 | ppl   137.34 
| epoch   9 |   200/  216 batches | lr 0.00030 | ms/batch 76.28 | loss  4.81 | ppl   122.66 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 17.08s | valid loss  4.88 | valid ppl   131.04 | valid bpc    7.034
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  216 batches | lr 0.00030 | ms/batch 77.56 | loss  4.81 | ppl   122.47 
| epoch  10 |   200/  216 batches | lr 0.00030 | ms/batch 76.03 | loss  4.72 | ppl   111.79 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 17.06s | valid loss  4.80 | valid ppl   121.10 | valid bpc    6.920
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  216 batches | lr 0.00030 | ms/batch 77.58 | loss  4.70 | ppl   110.02 
| epoch  11 |   200/  216 batches | lr 0.00030 | ms/batch 76.10 | loss  4.63 | ppl   102.40 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 17.07s | valid loss  4.68 | valid ppl   107.98 | valid bpc    6.755
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  216 batches | lr 0.00030 | ms/batch 77.40 | loss  4.57 | ppl    96.12 
| epoch  12 |   200/  216 batches | lr 0.00030 | ms/batch 76.42 | loss  4.55 | ppl    94.89 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 17.07s | valid loss  4.67 | valid ppl   106.56 | valid bpc    6.735
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 12.0%
| epoch  13 |   100/  216 batches | lr 0.00030 | ms/batch 77.74 | loss  4.51 | ppl    91.09 
| epoch  13 |   200/  216 batches | lr 0.00030 | ms/batch 75.83 | loss  4.48 | ppl    88.08 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 17.06s | valid loss  4.64 | valid ppl   103.49 | valid bpc    6.693
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 13.0%
| epoch  14 |   100/  216 batches | lr 0.00030 | ms/batch 77.83 | loss  4.45 | ppl    85.81 
| epoch  14 |   200/  216 batches | lr 0.00030 | ms/batch 75.79 | loss  4.40 | ppl    81.60 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 17.06s | valid loss  4.60 | valid ppl    99.60 | valid bpc    6.638
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  216 batches | lr 0.00030 | ms/batch 77.69 | loss  4.36 | ppl    78.62 
| epoch  15 |   200/  216 batches | lr 0.00030 | ms/batch 76.09 | loss  4.33 | ppl    76.22 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 17.07s | valid loss  4.52 | valid ppl    91.63 | valid bpc    6.518
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 15.0%
| epoch  16 |   100/  216 batches | lr 0.00030 | ms/batch 77.34 | loss  4.29 | ppl    72.90 
| epoch  16 |   200/  216 batches | lr 0.00030 | ms/batch 76.42 | loss  4.25 | ppl    70.40 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 17.07s | valid loss  4.52 | valid ppl    91.40 | valid bpc    6.514
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 16.0%
| epoch  17 |   100/  216 batches | lr 0.00030 | ms/batch 76.94 | loss  4.22 | ppl    68.22 
| epoch  17 |   200/  216 batches | lr 0.00030 | ms/batch 76.31 | loss  4.19 | ppl    65.84 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 17.07s | valid loss  4.48 | valid ppl    88.41 | valid bpc    6.466
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 17.0%
| epoch  18 |   100/  216 batches | lr 0.00030 | ms/batch 77.03 | loss  4.16 | ppl    64.24 
| epoch  18 |   200/  216 batches | lr 0.00030 | ms/batch 76.38 | loss  4.12 | ppl    61.70 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 17.07s | valid loss  4.44 | valid ppl    84.36 | valid bpc    6.398
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 18.0%
| epoch  19 |   100/  216 batches | lr 0.00030 | ms/batch 77.52 | loss  4.10 | ppl    60.63 
| epoch  19 |   200/  216 batches | lr 0.00030 | ms/batch 76.02 | loss  4.06 | ppl    58.14 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 17.06s | valid loss  4.44 | valid ppl    85.12 | valid bpc    6.411
-----------------------------------------------------------------------------------------
PROGRESS: 19.0%
| epoch  20 |   100/  216 batches | lr 0.00030 | ms/batch 77.34 | loss  4.04 | ppl    56.60 
| epoch  20 |   200/  216 batches | lr 0.00030 | ms/batch 76.28 | loss  4.04 | ppl    56.58 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 17.07s | valid loss  4.36 | valid ppl    77.89 | valid bpc    6.283
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 20.0%
| epoch  21 |   100/  216 batches | lr 0.00030 | ms/batch 77.14 | loss  3.99 | ppl    54.13 
| epoch  21 |   200/  216 batches | lr 0.00030 | ms/batch 76.21 | loss  3.97 | ppl    53.18 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 17.06s | valid loss  4.36 | valid ppl    78.64 | valid bpc    6.297
-----------------------------------------------------------------------------------------
PROGRESS: 21.0%
| epoch  22 |   100/  216 batches | lr 0.00030 | ms/batch 77.05 | loss  3.92 | ppl    50.49 
| epoch  22 |   200/  216 batches | lr 0.00030 | ms/batch 76.55 | loss  3.94 | ppl    51.50 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 17.06s | valid loss  4.35 | valid ppl    77.59 | valid bpc    6.278
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 22.0%
| epoch  23 |   100/  216 batches | lr 0.00030 | ms/batch 77.36 | loss  3.88 | ppl    48.40 
| epoch  23 |   200/  216 batches | lr 0.00030 | ms/batch 76.30 | loss  3.86 | ppl    47.62 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 17.07s | valid loss  4.35 | valid ppl    77.80 | valid bpc    6.282
-----------------------------------------------------------------------------------------
PROGRESS: 23.0%
| epoch  24 |   100/  216 batches | lr 0.00030 | ms/batch 77.14 | loss  3.86 | ppl    47.24 
| epoch  24 |   200/  216 batches | lr 0.00030 | ms/batch 76.76 | loss  3.81 | ppl    45.05 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 17.08s | valid loss  4.33 | valid ppl    75.65 | valid bpc    6.241
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 24.0%
| epoch  25 |   100/  216 batches | lr 0.00030 | ms/batch 77.10 | loss  3.78 | ppl    43.95 
| epoch  25 |   200/  216 batches | lr 0.00030 | ms/batch 76.57 | loss  3.78 | ppl    43.97 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 17.07s | valid loss  4.31 | valid ppl    74.27 | valid bpc    6.215
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 25.0%
| epoch  26 |   100/  216 batches | lr 0.00030 | ms/batch 77.05 | loss  3.74 | ppl    41.96 
| epoch  26 |   200/  216 batches | lr 0.00030 | ms/batch 76.64 | loss  3.75 | ppl    42.58 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 17.07s | valid loss  4.29 | valid ppl    72.87 | valid bpc    6.187
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 26.0%
| epoch  27 |   100/  216 batches | lr 0.00030 | ms/batch 77.64 | loss  3.73 | ppl    41.52 
| epoch  27 |   200/  216 batches | lr 0.00030 | ms/batch 75.98 | loss  3.69 | ppl    40.21 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 17.06s | valid loss  4.30 | valid ppl    73.76 | valid bpc    6.205
-----------------------------------------------------------------------------------------
PROGRESS: 27.0%
| epoch  28 |   100/  216 batches | lr 0.00030 | ms/batch 77.74 | loss  3.67 | ppl    39.42 
| epoch  28 |   200/  216 batches | lr 0.00030 | ms/batch 75.85 | loss  3.61 | ppl    37.14 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 17.07s | valid loss  4.30 | valid ppl    73.82 | valid bpc    6.206
-----------------------------------------------------------------------------------------
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  216 batches | lr 0.00030 | ms/batch 77.66 | loss  3.62 | ppl    37.41 
| epoch  29 |   200/  216 batches | lr 0.00030 | ms/batch 76.09 | loss  3.59 | ppl    36.35 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 17.07s | valid loss  4.24 | valid ppl    69.54 | valid bpc    6.120
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  216 batches | lr 0.00030 | ms/batch 77.23 | loss  3.56 | ppl    35.18 
| epoch  30 |   200/  216 batches | lr 0.00030 | ms/batch 76.26 | loss  3.57 | ppl    35.54 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 17.06s | valid loss  4.30 | valid ppl    73.77 | valid bpc    6.205
-----------------------------------------------------------------------------------------
PROGRESS: 30.0%
| epoch  31 |   100/  216 batches | lr 0.00030 | ms/batch 77.18 | loss  3.55 | ppl    34.65 
| epoch  31 |   200/  216 batches | lr 0.00030 | ms/batch 76.61 | loss  3.50 | ppl    33.15 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 17.07s | valid loss  4.30 | valid ppl    73.85 | valid bpc    6.207
-----------------------------------------------------------------------------------------
PROGRESS: 31.0%
| epoch  32 |   100/  216 batches | lr 0.00030 | ms/batch 77.04 | loss  3.49 | ppl    32.75 
| epoch  32 |   200/  216 batches | lr 0.00030 | ms/batch 76.86 | loss  3.50 | ppl    33.14 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 17.09s | valid loss  4.27 | valid ppl    71.76 | valid bpc    6.165
-----------------------------------------------------------------------------------------
PROGRESS: 32.0%
| epoch  33 |   100/  216 batches | lr 0.00015 | ms/batch 77.11 | loss  3.42 | ppl    30.62 
| epoch  33 |   200/  216 batches | lr 0.00015 | ms/batch 76.59 | loss  3.36 | ppl    28.92 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 17.08s | valid loss  4.20 | valid ppl    66.62 | valid bpc    6.058
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 33.0%
| epoch  34 |   100/  216 batches | lr 0.00015 | ms/batch 77.08 | loss  3.35 | ppl    28.36 
| epoch  34 |   200/  216 batches | lr 0.00015 | ms/batch 76.59 | loss  3.31 | ppl    27.51 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 17.07s | valid loss  4.23 | valid ppl    68.60 | valid bpc    6.100
-----------------------------------------------------------------------------------------
PROGRESS: 34.0%
| epoch  35 |   100/  216 batches | lr 0.00015 | ms/batch 77.40 | loss  3.32 | ppl    27.67 
| epoch  35 |   200/  216 batches | lr 0.00015 | ms/batch 76.30 | loss  3.28 | ppl    26.64 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 17.07s | valid loss  4.24 | valid ppl    69.15 | valid bpc    6.112
-----------------------------------------------------------------------------------------
PROGRESS: 35.0%
| epoch  36 |   100/  216 batches | lr 0.00015 | ms/batch 77.22 | loss  3.29 | ppl    26.72 
| epoch  36 |   200/  216 batches | lr 0.00015 | ms/batch 76.43 | loss  3.26 | ppl    26.16 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 17.07s | valid loss  4.23 | valid ppl    68.60 | valid bpc    6.100
-----------------------------------------------------------------------------------------
PROGRESS: 36.0%
| epoch  37 |   100/  216 batches | lr 0.00007 | ms/batch 77.61 | loss  3.25 | ppl    25.74 
| epoch  37 |   200/  216 batches | lr 0.00007 | ms/batch 76.16 | loss  3.19 | ppl    24.20 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 17.08s | valid loss  4.17 | valid ppl    64.63 | valid bpc    6.014
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 37.0%
| epoch  38 |   100/  216 batches | lr 0.00007 | ms/batch 77.87 | loss  3.20 | ppl    24.46 
| epoch  38 |   200/  216 batches | lr 0.00007 | ms/batch 75.90 | loss  3.17 | ppl    23.74 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 17.06s | valid loss  4.24 | valid ppl    69.65 | valid bpc    6.122
-----------------------------------------------------------------------------------------
PROGRESS: 38.0%
| epoch  39 |   100/  216 batches | lr 0.00007 | ms/batch 77.51 | loss  3.17 | ppl    23.92 
| epoch  39 |   200/  216 batches | lr 0.00007 | ms/batch 76.25 | loss  3.15 | ppl    23.28 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 17.07s | valid loss  4.19 | valid ppl    65.97 | valid bpc    6.044
-----------------------------------------------------------------------------------------
PROGRESS: 39.0%
| epoch  40 |   100/  216 batches | lr 0.00007 | ms/batch 77.21 | loss  3.15 | ppl    23.30 
| epoch  40 |   200/  216 batches | lr 0.00007 | ms/batch 76.33 | loss  3.12 | ppl    22.70 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 17.07s | valid loss  4.19 | valid ppl    65.91 | valid bpc    6.042
-----------------------------------------------------------------------------------------
PROGRESS: 40.0%
| epoch  41 |   100/  216 batches | lr 0.00004 | ms/batch 77.45 | loss  3.13 | ppl    22.90 
| epoch  41 |   200/  216 batches | lr 0.00004 | ms/batch 75.80 | loss  3.10 | ppl    22.21 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 17.08s | valid loss  4.21 | valid ppl    67.15 | valid bpc    6.069
-----------------------------------------------------------------------------------------
PROGRESS: 41.0%
| epoch  42 |   100/  216 batches | lr 0.00004 | ms/batch 77.50 | loss  3.13 | ppl    22.88 
| epoch  42 |   200/  216 batches | lr 0.00004 | ms/batch 76.15 | loss  3.06 | ppl    21.43 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 17.07s | valid loss  4.21 | valid ppl    67.67 | valid bpc    6.080
-----------------------------------------------------------------------------------------
PROGRESS: 42.0%
| epoch  43 |   100/  216 batches | lr 0.00004 | ms/batch 77.67 | loss  3.11 | ppl    22.52 
| epoch  43 |   200/  216 batches | lr 0.00004 | ms/batch 76.17 | loss  3.07 | ppl    21.59 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 17.08s | valid loss  4.18 | valid ppl    65.67 | valid bpc    6.037
-----------------------------------------------------------------------------------------
PROGRESS: 43.0%
| epoch  44 |   100/  216 batches | lr 0.00002 | ms/batch 77.66 | loss  3.08 | ppl    21.77 
| epoch  44 |   200/  216 batches | lr 0.00002 | ms/batch 75.98 | loss  3.07 | ppl    21.50 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 17.08s | valid loss  4.21 | valid ppl    67.15 | valid bpc    6.069
-----------------------------------------------------------------------------------------
PROGRESS: 44.0%
| epoch  45 |   100/  216 batches | lr 0.00002 | ms/batch 77.31 | loss  3.09 | ppl    21.91 
| epoch  45 |   200/  216 batches | lr 0.00002 | ms/batch 76.38 | loss  3.06 | ppl    21.31 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 17.07s | valid loss  4.21 | valid ppl    67.23 | valid bpc    6.071
-----------------------------------------------------------------------------------------
PROGRESS: 45.0%
| epoch  46 |   100/  216 batches | lr 0.00002 | ms/batch 77.52 | loss  3.08 | ppl    21.74 
| epoch  46 |   200/  216 batches | lr 0.00002 | ms/batch 76.16 | loss  3.06 | ppl    21.23 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 17.07s | valid loss  4.17 | valid ppl    64.62 | valid bpc    6.014
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 46.0%
| epoch  47 |   100/  216 batches | lr 0.00002 | ms/batch 77.31 | loss  3.07 | ppl    21.63 
| epoch  47 |   200/  216 batches | lr 0.00002 | ms/batch 76.29 | loss  3.03 | ppl    20.68 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 17.07s | valid loss  4.17 | valid ppl    64.73 | valid bpc    6.016
-----------------------------------------------------------------------------------------
PROGRESS: 47.0%
| epoch  48 |   100/  216 batches | lr 0.00002 | ms/batch 77.44 | loss  3.05 | ppl    21.21 
| epoch  48 |   200/  216 batches | lr 0.00002 | ms/batch 76.06 | loss  3.04 | ppl    20.93 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 17.07s | valid loss  4.18 | valid ppl    65.15 | valid bpc    6.026
-----------------------------------------------------------------------------------------
PROGRESS: 48.0%
| epoch  49 |   100/  216 batches | lr 0.00002 | ms/batch 77.26 | loss  3.04 | ppl    20.97 
| epoch  49 |   200/  216 batches | lr 0.00002 | ms/batch 75.99 | loss  3.04 | ppl    20.83 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 17.06s | valid loss  4.15 | valid ppl    63.49 | valid bpc    5.989
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 49.0%
| epoch  50 |   100/  216 batches | lr 0.00002 | ms/batch 77.14 | loss  3.05 | ppl    21.10 
| epoch  50 |   200/  216 batches | lr 0.00002 | ms/batch 76.51 | loss  3.02 | ppl    20.54 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 17.06s | valid loss  4.11 | valid ppl    61.07 | valid bpc    5.932
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 50.0%
| epoch  51 |   100/  216 batches | lr 0.00002 | ms/batch 77.09 | loss  3.04 | ppl    20.83 
| epoch  51 |   200/  216 batches | lr 0.00002 | ms/batch 76.51 | loss  3.02 | ppl    20.42 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 17.06s | valid loss  4.16 | valid ppl    64.28 | valid bpc    6.006
-----------------------------------------------------------------------------------------
PROGRESS: 51.0%
| epoch  52 |   100/  216 batches | lr 0.00002 | ms/batch 77.40 | loss  3.07 | ppl    21.53 
| epoch  52 |   200/  216 batches | lr 0.00002 | ms/batch 76.26 | loss  3.01 | ppl    20.31 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 17.07s | valid loss  4.20 | valid ppl    66.49 | valid bpc    6.055
-----------------------------------------------------------------------------------------
PROGRESS: 52.0%
| epoch  53 |   100/  216 batches | lr 0.00002 | ms/batch 77.20 | loss  3.05 | ppl    21.02 
| epoch  53 |   200/  216 batches | lr 0.00002 | ms/batch 76.16 | loss  3.03 | ppl    20.66 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 17.07s | valid loss  4.14 | valid ppl    62.62 | valid bpc    5.969
-----------------------------------------------------------------------------------------
PROGRESS: 53.0%
| epoch  54 |   100/  216 batches | lr 0.00001 | ms/batch 77.46 | loss  3.04 | ppl    20.84 
| epoch  54 |   200/  216 batches | lr 0.00001 | ms/batch 76.35 | loss  3.02 | ppl    20.41 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 17.07s | valid loss  4.16 | valid ppl    64.29 | valid bpc    6.007
-----------------------------------------------------------------------------------------
PROGRESS: 54.0%
| epoch  55 |   100/  216 batches | lr 0.00001 | ms/batch 77.66 | loss  3.04 | ppl    20.92 
| epoch  55 |   200/  216 batches | lr 0.00001 | ms/batch 76.19 | loss  2.99 | ppl    19.83 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 17.08s | valid loss  4.17 | valid ppl    64.64 | valid bpc    6.014
-----------------------------------------------------------------------------------------
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  216 batches | lr 0.00001 | ms/batch 77.58 | loss  3.02 | ppl    20.54 
| epoch  56 |   200/  216 batches | lr 0.00001 | ms/batch 76.01 | loss  3.01 | ppl    20.26 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 17.07s | valid loss  4.16 | valid ppl    64.24 | valid bpc    6.005
-----------------------------------------------------------------------------------------
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  216 batches | lr 0.00000 | ms/batch 77.44 | loss  3.03 | ppl    20.71 
| epoch  57 |   200/  216 batches | lr 0.00000 | ms/batch 76.30 | loss  2.98 | ppl    19.60 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 17.07s | valid loss  4.18 | valid ppl    65.47 | valid bpc    6.033
-----------------------------------------------------------------------------------------
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  216 batches | lr 0.00000 | ms/batch 77.03 | loss  3.03 | ppl    20.64 
| epoch  58 |   200/  216 batches | lr 0.00000 | ms/batch 76.53 | loss  2.99 | ppl    19.95 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 17.07s | valid loss  4.16 | valid ppl    64.28 | valid bpc    6.006
-----------------------------------------------------------------------------------------
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  216 batches | lr 0.00000 | ms/batch 77.26 | loss  3.01 | ppl    20.36 
| epoch  59 |   200/  216 batches | lr 0.00000 | ms/batch 76.41 | loss  2.98 | ppl    19.78 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 17.07s | valid loss  4.19 | valid ppl    65.95 | valid bpc    6.043
-----------------------------------------------------------------------------------------
PROGRESS: 59.0%
| epoch  60 |   100/  216 batches | lr 0.00000 | ms/batch 77.58 | loss  3.00 | ppl    20.14 
| epoch  60 |   200/  216 batches | lr 0.00000 | ms/batch 76.07 | loss  3.01 | ppl    20.28 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 17.07s | valid loss  4.19 | valid ppl    65.91 | valid bpc    6.042
-----------------------------------------------------------------------------------------
PROGRESS: 60.0%
| epoch  61 |   100/  216 batches | lr 0.00000 | ms/batch 77.46 | loss  3.02 | ppl    20.42 
| epoch  61 |   200/  216 batches | lr 0.00000 | ms/batch 76.30 | loss  2.98 | ppl    19.71 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 17.08s | valid loss  4.16 | valid ppl    64.09 | valid bpc    6.002
-----------------------------------------------------------------------------------------
PROGRESS: 61.0%
| epoch  62 |   100/  216 batches | lr 0.00000 | ms/batch 77.15 | loss  3.03 | ppl    20.75 
| epoch  62 |   200/  216 batches | lr 0.00000 | ms/batch 76.21 | loss  2.99 | ppl    19.93 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 17.08s | valid loss  4.16 | valid ppl    64.02 | valid bpc    6.001
-----------------------------------------------------------------------------------------
PROGRESS: 62.0%
| epoch  63 |   100/  216 batches | lr 0.00000 | ms/batch 76.95 | loss  3.02 | ppl    20.43 
| epoch  63 |   200/  216 batches | lr 0.00000 | ms/batch 76.83 | loss  3.00 | ppl    20.14 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 17.08s | valid loss  4.14 | valid ppl    62.88 | valid bpc    5.974
-----------------------------------------------------------------------------------------
PROGRESS: 63.0%
| epoch  64 |   100/  216 batches | lr 0.00000 | ms/batch 77.62 | loss  3.01 | ppl    20.19 
| epoch  64 |   200/  216 batches | lr 0.00000 | ms/batch 76.12 | loss  3.00 | ppl    20.15 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 17.08s | valid loss  4.20 | valid ppl    66.91 | valid bpc    6.064
-----------------------------------------------------------------------------------------
PROGRESS: 64.0%
| epoch  65 |   100/  216 batches | lr 0.00000 | ms/batch 77.37 | loss  3.02 | ppl    20.49 
| epoch  65 |   200/  216 batches | lr 0.00000 | ms/batch 76.39 | loss  2.97 | ppl    19.42 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 17.08s | valid loss  4.19 | valid ppl    66.19 | valid bpc    6.049
-----------------------------------------------------------------------------------------
PROGRESS: 65.0%
| epoch  66 |   100/  216 batches | lr 0.00000 | ms/batch 77.22 | loss  3.01 | ppl    20.30 
| epoch  66 |   200/  216 batches | lr 0.00000 | ms/batch 76.51 | loss  2.96 | ppl    19.22 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 17.08s | valid loss  4.18 | valid ppl    65.26 | valid bpc    6.028
-----------------------------------------------------------------------------------------
PROGRESS: 66.0%
| epoch  67 |   100/  216 batches | lr 0.00000 | ms/batch 77.70 | loss  3.02 | ppl    20.41 
| epoch  67 |   200/  216 batches | lr 0.00000 | ms/batch 75.98 | loss  2.97 | ppl    19.58 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 17.08s | valid loss  4.16 | valid ppl    64.38 | valid bpc    6.009
-----------------------------------------------------------------------------------------
PROGRESS: 67.0%
| epoch  68 |   100/  216 batches | lr 0.00000 | ms/batch 77.21 | loss  3.00 | ppl    20.05 
| epoch  68 |   200/  216 batches | lr 0.00000 | ms/batch 76.54 | loss  3.01 | ppl    20.23 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 17.09s | valid loss  4.17 | valid ppl    64.40 | valid bpc    6.009
-----------------------------------------------------------------------------------------
PROGRESS: 68.0%
| epoch  69 |   100/  216 batches | lr 0.00000 | ms/batch 77.47 | loss  3.02 | ppl    20.40 
| epoch  69 |   200/  216 batches | lr 0.00000 | ms/batch 76.11 | loss  2.99 | ppl    19.98 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 17.07s | valid loss  4.15 | valid ppl    63.27 | valid bpc    5.983
-----------------------------------------------------------------------------------------
PROGRESS: 69.0%
| epoch  70 |   100/  216 batches | lr 0.00000 | ms/batch 77.60 | loss  3.00 | ppl    20.00 
| epoch  70 |   200/  216 batches | lr 0.00000 | ms/batch 76.19 | loss  3.01 | ppl    20.35 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 17.08s | valid loss  4.19 | valid ppl    66.32 | valid bpc    6.051
-----------------------------------------------------------------------------------------
PROGRESS: 70.0%
| epoch  71 |   100/  216 batches | lr 0.00000 | ms/batch 77.18 | loss  3.01 | ppl    20.34 
| epoch  71 |   200/  216 batches | lr 0.00000 | ms/batch 76.23 | loss  2.98 | ppl    19.74 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 17.07s | valid loss  4.17 | valid ppl    64.58 | valid bpc    6.013
-----------------------------------------------------------------------------------------
PROGRESS: 71.0%
| epoch  72 |   100/  216 batches | lr 0.00000 | ms/batch 77.03 | loss  3.02 | ppl    20.51 
| epoch  72 |   200/  216 batches | lr 0.00000 | ms/batch 76.26 | loss  2.99 | ppl    19.80 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 17.07s | valid loss  4.20 | valid ppl    66.38 | valid bpc    6.053
-----------------------------------------------------------------------------------------
PROGRESS: 72.0%
| epoch  73 |   100/  216 batches | lr 0.00000 | ms/batch 77.34 | loss  3.01 | ppl    20.21 
| epoch  73 |   200/  216 batches | lr 0.00000 | ms/batch 76.42 | loss  2.98 | ppl    19.68 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 17.07s | valid loss  4.19 | valid ppl    65.75 | valid bpc    6.039
-----------------------------------------------------------------------------------------
PROGRESS: 73.0%
| epoch  74 |   100/  216 batches | lr 0.00000 | ms/batch 77.61 | loss  3.01 | ppl    20.24 
| epoch  74 |   200/  216 batches | lr 0.00000 | ms/batch 76.18 | loss  2.99 | ppl    19.93 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 17.08s | valid loss  4.16 | valid ppl    63.92 | valid bpc    5.998
-----------------------------------------------------------------------------------------
PROGRESS: 74.0%
| epoch  75 |   100/  216 batches | lr 0.00000 | ms/batch 77.54 | loss  3.01 | ppl    20.21 
| epoch  75 |   200/  216 batches | lr 0.00000 | ms/batch 76.33 | loss  2.99 | ppl    19.94 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 17.08s | valid loss  4.16 | valid ppl    64.34 | valid bpc    6.008
-----------------------------------------------------------------------------------------
PROGRESS: 75.0%
| epoch  76 |   100/  216 batches | lr 0.00000 | ms/batch 78.01 | loss  3.01 | ppl    20.37 
| epoch  76 |   200/  216 batches | lr 0.00000 | ms/batch 75.82 | loss  2.98 | ppl    19.76 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 17.08s | valid loss  4.19 | valid ppl    66.16 | valid bpc    6.048
-----------------------------------------------------------------------------------------
PROGRESS: 76.0%
| epoch  77 |   100/  216 batches | lr 0.00000 | ms/batch 77.89 | loss  3.02 | ppl    20.49 
| epoch  77 |   200/  216 batches | lr 0.00000 | ms/batch 75.89 | loss  2.99 | ppl    19.83 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 17.08s | valid loss  4.20 | valid ppl    66.88 | valid bpc    6.063
-----------------------------------------------------------------------------------------
PROGRESS: 77.0%
| epoch  78 |   100/  216 batches | lr 0.00000 | ms/batch 77.19 | loss  3.02 | ppl    20.54 
| epoch  78 |   200/  216 batches | lr 0.00000 | ms/batch 76.43 | loss  2.97 | ppl    19.56 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 17.07s | valid loss  4.10 | valid ppl    60.52 | valid bpc    5.919
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 78.0%
| epoch  79 |   100/  216 batches | lr 0.00000 | ms/batch 77.86 | loss  3.04 | ppl    20.88 
| epoch  79 |   200/  216 batches | lr 0.00000 | ms/batch 76.01 | loss  2.97 | ppl    19.41 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 17.09s | valid loss  4.15 | valid ppl    63.70 | valid bpc    5.993
-----------------------------------------------------------------------------------------
PROGRESS: 79.0%
| epoch  80 |   100/  216 batches | lr 0.00000 | ms/batch 77.19 | loss  3.00 | ppl    20.03 
| epoch  80 |   200/  216 batches | lr 0.00000 | ms/batch 76.36 | loss  3.00 | ppl    20.00 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 17.06s | valid loss  4.21 | valid ppl    67.22 | valid bpc    6.071
-----------------------------------------------------------------------------------------
PROGRESS: 80.0%
| epoch  81 |   100/  216 batches | lr 0.00000 | ms/batch 77.04 | loss  3.02 | ppl    20.51 
| epoch  81 |   200/  216 batches | lr 0.00000 | ms/batch 76.26 | loss  2.96 | ppl    19.32 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 17.06s | valid loss  4.15 | valid ppl    63.26 | valid bpc    5.983
-----------------------------------------------------------------------------------------
PROGRESS: 81.0%
| epoch  82 |   100/  216 batches | lr 0.00000 | ms/batch 77.77 | loss  3.04 | ppl    20.83 
| epoch  82 |   200/  216 batches | lr 0.00000 | ms/batch 75.95 | loss  2.97 | ppl    19.52 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 17.07s | valid loss  4.13 | valid ppl    62.49 | valid bpc    5.965
-----------------------------------------------------------------------------------------
PROGRESS: 82.0%
| epoch  83 |   100/  216 batches | lr 0.00000 | ms/batch 77.39 | loss  3.00 | ppl    20.16 
| epoch  83 |   200/  216 batches | lr 0.00000 | ms/batch 76.31 | loss  3.00 | ppl    20.06 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 17.07s | valid loss  4.13 | valid ppl    62.46 | valid bpc    5.965
-----------------------------------------------------------------------------------------
PROGRESS: 83.0%
| epoch  84 |   100/  216 batches | lr 0.00000 | ms/batch 77.29 | loss  3.01 | ppl    20.19 
| epoch  84 |   200/  216 batches | lr 0.00000 | ms/batch 76.42 | loss  3.00 | ppl    20.11 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 17.08s | valid loss  4.21 | valid ppl    67.19 | valid bpc    6.070
-----------------------------------------------------------------------------------------
PROGRESS: 84.0%
| epoch  85 |   100/  216 batches | lr 0.00000 | ms/batch 77.61 | loss  3.00 | ppl    20.04 
| epoch  85 |   200/  216 batches | lr 0.00000 | ms/batch 76.07 | loss  2.99 | ppl    19.92 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 17.07s | valid loss  4.18 | valid ppl    65.05 | valid bpc    6.024
-----------------------------------------------------------------------------------------
PROGRESS: 85.0%
| epoch  86 |   100/  216 batches | lr 0.00000 | ms/batch 77.51 | loss  3.01 | ppl    20.35 
| epoch  86 |   200/  216 batches | lr 0.00000 | ms/batch 76.02 | loss  2.97 | ppl    19.59 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 17.07s | valid loss  4.22 | valid ppl    67.79 | valid bpc    6.083
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  216 batches | lr 0.00000 | ms/batch 77.34 | loss  3.03 | ppl    20.65 
| epoch  87 |   200/  216 batches | lr 0.00000 | ms/batch 76.36 | loss  2.98 | ppl    19.69 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 17.08s | valid loss  4.19 | valid ppl    66.12 | valid bpc    6.047
-----------------------------------------------------------------------------------------
PROGRESS: 87.0%
| epoch  88 |   100/  216 batches | lr 0.00000 | ms/batch 77.43 | loss  3.01 | ppl    20.36 
| epoch  88 |   200/  216 batches | lr 0.00000 | ms/batch 76.40 | loss  2.98 | ppl    19.76 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 17.08s | valid loss  4.15 | valid ppl    63.39 | valid bpc    5.986
-----------------------------------------------------------------------------------------
PROGRESS: 88.0%
| epoch  89 |   100/  216 batches | lr 0.00000 | ms/batch 77.22 | loss  2.99 | ppl    19.94 
| epoch  89 |   200/  216 batches | lr 0.00000 | ms/batch 76.26 | loss  2.99 | ppl    19.81 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 17.08s | valid loss  4.15 | valid ppl    63.61 | valid bpc    5.991
-----------------------------------------------------------------------------------------
PROGRESS: 89.0%
| epoch  90 |   100/  216 batches | lr 0.00000 | ms/batch 77.72 | loss  3.01 | ppl    20.32 
| epoch  90 |   200/  216 batches | lr 0.00000 | ms/batch 75.99 | loss  2.99 | ppl    19.89 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 17.08s | valid loss  4.14 | valid ppl    62.54 | valid bpc    5.967
-----------------------------------------------------------------------------------------
PROGRESS: 90.0%
| epoch  91 |   100/  216 batches | lr 0.00000 | ms/batch 77.33 | loss  3.04 | ppl    20.81 
| epoch  91 |   200/  216 batches | lr 0.00000 | ms/batch 76.37 | loss  2.97 | ppl    19.58 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 17.07s | valid loss  4.17 | valid ppl    64.65 | valid bpc    6.015
-----------------------------------------------------------------------------------------
PROGRESS: 91.0%
| epoch  92 |   100/  216 batches | lr 0.00000 | ms/batch 77.34 | loss  3.00 | ppl    20.17 
| epoch  92 |   200/  216 batches | lr 0.00000 | ms/batch 76.46 | loss  3.01 | ppl    20.33 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 17.07s | valid loss  4.17 | valid ppl    64.92 | valid bpc    6.020
-----------------------------------------------------------------------------------------
PROGRESS: 92.0%
| epoch  93 |   100/  216 batches | lr 0.00000 | ms/batch 77.67 | loss  3.02 | ppl    20.43 
| epoch  93 |   200/  216 batches | lr 0.00000 | ms/batch 76.14 | loss  2.99 | ppl    19.97 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 17.07s | valid loss  4.16 | valid ppl    63.86 | valid bpc    5.997
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  216 batches | lr 0.00000 | ms/batch 77.57 | loss  3.02 | ppl    20.40 
| epoch  94 |   200/  216 batches | lr 0.00000 | ms/batch 76.23 | loss  2.99 | ppl    19.88 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 17.07s | valid loss  4.21 | valid ppl    67.13 | valid bpc    6.069
-----------------------------------------------------------------------------------------
PROGRESS: 94.0%
| epoch  95 |   100/  216 batches | lr 0.00000 | ms/batch 77.67 | loss  3.03 | ppl    20.62 
| epoch  95 |   200/  216 batches | lr 0.00000 | ms/batch 75.96 | loss  2.99 | ppl    19.84 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 17.07s | valid loss  4.18 | valid ppl    65.20 | valid bpc    6.027
-----------------------------------------------------------------------------------------
PROGRESS: 95.0%
| epoch  96 |   100/  216 batches | lr 0.00000 | ms/batch 77.66 | loss  3.01 | ppl    20.29 
| epoch  96 |   200/  216 batches | lr 0.00000 | ms/batch 76.01 | loss  2.97 | ppl    19.51 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 17.08s | valid loss  4.17 | valid ppl    64.67 | valid bpc    6.015
-----------------------------------------------------------------------------------------
PROGRESS: 96.0%
| epoch  97 |   100/  216 batches | lr 0.00000 | ms/batch 77.35 | loss  3.00 | ppl    20.13 
| epoch  97 |   200/  216 batches | lr 0.00000 | ms/batch 76.25 | loss  2.99 | ppl    19.81 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 17.06s | valid loss  4.15 | valid ppl    63.54 | valid bpc    5.990
-----------------------------------------------------------------------------------------
PROGRESS: 97.0%
| epoch  98 |   100/  216 batches | lr 0.00000 | ms/batch 77.54 | loss  3.03 | ppl    20.73 
| epoch  98 |   200/  216 batches | lr 0.00000 | ms/batch 76.15 | loss  2.98 | ppl    19.77 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 17.07s | valid loss  4.13 | valid ppl    62.25 | valid bpc    5.960
-----------------------------------------------------------------------------------------
PROGRESS: 98.0%
| epoch  99 |   100/  216 batches | lr 0.00000 | ms/batch 77.60 | loss  3.00 | ppl    20.09 
| epoch  99 |   200/  216 batches | lr 0.00000 | ms/batch 76.08 | loss  2.99 | ppl    19.93 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 17.07s | valid loss  4.15 | valid ppl    63.32 | valid bpc    5.985
-----------------------------------------------------------------------------------------
PROGRESS: 99.0%
| epoch 100 |   100/  216 batches | lr 0.00000 | ms/batch 77.82 | loss  3.01 | ppl    20.29 
| epoch 100 |   200/  216 batches | lr 0.00000 | ms/batch 76.08 | loss  3.00 | ppl    20.13 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 17.09s | valid loss  4.15 | valid ppl    63.29 | valid bpc    5.984
-----------------------------------------------------------------------------------------
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  4.14 | test ppl    62.95 | test bpc    5.976
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.4115, Mean Reca: 0.5677, Mean F1: 0.4690
Counter({'NP': 8854, 'PP': 3834, 'S': 3235, 'VP': 2662, 'SBAR': 533, 'ADJP': 310, 'QP': 290, 'ADVP': 167, 'SINV': 148, 'PRN': 52, 'FRAG': 34, 'WHNP': 30, 'NAC': 16, 'NX': 13, 'SQ': 12, 'CONJP': 11, 'WHPP': 10, 'UCP': 9, 'SBARQ': 9, 'WHADVP': 3, 'X': 3, 'WHADJP': 1})
Counter({'NP': 14432, 'VP': 8130, 'S': 5620, 'PP': 5484, 'SBAR': 1796, 'ADJP': 649, 'QP': 490, 'ADVP': 286, 'SINV': 157, 'PRN': 128, 'NX': 95, 'FRAG': 42, 'WHNP': 37, 'UCP': 32, 'NAC': 30, 'WHPP': 25, 'CONJP': 21, 'SQ': 18, 'SBARQ': 10, 'WHADVP': 9, 'X': 6, 'WHADJP': 4, 'INTJ': 1})
SBAR: 0.2968
NP: 0.6135
VP: 0.3274
PP: 0.6991
ADJP: 0.4777
ADVP: 0.5839
4.901344560614824
-----------------------------------------------------------------------------------------
Dependency parsing performance:
Conll-U Style:
DDA: 0.400
UDA: 0.534
=========================================================================================
Loading dataset...
Loading dictionary...
Number of tokens:  10001
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer_in_parser', nhid=512, nlayers=8, front_layers=3, rear_layers=5, n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=5555, nonmono=5, cuda=True, log_interval=100, save='trained_models/structformer_in_parser_5555_35.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 38475621
Model architecture: StructFormer_In_Parser(
  (transformer_front): Transformer_Front(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(10001, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-2): 3 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
  (transformer_rear): Transformer_Rear(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(10001, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-4): 5 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (output_layer): Linear(in_features=512, out_features=10001, bias=True)
  )
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  216 batches | lr 0.00030 | ms/batch 80.21 | loss  7.30 | ppl  1483.07 
| epoch   1 |   200/  216 batches | lr 0.00030 | ms/batch 75.48 | loss  6.86 | ppl   953.89 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 17.25s | valid loss  6.76 | valid ppl   858.55 | valid bpc    9.746
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  216 batches | lr 0.00030 | ms/batch 76.48 | loss  6.80 | ppl   896.52 
| epoch   2 |   200/  216 batches | lr 0.00030 | ms/batch 76.34 | loss  6.54 | ppl   692.53 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 16.96s | valid loss  6.32 | valid ppl   553.35 | valid bpc    9.112
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  216 batches | lr 0.00030 | ms/batch 77.14 | loss  6.31 | ppl   549.40 
| epoch   3 |   200/  216 batches | lr 0.00030 | ms/batch 76.03 | loss  6.03 | ppl   416.36 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 17.02s | valid loss  5.84 | valid ppl   344.99 | valid bpc    8.430
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  216 batches | lr 0.00030 | ms/batch 77.37 | loss  5.85 | ppl   347.12 
| epoch   4 |   200/  216 batches | lr 0.00030 | ms/batch 75.92 | loss  5.65 | ppl   283.38 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 17.03s | valid loss  5.51 | valid ppl   246.45 | valid bpc    7.945
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  216 batches | lr 0.00030 | ms/batch 77.32 | loss  5.54 | ppl   255.54 
| epoch   5 |   200/  216 batches | lr 0.00030 | ms/batch 76.16 | loss  5.41 | ppl   223.46 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 17.05s | valid loss  5.33 | valid ppl   206.33 | valid bpc    7.689
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  216 batches | lr 0.00030 | ms/batch 77.00 | loss  5.33 | ppl   205.87 
| epoch   6 |   200/  216 batches | lr 0.00030 | ms/batch 76.34 | loss  5.21 | ppl   183.03 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 17.06s | valid loss  5.19 | valid ppl   180.13 | valid bpc    7.493
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  216 batches | lr 0.00030 | ms/batch 77.52 | loss  5.17 | ppl   176.12 
| epoch   7 |   200/  216 batches | lr 0.00030 | ms/batch 76.02 | loss  5.04 | ppl   153.78 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 17.06s | valid loss  5.05 | valid ppl   156.25 | valid bpc    7.288
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  216 batches | lr 0.00030 | ms/batch 77.72 | loss  5.03 | ppl   152.79 
| epoch   8 |   200/  216 batches | lr 0.00030 | ms/batch 75.96 | loss  4.92 | ppl   137.49 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 17.07s | valid loss  4.93 | valid ppl   138.80 | valid bpc    7.117
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 8.0%
| epoch   9 |   100/  216 batches | lr 0.00030 | ms/batch 77.28 | loss  4.87 | ppl   130.03 
| epoch   9 |   200/  216 batches | lr 0.00030 | ms/batch 76.44 | loss  4.83 | ppl   124.63 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 17.07s | valid loss  4.89 | valid ppl   133.28 | valid bpc    7.058
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  216 batches | lr 0.00030 | ms/batch 77.72 | loss  4.80 | ppl   121.55 
| epoch  10 |   200/  216 batches | lr 0.00030 | ms/batch 76.12 | loss  4.69 | ppl   109.18 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 17.09s | valid loss  4.79 | valid ppl   119.76 | valid bpc    6.904
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  216 batches | lr 0.00030 | ms/batch 77.21 | loss  4.67 | ppl   106.40 
| epoch  11 |   200/  216 batches | lr 0.00030 | ms/batch 76.50 | loss  4.62 | ppl   101.09 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 17.08s | valid loss  4.67 | valid ppl   106.32 | valid bpc    6.732
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  216 batches | lr 0.00030 | ms/batch 77.34 | loss  4.57 | ppl    96.25 
| epoch  12 |   200/  216 batches | lr 0.00030 | ms/batch 76.50 | loss  4.53 | ppl    92.89 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 17.08s | valid loss  4.65 | valid ppl   104.13 | valid bpc    6.702
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 12.0%
| epoch  13 |   100/  216 batches | lr 0.00030 | ms/batch 77.47 | loss  4.47 | ppl    87.42 
| epoch  13 |   200/  216 batches | lr 0.00030 | ms/batch 75.94 | loss  4.44 | ppl    85.20 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 17.08s | valid loss  4.61 | valid ppl   100.90 | valid bpc    6.657
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 13.0%
| epoch  14 |   100/  216 batches | lr 0.00030 | ms/batch 77.39 | loss  4.43 | ppl    83.84 
| epoch  14 |   200/  216 batches | lr 0.00030 | ms/batch 76.43 | loss  4.35 | ppl    77.16 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 17.08s | valid loss  4.58 | valid ppl    97.98 | valid bpc    6.614
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  216 batches | lr 0.00030 | ms/batch 77.36 | loss  4.34 | ppl    76.69 
| epoch  15 |   200/  216 batches | lr 0.00030 | ms/batch 76.32 | loss  4.29 | ppl    73.11 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 17.08s | valid loss  4.56 | valid ppl    95.78 | valid bpc    6.582
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 15.0%
| epoch  16 |   100/  216 batches | lr 0.00030 | ms/batch 77.27 | loss  4.26 | ppl    70.65 
| epoch  16 |   200/  216 batches | lr 0.00030 | ms/batch 76.53 | loss  4.22 | ppl    67.93 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 17.08s | valid loss  4.47 | valid ppl    87.26 | valid bpc    6.447
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 16.0%
| epoch  17 |   100/  216 batches | lr 0.00030 | ms/batch 77.31 | loss  4.19 | ppl    66.34 
| epoch  17 |   200/  216 batches | lr 0.00030 | ms/batch 76.51 | loss  4.15 | ppl    63.14 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 17.09s | valid loss  4.45 | valid ppl    85.89 | valid bpc    6.424
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 17.0%
| epoch  18 |   100/  216 batches | lr 0.00030 | ms/batch 77.27 | loss  4.13 | ppl    62.14 
| epoch  18 |   200/  216 batches | lr 0.00030 | ms/batch 76.58 | loss  4.10 | ppl    60.39 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 17.08s | valid loss  4.42 | valid ppl    83.20 | valid bpc    6.379
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 18.0%
| epoch  19 |   100/  216 batches | lr 0.00030 | ms/batch 77.74 | loss  4.05 | ppl    57.17 
| epoch  19 |   200/  216 batches | lr 0.00030 | ms/batch 76.17 | loss  4.04 | ppl    56.76 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 17.08s | valid loss  4.41 | valid ppl    82.62 | valid bpc    6.368
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 19.0%
| epoch  20 |   100/  216 batches | lr 0.00030 | ms/batch 77.41 | loss  4.01 | ppl    55.09 
| epoch  20 |   200/  216 batches | lr 0.00030 | ms/batch 76.35 | loss  3.99 | ppl    53.85 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 17.07s | valid loss  4.38 | valid ppl    79.90 | valid bpc    6.320
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 20.0%
| epoch  21 |   100/  216 batches | lr 0.00030 | ms/batch 77.29 | loss  3.96 | ppl    52.33 
| epoch  21 |   200/  216 batches | lr 0.00030 | ms/batch 76.49 | loss  3.90 | ppl    49.63 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 17.08s | valid loss  4.36 | valid ppl    77.98 | valid bpc    6.285
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 21.0%
| epoch  22 |   100/  216 batches | lr 0.00030 | ms/batch 77.62 | loss  3.89 | ppl    48.83 
| epoch  22 |   200/  216 batches | lr 0.00030 | ms/batch 76.14 | loss  3.87 | ppl    47.93 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 17.08s | valid loss  4.34 | valid ppl    76.38 | valid bpc    6.255
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 22.0%
| epoch  23 |   100/  216 batches | lr 0.00030 | ms/batch 77.14 | loss  3.81 | ppl    45.33 
| epoch  23 |   200/  216 batches | lr 0.00030 | ms/batch 76.77 | loss  3.84 | ppl    46.41 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 17.09s | valid loss  4.31 | valid ppl    74.77 | valid bpc    6.224
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 23.0%
| epoch  24 |   100/  216 batches | lr 0.00030 | ms/batch 77.26 | loss  3.77 | ppl    43.48 
| epoch  24 |   200/  216 batches | lr 0.00030 | ms/batch 75.83 | loss  3.79 | ppl    44.07 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 17.07s | valid loss  4.30 | valid ppl    74.03 | valid bpc    6.210
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 24.0%
| epoch  25 |   100/  216 batches | lr 0.00030 | ms/batch 77.81 | loss  3.76 | ppl    42.78 
| epoch  25 |   200/  216 batches | lr 0.00030 | ms/batch 75.89 | loss  3.71 | ppl    40.66 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 17.08s | valid loss  4.35 | valid ppl    77.61 | valid bpc    6.278
-----------------------------------------------------------------------------------------
PROGRESS: 25.0%
| epoch  26 |   100/  216 batches | lr 0.00030 | ms/batch 77.53 | loss  3.71 | ppl    40.76 
| epoch  26 |   200/  216 batches | lr 0.00030 | ms/batch 76.27 | loss  3.67 | ppl    39.26 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 17.08s | valid loss  4.29 | valid ppl    73.26 | valid bpc    6.195
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 26.0%
| epoch  27 |   100/  216 batches | lr 0.00030 | ms/batch 77.44 | loss  3.66 | ppl    38.70 
| epoch  27 |   200/  216 batches | lr 0.00030 | ms/batch 76.22 | loss  3.65 | ppl    38.31 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 17.07s | valid loss  4.31 | valid ppl    74.45 | valid bpc    6.218
-----------------------------------------------------------------------------------------
PROGRESS: 27.0%
| epoch  28 |   100/  216 batches | lr 0.00030 | ms/batch 77.13 | loss  3.60 | ppl    36.75 
| epoch  28 |   200/  216 batches | lr 0.00030 | ms/batch 76.69 | loss  3.60 | ppl    36.55 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 17.09s | valid loss  4.26 | valid ppl    70.75 | valid bpc    6.145
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  216 batches | lr 0.00030 | ms/batch 77.11 | loss  3.56 | ppl    35.07 
| epoch  29 |   200/  216 batches | lr 0.00030 | ms/batch 76.54 | loss  3.58 | ppl    36.02 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 17.08s | valid loss  4.27 | valid ppl    71.55 | valid bpc    6.161
-----------------------------------------------------------------------------------------
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  216 batches | lr 0.00030 | ms/batch 77.29 | loss  3.52 | ppl    33.76 
| epoch  30 |   200/  216 batches | lr 0.00030 | ms/batch 76.37 | loss  3.51 | ppl    33.56 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 17.09s | valid loss  4.25 | valid ppl    70.01 | valid bpc    6.130
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 30.0%
| epoch  31 |   100/  216 batches | lr 0.00030 | ms/batch 77.15 | loss  3.48 | ppl    32.43 
| epoch  31 |   200/  216 batches | lr 0.00030 | ms/batch 76.59 | loss  3.48 | ppl    32.43 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 17.08s | valid loss  4.29 | valid ppl    73.15 | valid bpc    6.193
-----------------------------------------------------------------------------------------
PROGRESS: 31.0%
| epoch  32 |   100/  216 batches | lr 0.00030 | ms/batch 77.99 | loss  3.43 | ppl    30.97 
| epoch  32 |   200/  216 batches | lr 0.00030 | ms/batch 76.25 | loss  3.43 | ppl    30.84 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 17.13s | valid loss  4.30 | valid ppl    73.96 | valid bpc    6.209
-----------------------------------------------------------------------------------------
PROGRESS: 32.0%
| epoch  33 |   100/  216 batches | lr 0.00030 | ms/batch 77.30 | loss  3.40 | ppl    29.93 
| epoch  33 |   200/  216 batches | lr 0.00030 | ms/batch 76.61 | loss  3.39 | ppl    29.71 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 17.09s | valid loss  4.26 | valid ppl    70.92 | valid bpc    6.148
-----------------------------------------------------------------------------------------
PROGRESS: 33.0%
| epoch  34 |   100/  216 batches | lr 0.00015 | ms/batch 77.11 | loss  3.32 | ppl    27.71 
| epoch  34 |   200/  216 batches | lr 0.00015 | ms/batch 76.46 | loss  3.26 | ppl    26.05 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 17.10s | valid loss  4.29 | valid ppl    72.60 | valid bpc    6.182
-----------------------------------------------------------------------------------------
PROGRESS: 34.0%
| epoch  35 |   100/  216 batches | lr 0.00015 | ms/batch 77.58 | loss  3.25 | ppl    25.91 
| epoch  35 |   200/  216 batches | lr 0.00015 | ms/batch 76.08 | loss  3.21 | ppl    24.84 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 17.10s | valid loss  4.20 | valid ppl    66.55 | valid bpc    6.056
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 35.0%
| epoch  36 |   100/  216 batches | lr 0.00015 | ms/batch 77.30 | loss  3.23 | ppl    25.18 
| epoch  36 |   200/  216 batches | lr 0.00015 | ms/batch 76.10 | loss  3.19 | ppl    24.29 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 17.08s | valid loss  4.21 | valid ppl    67.57 | valid bpc    6.078
-----------------------------------------------------------------------------------------
PROGRESS: 36.0%
| epoch  37 |   100/  216 batches | lr 0.00015 | ms/batch 77.39 | loss  3.19 | ppl    24.35 
| epoch  37 |   200/  216 batches | lr 0.00015 | ms/batch 76.36 | loss  3.17 | ppl    23.92 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 17.08s | valid loss  4.22 | valid ppl    67.98 | valid bpc    6.087
-----------------------------------------------------------------------------------------
PROGRESS: 37.0%
| epoch  38 |   100/  216 batches | lr 0.00015 | ms/batch 77.42 | loss  3.13 | ppl    22.93 
| epoch  38 |   200/  216 batches | lr 0.00015 | ms/batch 76.20 | loss  3.15 | ppl    23.28 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 17.08s | valid loss  4.21 | valid ppl    67.61 | valid bpc    6.079
-----------------------------------------------------------------------------------------
PROGRESS: 38.0%
| epoch  39 |   100/  216 batches | lr 0.00007 | ms/batch 77.58 | loss  3.11 | ppl    22.46 
| epoch  39 |   200/  216 batches | lr 0.00007 | ms/batch 76.17 | loss  3.06 | ppl    21.25 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 17.08s | valid loss  4.18 | valid ppl    65.38 | valid bpc    6.031
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 39.0%
| epoch  40 |   100/  216 batches | lr 0.00007 | ms/batch 77.59 | loss  3.08 | ppl    21.84 
| epoch  40 |   200/  216 batches | lr 0.00007 | ms/batch 76.21 | loss  3.05 | ppl    21.21 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 17.08s | valid loss  4.24 | valid ppl    69.66 | valid bpc    6.122
-----------------------------------------------------------------------------------------
PROGRESS: 40.0%
| epoch  41 |   100/  216 batches | lr 0.00007 | ms/batch 77.12 | loss  3.06 | ppl    21.35 
| epoch  41 |   200/  216 batches | lr 0.00007 | ms/batch 76.78 | loss  3.01 | ppl    20.39 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 17.08s | valid loss  4.17 | valid ppl    64.69 | valid bpc    6.015
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 41.0%
| epoch  42 |   100/  216 batches | lr 0.00007 | ms/batch 77.19 | loss  3.03 | ppl    20.77 
| epoch  42 |   200/  216 batches | lr 0.00007 | ms/batch 76.57 | loss  3.00 | ppl    20.13 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 17.08s | valid loss  4.17 | valid ppl    64.66 | valid bpc    6.015
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 42.0%
| epoch  43 |   100/  216 batches | lr 0.00007 | ms/batch 77.62 | loss  2.99 | ppl    19.87 
| epoch  43 |   200/  216 batches | lr 0.00007 | ms/batch 76.12 | loss  3.02 | ppl    20.44 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 17.07s | valid loss  4.17 | valid ppl    64.53 | valid bpc    6.012
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 43.0%
| epoch  44 |   100/  216 batches | lr 0.00007 | ms/batch 77.83 | loss  2.98 | ppl    19.78 
| epoch  44 |   200/  216 batches | lr 0.00007 | ms/batch 75.74 | loss  2.99 | ppl    19.95 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 17.07s | valid loss  4.24 | valid ppl    69.36 | valid bpc    6.116
-----------------------------------------------------------------------------------------
PROGRESS: 44.0%
| epoch  45 |   100/  216 batches | lr 0.00007 | ms/batch 77.26 | loss  3.01 | ppl    20.20 
| epoch  45 |   200/  216 batches | lr 0.00007 | ms/batch 76.50 | loss  2.94 | ppl    19.01 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 17.08s | valid loss  4.19 | valid ppl    66.17 | valid bpc    6.048
-----------------------------------------------------------------------------------------
PROGRESS: 45.0%
| epoch  46 |   100/  216 batches | lr 0.00007 | ms/batch 77.21 | loss  3.00 | ppl    20.16 
| epoch  46 |   200/  216 batches | lr 0.00007 | ms/batch 76.26 | loss  2.93 | ppl    18.65 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 17.09s | valid loss  4.23 | valid ppl    69.03 | valid bpc    6.109
-----------------------------------------------------------------------------------------
PROGRESS: 46.0%
| epoch  47 |   100/  216 batches | lr 0.00004 | ms/batch 77.55 | loss  2.94 | ppl    18.95 
| epoch  47 |   200/  216 batches | lr 0.00004 | ms/batch 76.26 | loss  2.91 | ppl    18.30 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 17.09s | valid loss  4.24 | valid ppl    69.45 | valid bpc    6.118
-----------------------------------------------------------------------------------------
PROGRESS: 47.0%
| epoch  48 |   100/  216 batches | lr 0.00004 | ms/batch 77.38 | loss  2.95 | ppl    19.04 
| epoch  48 |   200/  216 batches | lr 0.00004 | ms/batch 76.39 | loss  2.91 | ppl    18.28 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 17.08s | valid loss  4.23 | valid ppl    68.69 | valid bpc    6.102
-----------------------------------------------------------------------------------------
PROGRESS: 48.0%
| epoch  49 |   100/  216 batches | lr 0.00004 | ms/batch 77.59 | loss  2.92 | ppl    18.62 
| epoch  49 |   200/  216 batches | lr 0.00004 | ms/batch 76.03 | loss  2.90 | ppl    18.22 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 17.08s | valid loss  4.18 | valid ppl    65.14 | valid bpc    6.025
-----------------------------------------------------------------------------------------
PROGRESS: 49.0%
| epoch  50 |   100/  216 batches | lr 0.00002 | ms/batch 77.62 | loss  2.91 | ppl    18.30 
| epoch  50 |   200/  216 batches | lr 0.00002 | ms/batch 76.25 | loss  2.89 | ppl    17.94 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 17.08s | valid loss  4.19 | valid ppl    66.13 | valid bpc    6.047
-----------------------------------------------------------------------------------------
PROGRESS: 50.0%
| epoch  51 |   100/  216 batches | lr 0.00002 | ms/batch 77.46 | loss  2.92 | ppl    18.50 
| epoch  51 |   200/  216 batches | lr 0.00002 | ms/batch 76.33 | loss  2.87 | ppl    17.58 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 17.08s | valid loss  4.18 | valid ppl    65.22 | valid bpc    6.027
-----------------------------------------------------------------------------------------
PROGRESS: 51.0%
| epoch  52 |   100/  216 batches | lr 0.00002 | ms/batch 77.52 | loss  2.91 | ppl    18.34 
| epoch  52 |   200/  216 batches | lr 0.00002 | ms/batch 76.37 | loss  2.87 | ppl    17.66 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 17.08s | valid loss  4.20 | valid ppl    66.52 | valid bpc    6.056
-----------------------------------------------------------------------------------------
PROGRESS: 52.0%
| epoch  53 |   100/  216 batches | lr 0.00001 | ms/batch 77.55 | loss  2.89 | ppl    18.05 
| epoch  53 |   200/  216 batches | lr 0.00001 | ms/batch 76.13 | loss  2.86 | ppl    17.40 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 17.08s | valid loss  4.21 | valid ppl    67.17 | valid bpc    6.070
-----------------------------------------------------------------------------------------
PROGRESS: 53.0%
| epoch  54 |   100/  216 batches | lr 0.00001 | ms/batch 77.69 | loss  2.89 | ppl    18.05 
| epoch  54 |   200/  216 batches | lr 0.00001 | ms/batch 76.24 | loss  2.86 | ppl    17.55 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 17.09s | valid loss  4.19 | valid ppl    65.70 | valid bpc    6.038
-----------------------------------------------------------------------------------------
PROGRESS: 54.0%
| epoch  55 |   100/  216 batches | lr 0.00001 | ms/batch 77.39 | loss  2.88 | ppl    17.87 
| epoch  55 |   200/  216 batches | lr 0.00001 | ms/batch 76.31 | loss  2.87 | ppl    17.56 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 17.08s | valid loss  4.22 | valid ppl    67.77 | valid bpc    6.083
-----------------------------------------------------------------------------------------
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  216 batches | lr 0.00000 | ms/batch 77.56 | loss  2.85 | ppl    17.33 
| epoch  56 |   200/  216 batches | lr 0.00000 | ms/batch 76.15 | loss  2.84 | ppl    17.16 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 17.07s | valid loss  4.19 | valid ppl    66.16 | valid bpc    6.048
-----------------------------------------------------------------------------------------
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  216 batches | lr 0.00000 | ms/batch 77.53 | loss  2.91 | ppl    18.29 
| epoch  57 |   200/  216 batches | lr 0.00000 | ms/batch 76.10 | loss  2.82 | ppl    16.78 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 17.07s | valid loss  4.21 | valid ppl    67.67 | valid bpc    6.080
-----------------------------------------------------------------------------------------
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  216 batches | lr 0.00000 | ms/batch 77.92 | loss  2.87 | ppl    17.71 
| epoch  58 |   200/  216 batches | lr 0.00000 | ms/batch 75.90 | loss  2.84 | ppl    17.20 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 17.08s | valid loss  4.20 | valid ppl    66.50 | valid bpc    6.055
-----------------------------------------------------------------------------------------
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  216 batches | lr 0.00000 | ms/batch 77.53 | loss  2.88 | ppl    17.88 
| epoch  59 |   200/  216 batches | lr 0.00000 | ms/batch 76.22 | loss  2.84 | ppl    17.14 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 17.08s | valid loss  4.23 | valid ppl    69.02 | valid bpc    6.109
-----------------------------------------------------------------------------------------
PROGRESS: 59.0%
| epoch  60 |   100/  216 batches | lr 0.00000 | ms/batch 77.70 | loss  2.87 | ppl    17.72 
| epoch  60 |   200/  216 batches | lr 0.00000 | ms/batch 76.03 | loss  2.82 | ppl    16.74 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 17.07s | valid loss  4.20 | valid ppl    66.63 | valid bpc    6.058
-----------------------------------------------------------------------------------------
PROGRESS: 60.0%
| epoch  61 |   100/  216 batches | lr 0.00000 | ms/batch 77.44 | loss  2.87 | ppl    17.63 
| epoch  61 |   200/  216 batches | lr 0.00000 | ms/batch 76.02 | loss  2.85 | ppl    17.30 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 17.08s | valid loss  4.21 | valid ppl    67.56 | valid bpc    6.078
-----------------------------------------------------------------------------------------
PROGRESS: 61.0%
| epoch  62 |   100/  216 batches | lr 0.00000 | ms/batch 77.60 | loss  2.87 | ppl    17.55 
| epoch  62 |   200/  216 batches | lr 0.00000 | ms/batch 76.34 | loss  2.82 | ppl    16.85 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 17.09s | valid loss  4.19 | valid ppl    65.71 | valid bpc    6.038
-----------------------------------------------------------------------------------------
PROGRESS: 62.0%
| epoch  63 |   100/  216 batches | lr 0.00000 | ms/batch 77.16 | loss  2.85 | ppl    17.22 
| epoch  63 |   200/  216 batches | lr 0.00000 | ms/batch 76.55 | loss  2.85 | ppl    17.34 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 17.07s | valid loss  4.17 | valid ppl    64.60 | valid bpc    6.013
-----------------------------------------------------------------------------------------
PROGRESS: 63.0%
| epoch  64 |   100/  216 batches | lr 0.00000 | ms/batch 77.05 | loss  2.86 | ppl    17.51 
| epoch  64 |   200/  216 batches | lr 0.00000 | ms/batch 76.80 | loss  2.85 | ppl    17.23 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 17.09s | valid loss  4.19 | valid ppl    66.20 | valid bpc    6.049
-----------------------------------------------------------------------------------------
PROGRESS: 64.0%
| epoch  65 |   100/  216 batches | lr 0.00000 | ms/batch 77.18 | loss  2.86 | ppl    17.52 
| epoch  65 |   200/  216 batches | lr 0.00000 | ms/batch 76.74 | loss  2.85 | ppl    17.23 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 17.08s | valid loss  4.16 | valid ppl    64.33 | valid bpc    6.007
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 65.0%
| epoch  66 |   100/  216 batches | lr 0.00000 | ms/batch 77.03 | loss  2.86 | ppl    17.54 
| epoch  66 |   200/  216 batches | lr 0.00000 | ms/batch 76.29 | loss  2.84 | ppl    17.17 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 17.08s | valid loss  4.16 | valid ppl    64.15 | valid bpc    6.003
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 66.0%
| epoch  67 |   100/  216 batches | lr 0.00000 | ms/batch 77.51 | loss  2.88 | ppl    17.86 
| epoch  67 |   200/  216 batches | lr 0.00000 | ms/batch 76.22 | loss  2.83 | ppl    16.89 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 17.07s | valid loss  4.16 | valid ppl    64.19 | valid bpc    6.004
-----------------------------------------------------------------------------------------
PROGRESS: 67.0%
| epoch  68 |   100/  216 batches | lr 0.00000 | ms/batch 77.26 | loss  2.88 | ppl    17.85 
| epoch  68 |   200/  216 batches | lr 0.00000 | ms/batch 76.30 | loss  2.82 | ppl    16.82 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 17.09s | valid loss  4.19 | valid ppl    65.73 | valid bpc    6.038
-----------------------------------------------------------------------------------------
PROGRESS: 68.0%
| epoch  69 |   100/  216 batches | lr 0.00000 | ms/batch 77.74 | loss  2.87 | ppl    17.61 
| epoch  69 |   200/  216 batches | lr 0.00000 | ms/batch 76.01 | loss  2.84 | ppl    17.19 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 17.08s | valid loss  4.22 | valid ppl    68.31 | valid bpc    6.094
-----------------------------------------------------------------------------------------
PROGRESS: 69.0%
| epoch  70 |   100/  216 batches | lr 0.00000 | ms/batch 77.66 | loss  2.88 | ppl    17.79 
| epoch  70 |   200/  216 batches | lr 0.00000 | ms/batch 75.93 | loss  2.85 | ppl    17.26 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 17.08s | valid loss  4.19 | valid ppl    66.34 | valid bpc    6.052
-----------------------------------------------------------------------------------------
PROGRESS: 70.0%
| epoch  71 |   100/  216 batches | lr 0.00000 | ms/batch 77.48 | loss  2.86 | ppl    17.38 
| epoch  71 |   200/  216 batches | lr 0.00000 | ms/batch 75.98 | loss  2.85 | ppl    17.35 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 17.08s | valid loss  4.20 | valid ppl    66.36 | valid bpc    6.052
-----------------------------------------------------------------------------------------
PROGRESS: 71.0%
| epoch  72 |   100/  216 batches | lr 0.00000 | ms/batch 77.25 | loss  2.85 | ppl    17.35 
| epoch  72 |   200/  216 batches | lr 0.00000 | ms/batch 76.57 | loss  2.84 | ppl    17.19 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 17.08s | valid loss  4.19 | valid ppl    66.11 | valid bpc    6.047
-----------------------------------------------------------------------------------------
PROGRESS: 72.0%
| epoch  73 |   100/  216 batches | lr 0.00000 | ms/batch 77.72 | loss  2.86 | ppl    17.43 
| epoch  73 |   200/  216 batches | lr 0.00000 | ms/batch 75.96 | loss  2.85 | ppl    17.23 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 17.08s | valid loss  4.18 | valid ppl    65.38 | valid bpc    6.031
-----------------------------------------------------------------------------------------
PROGRESS: 73.0%
| epoch  74 |   100/  216 batches | lr 0.00000 | ms/batch 77.59 | loss  2.89 | ppl    18.03 
| epoch  74 |   200/  216 batches | lr 0.00000 | ms/batch 76.12 | loss  2.82 | ppl    16.83 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 17.08s | valid loss  4.16 | valid ppl    64.39 | valid bpc    6.009
-----------------------------------------------------------------------------------------
PROGRESS: 74.0%
| epoch  75 |   100/  216 batches | lr 0.00000 | ms/batch 77.46 | loss  2.87 | ppl    17.71 
| epoch  75 |   200/  216 batches | lr 0.00000 | ms/batch 76.05 | loss  2.83 | ppl    17.01 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 17.08s | valid loss  4.17 | valid ppl    64.40 | valid bpc    6.009
-----------------------------------------------------------------------------------------
PROGRESS: 75.0%
| epoch  76 |   100/  216 batches | lr 0.00000 | ms/batch 77.31 | loss  2.87 | ppl    17.56 
| epoch  76 |   200/  216 batches | lr 0.00000 | ms/batch 76.46 | loss  2.85 | ppl    17.25 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 17.07s | valid loss  4.15 | valid ppl    63.72 | valid bpc    5.994
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 76.0%
| epoch  77 |   100/  216 batches | lr 0.00000 | ms/batch 77.05 | loss  2.89 | ppl    17.93 
| epoch  77 |   200/  216 batches | lr 0.00000 | ms/batch 76.66 | loss  2.83 | ppl    16.89 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 17.07s | valid loss  4.20 | valid ppl    66.42 | valid bpc    6.054
-----------------------------------------------------------------------------------------
PROGRESS: 77.0%
| epoch  78 |   100/  216 batches | lr 0.00000 | ms/batch 77.33 | loss  2.87 | ppl    17.59 
| epoch  78 |   200/  216 batches | lr 0.00000 | ms/batch 76.01 | loss  2.83 | ppl    16.98 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 17.08s | valid loss  4.20 | valid ppl    66.57 | valid bpc    6.057
-----------------------------------------------------------------------------------------
PROGRESS: 78.0%
| epoch  79 |   100/  216 batches | lr 0.00000 | ms/batch 77.66 | loss  2.86 | ppl    17.51 
| epoch  79 |   200/  216 batches | lr 0.00000 | ms/batch 76.01 | loss  2.83 | ppl    16.95 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 17.08s | valid loss  4.23 | valid ppl    68.43 | valid bpc    6.097
-----------------------------------------------------------------------------------------
PROGRESS: 79.0%
| epoch  80 |   100/  216 batches | lr 0.00000 | ms/batch 77.02 | loss  2.88 | ppl    17.80 
| epoch  80 |   200/  216 batches | lr 0.00000 | ms/batch 76.79 | loss  2.84 | ppl    17.15 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 17.08s | valid loss  4.16 | valid ppl    64.11 | valid bpc    6.002
-----------------------------------------------------------------------------------------
PROGRESS: 80.0%
| epoch  81 |   100/  216 batches | lr 0.00000 | ms/batch 77.08 | loss  2.87 | ppl    17.72 
| epoch  81 |   200/  216 batches | lr 0.00000 | ms/batch 76.74 | loss  2.83 | ppl    16.89 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 17.09s | valid loss  4.22 | valid ppl    68.31 | valid bpc    6.094
-----------------------------------------------------------------------------------------
PROGRESS: 81.0%
| epoch  82 |   100/  216 batches | lr 0.00000 | ms/batch 77.27 | loss  2.88 | ppl    17.79 
| epoch  82 |   200/  216 batches | lr 0.00000 | ms/batch 76.35 | loss  2.84 | ppl    17.04 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 17.08s | valid loss  4.21 | valid ppl    67.10 | valid bpc    6.068
-----------------------------------------------------------------------------------------
PROGRESS: 82.0%
| epoch  83 |   100/  216 batches | lr 0.00000 | ms/batch 77.30 | loss  2.88 | ppl    17.86 
| epoch  83 |   200/  216 batches | lr 0.00000 | ms/batch 76.26 | loss  2.84 | ppl    17.11 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 17.08s | valid loss  4.17 | valid ppl    64.88 | valid bpc    6.020
-----------------------------------------------------------------------------------------
PROGRESS: 83.0%
| epoch  84 |   100/  216 batches | lr 0.00000 | ms/batch 77.42 | loss  2.87 | ppl    17.67 
| epoch  84 |   200/  216 batches | lr 0.00000 | ms/batch 75.97 | loss  2.83 | ppl    16.96 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 17.07s | valid loss  4.20 | valid ppl    66.87 | valid bpc    6.063
-----------------------------------------------------------------------------------------
PROGRESS: 84.0%
| epoch  85 |   100/  216 batches | lr 0.00000 | ms/batch 77.44 | loss  2.86 | ppl    17.47 
| epoch  85 |   200/  216 batches | lr 0.00000 | ms/batch 76.38 | loss  2.84 | ppl    17.10 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 17.08s | valid loss  4.19 | valid ppl    65.89 | valid bpc    6.042
-----------------------------------------------------------------------------------------
PROGRESS: 85.0%
| epoch  86 |   100/  216 batches | lr 0.00000 | ms/batch 77.76 | loss  2.87 | ppl    17.60 
| epoch  86 |   200/  216 batches | lr 0.00000 | ms/batch 76.19 | loss  2.85 | ppl    17.23 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 17.08s | valid loss  4.20 | valid ppl    66.85 | valid bpc    6.063
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  216 batches | lr 0.00000 | ms/batch 77.37 | loss  2.87 | ppl    17.70 
| epoch  87 |   200/  216 batches | lr 0.00000 | ms/batch 76.07 | loss  2.83 | ppl    16.97 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 17.08s | valid loss  4.18 | valid ppl    65.12 | valid bpc    6.025
-----------------------------------------------------------------------------------------
PROGRESS: 87.0%
| epoch  88 |   100/  216 batches | lr 0.00000 | ms/batch 77.56 | loss  2.86 | ppl    17.48 
| epoch  88 |   200/  216 batches | lr 0.00000 | ms/batch 76.15 | loss  2.84 | ppl    17.17 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 17.07s | valid loss  4.20 | valid ppl    66.38 | valid bpc    6.053
-----------------------------------------------------------------------------------------
PROGRESS: 88.0%
| epoch  89 |   100/  216 batches | lr 0.00000 | ms/batch 77.72 | loss  2.85 | ppl    17.23 
| epoch  89 |   200/  216 batches | lr 0.00000 | ms/batch 76.06 | loss  2.86 | ppl    17.40 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 17.07s | valid loss  4.16 | valid ppl    64.13 | valid bpc    6.003
-----------------------------------------------------------------------------------------
PROGRESS: 89.0%
| epoch  90 |   100/  216 batches | lr 0.00000 | ms/batch 77.72 | loss  2.87 | ppl    17.58 
| epoch  90 |   200/  216 batches | lr 0.00000 | ms/batch 76.16 | loss  2.85 | ppl    17.26 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 17.07s | valid loss  4.19 | valid ppl    66.09 | valid bpc    6.046
-----------------------------------------------------------------------------------------
PROGRESS: 90.0%
| epoch  91 |   100/  216 batches | lr 0.00000 | ms/batch 77.47 | loss  2.87 | ppl    17.58 
| epoch  91 |   200/  216 batches | lr 0.00000 | ms/batch 76.16 | loss  2.84 | ppl    17.10 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 17.07s | valid loss  4.20 | valid ppl    66.52 | valid bpc    6.056
-----------------------------------------------------------------------------------------
PROGRESS: 91.0%
| epoch  92 |   100/  216 batches | lr 0.00000 | ms/batch 77.61 | loss  2.86 | ppl    17.42 
| epoch  92 |   200/  216 batches | lr 0.00000 | ms/batch 76.01 | loss  2.84 | ppl    17.13 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 17.08s | valid loss  4.18 | valid ppl    65.31 | valid bpc    6.029
-----------------------------------------------------------------------------------------
PROGRESS: 92.0%
| epoch  93 |   100/  216 batches | lr 0.00000 | ms/batch 77.68 | loss  2.86 | ppl    17.38 
| epoch  93 |   200/  216 batches | lr 0.00000 | ms/batch 76.15 | loss  2.86 | ppl    17.39 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 17.09s | valid loss  4.21 | valid ppl    67.40 | valid bpc    6.075
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  216 batches | lr 0.00000 | ms/batch 76.96 | loss  2.86 | ppl    17.52 
| epoch  94 |   200/  216 batches | lr 0.00000 | ms/batch 76.76 | loss  2.85 | ppl    17.36 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 17.08s | valid loss  4.17 | valid ppl    64.47 | valid bpc    6.011
-----------------------------------------------------------------------------------------
PROGRESS: 94.0%
| epoch  95 |   100/  216 batches | lr 0.00000 | ms/batch 77.49 | loss  2.84 | ppl    17.12 
| epoch  95 |   200/  216 batches | lr 0.00000 | ms/batch 76.22 | loss  2.84 | ppl    17.16 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 17.08s | valid loss  4.17 | valid ppl    64.98 | valid bpc    6.022
-----------------------------------------------------------------------------------------
PROGRESS: 95.0%
| epoch  96 |   100/  216 batches | lr 0.00000 | ms/batch 77.56 | loss  2.85 | ppl    17.28 
| epoch  96 |   200/  216 batches | lr 0.00000 | ms/batch 76.27 | loss  2.86 | ppl    17.38 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 17.09s | valid loss  4.21 | valid ppl    67.27 | valid bpc    6.072
-----------------------------------------------------------------------------------------
PROGRESS: 96.0%
| epoch  97 |   100/  216 batches | lr 0.00000 | ms/batch 77.10 | loss  2.87 | ppl    17.67 
| epoch  97 |   200/  216 batches | lr 0.00000 | ms/batch 76.46 | loss  2.83 | ppl    16.93 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 17.07s | valid loss  4.18 | valid ppl    65.38 | valid bpc    6.031
-----------------------------------------------------------------------------------------
PROGRESS: 97.0%
| epoch  98 |   100/  216 batches | lr 0.00000 | ms/batch 77.85 | loss  2.88 | ppl    17.90 
| epoch  98 |   200/  216 batches | lr 0.00000 | ms/batch 75.98 | loss  2.83 | ppl    16.90 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 17.08s | valid loss  4.18 | valid ppl    65.14 | valid bpc    6.025
-----------------------------------------------------------------------------------------
PROGRESS: 98.0%
| epoch  99 |   100/  216 batches | lr 0.00000 | ms/batch 77.52 | loss  2.88 | ppl    17.73 
| epoch  99 |   200/  216 batches | lr 0.00000 | ms/batch 76.27 | loss  2.85 | ppl    17.23 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 17.09s | valid loss  4.21 | valid ppl    67.17 | valid bpc    6.070
-----------------------------------------------------------------------------------------
PROGRESS: 99.0%
| epoch 100 |   100/  216 batches | lr 0.00000 | ms/batch 77.77 | loss  2.87 | ppl    17.64 
| epoch 100 |   200/  216 batches | lr 0.00000 | ms/batch 76.00 | loss  2.82 | ppl    16.85 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 17.08s | valid loss  4.23 | valid ppl    68.82 | valid bpc    6.105
-----------------------------------------------------------------------------------------
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  4.13 | test ppl    62.04 | test bpc    5.955
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.5136, Mean Reca: 0.7043, Mean F1: 0.5853
Counter({'NP': 10224, 'VP': 4707, 'PP': 4398, 'S': 3935, 'SBAR': 1092, 'QP': 277, 'ADJP': 273, 'ADVP': 182, 'SINV': 150, 'PRN': 58, 'NX': 39, 'FRAG': 34, 'WHNP': 29, 'NAC': 15, 'SQ': 15, 'UCP': 9, 'SBARQ': 9, 'CONJP': 5, 'X': 3, 'WHPP': 2})
Counter({'NP': 14432, 'VP': 8130, 'S': 5620, 'PP': 5484, 'SBAR': 1796, 'ADJP': 649, 'QP': 490, 'ADVP': 286, 'SINV': 157, 'PRN': 128, 'NX': 95, 'FRAG': 42, 'WHNP': 37, 'UCP': 32, 'NAC': 30, 'WHPP': 25, 'CONJP': 21, 'SQ': 18, 'SBARQ': 10, 'WHADVP': 9, 'X': 6, 'WHADJP': 4, 'INTJ': 1})
SBAR: 0.6080
NP: 0.7084
VP: 0.5790
PP: 0.8020
ADJP: 0.4206
ADVP: 0.6364
5.234131667762698
-----------------------------------------------------------------------------------------
Dependency parsing performance:
Conll-U Style:
DDA: 0.077
UDA: 0.338
=========================================================================================
Loading dataset...
Loading dictionary...
Number of tokens:  10001
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer_in_parser', nhid=512, nlayers=8, front_layers=4, rear_layers=4, n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=1111, nonmono=5, cuda=True, log_interval=100, save='trained_models/structformer_in_parser_1111_44.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 38475605
Model architecture: StructFormer_In_Parser(
  (transformer_front): Transformer_Front(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(10001, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-3): 4 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
  (transformer_rear): Transformer_Rear(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(10001, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-3): 4 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (output_layer): Linear(in_features=512, out_features=10001, bias=True)
  )
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  216 batches | lr 0.00030 | ms/batch 79.85 | loss  7.29 | ppl  1472.38 
| epoch   1 |   200/  216 batches | lr 0.00030 | ms/batch 75.37 | loss  6.88 | ppl   968.61 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 17.20s | valid loss  6.74 | valid ppl   846.68 | valid bpc    9.726
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  216 batches | lr 0.00030 | ms/batch 76.76 | loss  6.81 | ppl   906.05 
| epoch   2 |   200/  216 batches | lr 0.00030 | ms/batch 75.52 | loss  6.59 | ppl   729.36 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 16.91s | valid loss  6.35 | valid ppl   575.07 | valid bpc    9.168
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  216 batches | lr 0.00030 | ms/batch 77.22 | loss  6.40 | ppl   600.57 
| epoch   3 |   200/  216 batches | lr 0.00030 | ms/batch 75.53 | loss  6.11 | ppl   450.14 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 16.96s | valid loss  5.91 | valid ppl   370.54 | valid bpc    8.533
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  216 batches | lr 0.00030 | ms/batch 77.17 | loss  5.93 | ppl   374.30 
| epoch   4 |   200/  216 batches | lr 0.00030 | ms/batch 75.49 | loss  5.74 | ppl   310.83 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 17.00s | valid loss  5.59 | valid ppl   268.08 | valid bpc    8.067
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  216 batches | lr 0.00030 | ms/batch 77.11 | loss  5.62 | ppl   274.94 
| epoch   5 |   200/  216 batches | lr 0.00030 | ms/batch 75.99 | loss  5.45 | ppl   232.90 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 17.00s | valid loss  5.40 | valid ppl   220.37 | valid bpc    7.784
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  216 batches | lr 0.00030 | ms/batch 76.97 | loss  5.39 | ppl   218.80 
| epoch   6 |   200/  216 batches | lr 0.00030 | ms/batch 76.21 | loss  5.28 | ppl   195.61 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 17.01s | valid loss  5.24 | valid ppl   189.39 | valid bpc    7.565
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  216 batches | lr 0.00030 | ms/batch 77.13 | loss  5.22 | ppl   185.14 
| epoch   7 |   200/  216 batches | lr 0.00030 | ms/batch 75.87 | loss  5.12 | ppl   167.22 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 17.02s | valid loss  5.13 | valid ppl   168.97 | valid bpc    7.401
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  216 batches | lr 0.00030 | ms/batch 76.96 | loss  5.04 | ppl   153.73 
| epoch   8 |   200/  216 batches | lr 0.00030 | ms/batch 76.27 | loss  5.02 | ppl   150.69 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 17.02s | valid loss  5.04 | valid ppl   154.77 | valid bpc    7.274
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 8.0%
| epoch   9 |   100/  216 batches | lr 0.00030 | ms/batch 77.28 | loss  4.93 | ppl   138.91 
| epoch   9 |   200/  216 batches | lr 0.00030 | ms/batch 76.02 | loss  4.87 | ppl   129.85 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 17.03s | valid loss  4.94 | valid ppl   140.41 | valid bpc    7.134
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  216 batches | lr 0.00030 | ms/batch 77.43 | loss  4.83 | ppl   124.75 
| epoch  10 |   200/  216 batches | lr 0.00030 | ms/batch 75.79 | loss  4.76 | ppl   116.85 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 17.03s | valid loss  4.84 | valid ppl   126.29 | valid bpc    6.981
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  216 batches | lr 0.00030 | ms/batch 77.56 | loss  4.75 | ppl   115.13 
| epoch  11 |   200/  216 batches | lr 0.00030 | ms/batch 75.87 | loss  4.64 | ppl   103.55 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 17.04s | valid loss  4.77 | valid ppl   118.12 | valid bpc    6.884
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  216 batches | lr 0.00030 | ms/batch 77.22 | loss  4.63 | ppl   102.28 
| epoch  12 |   200/  216 batches | lr 0.00030 | ms/batch 76.13 | loss  4.60 | ppl    99.61 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 17.03s | valid loss  4.71 | valid ppl   111.40 | valid bpc    6.800
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 12.0%
| epoch  13 |   100/  216 batches | lr 0.00030 | ms/batch 77.08 | loss  4.53 | ppl    92.77 
| epoch  13 |   200/  216 batches | lr 0.00030 | ms/batch 76.08 | loss  4.49 | ppl    88.69 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 17.02s | valid loss  4.69 | valid ppl   108.44 | valid bpc    6.761
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 13.0%
| epoch  14 |   100/  216 batches | lr 0.00030 | ms/batch 77.27 | loss  4.46 | ppl    86.18 
| epoch  14 |   200/  216 batches | lr 0.00030 | ms/batch 75.91 | loss  4.41 | ppl    81.99 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 17.02s | valid loss  4.60 | valid ppl    99.96 | valid bpc    6.643
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  216 batches | lr 0.00030 | ms/batch 77.02 | loss  4.37 | ppl    79.41 
| epoch  15 |   200/  216 batches | lr 0.00030 | ms/batch 76.22 | loss  4.37 | ppl    78.70 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 17.03s | valid loss  4.57 | valid ppl    96.25 | valid bpc    6.589
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 15.0%
| epoch  16 |   100/  216 batches | lr 0.00030 | ms/batch 77.15 | loss  4.31 | ppl    74.11 
| epoch  16 |   200/  216 batches | lr 0.00030 | ms/batch 76.31 | loss  4.29 | ppl    72.68 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 17.03s | valid loss  4.50 | valid ppl    90.40 | valid bpc    6.498
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 16.0%
| epoch  17 |   100/  216 batches | lr 0.00030 | ms/batch 77.12 | loss  4.26 | ppl    70.47 
| epoch  17 |   200/  216 batches | lr 0.00030 | ms/batch 76.23 | loss  4.22 | ppl    68.05 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 17.03s | valid loss  4.50 | valid ppl    89.74 | valid bpc    6.488
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 17.0%
| epoch  18 |   100/  216 batches | lr 0.00030 | ms/batch 77.12 | loss  4.20 | ppl    66.56 
| epoch  18 |   200/  216 batches | lr 0.00030 | ms/batch 76.16 | loss  4.15 | ppl    63.55 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 17.02s | valid loss  4.48 | valid ppl    88.59 | valid bpc    6.469
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 18.0%
| epoch  19 |   100/  216 batches | lr 0.00030 | ms/batch 77.01 | loss  4.12 | ppl    61.76 
| epoch  19 |   200/  216 batches | lr 0.00030 | ms/batch 75.88 | loss  4.07 | ppl    58.59 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 17.02s | valid loss  4.47 | valid ppl    87.17 | valid bpc    6.446
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 19.0%
| epoch  20 |   100/  216 batches | lr 0.00030 | ms/batch 77.17 | loss  4.05 | ppl    57.61 
| epoch  20 |   200/  216 batches | lr 0.00030 | ms/batch 75.80 | loss  4.04 | ppl    57.03 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 17.01s | valid loss  4.46 | valid ppl    86.08 | valid bpc    6.428
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 20.0%
| epoch  21 |   100/  216 batches | lr 0.00030 | ms/batch 77.36 | loss  4.00 | ppl    54.61 
| epoch  21 |   200/  216 batches | lr 0.00030 | ms/batch 76.04 | loss  3.97 | ppl    53.23 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 17.03s | valid loss  4.37 | valid ppl    79.42 | valid bpc    6.311
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 21.0%
| epoch  22 |   100/  216 batches | lr 0.00030 | ms/batch 77.15 | loss  3.95 | ppl    51.82 
| epoch  22 |   200/  216 batches | lr 0.00030 | ms/batch 76.20 | loss  3.94 | ppl    51.31 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 17.03s | valid loss  4.41 | valid ppl    82.50 | valid bpc    6.366
-----------------------------------------------------------------------------------------
PROGRESS: 22.0%
| epoch  23 |   100/  216 batches | lr 0.00030 | ms/batch 77.45 | loss  3.90 | ppl    49.38 
| epoch  23 |   200/  216 batches | lr 0.00030 | ms/batch 76.07 | loss  3.90 | ppl    49.21 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 17.05s | valid loss  4.36 | valid ppl    78.17 | valid bpc    6.289
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 23.0%
| epoch  24 |   100/  216 batches | lr 0.00030 | ms/batch 77.12 | loss  3.84 | ppl    46.47 
| epoch  24 |   200/  216 batches | lr 0.00030 | ms/batch 76.19 | loss  3.82 | ppl    45.82 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 17.02s | valid loss  4.32 | valid ppl    74.97 | valid bpc    6.228
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 24.0%
| epoch  25 |   100/  216 batches | lr 0.00030 | ms/batch 77.21 | loss  3.80 | ppl    44.65 
| epoch  25 |   200/  216 batches | lr 0.00030 | ms/batch 76.04 | loss  3.76 | ppl    43.10 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 17.02s | valid loss  4.31 | valid ppl    74.18 | valid bpc    6.213
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 25.0%
| epoch  26 |   100/  216 batches | lr 0.00030 | ms/batch 77.34 | loss  3.76 | ppl    43.01 
| epoch  26 |   200/  216 batches | lr 0.00030 | ms/batch 75.77 | loss  3.73 | ppl    41.83 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 17.02s | valid loss  4.33 | valid ppl    75.95 | valid bpc    6.247
-----------------------------------------------------------------------------------------
PROGRESS: 26.0%
| epoch  27 |   100/  216 batches | lr 0.00030 | ms/batch 77.26 | loss  3.70 | ppl    40.25 
| epoch  27 |   200/  216 batches | lr 0.00030 | ms/batch 76.07 | loss  3.69 | ppl    40.00 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 17.03s | valid loss  4.32 | valid ppl    75.16 | valid bpc    6.232
-----------------------------------------------------------------------------------------
PROGRESS: 27.0%
| epoch  28 |   100/  216 batches | lr 0.00030 | ms/batch 77.47 | loss  3.65 | ppl    38.62 
| epoch  28 |   200/  216 batches | lr 0.00030 | ms/batch 75.97 | loss  3.68 | ppl    39.62 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 17.04s | valid loss  4.29 | valid ppl    73.15 | valid bpc    6.193
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  216 batches | lr 0.00030 | ms/batch 77.14 | loss  3.63 | ppl    37.73 
| epoch  29 |   200/  216 batches | lr 0.00030 | ms/batch 75.66 | loss  3.60 | ppl    36.76 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 17.02s | valid loss  4.31 | valid ppl    74.43 | valid bpc    6.218
-----------------------------------------------------------------------------------------
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  216 batches | lr 0.00030 | ms/batch 77.40 | loss  3.57 | ppl    35.58 
| epoch  30 |   200/  216 batches | lr 0.00030 | ms/batch 75.86 | loss  3.59 | ppl    36.15 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 17.03s | valid loss  4.32 | valid ppl    75.52 | valid bpc    6.239
-----------------------------------------------------------------------------------------
PROGRESS: 30.0%
| epoch  31 |   100/  216 batches | lr 0.00030 | ms/batch 77.17 | loss  3.55 | ppl    34.94 
| epoch  31 |   200/  216 batches | lr 0.00030 | ms/batch 76.26 | loss  3.53 | ppl    34.28 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 17.04s | valid loss  4.29 | valid ppl    72.62 | valid bpc    6.182
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 31.0%
| epoch  32 |   100/  216 batches | lr 0.00030 | ms/batch 77.36 | loss  3.51 | ppl    33.43 
| epoch  32 |   200/  216 batches | lr 0.00030 | ms/batch 75.86 | loss  3.48 | ppl    32.38 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 17.02s | valid loss  4.23 | valid ppl    69.00 | valid bpc    6.109
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 32.0%
| epoch  33 |   100/  216 batches | lr 0.00030 | ms/batch 77.70 | loss  3.47 | ppl    32.04 
| epoch  33 |   200/  216 batches | lr 0.00030 | ms/batch 75.58 | loss  3.47 | ppl    32.05 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 17.02s | valid loss  4.26 | valid ppl    70.53 | valid bpc    6.140
-----------------------------------------------------------------------------------------
PROGRESS: 33.0%
| epoch  34 |   100/  216 batches | lr 0.00030 | ms/batch 77.29 | loss  3.43 | ppl    31.01 
| epoch  34 |   200/  216 batches | lr 0.00030 | ms/batch 76.02 | loss  3.42 | ppl    30.51 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 17.03s | valid loss  4.28 | valid ppl    72.45 | valid bpc    6.179
-----------------------------------------------------------------------------------------
PROGRESS: 34.0%
| epoch  35 |   100/  216 batches | lr 0.00030 | ms/batch 77.28 | loss  3.38 | ppl    29.35 
| epoch  35 |   200/  216 batches | lr 0.00030 | ms/batch 75.99 | loss  3.38 | ppl    29.29 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 17.02s | valid loss  4.30 | valid ppl    73.58 | valid bpc    6.201
-----------------------------------------------------------------------------------------
PROGRESS: 35.0%
| epoch  36 |   100/  216 batches | lr 0.00015 | ms/batch 77.71 | loss  3.28 | ppl    26.44 
| epoch  36 |   200/  216 batches | lr 0.00015 | ms/batch 75.79 | loss  3.27 | ppl    26.23 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 17.04s | valid loss  4.21 | valid ppl    67.05 | valid bpc    6.067
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 36.0%
| epoch  37 |   100/  216 batches | lr 0.00015 | ms/batch 77.50 | loss  3.25 | ppl    25.73 
| epoch  37 |   200/  216 batches | lr 0.00015 | ms/batch 75.80 | loss  3.22 | ppl    24.97 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 17.03s | valid loss  4.20 | valid ppl    66.86 | valid bpc    6.063
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 37.0%
| epoch  38 |   100/  216 batches | lr 0.00015 | ms/batch 77.30 | loss  3.21 | ppl    24.70 
| epoch  38 |   200/  216 batches | lr 0.00015 | ms/batch 76.00 | loss  3.19 | ppl    24.31 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 17.02s | valid loss  4.22 | valid ppl    68.07 | valid bpc    6.089
-----------------------------------------------------------------------------------------
PROGRESS: 38.0%
| epoch  39 |   100/  216 batches | lr 0.00015 | ms/batch 77.57 | loss  3.17 | ppl    23.86 
| epoch  39 |   200/  216 batches | lr 0.00015 | ms/batch 75.73 | loss  3.18 | ppl    23.95 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 17.04s | valid loss  4.21 | valid ppl    67.68 | valid bpc    6.081
-----------------------------------------------------------------------------------------
PROGRESS: 39.0%
| epoch  40 |   100/  216 batches | lr 0.00015 | ms/batch 77.26 | loss  3.15 | ppl    23.34 
| epoch  40 |   200/  216 batches | lr 0.00015 | ms/batch 75.93 | loss  3.14 | ppl    23.16 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 17.03s | valid loss  4.26 | valid ppl    70.71 | valid bpc    6.144
-----------------------------------------------------------------------------------------
PROGRESS: 40.0%
| epoch  41 |   100/  216 batches | lr 0.00007 | ms/batch 77.45 | loss  3.10 | ppl    22.25 
| epoch  41 |   200/  216 batches | lr 0.00007 | ms/batch 75.97 | loss  3.06 | ppl    21.43 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 17.04s | valid loss  4.22 | valid ppl    68.14 | valid bpc    6.090
-----------------------------------------------------------------------------------------
PROGRESS: 41.0%
| epoch  42 |   100/  216 batches | lr 0.00007 | ms/batch 77.44 | loss  3.06 | ppl    21.40 
| epoch  42 |   200/  216 batches | lr 0.00007 | ms/batch 75.88 | loss  3.04 | ppl    20.87 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 17.03s | valid loss  4.21 | valid ppl    67.22 | valid bpc    6.071
-----------------------------------------------------------------------------------------
PROGRESS: 42.0%
| epoch  43 |   100/  216 batches | lr 0.00007 | ms/batch 77.01 | loss  3.03 | ppl    20.64 
| epoch  43 |   200/  216 batches | lr 0.00007 | ms/batch 76.41 | loss  3.04 | ppl    20.97 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 17.04s | valid loss  4.22 | valid ppl    68.34 | valid bpc    6.095
-----------------------------------------------------------------------------------------
PROGRESS: 43.0%
| epoch  44 |   100/  216 batches | lr 0.00004 | ms/batch 77.17 | loss  3.03 | ppl    20.79 
| epoch  44 |   200/  216 batches | lr 0.00004 | ms/batch 76.06 | loss  2.98 | ppl    19.63 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 17.03s | valid loss  4.24 | valid ppl    69.32 | valid bpc    6.115
-----------------------------------------------------------------------------------------
PROGRESS: 44.0%
| epoch  45 |   100/  216 batches | lr 0.00004 | ms/batch 77.75 | loss  3.02 | ppl    20.41 
| epoch  45 |   200/  216 batches | lr 0.00004 | ms/batch 75.44 | loss  2.97 | ppl    19.51 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 17.02s | valid loss  4.18 | valid ppl    65.25 | valid bpc    6.028
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 45.0%
| epoch  46 |   100/  216 batches | lr 0.00004 | ms/batch 76.78 | loss  2.98 | ppl    19.59 
| epoch  46 |   200/  216 batches | lr 0.00004 | ms/batch 76.45 | loss  2.97 | ppl    19.57 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 17.02s | valid loss  4.21 | valid ppl    67.55 | valid bpc    6.078
-----------------------------------------------------------------------------------------
PROGRESS: 46.0%
| epoch  47 |   100/  216 batches | lr 0.00004 | ms/batch 77.45 | loss  2.98 | ppl    19.78 
| epoch  47 |   200/  216 batches | lr 0.00004 | ms/batch 75.88 | loss  2.94 | ppl    18.90 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 17.02s | valid loss  4.22 | valid ppl    67.73 | valid bpc    6.082
-----------------------------------------------------------------------------------------
PROGRESS: 47.0%
| epoch  48 |   100/  216 batches | lr 0.00004 | ms/batch 77.41 | loss  2.99 | ppl    19.86 
| epoch  48 |   200/  216 batches | lr 0.00004 | ms/batch 75.90 | loss  2.93 | ppl    18.72 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 17.03s | valid loss  4.19 | valid ppl    65.82 | valid bpc    6.041
-----------------------------------------------------------------------------------------
PROGRESS: 48.0%
| epoch  49 |   100/  216 batches | lr 0.00002 | ms/batch 77.32 | loss  2.96 | ppl    19.24 
| epoch  49 |   200/  216 batches | lr 0.00002 | ms/batch 75.95 | loss  2.95 | ppl    19.10 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 17.04s | valid loss  4.19 | valid ppl    66.23 | valid bpc    6.049
-----------------------------------------------------------------------------------------
PROGRESS: 49.0%
| epoch  50 |   100/  216 batches | lr 0.00002 | ms/batch 77.61 | loss  2.96 | ppl    19.31 
| epoch  50 |   200/  216 batches | lr 0.00002 | ms/batch 75.90 | loss  2.90 | ppl    18.17 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 17.04s | valid loss  4.17 | valid ppl    64.77 | valid bpc    6.017
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 50.0%
| epoch  51 |   100/  216 batches | lr 0.00002 | ms/batch 77.02 | loss  2.96 | ppl    19.21 
| epoch  51 |   200/  216 batches | lr 0.00002 | ms/batch 75.87 | loss  2.93 | ppl    18.65 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 17.02s | valid loss  4.16 | valid ppl    64.13 | valid bpc    6.003
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 51.0%
| epoch  52 |   100/  216 batches | lr 0.00002 | ms/batch 77.55 | loss  2.94 | ppl    18.93 
| epoch  52 |   200/  216 batches | lr 0.00002 | ms/batch 75.74 | loss  2.92 | ppl    18.45 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 17.03s | valid loss  4.19 | valid ppl    65.83 | valid bpc    6.041
-----------------------------------------------------------------------------------------
PROGRESS: 52.0%
| epoch  53 |   100/  216 batches | lr 0.00002 | ms/batch 77.13 | loss  2.97 | ppl    19.56 
| epoch  53 |   200/  216 batches | lr 0.00002 | ms/batch 76.29 | loss  2.88 | ppl    17.81 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 17.04s | valid loss  4.17 | valid ppl    64.62 | valid bpc    6.014
-----------------------------------------------------------------------------------------
PROGRESS: 53.0%
| epoch  54 |   100/  216 batches | lr 0.00002 | ms/batch 77.01 | loss  2.93 | ppl    18.73 
| epoch  54 |   200/  216 batches | lr 0.00002 | ms/batch 76.03 | loss  2.89 | ppl    18.07 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 17.03s | valid loss  4.21 | valid ppl    67.33 | valid bpc    6.073
-----------------------------------------------------------------------------------------
PROGRESS: 54.0%
| epoch  55 |   100/  216 batches | lr 0.00001 | ms/batch 77.36 | loss  2.93 | ppl    18.81 
| epoch  55 |   200/  216 batches | lr 0.00001 | ms/batch 75.96 | loss  2.91 | ppl    18.38 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 17.03s | valid loss  4.17 | valid ppl    64.73 | valid bpc    6.016
-----------------------------------------------------------------------------------------
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  216 batches | lr 0.00001 | ms/batch 77.24 | loss  2.93 | ppl    18.70 
| epoch  56 |   200/  216 batches | lr 0.00001 | ms/batch 76.02 | loss  2.88 | ppl    17.79 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 17.03s | valid loss  4.14 | valid ppl    62.52 | valid bpc    5.966
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  216 batches | lr 0.00001 | ms/batch 77.13 | loss  2.90 | ppl    18.18 
| epoch  57 |   200/  216 batches | lr 0.00001 | ms/batch 76.17 | loss  2.90 | ppl    18.24 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 17.03s | valid loss  4.18 | valid ppl    65.10 | valid bpc    6.025
-----------------------------------------------------------------------------------------
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  216 batches | lr 0.00001 | ms/batch 77.24 | loss  2.90 | ppl    18.18 
| epoch  58 |   200/  216 batches | lr 0.00001 | ms/batch 76.06 | loss  2.91 | ppl    18.39 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 17.02s | valid loss  4.17 | valid ppl    64.43 | valid bpc    6.010
-----------------------------------------------------------------------------------------
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  216 batches | lr 0.00001 | ms/batch 77.29 | loss  2.91 | ppl    18.44 
| epoch  59 |   200/  216 batches | lr 0.00001 | ms/batch 76.08 | loss  2.89 | ppl    17.91 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 17.03s | valid loss  4.19 | valid ppl    66.03 | valid bpc    6.045
-----------------------------------------------------------------------------------------
PROGRESS: 59.0%
| epoch  60 |   100/  216 batches | lr 0.00000 | ms/batch 77.07 | loss  2.91 | ppl    18.35 
| epoch  60 |   200/  216 batches | lr 0.00000 | ms/batch 76.49 | loss  2.88 | ppl    17.82 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 17.04s | valid loss  4.18 | valid ppl    65.52 | valid bpc    6.034
-----------------------------------------------------------------------------------------
PROGRESS: 60.0%
| epoch  61 |   100/  216 batches | lr 0.00000 | ms/batch 77.01 | loss  2.89 | ppl    17.92 
| epoch  61 |   200/  216 batches | lr 0.00000 | ms/batch 76.44 | loss  2.91 | ppl    18.28 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 17.05s | valid loss  4.23 | valid ppl    68.53 | valid bpc    6.099
-----------------------------------------------------------------------------------------
PROGRESS: 61.0%
| epoch  62 |   100/  216 batches | lr 0.00000 | ms/batch 77.05 | loss  2.91 | ppl    18.37 
| epoch  62 |   200/  216 batches | lr 0.00000 | ms/batch 76.15 | loss  2.88 | ppl    17.87 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 17.06s | valid loss  4.16 | valid ppl    63.76 | valid bpc    5.994
-----------------------------------------------------------------------------------------
PROGRESS: 62.0%
| epoch  63 |   100/  216 batches | lr 0.00000 | ms/batch 77.39 | loss  2.94 | ppl    18.93 
| epoch  63 |   200/  216 batches | lr 0.00000 | ms/batch 75.92 | loss  2.87 | ppl    17.71 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 17.03s | valid loss  4.24 | valid ppl    69.46 | valid bpc    6.118
-----------------------------------------------------------------------------------------
PROGRESS: 63.0%
| epoch  64 |   100/  216 batches | lr 0.00000 | ms/batch 77.11 | loss  2.90 | ppl    18.13 
| epoch  64 |   200/  216 batches | lr 0.00000 | ms/batch 76.34 | loss  2.86 | ppl    17.42 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 17.04s | valid loss  4.24 | valid ppl    69.34 | valid bpc    6.116
-----------------------------------------------------------------------------------------
PROGRESS: 64.0%
| epoch  65 |   100/  216 batches | lr 0.00000 | ms/batch 77.29 | loss  2.91 | ppl    18.32 
| epoch  65 |   200/  216 batches | lr 0.00000 | ms/batch 76.12 | loss  2.88 | ppl    17.81 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 17.03s | valid loss  4.21 | valid ppl    67.62 | valid bpc    6.079
-----------------------------------------------------------------------------------------
PROGRESS: 65.0%
| epoch  66 |   100/  216 batches | lr 0.00000 | ms/batch 77.11 | loss  2.92 | ppl    18.55 
| epoch  66 |   200/  216 batches | lr 0.00000 | ms/batch 76.24 | loss  2.89 | ppl    17.91 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 17.03s | valid loss  4.18 | valid ppl    65.37 | valid bpc    6.031
-----------------------------------------------------------------------------------------
PROGRESS: 66.0%
| epoch  67 |   100/  216 batches | lr 0.00000 | ms/batch 77.27 | loss  2.91 | ppl    18.29 
| epoch  67 |   200/  216 batches | lr 0.00000 | ms/batch 76.14 | loss  2.88 | ppl    17.79 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 17.04s | valid loss  4.20 | valid ppl    66.95 | valid bpc    6.065
-----------------------------------------------------------------------------------------
PROGRESS: 67.0%
| epoch  68 |   100/  216 batches | lr 0.00000 | ms/batch 77.31 | loss  2.90 | ppl    18.22 
| epoch  68 |   200/  216 batches | lr 0.00000 | ms/batch 76.69 | loss  2.85 | ppl    17.27 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 17.10s | valid loss  4.15 | valid ppl    63.20 | valid bpc    5.982
-----------------------------------------------------------------------------------------
PROGRESS: 68.0%
| epoch  69 |   100/  216 batches | lr 0.00000 | ms/batch 77.54 | loss  2.89 | ppl    18.01 
| epoch  69 |   200/  216 batches | lr 0.00000 | ms/batch 75.98 | loss  2.88 | ppl    17.74 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 17.05s | valid loss  4.17 | valid ppl    64.89 | valid bpc    6.020
-----------------------------------------------------------------------------------------
PROGRESS: 69.0%
| epoch  70 |   100/  216 batches | lr 0.00000 | ms/batch 77.02 | loss  2.91 | ppl    18.35 
| epoch  70 |   200/  216 batches | lr 0.00000 | ms/batch 76.28 | loss  2.89 | ppl    18.07 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 17.03s | valid loss  4.26 | valid ppl    70.60 | valid bpc    6.142
-----------------------------------------------------------------------------------------
PROGRESS: 70.0%
| epoch  71 |   100/  216 batches | lr 0.00000 | ms/batch 77.19 | loss  2.91 | ppl    18.44 
| epoch  71 |   200/  216 batches | lr 0.00000 | ms/batch 76.22 | loss  2.87 | ppl    17.67 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 17.03s | valid loss  4.14 | valid ppl    63.01 | valid bpc    5.978
-----------------------------------------------------------------------------------------
PROGRESS: 71.0%
| epoch  72 |   100/  216 batches | lr 0.00000 | ms/batch 77.21 | loss  2.90 | ppl    18.24 
| epoch  72 |   200/  216 batches | lr 0.00000 | ms/batch 75.84 | loss  2.87 | ppl    17.72 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 17.03s | valid loss  4.21 | valid ppl    67.51 | valid bpc    6.077
-----------------------------------------------------------------------------------------
PROGRESS: 72.0%
| epoch  73 |   100/  216 batches | lr 0.00000 | ms/batch 77.19 | loss  2.90 | ppl    18.19 
| epoch  73 |   200/  216 batches | lr 0.00000 | ms/batch 75.87 | loss  2.88 | ppl    17.86 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 17.04s | valid loss  4.19 | valid ppl    66.10 | valid bpc    6.047
-----------------------------------------------------------------------------------------
PROGRESS: 73.0%
| epoch  74 |   100/  216 batches | lr 0.00000 | ms/batch 77.58 | loss  2.91 | ppl    18.36 
| epoch  74 |   200/  216 batches | lr 0.00000 | ms/batch 75.85 | loss  2.85 | ppl    17.24 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 17.04s | valid loss  4.19 | valid ppl    66.35 | valid bpc    6.052
-----------------------------------------------------------------------------------------
PROGRESS: 74.0%
| epoch  75 |   100/  216 batches | lr 0.00000 | ms/batch 77.41 | loss  2.91 | ppl    18.42 
| epoch  75 |   200/  216 batches | lr 0.00000 | ms/batch 75.98 | loss  2.88 | ppl    17.89 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 17.03s | valid loss  4.20 | valid ppl    66.61 | valid bpc    6.058
-----------------------------------------------------------------------------------------
PROGRESS: 75.0%
| epoch  76 |   100/  216 batches | lr 0.00000 | ms/batch 77.17 | loss  2.88 | ppl    17.86 
| epoch  76 |   200/  216 batches | lr 0.00000 | ms/batch 76.39 | loss  2.87 | ppl    17.69 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 17.04s | valid loss  4.21 | valid ppl    67.22 | valid bpc    6.071
-----------------------------------------------------------------------------------------
PROGRESS: 76.0%
| epoch  77 |   100/  216 batches | lr 0.00000 | ms/batch 77.43 | loss  2.92 | ppl    18.46 
| epoch  77 |   200/  216 batches | lr 0.00000 | ms/batch 75.83 | loss  2.87 | ppl    17.72 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 17.03s | valid loss  4.24 | valid ppl    69.43 | valid bpc    6.118
-----------------------------------------------------------------------------------------
PROGRESS: 77.0%
| epoch  78 |   100/  216 batches | lr 0.00000 | ms/batch 76.92 | loss  2.91 | ppl    18.39 
| epoch  78 |   200/  216 batches | lr 0.00000 | ms/batch 76.45 | loss  2.86 | ppl    17.38 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 17.03s | valid loss  4.23 | valid ppl    68.38 | valid bpc    6.095
-----------------------------------------------------------------------------------------
PROGRESS: 78.0%
| epoch  79 |   100/  216 batches | lr 0.00000 | ms/batch 77.63 | loss  2.90 | ppl    18.17 
| epoch  79 |   200/  216 batches | lr 0.00000 | ms/batch 75.71 | loss  2.86 | ppl    17.51 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 17.03s | valid loss  4.19 | valid ppl    65.99 | valid bpc    6.044
-----------------------------------------------------------------------------------------
PROGRESS: 79.0%
| epoch  80 |   100/  216 batches | lr 0.00000 | ms/batch 77.78 | loss  2.91 | ppl    18.33 
| epoch  80 |   200/  216 batches | lr 0.00000 | ms/batch 75.78 | loss  2.86 | ppl    17.43 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 17.05s | valid loss  4.22 | valid ppl    67.86 | valid bpc    6.085
-----------------------------------------------------------------------------------------
PROGRESS: 80.0%
| epoch  81 |   100/  216 batches | lr 0.00000 | ms/batch 77.04 | loss  2.90 | ppl    18.12 
| epoch  81 |   200/  216 batches | lr 0.00000 | ms/batch 76.06 | loss  2.88 | ppl    17.76 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 17.04s | valid loss  4.16 | valid ppl    64.23 | valid bpc    6.005
-----------------------------------------------------------------------------------------
PROGRESS: 81.0%
| epoch  82 |   100/  216 batches | lr 0.00000 | ms/batch 76.90 | loss  2.91 | ppl    18.36 
| epoch  82 |   200/  216 batches | lr 0.00000 | ms/batch 76.37 | loss  2.87 | ppl    17.57 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 17.03s | valid loss  4.20 | valid ppl    66.84 | valid bpc    6.063
-----------------------------------------------------------------------------------------
PROGRESS: 82.0%
| epoch  83 |   100/  216 batches | lr 0.00000 | ms/batch 77.48 | loss  2.91 | ppl    18.40 
| epoch  83 |   200/  216 batches | lr 0.00000 | ms/batch 75.95 | loss  2.86 | ppl    17.46 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 17.05s | valid loss  4.21 | valid ppl    67.52 | valid bpc    6.077
-----------------------------------------------------------------------------------------
PROGRESS: 83.0%
| epoch  84 |   100/  216 batches | lr 0.00000 | ms/batch 77.23 | loss  2.92 | ppl    18.51 
| epoch  84 |   200/  216 batches | lr 0.00000 | ms/batch 76.15 | loss  2.86 | ppl    17.50 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 17.03s | valid loss  4.24 | valid ppl    69.23 | valid bpc    6.113
-----------------------------------------------------------------------------------------
PROGRESS: 84.0%
| epoch  85 |   100/  216 batches | lr 0.00000 | ms/batch 77.42 | loss  2.91 | ppl    18.39 
| epoch  85 |   200/  216 batches | lr 0.00000 | ms/batch 76.01 | loss  2.87 | ppl    17.63 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 17.04s | valid loss  4.15 | valid ppl    63.23 | valid bpc    5.983
-----------------------------------------------------------------------------------------
PROGRESS: 85.0%
| epoch  86 |   100/  216 batches | lr 0.00000 | ms/batch 77.30 | loss  2.91 | ppl    18.33 
| epoch  86 |   200/  216 batches | lr 0.00000 | ms/batch 75.91 | loss  2.87 | ppl    17.62 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 17.03s | valid loss  4.23 | valid ppl    68.81 | valid bpc    6.104
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  216 batches | lr 0.00000 | ms/batch 77.09 | loss  2.90 | ppl    18.26 
| epoch  87 |   200/  216 batches | lr 0.00000 | ms/batch 75.83 | loss  2.88 | ppl    17.80 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 17.03s | valid loss  4.18 | valid ppl    65.62 | valid bpc    6.036
-----------------------------------------------------------------------------------------
PROGRESS: 87.0%
| epoch  88 |   100/  216 batches | lr 0.00000 | ms/batch 76.96 | loss  2.91 | ppl    18.31 
| epoch  88 |   200/  216 batches | lr 0.00000 | ms/batch 76.24 | loss  2.87 | ppl    17.58 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 17.02s | valid loss  4.18 | valid ppl    65.41 | valid bpc    6.031
-----------------------------------------------------------------------------------------
PROGRESS: 88.0%
| epoch  89 |   100/  216 batches | lr 0.00000 | ms/batch 77.13 | loss  2.87 | ppl    17.72 
| epoch  89 |   200/  216 batches | lr 0.00000 | ms/batch 76.23 | loss  2.89 | ppl    18.03 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 17.04s | valid loss  4.19 | valid ppl    66.19 | valid bpc    6.049
-----------------------------------------------------------------------------------------
PROGRESS: 89.0%
| epoch  90 |   100/  216 batches | lr 0.00000 | ms/batch 76.95 | loss  2.92 | ppl    18.45 
| epoch  90 |   200/  216 batches | lr 0.00000 | ms/batch 76.40 | loss  2.88 | ppl    17.74 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 17.03s | valid loss  4.24 | valid ppl    69.38 | valid bpc    6.117
-----------------------------------------------------------------------------------------
PROGRESS: 90.0%
| epoch  91 |   100/  216 batches | lr 0.00000 | ms/batch 77.18 | loss  2.89 | ppl    17.99 
| epoch  91 |   200/  216 batches | lr 0.00000 | ms/batch 75.84 | loss  2.88 | ppl    17.80 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 17.04s | valid loss  4.20 | valid ppl    66.41 | valid bpc    6.053
-----------------------------------------------------------------------------------------
PROGRESS: 91.0%
| epoch  92 |   100/  216 batches | lr 0.00000 | ms/batch 77.12 | loss  2.91 | ppl    18.43 
| epoch  92 |   200/  216 batches | lr 0.00000 | ms/batch 76.21 | loss  2.86 | ppl    17.38 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 17.03s | valid loss  4.21 | valid ppl    67.38 | valid bpc    6.074
-----------------------------------------------------------------------------------------
PROGRESS: 92.0%
| epoch  93 |   100/  216 batches | lr 0.00000 | ms/batch 77.76 | loss  2.92 | ppl    18.55 
| epoch  93 |   200/  216 batches | lr 0.00000 | ms/batch 75.60 | loss  2.85 | ppl    17.34 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 17.03s | valid loss  4.21 | valid ppl    67.32 | valid bpc    6.073
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  216 batches | lr 0.00000 | ms/batch 76.94 | loss  2.88 | ppl    17.78 
| epoch  94 |   200/  216 batches | lr 0.00000 | ms/batch 76.51 | loss  2.88 | ppl    17.81 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 17.04s | valid loss  4.21 | valid ppl    67.60 | valid bpc    6.079
-----------------------------------------------------------------------------------------
PROGRESS: 94.0%
| epoch  95 |   100/  216 batches | lr 0.00000 | ms/batch 77.45 | loss  2.90 | ppl    18.26 
| epoch  95 |   200/  216 batches | lr 0.00000 | ms/batch 75.64 | loss  2.87 | ppl    17.67 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 17.03s | valid loss  4.19 | valid ppl    66.11 | valid bpc    6.047
-----------------------------------------------------------------------------------------
PROGRESS: 95.0%
| epoch  96 |   100/  216 batches | lr 0.00000 | ms/batch 77.36 | loss  2.91 | ppl    18.35 
| epoch  96 |   200/  216 batches | lr 0.00000 | ms/batch 76.10 | loss  2.86 | ppl    17.53 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 17.05s | valid loss  4.18 | valid ppl    65.59 | valid bpc    6.035
-----------------------------------------------------------------------------------------
PROGRESS: 96.0%
| epoch  97 |   100/  216 batches | lr 0.00000 | ms/batch 77.03 | loss  2.88 | ppl    17.76 
| epoch  97 |   200/  216 batches | lr 0.00000 | ms/batch 76.36 | loss  2.88 | ppl    17.75 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 17.03s | valid loss  4.16 | valid ppl    64.23 | valid bpc    6.005
-----------------------------------------------------------------------------------------
PROGRESS: 97.0%
| epoch  98 |   100/  216 batches | lr 0.00000 | ms/batch 77.28 | loss  2.92 | ppl    18.47 
| epoch  98 |   200/  216 batches | lr 0.00000 | ms/batch 76.07 | loss  2.86 | ppl    17.46 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 17.03s | valid loss  4.21 | valid ppl    67.33 | valid bpc    6.073
-----------------------------------------------------------------------------------------
PROGRESS: 98.0%
| epoch  99 |   100/  216 batches | lr 0.00000 | ms/batch 77.35 | loss  2.90 | ppl    18.25 
| epoch  99 |   200/  216 batches | lr 0.00000 | ms/batch 76.24 | loss  2.87 | ppl    17.58 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 17.05s | valid loss  4.19 | valid ppl    66.30 | valid bpc    6.051
-----------------------------------------------------------------------------------------
PROGRESS: 99.0%
| epoch 100 |   100/  216 batches | lr 0.00000 | ms/batch 76.88 | loss  2.90 | ppl    18.17 
| epoch 100 |   200/  216 batches | lr 0.00000 | ms/batch 76.25 | loss  2.88 | ppl    17.74 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 17.03s | valid loss  4.19 | valid ppl    66.32 | valid bpc    6.051
-----------------------------------------------------------------------------------------
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  4.14 | test ppl    62.99 | test bpc    5.977
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.5052, Mean Reca: 0.6927, Mean F1: 0.5757
Counter({'NP': 10090, 'VP': 4587, 'PP': 4360, 'S': 3926, 'SBAR': 1060, 'ADJP': 290, 'QP': 281, 'ADVP': 173, 'SINV': 149, 'PRN': 60, 'NX': 45, 'FRAG': 34, 'WHNP': 27, 'SQ': 16, 'NAC': 12, 'SBARQ': 10, 'UCP': 8, 'WHPP': 6, 'CONJP': 3, 'X': 2})
Counter({'NP': 14432, 'VP': 8130, 'S': 5620, 'PP': 5484, 'SBAR': 1796, 'ADJP': 649, 'QP': 490, 'ADVP': 286, 'SINV': 157, 'PRN': 128, 'NX': 95, 'FRAG': 42, 'WHNP': 37, 'UCP': 32, 'NAC': 30, 'WHPP': 25, 'CONJP': 21, 'SQ': 18, 'SBARQ': 10, 'WHADVP': 9, 'X': 6, 'WHADJP': 4, 'INTJ': 1})
SBAR: 0.5902
NP: 0.6991
VP: 0.5642
PP: 0.7950
ADJP: 0.4468
ADVP: 0.6049
5.228026866614697
-----------------------------------------------------------------------------------------
Dependency parsing performance:
Conll-U Style:
DDA: 0.072
UDA: 0.336
=========================================================================================
Loading dataset...
Loading dictionary...
Number of tokens:  10001
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer_in_parser', nhid=512, nlayers=8, front_layers=4, rear_layers=4, n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=2222, nonmono=5, cuda=True, log_interval=100, save='trained_models/structformer_in_parser_2222_44.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 38475605
Model architecture: StructFormer_In_Parser(
  (transformer_front): Transformer_Front(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(10001, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-3): 4 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
  (transformer_rear): Transformer_Rear(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(10001, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-3): 4 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (output_layer): Linear(in_features=512, out_features=10001, bias=True)
  )
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  216 batches | lr 0.00030 | ms/batch 81.06 | loss  7.30 | ppl  1476.61 
| epoch   1 |   200/  216 batches | lr 0.00030 | ms/batch 74.85 | loss  6.87 | ppl   963.63 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 17.25s | valid loss  6.70 | valid ppl   808.79 | valid bpc    9.660
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  216 batches | lr 0.00030 | ms/batch 76.72 | loss  6.80 | ppl   894.92 
| epoch   2 |   200/  216 batches | lr 0.00030 | ms/batch 75.45 | loss  6.57 | ppl   716.83 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 16.90s | valid loss  6.38 | valid ppl   588.60 | valid bpc    9.201
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  216 batches | lr 0.00030 | ms/batch 76.47 | loss  6.35 | ppl   572.48 
| epoch   3 |   200/  216 batches | lr 0.00030 | ms/batch 76.04 | loss  6.11 | ppl   448.86 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 16.95s | valid loss  5.89 | valid ppl   362.01 | valid bpc    8.500
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  216 batches | lr 0.00030 | ms/batch 76.91 | loss  5.93 | ppl   375.82 
| epoch   4 |   200/  216 batches | lr 0.00030 | ms/batch 75.91 | loss  5.73 | ppl   307.34 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 16.98s | valid loss  5.61 | valid ppl   273.62 | valid bpc    8.096
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  216 batches | lr 0.00030 | ms/batch 77.15 | loss  5.63 | ppl   279.15 
| epoch   5 |   200/  216 batches | lr 0.00030 | ms/batch 75.95 | loss  5.46 | ppl   236.18 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 17.00s | valid loss  5.37 | valid ppl   214.46 | valid bpc    7.745
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  216 batches | lr 0.00030 | ms/batch 77.24 | loss  5.42 | ppl   225.66 
| epoch   6 |   200/  216 batches | lr 0.00030 | ms/batch 75.74 | loss  5.26 | ppl   193.02 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 17.00s | valid loss  5.21 | valid ppl   182.97 | valid bpc    7.515
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  216 batches | lr 0.00030 | ms/batch 77.39 | loss  5.20 | ppl   182.12 
| epoch   7 |   200/  216 batches | lr 0.00030 | ms/batch 75.74 | loss  5.13 | ppl   169.72 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 17.01s | valid loss  5.11 | valid ppl   165.14 | valid bpc    7.368
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  216 batches | lr 0.00030 | ms/batch 76.90 | loss  5.08 | ppl   160.64 
| epoch   8 |   200/  216 batches | lr 0.00030 | ms/batch 75.93 | loss  4.98 | ppl   145.36 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 17.01s | valid loss  5.02 | valid ppl   151.31 | valid bpc    7.241
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 8.0%
| epoch   9 |   100/  216 batches | lr 0.00030 | ms/batch 77.34 | loss  4.93 | ppl   139.05 
| epoch   9 |   200/  216 batches | lr 0.00030 | ms/batch 75.76 | loss  4.88 | ppl   131.51 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 17.01s | valid loss  4.93 | valid ppl   137.73 | valid bpc    7.106
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  216 batches | lr 0.00030 | ms/batch 77.01 | loss  4.85 | ppl   127.30 
| epoch  10 |   200/  216 batches | lr 0.00030 | ms/batch 76.40 | loss  4.78 | ppl   118.60 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 17.03s | valid loss  4.87 | valid ppl   130.81 | valid bpc    7.031
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  216 batches | lr 0.00030 | ms/batch 76.99 | loss  4.71 | ppl   110.98 
| epoch  11 |   200/  216 batches | lr 0.00030 | ms/batch 76.20 | loss  4.69 | ppl   108.48 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 17.01s | valid loss  4.79 | valid ppl   120.20 | valid bpc    6.909
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  216 batches | lr 0.00030 | ms/batch 77.02 | loss  4.64 | ppl   103.33 
| epoch  12 |   200/  216 batches | lr 0.00030 | ms/batch 76.20 | loss  4.60 | ppl    99.05 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 17.02s | valid loss  4.71 | valid ppl   110.86 | valid bpc    6.793
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 12.0%
| epoch  13 |   100/  216 batches | lr 0.00030 | ms/batch 76.78 | loss  4.56 | ppl    95.90 
| epoch  13 |   200/  216 batches | lr 0.00030 | ms/batch 76.49 | loss  4.52 | ppl    91.51 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 17.02s | valid loss  4.72 | valid ppl   111.87 | valid bpc    6.806
-----------------------------------------------------------------------------------------
PROGRESS: 13.0%
| epoch  14 |   100/  216 batches | lr 0.00030 | ms/batch 77.43 | loss  4.48 | ppl    88.60 
| epoch  14 |   200/  216 batches | lr 0.00030 | ms/batch 75.95 | loss  4.44 | ppl    84.91 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 17.03s | valid loss  4.59 | valid ppl    98.72 | valid bpc    6.625
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  216 batches | lr 0.00030 | ms/batch 77.19 | loss  4.41 | ppl    81.94 
| epoch  15 |   200/  216 batches | lr 0.00030 | ms/batch 75.74 | loss  4.35 | ppl    77.33 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 17.02s | valid loss  4.59 | valid ppl    98.76 | valid bpc    6.626
-----------------------------------------------------------------------------------------
PROGRESS: 15.0%
| epoch  16 |   100/  216 batches | lr 0.00030 | ms/batch 77.47 | loss  4.34 | ppl    76.42 
| epoch  16 |   200/  216 batches | lr 0.00030 | ms/batch 75.80 | loss  4.29 | ppl    72.61 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 17.03s | valid loss  4.52 | valid ppl    91.93 | valid bpc    6.522
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 16.0%
| epoch  17 |   100/  216 batches | lr 0.00030 | ms/batch 77.03 | loss  4.26 | ppl    70.54 
| epoch  17 |   200/  216 batches | lr 0.00030 | ms/batch 76.39 | loss  4.25 | ppl    69.82 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 17.03s | valid loss  4.50 | valid ppl    90.05 | valid bpc    6.493
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 17.0%
| epoch  18 |   100/  216 batches | lr 0.00030 | ms/batch 77.13 | loss  4.21 | ppl    67.62 
| epoch  18 |   200/  216 batches | lr 0.00030 | ms/batch 76.18 | loss  4.18 | ppl    65.60 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 17.03s | valid loss  4.44 | valid ppl    84.52 | valid bpc    6.401
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 18.0%
| epoch  19 |   100/  216 batches | lr 0.00030 | ms/batch 77.22 | loss  4.14 | ppl    63.00 
| epoch  19 |   200/  216 batches | lr 0.00030 | ms/batch 76.05 | loss  4.10 | ppl    60.55 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 17.02s | valid loss  4.45 | valid ppl    85.81 | valid bpc    6.423
-----------------------------------------------------------------------------------------
PROGRESS: 19.0%
| epoch  20 |   100/  216 batches | lr 0.00030 | ms/batch 77.45 | loss  4.06 | ppl    58.14 
| epoch  20 |   200/  216 batches | lr 0.00030 | ms/batch 75.85 | loss  4.08 | ppl    59.19 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 17.03s | valid loss  4.40 | valid ppl    81.44 | valid bpc    6.348
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 20.0%
| epoch  21 |   100/  216 batches | lr 0.00030 | ms/batch 77.20 | loss  4.02 | ppl    55.57 
| epoch  21 |   200/  216 batches | lr 0.00030 | ms/batch 76.08 | loss  4.01 | ppl    55.42 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 17.02s | valid loss  4.40 | valid ppl    81.60 | valid bpc    6.351
-----------------------------------------------------------------------------------------
PROGRESS: 21.0%
| epoch  22 |   100/  216 batches | lr 0.00030 | ms/batch 76.87 | loss  3.95 | ppl    52.12 
| epoch  22 |   200/  216 batches | lr 0.00030 | ms/batch 76.38 | loss  3.98 | ppl    53.37 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 17.03s | valid loss  4.40 | valid ppl    81.42 | valid bpc    6.347
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 22.0%
| epoch  23 |   100/  216 batches | lr 0.00030 | ms/batch 77.47 | loss  3.92 | ppl    50.32 
| epoch  23 |   200/  216 batches | lr 0.00030 | ms/batch 75.80 | loss  3.91 | ppl    50.04 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 17.02s | valid loss  4.35 | valid ppl    77.77 | valid bpc    6.281
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 23.0%
| epoch  24 |   100/  216 batches | lr 0.00030 | ms/batch 77.60 | loss  3.86 | ppl    47.62 
| epoch  24 |   200/  216 batches | lr 0.00030 | ms/batch 75.81 | loss  3.84 | ppl    46.38 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 17.02s | valid loss  4.36 | valid ppl    78.10 | valid bpc    6.287
-----------------------------------------------------------------------------------------
PROGRESS: 24.0%
| epoch  25 |   100/  216 batches | lr 0.00030 | ms/batch 77.05 | loss  3.83 | ppl    46.07 
| epoch  25 |   200/  216 batches | lr 0.00030 | ms/batch 76.29 | loss  3.82 | ppl    45.66 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 17.02s | valid loss  4.30 | valid ppl    73.97 | valid bpc    6.209
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 25.0%
| epoch  26 |   100/  216 batches | lr 0.00030 | ms/batch 77.10 | loss  3.78 | ppl    43.62 
| epoch  26 |   200/  216 batches | lr 0.00030 | ms/batch 76.18 | loss  3.78 | ppl    43.72 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 17.02s | valid loss  4.31 | valid ppl    74.73 | valid bpc    6.224
-----------------------------------------------------------------------------------------
PROGRESS: 26.0%
| epoch  27 |   100/  216 batches | lr 0.00030 | ms/batch 77.12 | loss  3.72 | ppl    41.32 
| epoch  27 |   200/  216 batches | lr 0.00030 | ms/batch 76.16 | loss  3.70 | ppl    40.54 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 17.02s | valid loss  4.31 | valid ppl    74.44 | valid bpc    6.218
-----------------------------------------------------------------------------------------
PROGRESS: 27.0%
| epoch  28 |   100/  216 batches | lr 0.00030 | ms/batch 77.44 | loss  3.71 | ppl    40.79 
| epoch  28 |   200/  216 batches | lr 0.00030 | ms/batch 75.84 | loss  3.67 | ppl    39.37 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 17.04s | valid loss  4.27 | valid ppl    71.51 | valid bpc    6.160
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  216 batches | lr 0.00030 | ms/batch 77.17 | loss  3.64 | ppl    37.92 
| epoch  29 |   200/  216 batches | lr 0.00030 | ms/batch 76.18 | loss  3.65 | ppl    38.43 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 17.02s | valid loss  4.28 | valid ppl    72.39 | valid bpc    6.178
-----------------------------------------------------------------------------------------
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  216 batches | lr 0.00030 | ms/batch 77.45 | loss  3.63 | ppl    37.57 
| epoch  30 |   200/  216 batches | lr 0.00030 | ms/batch 75.74 | loss  3.56 | ppl    35.14 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 17.03s | valid loss  4.29 | valid ppl    72.99 | valid bpc    6.190
-----------------------------------------------------------------------------------------
PROGRESS: 30.0%
| epoch  31 |   100/  216 batches | lr 0.00030 | ms/batch 77.31 | loss  3.55 | ppl    34.95 
| epoch  31 |   200/  216 batches | lr 0.00030 | ms/batch 76.08 | loss  3.56 | ppl    35.08 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 17.03s | valid loss  4.26 | valid ppl    70.73 | valid bpc    6.144
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 31.0%
| epoch  32 |   100/  216 batches | lr 0.00030 | ms/batch 77.06 | loss  3.51 | ppl    33.48 
| epoch  32 |   200/  216 batches | lr 0.00030 | ms/batch 76.12 | loss  3.52 | ppl    33.92 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 17.01s | valid loss  4.27 | valid ppl    71.56 | valid bpc    6.161
-----------------------------------------------------------------------------------------
PROGRESS: 32.0%
| epoch  33 |   100/  216 batches | lr 0.00030 | ms/batch 76.93 | loss  3.47 | ppl    32.00 
| epoch  33 |   200/  216 batches | lr 0.00030 | ms/batch 76.43 | loss  3.48 | ppl    32.60 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 17.03s | valid loss  4.28 | valid ppl    71.95 | valid bpc    6.169
-----------------------------------------------------------------------------------------
PROGRESS: 33.0%
| epoch  34 |   100/  216 batches | lr 0.00030 | ms/batch 77.47 | loss  3.43 | ppl    30.94 
| epoch  34 |   200/  216 batches | lr 0.00030 | ms/batch 75.93 | loss  3.47 | ppl    32.06 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 17.03s | valid loss  4.22 | valid ppl    67.82 | valid bpc    6.084
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 34.0%
| epoch  35 |   100/  216 batches | lr 0.00030 | ms/batch 77.16 | loss  3.40 | ppl    30.05 
| epoch  35 |   200/  216 batches | lr 0.00030 | ms/batch 75.97 | loss  3.41 | ppl    30.18 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 17.01s | valid loss  4.27 | valid ppl    71.19 | valid bpc    6.154
-----------------------------------------------------------------------------------------
PROGRESS: 35.0%
| epoch  36 |   100/  216 batches | lr 0.00030 | ms/batch 77.00 | loss  3.36 | ppl    28.68 
| epoch  36 |   200/  216 batches | lr 0.00030 | ms/batch 76.20 | loss  3.39 | ppl    29.53 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 17.01s | valid loss  4.27 | valid ppl    71.71 | valid bpc    6.164
-----------------------------------------------------------------------------------------
PROGRESS: 36.0%
| epoch  37 |   100/  216 batches | lr 0.00030 | ms/batch 77.50 | loss  3.34 | ppl    28.26 
| epoch  37 |   200/  216 batches | lr 0.00030 | ms/batch 75.80 | loss  3.33 | ppl    27.82 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 17.02s | valid loss  4.29 | valid ppl    72.91 | valid bpc    6.188
-----------------------------------------------------------------------------------------
PROGRESS: 37.0%
| epoch  38 |   100/  216 batches | lr 0.00015 | ms/batch 77.04 | loss  3.26 | ppl    25.96 
| epoch  38 |   200/  216 batches | lr 0.00015 | ms/batch 76.22 | loss  3.23 | ppl    25.24 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 17.03s | valid loss  4.24 | valid ppl    69.52 | valid bpc    6.119
-----------------------------------------------------------------------------------------
PROGRESS: 38.0%
| epoch  39 |   100/  216 batches | lr 0.00015 | ms/batch 77.23 | loss  3.19 | ppl    24.38 
| epoch  39 |   200/  216 batches | lr 0.00015 | ms/batch 76.00 | loss  3.18 | ppl    24.15 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 17.02s | valid loss  4.20 | valid ppl    67.00 | valid bpc    6.066
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 39.0%
| epoch  40 |   100/  216 batches | lr 0.00015 | ms/batch 77.00 | loss  3.15 | ppl    23.29 
| epoch  40 |   200/  216 batches | lr 0.00015 | ms/batch 76.18 | loss  3.14 | ppl    23.16 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 17.01s | valid loss  4.17 | valid ppl    64.45 | valid bpc    6.010
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 40.0%
| epoch  41 |   100/  216 batches | lr 0.00015 | ms/batch 77.52 | loss  3.12 | ppl    22.69 
| epoch  41 |   200/  216 batches | lr 0.00015 | ms/batch 75.72 | loss  3.14 | ppl    23.00 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 17.02s | valid loss  4.18 | valid ppl    65.69 | valid bpc    6.038
-----------------------------------------------------------------------------------------
PROGRESS: 41.0%
| epoch  42 |   100/  216 batches | lr 0.00015 | ms/batch 77.10 | loss  3.09 | ppl    22.04 
| epoch  42 |   200/  216 batches | lr 0.00015 | ms/batch 76.08 | loss  3.10 | ppl    22.27 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 17.01s | valid loss  4.25 | valid ppl    70.02 | valid bpc    6.130
-----------------------------------------------------------------------------------------
PROGRESS: 42.0%
| epoch  43 |   100/  216 batches | lr 0.00015 | ms/batch 77.30 | loss  3.07 | ppl    21.59 
| epoch  43 |   200/  216 batches | lr 0.00015 | ms/batch 75.97 | loss  3.06 | ppl    21.27 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 17.01s | valid loss  4.22 | valid ppl    67.93 | valid bpc    6.086
-----------------------------------------------------------------------------------------
PROGRESS: 43.0%
| epoch  44 |   100/  216 batches | lr 0.00007 | ms/batch 77.19 | loss  3.02 | ppl    20.46 
| epoch  44 |   200/  216 batches | lr 0.00007 | ms/batch 76.18 | loss  3.03 | ppl    20.63 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 17.02s | valid loss  4.21 | valid ppl    67.17 | valid bpc    6.070
-----------------------------------------------------------------------------------------
PROGRESS: 44.0%
| epoch  45 |   100/  216 batches | lr 0.00007 | ms/batch 77.60 | loss  3.00 | ppl    20.13 
| epoch  45 |   200/  216 batches | lr 0.00007 | ms/batch 75.66 | loss  2.97 | ppl    19.54 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 17.02s | valid loss  4.18 | valid ppl    65.40 | valid bpc    6.031
-----------------------------------------------------------------------------------------
PROGRESS: 45.0%
| epoch  46 |   100/  216 batches | lr 0.00007 | ms/batch 76.93 | loss  2.99 | ppl    19.91 
| epoch  46 |   200/  216 batches | lr 0.00007 | ms/batch 76.25 | loss  2.96 | ppl    19.25 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 17.02s | valid loss  4.20 | valid ppl    66.92 | valid bpc    6.064
-----------------------------------------------------------------------------------------
PROGRESS: 46.0%
| epoch  47 |   100/  216 batches | lr 0.00004 | ms/batch 77.30 | loss  2.95 | ppl    19.19 
| epoch  47 |   200/  216 batches | lr 0.00004 | ms/batch 76.18 | loss  2.92 | ppl    18.53 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 17.03s | valid loss  4.21 | valid ppl    67.48 | valid bpc    6.076
-----------------------------------------------------------------------------------------
PROGRESS: 47.0%
| epoch  48 |   100/  216 batches | lr 0.00004 | ms/batch 77.46 | loss  2.94 | ppl    18.89 
| epoch  48 |   200/  216 batches | lr 0.00004 | ms/batch 75.73 | loss  2.92 | ppl    18.48 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 17.02s | valid loss  4.16 | valid ppl    63.93 | valid bpc    5.998
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 48.0%
| epoch  49 |   100/  216 batches | lr 0.00004 | ms/batch 77.01 | loss  2.93 | ppl    18.79 
| epoch  49 |   200/  216 batches | lr 0.00004 | ms/batch 76.16 | loss  2.87 | ppl    17.57 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 17.02s | valid loss  4.26 | valid ppl    70.95 | valid bpc    6.149
-----------------------------------------------------------------------------------------
PROGRESS: 49.0%
| epoch  50 |   100/  216 batches | lr 0.00004 | ms/batch 77.52 | loss  2.91 | ppl    18.32 
| epoch  50 |   200/  216 batches | lr 0.00004 | ms/batch 75.63 | loss  2.92 | ppl    18.50 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 17.01s | valid loss  4.20 | valid ppl    66.69 | valid bpc    6.059
-----------------------------------------------------------------------------------------
PROGRESS: 50.0%
| epoch  51 |   100/  216 batches | lr 0.00004 | ms/batch 77.43 | loss  2.90 | ppl    18.14 
| epoch  51 |   200/  216 batches | lr 0.00004 | ms/batch 75.84 | loss  2.88 | ppl    17.89 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 17.02s | valid loss  4.21 | valid ppl    67.66 | valid bpc    6.080
-----------------------------------------------------------------------------------------
PROGRESS: 51.0%
| epoch  52 |   100/  216 batches | lr 0.00002 | ms/batch 77.10 | loss  2.90 | ppl    18.13 
| epoch  52 |   200/  216 batches | lr 0.00002 | ms/batch 76.00 | loss  2.86 | ppl    17.43 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 17.01s | valid loss  4.19 | valid ppl    65.85 | valid bpc    6.041
-----------------------------------------------------------------------------------------
PROGRESS: 52.0%
| epoch  53 |   100/  216 batches | lr 0.00002 | ms/batch 77.52 | loss  2.91 | ppl    18.30 
| epoch  53 |   200/  216 batches | lr 0.00002 | ms/batch 75.73 | loss  2.85 | ppl    17.20 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 17.02s | valid loss  4.22 | valid ppl    68.07 | valid bpc    6.089
-----------------------------------------------------------------------------------------
PROGRESS: 53.0%
| epoch  54 |   100/  216 batches | lr 0.00002 | ms/batch 77.63 | loss  2.90 | ppl    18.26 
| epoch  54 |   200/  216 batches | lr 0.00002 | ms/batch 75.65 | loss  2.85 | ppl    17.29 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 17.02s | valid loss  4.21 | valid ppl    67.15 | valid bpc    6.069
-----------------------------------------------------------------------------------------
PROGRESS: 54.0%
| epoch  55 |   100/  216 batches | lr 0.00001 | ms/batch 77.20 | loss  2.87 | ppl    17.58 
| epoch  55 |   200/  216 batches | lr 0.00001 | ms/batch 75.75 | loss  2.83 | ppl    17.02 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 17.03s | valid loss  4.19 | valid ppl    65.84 | valid bpc    6.041
-----------------------------------------------------------------------------------------
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  216 batches | lr 0.00001 | ms/batch 77.45 | loss  2.89 | ppl    18.00 
| epoch  56 |   200/  216 batches | lr 0.00001 | ms/batch 75.91 | loss  2.86 | ppl    17.45 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 17.03s | valid loss  4.14 | valid ppl    62.61 | valid bpc    5.968
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  216 batches | lr 0.00001 | ms/batch 76.82 | loss  2.85 | ppl    17.28 
| epoch  57 |   200/  216 batches | lr 0.00001 | ms/batch 76.43 | loss  2.86 | ppl    17.46 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 17.02s | valid loss  4.18 | valid ppl    65.38 | valid bpc    6.031
-----------------------------------------------------------------------------------------
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  216 batches | lr 0.00001 | ms/batch 77.40 | loss  2.86 | ppl    17.51 
| epoch  58 |   200/  216 batches | lr 0.00001 | ms/batch 75.89 | loss  2.81 | ppl    16.69 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 17.03s | valid loss  4.20 | valid ppl    66.53 | valid bpc    6.056
-----------------------------------------------------------------------------------------
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  216 batches | lr 0.00001 | ms/batch 77.38 | loss  2.89 | ppl    17.95 
| epoch  59 |   200/  216 batches | lr 0.00001 | ms/batch 75.81 | loss  2.84 | ppl    17.13 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 17.02s | valid loss  4.20 | valid ppl    67.02 | valid bpc    6.066
-----------------------------------------------------------------------------------------
PROGRESS: 59.0%
| epoch  60 |   100/  216 batches | lr 0.00000 | ms/batch 77.34 | loss  2.86 | ppl    17.45 
| epoch  60 |   200/  216 batches | lr 0.00000 | ms/batch 75.85 | loss  2.84 | ppl    17.16 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 17.01s | valid loss  4.22 | valid ppl    67.78 | valid bpc    6.083
-----------------------------------------------------------------------------------------
PROGRESS: 60.0%
| epoch  61 |   100/  216 batches | lr 0.00000 | ms/batch 77.08 | loss  2.85 | ppl    17.32 
| epoch  61 |   200/  216 batches | lr 0.00000 | ms/batch 76.13 | loss  2.84 | ppl    17.10 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 17.02s | valid loss  4.21 | valid ppl    67.24 | valid bpc    6.071
-----------------------------------------------------------------------------------------
PROGRESS: 61.0%
| epoch  62 |   100/  216 batches | lr 0.00000 | ms/batch 77.13 | loss  2.84 | ppl    17.03 
| epoch  62 |   200/  216 batches | lr 0.00000 | ms/batch 76.09 | loss  2.84 | ppl    17.10 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 17.02s | valid loss  4.23 | valid ppl    68.45 | valid bpc    6.097
-----------------------------------------------------------------------------------------
PROGRESS: 62.0%
| epoch  63 |   100/  216 batches | lr 0.00000 | ms/batch 77.52 | loss  2.84 | ppl    17.11 
| epoch  63 |   200/  216 batches | lr 0.00000 | ms/batch 75.70 | loss  2.84 | ppl    17.10 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 17.02s | valid loss  4.25 | valid ppl    70.03 | valid bpc    6.130
-----------------------------------------------------------------------------------------
PROGRESS: 63.0%
| epoch  64 |   100/  216 batches | lr 0.00000 | ms/batch 77.07 | loss  2.87 | ppl    17.72 
| epoch  64 |   200/  216 batches | lr 0.00000 | ms/batch 76.19 | loss  2.81 | ppl    16.53 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 17.03s | valid loss  4.20 | valid ppl    66.49 | valid bpc    6.055
-----------------------------------------------------------------------------------------
PROGRESS: 64.0%
| epoch  65 |   100/  216 batches | lr 0.00000 | ms/batch 76.90 | loss  2.86 | ppl    17.52 
| epoch  65 |   200/  216 batches | lr 0.00000 | ms/batch 76.45 | loss  2.84 | ppl    17.09 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 17.02s | valid loss  4.14 | valid ppl    62.59 | valid bpc    5.968
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 65.0%
| epoch  66 |   100/  216 batches | lr 0.00000 | ms/batch 77.46 | loss  2.86 | ppl    17.46 
| epoch  66 |   200/  216 batches | lr 0.00000 | ms/batch 75.66 | loss  2.82 | ppl    16.76 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 17.01s | valid loss  4.17 | valid ppl    64.50 | valid bpc    6.011
-----------------------------------------------------------------------------------------
PROGRESS: 66.0%
| epoch  67 |   100/  216 batches | lr 0.00000 | ms/batch 77.04 | loss  2.86 | ppl    17.45 
| epoch  67 |   200/  216 batches | lr 0.00000 | ms/batch 76.37 | loss  2.81 | ppl    16.66 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 17.03s | valid loss  4.20 | valid ppl    67.02 | valid bpc    6.066
-----------------------------------------------------------------------------------------
PROGRESS: 67.0%
| epoch  68 |   100/  216 batches | lr 0.00000 | ms/batch 77.45 | loss  2.86 | ppl    17.42 
| epoch  68 |   200/  216 batches | lr 0.00000 | ms/batch 75.83 | loss  2.81 | ppl    16.62 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 17.02s | valid loss  4.19 | valid ppl    66.18 | valid bpc    6.048
-----------------------------------------------------------------------------------------
PROGRESS: 68.0%
| epoch  69 |   100/  216 batches | lr 0.00000 | ms/batch 76.98 | loss  2.87 | ppl    17.71 
| epoch  69 |   200/  216 batches | lr 0.00000 | ms/batch 76.31 | loss  2.83 | ppl    16.87 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 17.03s | valid loss  4.22 | valid ppl    67.77 | valid bpc    6.083
-----------------------------------------------------------------------------------------
PROGRESS: 69.0%
| epoch  70 |   100/  216 batches | lr 0.00000 | ms/batch 77.25 | loss  2.88 | ppl    17.83 
| epoch  70 |   200/  216 batches | lr 0.00000 | ms/batch 76.08 | loss  2.81 | ppl    16.69 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 17.03s | valid loss  4.19 | valid ppl    65.87 | valid bpc    6.041
-----------------------------------------------------------------------------------------
PROGRESS: 70.0%
| epoch  71 |   100/  216 batches | lr 0.00000 | ms/batch 76.90 | loss  2.83 | ppl    16.91 
| epoch  71 |   200/  216 batches | lr 0.00000 | ms/batch 76.38 | loss  2.84 | ppl    17.08 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 17.02s | valid loss  4.18 | valid ppl    65.07 | valid bpc    6.024
-----------------------------------------------------------------------------------------
PROGRESS: 71.0%
| epoch  72 |   100/  216 batches | lr 0.00000 | ms/batch 76.84 | loss  2.86 | ppl    17.45 
| epoch  72 |   200/  216 batches | lr 0.00000 | ms/batch 76.41 | loss  2.82 | ppl    16.80 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 17.02s | valid loss  4.25 | valid ppl    70.13 | valid bpc    6.132
-----------------------------------------------------------------------------------------
PROGRESS: 72.0%
| epoch  73 |   100/  216 batches | lr 0.00000 | ms/batch 77.10 | loss  2.84 | ppl    17.09 
| epoch  73 |   200/  216 batches | lr 0.00000 | ms/batch 76.19 | loss  2.83 | ppl    16.95 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 17.03s | valid loss  4.17 | valid ppl    64.73 | valid bpc    6.016
-----------------------------------------------------------------------------------------
PROGRESS: 73.0%
| epoch  74 |   100/  216 batches | lr 0.00000 | ms/batch 77.48 | loss  2.86 | ppl    17.41 
| epoch  74 |   200/  216 batches | lr 0.00000 | ms/batch 75.88 | loss  2.82 | ppl    16.82 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 17.04s | valid loss  4.20 | valid ppl    66.78 | valid bpc    6.061
-----------------------------------------------------------------------------------------
PROGRESS: 74.0%
| epoch  75 |   100/  216 batches | lr 0.00000 | ms/batch 77.04 | loss  2.84 | ppl    17.15 
| epoch  75 |   200/  216 batches | lr 0.00000 | ms/batch 76.31 | loss  2.84 | ppl    17.06 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 17.02s | valid loss  4.21 | valid ppl    67.26 | valid bpc    6.072
-----------------------------------------------------------------------------------------
PROGRESS: 75.0%
| epoch  76 |   100/  216 batches | lr 0.00000 | ms/batch 77.20 | loss  2.86 | ppl    17.38 
| epoch  76 |   200/  216 batches | lr 0.00000 | ms/batch 76.16 | loss  2.80 | ppl    16.53 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 17.03s | valid loss  4.19 | valid ppl    66.06 | valid bpc    6.046
-----------------------------------------------------------------------------------------
PROGRESS: 76.0%
| epoch  77 |   100/  216 batches | lr 0.00000 | ms/batch 76.96 | loss  2.85 | ppl    17.22 
| epoch  77 |   200/  216 batches | lr 0.00000 | ms/batch 76.11 | loss  2.82 | ppl    16.82 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 17.02s | valid loss  4.19 | valid ppl    66.18 | valid bpc    6.048
-----------------------------------------------------------------------------------------
PROGRESS: 77.0%
| epoch  78 |   100/  216 batches | lr 0.00000 | ms/batch 77.33 | loss  2.84 | ppl    17.03 
| epoch  78 |   200/  216 batches | lr 0.00000 | ms/batch 76.15 | loss  2.83 | ppl    16.91 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 17.03s | valid loss  4.18 | valid ppl    65.10 | valid bpc    6.025
-----------------------------------------------------------------------------------------
PROGRESS: 78.0%
| epoch  79 |   100/  216 batches | lr 0.00000 | ms/batch 77.37 | loss  2.86 | ppl    17.40 
| epoch  79 |   200/  216 batches | lr 0.00000 | ms/batch 75.87 | loss  2.82 | ppl    16.77 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 17.02s | valid loss  4.20 | valid ppl    66.99 | valid bpc    6.066
-----------------------------------------------------------------------------------------
PROGRESS: 79.0%
| epoch  80 |   100/  216 batches | lr 0.00000 | ms/batch 77.16 | loss  2.83 | ppl    17.00 
| epoch  80 |   200/  216 batches | lr 0.00000 | ms/batch 76.15 | loss  2.84 | ppl    17.10 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 17.03s | valid loss  4.19 | valid ppl    66.25 | valid bpc    6.050
-----------------------------------------------------------------------------------------
PROGRESS: 80.0%
| epoch  81 |   100/  216 batches | lr 0.00000 | ms/batch 77.09 | loss  2.86 | ppl    17.42 
| epoch  81 |   200/  216 batches | lr 0.00000 | ms/batch 76.19 | loss  2.82 | ppl    16.75 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 17.02s | valid loss  4.19 | valid ppl    66.25 | valid bpc    6.050
-----------------------------------------------------------------------------------------
PROGRESS: 81.0%
| epoch  82 |   100/  216 batches | lr 0.00000 | ms/batch 76.91 | loss  2.84 | ppl    17.10 
| epoch  82 |   200/  216 batches | lr 0.00000 | ms/batch 76.43 | loss  2.84 | ppl    17.09 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 17.03s | valid loss  4.18 | valid ppl    65.20 | valid bpc    6.027
-----------------------------------------------------------------------------------------
PROGRESS: 82.0%
| epoch  83 |   100/  216 batches | lr 0.00000 | ms/batch 77.41 | loss  2.84 | ppl    17.09 
| epoch  83 |   200/  216 batches | lr 0.00000 | ms/batch 76.00 | loss  2.83 | ppl    17.00 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 17.03s | valid loss  4.18 | valid ppl    65.37 | valid bpc    6.031
-----------------------------------------------------------------------------------------
PROGRESS: 83.0%
| epoch  84 |   100/  216 batches | lr 0.00000 | ms/batch 77.14 | loss  2.86 | ppl    17.40 
| epoch  84 |   200/  216 batches | lr 0.00000 | ms/batch 76.29 | loss  2.81 | ppl    16.68 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 17.04s | valid loss  4.17 | valid ppl    64.75 | valid bpc    6.017
-----------------------------------------------------------------------------------------
PROGRESS: 84.0%
| epoch  85 |   100/  216 batches | lr 0.00000 | ms/batch 77.00 | loss  2.86 | ppl    17.48 
| epoch  85 |   200/  216 batches | lr 0.00000 | ms/batch 76.31 | loss  2.84 | ppl    17.04 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 17.03s | valid loss  4.21 | valid ppl    67.33 | valid bpc    6.073
-----------------------------------------------------------------------------------------
PROGRESS: 85.0%
| epoch  86 |   100/  216 batches | lr 0.00000 | ms/batch 77.21 | loss  2.86 | ppl    17.39 
| epoch  86 |   200/  216 batches | lr 0.00000 | ms/batch 76.19 | loss  2.83 | ppl    16.88 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 17.04s | valid loss  4.18 | valid ppl    65.37 | valid bpc    6.031
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  216 batches | lr 0.00000 | ms/batch 77.59 | loss  2.84 | ppl    17.16 
| epoch  87 |   200/  216 batches | lr 0.00000 | ms/batch 75.64 | loss  2.80 | ppl    16.48 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 17.03s | valid loss  4.22 | valid ppl    68.15 | valid bpc    6.091
-----------------------------------------------------------------------------------------
PROGRESS: 87.0%
| epoch  88 |   100/  216 batches | lr 0.00000 | ms/batch 77.18 | loss  2.85 | ppl    17.33 
| epoch  88 |   200/  216 batches | lr 0.00000 | ms/batch 76.29 | loss  2.83 | ppl    16.96 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 17.04s | valid loss  4.23 | valid ppl    68.74 | valid bpc    6.103
-----------------------------------------------------------------------------------------
PROGRESS: 88.0%
| epoch  89 |   100/  216 batches | lr 0.00000 | ms/batch 77.04 | loss  2.84 | ppl    17.07 
| epoch  89 |   200/  216 batches | lr 0.00000 | ms/batch 75.96 | loss  2.81 | ppl    16.57 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 17.02s | valid loss  4.18 | valid ppl    65.12 | valid bpc    6.025
-----------------------------------------------------------------------------------------
PROGRESS: 89.0%
| epoch  90 |   100/  216 batches | lr 0.00000 | ms/batch 77.25 | loss  2.85 | ppl    17.22 
| epoch  90 |   200/  216 batches | lr 0.00000 | ms/batch 76.08 | loss  2.81 | ppl    16.54 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 17.03s | valid loss  4.18 | valid ppl    65.11 | valid bpc    6.025
-----------------------------------------------------------------------------------------
PROGRESS: 90.0%
| epoch  91 |   100/  216 batches | lr 0.00000 | ms/batch 76.89 | loss  2.84 | ppl    17.15 
| epoch  91 |   200/  216 batches | lr 0.00000 | ms/batch 76.29 | loss  2.82 | ppl    16.78 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 17.03s | valid loss  4.21 | valid ppl    67.36 | valid bpc    6.074
-----------------------------------------------------------------------------------------
PROGRESS: 91.0%
| epoch  92 |   100/  216 batches | lr 0.00000 | ms/batch 76.91 | loss  2.83 | ppl    16.90 
| epoch  92 |   200/  216 batches | lr 0.00000 | ms/batch 76.07 | loss  2.83 | ppl    16.89 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 17.04s | valid loss  4.17 | valid ppl    64.51 | valid bpc    6.011
-----------------------------------------------------------------------------------------
PROGRESS: 92.0%
| epoch  93 |   100/  216 batches | lr 0.00000 | ms/batch 77.12 | loss  2.84 | ppl    17.14 
| epoch  93 |   200/  216 batches | lr 0.00000 | ms/batch 76.20 | loss  2.80 | ppl    16.51 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 17.03s | valid loss  4.21 | valid ppl    67.32 | valid bpc    6.073
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  216 batches | lr 0.00000 | ms/batch 76.89 | loss  2.85 | ppl    17.22 
| epoch  94 |   200/  216 batches | lr 0.00000 | ms/batch 76.61 | loss  2.81 | ppl    16.60 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 17.04s | valid loss  4.18 | valid ppl    65.58 | valid bpc    6.035
-----------------------------------------------------------------------------------------
PROGRESS: 94.0%
| epoch  95 |   100/  216 batches | lr 0.00000 | ms/batch 77.26 | loss  2.85 | ppl    17.30 
| epoch  95 |   200/  216 batches | lr 0.00000 | ms/batch 76.03 | loss  2.84 | ppl    17.18 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 17.04s | valid loss  4.19 | valid ppl    66.13 | valid bpc    6.047
-----------------------------------------------------------------------------------------
PROGRESS: 95.0%
| epoch  96 |   100/  216 batches | lr 0.00000 | ms/batch 77.45 | loss  2.85 | ppl    17.37 
| epoch  96 |   200/  216 batches | lr 0.00000 | ms/batch 75.81 | loss  2.80 | ppl    16.49 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 17.02s | valid loss  4.20 | valid ppl    66.51 | valid bpc    6.056
-----------------------------------------------------------------------------------------
PROGRESS: 96.0%
| epoch  97 |   100/  216 batches | lr 0.00000 | ms/batch 77.52 | loss  2.85 | ppl    17.28 
| epoch  97 |   200/  216 batches | lr 0.00000 | ms/batch 75.77 | loss  2.82 | ppl    16.73 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 17.03s | valid loss  4.26 | valid ppl    70.82 | valid bpc    6.146
-----------------------------------------------------------------------------------------
PROGRESS: 97.0%
| epoch  98 |   100/  216 batches | lr 0.00000 | ms/batch 77.75 | loss  2.87 | ppl    17.58 
| epoch  98 |   200/  216 batches | lr 0.00000 | ms/batch 75.60 | loss  2.83 | ppl    16.97 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 17.04s | valid loss  4.15 | valid ppl    63.75 | valid bpc    5.994
-----------------------------------------------------------------------------------------
PROGRESS: 98.0%
| epoch  99 |   100/  216 batches | lr 0.00000 | ms/batch 76.92 | loss  2.85 | ppl    17.23 
| epoch  99 |   200/  216 batches | lr 0.00000 | ms/batch 76.33 | loss  2.83 | ppl    16.93 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 17.02s | valid loss  4.20 | valid ppl    67.01 | valid bpc    6.066
-----------------------------------------------------------------------------------------
PROGRESS: 99.0%
| epoch 100 |   100/  216 batches | lr 0.00000 | ms/batch 77.31 | loss  2.84 | ppl    17.05 
| epoch 100 |   200/  216 batches | lr 0.00000 | ms/batch 75.82 | loss  2.82 | ppl    16.82 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 17.02s | valid loss  4.15 | valid ppl    63.68 | valid bpc    5.993
-----------------------------------------------------------------------------------------
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  4.14 | test ppl    62.60 | test bpc    5.968
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.5077, Mean Reca: 0.6964, Mean F1: 0.5787
Counter({'NP': 10275, 'VP': 4461, 'PP': 4342, 'S': 3967, 'SBAR': 1140, 'ADJP': 288, 'QP': 271, 'ADVP': 175, 'SINV': 150, 'PRN': 58, 'NX': 47, 'FRAG': 34, 'WHNP': 25, 'SQ': 15, 'NAC': 14, 'SBARQ': 10, 'UCP': 9, 'CONJP': 6, 'X': 3, 'WHADVP': 2, 'WHPP': 2})
Counter({'NP': 14432, 'VP': 8130, 'S': 5620, 'PP': 5484, 'SBAR': 1796, 'ADJP': 649, 'QP': 490, 'ADVP': 286, 'SINV': 157, 'PRN': 128, 'NX': 95, 'FRAG': 42, 'WHNP': 37, 'UCP': 32, 'NAC': 30, 'WHPP': 25, 'CONJP': 21, 'SQ': 18, 'SBARQ': 10, 'WHADVP': 9, 'X': 6, 'WHADJP': 4, 'INTJ': 1})
SBAR: 0.6347
NP: 0.7120
VP: 0.5487
PP: 0.7918
ADJP: 0.4438
ADVP: 0.6119
5.243309213863929
-----------------------------------------------------------------------------------------
Dependency parsing performance:
Conll-U Style:
DDA: 0.074
UDA: 0.342
=========================================================================================
Loading dataset...
Loading dictionary...
Number of tokens:  10001
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer_in_parser', nhid=512, nlayers=8, front_layers=4, rear_layers=4, n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=3333, nonmono=5, cuda=True, log_interval=100, save='trained_models/structformer_in_parser_3333_44.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 38475605
Model architecture: StructFormer_In_Parser(
  (transformer_front): Transformer_Front(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(10001, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-3): 4 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
  (transformer_rear): Transformer_Rear(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(10001, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-3): 4 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (output_layer): Linear(in_features=512, out_features=10001, bias=True)
  )
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  216 batches | lr 0.00030 | ms/batch 80.25 | loss  7.27 | ppl  1439.07 
| epoch   1 |   200/  216 batches | lr 0.00030 | ms/batch 75.34 | loss  6.86 | ppl   951.04 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 17.23s | valid loss  6.70 | valid ppl   811.41 | valid bpc    9.664
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  216 batches | lr 0.00030 | ms/batch 76.31 | loss  6.78 | ppl   882.16 
| epoch   2 |   200/  216 batches | lr 0.00030 | ms/batch 75.87 | loss  6.55 | ppl   695.81 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 16.90s | valid loss  6.30 | valid ppl   542.14 | valid bpc    9.083
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  216 batches | lr 0.00030 | ms/batch 76.67 | loss  6.32 | ppl   552.82 
| epoch   3 |   200/  216 batches | lr 0.00030 | ms/batch 75.92 | loss  6.08 | ppl   435.25 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 16.95s | valid loss  5.89 | valid ppl   362.37 | valid bpc    8.501
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  216 batches | lr 0.00030 | ms/batch 76.65 | loss  5.89 | ppl   362.53 
| epoch   4 |   200/  216 batches | lr 0.00030 | ms/batch 76.25 | loss  5.72 | ppl   305.22 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 16.97s | valid loss  5.57 | valid ppl   261.74 | valid bpc    8.032
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  216 batches | lr 0.00030 | ms/batch 76.69 | loss  5.59 | ppl   268.69 
| epoch   5 |   200/  216 batches | lr 0.00030 | ms/batch 76.34 | loss  5.46 | ppl   234.46 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 16.99s | valid loss  5.41 | valid ppl   222.64 | valid bpc    7.799
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  216 batches | lr 0.00030 | ms/batch 76.75 | loss  5.40 | ppl   221.34 
| epoch   6 |   200/  216 batches | lr 0.00030 | ms/batch 76.38 | loss  5.29 | ppl   198.41 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 17.00s | valid loss  5.25 | valid ppl   190.71 | valid bpc    7.575
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  216 batches | lr 0.00030 | ms/batch 77.20 | loss  5.21 | ppl   183.50 
| epoch   7 |   200/  216 batches | lr 0.00030 | ms/batch 75.98 | loss  5.15 | ppl   172.78 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 17.01s | valid loss  5.13 | valid ppl   169.68 | valid bpc    7.407
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  216 batches | lr 0.00030 | ms/batch 77.77 | loss  5.10 | ppl   164.05 
| epoch   8 |   200/  216 batches | lr 0.00030 | ms/batch 75.65 | loss  5.00 | ppl   148.82 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 17.02s | valid loss  5.02 | valid ppl   150.80 | valid bpc    7.236
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 8.0%
| epoch   9 |   100/  216 batches | lr 0.00030 | ms/batch 77.47 | loss  4.97 | ppl   144.53 
| epoch   9 |   200/  216 batches | lr 0.00030 | ms/batch 75.76 | loss  4.88 | ppl   131.65 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 17.02s | valid loss  4.94 | valid ppl   139.10 | valid bpc    7.120
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  216 batches | lr 0.00030 | ms/batch 76.94 | loss  4.85 | ppl   128.16 
| epoch  10 |   200/  216 batches | lr 0.00030 | ms/batch 76.04 | loss  4.80 | ppl   121.37 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 17.02s | valid loss  4.85 | valid ppl   127.52 | valid bpc    6.995
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  216 batches | lr 0.00030 | ms/batch 77.09 | loss  4.73 | ppl   113.62 
| epoch  11 |   200/  216 batches | lr 0.00030 | ms/batch 75.82 | loss  4.69 | ppl   108.37 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 17.01s | valid loss  4.77 | valid ppl   117.62 | valid bpc    6.878
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  216 batches | lr 0.00030 | ms/batch 77.49 | loss  4.66 | ppl   105.57 
| epoch  12 |   200/  216 batches | lr 0.00030 | ms/batch 75.67 | loss  4.60 | ppl    99.71 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 17.01s | valid loss  4.71 | valid ppl   110.90 | valid bpc    6.793
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 12.0%
| epoch  13 |   100/  216 batches | lr 0.00030 | ms/batch 77.17 | loss  4.58 | ppl    97.39 
| epoch  13 |   200/  216 batches | lr 0.00030 | ms/batch 75.97 | loss  4.49 | ppl    89.32 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 17.01s | valid loss  4.67 | valid ppl   106.50 | valid bpc    6.735
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 13.0%
| epoch  14 |   100/  216 batches | lr 0.00030 | ms/batch 76.86 | loss  4.49 | ppl    88.79 
| epoch  14 |   200/  216 batches | lr 0.00030 | ms/batch 76.33 | loss  4.44 | ppl    85.01 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 17.01s | valid loss  4.62 | valid ppl   101.36 | valid bpc    6.663
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  216 batches | lr 0.00030 | ms/batch 77.59 | loss  4.42 | ppl    83.30 
| epoch  15 |   200/  216 batches | lr 0.00030 | ms/batch 75.57 | loss  4.36 | ppl    77.98 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 17.02s | valid loss  4.60 | valid ppl    99.08 | valid bpc    6.631
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 15.0%
| epoch  16 |   100/  216 batches | lr 0.00030 | ms/batch 77.43 | loss  4.31 | ppl    74.42 
| epoch  16 |   200/  216 batches | lr 0.00030 | ms/batch 75.66 | loss  4.30 | ppl    73.71 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 17.01s | valid loss  4.52 | valid ppl    91.53 | valid bpc    6.516
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 16.0%
| epoch  17 |   100/  216 batches | lr 0.00030 | ms/batch 77.26 | loss  4.28 | ppl    71.97 
| epoch  17 |   200/  216 batches | lr 0.00030 | ms/batch 76.04 | loss  4.23 | ppl    68.72 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 17.02s | valid loss  4.50 | valid ppl    89.94 | valid bpc    6.491
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 17.0%
| epoch  18 |   100/  216 batches | lr 0.00030 | ms/batch 77.30 | loss  4.22 | ppl    68.09 
| epoch  18 |   200/  216 batches | lr 0.00030 | ms/batch 76.09 | loss  4.15 | ppl    63.71 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 17.03s | valid loss  4.46 | valid ppl    86.87 | valid bpc    6.441
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 18.0%
| epoch  19 |   100/  216 batches | lr 0.00030 | ms/batch 76.69 | loss  4.15 | ppl    63.55 
| epoch  19 |   200/  216 batches | lr 0.00030 | ms/batch 76.54 | loss  4.09 | ppl    59.88 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 17.02s | valid loss  4.44 | valid ppl    84.86 | valid bpc    6.407
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 19.0%
| epoch  20 |   100/  216 batches | lr 0.00030 | ms/batch 76.95 | loss  4.05 | ppl    57.62 
| epoch  20 |   200/  216 batches | lr 0.00030 | ms/batch 76.28 | loss  4.08 | ppl    58.85 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 17.01s | valid loss  4.37 | valid ppl    78.90 | valid bpc    6.302
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 20.0%
| epoch  21 |   100/  216 batches | lr 0.00030 | ms/batch 76.88 | loss  3.99 | ppl    54.30 
| epoch  21 |   200/  216 batches | lr 0.00030 | ms/batch 76.09 | loss  4.00 | ppl    54.33 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 17.01s | valid loss  4.43 | valid ppl    83.58 | valid bpc    6.385
-----------------------------------------------------------------------------------------
PROGRESS: 21.0%
| epoch  22 |   100/  216 batches | lr 0.00030 | ms/batch 77.37 | loss  3.97 | ppl    53.13 
| epoch  22 |   200/  216 batches | lr 0.00030 | ms/batch 75.99 | loss  3.94 | ppl    51.30 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 17.02s | valid loss  4.38 | valid ppl    79.88 | valid bpc    6.320
-----------------------------------------------------------------------------------------
PROGRESS: 22.0%
| epoch  23 |   100/  216 batches | lr 0.00030 | ms/batch 77.06 | loss  3.89 | ppl    48.81 
| epoch  23 |   200/  216 batches | lr 0.00030 | ms/batch 76.24 | loss  3.91 | ppl    50.01 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 17.02s | valid loss  4.34 | valid ppl    76.45 | valid bpc    6.256
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 23.0%
| epoch  24 |   100/  216 batches | lr 0.00030 | ms/batch 77.00 | loss  3.85 | ppl    46.77 
| epoch  24 |   200/  216 batches | lr 0.00030 | ms/batch 76.41 | loss  3.87 | ppl    47.88 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 17.02s | valid loss  4.35 | valid ppl    77.29 | valid bpc    6.272
-----------------------------------------------------------------------------------------
PROGRESS: 24.0%
| epoch  25 |   100/  216 batches | lr 0.00030 | ms/batch 77.50 | loss  3.83 | ppl    46.09 
| epoch  25 |   200/  216 batches | lr 0.00030 | ms/batch 75.94 | loss  3.80 | ppl    44.68 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 17.04s | valid loss  4.32 | valid ppl    74.99 | valid bpc    6.229
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 25.0%
| epoch  26 |   100/  216 batches | lr 0.00030 | ms/batch 76.88 | loss  3.77 | ppl    43.21 
| epoch  26 |   200/  216 batches | lr 0.00030 | ms/batch 76.50 | loss  3.76 | ppl    42.86 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 17.02s | valid loss  4.31 | valid ppl    74.81 | valid bpc    6.225
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 26.0%
| epoch  27 |   100/  216 batches | lr 0.00030 | ms/batch 77.19 | loss  3.73 | ppl    41.64 
| epoch  27 |   200/  216 batches | lr 0.00030 | ms/batch 76.22 | loss  3.72 | ppl    41.27 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 17.02s | valid loss  4.29 | valid ppl    72.91 | valid bpc    6.188
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 27.0%
| epoch  28 |   100/  216 batches | lr 0.00030 | ms/batch 77.28 | loss  3.68 | ppl    39.80 
| epoch  28 |   200/  216 batches | lr 0.00030 | ms/batch 75.80 | loss  3.65 | ppl    38.38 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 17.02s | valid loss  4.31 | valid ppl    74.37 | valid bpc    6.217
-----------------------------------------------------------------------------------------
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  216 batches | lr 0.00030 | ms/batch 77.09 | loss  3.63 | ppl    37.55 
| epoch  29 |   200/  216 batches | lr 0.00030 | ms/batch 76.14 | loss  3.65 | ppl    38.57 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 17.02s | valid loss  4.34 | valid ppl    76.40 | valid bpc    6.255
-----------------------------------------------------------------------------------------
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  216 batches | lr 0.00030 | ms/batch 77.54 | loss  3.62 | ppl    37.20 
| epoch  30 |   200/  216 batches | lr 0.00030 | ms/batch 75.69 | loss  3.57 | ppl    35.51 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 17.02s | valid loss  4.27 | valid ppl    71.21 | valid bpc    6.154
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 30.0%
| epoch  31 |   100/  216 batches | lr 0.00030 | ms/batch 77.30 | loss  3.55 | ppl    34.88 
| epoch  31 |   200/  216 batches | lr 0.00030 | ms/batch 75.84 | loss  3.55 | ppl    34.70 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 17.01s | valid loss  4.23 | valid ppl    68.85 | valid bpc    6.105
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 31.0%
| epoch  32 |   100/  216 batches | lr 0.00030 | ms/batch 77.06 | loss  3.50 | ppl    33.13 
| epoch  32 |   200/  216 batches | lr 0.00030 | ms/batch 76.19 | loss  3.52 | ppl    33.75 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 17.01s | valid loss  4.24 | valid ppl    69.60 | valid bpc    6.121
-----------------------------------------------------------------------------------------
PROGRESS: 32.0%
| epoch  33 |   100/  216 batches | lr 0.00030 | ms/batch 77.42 | loss  3.50 | ppl    32.95 
| epoch  33 |   200/  216 batches | lr 0.00030 | ms/batch 75.86 | loss  3.46 | ppl    31.79 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 17.02s | valid loss  4.28 | valid ppl    72.44 | valid bpc    6.179
-----------------------------------------------------------------------------------------
PROGRESS: 33.0%
| epoch  34 |   100/  216 batches | lr 0.00030 | ms/batch 77.08 | loss  3.43 | ppl    31.01 
| epoch  34 |   200/  216 batches | lr 0.00030 | ms/batch 76.42 | loss  3.43 | ppl    30.97 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 17.03s | valid loss  4.27 | valid ppl    71.53 | valid bpc    6.161
-----------------------------------------------------------------------------------------
PROGRESS: 34.0%
| epoch  35 |   100/  216 batches | lr 0.00015 | ms/batch 77.11 | loss  3.36 | ppl    28.73 
| epoch  35 |   200/  216 batches | lr 0.00015 | ms/batch 76.32 | loss  3.32 | ppl    27.63 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 17.04s | valid loss  4.21 | valid ppl    67.62 | valid bpc    6.079
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 35.0%
| epoch  36 |   100/  216 batches | lr 0.00015 | ms/batch 77.08 | loss  3.28 | ppl    26.54 
| epoch  36 |   200/  216 batches | lr 0.00015 | ms/batch 75.93 | loss  3.24 | ppl    25.57 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 17.03s | valid loss  4.21 | valid ppl    67.53 | valid bpc    6.078
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 36.0%
| epoch  37 |   100/  216 batches | lr 0.00015 | ms/batch 76.92 | loss  3.24 | ppl    25.45 
| epoch  37 |   200/  216 batches | lr 0.00015 | ms/batch 76.22 | loss  3.25 | ppl    25.74 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 17.02s | valid loss  4.23 | valid ppl    68.90 | valid bpc    6.106
-----------------------------------------------------------------------------------------
PROGRESS: 37.0%
| epoch  38 |   100/  216 batches | lr 0.00015 | ms/batch 77.04 | loss  3.21 | ppl    24.90 
| epoch  38 |   200/  216 batches | lr 0.00015 | ms/batch 76.27 | loss  3.21 | ppl    24.79 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 17.02s | valid loss  4.20 | valid ppl    66.44 | valid bpc    6.054
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 38.0%
| epoch  39 |   100/  216 batches | lr 0.00015 | ms/batch 76.90 | loss  3.18 | ppl    24.13 
| epoch  39 |   200/  216 batches | lr 0.00015 | ms/batch 76.32 | loss  3.19 | ppl    24.35 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 17.01s | valid loss  4.18 | valid ppl    65.24 | valid bpc    6.028
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 39.0%
| epoch  40 |   100/  216 batches | lr 0.00015 | ms/batch 77.34 | loss  3.15 | ppl    23.33 
| epoch  40 |   200/  216 batches | lr 0.00015 | ms/batch 75.99 | loss  3.17 | ppl    23.87 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 17.01s | valid loss  4.24 | valid ppl    69.48 | valid bpc    6.119
-----------------------------------------------------------------------------------------
PROGRESS: 40.0%
| epoch  41 |   100/  216 batches | lr 0.00015 | ms/batch 77.00 | loss  3.14 | ppl    23.09 
| epoch  41 |   200/  216 batches | lr 0.00015 | ms/batch 76.29 | loss  3.16 | ppl    23.55 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 17.02s | valid loss  4.23 | valid ppl    68.72 | valid bpc    6.103
-----------------------------------------------------------------------------------------
PROGRESS: 41.0%
| epoch  42 |   100/  216 batches | lr 0.00015 | ms/batch 77.27 | loss  3.12 | ppl    22.67 
| epoch  42 |   200/  216 batches | lr 0.00015 | ms/batch 75.88 | loss  3.10 | ppl    22.27 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 17.03s | valid loss  4.23 | valid ppl    68.75 | valid bpc    6.103
-----------------------------------------------------------------------------------------
PROGRESS: 42.0%
| epoch  43 |   100/  216 batches | lr 0.00007 | ms/batch 77.34 | loss  3.08 | ppl    21.77 
| epoch  43 |   200/  216 batches | lr 0.00007 | ms/batch 76.12 | loss  3.02 | ppl    20.47 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 17.03s | valid loss  4.17 | valid ppl    64.94 | valid bpc    6.021
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 43.0%
| epoch  44 |   100/  216 batches | lr 0.00007 | ms/batch 76.98 | loss  3.04 | ppl    20.98 
| epoch  44 |   200/  216 batches | lr 0.00007 | ms/batch 76.29 | loss  3.03 | ppl    20.61 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 17.02s | valid loss  4.20 | valid ppl    66.62 | valid bpc    6.058
-----------------------------------------------------------------------------------------
PROGRESS: 44.0%
| epoch  45 |   100/  216 batches | lr 0.00007 | ms/batch 77.33 | loss  3.03 | ppl    20.66 
| epoch  45 |   200/  216 batches | lr 0.00007 | ms/batch 76.07 | loss  2.98 | ppl    19.77 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 17.02s | valid loss  4.17 | valid ppl    64.57 | valid bpc    6.013
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 45.0%
| epoch  46 |   100/  216 batches | lr 0.00007 | ms/batch 77.29 | loss  3.01 | ppl    20.31 
| epoch  46 |   200/  216 batches | lr 0.00007 | ms/batch 75.94 | loss  2.98 | ppl    19.70 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 17.01s | valid loss  4.23 | valid ppl    68.72 | valid bpc    6.103
-----------------------------------------------------------------------------------------
PROGRESS: 46.0%
| epoch  47 |   100/  216 batches | lr 0.00007 | ms/batch 77.26 | loss  2.99 | ppl    19.83 
| epoch  47 |   200/  216 batches | lr 0.00007 | ms/batch 75.89 | loss  2.98 | ppl    19.74 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 17.02s | valid loss  4.21 | valid ppl    67.30 | valid bpc    6.073
-----------------------------------------------------------------------------------------
PROGRESS: 47.0%
| epoch  48 |   100/  216 batches | lr 0.00007 | ms/batch 77.17 | loss  2.99 | ppl    19.96 
| epoch  48 |   200/  216 batches | lr 0.00007 | ms/batch 76.24 | loss  2.94 | ppl    18.94 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 17.03s | valid loss  4.21 | valid ppl    67.53 | valid bpc    6.077
-----------------------------------------------------------------------------------------
PROGRESS: 48.0%
| epoch  49 |   100/  216 batches | lr 0.00004 | ms/batch 77.09 | loss  2.95 | ppl    19.15 
| epoch  49 |   200/  216 batches | lr 0.00004 | ms/batch 76.23 | loss  2.93 | ppl    18.68 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 17.03s | valid loss  4.23 | valid ppl    68.53 | valid bpc    6.099
-----------------------------------------------------------------------------------------
PROGRESS: 49.0%
| epoch  50 |   100/  216 batches | lr 0.00004 | ms/batch 77.57 | loss  2.94 | ppl    18.96 
| epoch  50 |   200/  216 batches | lr 0.00004 | ms/batch 75.93 | loss  2.91 | ppl    18.40 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 17.02s | valid loss  4.22 | valid ppl    67.95 | valid bpc    6.086
-----------------------------------------------------------------------------------------
PROGRESS: 50.0%
| epoch  51 |   100/  216 batches | lr 0.00004 | ms/batch 77.18 | loss  2.94 | ppl    18.86 
| epoch  51 |   200/  216 batches | lr 0.00004 | ms/batch 75.91 | loss  2.92 | ppl    18.49 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 17.02s | valid loss  4.21 | valid ppl    67.27 | valid bpc    6.072
-----------------------------------------------------------------------------------------
PROGRESS: 51.0%
| epoch  52 |   100/  216 batches | lr 0.00002 | ms/batch 77.27 | loss  2.91 | ppl    18.34 
| epoch  52 |   200/  216 batches | lr 0.00002 | ms/batch 75.73 | loss  2.89 | ppl    17.98 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 17.03s | valid loss  4.18 | valid ppl    65.07 | valid bpc    6.024
-----------------------------------------------------------------------------------------
PROGRESS: 52.0%
| epoch  53 |   100/  216 batches | lr 0.00002 | ms/batch 76.97 | loss  2.90 | ppl    18.22 
| epoch  53 |   200/  216 batches | lr 0.00002 | ms/batch 76.27 | loss  2.86 | ppl    17.53 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 17.04s | valid loss  4.19 | valid ppl    65.75 | valid bpc    6.039
-----------------------------------------------------------------------------------------
PROGRESS: 53.0%
| epoch  54 |   100/  216 batches | lr 0.00002 | ms/batch 77.38 | loss  2.90 | ppl    18.19 
| epoch  54 |   200/  216 batches | lr 0.00002 | ms/batch 76.10 | loss  2.89 | ppl    17.98 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 17.03s | valid loss  4.17 | valid ppl    64.69 | valid bpc    6.015
-----------------------------------------------------------------------------------------
PROGRESS: 54.0%
| epoch  55 |   100/  216 batches | lr 0.00001 | ms/batch 77.60 | loss  2.90 | ppl    18.16 
| epoch  55 |   200/  216 batches | lr 0.00001 | ms/batch 75.75 | loss  2.85 | ppl    17.35 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 17.03s | valid loss  4.20 | valid ppl    66.63 | valid bpc    6.058
-----------------------------------------------------------------------------------------
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  216 batches | lr 0.00001 | ms/batch 77.08 | loss  2.90 | ppl    18.09 
| epoch  56 |   200/  216 batches | lr 0.00001 | ms/batch 75.99 | loss  2.86 | ppl    17.40 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 17.03s | valid loss  4.21 | valid ppl    67.64 | valid bpc    6.080
-----------------------------------------------------------------------------------------
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  216 batches | lr 0.00001 | ms/batch 77.32 | loss  2.87 | ppl    17.72 
| epoch  57 |   200/  216 batches | lr 0.00001 | ms/batch 75.85 | loss  2.87 | ppl    17.56 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 17.03s | valid loss  4.18 | valid ppl    65.31 | valid bpc    6.029
-----------------------------------------------------------------------------------------
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  216 batches | lr 0.00000 | ms/batch 76.95 | loss  2.88 | ppl    17.78 
| epoch  58 |   200/  216 batches | lr 0.00000 | ms/batch 76.41 | loss  2.86 | ppl    17.40 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 17.02s | valid loss  4.17 | valid ppl    64.60 | valid bpc    6.014
-----------------------------------------------------------------------------------------
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  216 batches | lr 0.00000 | ms/batch 77.06 | loss  2.88 | ppl    17.90 
| epoch  59 |   200/  216 batches | lr 0.00000 | ms/batch 76.05 | loss  2.84 | ppl    17.11 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 17.03s | valid loss  4.20 | valid ppl    66.95 | valid bpc    6.065
-----------------------------------------------------------------------------------------
PROGRESS: 59.0%
| epoch  60 |   100/  216 batches | lr 0.00000 | ms/batch 77.14 | loss  2.87 | ppl    17.64 
| epoch  60 |   200/  216 batches | lr 0.00000 | ms/batch 76.43 | loss  2.84 | ppl    17.16 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 17.04s | valid loss  4.18 | valid ppl    65.23 | valid bpc    6.027
-----------------------------------------------------------------------------------------
PROGRESS: 60.0%
| epoch  61 |   100/  216 batches | lr 0.00000 | ms/batch 77.02 | loss  2.88 | ppl    17.87 
| epoch  61 |   200/  216 batches | lr 0.00000 | ms/batch 76.01 | loss  2.84 | ppl    17.05 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 17.04s | valid loss  4.19 | valid ppl    65.97 | valid bpc    6.044
-----------------------------------------------------------------------------------------
PROGRESS: 61.0%
| epoch  62 |   100/  216 batches | lr 0.00000 | ms/batch 76.91 | loss  2.86 | ppl    17.38 
| epoch  62 |   200/  216 batches | lr 0.00000 | ms/batch 76.41 | loss  2.84 | ppl    17.15 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 17.02s | valid loss  4.25 | valid ppl    69.97 | valid bpc    6.129
-----------------------------------------------------------------------------------------
PROGRESS: 62.0%
| epoch  63 |   100/  216 batches | lr 0.00000 | ms/batch 77.43 | loss  2.89 | ppl    17.90 
| epoch  63 |   200/  216 batches | lr 0.00000 | ms/batch 75.72 | loss  2.84 | ppl    17.19 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 17.02s | valid loss  4.22 | valid ppl    68.33 | valid bpc    6.094
-----------------------------------------------------------------------------------------
PROGRESS: 63.0%
| epoch  64 |   100/  216 batches | lr 0.00000 | ms/batch 77.12 | loss  2.87 | ppl    17.68 
| epoch  64 |   200/  216 batches | lr 0.00000 | ms/batch 76.22 | loss  2.83 | ppl    16.94 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 17.02s | valid loss  4.21 | valid ppl    67.40 | valid bpc    6.075
-----------------------------------------------------------------------------------------
PROGRESS: 64.0%
| epoch  65 |   100/  216 batches | lr 0.00000 | ms/batch 77.22 | loss  2.87 | ppl    17.58 
| epoch  65 |   200/  216 batches | lr 0.00000 | ms/batch 75.80 | loss  2.85 | ppl    17.23 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 17.02s | valid loss  4.19 | valid ppl    66.20 | valid bpc    6.049
-----------------------------------------------------------------------------------------
PROGRESS: 65.0%
| epoch  66 |   100/  216 batches | lr 0.00000 | ms/batch 77.41 | loss  2.87 | ppl    17.66 
| epoch  66 |   200/  216 batches | lr 0.00000 | ms/batch 76.03 | loss  2.85 | ppl    17.25 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 17.03s | valid loss  4.19 | valid ppl    66.26 | valid bpc    6.050
-----------------------------------------------------------------------------------------
PROGRESS: 66.0%
| epoch  67 |   100/  216 batches | lr 0.00000 | ms/batch 77.59 | loss  2.86 | ppl    17.40 
| epoch  67 |   200/  216 batches | lr 0.00000 | ms/batch 75.79 | loss  2.86 | ppl    17.39 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 17.02s | valid loss  4.24 | valid ppl    69.45 | valid bpc    6.118
-----------------------------------------------------------------------------------------
PROGRESS: 67.0%
| epoch  68 |   100/  216 batches | lr 0.00000 | ms/batch 77.19 | loss  2.87 | ppl    17.59 
| epoch  68 |   200/  216 batches | lr 0.00000 | ms/batch 76.29 | loss  2.87 | ppl    17.58 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 17.04s | valid loss  4.20 | valid ppl    66.66 | valid bpc    6.059
-----------------------------------------------------------------------------------------
PROGRESS: 68.0%
| epoch  69 |   100/  216 batches | lr 0.00000 | ms/batch 77.29 | loss  2.87 | ppl    17.60 
| epoch  69 |   200/  216 batches | lr 0.00000 | ms/batch 76.32 | loss  2.86 | ppl    17.53 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 17.05s | valid loss  4.24 | valid ppl    69.73 | valid bpc    6.124
-----------------------------------------------------------------------------------------
PROGRESS: 69.0%
| epoch  70 |   100/  216 batches | lr 0.00000 | ms/batch 77.38 | loss  2.88 | ppl    17.87 
| epoch  70 |   200/  216 batches | lr 0.00000 | ms/batch 75.82 | loss  2.84 | ppl    17.08 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 17.02s | valid loss  4.22 | valid ppl    68.21 | valid bpc    6.092
-----------------------------------------------------------------------------------------
PROGRESS: 70.0%
| epoch  71 |   100/  216 batches | lr 0.00000 | ms/batch 77.14 | loss  2.88 | ppl    17.76 
| epoch  71 |   200/  216 batches | lr 0.00000 | ms/batch 75.74 | loss  2.83 | ppl    17.00 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 17.03s | valid loss  4.18 | valid ppl    65.61 | valid bpc    6.036
-----------------------------------------------------------------------------------------
PROGRESS: 71.0%
| epoch  72 |   100/  216 batches | lr 0.00000 | ms/batch 77.43 | loss  2.87 | ppl    17.59 
| epoch  72 |   200/  216 batches | lr 0.00000 | ms/batch 75.77 | loss  2.83 | ppl    16.93 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 17.02s | valid loss  4.17 | valid ppl    64.62 | valid bpc    6.014
-----------------------------------------------------------------------------------------
PROGRESS: 72.0%
| epoch  73 |   100/  216 batches | lr 0.00000 | ms/batch 77.30 | loss  2.89 | ppl    17.94 
| epoch  73 |   200/  216 batches | lr 0.00000 | ms/batch 76.15 | loss  2.85 | ppl    17.28 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 17.04s | valid loss  4.18 | valid ppl    65.61 | valid bpc    6.036
-----------------------------------------------------------------------------------------
PROGRESS: 73.0%
| epoch  74 |   100/  216 batches | lr 0.00000 | ms/batch 77.45 | loss  2.88 | ppl    17.90 
| epoch  74 |   200/  216 batches | lr 0.00000 | ms/batch 75.97 | loss  2.83 | ppl    16.97 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 17.03s | valid loss  4.24 | valid ppl    69.60 | valid bpc    6.121
-----------------------------------------------------------------------------------------
PROGRESS: 74.0%
| epoch  75 |   100/  216 batches | lr 0.00000 | ms/batch 77.66 | loss  2.86 | ppl    17.51 
| epoch  75 |   200/  216 batches | lr 0.00000 | ms/batch 75.72 | loss  2.84 | ppl    17.17 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 17.03s | valid loss  4.20 | valid ppl    66.45 | valid bpc    6.054
-----------------------------------------------------------------------------------------
PROGRESS: 75.0%
| epoch  76 |   100/  216 batches | lr 0.00000 | ms/batch 77.31 | loss  2.87 | ppl    17.60 
| epoch  76 |   200/  216 batches | lr 0.00000 | ms/batch 75.96 | loss  2.84 | ppl    17.16 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 17.02s | valid loss  4.21 | valid ppl    67.67 | valid bpc    6.081
-----------------------------------------------------------------------------------------
PROGRESS: 76.0%
| epoch  77 |   100/  216 batches | lr 0.00000 | ms/batch 77.09 | loss  2.87 | ppl    17.67 
| epoch  77 |   200/  216 batches | lr 0.00000 | ms/batch 76.34 | loss  2.85 | ppl    17.23 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 17.02s | valid loss  4.16 | valid ppl    64.30 | valid bpc    6.007
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 77.0%
| epoch  78 |   100/  216 batches | lr 0.00000 | ms/batch 77.21 | loss  2.89 | ppl    17.91 
| epoch  78 |   200/  216 batches | lr 0.00000 | ms/batch 75.88 | loss  2.84 | ppl    17.09 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 17.01s | valid loss  4.22 | valid ppl    68.09 | valid bpc    6.089
-----------------------------------------------------------------------------------------
PROGRESS: 78.0%
| epoch  79 |   100/  216 batches | lr 0.00000 | ms/batch 77.00 | loss  2.86 | ppl    17.47 
| epoch  79 |   200/  216 batches | lr 0.00000 | ms/batch 76.40 | loss  2.84 | ppl    17.08 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 17.02s | valid loss  4.17 | valid ppl    64.84 | valid bpc    6.019
-----------------------------------------------------------------------------------------
PROGRESS: 79.0%
| epoch  80 |   100/  216 batches | lr 0.00000 | ms/batch 77.06 | loss  2.87 | ppl    17.64 
| epoch  80 |   200/  216 batches | lr 0.00000 | ms/batch 76.24 | loss  2.85 | ppl    17.24 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 17.02s | valid loss  4.21 | valid ppl    67.61 | valid bpc    6.079
-----------------------------------------------------------------------------------------
PROGRESS: 80.0%
| epoch  81 |   100/  216 batches | lr 0.00000 | ms/batch 77.20 | loss  2.88 | ppl    17.77 
| epoch  81 |   200/  216 batches | lr 0.00000 | ms/batch 76.13 | loss  2.85 | ppl    17.24 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 17.02s | valid loss  4.21 | valid ppl    67.51 | valid bpc    6.077
-----------------------------------------------------------------------------------------
PROGRESS: 81.0%
| epoch  82 |   100/  216 batches | lr 0.00000 | ms/batch 76.94 | loss  2.86 | ppl    17.44 
| epoch  82 |   200/  216 batches | lr 0.00000 | ms/batch 76.45 | loss  2.85 | ppl    17.25 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 17.03s | valid loss  4.16 | valid ppl    64.32 | valid bpc    6.007
-----------------------------------------------------------------------------------------
PROGRESS: 82.0%
| epoch  83 |   100/  216 batches | lr 0.00000 | ms/batch 77.02 | loss  2.87 | ppl    17.55 
| epoch  83 |   200/  216 batches | lr 0.00000 | ms/batch 76.00 | loss  2.84 | ppl    17.08 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 17.02s | valid loss  4.19 | valid ppl    65.87 | valid bpc    6.042
-----------------------------------------------------------------------------------------
PROGRESS: 83.0%
| epoch  84 |   100/  216 batches | lr 0.00000 | ms/batch 77.16 | loss  2.86 | ppl    17.54 
| epoch  84 |   200/  216 batches | lr 0.00000 | ms/batch 76.17 | loss  2.84 | ppl    17.19 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 17.02s | valid loss  4.19 | valid ppl    65.77 | valid bpc    6.039
-----------------------------------------------------------------------------------------
PROGRESS: 84.0%
| epoch  85 |   100/  216 batches | lr 0.00000 | ms/batch 76.99 | loss  2.87 | ppl    17.62 
| epoch  85 |   200/  216 batches | lr 0.00000 | ms/batch 76.23 | loss  2.84 | ppl    17.16 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 17.02s | valid loss  4.21 | valid ppl    67.69 | valid bpc    6.081
-----------------------------------------------------------------------------------------
PROGRESS: 85.0%
| epoch  86 |   100/  216 batches | lr 0.00000 | ms/batch 77.55 | loss  2.88 | ppl    17.80 
| epoch  86 |   200/  216 batches | lr 0.00000 | ms/batch 75.72 | loss  2.85 | ppl    17.25 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 17.02s | valid loss  4.21 | valid ppl    67.12 | valid bpc    6.069
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  216 batches | lr 0.00000 | ms/batch 77.05 | loss  2.87 | ppl    17.59 
| epoch  87 |   200/  216 batches | lr 0.00000 | ms/batch 75.86 | loss  2.85 | ppl    17.22 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 17.02s | valid loss  4.19 | valid ppl    65.81 | valid bpc    6.040
-----------------------------------------------------------------------------------------
PROGRESS: 87.0%
| epoch  88 |   100/  216 batches | lr 0.00000 | ms/batch 77.15 | loss  2.86 | ppl    17.40 
| epoch  88 |   200/  216 batches | lr 0.00000 | ms/batch 76.20 | loss  2.85 | ppl    17.29 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 17.02s | valid loss  4.20 | valid ppl    66.64 | valid bpc    6.058
-----------------------------------------------------------------------------------------
PROGRESS: 88.0%
| epoch  89 |   100/  216 batches | lr 0.00000 | ms/batch 77.16 | loss  2.86 | ppl    17.44 
| epoch  89 |   200/  216 batches | lr 0.00000 | ms/batch 76.23 | loss  2.84 | ppl    17.19 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 17.03s | valid loss  4.22 | valid ppl    67.98 | valid bpc    6.087
-----------------------------------------------------------------------------------------
PROGRESS: 89.0%
| epoch  90 |   100/  216 batches | lr 0.00000 | ms/batch 77.22 | loss  2.86 | ppl    17.47 
| epoch  90 |   200/  216 batches | lr 0.00000 | ms/batch 75.66 | loss  2.87 | ppl    17.57 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 17.02s | valid loss  4.20 | valid ppl    66.85 | valid bpc    6.063
-----------------------------------------------------------------------------------------
PROGRESS: 90.0%
| epoch  91 |   100/  216 batches | lr 0.00000 | ms/batch 77.48 | loss  2.87 | ppl    17.57 
| epoch  91 |   200/  216 batches | lr 0.00000 | ms/batch 75.79 | loss  2.87 | ppl    17.59 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 17.02s | valid loss  4.21 | valid ppl    67.16 | valid bpc    6.070
-----------------------------------------------------------------------------------------
PROGRESS: 91.0%
| epoch  92 |   100/  216 batches | lr 0.00000 | ms/batch 77.00 | loss  2.87 | ppl    17.64 
| epoch  92 |   200/  216 batches | lr 0.00000 | ms/batch 76.57 | loss  2.87 | ppl    17.60 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 17.06s | valid loss  4.18 | valid ppl    65.40 | valid bpc    6.031
-----------------------------------------------------------------------------------------
PROGRESS: 92.0%
| epoch  93 |   100/  216 batches | lr 0.00000 | ms/batch 77.25 | loss  2.85 | ppl    17.32 
| epoch  93 |   200/  216 batches | lr 0.00000 | ms/batch 76.26 | loss  2.85 | ppl    17.33 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 17.04s | valid loss  4.18 | valid ppl    65.64 | valid bpc    6.036
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  216 batches | lr 0.00000 | ms/batch 77.50 | loss  2.89 | ppl    17.91 
| epoch  94 |   200/  216 batches | lr 0.00000 | ms/batch 75.94 | loss  2.81 | ppl    16.65 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 17.02s | valid loss  4.22 | valid ppl    67.83 | valid bpc    6.084
-----------------------------------------------------------------------------------------
PROGRESS: 94.0%
| epoch  95 |   100/  216 batches | lr 0.00000 | ms/batch 77.34 | loss  2.87 | ppl    17.69 
| epoch  95 |   200/  216 batches | lr 0.00000 | ms/batch 75.90 | loss  2.84 | ppl    17.10 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 17.03s | valid loss  4.21 | valid ppl    67.42 | valid bpc    6.075
-----------------------------------------------------------------------------------------
PROGRESS: 95.0%
| epoch  96 |   100/  216 batches | lr 0.00000 | ms/batch 77.61 | loss  2.87 | ppl    17.69 
| epoch  96 |   200/  216 batches | lr 0.00000 | ms/batch 75.57 | loss  2.83 | ppl    16.91 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 17.01s | valid loss  4.18 | valid ppl    65.07 | valid bpc    6.024
-----------------------------------------------------------------------------------------
PROGRESS: 96.0%
| epoch  97 |   100/  216 batches | lr 0.00000 | ms/batch 77.38 | loss  2.84 | ppl    17.16 
| epoch  97 |   200/  216 batches | lr 0.00000 | ms/batch 75.97 | loss  2.86 | ppl    17.41 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 17.03s | valid loss  4.23 | valid ppl    68.68 | valid bpc    6.102
-----------------------------------------------------------------------------------------
PROGRESS: 97.0%
| epoch  98 |   100/  216 batches | lr 0.00000 | ms/batch 77.22 | loss  2.88 | ppl    17.82 
| epoch  98 |   200/  216 batches | lr 0.00000 | ms/batch 76.09 | loss  2.81 | ppl    16.61 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 17.02s | valid loss  4.19 | valid ppl    65.81 | valid bpc    6.040
-----------------------------------------------------------------------------------------
PROGRESS: 98.0%
| epoch  99 |   100/  216 batches | lr 0.00000 | ms/batch 77.38 | loss  2.88 | ppl    17.89 
| epoch  99 |   200/  216 batches | lr 0.00000 | ms/batch 75.88 | loss  2.84 | ppl    17.10 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 17.03s | valid loss  4.23 | valid ppl    68.71 | valid bpc    6.102
-----------------------------------------------------------------------------------------
PROGRESS: 99.0%
| epoch 100 |   100/  216 batches | lr 0.00000 | ms/batch 77.14 | loss  2.85 | ppl    17.31 
| epoch 100 |   200/  216 batches | lr 0.00000 | ms/batch 76.11 | loss  2.84 | ppl    17.09 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 17.02s | valid loss  4.20 | valid ppl    66.40 | valid bpc    6.053
-----------------------------------------------------------------------------------------
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  4.12 | test ppl    61.84 | test bpc    5.950
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.4720, Mean Reca: 0.6487, Mean F1: 0.5381
Counter({'NP': 9506, 'PP': 4347, 'S': 3982, 'VP': 3748, 'SBAR': 1125, 'QP': 248, 'ADJP': 230, 'ADVP': 161, 'SINV': 150, 'PRN': 71, 'NX': 37, 'FRAG': 35, 'WHNP': 25, 'NAC': 15, 'SQ': 14, 'SBARQ': 9, 'UCP': 7, 'CONJP': 5, 'WHPP': 4, 'WHADVP': 3, 'X': 2, 'WHADJP': 1})
Counter({'NP': 14432, 'VP': 8130, 'S': 5620, 'PP': 5484, 'SBAR': 1796, 'ADJP': 649, 'QP': 490, 'ADVP': 286, 'SINV': 157, 'PRN': 128, 'NX': 95, 'FRAG': 42, 'WHNP': 37, 'UCP': 32, 'NAC': 30, 'WHPP': 25, 'CONJP': 21, 'SQ': 18, 'SBARQ': 10, 'WHADVP': 9, 'X': 6, 'WHADJP': 4, 'INTJ': 1})
SBAR: 0.6264
NP: 0.6587
VP: 0.4610
PP: 0.7927
ADJP: 0.3544
ADVP: 0.5629
5.042823549910571
-----------------------------------------------------------------------------------------
Dependency parsing performance:
Conll-U Style:
DDA: 0.071
UDA: 0.316
=========================================================================================
Loading dataset...
Loading dictionary...
Number of tokens:  10001
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer_in_parser', nhid=512, nlayers=8, front_layers=4, rear_layers=4, n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=4444, nonmono=5, cuda=True, log_interval=100, save='trained_models/structformer_in_parser_4444_44.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 38475605
Model architecture: StructFormer_In_Parser(
  (transformer_front): Transformer_Front(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(10001, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-3): 4 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
  (transformer_rear): Transformer_Rear(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(10001, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-3): 4 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (output_layer): Linear(in_features=512, out_features=10001, bias=True)
  )
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  216 batches | lr 0.00030 | ms/batch 79.60 | loss  7.28 | ppl  1450.75 
| epoch   1 |   200/  216 batches | lr 0.00030 | ms/batch 75.45 | loss  6.85 | ppl   941.05 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 17.19s | valid loss  6.68 | valid ppl   799.23 | valid bpc    9.642
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  216 batches | lr 0.00030 | ms/batch 76.81 | loss  6.79 | ppl   885.19 
| epoch   2 |   200/  216 batches | lr 0.00030 | ms/batch 75.38 | loss  6.51 | ppl   671.63 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 16.91s | valid loss  6.32 | valid ppl   556.15 | valid bpc    9.119
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  216 batches | lr 0.00030 | ms/batch 76.99 | loss  6.29 | ppl   537.03 
| epoch   3 |   200/  216 batches | lr 0.00030 | ms/batch 75.80 | loss  6.02 | ppl   410.68 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 16.96s | valid loss  5.86 | valid ppl   352.02 | valid bpc    8.459
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  216 batches | lr 0.00030 | ms/batch 76.67 | loss  5.85 | ppl   348.27 
| epoch   4 |   200/  216 batches | lr 0.00030 | ms/batch 76.38 | loss  5.70 | ppl   300.36 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 16.98s | valid loss  5.55 | valid ppl   257.78 | valid bpc    8.010
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  216 batches | lr 0.00030 | ms/batch 77.18 | loss  5.57 | ppl   262.38 
| epoch   5 |   200/  216 batches | lr 0.00030 | ms/batch 75.74 | loss  5.44 | ppl   231.21 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 17.00s | valid loss  5.32 | valid ppl   205.25 | valid bpc    7.681
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  216 batches | lr 0.00030 | ms/batch 76.92 | loss  5.33 | ppl   206.05 
| epoch   6 |   200/  216 batches | lr 0.00030 | ms/batch 75.89 | loss  5.25 | ppl   190.45 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 17.01s | valid loss  5.15 | valid ppl   173.23 | valid bpc    7.437
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  216 batches | lr 0.00030 | ms/batch 77.30 | loss  5.20 | ppl   182.15 
| epoch   7 |   200/  216 batches | lr 0.00030 | ms/batch 75.98 | loss  5.08 | ppl   160.71 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 17.02s | valid loss  5.11 | valid ppl   166.13 | valid bpc    7.376
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  216 batches | lr 0.00030 | ms/batch 77.17 | loss  5.05 | ppl   155.32 
| epoch   8 |   200/  216 batches | lr 0.00030 | ms/batch 76.13 | loss  4.96 | ppl   142.43 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 17.03s | valid loss  4.98 | valid ppl   145.50 | valid bpc    7.185
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 8.0%
| epoch   9 |   100/  216 batches | lr 0.00030 | ms/batch 77.11 | loss  4.92 | ppl   136.56 
| epoch   9 |   200/  216 batches | lr 0.00030 | ms/batch 76.39 | loss  4.85 | ppl   127.65 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 17.05s | valid loss  4.89 | valid ppl   133.34 | valid bpc    7.059
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  216 batches | lr 0.00030 | ms/batch 77.43 | loss  4.82 | ppl   123.84 
| epoch  10 |   200/  216 batches | lr 0.00030 | ms/batch 75.69 | loss  4.74 | ppl   114.50 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 17.02s | valid loss  4.80 | valid ppl   121.78 | valid bpc    6.928
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  216 batches | lr 0.00030 | ms/batch 77.50 | loss  4.73 | ppl   112.76 
| epoch  11 |   200/  216 batches | lr 0.00030 | ms/batch 75.83 | loss  4.63 | ppl   102.83 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 17.02s | valid loss  4.75 | valid ppl   115.14 | valid bpc    6.847
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  216 batches | lr 0.00030 | ms/batch 76.88 | loss  4.63 | ppl   102.59 
| epoch  12 |   200/  216 batches | lr 0.00030 | ms/batch 76.42 | loss  4.56 | ppl    95.90 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 17.03s | valid loss  4.68 | valid ppl   108.18 | valid bpc    6.757
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 12.0%
| epoch  13 |   100/  216 batches | lr 0.00030 | ms/batch 77.12 | loss  4.53 | ppl    92.63 
| epoch  13 |   200/  216 batches | lr 0.00030 | ms/batch 76.14 | loss  4.50 | ppl    89.65 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 17.02s | valid loss  4.69 | valid ppl   108.35 | valid bpc    6.760
-----------------------------------------------------------------------------------------
PROGRESS: 13.0%
| epoch  14 |   100/  216 batches | lr 0.00030 | ms/batch 77.45 | loss  4.43 | ppl    83.62 
| epoch  14 |   200/  216 batches | lr 0.00030 | ms/batch 75.99 | loss  4.43 | ppl    83.82 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 17.03s | valid loss  4.59 | valid ppl    98.75 | valid bpc    6.626
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  216 batches | lr 0.00030 | ms/batch 77.27 | loss  4.39 | ppl    80.24 
| epoch  15 |   200/  216 batches | lr 0.00030 | ms/batch 75.99 | loss  4.34 | ppl    76.68 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 17.02s | valid loss  4.57 | valid ppl    96.13 | valid bpc    6.587
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 15.0%
| epoch  16 |   100/  216 batches | lr 0.00030 | ms/batch 77.26 | loss  4.32 | ppl    75.08 
| epoch  16 |   200/  216 batches | lr 0.00030 | ms/batch 76.09 | loss  4.29 | ppl    72.68 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 17.03s | valid loss  4.54 | valid ppl    94.14 | valid bpc    6.557
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 16.0%
| epoch  17 |   100/  216 batches | lr 0.00030 | ms/batch 77.16 | loss  4.27 | ppl    71.79 
| epoch  17 |   200/  216 batches | lr 0.00030 | ms/batch 76.36 | loss  4.22 | ppl    68.10 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 17.04s | valid loss  4.51 | valid ppl    90.70 | valid bpc    6.503
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 17.0%
| epoch  18 |   100/  216 batches | lr 0.00030 | ms/batch 77.08 | loss  4.20 | ppl    66.99 
| epoch  18 |   200/  216 batches | lr 0.00030 | ms/batch 76.24 | loss  4.17 | ppl    64.71 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 17.03s | valid loss  4.45 | valid ppl    85.89 | valid bpc    6.424
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 18.0%
| epoch  19 |   100/  216 batches | lr 0.00030 | ms/batch 77.11 | loss  4.15 | ppl    63.60 
| epoch  19 |   200/  216 batches | lr 0.00030 | ms/batch 76.24 | loss  4.09 | ppl    59.91 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 17.03s | valid loss  4.45 | valid ppl    85.88 | valid bpc    6.424
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 19.0%
| epoch  20 |   100/  216 batches | lr 0.00030 | ms/batch 77.25 | loss  4.08 | ppl    59.22 
| epoch  20 |   200/  216 batches | lr 0.00030 | ms/batch 75.80 | loss  4.05 | ppl    57.51 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 17.03s | valid loss  4.37 | valid ppl    78.91 | valid bpc    6.302
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 20.0%
| epoch  21 |   100/  216 batches | lr 0.00030 | ms/batch 77.40 | loss  4.02 | ppl    55.86 
| epoch  21 |   200/  216 batches | lr 0.00030 | ms/batch 75.99 | loss  4.02 | ppl    55.47 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 17.03s | valid loss  4.40 | valid ppl    81.14 | valid bpc    6.342
-----------------------------------------------------------------------------------------
PROGRESS: 21.0%
| epoch  22 |   100/  216 batches | lr 0.00030 | ms/batch 77.33 | loss  3.99 | ppl    53.96 
| epoch  22 |   200/  216 batches | lr 0.00030 | ms/batch 76.05 | loss  3.95 | ppl    51.95 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 17.04s | valid loss  4.36 | valid ppl    78.61 | valid bpc    6.297
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 22.0%
| epoch  23 |   100/  216 batches | lr 0.00030 | ms/batch 77.27 | loss  3.92 | ppl    50.48 
| epoch  23 |   200/  216 batches | lr 0.00030 | ms/batch 76.03 | loss  3.92 | ppl    50.41 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 17.03s | valid loss  4.32 | valid ppl    75.44 | valid bpc    6.237
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 23.0%
| epoch  24 |   100/  216 batches | lr 0.00030 | ms/batch 77.49 | loss  3.89 | ppl    49.02 
| epoch  24 |   200/  216 batches | lr 0.00030 | ms/batch 75.81 | loss  3.85 | ppl    47.09 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 17.03s | valid loss  4.36 | valid ppl    78.01 | valid bpc    6.286
-----------------------------------------------------------------------------------------
PROGRESS: 24.0%
| epoch  25 |   100/  216 batches | lr 0.00030 | ms/batch 77.18 | loss  3.84 | ppl    46.68 
| epoch  25 |   200/  216 batches | lr 0.00030 | ms/batch 76.26 | loss  3.81 | ppl    45.02 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 17.03s | valid loss  4.32 | valid ppl    74.90 | valid bpc    6.227
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 25.0%
| epoch  26 |   100/  216 batches | lr 0.00030 | ms/batch 77.31 | loss  3.78 | ppl    43.99 
| epoch  26 |   200/  216 batches | lr 0.00030 | ms/batch 75.88 | loss  3.76 | ppl    42.82 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 17.02s | valid loss  4.29 | valid ppl    72.97 | valid bpc    6.189
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 26.0%
| epoch  27 |   100/  216 batches | lr 0.00030 | ms/batch 77.31 | loss  3.76 | ppl    43.04 
| epoch  27 |   200/  216 batches | lr 0.00030 | ms/batch 75.94 | loss  3.73 | ppl    41.57 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 17.02s | valid loss  4.29 | valid ppl    72.69 | valid bpc    6.184
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 27.0%
| epoch  28 |   100/  216 batches | lr 0.00030 | ms/batch 77.34 | loss  3.71 | ppl    40.85 
| epoch  28 |   200/  216 batches | lr 0.00030 | ms/batch 75.95 | loss  3.69 | ppl    40.20 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 17.03s | valid loss  4.29 | valid ppl    72.81 | valid bpc    6.186
-----------------------------------------------------------------------------------------
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  216 batches | lr 0.00030 | ms/batch 77.30 | loss  3.69 | ppl    39.90 
| epoch  29 |   200/  216 batches | lr 0.00030 | ms/batch 75.95 | loss  3.64 | ppl    38.16 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 17.03s | valid loss  4.25 | valid ppl    70.33 | valid bpc    6.136
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  216 batches | lr 0.00030 | ms/batch 76.94 | loss  3.63 | ppl    37.55 
| epoch  30 |   200/  216 batches | lr 0.00030 | ms/batch 76.30 | loss  3.60 | ppl    36.71 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 17.02s | valid loss  4.34 | valid ppl    76.83 | valid bpc    6.264
-----------------------------------------------------------------------------------------
PROGRESS: 30.0%
| epoch  31 |   100/  216 batches | lr 0.00030 | ms/batch 77.12 | loss  3.58 | ppl    36.01 
| epoch  31 |   200/  216 batches | lr 0.00030 | ms/batch 76.29 | loss  3.55 | ppl    34.86 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 17.04s | valid loss  4.25 | valid ppl    70.10 | valid bpc    6.131
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 31.0%
| epoch  32 |   100/  216 batches | lr 0.00030 | ms/batch 77.47 | loss  3.56 | ppl    35.23 
| epoch  32 |   200/  216 batches | lr 0.00030 | ms/batch 75.73 | loss  3.52 | ppl    33.87 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 17.01s | valid loss  4.25 | valid ppl    70.20 | valid bpc    6.133
-----------------------------------------------------------------------------------------
PROGRESS: 32.0%
| epoch  33 |   100/  216 batches | lr 0.00030 | ms/batch 77.64 | loss  3.52 | ppl    33.63 
| epoch  33 |   200/  216 batches | lr 0.00030 | ms/batch 75.64 | loss  3.50 | ppl    33.20 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 17.03s | valid loss  4.31 | valid ppl    74.44 | valid bpc    6.218
-----------------------------------------------------------------------------------------
PROGRESS: 33.0%
| epoch  34 |   100/  216 batches | lr 0.00030 | ms/batch 77.21 | loss  3.48 | ppl    32.42 
| epoch  34 |   200/  216 batches | lr 0.00030 | ms/batch 76.19 | loss  3.47 | ppl    32.15 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 17.04s | valid loss  4.29 | valid ppl    72.77 | valid bpc    6.185
-----------------------------------------------------------------------------------------
PROGRESS: 34.0%
| epoch  35 |   100/  216 batches | lr 0.00015 | ms/batch 77.30 | loss  3.41 | ppl    30.39 
| epoch  35 |   200/  216 batches | lr 0.00015 | ms/batch 75.93 | loss  3.34 | ppl    28.18 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 17.03s | valid loss  4.22 | valid ppl    68.06 | valid bpc    6.089
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 35.0%
| epoch  36 |   100/  216 batches | lr 0.00015 | ms/batch 77.28 | loss  3.34 | ppl    28.27 
| epoch  36 |   200/  216 batches | lr 0.00015 | ms/batch 75.91 | loss  3.30 | ppl    27.00 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 17.03s | valid loss  4.25 | valid ppl    70.19 | valid bpc    6.133
-----------------------------------------------------------------------------------------
PROGRESS: 36.0%
| epoch  37 |   100/  216 batches | lr 0.00015 | ms/batch 77.05 | loss  3.31 | ppl    27.49 
| epoch  37 |   200/  216 batches | lr 0.00015 | ms/batch 76.20 | loss  3.28 | ppl    26.48 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 17.03s | valid loss  4.24 | valid ppl    69.42 | valid bpc    6.117
-----------------------------------------------------------------------------------------
PROGRESS: 37.0%
| epoch  38 |   100/  216 batches | lr 0.00015 | ms/batch 77.11 | loss  3.27 | ppl    26.26 
| epoch  38 |   200/  216 batches | lr 0.00015 | ms/batch 76.35 | loss  3.27 | ppl    26.34 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 17.05s | valid loss  4.21 | valid ppl    67.44 | valid bpc    6.076
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 38.0%
| epoch  39 |   100/  216 batches | lr 0.00015 | ms/batch 77.45 | loss  3.24 | ppl    25.65 
| epoch  39 |   200/  216 batches | lr 0.00015 | ms/batch 75.75 | loss  3.23 | ppl    25.25 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 17.02s | valid loss  4.15 | valid ppl    63.68 | valid bpc    5.993
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 39.0%
| epoch  40 |   100/  216 batches | lr 0.00015 | ms/batch 77.13 | loss  3.22 | ppl    25.09 
| epoch  40 |   200/  216 batches | lr 0.00015 | ms/batch 76.21 | loss  3.20 | ppl    24.61 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 17.02s | valid loss  4.17 | valid ppl    64.45 | valid bpc    6.010
-----------------------------------------------------------------------------------------
PROGRESS: 40.0%
| epoch  41 |   100/  216 batches | lr 0.00015 | ms/batch 77.28 | loss  3.20 | ppl    24.44 
| epoch  41 |   200/  216 batches | lr 0.00015 | ms/batch 76.19 | loss  3.21 | ppl    24.74 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 17.05s | valid loss  4.21 | valid ppl    67.67 | valid bpc    6.080
-----------------------------------------------------------------------------------------
PROGRESS: 41.0%
| epoch  42 |   100/  216 batches | lr 0.00015 | ms/batch 77.61 | loss  3.18 | ppl    24.12 
| epoch  42 |   200/  216 batches | lr 0.00015 | ms/batch 75.73 | loss  3.17 | ppl    23.83 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 17.03s | valid loss  4.18 | valid ppl    65.61 | valid bpc    6.036
-----------------------------------------------------------------------------------------
PROGRESS: 42.0%
| epoch  43 |   100/  216 batches | lr 0.00007 | ms/batch 77.23 | loss  3.12 | ppl    22.56 
| epoch  43 |   200/  216 batches | lr 0.00007 | ms/batch 75.94 | loss  3.10 | ppl    22.15 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 17.02s | valid loss  4.19 | valid ppl    66.24 | valid bpc    6.050
-----------------------------------------------------------------------------------------
PROGRESS: 43.0%
| epoch  44 |   100/  216 batches | lr 0.00007 | ms/batch 76.82 | loss  3.09 | ppl    22.06 
| epoch  44 |   200/  216 batches | lr 0.00007 | ms/batch 76.54 | loss  3.08 | ppl    21.68 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 17.04s | valid loss  4.21 | valid ppl    67.32 | valid bpc    6.073
-----------------------------------------------------------------------------------------
PROGRESS: 44.0%
| epoch  45 |   100/  216 batches | lr 0.00007 | ms/batch 77.18 | loss  3.09 | ppl    21.99 
| epoch  45 |   200/  216 batches | lr 0.00007 | ms/batch 76.23 | loss  3.06 | ppl    21.27 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 17.04s | valid loss  4.19 | valid ppl    66.13 | valid bpc    6.047
-----------------------------------------------------------------------------------------
PROGRESS: 45.0%
| epoch  46 |   100/  216 batches | lr 0.00004 | ms/batch 77.04 | loss  3.05 | ppl    21.19 
| epoch  46 |   200/  216 batches | lr 0.00004 | ms/batch 76.45 | loss  3.03 | ppl    20.66 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 17.04s | valid loss  4.22 | valid ppl    67.92 | valid bpc    6.086
-----------------------------------------------------------------------------------------
PROGRESS: 46.0%
| epoch  47 |   100/  216 batches | lr 0.00004 | ms/batch 77.29 | loss  3.04 | ppl    21.00 
| epoch  47 |   200/  216 batches | lr 0.00004 | ms/batch 75.66 | loss  3.01 | ppl    20.22 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 17.03s | valid loss  4.19 | valid ppl    66.10 | valid bpc    6.047
-----------------------------------------------------------------------------------------
PROGRESS: 47.0%
| epoch  48 |   100/  216 batches | lr 0.00004 | ms/batch 77.06 | loss  3.03 | ppl    20.69 
| epoch  48 |   200/  216 batches | lr 0.00004 | ms/batch 76.37 | loss  3.00 | ppl    20.07 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 17.02s | valid loss  4.15 | valid ppl    63.18 | valid bpc    5.982
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 48.0%
| epoch  49 |   100/  216 batches | lr 0.00004 | ms/batch 77.06 | loss  3.00 | ppl    20.15 
| epoch  49 |   200/  216 batches | lr 0.00004 | ms/batch 76.20 | loss  3.00 | ppl    20.15 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 17.02s | valid loss  4.19 | valid ppl    66.16 | valid bpc    6.048
-----------------------------------------------------------------------------------------
PROGRESS: 49.0%
| epoch  50 |   100/  216 batches | lr 0.00004 | ms/batch 77.03 | loss  3.01 | ppl    20.27 
| epoch  50 |   200/  216 batches | lr 0.00004 | ms/batch 76.30 | loss  2.99 | ppl    19.83 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 17.03s | valid loss  4.16 | valid ppl    63.90 | valid bpc    5.998
-----------------------------------------------------------------------------------------
PROGRESS: 50.0%
| epoch  51 |   100/  216 batches | lr 0.00004 | ms/batch 77.39 | loss  2.99 | ppl    19.87 
| epoch  51 |   200/  216 batches | lr 0.00004 | ms/batch 75.80 | loss  2.99 | ppl    19.87 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 17.03s | valid loss  4.11 | valid ppl    61.17 | valid bpc    5.935
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 51.0%
| epoch  52 |   100/  216 batches | lr 0.00004 | ms/batch 77.38 | loss  3.01 | ppl    20.27 
| epoch  52 |   200/  216 batches | lr 0.00004 | ms/batch 75.94 | loss  2.95 | ppl    19.18 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 17.03s | valid loss  4.19 | valid ppl    66.31 | valid bpc    6.051
-----------------------------------------------------------------------------------------
PROGRESS: 52.0%
| epoch  53 |   100/  216 batches | lr 0.00004 | ms/batch 77.15 | loss  2.98 | ppl    19.68 
| epoch  53 |   200/  216 batches | lr 0.00004 | ms/batch 76.30 | loss  2.97 | ppl    19.55 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 17.03s | valid loss  4.17 | valid ppl    64.96 | valid bpc    6.021
-----------------------------------------------------------------------------------------
PROGRESS: 53.0%
| epoch  54 |   100/  216 batches | lr 0.00004 | ms/batch 77.39 | loss  2.97 | ppl    19.45 
| epoch  54 |   200/  216 batches | lr 0.00004 | ms/batch 76.12 | loss  2.97 | ppl    19.51 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 17.04s | valid loss  4.23 | valid ppl    68.67 | valid bpc    6.102
-----------------------------------------------------------------------------------------
PROGRESS: 54.0%
| epoch  55 |   100/  216 batches | lr 0.00002 | ms/batch 77.21 | loss  2.96 | ppl    19.39 
| epoch  55 |   200/  216 batches | lr 0.00002 | ms/batch 75.99 | loss  2.92 | ppl    18.61 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 17.03s | valid loss  4.16 | valid ppl    64.03 | valid bpc    6.001
-----------------------------------------------------------------------------------------
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  216 batches | lr 0.00002 | ms/batch 76.73 | loss  2.95 | ppl    19.07 
| epoch  56 |   200/  216 batches | lr 0.00002 | ms/batch 76.59 | loss  2.93 | ppl    18.75 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 17.03s | valid loss  4.21 | valid ppl    67.13 | valid bpc    6.069
-----------------------------------------------------------------------------------------
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  216 batches | lr 0.00002 | ms/batch 77.15 | loss  2.93 | ppl    18.75 
| epoch  57 |   200/  216 batches | lr 0.00002 | ms/batch 76.37 | loss  2.92 | ppl    18.57 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 17.03s | valid loss  4.18 | valid ppl    65.26 | valid bpc    6.028
-----------------------------------------------------------------------------------------
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  216 batches | lr 0.00001 | ms/batch 77.45 | loss  2.95 | ppl    19.05 
| epoch  58 |   200/  216 batches | lr 0.00001 | ms/batch 75.99 | loss  2.91 | ppl    18.29 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 17.04s | valid loss  4.17 | valid ppl    64.72 | valid bpc    6.016
-----------------------------------------------------------------------------------------
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  216 batches | lr 0.00001 | ms/batch 76.98 | loss  2.93 | ppl    18.65 
| epoch  59 |   200/  216 batches | lr 0.00001 | ms/batch 76.19 | loss  2.93 | ppl    18.78 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 17.04s | valid loss  4.21 | valid ppl    67.39 | valid bpc    6.074
-----------------------------------------------------------------------------------------
PROGRESS: 59.0%
| epoch  60 |   100/  216 batches | lr 0.00001 | ms/batch 77.57 | loss  2.93 | ppl    18.78 
| epoch  60 |   200/  216 batches | lr 0.00001 | ms/batch 75.80 | loss  2.91 | ppl    18.33 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 17.04s | valid loss  4.19 | valid ppl    66.02 | valid bpc    6.045
-----------------------------------------------------------------------------------------
PROGRESS: 60.0%
| epoch  61 |   100/  216 batches | lr 0.00000 | ms/batch 77.49 | loss  2.92 | ppl    18.56 
| epoch  61 |   200/  216 batches | lr 0.00000 | ms/batch 75.96 | loss  2.92 | ppl    18.59 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 17.03s | valid loss  4.18 | valid ppl    65.04 | valid bpc    6.023
-----------------------------------------------------------------------------------------
PROGRESS: 61.0%
| epoch  62 |   100/  216 batches | lr 0.00000 | ms/batch 77.50 | loss  2.92 | ppl    18.45 
| epoch  62 |   200/  216 batches | lr 0.00000 | ms/batch 75.95 | loss  2.91 | ppl    18.40 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 17.04s | valid loss  4.21 | valid ppl    67.37 | valid bpc    6.074
-----------------------------------------------------------------------------------------
PROGRESS: 62.0%
| epoch  63 |   100/  216 batches | lr 0.00000 | ms/batch 77.52 | loss  2.95 | ppl    19.02 
| epoch  63 |   200/  216 batches | lr 0.00000 | ms/batch 75.80 | loss  2.90 | ppl    18.22 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 17.03s | valid loss  4.17 | valid ppl    64.51 | valid bpc    6.011
-----------------------------------------------------------------------------------------
PROGRESS: 63.0%
| epoch  64 |   100/  216 batches | lr 0.00000 | ms/batch 77.41 | loss  2.95 | ppl    19.14 
| epoch  64 |   200/  216 batches | lr 0.00000 | ms/batch 75.86 | loss  2.90 | ppl    18.11 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 17.03s | valid loss  4.17 | valid ppl    64.46 | valid bpc    6.010
-----------------------------------------------------------------------------------------
PROGRESS: 64.0%
| epoch  65 |   100/  216 batches | lr 0.00000 | ms/batch 77.70 | loss  2.90 | ppl    18.12 
| epoch  65 |   200/  216 batches | lr 0.00000 | ms/batch 75.70 | loss  2.93 | ppl    18.71 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 17.03s | valid loss  4.19 | valid ppl    66.33 | valid bpc    6.052
-----------------------------------------------------------------------------------------
PROGRESS: 65.0%
| epoch  66 |   100/  216 batches | lr 0.00000 | ms/batch 77.16 | loss  2.93 | ppl    18.70 
| epoch  66 |   200/  216 batches | lr 0.00000 | ms/batch 75.82 | loss  2.89 | ppl    18.03 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 17.03s | valid loss  4.20 | valid ppl    66.90 | valid bpc    6.064
-----------------------------------------------------------------------------------------
PROGRESS: 66.0%
| epoch  67 |   100/  216 batches | lr 0.00000 | ms/batch 77.13 | loss  2.95 | ppl    19.13 
| epoch  67 |   200/  216 batches | lr 0.00000 | ms/batch 76.21 | loss  2.90 | ppl    18.26 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 17.03s | valid loss  4.18 | valid ppl    65.17 | valid bpc    6.026
-----------------------------------------------------------------------------------------
PROGRESS: 67.0%
| epoch  68 |   100/  216 batches | lr 0.00000 | ms/batch 77.52 | loss  2.93 | ppl    18.79 
| epoch  68 |   200/  216 batches | lr 0.00000 | ms/batch 75.72 | loss  2.89 | ppl    18.00 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 17.02s | valid loss  4.19 | valid ppl    65.85 | valid bpc    6.041
-----------------------------------------------------------------------------------------
PROGRESS: 68.0%
| epoch  69 |   100/  216 batches | lr 0.00000 | ms/batch 77.35 | loss  2.95 | ppl    19.02 
| epoch  69 |   200/  216 batches | lr 0.00000 | ms/batch 75.86 | loss  2.90 | ppl    18.20 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 17.04s | valid loss  4.20 | valid ppl    66.79 | valid bpc    6.061
-----------------------------------------------------------------------------------------
PROGRESS: 69.0%
| epoch  70 |   100/  216 batches | lr 0.00000 | ms/batch 76.90 | loss  2.92 | ppl    18.58 
| epoch  70 |   200/  216 batches | lr 0.00000 | ms/batch 76.51 | loss  2.90 | ppl    18.21 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 17.04s | valid loss  4.20 | valid ppl    66.43 | valid bpc    6.054
-----------------------------------------------------------------------------------------
PROGRESS: 70.0%
| epoch  71 |   100/  216 batches | lr 0.00000 | ms/batch 77.18 | loss  2.91 | ppl    18.43 
| epoch  71 |   200/  216 batches | lr 0.00000 | ms/batch 76.20 | loss  2.90 | ppl    18.18 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 17.04s | valid loss  4.17 | valid ppl    64.89 | valid bpc    6.020
-----------------------------------------------------------------------------------------
PROGRESS: 71.0%
| epoch  72 |   100/  216 batches | lr 0.00000 | ms/batch 77.39 | loss  2.93 | ppl    18.68 
| epoch  72 |   200/  216 batches | lr 0.00000 | ms/batch 75.82 | loss  2.89 | ppl    18.06 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 17.03s | valid loss  4.18 | valid ppl    65.40 | valid bpc    6.031
-----------------------------------------------------------------------------------------
PROGRESS: 72.0%
| epoch  73 |   100/  216 batches | lr 0.00000 | ms/batch 76.86 | loss  2.94 | ppl    18.84 
| epoch  73 |   200/  216 batches | lr 0.00000 | ms/batch 76.52 | loss  2.90 | ppl    18.11 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 17.03s | valid loss  4.21 | valid ppl    67.45 | valid bpc    6.076
-----------------------------------------------------------------------------------------
PROGRESS: 73.0%
| epoch  74 |   100/  216 batches | lr 0.00000 | ms/batch 76.85 | loss  2.95 | ppl    19.05 
| epoch  74 |   200/  216 batches | lr 0.00000 | ms/batch 76.41 | loss  2.89 | ppl    17.97 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 17.03s | valid loss  4.19 | valid ppl    65.78 | valid bpc    6.039
-----------------------------------------------------------------------------------------
PROGRESS: 74.0%
| epoch  75 |   100/  216 batches | lr 0.00000 | ms/batch 77.11 | loss  2.93 | ppl    18.68 
| epoch  75 |   200/  216 batches | lr 0.00000 | ms/batch 75.96 | loss  2.90 | ppl    18.23 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 17.04s | valid loss  4.16 | valid ppl    64.37 | valid bpc    6.008
-----------------------------------------------------------------------------------------
PROGRESS: 75.0%
| epoch  76 |   100/  216 batches | lr 0.00000 | ms/batch 77.30 | loss  2.92 | ppl    18.62 
| epoch  76 |   200/  216 batches | lr 0.00000 | ms/batch 76.20 | loss  2.89 | ppl    17.92 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 17.04s | valid loss  4.21 | valid ppl    67.10 | valid bpc    6.068
-----------------------------------------------------------------------------------------
PROGRESS: 76.0%
| epoch  77 |   100/  216 batches | lr 0.00000 | ms/batch 77.27 | loss  2.91 | ppl    18.36 
| epoch  77 |   200/  216 batches | lr 0.00000 | ms/batch 76.16 | loss  2.90 | ppl    18.21 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 17.04s | valid loss  4.17 | valid ppl    64.90 | valid bpc    6.020
-----------------------------------------------------------------------------------------
PROGRESS: 77.0%
| epoch  78 |   100/  216 batches | lr 0.00000 | ms/batch 77.54 | loss  2.92 | ppl    18.63 
| epoch  78 |   200/  216 batches | lr 0.00000 | ms/batch 76.07 | loss  2.89 | ppl    17.98 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 17.05s | valid loss  4.20 | valid ppl    66.66 | valid bpc    6.059
-----------------------------------------------------------------------------------------
PROGRESS: 78.0%
| epoch  79 |   100/  216 batches | lr 0.00000 | ms/batch 77.05 | loss  2.93 | ppl    18.79 
| epoch  79 |   200/  216 batches | lr 0.00000 | ms/batch 75.83 | loss  2.89 | ppl    17.96 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 17.05s | valid loss  4.16 | valid ppl    64.10 | valid bpc    6.002
-----------------------------------------------------------------------------------------
PROGRESS: 79.0%
| epoch  80 |   100/  216 batches | lr 0.00000 | ms/batch 77.50 | loss  2.91 | ppl    18.33 
| epoch  80 |   200/  216 batches | lr 0.00000 | ms/batch 75.91 | loss  2.92 | ppl    18.49 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 17.04s | valid loss  4.21 | valid ppl    67.46 | valid bpc    6.076
-----------------------------------------------------------------------------------------
PROGRESS: 80.0%
| epoch  81 |   100/  216 batches | lr 0.00000 | ms/batch 77.28 | loss  2.92 | ppl    18.58 
| epoch  81 |   200/  216 batches | lr 0.00000 | ms/batch 75.85 | loss  2.89 | ppl    17.92 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 17.03s | valid loss  4.21 | valid ppl    67.39 | valid bpc    6.074
-----------------------------------------------------------------------------------------
PROGRESS: 81.0%
| epoch  82 |   100/  216 batches | lr 0.00000 | ms/batch 77.28 | loss  2.94 | ppl    19.00 
| epoch  82 |   200/  216 batches | lr 0.00000 | ms/batch 75.98 | loss  2.89 | ppl    18.00 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 17.02s | valid loss  4.19 | valid ppl    66.20 | valid bpc    6.049
-----------------------------------------------------------------------------------------
PROGRESS: 82.0%
| epoch  83 |   100/  216 batches | lr 0.00000 | ms/batch 77.46 | loss  2.93 | ppl    18.81 
| epoch  83 |   200/  216 batches | lr 0.00000 | ms/batch 75.85 | loss  2.90 | ppl    18.12 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 17.03s | valid loss  4.18 | valid ppl    65.68 | valid bpc    6.037
-----------------------------------------------------------------------------------------
PROGRESS: 83.0%
| epoch  84 |   100/  216 batches | lr 0.00000 | ms/batch 77.63 | loss  2.92 | ppl    18.60 
| epoch  84 |   200/  216 batches | lr 0.00000 | ms/batch 75.69 | loss  2.90 | ppl    18.21 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 17.03s | valid loss  4.22 | valid ppl    67.89 | valid bpc    6.085
-----------------------------------------------------------------------------------------
PROGRESS: 84.0%
| epoch  85 |   100/  216 batches | lr 0.00000 | ms/batch 77.17 | loss  2.93 | ppl    18.75 
| epoch  85 |   200/  216 batches | lr 0.00000 | ms/batch 76.25 | loss  2.89 | ppl    17.97 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 17.03s | valid loss  4.20 | valid ppl    66.91 | valid bpc    6.064
-----------------------------------------------------------------------------------------
PROGRESS: 85.0%
| epoch  86 |   100/  216 batches | lr 0.00000 | ms/batch 77.40 | loss  2.93 | ppl    18.68 
| epoch  86 |   200/  216 batches | lr 0.00000 | ms/batch 75.92 | loss  2.90 | ppl    18.16 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 17.03s | valid loss  4.16 | valid ppl    64.05 | valid bpc    6.001
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  216 batches | lr 0.00000 | ms/batch 77.34 | loss  2.94 | ppl    18.83 
| epoch  87 |   200/  216 batches | lr 0.00000 | ms/batch 75.96 | loss  2.90 | ppl    18.19 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 17.03s | valid loss  4.19 | valid ppl    66.24 | valid bpc    6.050
-----------------------------------------------------------------------------------------
PROGRESS: 87.0%
| epoch  88 |   100/  216 batches | lr 0.00000 | ms/batch 77.49 | loss  2.92 | ppl    18.60 
| epoch  88 |   200/  216 batches | lr 0.00000 | ms/batch 75.81 | loss  2.90 | ppl    18.20 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 17.03s | valid loss  4.16 | valid ppl    64.27 | valid bpc    6.006
-----------------------------------------------------------------------------------------
PROGRESS: 88.0%
| epoch  89 |   100/  216 batches | lr 0.00000 | ms/batch 77.43 | loss  2.94 | ppl    18.84 
| epoch  89 |   200/  216 batches | lr 0.00000 | ms/batch 76.02 | loss  2.89 | ppl    18.04 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 17.03s | valid loss  4.17 | valid ppl    64.70 | valid bpc    6.016
-----------------------------------------------------------------------------------------
PROGRESS: 89.0%
| epoch  90 |   100/  216 batches | lr 0.00000 | ms/batch 77.23 | loss  2.93 | ppl    18.70 
| epoch  90 |   200/  216 batches | lr 0.00000 | ms/batch 76.28 | loss  2.90 | ppl    18.11 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 17.04s | valid loss  4.21 | valid ppl    67.21 | valid bpc    6.071
-----------------------------------------------------------------------------------------
PROGRESS: 90.0%
| epoch  91 |   100/  216 batches | lr 0.00000 | ms/batch 77.25 | loss  2.92 | ppl    18.63 
| epoch  91 |   200/  216 batches | lr 0.00000 | ms/batch 75.73 | loss  2.88 | ppl    17.79 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 17.04s | valid loss  4.17 | valid ppl    64.68 | valid bpc    6.015
-----------------------------------------------------------------------------------------
PROGRESS: 91.0%
| epoch  92 |   100/  216 batches | lr 0.00000 | ms/batch 77.29 | loss  2.94 | ppl    18.91 
| epoch  92 |   200/  216 batches | lr 0.00000 | ms/batch 76.16 | loss  2.88 | ppl    17.79 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 17.04s | valid loss  4.21 | valid ppl    67.23 | valid bpc    6.071
-----------------------------------------------------------------------------------------
PROGRESS: 92.0%
| epoch  93 |   100/  216 batches | lr 0.00000 | ms/batch 77.49 | loss  2.92 | ppl    18.58 
| epoch  93 |   200/  216 batches | lr 0.00000 | ms/batch 75.71 | loss  2.90 | ppl    18.26 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 17.02s | valid loss  4.15 | valid ppl    63.52 | valid bpc    5.989
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  216 batches | lr 0.00000 | ms/batch 77.29 | loss  2.95 | ppl    19.05 
| epoch  94 |   200/  216 batches | lr 0.00000 | ms/batch 75.91 | loss  2.89 | ppl    18.02 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 17.02s | valid loss  4.17 | valid ppl    64.56 | valid bpc    6.013
-----------------------------------------------------------------------------------------
PROGRESS: 94.0%
| epoch  95 |   100/  216 batches | lr 0.00000 | ms/batch 77.38 | loss  2.94 | ppl    18.91 
| epoch  95 |   200/  216 batches | lr 0.00000 | ms/batch 76.01 | loss  2.89 | ppl    17.91 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 17.03s | valid loss  4.18 | valid ppl    65.56 | valid bpc    6.035
-----------------------------------------------------------------------------------------
PROGRESS: 95.0%
| epoch  96 |   100/  216 batches | lr 0.00000 | ms/batch 76.98 | loss  2.90 | ppl    18.18 
| epoch  96 |   200/  216 batches | lr 0.00000 | ms/batch 75.81 | loss  2.90 | ppl    18.09 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 17.02s | valid loss  4.16 | valid ppl    63.87 | valid bpc    5.997
-----------------------------------------------------------------------------------------
PROGRESS: 96.0%
| epoch  97 |   100/  216 batches | lr 0.00000 | ms/batch 76.97 | loss  2.91 | ppl    18.33 
| epoch  97 |   200/  216 batches | lr 0.00000 | ms/batch 76.45 | loss  2.90 | ppl    18.25 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 17.04s | valid loss  4.16 | valid ppl    63.89 | valid bpc    5.998
-----------------------------------------------------------------------------------------
PROGRESS: 97.0%
| epoch  98 |   100/  216 batches | lr 0.00000 | ms/batch 77.25 | loss  2.92 | ppl    18.58 
| epoch  98 |   200/  216 batches | lr 0.00000 | ms/batch 76.05 | loss  2.91 | ppl    18.35 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 17.02s | valid loss  4.18 | valid ppl    65.45 | valid bpc    6.032
-----------------------------------------------------------------------------------------
PROGRESS: 98.0%
| epoch  99 |   100/  216 batches | lr 0.00000 | ms/batch 77.12 | loss  2.91 | ppl    18.44 
| epoch  99 |   200/  216 batches | lr 0.00000 | ms/batch 76.17 | loss  2.91 | ppl    18.34 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 17.02s | valid loss  4.17 | valid ppl    64.50 | valid bpc    6.011
-----------------------------------------------------------------------------------------
PROGRESS: 99.0%
| epoch 100 |   100/  216 batches | lr 0.00000 | ms/batch 77.18 | loss  2.93 | ppl    18.76 
| epoch 100 |   200/  216 batches | lr 0.00000 | ms/batch 75.80 | loss  2.88 | ppl    17.77 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 17.03s | valid loss  4.18 | valid ppl    65.33 | valid bpc    6.030
-----------------------------------------------------------------------------------------
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  4.16 | test ppl    63.87 | test bpc    5.997
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.3523, Mean Reca: 0.4865, Mean F1: 0.4010
Counter({'NP': 9530, 'S': 3017, 'PP': 2260, 'VP': 1745, 'ADJP': 307, 'QP': 303, 'SBAR': 297, 'ADVP': 157, 'SINV': 146, 'PRN': 31, 'FRAG': 31, 'WHNP': 21, 'NAC': 18, 'SQ': 11, 'NX': 10, 'UCP': 8, 'SBARQ': 8, 'CONJP': 6, 'WHPP': 5, 'X': 3})
Counter({'NP': 14432, 'VP': 8130, 'S': 5620, 'PP': 5484, 'SBAR': 1796, 'ADJP': 649, 'QP': 490, 'ADVP': 286, 'SINV': 157, 'PRN': 128, 'NX': 95, 'FRAG': 42, 'WHNP': 37, 'UCP': 32, 'NAC': 30, 'WHPP': 25, 'CONJP': 21, 'SQ': 18, 'SBARQ': 10, 'WHADVP': 9, 'X': 6, 'WHADJP': 4, 'INTJ': 1})
SBAR: 0.1654
NP: 0.6603
VP: 0.2146
PP: 0.4121
ADJP: 0.4730
ADVP: 0.5490
4.9762726724895785
-----------------------------------------------------------------------------------------
Dependency parsing performance:
Conll-U Style:
DDA: 0.388
UDA: 0.501
=========================================================================================
Loading dataset...
Loading dictionary...
Number of tokens:  10001
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer_in_parser', nhid=512, nlayers=8, front_layers=4, rear_layers=4, n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=5555, nonmono=5, cuda=True, log_interval=100, save='trained_models/structformer_in_parser_5555_44.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 38475605
Model architecture: StructFormer_In_Parser(
  (transformer_front): Transformer_Front(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(10001, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-3): 4 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
  (transformer_rear): Transformer_Rear(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(10001, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-3): 4 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (output_layer): Linear(in_features=512, out_features=10001, bias=True)
  )
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  216 batches | lr 0.00030 | ms/batch 79.96 | loss  7.28 | ppl  1444.01 
| epoch   1 |   200/  216 batches | lr 0.00030 | ms/batch 75.41 | loss  6.88 | ppl   972.50 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 17.21s | valid loss  6.72 | valid ppl   824.89 | valid bpc    9.688
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  216 batches | lr 0.00030 | ms/batch 76.62 | loss  6.81 | ppl   911.01 
| epoch   2 |   200/  216 batches | lr 0.00030 | ms/batch 75.67 | loss  6.61 | ppl   740.07 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 16.91s | valid loss  6.42 | valid ppl   614.12 | valid bpc    9.262
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  216 batches | lr 0.00030 | ms/batch 76.65 | loss  6.40 | ppl   601.66 
| epoch   3 |   200/  216 batches | lr 0.00030 | ms/batch 75.96 | loss  6.10 | ppl   447.07 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 16.95s | valid loss  5.87 | valid ppl   353.54 | valid bpc    8.466
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  216 batches | lr 0.00030 | ms/batch 77.50 | loss  5.91 | ppl   369.33 
| epoch   4 |   200/  216 batches | lr 0.00030 | ms/batch 75.52 | loss  5.71 | ppl   302.30 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 16.99s | valid loss  5.62 | valid ppl   275.62 | valid bpc    8.107
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  216 batches | lr 0.00030 | ms/batch 76.99 | loss  5.61 | ppl   273.25 
| epoch   5 |   200/  216 batches | lr 0.00030 | ms/batch 75.97 | loss  5.45 | ppl   232.30 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 16.99s | valid loss  5.38 | valid ppl   217.31 | valid bpc    7.764
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  216 batches | lr 0.00030 | ms/batch 77.08 | loss  5.40 | ppl   222.09 
| epoch   6 |   200/  216 batches | lr 0.00030 | ms/batch 75.90 | loss  5.26 | ppl   193.04 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 16.99s | valid loss  5.27 | valid ppl   194.22 | valid bpc    7.602
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  216 batches | lr 0.00030 | ms/batch 77.00 | loss  5.23 | ppl   187.22 
| epoch   7 |   200/  216 batches | lr 0.00030 | ms/batch 76.19 | loss  5.13 | ppl   169.51 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 17.01s | valid loss  5.11 | valid ppl   166.30 | valid bpc    7.378
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  216 batches | lr 0.00030 | ms/batch 77.21 | loss  5.08 | ppl   161.42 
| epoch   8 |   200/  216 batches | lr 0.00030 | ms/batch 75.85 | loss  5.00 | ppl   148.17 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 17.01s | valid loss  5.03 | valid ppl   152.51 | valid bpc    7.253
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 8.0%
| epoch   9 |   100/  216 batches | lr 0.00030 | ms/batch 77.01 | loss  4.99 | ppl   146.30 
| epoch   9 |   200/  216 batches | lr 0.00030 | ms/batch 76.16 | loss  4.90 | ppl   134.41 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 17.01s | valid loss  4.94 | valid ppl   139.61 | valid bpc    7.125
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  216 batches | lr 0.00030 | ms/batch 77.19 | loss  4.85 | ppl   128.04 
| epoch  10 |   200/  216 batches | lr 0.00030 | ms/batch 76.08 | loss  4.80 | ppl   121.26 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 17.02s | valid loss  4.89 | valid ppl   133.39 | valid bpc    7.059
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  216 batches | lr 0.00030 | ms/batch 77.18 | loss  4.75 | ppl   115.03 
| epoch  11 |   200/  216 batches | lr 0.00030 | ms/batch 76.02 | loss  4.68 | ppl   108.25 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 17.02s | valid loss  4.79 | valid ppl   120.45 | valid bpc    6.912
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  216 batches | lr 0.00030 | ms/batch 77.41 | loss  4.67 | ppl   106.94 
| epoch  12 |   200/  216 batches | lr 0.00030 | ms/batch 75.82 | loss  4.60 | ppl    99.04 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 17.02s | valid loss  4.70 | valid ppl   109.45 | valid bpc    6.774
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 12.0%
| epoch  13 |   100/  216 batches | lr 0.00030 | ms/batch 77.34 | loss  4.57 | ppl    96.63 
| epoch  13 |   200/  216 batches | lr 0.00030 | ms/batch 75.87 | loss  4.53 | ppl    92.70 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 17.02s | valid loss  4.66 | valid ppl   105.61 | valid bpc    6.723
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 13.0%
| epoch  14 |   100/  216 batches | lr 0.00030 | ms/batch 76.99 | loss  4.48 | ppl    88.50 
| epoch  14 |   200/  216 batches | lr 0.00030 | ms/batch 76.30 | loss  4.46 | ppl    86.13 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 17.02s | valid loss  4.63 | valid ppl   102.98 | valid bpc    6.686
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  216 batches | lr 0.00030 | ms/batch 77.45 | loss  4.40 | ppl    81.15 
| epoch  15 |   200/  216 batches | lr 0.00030 | ms/batch 76.09 | loss  4.39 | ppl    80.60 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 17.03s | valid loss  4.61 | valid ppl   100.33 | valid bpc    6.649
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 15.0%
| epoch  16 |   100/  216 batches | lr 0.00030 | ms/batch 77.10 | loss  4.36 | ppl    78.61 
| epoch  16 |   200/  216 batches | lr 0.00030 | ms/batch 76.12 | loss  4.27 | ppl    71.65 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 17.02s | valid loss  4.55 | valid ppl    94.38 | valid bpc    6.560
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 16.0%
| epoch  17 |   100/  216 batches | lr 0.00030 | ms/batch 77.05 | loss  4.29 | ppl    72.89 
| epoch  17 |   200/  216 batches | lr 0.00030 | ms/batch 76.20 | loss  4.23 | ppl    68.57 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 17.02s | valid loss  4.50 | valid ppl    90.16 | valid bpc    6.494
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 17.0%
| epoch  18 |   100/  216 batches | lr 0.00030 | ms/batch 76.93 | loss  4.21 | ppl    67.32 
| epoch  18 |   200/  216 batches | lr 0.00030 | ms/batch 76.20 | loss  4.18 | ppl    65.63 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 17.02s | valid loss  4.47 | valid ppl    87.21 | valid bpc    6.446
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 18.0%
| epoch  19 |   100/  216 batches | lr 0.00030 | ms/batch 77.01 | loss  4.15 | ppl    63.45 
| epoch  19 |   200/  216 batches | lr 0.00030 | ms/batch 76.26 | loss  4.11 | ppl    60.84 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 17.02s | valid loss  4.46 | valid ppl    86.69 | valid bpc    6.438
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 19.0%
| epoch  20 |   100/  216 batches | lr 0.00030 | ms/batch 77.01 | loss  4.09 | ppl    59.72 
| epoch  20 |   200/  216 batches | lr 0.00030 | ms/batch 76.19 | loss  4.07 | ppl    58.57 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 17.02s | valid loss  4.42 | valid ppl    83.06 | valid bpc    6.376
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 20.0%
| epoch  21 |   100/  216 batches | lr 0.00030 | ms/batch 77.07 | loss  4.02 | ppl    55.93 
| epoch  21 |   200/  216 batches | lr 0.00030 | ms/batch 76.11 | loss  4.02 | ppl    55.68 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 17.02s | valid loss  4.44 | valid ppl    84.46 | valid bpc    6.400
-----------------------------------------------------------------------------------------
PROGRESS: 21.0%
| epoch  22 |   100/  216 batches | lr 0.00030 | ms/batch 76.89 | loss  3.98 | ppl    53.74 
| epoch  22 |   200/  216 batches | lr 0.00030 | ms/batch 76.34 | loss  3.95 | ppl    51.89 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 17.02s | valid loss  4.43 | valid ppl    83.69 | valid bpc    6.387
-----------------------------------------------------------------------------------------
PROGRESS: 22.0%
| epoch  23 |   100/  216 batches | lr 0.00030 | ms/batch 77.00 | loss  3.90 | ppl    49.64 
| epoch  23 |   200/  216 batches | lr 0.00030 | ms/batch 75.88 | loss  3.92 | ppl    50.33 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 17.03s | valid loss  4.40 | valid ppl    81.27 | valid bpc    6.345
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 23.0%
| epoch  24 |   100/  216 batches | lr 0.00030 | ms/batch 77.31 | loss  3.88 | ppl    48.41 
| epoch  24 |   200/  216 batches | lr 0.00030 | ms/batch 75.92 | loss  3.86 | ppl    47.59 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 17.02s | valid loss  4.34 | valid ppl    77.02 | valid bpc    6.267
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 24.0%
| epoch  25 |   100/  216 batches | lr 0.00030 | ms/batch 77.14 | loss  3.82 | ppl    45.65 
| epoch  25 |   200/  216 batches | lr 0.00030 | ms/batch 76.09 | loss  3.80 | ppl    44.81 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 17.02s | valid loss  4.34 | valid ppl    76.85 | valid bpc    6.264
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 25.0%
| epoch  26 |   100/  216 batches | lr 0.00030 | ms/batch 77.25 | loss  3.78 | ppl    43.96 
| epoch  26 |   200/  216 batches | lr 0.00030 | ms/batch 75.97 | loss  3.77 | ppl    43.59 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 17.01s | valid loss  4.32 | valid ppl    75.36 | valid bpc    6.236
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 26.0%
| epoch  27 |   100/  216 batches | lr 0.00030 | ms/batch 77.40 | loss  3.75 | ppl    42.52 
| epoch  27 |   200/  216 batches | lr 0.00030 | ms/batch 75.96 | loss  3.72 | ppl    41.37 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 17.03s | valid loss  4.31 | valid ppl    74.42 | valid bpc    6.218
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 27.0%
| epoch  28 |   100/  216 batches | lr 0.00030 | ms/batch 76.81 | loss  3.70 | ppl    40.44 
| epoch  28 |   200/  216 batches | lr 0.00030 | ms/batch 76.36 | loss  3.68 | ppl    39.61 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 17.02s | valid loss  4.29 | valid ppl    72.99 | valid bpc    6.190
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  216 batches | lr 0.00030 | ms/batch 77.34 | loss  3.65 | ppl    38.63 
| epoch  29 |   200/  216 batches | lr 0.00030 | ms/batch 75.99 | loss  3.65 | ppl    38.33 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 17.02s | valid loss  4.28 | valid ppl    72.16 | valid bpc    6.173
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  216 batches | lr 0.00030 | ms/batch 77.14 | loss  3.63 | ppl    37.72 
| epoch  30 |   200/  216 batches | lr 0.00030 | ms/batch 76.18 | loss  3.58 | ppl    35.90 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 17.03s | valid loss  4.29 | valid ppl    72.63 | valid bpc    6.182
-----------------------------------------------------------------------------------------
PROGRESS: 30.0%
| epoch  31 |   100/  216 batches | lr 0.00030 | ms/batch 77.20 | loss  3.58 | ppl    35.74 
| epoch  31 |   200/  216 batches | lr 0.00030 | ms/batch 76.25 | loss  3.55 | ppl    34.85 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 17.04s | valid loss  4.28 | valid ppl    72.32 | valid bpc    6.176
-----------------------------------------------------------------------------------------
PROGRESS: 31.0%
| epoch  32 |   100/  216 batches | lr 0.00030 | ms/batch 77.25 | loss  3.55 | ppl    34.83 
| epoch  32 |   200/  216 batches | lr 0.00030 | ms/batch 76.10 | loss  3.51 | ppl    33.58 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 17.03s | valid loss  4.27 | valid ppl    71.56 | valid bpc    6.161
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 32.0%
| epoch  33 |   100/  216 batches | lr 0.00030 | ms/batch 77.18 | loss  3.51 | ppl    33.29 
| epoch  33 |   200/  216 batches | lr 0.00030 | ms/batch 76.18 | loss  3.48 | ppl    32.38 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 17.02s | valid loss  4.30 | valid ppl    73.33 | valid bpc    6.196
-----------------------------------------------------------------------------------------
PROGRESS: 33.0%
| epoch  34 |   100/  216 batches | lr 0.00030 | ms/batch 77.27 | loss  3.45 | ppl    31.50 
| epoch  34 |   200/  216 batches | lr 0.00030 | ms/batch 76.23 | loss  3.44 | ppl    31.11 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 17.05s | valid loss  4.25 | valid ppl    70.08 | valid bpc    6.131
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 34.0%
| epoch  35 |   100/  216 batches | lr 0.00030 | ms/batch 77.64 | loss  3.41 | ppl    30.30 
| epoch  35 |   200/  216 batches | lr 0.00030 | ms/batch 75.72 | loss  3.41 | ppl    30.36 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 17.03s | valid loss  4.27 | valid ppl    71.47 | valid bpc    6.159
-----------------------------------------------------------------------------------------
PROGRESS: 35.0%
| epoch  36 |   100/  216 batches | lr 0.00030 | ms/batch 77.56 | loss  3.39 | ppl    29.53 
| epoch  36 |   200/  216 batches | lr 0.00030 | ms/batch 75.94 | loss  3.36 | ppl    28.79 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 17.05s | valid loss  4.23 | valid ppl    69.04 | valid bpc    6.109
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 36.0%
| epoch  37 |   100/  216 batches | lr 0.00030 | ms/batch 77.39 | loss  3.34 | ppl    28.23 
| epoch  37 |   200/  216 batches | lr 0.00030 | ms/batch 76.15 | loss  3.36 | ppl    28.72 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 17.06s | valid loss  4.25 | valid ppl    70.16 | valid bpc    6.132
-----------------------------------------------------------------------------------------
PROGRESS: 37.0%
| epoch  38 |   100/  216 batches | lr 0.00030 | ms/batch 77.46 | loss  3.32 | ppl    27.62 
| epoch  38 |   200/  216 batches | lr 0.00030 | ms/batch 75.91 | loss  3.30 | ppl    27.09 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 17.03s | valid loss  4.22 | valid ppl    68.37 | valid bpc    6.095
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 38.0%
| epoch  39 |   100/  216 batches | lr 0.00030 | ms/batch 77.30 | loss  3.28 | ppl    26.54 
| epoch  39 |   200/  216 batches | lr 0.00030 | ms/batch 76.04 | loss  3.27 | ppl    26.20 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 17.03s | valid loss  4.27 | valid ppl    71.44 | valid bpc    6.159
-----------------------------------------------------------------------------------------
PROGRESS: 39.0%
| epoch  40 |   100/  216 batches | lr 0.00030 | ms/batch 77.28 | loss  3.25 | ppl    25.88 
| epoch  40 |   200/  216 batches | lr 0.00030 | ms/batch 76.23 | loss  3.23 | ppl    25.30 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 17.03s | valid loss  4.27 | valid ppl    71.32 | valid bpc    6.156
-----------------------------------------------------------------------------------------
PROGRESS: 40.0%
| epoch  41 |   100/  216 batches | lr 0.00030 | ms/batch 77.05 | loss  3.18 | ppl    24.14 
| epoch  41 |   200/  216 batches | lr 0.00030 | ms/batch 76.39 | loss  3.22 | ppl    24.92 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 17.03s | valid loss  4.28 | valid ppl    72.25 | valid bpc    6.175
-----------------------------------------------------------------------------------------
PROGRESS: 41.0%
| epoch  42 |   100/  216 batches | lr 0.00015 | ms/batch 77.10 | loss  3.11 | ppl    22.45 
| epoch  42 |   200/  216 batches | lr 0.00015 | ms/batch 76.04 | loss  3.08 | ppl    21.80 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 17.03s | valid loss  4.26 | valid ppl    70.55 | valid bpc    6.141
-----------------------------------------------------------------------------------------
PROGRESS: 42.0%
| epoch  43 |   100/  216 batches | lr 0.00015 | ms/batch 76.79 | loss  3.05 | ppl    21.03 
| epoch  43 |   200/  216 batches | lr 0.00015 | ms/batch 76.44 | loss  3.06 | ppl    21.30 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 17.03s | valid loss  4.22 | valid ppl    68.02 | valid bpc    6.088
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 43.0%
| epoch  44 |   100/  216 batches | lr 0.00015 | ms/batch 77.64 | loss  3.04 | ppl    20.86 
| epoch  44 |   200/  216 batches | lr 0.00015 | ms/batch 75.72 | loss  3.01 | ppl    20.24 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 17.02s | valid loss  4.22 | valid ppl    68.03 | valid bpc    6.088
-----------------------------------------------------------------------------------------
PROGRESS: 44.0%
| epoch  45 |   100/  216 batches | lr 0.00015 | ms/batch 77.39 | loss  3.00 | ppl    20.14 
| epoch  45 |   200/  216 batches | lr 0.00015 | ms/batch 76.02 | loss  3.00 | ppl    20.09 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 17.04s | valid loss  4.23 | valid ppl    69.03 | valid bpc    6.109
-----------------------------------------------------------------------------------------
PROGRESS: 45.0%
| epoch  46 |   100/  216 batches | lr 0.00015 | ms/batch 77.57 | loss  2.97 | ppl    19.47 
| epoch  46 |   200/  216 batches | lr 0.00015 | ms/batch 75.72 | loss  2.97 | ppl    19.45 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 17.03s | valid loss  4.25 | valid ppl    69.97 | valid bpc    6.129
-----------------------------------------------------------------------------------------
PROGRESS: 46.0%
| epoch  47 |   100/  216 batches | lr 0.00007 | ms/batch 77.37 | loss  2.92 | ppl    18.53 
| epoch  47 |   200/  216 batches | lr 0.00007 | ms/batch 75.94 | loss  2.93 | ppl    18.66 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 17.03s | valid loss  4.19 | valid ppl    66.34 | valid bpc    6.052
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 47.0%
| epoch  48 |   100/  216 batches | lr 0.00007 | ms/batch 77.51 | loss  2.90 | ppl    18.20 
| epoch  48 |   200/  216 batches | lr 0.00007 | ms/batch 75.74 | loss  2.88 | ppl    17.78 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 17.03s | valid loss  4.22 | valid ppl    68.26 | valid bpc    6.093
-----------------------------------------------------------------------------------------
PROGRESS: 48.0%
| epoch  49 |   100/  216 batches | lr 0.00007 | ms/batch 77.49 | loss  2.87 | ppl    17.63 
| epoch  49 |   200/  216 batches | lr 0.00007 | ms/batch 75.70 | loss  2.86 | ppl    17.39 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 17.02s | valid loss  4.24 | valid ppl    69.56 | valid bpc    6.120
-----------------------------------------------------------------------------------------
PROGRESS: 49.0%
| epoch  50 |   100/  216 batches | lr 0.00007 | ms/batch 77.18 | loss  2.87 | ppl    17.62 
| epoch  50 |   200/  216 batches | lr 0.00007 | ms/batch 75.73 | loss  2.84 | ppl    17.07 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 17.02s | valid loss  4.23 | valid ppl    68.60 | valid bpc    6.100
-----------------------------------------------------------------------------------------
PROGRESS: 50.0%
| epoch  51 |   100/  216 batches | lr 0.00004 | ms/batch 77.45 | loss  2.84 | ppl    17.14 
| epoch  51 |   200/  216 batches | lr 0.00004 | ms/batch 75.78 | loss  2.81 | ppl    16.57 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 17.02s | valid loss  4.25 | valid ppl    70.10 | valid bpc    6.131
-----------------------------------------------------------------------------------------
PROGRESS: 51.0%
| epoch  52 |   100/  216 batches | lr 0.00004 | ms/batch 77.15 | loss  2.82 | ppl    16.80 
| epoch  52 |   200/  216 batches | lr 0.00004 | ms/batch 75.67 | loss  2.78 | ppl    16.19 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 17.02s | valid loss  4.19 | valid ppl    66.14 | valid bpc    6.048
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 52.0%
| epoch  53 |   100/  216 batches | lr 0.00004 | ms/batch 77.42 | loss  2.81 | ppl    16.59 
| epoch  53 |   200/  216 batches | lr 0.00004 | ms/batch 75.82 | loss  2.78 | ppl    16.10 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 17.02s | valid loss  4.21 | valid ppl    67.64 | valid bpc    6.080
-----------------------------------------------------------------------------------------
PROGRESS: 53.0%
| epoch  54 |   100/  216 batches | lr 0.00004 | ms/batch 76.92 | loss  2.80 | ppl    16.38 
| epoch  54 |   200/  216 batches | lr 0.00004 | ms/batch 76.42 | loss  2.78 | ppl    16.06 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 17.03s | valid loss  4.19 | valid ppl    66.19 | valid bpc    6.048
-----------------------------------------------------------------------------------------
PROGRESS: 54.0%
| epoch  55 |   100/  216 batches | lr 0.00004 | ms/batch 77.47 | loss  2.81 | ppl    16.59 
| epoch  55 |   200/  216 batches | lr 0.00004 | ms/batch 75.88 | loss  2.76 | ppl    15.86 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 17.04s | valid loss  4.23 | valid ppl    68.57 | valid bpc    6.100
-----------------------------------------------------------------------------------------
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  216 batches | lr 0.00002 | ms/batch 77.19 | loss  2.78 | ppl    16.19 
| epoch  56 |   200/  216 batches | lr 0.00002 | ms/batch 76.20 | loss  2.75 | ppl    15.61 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 17.03s | valid loss  4.23 | valid ppl    68.85 | valid bpc    6.105
-----------------------------------------------------------------------------------------
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  216 batches | lr 0.00002 | ms/batch 77.54 | loss  2.77 | ppl    15.96 
| epoch  57 |   200/  216 batches | lr 0.00002 | ms/batch 75.84 | loss  2.76 | ppl    15.76 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 17.03s | valid loss  4.20 | valid ppl    66.87 | valid bpc    6.063
-----------------------------------------------------------------------------------------
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  216 batches | lr 0.00002 | ms/batch 77.26 | loss  2.75 | ppl    15.70 
| epoch  58 |   200/  216 batches | lr 0.00002 | ms/batch 76.19 | loss  2.74 | ppl    15.46 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 17.03s | valid loss  4.21 | valid ppl    67.33 | valid bpc    6.073
-----------------------------------------------------------------------------------------
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  216 batches | lr 0.00001 | ms/batch 77.05 | loss  2.75 | ppl    15.60 
| epoch  59 |   200/  216 batches | lr 0.00001 | ms/batch 76.30 | loss  2.70 | ppl    14.94 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 17.03s | valid loss  4.21 | valid ppl    67.46 | valid bpc    6.076
-----------------------------------------------------------------------------------------
PROGRESS: 59.0%
| epoch  60 |   100/  216 batches | lr 0.00001 | ms/batch 77.25 | loss  2.75 | ppl    15.68 
| epoch  60 |   200/  216 batches | lr 0.00001 | ms/batch 76.27 | loss  2.73 | ppl    15.32 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 17.05s | valid loss  4.20 | valid ppl    66.74 | valid bpc    6.060
-----------------------------------------------------------------------------------------
PROGRESS: 60.0%
| epoch  61 |   100/  216 batches | lr 0.00001 | ms/batch 77.61 | loss  2.76 | ppl    15.82 
| epoch  61 |   200/  216 batches | lr 0.00001 | ms/batch 75.71 | loss  2.70 | ppl    14.91 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 17.03s | valid loss  4.23 | valid ppl    68.42 | valid bpc    6.096
-----------------------------------------------------------------------------------------
PROGRESS: 61.0%
| epoch  62 |   100/  216 batches | lr 0.00000 | ms/batch 77.66 | loss  2.76 | ppl    15.88 
| epoch  62 |   200/  216 batches | lr 0.00000 | ms/batch 75.68 | loss  2.70 | ppl    14.95 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 17.03s | valid loss  4.21 | valid ppl    67.41 | valid bpc    6.075
-----------------------------------------------------------------------------------------
PROGRESS: 62.0%
| epoch  63 |   100/  216 batches | lr 0.00000 | ms/batch 77.28 | loss  2.75 | ppl    15.69 
| epoch  63 |   200/  216 batches | lr 0.00000 | ms/batch 76.01 | loss  2.71 | ppl    15.01 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 17.02s | valid loss  4.22 | valid ppl    68.03 | valid bpc    6.088
-----------------------------------------------------------------------------------------
PROGRESS: 63.0%
| epoch  64 |   100/  216 batches | lr 0.00000 | ms/batch 77.40 | loss  2.74 | ppl    15.51 
| epoch  64 |   200/  216 batches | lr 0.00000 | ms/batch 75.93 | loss  2.73 | ppl    15.31 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 17.03s | valid loss  4.22 | valid ppl    68.29 | valid bpc    6.093
-----------------------------------------------------------------------------------------
PROGRESS: 64.0%
| epoch  65 |   100/  216 batches | lr 0.00000 | ms/batch 76.90 | loss  2.71 | ppl    15.10 
| epoch  65 |   200/  216 batches | lr 0.00000 | ms/batch 76.37 | loss  2.71 | ppl    15.10 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 17.02s | valid loss  4.20 | valid ppl    66.75 | valid bpc    6.061
-----------------------------------------------------------------------------------------
PROGRESS: 65.0%
| epoch  66 |   100/  216 batches | lr 0.00000 | ms/batch 77.43 | loss  2.73 | ppl    15.32 
| epoch  66 |   200/  216 batches | lr 0.00000 | ms/batch 75.75 | loss  2.72 | ppl    15.21 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 17.02s | valid loss  4.21 | valid ppl    67.64 | valid bpc    6.080
-----------------------------------------------------------------------------------------
PROGRESS: 66.0%
| epoch  67 |   100/  216 batches | lr 0.00000 | ms/batch 76.94 | loss  2.73 | ppl    15.34 
| epoch  67 |   200/  216 batches | lr 0.00000 | ms/batch 76.34 | loss  2.70 | ppl    14.82 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 17.03s | valid loss  4.22 | valid ppl    67.74 | valid bpc    6.082
-----------------------------------------------------------------------------------------
PROGRESS: 67.0%
| epoch  68 |   100/  216 batches | lr 0.00000 | ms/batch 77.13 | loss  2.75 | ppl    15.60 
| epoch  68 |   200/  216 batches | lr 0.00000 | ms/batch 76.16 | loss  2.70 | ppl    14.84 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 17.03s | valid loss  4.22 | valid ppl    68.22 | valid bpc    6.092
-----------------------------------------------------------------------------------------
PROGRESS: 68.0%
| epoch  69 |   100/  216 batches | lr 0.00000 | ms/batch 77.69 | loss  2.73 | ppl    15.39 
| epoch  69 |   200/  216 batches | lr 0.00000 | ms/batch 75.64 | loss  2.72 | ppl    15.21 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 17.03s | valid loss  4.21 | valid ppl    67.25 | valid bpc    6.072
-----------------------------------------------------------------------------------------
PROGRESS: 69.0%
| epoch  70 |   100/  216 batches | lr 0.00000 | ms/batch 77.46 | loss  2.76 | ppl    15.75 
| epoch  70 |   200/  216 batches | lr 0.00000 | ms/batch 75.93 | loss  2.71 | ppl    15.02 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 17.03s | valid loss  4.20 | valid ppl    66.99 | valid bpc    6.066
-----------------------------------------------------------------------------------------
PROGRESS: 70.0%
| epoch  71 |   100/  216 batches | lr 0.00000 | ms/batch 77.32 | loss  2.73 | ppl    15.40 
| epoch  71 |   200/  216 batches | lr 0.00000 | ms/batch 75.98 | loss  2.72 | ppl    15.21 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 17.03s | valid loss  4.23 | valid ppl    68.73 | valid bpc    6.103
-----------------------------------------------------------------------------------------
PROGRESS: 71.0%
| epoch  72 |   100/  216 batches | lr 0.00000 | ms/batch 77.53 | loss  2.74 | ppl    15.51 
| epoch  72 |   200/  216 batches | lr 0.00000 | ms/batch 75.95 | loss  2.70 | ppl    14.81 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 17.04s | valid loss  4.23 | valid ppl    68.85 | valid bpc    6.105
-----------------------------------------------------------------------------------------
PROGRESS: 72.0%
| epoch  73 |   100/  216 batches | lr 0.00000 | ms/batch 77.24 | loss  2.74 | ppl    15.43 
| epoch  73 |   200/  216 batches | lr 0.00000 | ms/batch 75.92 | loss  2.70 | ppl    14.94 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 17.02s | valid loss  4.22 | valid ppl    68.09 | valid bpc    6.089
-----------------------------------------------------------------------------------------
PROGRESS: 73.0%
| epoch  74 |   100/  216 batches | lr 0.00000 | ms/batch 76.80 | loss  2.77 | ppl    15.90 
| epoch  74 |   200/  216 batches | lr 0.00000 | ms/batch 76.48 | loss  2.69 | ppl    14.70 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 17.03s | valid loss  4.24 | valid ppl    69.62 | valid bpc    6.121
-----------------------------------------------------------------------------------------
PROGRESS: 74.0%
| epoch  75 |   100/  216 batches | lr 0.00000 | ms/batch 76.93 | loss  2.72 | ppl    15.25 
| epoch  75 |   200/  216 batches | lr 0.00000 | ms/batch 76.16 | loss  2.71 | ppl    14.97 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 17.03s | valid loss  4.23 | valid ppl    68.63 | valid bpc    6.101
-----------------------------------------------------------------------------------------
PROGRESS: 75.0%
| epoch  76 |   100/  216 batches | lr 0.00000 | ms/batch 77.38 | loss  2.75 | ppl    15.63 
| epoch  76 |   200/  216 batches | lr 0.00000 | ms/batch 76.07 | loss  2.71 | ppl    15.09 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 17.04s | valid loss  4.20 | valid ppl    66.52 | valid bpc    6.056
-----------------------------------------------------------------------------------------
PROGRESS: 76.0%
| epoch  77 |   100/  216 batches | lr 0.00000 | ms/batch 77.53 | loss  2.76 | ppl    15.87 
| epoch  77 |   200/  216 batches | lr 0.00000 | ms/batch 75.89 | loss  2.71 | ppl    15.09 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 17.03s | valid loss  4.21 | valid ppl    67.08 | valid bpc    6.068
-----------------------------------------------------------------------------------------
PROGRESS: 77.0%
| epoch  78 |   100/  216 batches | lr 0.00000 | ms/batch 77.51 | loss  2.72 | ppl    15.24 
| epoch  78 |   200/  216 batches | lr 0.00000 | ms/batch 75.76 | loss  2.72 | ppl    15.14 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 17.03s | valid loss  4.23 | valid ppl    68.62 | valid bpc    6.101
-----------------------------------------------------------------------------------------
PROGRESS: 78.0%
| epoch  79 |   100/  216 batches | lr 0.00000 | ms/batch 76.96 | loss  2.73 | ppl    15.39 
| epoch  79 |   200/  216 batches | lr 0.00000 | ms/batch 76.36 | loss  2.71 | ppl    15.04 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 17.03s | valid loss  4.20 | valid ppl    66.55 | valid bpc    6.056
-----------------------------------------------------------------------------------------
PROGRESS: 79.0%
| epoch  80 |   100/  216 batches | lr 0.00000 | ms/batch 76.82 | loss  2.72 | ppl    15.17 
| epoch  80 |   200/  216 batches | lr 0.00000 | ms/batch 76.25 | loss  2.70 | ppl    14.92 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 17.02s | valid loss  4.23 | valid ppl    68.68 | valid bpc    6.102
-----------------------------------------------------------------------------------------
PROGRESS: 80.0%
| epoch  81 |   100/  216 batches | lr 0.00000 | ms/batch 77.24 | loss  2.74 | ppl    15.54 
| epoch  81 |   200/  216 batches | lr 0.00000 | ms/batch 76.03 | loss  2.71 | ppl    15.04 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 17.03s | valid loss  4.21 | valid ppl    67.27 | valid bpc    6.072
-----------------------------------------------------------------------------------------
PROGRESS: 81.0%
| epoch  82 |   100/  216 batches | lr 0.00000 | ms/batch 77.09 | loss  2.75 | ppl    15.62 
| epoch  82 |   200/  216 batches | lr 0.00000 | ms/batch 76.30 | loss  2.72 | ppl    15.19 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 17.04s | valid loss  4.23 | valid ppl    68.99 | valid bpc    6.108
-----------------------------------------------------------------------------------------
PROGRESS: 82.0%
| epoch  83 |   100/  216 batches | lr 0.00000 | ms/batch 77.28 | loss  2.75 | ppl    15.66 
| epoch  83 |   200/  216 batches | lr 0.00000 | ms/batch 75.97 | loss  2.68 | ppl    14.62 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 17.02s | valid loss  4.26 | valid ppl    70.56 | valid bpc    6.141
-----------------------------------------------------------------------------------------
PROGRESS: 83.0%
| epoch  84 |   100/  216 batches | lr 0.00000 | ms/batch 77.62 | loss  2.72 | ppl    15.19 
| epoch  84 |   200/  216 batches | lr 0.00000 | ms/batch 75.77 | loss  2.69 | ppl    14.77 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 17.03s | valid loss  4.21 | valid ppl    67.29 | valid bpc    6.072
-----------------------------------------------------------------------------------------
PROGRESS: 84.0%
| epoch  85 |   100/  216 batches | lr 0.00000 | ms/batch 77.20 | loss  2.75 | ppl    15.67 
| epoch  85 |   200/  216 batches | lr 0.00000 | ms/batch 76.15 | loss  2.70 | ppl    14.85 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 17.03s | valid loss  4.20 | valid ppl    66.40 | valid bpc    6.053
-----------------------------------------------------------------------------------------
PROGRESS: 85.0%
| epoch  86 |   100/  216 batches | lr 0.00000 | ms/batch 77.48 | loss  2.72 | ppl    15.24 
| epoch  86 |   200/  216 batches | lr 0.00000 | ms/batch 75.86 | loss  2.70 | ppl    14.92 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 17.04s | valid loss  4.22 | valid ppl    68.26 | valid bpc    6.093
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  216 batches | lr 0.00000 | ms/batch 77.46 | loss  2.73 | ppl    15.32 
| epoch  87 |   200/  216 batches | lr 0.00000 | ms/batch 75.93 | loss  2.72 | ppl    15.12 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 17.03s | valid loss  4.19 | valid ppl    65.99 | valid bpc    6.044
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 87.0%
| epoch  88 |   100/  216 batches | lr 0.00000 | ms/batch 77.45 | loss  2.74 | ppl    15.48 
| epoch  88 |   200/  216 batches | lr 0.00000 | ms/batch 75.74 | loss  2.70 | ppl    14.89 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 17.02s | valid loss  4.19 | valid ppl    65.84 | valid bpc    6.041
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 88.0%
| epoch  89 |   100/  216 batches | lr 0.00000 | ms/batch 77.31 | loss  2.74 | ppl    15.42 
| epoch  89 |   200/  216 batches | lr 0.00000 | ms/batch 75.91 | loss  2.71 | ppl    15.00 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 17.02s | valid loss  4.19 | valid ppl    66.24 | valid bpc    6.050
-----------------------------------------------------------------------------------------
PROGRESS: 89.0%
| epoch  90 |   100/  216 batches | lr 0.00000 | ms/batch 77.34 | loss  2.75 | ppl    15.70 
| epoch  90 |   200/  216 batches | lr 0.00000 | ms/batch 76.10 | loss  2.71 | ppl    15.08 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 17.03s | valid loss  4.22 | valid ppl    68.29 | valid bpc    6.093
-----------------------------------------------------------------------------------------
PROGRESS: 90.0%
| epoch  91 |   100/  216 batches | lr 0.00000 | ms/batch 76.96 | loss  2.75 | ppl    15.57 
| epoch  91 |   200/  216 batches | lr 0.00000 | ms/batch 76.34 | loss  2.70 | ppl    14.95 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 17.02s | valid loss  4.23 | valid ppl    69.01 | valid bpc    6.109
-----------------------------------------------------------------------------------------
PROGRESS: 91.0%
| epoch  92 |   100/  216 batches | lr 0.00000 | ms/batch 77.06 | loss  2.75 | ppl    15.62 
| epoch  92 |   200/  216 batches | lr 0.00000 | ms/batch 76.19 | loss  2.71 | ppl    15.05 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 17.02s | valid loss  4.20 | valid ppl    66.45 | valid bpc    6.054
-----------------------------------------------------------------------------------------
PROGRESS: 92.0%
| epoch  93 |   100/  216 batches | lr 0.00000 | ms/batch 77.42 | loss  2.75 | ppl    15.63 
| epoch  93 |   200/  216 batches | lr 0.00000 | ms/batch 75.86 | loss  2.70 | ppl    14.95 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 17.02s | valid loss  4.23 | valid ppl    68.72 | valid bpc    6.103
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  216 batches | lr 0.00000 | ms/batch 76.75 | loss  2.74 | ppl    15.45 
| epoch  94 |   200/  216 batches | lr 0.00000 | ms/batch 76.60 | loss  2.69 | ppl    14.80 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 17.03s | valid loss  4.21 | valid ppl    67.08 | valid bpc    6.068
-----------------------------------------------------------------------------------------
PROGRESS: 94.0%
| epoch  95 |   100/  216 batches | lr 0.00000 | ms/batch 76.91 | loss  2.73 | ppl    15.26 
| epoch  95 |   200/  216 batches | lr 0.00000 | ms/batch 76.49 | loss  2.71 | ppl    15.01 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 17.04s | valid loss  4.22 | valid ppl    67.94 | valid bpc    6.086
-----------------------------------------------------------------------------------------
PROGRESS: 95.0%
| epoch  96 |   100/  216 batches | lr 0.00000 | ms/batch 77.32 | loss  2.73 | ppl    15.41 
| epoch  96 |   200/  216 batches | lr 0.00000 | ms/batch 76.01 | loss  2.70 | ppl    14.95 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 17.03s | valid loss  4.25 | valid ppl    70.02 | valid bpc    6.130
-----------------------------------------------------------------------------------------
PROGRESS: 96.0%
| epoch  97 |   100/  216 batches | lr 0.00000 | ms/batch 77.44 | loss  2.73 | ppl    15.34 
| epoch  97 |   200/  216 batches | lr 0.00000 | ms/batch 75.89 | loss  2.74 | ppl    15.46 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 17.04s | valid loss  4.23 | valid ppl    68.79 | valid bpc    6.104
-----------------------------------------------------------------------------------------
PROGRESS: 97.0%
| epoch  98 |   100/  216 batches | lr 0.00000 | ms/batch 77.11 | loss  2.72 | ppl    15.12 
| epoch  98 |   200/  216 batches | lr 0.00000 | ms/batch 76.29 | loss  2.73 | ppl    15.35 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 17.03s | valid loss  4.25 | valid ppl    70.27 | valid bpc    6.135
-----------------------------------------------------------------------------------------
PROGRESS: 98.0%
| epoch  99 |   100/  216 batches | lr 0.00000 | ms/batch 77.26 | loss  2.72 | ppl    15.22 
| epoch  99 |   200/  216 batches | lr 0.00000 | ms/batch 76.10 | loss  2.71 | ppl    15.02 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 17.04s | valid loss  4.20 | valid ppl    66.75 | valid bpc    6.061
-----------------------------------------------------------------------------------------
PROGRESS: 99.0%
| epoch 100 |   100/  216 batches | lr 0.00000 | ms/batch 77.23 | loss  2.75 | ppl    15.63 
| epoch 100 |   200/  216 batches | lr 0.00000 | ms/batch 75.77 | loss  2.69 | ppl    14.66 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 17.03s | valid loss  4.21 | valid ppl    67.55 | valid bpc    6.078
-----------------------------------------------------------------------------------------
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  4.18 | test ppl    65.49 | test bpc    6.033
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.4764, Mean Reca: 0.6547, Mean F1: 0.5431
Counter({'NP': 9555, 'PP': 4376, 'S': 4003, 'VP': 3793, 'SBAR': 1129, 'QP': 243, 'ADJP': 230, 'ADVP': 165, 'SINV': 151, 'PRN': 74, 'NX': 38, 'FRAG': 33, 'WHNP': 27, 'NAC': 15, 'SQ': 15, 'SBARQ': 8, 'WHPP': 7, 'UCP': 5, 'CONJP': 4, 'X': 3})
Counter({'NP': 14432, 'VP': 8130, 'S': 5620, 'PP': 5484, 'SBAR': 1796, 'ADJP': 649, 'QP': 490, 'ADVP': 286, 'SINV': 157, 'PRN': 128, 'NX': 95, 'FRAG': 42, 'WHNP': 37, 'UCP': 32, 'NAC': 30, 'WHPP': 25, 'CONJP': 21, 'SQ': 18, 'SBARQ': 10, 'WHADVP': 9, 'X': 6, 'WHADJP': 4, 'INTJ': 1})
SBAR: 0.6286
NP: 0.6621
VP: 0.4665
PP: 0.7980
ADJP: 0.3544
ADVP: 0.5769
5.090251467966666
-----------------------------------------------------------------------------------------
Dependency parsing performance:
Conll-U Style:
DDA: 0.065
UDA: 0.314
=========================================================================================
Loading dataset...
Loading dictionary...
Number of tokens:  10001
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer_in_parser', nhid=512, nlayers=8, front_layers=5, rear_layers=3, n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=1111, nonmono=5, cuda=True, log_interval=100, save='trained_models/structformer_in_parser_1111_53.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 38475589
Model architecture: StructFormer_In_Parser(
  (transformer_front): Transformer_Front(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(10001, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-4): 5 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
  (transformer_rear): Transformer_Rear(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(10001, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-2): 3 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (output_layer): Linear(in_features=512, out_features=10001, bias=True)
  )
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  216 batches | lr 0.00030 | ms/batch 79.69 | loss  7.31 | ppl  1488.19 
| epoch   1 |   200/  216 batches | lr 0.00030 | ms/batch 74.57 | loss  6.87 | ppl   960.29 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 17.11s | valid loss  6.75 | valid ppl   853.06 | valid bpc    9.737
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  216 batches | lr 0.00030 | ms/batch 76.13 | loss  6.85 | ppl   948.16 
| epoch   2 |   200/  216 batches | lr 0.00030 | ms/batch 75.48 | loss  6.70 | ppl   810.79 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 16.83s | valid loss  6.50 | valid ppl   663.01 | valid bpc    9.373
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  216 batches | lr 0.00030 | ms/batch 76.96 | loss  6.53 | ppl   682.19 
| epoch   3 |   200/  216 batches | lr 0.00030 | ms/batch 74.93 | loss  6.20 | ppl   491.95 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 16.86s | valid loss  6.01 | valid ppl   407.05 | valid bpc    8.669
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  216 batches | lr 0.00030 | ms/batch 76.60 | loss  5.99 | ppl   398.27 
| epoch   4 |   200/  216 batches | lr 0.00030 | ms/batch 75.62 | loss  5.79 | ppl   327.19 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 16.90s | valid loss  5.65 | valid ppl   284.66 | valid bpc    8.153
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  216 batches | lr 0.00030 | ms/batch 76.79 | loss  5.65 | ppl   285.61 
| epoch   5 |   200/  216 batches | lr 0.00030 | ms/batch 75.79 | loss  5.51 | ppl   247.08 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 16.94s | valid loss  5.41 | valid ppl   222.70 | valid bpc    7.799
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  216 batches | lr 0.00030 | ms/batch 76.52 | loss  5.40 | ppl   221.60 
| epoch   6 |   200/  216 batches | lr 0.00030 | ms/batch 76.02 | loss  5.33 | ppl   207.02 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 16.94s | valid loss  5.28 | valid ppl   196.54 | valid bpc    7.619
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  216 batches | lr 0.00030 | ms/batch 76.70 | loss  5.25 | ppl   190.25 
| epoch   7 |   200/  216 batches | lr 0.00030 | ms/batch 75.84 | loss  5.17 | ppl   176.06 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 16.94s | valid loss  5.15 | valid ppl   172.90 | valid bpc    7.434
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  216 batches | lr 0.00030 | ms/batch 76.44 | loss  5.11 | ppl   165.99 
| epoch   8 |   200/  216 batches | lr 0.00030 | ms/batch 75.47 | loss  5.02 | ppl   151.31 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 16.92s | valid loss  5.05 | valid ppl   155.87 | valid bpc    7.284
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 8.0%
| epoch   9 |   100/  216 batches | lr 0.00030 | ms/batch 76.54 | loss  5.00 | ppl   148.49 
| epoch   9 |   200/  216 batches | lr 0.00030 | ms/batch 76.05 | loss  4.91 | ppl   135.85 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 16.94s | valid loss  4.96 | valid ppl   143.02 | valid bpc    7.160
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  216 batches | lr 0.00030 | ms/batch 76.67 | loss  4.88 | ppl   132.15 
| epoch  10 |   200/  216 batches | lr 0.00030 | ms/batch 75.81 | loss  4.82 | ppl   124.30 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 16.94s | valid loss  4.86 | valid ppl   128.48 | valid bpc    7.005
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  216 batches | lr 0.00030 | ms/batch 76.73 | loss  4.76 | ppl   117.20 
| epoch  11 |   200/  216 batches | lr 0.00030 | ms/batch 75.95 | loss  4.73 | ppl   113.18 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 16.96s | valid loss  4.79 | valid ppl   120.34 | valid bpc    6.911
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  216 batches | lr 0.00030 | ms/batch 76.85 | loss  4.70 | ppl   110.44 
| epoch  12 |   200/  216 batches | lr 0.00030 | ms/batch 75.76 | loss  4.62 | ppl   101.26 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 16.95s | valid loss  4.74 | valid ppl   114.43 | valid bpc    6.838
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 12.0%
| epoch  13 |   100/  216 batches | lr 0.00030 | ms/batch 77.06 | loss  4.61 | ppl   100.93 
| epoch  13 |   200/  216 batches | lr 0.00030 | ms/batch 75.55 | loss  4.54 | ppl    93.59 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 16.94s | valid loss  4.69 | valid ppl   108.92 | valid bpc    6.767
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 13.0%
| epoch  14 |   100/  216 batches | lr 0.00030 | ms/batch 76.45 | loss  4.53 | ppl    93.17 
| epoch  14 |   200/  216 batches | lr 0.00030 | ms/batch 75.83 | loss  4.47 | ppl    87.70 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 16.95s | valid loss  4.61 | valid ppl   100.60 | valid bpc    6.652
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  216 batches | lr 0.00030 | ms/batch 76.79 | loss  4.44 | ppl    84.38 
| epoch  15 |   200/  216 batches | lr 0.00030 | ms/batch 75.59 | loss  4.40 | ppl    81.06 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 16.95s | valid loss  4.57 | valid ppl    96.32 | valid bpc    6.590
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 15.0%
| epoch  16 |   100/  216 batches | lr 0.00030 | ms/batch 76.88 | loss  4.38 | ppl    79.78 
| epoch  16 |   200/  216 batches | lr 0.00030 | ms/batch 75.74 | loss  4.34 | ppl    76.87 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 16.94s | valid loss  4.56 | valid ppl    95.15 | valid bpc    6.572
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 16.0%
| epoch  17 |   100/  216 batches | lr 0.00030 | ms/batch 76.95 | loss  4.33 | ppl    75.72 
| epoch  17 |   200/  216 batches | lr 0.00030 | ms/batch 75.56 | loss  4.27 | ppl    71.19 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 16.94s | valid loss  4.54 | valid ppl    93.82 | valid bpc    6.552
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 17.0%
| epoch  18 |   100/  216 batches | lr 0.00030 | ms/batch 76.83 | loss  4.24 | ppl    69.41 
| epoch  18 |   200/  216 batches | lr 0.00030 | ms/batch 75.61 | loss  4.20 | ppl    66.55 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 16.93s | valid loss  4.50 | valid ppl    89.75 | valid bpc    6.488
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 18.0%
| epoch  19 |   100/  216 batches | lr 0.00030 | ms/batch 76.47 | loss  4.18 | ppl    65.59 
| epoch  19 |   200/  216 batches | lr 0.00030 | ms/batch 75.95 | loss  4.17 | ppl    64.77 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 16.93s | valid loss  4.46 | valid ppl    86.56 | valid bpc    6.436
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 19.0%
| epoch  20 |   100/  216 batches | lr 0.00030 | ms/batch 76.92 | loss  4.12 | ppl    61.82 
| epoch  20 |   200/  216 batches | lr 0.00030 | ms/batch 75.60 | loss  4.11 | ppl    60.85 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 16.94s | valid loss  4.49 | valid ppl    88.70 | valid bpc    6.471
-----------------------------------------------------------------------------------------
PROGRESS: 20.0%
| epoch  21 |   100/  216 batches | lr 0.00030 | ms/batch 76.61 | loss  4.08 | ppl    58.94 
| epoch  21 |   200/  216 batches | lr 0.00030 | ms/batch 76.02 | loss  4.05 | ppl    57.52 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 16.95s | valid loss  4.44 | valid ppl    85.03 | valid bpc    6.410
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 21.0%
| epoch  22 |   100/  216 batches | lr 0.00030 | ms/batch 76.73 | loss  4.03 | ppl    56.17 
| epoch  22 |   200/  216 batches | lr 0.00030 | ms/batch 75.93 | loss  4.00 | ppl    54.54 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 16.96s | valid loss  4.39 | valid ppl    80.74 | valid bpc    6.335
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 22.0%
| epoch  23 |   100/  216 batches | lr 0.00030 | ms/batch 76.78 | loss  3.98 | ppl    53.60 
| epoch  23 |   200/  216 batches | lr 0.00030 | ms/batch 75.61 | loss  3.95 | ppl    52.17 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 16.93s | valid loss  4.36 | valid ppl    78.64 | valid bpc    6.297
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 23.0%
| epoch  24 |   100/  216 batches | lr 0.00030 | ms/batch 76.95 | loss  3.91 | ppl    50.06 
| epoch  24 |   200/  216 batches | lr 0.00030 | ms/batch 75.67 | loss  3.92 | ppl    50.29 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 16.95s | valid loss  4.35 | valid ppl    77.22 | valid bpc    6.271
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 24.0%
| epoch  25 |   100/  216 batches | lr 0.00030 | ms/batch 76.98 | loss  3.91 | ppl    49.70 
| epoch  25 |   200/  216 batches | lr 0.00030 | ms/batch 75.62 | loss  3.84 | ppl    46.66 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 16.95s | valid loss  4.36 | valid ppl    78.38 | valid bpc    6.292
-----------------------------------------------------------------------------------------
PROGRESS: 25.0%
| epoch  26 |   100/  216 batches | lr 0.00030 | ms/batch 77.06 | loss  3.85 | ppl    47.09 
| epoch  26 |   200/  216 batches | lr 0.00030 | ms/batch 75.45 | loss  3.81 | ppl    45.12 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 16.94s | valid loss  4.33 | valid ppl    75.66 | valid bpc    6.241
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 26.0%
| epoch  27 |   100/  216 batches | lr 0.00030 | ms/batch 77.25 | loss  3.79 | ppl    44.36 
| epoch  27 |   200/  216 batches | lr 0.00030 | ms/batch 75.19 | loss  3.77 | ppl    43.26 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 16.93s | valid loss  4.35 | valid ppl    77.14 | valid bpc    6.269
-----------------------------------------------------------------------------------------
PROGRESS: 27.0%
| epoch  28 |   100/  216 batches | lr 0.00030 | ms/batch 76.85 | loss  3.75 | ppl    42.41 
| epoch  28 |   200/  216 batches | lr 0.00030 | ms/batch 75.69 | loss  3.71 | ppl    40.72 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 16.94s | valid loss  4.32 | valid ppl    75.21 | valid bpc    6.233
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  216 batches | lr 0.00030 | ms/batch 76.67 | loss  3.68 | ppl    39.71 
| epoch  29 |   200/  216 batches | lr 0.00030 | ms/batch 75.75 | loss  3.72 | ppl    41.08 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 16.94s | valid loss  4.32 | valid ppl    74.83 | valid bpc    6.225
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  216 batches | lr 0.00030 | ms/batch 76.77 | loss  3.65 | ppl    38.63 
| epoch  30 |   200/  216 batches | lr 0.00030 | ms/batch 75.80 | loss  3.66 | ppl    38.72 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 16.95s | valid loss  4.29 | valid ppl    72.95 | valid bpc    6.189
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 30.0%
| epoch  31 |   100/  216 batches | lr 0.00030 | ms/batch 76.95 | loss  3.63 | ppl    37.64 
| epoch  31 |   200/  216 batches | lr 0.00030 | ms/batch 75.72 | loss  3.61 | ppl    36.84 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 16.95s | valid loss  4.30 | valid ppl    73.46 | valid bpc    6.199
-----------------------------------------------------------------------------------------
PROGRESS: 31.0%
| epoch  32 |   100/  216 batches | lr 0.00030 | ms/batch 77.23 | loss  3.59 | ppl    36.18 
| epoch  32 |   200/  216 batches | lr 0.00030 | ms/batch 75.49 | loss  3.56 | ppl    35.15 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 16.94s | valid loss  4.30 | valid ppl    73.57 | valid bpc    6.201
-----------------------------------------------------------------------------------------
PROGRESS: 32.0%
| epoch  33 |   100/  216 batches | lr 0.00030 | ms/batch 77.11 | loss  3.54 | ppl    34.50 
| epoch  33 |   200/  216 batches | lr 0.00030 | ms/batch 75.49 | loss  3.54 | ppl    34.40 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 16.95s | valid loss  4.27 | valid ppl    71.21 | valid bpc    6.154
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 33.0%
| epoch  34 |   100/  216 batches | lr 0.00030 | ms/batch 76.70 | loss  3.53 | ppl    34.11 
| epoch  34 |   200/  216 batches | lr 0.00030 | ms/batch 75.75 | loss  3.51 | ppl    33.32 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 16.94s | valid loss  4.27 | valid ppl    71.38 | valid bpc    6.157
-----------------------------------------------------------------------------------------
PROGRESS: 34.0%
| epoch  35 |   100/  216 batches | lr 0.00030 | ms/batch 76.76 | loss  3.46 | ppl    31.84 
| epoch  35 |   200/  216 batches | lr 0.00030 | ms/batch 75.78 | loss  3.46 | ppl    31.73 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 16.94s | valid loss  4.25 | valid ppl    70.41 | valid bpc    6.138
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 35.0%
| epoch  36 |   100/  216 batches | lr 0.00030 | ms/batch 76.74 | loss  3.41 | ppl    30.13 
| epoch  36 |   200/  216 batches | lr 0.00030 | ms/batch 75.80 | loss  3.46 | ppl    31.74 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 16.94s | valid loss  4.28 | valid ppl    72.12 | valid bpc    6.172
-----------------------------------------------------------------------------------------
PROGRESS: 36.0%
| epoch  37 |   100/  216 batches | lr 0.00030 | ms/batch 76.97 | loss  3.38 | ppl    29.34 
| epoch  37 |   200/  216 batches | lr 0.00030 | ms/batch 75.61 | loss  3.40 | ppl    29.91 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 16.94s | valid loss  4.24 | valid ppl    69.10 | valid bpc    6.111
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 37.0%
| epoch  38 |   100/  216 batches | lr 0.00030 | ms/batch 76.59 | loss  3.36 | ppl    28.81 
| epoch  38 |   200/  216 batches | lr 0.00030 | ms/batch 75.91 | loss  3.37 | ppl    29.02 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 16.94s | valid loss  4.25 | valid ppl    69.79 | valid bpc    6.125
-----------------------------------------------------------------------------------------
PROGRESS: 38.0%
| epoch  39 |   100/  216 batches | lr 0.00030 | ms/batch 76.53 | loss  3.35 | ppl    28.40 
| epoch  39 |   200/  216 batches | lr 0.00030 | ms/batch 76.04 | loss  3.33 | ppl    27.80 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 16.95s | valid loss  4.28 | valid ppl    72.35 | valid bpc    6.177
-----------------------------------------------------------------------------------------
PROGRESS: 39.0%
| epoch  40 |   100/  216 batches | lr 0.00030 | ms/batch 77.10 | loss  3.30 | ppl    26.98 
| epoch  40 |   200/  216 batches | lr 0.00030 | ms/batch 75.49 | loss  3.30 | ppl    27.02 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 16.95s | valid loss  4.25 | valid ppl    70.35 | valid bpc    6.137
-----------------------------------------------------------------------------------------
PROGRESS: 40.0%
| epoch  41 |   100/  216 batches | lr 0.00015 | ms/batch 76.56 | loss  3.22 | ppl    25.12 
| epoch  41 |   200/  216 batches | lr 0.00015 | ms/batch 76.06 | loss  3.17 | ppl    23.88 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 16.95s | valid loss  4.22 | valid ppl    68.27 | valid bpc    6.093
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 41.0%
| epoch  42 |   100/  216 batches | lr 0.00015 | ms/batch 76.92 | loss  3.15 | ppl    23.32 
| epoch  42 |   200/  216 batches | lr 0.00015 | ms/batch 75.67 | loss  3.13 | ppl    22.99 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 16.94s | valid loss  4.23 | valid ppl    68.81 | valid bpc    6.105
-----------------------------------------------------------------------------------------
PROGRESS: 42.0%
| epoch  43 |   100/  216 batches | lr 0.00015 | ms/batch 76.86 | loss  3.13 | ppl    22.76 
| epoch  43 |   200/  216 batches | lr 0.00015 | ms/batch 75.78 | loss  3.11 | ppl    22.49 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 16.95s | valid loss  4.22 | valid ppl    68.32 | valid bpc    6.094
-----------------------------------------------------------------------------------------
PROGRESS: 43.0%
| epoch  44 |   100/  216 batches | lr 0.00015 | ms/batch 76.91 | loss  3.08 | ppl    21.81 
| epoch  44 |   200/  216 batches | lr 0.00015 | ms/batch 75.69 | loss  3.09 | ppl    21.90 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 16.95s | valid loss  4.21 | valid ppl    67.05 | valid bpc    6.067
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 44.0%
| epoch  45 |   100/  216 batches | lr 0.00015 | ms/batch 76.62 | loss  3.07 | ppl    21.57 
| epoch  45 |   200/  216 batches | lr 0.00015 | ms/batch 75.82 | loss  3.06 | ppl    21.34 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 16.94s | valid loss  4.23 | valid ppl    68.70 | valid bpc    6.102
-----------------------------------------------------------------------------------------
PROGRESS: 45.0%
| epoch  46 |   100/  216 batches | lr 0.00015 | ms/batch 76.63 | loss  3.04 | ppl    20.99 
| epoch  46 |   200/  216 batches | lr 0.00015 | ms/batch 75.86 | loss  3.04 | ppl    20.90 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 16.94s | valid loss  4.21 | valid ppl    67.16 | valid bpc    6.070
-----------------------------------------------------------------------------------------
PROGRESS: 46.0%
| epoch  47 |   100/  216 batches | lr 0.00015 | ms/batch 76.95 | loss  3.04 | ppl    20.93 
| epoch  47 |   200/  216 batches | lr 0.00015 | ms/batch 75.62 | loss  3.02 | ppl    20.40 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 16.95s | valid loss  4.26 | valid ppl    70.50 | valid bpc    6.140
-----------------------------------------------------------------------------------------
PROGRESS: 47.0%
| epoch  48 |   100/  216 batches | lr 0.00007 | ms/batch 76.70 | loss  2.98 | ppl    19.77 
| epoch  48 |   200/  216 batches | lr 0.00007 | ms/batch 75.74 | loss  2.96 | ppl    19.29 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 16.94s | valid loss  4.21 | valid ppl    67.15 | valid bpc    6.069
-----------------------------------------------------------------------------------------
PROGRESS: 48.0%
| epoch  49 |   100/  216 batches | lr 0.00007 | ms/batch 76.82 | loss  2.95 | ppl    19.01 
| epoch  49 |   200/  216 batches | lr 0.00007 | ms/batch 75.76 | loss  2.94 | ppl    18.94 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 16.95s | valid loss  4.22 | valid ppl    68.14 | valid bpc    6.090
-----------------------------------------------------------------------------------------
PROGRESS: 49.0%
| epoch  50 |   100/  216 batches | lr 0.00007 | ms/batch 76.49 | loss  2.92 | ppl    18.61 
| epoch  50 |   200/  216 batches | lr 0.00007 | ms/batch 76.08 | loss  2.90 | ppl    18.20 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 16.94s | valid loss  4.24 | valid ppl    69.26 | valid bpc    6.114
-----------------------------------------------------------------------------------------
PROGRESS: 50.0%
| epoch  51 |   100/  216 batches | lr 0.00004 | ms/batch 77.03 | loss  2.89 | ppl    18.08 
| epoch  51 |   200/  216 batches | lr 0.00004 | ms/batch 75.56 | loss  2.88 | ppl    17.77 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 16.94s | valid loss  4.22 | valid ppl    67.75 | valid bpc    6.082
-----------------------------------------------------------------------------------------
PROGRESS: 51.0%
| epoch  52 |   100/  216 batches | lr 0.00004 | ms/batch 76.45 | loss  2.90 | ppl    18.16 
| epoch  52 |   200/  216 batches | lr 0.00004 | ms/batch 76.11 | loss  2.86 | ppl    17.53 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 16.94s | valid loss  4.23 | valid ppl    68.51 | valid bpc    6.098
-----------------------------------------------------------------------------------------
PROGRESS: 52.0%
| epoch  53 |   100/  216 batches | lr 0.00004 | ms/batch 77.14 | loss  2.88 | ppl    17.75 
| epoch  53 |   200/  216 batches | lr 0.00004 | ms/batch 75.43 | loss  2.85 | ppl    17.34 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 16.94s | valid loss  4.21 | valid ppl    67.23 | valid bpc    6.071
-----------------------------------------------------------------------------------------
PROGRESS: 53.0%
| epoch  54 |   100/  216 batches | lr 0.00002 | ms/batch 76.61 | loss  2.87 | ppl    17.66 
| epoch  54 |   200/  216 batches | lr 0.00002 | ms/batch 75.99 | loss  2.82 | ppl    16.78 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 16.96s | valid loss  4.25 | valid ppl    70.29 | valid bpc    6.135
-----------------------------------------------------------------------------------------
PROGRESS: 54.0%
| epoch  55 |   100/  216 batches | lr 0.00002 | ms/batch 76.57 | loss  2.84 | ppl    17.07 
| epoch  55 |   200/  216 batches | lr 0.00002 | ms/batch 76.19 | loss  2.84 | ppl    17.15 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 16.95s | valid loss  4.25 | valid ppl    70.16 | valid bpc    6.133
-----------------------------------------------------------------------------------------
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  216 batches | lr 0.00002 | ms/batch 76.81 | loss  2.85 | ppl    17.37 
| epoch  56 |   200/  216 batches | lr 0.00002 | ms/batch 75.82 | loss  2.82 | ppl    16.79 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 16.96s | valid loss  4.23 | valid ppl    68.77 | valid bpc    6.104
-----------------------------------------------------------------------------------------
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  216 batches | lr 0.00001 | ms/batch 76.98 | loss  2.83 | ppl    16.91 
| epoch  57 |   200/  216 batches | lr 0.00001 | ms/batch 75.34 | loss  2.80 | ppl    16.46 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 16.95s | valid loss  4.24 | valid ppl    69.49 | valid bpc    6.119
-----------------------------------------------------------------------------------------
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  216 batches | lr 0.00001 | ms/batch 76.66 | loss  2.85 | ppl    17.21 
| epoch  58 |   200/  216 batches | lr 0.00001 | ms/batch 76.17 | loss  2.80 | ppl    16.42 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 16.97s | valid loss  4.19 | valid ppl    65.76 | valid bpc    6.039
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  216 batches | lr 0.00001 | ms/batch 77.25 | loss  2.81 | ppl    16.66 
| epoch  59 |   200/  216 batches | lr 0.00001 | ms/batch 75.35 | loss  2.83 | ppl    16.96 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 16.94s | valid loss  4.22 | valid ppl    67.80 | valid bpc    6.083
-----------------------------------------------------------------------------------------
PROGRESS: 59.0%
| epoch  60 |   100/  216 batches | lr 0.00001 | ms/batch 77.14 | loss  2.82 | ppl    16.79 
| epoch  60 |   200/  216 batches | lr 0.00001 | ms/batch 75.47 | loss  2.82 | ppl    16.78 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 16.94s | valid loss  4.20 | valid ppl    67.01 | valid bpc    6.066
-----------------------------------------------------------------------------------------
PROGRESS: 60.0%
| epoch  61 |   100/  216 batches | lr 0.00001 | ms/batch 76.80 | loss  2.81 | ppl    16.66 
| epoch  61 |   200/  216 batches | lr 0.00001 | ms/batch 75.69 | loss  2.83 | ppl    16.87 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 16.94s | valid loss  4.21 | valid ppl    67.13 | valid bpc    6.069
-----------------------------------------------------------------------------------------
PROGRESS: 61.0%
| epoch  62 |   100/  216 batches | lr 0.00000 | ms/batch 77.09 | loss  2.85 | ppl    17.22 
| epoch  62 |   200/  216 batches | lr 0.00000 | ms/batch 75.60 | loss  2.80 | ppl    16.42 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 16.96s | valid loss  4.22 | valid ppl    68.06 | valid bpc    6.089
-----------------------------------------------------------------------------------------
PROGRESS: 62.0%
| epoch  63 |   100/  216 batches | lr 0.00000 | ms/batch 76.53 | loss  2.82 | ppl    16.76 
| epoch  63 |   200/  216 batches | lr 0.00000 | ms/batch 76.03 | loss  2.82 | ppl    16.70 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 16.94s | valid loss  4.19 | valid ppl    65.83 | valid bpc    6.041
-----------------------------------------------------------------------------------------
PROGRESS: 63.0%
| epoch  64 |   100/  216 batches | lr 0.00000 | ms/batch 76.72 | loss  2.81 | ppl    16.55 
| epoch  64 |   200/  216 batches | lr 0.00000 | ms/batch 75.94 | loss  2.79 | ppl    16.26 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 16.95s | valid loss  4.23 | valid ppl    68.73 | valid bpc    6.103
-----------------------------------------------------------------------------------------
PROGRESS: 64.0%
| epoch  65 |   100/  216 batches | lr 0.00000 | ms/batch 76.92 | loss  2.83 | ppl    16.91 
| epoch  65 |   200/  216 batches | lr 0.00000 | ms/batch 75.75 | loss  2.80 | ppl    16.40 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 16.94s | valid loss  4.23 | valid ppl    68.40 | valid bpc    6.096
-----------------------------------------------------------------------------------------
PROGRESS: 65.0%
| epoch  66 |   100/  216 batches | lr 0.00000 | ms/batch 77.08 | loss  2.84 | ppl    17.04 
| epoch  66 |   200/  216 batches | lr 0.00000 | ms/batch 75.53 | loss  2.80 | ppl    16.36 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 16.95s | valid loss  4.24 | valid ppl    69.73 | valid bpc    6.124
-----------------------------------------------------------------------------------------
PROGRESS: 66.0%
| epoch  67 |   100/  216 batches | lr 0.00000 | ms/batch 77.32 | loss  2.81 | ppl    16.65 
| epoch  67 |   200/  216 batches | lr 0.00000 | ms/batch 75.34 | loss  2.81 | ppl    16.64 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 16.95s | valid loss  4.21 | valid ppl    67.20 | valid bpc    6.070
-----------------------------------------------------------------------------------------
PROGRESS: 67.0%
| epoch  68 |   100/  216 batches | lr 0.00000 | ms/batch 77.26 | loss  2.83 | ppl    17.00 
| epoch  68 |   200/  216 batches | lr 0.00000 | ms/batch 75.26 | loss  2.77 | ppl    16.03 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 16.94s | valid loss  4.25 | valid ppl    69.76 | valid bpc    6.124
-----------------------------------------------------------------------------------------
PROGRESS: 68.0%
| epoch  69 |   100/  216 batches | lr 0.00000 | ms/batch 76.49 | loss  2.80 | ppl    16.52 
| epoch  69 |   200/  216 batches | lr 0.00000 | ms/batch 76.03 | loss  2.79 | ppl    16.21 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 16.94s | valid loss  4.22 | valid ppl    67.75 | valid bpc    6.082
-----------------------------------------------------------------------------------------
PROGRESS: 69.0%
| epoch  70 |   100/  216 batches | lr 0.00000 | ms/batch 76.96 | loss  2.82 | ppl    16.80 
| epoch  70 |   200/  216 batches | lr 0.00000 | ms/batch 75.58 | loss  2.78 | ppl    16.19 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 16.94s | valid loss  4.20 | valid ppl    66.52 | valid bpc    6.056
-----------------------------------------------------------------------------------------
PROGRESS: 70.0%
| epoch  71 |   100/  216 batches | lr 0.00000 | ms/batch 76.74 | loss  2.82 | ppl    16.79 
| epoch  71 |   200/  216 batches | lr 0.00000 | ms/batch 75.83 | loss  2.80 | ppl    16.45 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 16.95s | valid loss  4.25 | valid ppl    70.09 | valid bpc    6.131
-----------------------------------------------------------------------------------------
PROGRESS: 71.0%
| epoch  72 |   100/  216 batches | lr 0.00000 | ms/batch 76.87 | loss  2.82 | ppl    16.80 
| epoch  72 |   200/  216 batches | lr 0.00000 | ms/batch 75.68 | loss  2.78 | ppl    16.20 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 16.95s | valid loss  4.20 | valid ppl    66.74 | valid bpc    6.060
-----------------------------------------------------------------------------------------
PROGRESS: 72.0%
| epoch  73 |   100/  216 batches | lr 0.00000 | ms/batch 76.66 | loss  2.82 | ppl    16.84 
| epoch  73 |   200/  216 batches | lr 0.00000 | ms/batch 75.82 | loss  2.81 | ppl    16.59 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 16.94s | valid loss  4.25 | valid ppl    69.87 | valid bpc    6.127
-----------------------------------------------------------------------------------------
PROGRESS: 73.0%
| epoch  74 |   100/  216 batches | lr 0.00000 | ms/batch 76.92 | loss  2.82 | ppl    16.75 
| epoch  74 |   200/  216 batches | lr 0.00000 | ms/batch 75.72 | loss  2.80 | ppl    16.45 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 16.95s | valid loss  4.23 | valid ppl    68.55 | valid bpc    6.099
-----------------------------------------------------------------------------------------
PROGRESS: 74.0%
| epoch  75 |   100/  216 batches | lr 0.00000 | ms/batch 76.88 | loss  2.82 | ppl    16.72 
| epoch  75 |   200/  216 batches | lr 0.00000 | ms/batch 75.66 | loss  2.80 | ppl    16.46 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 16.95s | valid loss  4.22 | valid ppl    68.31 | valid bpc    6.094
-----------------------------------------------------------------------------------------
PROGRESS: 75.0%
| epoch  76 |   100/  216 batches | lr 0.00000 | ms/batch 76.82 | loss  2.81 | ppl    16.60 
| epoch  76 |   200/  216 batches | lr 0.00000 | ms/batch 75.73 | loss  2.79 | ppl    16.35 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 16.94s | valid loss  4.21 | valid ppl    67.65 | valid bpc    6.080
-----------------------------------------------------------------------------------------
PROGRESS: 76.0%
| epoch  77 |   100/  216 batches | lr 0.00000 | ms/batch 76.85 | loss  2.83 | ppl    16.92 
| epoch  77 |   200/  216 batches | lr 0.00000 | ms/batch 75.81 | loss  2.77 | ppl    15.95 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 16.95s | valid loss  4.20 | valid ppl    66.88 | valid bpc    6.063
-----------------------------------------------------------------------------------------
PROGRESS: 77.0%
| epoch  78 |   100/  216 batches | lr 0.00000 | ms/batch 76.93 | loss  2.81 | ppl    16.60 
| epoch  78 |   200/  216 batches | lr 0.00000 | ms/batch 75.57 | loss  2.78 | ppl    16.16 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 16.95s | valid loss  4.24 | valid ppl    69.06 | valid bpc    6.110
-----------------------------------------------------------------------------------------
PROGRESS: 78.0%
| epoch  79 |   100/  216 batches | lr 0.00000 | ms/batch 76.93 | loss  2.81 | ppl    16.60 
| epoch  79 |   200/  216 batches | lr 0.00000 | ms/batch 75.55 | loss  2.80 | ppl    16.41 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 16.96s | valid loss  4.18 | valid ppl    65.46 | valid bpc    6.033
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 79.0%
| epoch  80 |   100/  216 batches | lr 0.00000 | ms/batch 76.59 | loss  2.80 | ppl    16.49 
| epoch  80 |   200/  216 batches | lr 0.00000 | ms/batch 75.94 | loss  2.79 | ppl    16.26 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 16.94s | valid loss  4.21 | valid ppl    67.69 | valid bpc    6.081
-----------------------------------------------------------------------------------------
PROGRESS: 80.0%
| epoch  81 |   100/  216 batches | lr 0.00000 | ms/batch 77.23 | loss  2.83 | ppl    16.96 
| epoch  81 |   200/  216 batches | lr 0.00000 | ms/batch 75.33 | loss  2.77 | ppl    15.93 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 16.94s | valid loss  4.22 | valid ppl    68.05 | valid bpc    6.088
-----------------------------------------------------------------------------------------
PROGRESS: 81.0%
| epoch  82 |   100/  216 batches | lr 0.00000 | ms/batch 76.47 | loss  2.81 | ppl    16.65 
| epoch  82 |   200/  216 batches | lr 0.00000 | ms/batch 76.13 | loss  2.79 | ppl    16.22 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 16.94s | valid loss  4.21 | valid ppl    67.45 | valid bpc    6.076
-----------------------------------------------------------------------------------------
PROGRESS: 82.0%
| epoch  83 |   100/  216 batches | lr 0.00000 | ms/batch 76.87 | loss  2.81 | ppl    16.65 
| epoch  83 |   200/  216 batches | lr 0.00000 | ms/batch 75.76 | loss  2.78 | ppl    16.14 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 16.95s | valid loss  4.19 | valid ppl    66.30 | valid bpc    6.051
-----------------------------------------------------------------------------------------
PROGRESS: 83.0%
| epoch  84 |   100/  216 batches | lr 0.00000 | ms/batch 77.05 | loss  2.84 | ppl    17.06 
| epoch  84 |   200/  216 batches | lr 0.00000 | ms/batch 75.69 | loss  2.79 | ppl    16.30 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 16.96s | valid loss  4.21 | valid ppl    67.24 | valid bpc    6.071
-----------------------------------------------------------------------------------------
PROGRESS: 84.0%
| epoch  85 |   100/  216 batches | lr 0.00000 | ms/batch 76.93 | loss  2.80 | ppl    16.51 
| epoch  85 |   200/  216 batches | lr 0.00000 | ms/batch 75.84 | loss  2.80 | ppl    16.42 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 16.96s | valid loss  4.20 | valid ppl    66.56 | valid bpc    6.057
-----------------------------------------------------------------------------------------
PROGRESS: 85.0%
| epoch  86 |   100/  216 batches | lr 0.00000 | ms/batch 76.73 | loss  2.84 | ppl    17.20 
| epoch  86 |   200/  216 batches | lr 0.00000 | ms/batch 76.01 | loss  2.77 | ppl    15.95 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 16.95s | valid loss  4.22 | valid ppl    67.75 | valid bpc    6.082
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  216 batches | lr 0.00000 | ms/batch 76.71 | loss  2.82 | ppl    16.70 
| epoch  87 |   200/  216 batches | lr 0.00000 | ms/batch 75.90 | loss  2.80 | ppl    16.47 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 16.96s | valid loss  4.20 | valid ppl    66.94 | valid bpc    6.065
-----------------------------------------------------------------------------------------
PROGRESS: 87.0%
| epoch  88 |   100/  216 batches | lr 0.00000 | ms/batch 76.69 | loss  2.82 | ppl    16.75 
| epoch  88 |   200/  216 batches | lr 0.00000 | ms/batch 75.91 | loss  2.79 | ppl    16.35 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 16.95s | valid loss  4.21 | valid ppl    67.20 | valid bpc    6.070
-----------------------------------------------------------------------------------------
PROGRESS: 88.0%
| epoch  89 |   100/  216 batches | lr 0.00000 | ms/batch 76.47 | loss  2.80 | ppl    16.41 
| epoch  89 |   200/  216 batches | lr 0.00000 | ms/batch 76.23 | loss  2.83 | ppl    16.86 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 16.95s | valid loss  4.21 | valid ppl    67.16 | valid bpc    6.070
-----------------------------------------------------------------------------------------
PROGRESS: 89.0%
| epoch  90 |   100/  216 batches | lr 0.00000 | ms/batch 76.67 | loss  2.81 | ppl    16.54 
| epoch  90 |   200/  216 batches | lr 0.00000 | ms/batch 75.61 | loss  2.79 | ppl    16.35 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 16.94s | valid loss  4.23 | valid ppl    68.92 | valid bpc    6.107
-----------------------------------------------------------------------------------------
PROGRESS: 90.0%
| epoch  91 |   100/  216 batches | lr 0.00000 | ms/batch 76.70 | loss  2.82 | ppl    16.81 
| epoch  91 |   200/  216 batches | lr 0.00000 | ms/batch 75.87 | loss  2.79 | ppl    16.29 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 16.95s | valid loss  4.22 | valid ppl    67.72 | valid bpc    6.081
-----------------------------------------------------------------------------------------
PROGRESS: 91.0%
| epoch  92 |   100/  216 batches | lr 0.00000 | ms/batch 76.92 | loss  2.82 | ppl    16.73 
| epoch  92 |   200/  216 batches | lr 0.00000 | ms/batch 75.45 | loss  2.77 | ppl    16.03 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 16.95s | valid loss  4.23 | valid ppl    68.89 | valid bpc    6.106
-----------------------------------------------------------------------------------------
PROGRESS: 92.0%
| epoch  93 |   100/  216 batches | lr 0.00000 | ms/batch 76.50 | loss  2.82 | ppl    16.86 
| epoch  93 |   200/  216 batches | lr 0.00000 | ms/batch 76.01 | loss  2.80 | ppl    16.42 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 16.95s | valid loss  4.24 | valid ppl    69.50 | valid bpc    6.119
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  216 batches | lr 0.00000 | ms/batch 77.20 | loss  2.82 | ppl    16.82 
| epoch  94 |   200/  216 batches | lr 0.00000 | ms/batch 75.50 | loss  2.79 | ppl    16.21 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 16.94s | valid loss  4.22 | valid ppl    68.31 | valid bpc    6.094
-----------------------------------------------------------------------------------------
PROGRESS: 94.0%
| epoch  95 |   100/  216 batches | lr 0.00000 | ms/batch 76.71 | loss  2.82 | ppl    16.79 
| epoch  95 |   200/  216 batches | lr 0.00000 | ms/batch 75.84 | loss  2.79 | ppl    16.34 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 16.94s | valid loss  4.20 | valid ppl    67.01 | valid bpc    6.066
-----------------------------------------------------------------------------------------
PROGRESS: 95.0%
| epoch  96 |   100/  216 batches | lr 0.00000 | ms/batch 77.20 | loss  2.80 | ppl    16.47 
| epoch  96 |   200/  216 batches | lr 0.00000 | ms/batch 75.44 | loss  2.80 | ppl    16.39 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 16.95s | valid loss  4.20 | valid ppl    66.94 | valid bpc    6.065
-----------------------------------------------------------------------------------------
PROGRESS: 96.0%
| epoch  97 |   100/  216 batches | lr 0.00000 | ms/batch 76.88 | loss  2.81 | ppl    16.56 
| epoch  97 |   200/  216 batches | lr 0.00000 | ms/batch 75.67 | loss  2.78 | ppl    16.19 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 16.95s | valid loss  4.23 | valid ppl    68.48 | valid bpc    6.098
-----------------------------------------------------------------------------------------
PROGRESS: 97.0%
| epoch  98 |   100/  216 batches | lr 0.00000 | ms/batch 76.77 | loss  2.82 | ppl    16.70 
| epoch  98 |   200/  216 batches | lr 0.00000 | ms/batch 75.74 | loss  2.78 | ppl    16.10 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 16.94s | valid loss  4.24 | valid ppl    69.62 | valid bpc    6.121
-----------------------------------------------------------------------------------------
PROGRESS: 98.0%
| epoch  99 |   100/  216 batches | lr 0.00000 | ms/batch 77.14 | loss  2.80 | ppl    16.50 
| epoch  99 |   200/  216 batches | lr 0.00000 | ms/batch 75.46 | loss  2.81 | ppl    16.54 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 16.95s | valid loss  4.24 | valid ppl    69.46 | valid bpc    6.118
-----------------------------------------------------------------------------------------
PROGRESS: 99.0%
| epoch 100 |   100/  216 batches | lr 0.00000 | ms/batch 76.85 | loss  2.82 | ppl    16.76 
| epoch 100 |   200/  216 batches | lr 0.00000 | ms/batch 75.87 | loss  2.79 | ppl    16.24 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 16.95s | valid loss  4.25 | valid ppl    70.29 | valid bpc    6.135
-----------------------------------------------------------------------------------------
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  4.16 | test ppl    64.35 | test bpc    6.008
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.5112, Mean Reca: 0.7013, Mean F1: 0.5828
Counter({'NP': 10093, 'VP': 4693, 'PP': 4402, 'S': 3980, 'SBAR': 1124, 'ADJP': 306, 'QP': 277, 'ADVP': 174, 'SINV': 150, 'PRN': 55, 'NX': 42, 'FRAG': 32, 'WHNP': 23, 'SQ': 15, 'NAC': 13, 'UCP': 10, 'SBARQ': 8, 'CONJP': 3, 'X': 3, 'WHPP': 1})
Counter({'NP': 14432, 'VP': 8130, 'S': 5620, 'PP': 5484, 'SBAR': 1796, 'ADJP': 649, 'QP': 490, 'ADVP': 286, 'SINV': 157, 'PRN': 128, 'NX': 95, 'FRAG': 42, 'WHNP': 37, 'UCP': 32, 'NAC': 30, 'WHPP': 25, 'CONJP': 21, 'SQ': 18, 'SBARQ': 10, 'WHADVP': 9, 'X': 6, 'WHADJP': 4, 'INTJ': 1})
SBAR: 0.6258
NP: 0.6993
VP: 0.5772
PP: 0.8027
ADJP: 0.4715
ADVP: 0.6084
5.236112443180244
-----------------------------------------------------------------------------------------
Dependency parsing performance:
Conll-U Style:
DDA: 0.079
UDA: 0.339
=========================================================================================
Loading dataset...
Loading dictionary...
Number of tokens:  10001
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer_in_parser', nhid=512, nlayers=8, front_layers=5, rear_layers=3, n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=2222, nonmono=5, cuda=True, log_interval=100, save='trained_models/structformer_in_parser_2222_53.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 38475589
Model architecture: StructFormer_In_Parser(
  (transformer_front): Transformer_Front(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(10001, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-4): 5 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
  (transformer_rear): Transformer_Rear(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(10001, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-2): 3 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (output_layer): Linear(in_features=512, out_features=10001, bias=True)
  )
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  216 batches | lr 0.00030 | ms/batch 79.24 | loss  7.31 | ppl  1500.47 
| epoch   1 |   200/  216 batches | lr 0.00030 | ms/batch 74.80 | loss  6.86 | ppl   953.03 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 17.11s | valid loss  6.73 | valid ppl   839.42 | valid bpc    9.713
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  216 batches | lr 0.00030 | ms/batch 76.53 | loss  6.85 | ppl   945.64 
| epoch   2 |   200/  216 batches | lr 0.00030 | ms/batch 74.90 | loss  6.67 | ppl   788.44 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 16.82s | valid loss  6.47 | valid ppl   647.01 | valid bpc    9.338
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  216 batches | lr 0.00030 | ms/batch 76.60 | loss  6.50 | ppl   663.31 
| epoch   3 |   200/  216 batches | lr 0.00030 | ms/batch 75.39 | loss  6.24 | ppl   510.81 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 16.87s | valid loss  6.05 | valid ppl   423.87 | valid bpc    8.727
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  216 batches | lr 0.00030 | ms/batch 76.23 | loss  6.02 | ppl   411.27 
| epoch   4 |   200/  216 batches | lr 0.00030 | ms/batch 75.87 | loss  5.81 | ppl   335.17 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 16.90s | valid loss  5.69 | valid ppl   296.00 | valid bpc    8.209
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  216 batches | lr 0.00030 | ms/batch 76.47 | loss  5.65 | ppl   284.76 
| epoch   5 |   200/  216 batches | lr 0.00030 | ms/batch 75.91 | loss  5.53 | ppl   251.68 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 16.92s | valid loss  5.42 | valid ppl   226.67 | valid bpc    7.824
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  216 batches | lr 0.00030 | ms/batch 76.54 | loss  5.43 | ppl   228.44 
| epoch   6 |   200/  216 batches | lr 0.00030 | ms/batch 75.61 | loss  5.32 | ppl   204.89 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 16.92s | valid loss  5.21 | valid ppl   183.86 | valid bpc    7.522
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  216 batches | lr 0.00030 | ms/batch 76.55 | loss  5.25 | ppl   190.35 
| epoch   7 |   200/  216 batches | lr 0.00030 | ms/batch 75.73 | loss  5.14 | ppl   171.22 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 16.92s | valid loss  5.14 | valid ppl   170.64 | valid bpc    7.415
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  216 batches | lr 0.00030 | ms/batch 76.68 | loss  5.12 | ppl   166.88 
| epoch   8 |   200/  216 batches | lr 0.00030 | ms/batch 75.47 | loss  4.99 | ppl   146.81 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 16.94s | valid loss  5.02 | valid ppl   150.75 | valid bpc    7.236
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 8.0%
| epoch   9 |   100/  216 batches | lr 0.00030 | ms/batch 76.91 | loss  5.00 | ppl   148.51 
| epoch   9 |   200/  216 batches | lr 0.00030 | ms/batch 75.68 | loss  4.90 | ppl   134.59 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 16.95s | valid loss  4.91 | valid ppl   135.39 | valid bpc    7.081
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  216 batches | lr 0.00030 | ms/batch 76.78 | loss  4.87 | ppl   129.95 
| epoch  10 |   200/  216 batches | lr 0.00030 | ms/batch 75.72 | loss  4.82 | ppl   123.40 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 16.94s | valid loss  4.86 | valid ppl   128.80 | valid bpc    7.009
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  216 batches | lr 0.00030 | ms/batch 76.68 | loss  4.80 | ppl   121.62 
| epoch  11 |   200/  216 batches | lr 0.00030 | ms/batch 75.77 | loss  4.70 | ppl   109.74 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 16.94s | valid loss  4.80 | valid ppl   121.97 | valid bpc    6.930
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  216 batches | lr 0.00030 | ms/batch 76.96 | loss  4.68 | ppl   107.57 
| epoch  12 |   200/  216 batches | lr 0.00030 | ms/batch 75.48 | loss  4.63 | ppl   102.36 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 16.94s | valid loss  4.75 | valid ppl   115.28 | valid bpc    6.849
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 12.0%
| epoch  13 |   100/  216 batches | lr 0.00030 | ms/batch 76.63 | loss  4.60 | ppl    99.50 
| epoch  13 |   200/  216 batches | lr 0.00030 | ms/batch 75.57 | loss  4.55 | ppl    94.21 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 16.94s | valid loss  4.68 | valid ppl   108.28 | valid bpc    6.759
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 13.0%
| epoch  14 |   100/  216 batches | lr 0.00030 | ms/batch 76.50 | loss  4.53 | ppl    92.51 
| epoch  14 |   200/  216 batches | lr 0.00030 | ms/batch 75.91 | loss  4.46 | ppl    86.58 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 16.94s | valid loss  4.64 | valid ppl   103.74 | valid bpc    6.697
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  216 batches | lr 0.00030 | ms/batch 76.94 | loss  4.45 | ppl    85.57 
| epoch  15 |   200/  216 batches | lr 0.00030 | ms/batch 75.55 | loss  4.40 | ppl    81.51 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 16.93s | valid loss  4.62 | valid ppl   101.14 | valid bpc    6.660
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 15.0%
| epoch  16 |   100/  216 batches | lr 0.00030 | ms/batch 77.03 | loss  4.38 | ppl    80.18 
| epoch  16 |   200/  216 batches | lr 0.00030 | ms/batch 75.22 | loss  4.31 | ppl    74.70 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 16.94s | valid loss  4.54 | valid ppl    94.13 | valid bpc    6.557
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 16.0%
| epoch  17 |   100/  216 batches | lr 0.00030 | ms/batch 76.69 | loss  4.31 | ppl    74.09 
| epoch  17 |   200/  216 batches | lr 0.00030 | ms/batch 75.86 | loss  4.27 | ppl    71.53 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 16.94s | valid loss  4.56 | valid ppl    95.82 | valid bpc    6.582
-----------------------------------------------------------------------------------------
PROGRESS: 17.0%
| epoch  18 |   100/  216 batches | lr 0.00030 | ms/batch 77.12 | loss  4.24 | ppl    69.26 
| epoch  18 |   200/  216 batches | lr 0.00030 | ms/batch 75.30 | loss  4.22 | ppl    67.86 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 16.93s | valid loss  4.49 | valid ppl    89.25 | valid bpc    6.480
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 18.0%
| epoch  19 |   100/  216 batches | lr 0.00030 | ms/batch 76.89 | loss  4.19 | ppl    66.31 
| epoch  19 |   200/  216 batches | lr 0.00030 | ms/batch 75.57 | loss  4.16 | ppl    63.90 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 16.94s | valid loss  4.45 | valid ppl    86.03 | valid bpc    6.427
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 19.0%
| epoch  20 |   100/  216 batches | lr 0.00030 | ms/batch 77.03 | loss  4.15 | ppl    63.15 
| epoch  20 |   200/  216 batches | lr 0.00030 | ms/batch 75.35 | loss  4.07 | ppl    58.53 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 16.93s | valid loss  4.47 | valid ppl    86.99 | valid bpc    6.443
-----------------------------------------------------------------------------------------
PROGRESS: 20.0%
| epoch  21 |   100/  216 batches | lr 0.00030 | ms/batch 76.48 | loss  4.08 | ppl    58.87 
| epoch  21 |   200/  216 batches | lr 0.00030 | ms/batch 76.02 | loss  4.06 | ppl    57.87 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 16.94s | valid loss  4.40 | valid ppl    81.60 | valid bpc    6.350
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 21.0%
| epoch  22 |   100/  216 batches | lr 0.00030 | ms/batch 76.71 | loss  4.01 | ppl    55.02 
| epoch  22 |   200/  216 batches | lr 0.00030 | ms/batch 75.74 | loss  4.03 | ppl    56.23 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 16.93s | valid loss  4.35 | valid ppl    77.70 | valid bpc    6.280
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 22.0%
| epoch  23 |   100/  216 batches | lr 0.00030 | ms/batch 77.16 | loss  3.95 | ppl    51.68 
| epoch  23 |   200/  216 batches | lr 0.00030 | ms/batch 75.25 | loss  3.96 | ppl    52.66 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 16.94s | valid loss  4.38 | valid ppl    80.18 | valid bpc    6.325
-----------------------------------------------------------------------------------------
PROGRESS: 23.0%
| epoch  24 |   100/  216 batches | lr 0.00030 | ms/batch 76.59 | loss  3.93 | ppl    50.72 
| epoch  24 |   200/  216 batches | lr 0.00030 | ms/batch 75.94 | loss  3.91 | ppl    49.94 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 16.94s | valid loss  4.40 | valid ppl    81.49 | valid bpc    6.349
-----------------------------------------------------------------------------------------
PROGRESS: 24.0%
| epoch  25 |   100/  216 batches | lr 0.00030 | ms/batch 76.44 | loss  3.89 | ppl    48.67 
| epoch  25 |   200/  216 batches | lr 0.00030 | ms/batch 76.14 | loss  3.85 | ppl    47.11 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 16.94s | valid loss  4.37 | valid ppl    78.88 | valid bpc    6.302
-----------------------------------------------------------------------------------------
PROGRESS: 25.0%
| epoch  26 |   100/  216 batches | lr 0.00015 | ms/batch 77.09 | loss  3.82 | ppl    45.46 
| epoch  26 |   200/  216 batches | lr 0.00015 | ms/batch 75.27 | loss  3.72 | ppl    41.16 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 16.94s | valid loss  4.28 | valid ppl    72.42 | valid bpc    6.178
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 26.0%
| epoch  27 |   100/  216 batches | lr 0.00015 | ms/batch 76.58 | loss  3.72 | ppl    41.44 
| epoch  27 |   200/  216 batches | lr 0.00015 | ms/batch 75.77 | loss  3.70 | ppl    40.27 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 16.93s | valid loss  4.29 | valid ppl    73.19 | valid bpc    6.194
-----------------------------------------------------------------------------------------
PROGRESS: 27.0%
| epoch  28 |   100/  216 batches | lr 0.00015 | ms/batch 76.84 | loss  3.69 | ppl    39.90 
| epoch  28 |   200/  216 batches | lr 0.00015 | ms/batch 75.66 | loss  3.67 | ppl    39.43 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 16.94s | valid loss  4.28 | valid ppl    72.08 | valid bpc    6.171
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  216 batches | lr 0.00015 | ms/batch 77.05 | loss  3.67 | ppl    39.18 
| epoch  29 |   200/  216 batches | lr 0.00015 | ms/batch 75.31 | loss  3.61 | ppl    37.09 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 16.93s | valid loss  4.27 | valid ppl    71.54 | valid bpc    6.161
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  216 batches | lr 0.00015 | ms/batch 76.69 | loss  3.62 | ppl    37.24 
| epoch  30 |   200/  216 batches | lr 0.00015 | ms/batch 75.83 | loss  3.60 | ppl    36.62 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 16.94s | valid loss  4.29 | valid ppl    72.95 | valid bpc    6.189
-----------------------------------------------------------------------------------------
PROGRESS: 30.0%
| epoch  31 |   100/  216 batches | lr 0.00015 | ms/batch 76.74 | loss  3.58 | ppl    35.82 
| epoch  31 |   200/  216 batches | lr 0.00015 | ms/batch 75.74 | loss  3.57 | ppl    35.67 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 16.93s | valid loss  4.24 | valid ppl    69.20 | valid bpc    6.113
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 31.0%
| epoch  32 |   100/  216 batches | lr 0.00015 | ms/batch 77.13 | loss  3.57 | ppl    35.47 
| epoch  32 |   200/  216 batches | lr 0.00015 | ms/batch 75.26 | loss  3.55 | ppl    34.87 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 16.92s | valid loss  4.24 | valid ppl    69.14 | valid bpc    6.111
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 32.0%
| epoch  33 |   100/  216 batches | lr 0.00015 | ms/batch 76.89 | loss  3.54 | ppl    34.49 
| epoch  33 |   200/  216 batches | lr 0.00015 | ms/batch 75.62 | loss  3.53 | ppl    33.96 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 16.93s | valid loss  4.23 | valid ppl    68.91 | valid bpc    6.107
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 33.0%
| epoch  34 |   100/  216 batches | lr 0.00015 | ms/batch 77.11 | loss  3.52 | ppl    33.66 
| epoch  34 |   200/  216 batches | lr 0.00015 | ms/batch 75.41 | loss  3.50 | ppl    33.20 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 16.93s | valid loss  4.22 | valid ppl    68.27 | valid bpc    6.093
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 34.0%
| epoch  35 |   100/  216 batches | lr 0.00015 | ms/batch 77.03 | loss  3.49 | ppl    32.84 
| epoch  35 |   200/  216 batches | lr 0.00015 | ms/batch 75.49 | loss  3.47 | ppl    32.09 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 16.94s | valid loss  4.28 | valid ppl    72.39 | valid bpc    6.178
-----------------------------------------------------------------------------------------
PROGRESS: 35.0%
| epoch  36 |   100/  216 batches | lr 0.00015 | ms/batch 77.00 | loss  3.47 | ppl    32.18 
| epoch  36 |   200/  216 batches | lr 0.00015 | ms/batch 75.31 | loss  3.44 | ppl    31.14 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 16.94s | valid loss  4.22 | valid ppl    68.06 | valid bpc    6.089
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 36.0%
| epoch  37 |   100/  216 batches | lr 0.00015 | ms/batch 76.66 | loss  3.42 | ppl    30.55 
| epoch  37 |   200/  216 batches | lr 0.00015 | ms/batch 75.68 | loss  3.43 | ppl    30.87 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 16.93s | valid loss  4.27 | valid ppl    71.46 | valid bpc    6.159
-----------------------------------------------------------------------------------------
PROGRESS: 37.0%
| epoch  38 |   100/  216 batches | lr 0.00015 | ms/batch 77.09 | loss  3.41 | ppl    30.22 
| epoch  38 |   200/  216 batches | lr 0.00015 | ms/batch 75.55 | loss  3.42 | ppl    30.45 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 16.94s | valid loss  4.24 | valid ppl    69.22 | valid bpc    6.113
-----------------------------------------------------------------------------------------
PROGRESS: 38.0%
| epoch  39 |   100/  216 batches | lr 0.00015 | ms/batch 76.96 | loss  3.41 | ppl    30.18 
| epoch  39 |   200/  216 batches | lr 0.00015 | ms/batch 75.61 | loss  3.39 | ppl    29.54 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 16.95s | valid loss  4.24 | valid ppl    69.21 | valid bpc    6.113
-----------------------------------------------------------------------------------------
PROGRESS: 39.0%
| epoch  40 |   100/  216 batches | lr 0.00007 | ms/batch 76.67 | loss  3.34 | ppl    28.18 
| epoch  40 |   200/  216 batches | lr 0.00007 | ms/batch 75.81 | loss  3.32 | ppl    27.67 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 16.94s | valid loss  4.23 | valid ppl    68.91 | valid bpc    6.107
-----------------------------------------------------------------------------------------
PROGRESS: 40.0%
| epoch  41 |   100/  216 batches | lr 0.00007 | ms/batch 76.41 | loss  3.34 | ppl    28.29 
| epoch  41 |   200/  216 batches | lr 0.00007 | ms/batch 75.78 | loss  3.26 | ppl    26.07 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 16.93s | valid loss  4.18 | valid ppl    65.68 | valid bpc    6.037
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 41.0%
| epoch  42 |   100/  216 batches | lr 0.00007 | ms/batch 76.51 | loss  3.30 | ppl    27.14 
| epoch  42 |   200/  216 batches | lr 0.00007 | ms/batch 75.98 | loss  3.27 | ppl    26.39 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 16.94s | valid loss  4.21 | valid ppl    67.66 | valid bpc    6.080
-----------------------------------------------------------------------------------------
PROGRESS: 42.0%
| epoch  43 |   100/  216 batches | lr 0.00007 | ms/batch 76.69 | loss  3.28 | ppl    26.53 
| epoch  43 |   200/  216 batches | lr 0.00007 | ms/batch 75.82 | loss  3.25 | ppl    25.69 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 16.94s | valid loss  4.22 | valid ppl    68.16 | valid bpc    6.091
-----------------------------------------------------------------------------------------
PROGRESS: 43.0%
| epoch  44 |   100/  216 batches | lr 0.00007 | ms/batch 76.91 | loss  3.28 | ppl    26.58 
| epoch  44 |   200/  216 batches | lr 0.00007 | ms/batch 75.70 | loss  3.24 | ppl    25.45 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 16.94s | valid loss  4.23 | valid ppl    69.01 | valid bpc    6.109
-----------------------------------------------------------------------------------------
PROGRESS: 44.0%
| epoch  45 |   100/  216 batches | lr 0.00004 | ms/batch 76.47 | loss  3.23 | ppl    25.28 
| epoch  45 |   200/  216 batches | lr 0.00004 | ms/batch 76.04 | loss  3.21 | ppl    24.77 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 16.94s | valid loss  4.24 | valid ppl    69.09 | valid bpc    6.111
-----------------------------------------------------------------------------------------
PROGRESS: 45.0%
| epoch  46 |   100/  216 batches | lr 0.00004 | ms/batch 76.56 | loss  3.20 | ppl    24.60 
| epoch  46 |   200/  216 batches | lr 0.00004 | ms/batch 75.89 | loss  3.21 | ppl    24.89 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 16.94s | valid loss  4.19 | valid ppl    66.09 | valid bpc    6.046
-----------------------------------------------------------------------------------------
PROGRESS: 46.0%
| epoch  47 |   100/  216 batches | lr 0.00004 | ms/batch 77.08 | loss  3.23 | ppl    25.19 
| epoch  47 |   200/  216 batches | lr 0.00004 | ms/batch 75.45 | loss  3.18 | ppl    24.01 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 16.94s | valid loss  4.22 | valid ppl    68.06 | valid bpc    6.089
-----------------------------------------------------------------------------------------
PROGRESS: 47.0%
| epoch  48 |   100/  216 batches | lr 0.00002 | ms/batch 76.97 | loss  3.18 | ppl    24.06 
| epoch  48 |   200/  216 batches | lr 0.00002 | ms/batch 75.53 | loss  3.18 | ppl    24.11 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 16.94s | valid loss  4.15 | valid ppl    63.17 | valid bpc    5.981
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 48.0%
| epoch  49 |   100/  216 batches | lr 0.00002 | ms/batch 76.86 | loss  3.20 | ppl    24.47 
| epoch  49 |   200/  216 batches | lr 0.00002 | ms/batch 75.63 | loss  3.16 | ppl    23.48 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 16.94s | valid loss  4.15 | valid ppl    63.51 | valid bpc    5.989
-----------------------------------------------------------------------------------------
PROGRESS: 49.0%
| epoch  50 |   100/  216 batches | lr 0.00002 | ms/batch 76.99 | loss  3.21 | ppl    24.76 
| epoch  50 |   200/  216 batches | lr 0.00002 | ms/batch 75.50 | loss  3.14 | ppl    23.06 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 16.93s | valid loss  4.17 | valid ppl    64.71 | valid bpc    6.016
-----------------------------------------------------------------------------------------
PROGRESS: 50.0%
| epoch  51 |   100/  216 batches | lr 0.00002 | ms/batch 76.85 | loss  3.21 | ppl    24.78 
| epoch  51 |   200/  216 batches | lr 0.00002 | ms/batch 75.65 | loss  3.15 | ppl    23.27 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 16.94s | valid loss  4.17 | valid ppl    64.75 | valid bpc    6.017
-----------------------------------------------------------------------------------------
PROGRESS: 51.0%
| epoch  52 |   100/  216 batches | lr 0.00001 | ms/batch 76.99 | loss  3.19 | ppl    24.32 
| epoch  52 |   200/  216 batches | lr 0.00001 | ms/batch 75.59 | loss  3.13 | ppl    22.93 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 16.94s | valid loss  4.20 | valid ppl    66.43 | valid bpc    6.054
-----------------------------------------------------------------------------------------
PROGRESS: 52.0%
| epoch  53 |   100/  216 batches | lr 0.00001 | ms/batch 76.65 | loss  3.17 | ppl    23.72 
| epoch  53 |   200/  216 batches | lr 0.00001 | ms/batch 75.95 | loss  3.14 | ppl    23.19 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 16.95s | valid loss  4.17 | valid ppl    64.60 | valid bpc    6.013
-----------------------------------------------------------------------------------------
PROGRESS: 53.0%
| epoch  54 |   100/  216 batches | lr 0.00001 | ms/batch 77.00 | loss  3.18 | ppl    23.99 
| epoch  54 |   200/  216 batches | lr 0.00001 | ms/batch 75.47 | loss  3.13 | ppl    22.97 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 16.95s | valid loss  4.16 | valid ppl    63.88 | valid bpc    5.997
-----------------------------------------------------------------------------------------
PROGRESS: 54.0%
| epoch  55 |   100/  216 batches | lr 0.00000 | ms/batch 77.01 | loss  3.16 | ppl    23.46 
| epoch  55 |   200/  216 batches | lr 0.00000 | ms/batch 75.42 | loss  3.13 | ppl    22.95 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 16.94s | valid loss  4.20 | valid ppl    66.59 | valid bpc    6.057
-----------------------------------------------------------------------------------------
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  216 batches | lr 0.00000 | ms/batch 76.64 | loss  3.15 | ppl    23.25 
| epoch  56 |   200/  216 batches | lr 0.00000 | ms/batch 75.94 | loss  3.15 | ppl    23.45 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 16.94s | valid loss  4.14 | valid ppl    62.89 | valid bpc    5.975
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  216 batches | lr 0.00000 | ms/batch 77.04 | loss  3.19 | ppl    24.29 
| epoch  57 |   200/  216 batches | lr 0.00000 | ms/batch 75.50 | loss  3.12 | ppl    22.70 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 16.94s | valid loss  4.18 | valid ppl    65.28 | valid bpc    6.029
-----------------------------------------------------------------------------------------
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  216 batches | lr 0.00000 | ms/batch 77.12 | loss  3.15 | ppl    23.32 
| epoch  58 |   200/  216 batches | lr 0.00000 | ms/batch 75.49 | loss  3.14 | ppl    23.18 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 16.95s | valid loss  4.20 | valid ppl    66.99 | valid bpc    6.066
-----------------------------------------------------------------------------------------
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  216 batches | lr 0.00000 | ms/batch 77.11 | loss  3.17 | ppl    23.78 
| epoch  59 |   200/  216 batches | lr 0.00000 | ms/batch 75.59 | loss  3.14 | ppl    23.21 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 16.96s | valid loss  4.21 | valid ppl    67.57 | valid bpc    6.078
-----------------------------------------------------------------------------------------
PROGRESS: 59.0%
| epoch  60 |   100/  216 batches | lr 0.00000 | ms/batch 76.70 | loss  3.17 | ppl    23.71 
| epoch  60 |   200/  216 batches | lr 0.00000 | ms/batch 75.92 | loss  3.13 | ppl    22.79 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 16.95s | valid loss  4.21 | valid ppl    67.42 | valid bpc    6.075
-----------------------------------------------------------------------------------------
PROGRESS: 60.0%
| epoch  61 |   100/  216 batches | lr 0.00000 | ms/batch 76.53 | loss  3.15 | ppl    23.43 
| epoch  61 |   200/  216 batches | lr 0.00000 | ms/batch 76.16 | loss  3.14 | ppl    23.11 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 16.97s | valid loss  4.20 | valid ppl    66.91 | valid bpc    6.064
-----------------------------------------------------------------------------------------
PROGRESS: 61.0%
| epoch  62 |   100/  216 batches | lr 0.00000 | ms/batch 77.09 | loss  3.14 | ppl    23.07 
| epoch  62 |   200/  216 batches | lr 0.00000 | ms/batch 75.65 | loss  3.14 | ppl    23.08 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 16.96s | valid loss  4.17 | valid ppl    64.89 | valid bpc    6.020
-----------------------------------------------------------------------------------------
PROGRESS: 62.0%
| epoch  63 |   100/  216 batches | lr 0.00000 | ms/batch 76.72 | loss  3.15 | ppl    23.26 
| epoch  63 |   200/  216 batches | lr 0.00000 | ms/batch 75.72 | loss  3.12 | ppl    22.70 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 16.95s | valid loss  4.14 | valid ppl    62.71 | valid bpc    5.971
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 63.0%
| epoch  64 |   100/  216 batches | lr 0.00000 | ms/batch 76.75 | loss  3.13 | ppl    22.96 
| epoch  64 |   200/  216 batches | lr 0.00000 | ms/batch 75.87 | loss  3.14 | ppl    23.02 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 16.94s | valid loss  4.20 | valid ppl    66.67 | valid bpc    6.059
-----------------------------------------------------------------------------------------
PROGRESS: 64.0%
| epoch  65 |   100/  216 batches | lr 0.00000 | ms/batch 76.53 | loss  3.17 | ppl    23.77 
| epoch  65 |   200/  216 batches | lr 0.00000 | ms/batch 75.88 | loss  3.13 | ppl    22.90 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 16.95s | valid loss  4.17 | valid ppl    64.59 | valid bpc    6.013
-----------------------------------------------------------------------------------------
PROGRESS: 65.0%
| epoch  66 |   100/  216 batches | lr 0.00000 | ms/batch 77.23 | loss  3.16 | ppl    23.48 
| epoch  66 |   200/  216 batches | lr 0.00000 | ms/batch 75.54 | loss  3.13 | ppl    22.93 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 16.96s | valid loss  4.18 | valid ppl    65.49 | valid bpc    6.033
-----------------------------------------------------------------------------------------
PROGRESS: 66.0%
| epoch  67 |   100/  216 batches | lr 0.00000 | ms/batch 76.94 | loss  3.18 | ppl    24.01 
| epoch  67 |   200/  216 batches | lr 0.00000 | ms/batch 75.54 | loss  3.11 | ppl    22.33 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 16.94s | valid loss  4.19 | valid ppl    65.77 | valid bpc    6.039
-----------------------------------------------------------------------------------------
PROGRESS: 67.0%
| epoch  68 |   100/  216 batches | lr 0.00000 | ms/batch 76.71 | loss  3.16 | ppl    23.66 
| epoch  68 |   200/  216 batches | lr 0.00000 | ms/batch 75.85 | loss  3.11 | ppl    22.52 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 16.94s | valid loss  4.20 | valid ppl    66.36 | valid bpc    6.052
-----------------------------------------------------------------------------------------
PROGRESS: 68.0%
| epoch  69 |   100/  216 batches | lr 0.00000 | ms/batch 77.07 | loss  3.15 | ppl    23.23 
| epoch  69 |   200/  216 batches | lr 0.00000 | ms/batch 75.48 | loss  3.15 | ppl    23.23 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 16.94s | valid loss  4.17 | valid ppl    64.90 | valid bpc    6.020
-----------------------------------------------------------------------------------------
PROGRESS: 69.0%
| epoch  70 |   100/  216 batches | lr 0.00000 | ms/batch 76.93 | loss  3.18 | ppl    24.04 
| epoch  70 |   200/  216 batches | lr 0.00000 | ms/batch 75.69 | loss  3.11 | ppl    22.38 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 16.94s | valid loss  4.20 | valid ppl    66.66 | valid bpc    6.059
-----------------------------------------------------------------------------------------
PROGRESS: 70.0%
| epoch  71 |   100/  216 batches | lr 0.00000 | ms/batch 76.66 | loss  3.13 | ppl    22.82 
| epoch  71 |   200/  216 batches | lr 0.00000 | ms/batch 75.90 | loss  3.14 | ppl    23.13 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 16.95s | valid loss  4.20 | valid ppl    66.88 | valid bpc    6.063
-----------------------------------------------------------------------------------------
PROGRESS: 71.0%
| epoch  72 |   100/  216 batches | lr 0.00000 | ms/batch 76.96 | loss  3.17 | ppl    23.84 
| epoch  72 |   200/  216 batches | lr 0.00000 | ms/batch 75.54 | loss  3.12 | ppl    22.70 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 16.94s | valid loss  4.17 | valid ppl    64.71 | valid bpc    6.016
-----------------------------------------------------------------------------------------
PROGRESS: 72.0%
| epoch  73 |   100/  216 batches | lr 0.00000 | ms/batch 76.87 | loss  3.15 | ppl    23.37 
| epoch  73 |   200/  216 batches | lr 0.00000 | ms/batch 75.79 | loss  3.12 | ppl    22.53 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 16.95s | valid loss  4.20 | valid ppl    66.58 | valid bpc    6.057
-----------------------------------------------------------------------------------------
PROGRESS: 73.0%
| epoch  74 |   100/  216 batches | lr 0.00000 | ms/batch 77.31 | loss  3.17 | ppl    23.87 
| epoch  74 |   200/  216 batches | lr 0.00000 | ms/batch 75.27 | loss  3.13 | ppl    22.78 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 16.94s | valid loss  4.20 | valid ppl    66.63 | valid bpc    6.058
-----------------------------------------------------------------------------------------
PROGRESS: 74.0%
| epoch  75 |   100/  216 batches | lr 0.00000 | ms/batch 77.22 | loss  3.14 | ppl    23.11 
| epoch  75 |   200/  216 batches | lr 0.00000 | ms/batch 75.40 | loss  3.13 | ppl    22.81 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 16.96s | valid loss  4.20 | valid ppl    66.58 | valid bpc    6.057
-----------------------------------------------------------------------------------------
PROGRESS: 75.0%
| epoch  76 |   100/  216 batches | lr 0.00000 | ms/batch 76.86 | loss  3.15 | ppl    23.45 
| epoch  76 |   200/  216 batches | lr 0.00000 | ms/batch 75.77 | loss  3.12 | ppl    22.57 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 16.94s | valid loss  4.17 | valid ppl    64.84 | valid bpc    6.019
-----------------------------------------------------------------------------------------
PROGRESS: 76.0%
| epoch  77 |   100/  216 batches | lr 0.00000 | ms/batch 76.54 | loss  3.15 | ppl    23.24 
| epoch  77 |   200/  216 batches | lr 0.00000 | ms/batch 75.83 | loss  3.12 | ppl    22.58 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 16.94s | valid loss  4.19 | valid ppl    65.71 | valid bpc    6.038
-----------------------------------------------------------------------------------------
PROGRESS: 77.0%
| epoch  78 |   100/  216 batches | lr 0.00000 | ms/batch 76.91 | loss  3.16 | ppl    23.67 
| epoch  78 |   200/  216 batches | lr 0.00000 | ms/batch 75.63 | loss  3.12 | ppl    22.62 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 16.94s | valid loss  4.17 | valid ppl    64.54 | valid bpc    6.012
-----------------------------------------------------------------------------------------
PROGRESS: 78.0%
| epoch  79 |   100/  216 batches | lr 0.00000 | ms/batch 76.75 | loss  3.15 | ppl    23.33 
| epoch  79 |   200/  216 batches | lr 0.00000 | ms/batch 75.31 | loss  3.11 | ppl    22.45 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 16.95s | valid loss  4.20 | valid ppl    66.74 | valid bpc    6.060
-----------------------------------------------------------------------------------------
PROGRESS: 79.0%
| epoch  80 |   100/  216 batches | lr 0.00000 | ms/batch 76.79 | loss  3.14 | ppl    23.15 
| epoch  80 |   200/  216 batches | lr 0.00000 | ms/batch 75.82 | loss  3.13 | ppl    22.86 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 16.95s | valid loss  4.15 | valid ppl    63.63 | valid bpc    5.992
-----------------------------------------------------------------------------------------
PROGRESS: 80.0%
| epoch  81 |   100/  216 batches | lr 0.00000 | ms/batch 76.72 | loss  3.17 | ppl    23.81 
| epoch  81 |   200/  216 batches | lr 0.00000 | ms/batch 75.86 | loss  3.10 | ppl    22.29 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 16.95s | valid loss  4.17 | valid ppl    64.78 | valid bpc    6.018
-----------------------------------------------------------------------------------------
PROGRESS: 81.0%
| epoch  82 |   100/  216 batches | lr 0.00000 | ms/batch 76.80 | loss  3.16 | ppl    23.52 
| epoch  82 |   200/  216 batches | lr 0.00000 | ms/batch 75.83 | loss  3.13 | ppl    22.98 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 16.96s | valid loss  4.19 | valid ppl    65.76 | valid bpc    6.039
-----------------------------------------------------------------------------------------
PROGRESS: 82.0%
| epoch  83 |   100/  216 batches | lr 0.00000 | ms/batch 76.79 | loss  3.14 | ppl    23.10 
| epoch  83 |   200/  216 batches | lr 0.00000 | ms/batch 75.92 | loss  3.14 | ppl    23.00 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 16.95s | valid loss  4.18 | valid ppl    65.61 | valid bpc    6.036
-----------------------------------------------------------------------------------------
PROGRESS: 83.0%
| epoch  84 |   100/  216 batches | lr 0.00000 | ms/batch 76.47 | loss  3.17 | ppl    23.75 
| epoch  84 |   200/  216 batches | lr 0.00000 | ms/batch 76.04 | loss  3.12 | ppl    22.76 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 16.94s | valid loss  4.22 | valid ppl    68.26 | valid bpc    6.093
-----------------------------------------------------------------------------------------
PROGRESS: 84.0%
| epoch  85 |   100/  216 batches | lr 0.00000 | ms/batch 76.82 | loss  3.15 | ppl    23.24 
| epoch  85 |   200/  216 batches | lr 0.00000 | ms/batch 75.67 | loss  3.13 | ppl    22.97 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 16.95s | valid loss  4.20 | valid ppl    66.94 | valid bpc    6.065
-----------------------------------------------------------------------------------------
PROGRESS: 85.0%
| epoch  86 |   100/  216 batches | lr 0.00000 | ms/batch 76.52 | loss  3.15 | ppl    23.30 
| epoch  86 |   200/  216 batches | lr 0.00000 | ms/batch 75.75 | loss  3.13 | ppl    22.89 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 16.94s | valid loss  4.18 | valid ppl    65.09 | valid bpc    6.024
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  216 batches | lr 0.00000 | ms/batch 77.15 | loss  3.16 | ppl    23.62 
| epoch  87 |   200/  216 batches | lr 0.00000 | ms/batch 75.41 | loss  3.12 | ppl    22.65 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 16.94s | valid loss  4.15 | valid ppl    63.19 | valid bpc    5.982
-----------------------------------------------------------------------------------------
PROGRESS: 87.0%
| epoch  88 |   100/  216 batches | lr 0.00000 | ms/batch 77.09 | loss  3.17 | ppl    23.76 
| epoch  88 |   200/  216 batches | lr 0.00000 | ms/batch 75.52 | loss  3.11 | ppl    22.41 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 16.95s | valid loss  4.21 | valid ppl    67.27 | valid bpc    6.072
-----------------------------------------------------------------------------------------
PROGRESS: 88.0%
| epoch  89 |   100/  216 batches | lr 0.00000 | ms/batch 76.71 | loss  3.16 | ppl    23.65 
| epoch  89 |   200/  216 batches | lr 0.00000 | ms/batch 75.80 | loss  3.11 | ppl    22.36 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 16.94s | valid loss  4.19 | valid ppl    65.93 | valid bpc    6.043
-----------------------------------------------------------------------------------------
PROGRESS: 89.0%
| epoch  90 |   100/  216 batches | lr 0.00000 | ms/batch 77.10 | loss  3.15 | ppl    23.45 
| epoch  90 |   200/  216 batches | lr 0.00000 | ms/batch 75.70 | loss  3.12 | ppl    22.63 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 16.97s | valid loss  4.16 | valid ppl    63.96 | valid bpc    5.999
-----------------------------------------------------------------------------------------
PROGRESS: 90.0%
| epoch  91 |   100/  216 batches | lr 0.00000 | ms/batch 77.00 | loss  3.17 | ppl    23.88 
| epoch  91 |   200/  216 batches | lr 0.00000 | ms/batch 75.52 | loss  3.12 | ppl    22.73 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 16.94s | valid loss  4.13 | valid ppl    62.34 | valid bpc    5.962
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 91.0%
| epoch  92 |   100/  216 batches | lr 0.00000 | ms/batch 76.72 | loss  3.15 | ppl    23.37 
| epoch  92 |   200/  216 batches | lr 0.00000 | ms/batch 75.91 | loss  3.12 | ppl    22.56 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 16.94s | valid loss  4.20 | valid ppl    66.37 | valid bpc    6.052
-----------------------------------------------------------------------------------------
PROGRESS: 92.0%
| epoch  93 |   100/  216 batches | lr 0.00000 | ms/batch 77.02 | loss  3.16 | ppl    23.59 
| epoch  93 |   200/  216 batches | lr 0.00000 | ms/batch 75.62 | loss  3.11 | ppl    22.50 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 16.94s | valid loss  4.17 | valid ppl    64.41 | valid bpc    6.009
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  216 batches | lr 0.00000 | ms/batch 76.85 | loss  3.12 | ppl    22.64 
| epoch  94 |   200/  216 batches | lr 0.00000 | ms/batch 75.49 | loss  3.15 | ppl    23.30 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 16.93s | valid loss  4.16 | valid ppl    64.07 | valid bpc    6.001
-----------------------------------------------------------------------------------------
PROGRESS: 94.0%
| epoch  95 |   100/  216 batches | lr 0.00000 | ms/batch 76.59 | loss  3.16 | ppl    23.50 
| epoch  95 |   200/  216 batches | lr 0.00000 | ms/batch 76.04 | loss  3.13 | ppl    22.86 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 16.94s | valid loss  4.18 | valid ppl    65.40 | valid bpc    6.031
-----------------------------------------------------------------------------------------
PROGRESS: 95.0%
| epoch  96 |   100/  216 batches | lr 0.00000 | ms/batch 76.50 | loss  3.15 | ppl    23.29 
| epoch  96 |   200/  216 batches | lr 0.00000 | ms/batch 76.07 | loss  3.12 | ppl    22.59 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 16.94s | valid loss  4.21 | valid ppl    67.67 | valid bpc    6.080
-----------------------------------------------------------------------------------------
PROGRESS: 96.0%
| epoch  97 |   100/  216 batches | lr 0.00000 | ms/batch 76.92 | loss  3.15 | ppl    23.22 
| epoch  97 |   200/  216 batches | lr 0.00000 | ms/batch 75.53 | loss  3.12 | ppl    22.67 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 16.93s | valid loss  4.17 | valid ppl    64.85 | valid bpc    6.019
-----------------------------------------------------------------------------------------
PROGRESS: 97.0%
| epoch  98 |   100/  216 batches | lr 0.00000 | ms/batch 77.32 | loss  3.15 | ppl    23.41 
| epoch  98 |   200/  216 batches | lr 0.00000 | ms/batch 75.37 | loss  3.13 | ppl    22.83 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 16.95s | valid loss  4.16 | valid ppl    63.80 | valid bpc    5.995
-----------------------------------------------------------------------------------------
PROGRESS: 98.0%
| epoch  99 |   100/  216 batches | lr 0.00000 | ms/batch 76.78 | loss  3.14 | ppl    23.08 
| epoch  99 |   200/  216 batches | lr 0.00000 | ms/batch 76.08 | loss  3.12 | ppl    22.62 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 16.96s | valid loss  4.18 | valid ppl    65.67 | valid bpc    6.037
-----------------------------------------------------------------------------------------
PROGRESS: 99.0%
| epoch 100 |   100/  216 batches | lr 0.00000 | ms/batch 76.78 | loss  3.12 | ppl    22.64 
| epoch 100 |   200/  216 batches | lr 0.00000 | ms/batch 75.80 | loss  3.14 | ppl    23.04 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 16.94s | valid loss  4.14 | valid ppl    63.07 | valid bpc    5.979
-----------------------------------------------------------------------------------------
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  4.14 | test ppl    62.65 | test bpc    5.969
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.5036, Mean Reca: 0.6905, Mean F1: 0.5739
Counter({'NP': 10320, 'VP': 4442, 'PP': 4241, 'S': 3844, 'SBAR': 1040, 'ADJP': 305, 'QP': 276, 'ADVP': 165, 'SINV': 149, 'PRN': 64, 'NX': 44, 'FRAG': 33, 'WHNP': 26, 'SQ': 16, 'NAC': 12, 'UCP': 9, 'SBARQ': 8, 'CONJP': 3, 'X': 3, 'WHADVP': 1})
Counter({'NP': 14432, 'VP': 8130, 'S': 5620, 'PP': 5484, 'SBAR': 1796, 'ADJP': 649, 'QP': 490, 'ADVP': 286, 'SINV': 157, 'PRN': 128, 'NX': 95, 'FRAG': 42, 'WHNP': 37, 'UCP': 32, 'NAC': 30, 'WHPP': 25, 'CONJP': 21, 'SQ': 18, 'SBARQ': 10, 'WHADVP': 9, 'X': 6, 'WHADJP': 4, 'INTJ': 1})
SBAR: 0.5791
NP: 0.7151
VP: 0.5464
PP: 0.7733
ADJP: 0.4700
ADVP: 0.5769
5.21577347609597
-----------------------------------------------------------------------------------------
Dependency parsing performance:
Conll-U Style:
DDA: 0.068
UDA: 0.343
=========================================================================================
Loading dataset...
Loading dictionary...
Number of tokens:  10001
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer_in_parser', nhid=512, nlayers=8, front_layers=5, rear_layers=3, n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=3333, nonmono=5, cuda=True, log_interval=100, save='trained_models/structformer_in_parser_3333_53.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 38475589
Model architecture: StructFormer_In_Parser(
  (transformer_front): Transformer_Front(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(10001, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-4): 5 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
  (transformer_rear): Transformer_Rear(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(10001, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-2): 3 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (output_layer): Linear(in_features=512, out_features=10001, bias=True)
  )
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  216 batches | lr 0.00030 | ms/batch 79.13 | loss  7.27 | ppl  1431.70 
| epoch   1 |   200/  216 batches | lr 0.00030 | ms/batch 75.04 | loss  6.86 | ppl   953.87 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 17.12s | valid loss  6.67 | valid ppl   789.11 | valid bpc    9.624
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  216 batches | lr 0.00030 | ms/batch 75.98 | loss  6.75 | ppl   854.96 
| epoch   2 |   200/  216 batches | lr 0.00030 | ms/batch 75.45 | loss  6.44 | ppl   625.59 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 16.83s | valid loss  6.21 | valid ppl   498.19 | valid bpc    8.961
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  216 batches | lr 0.00030 | ms/batch 76.39 | loss  6.21 | ppl   496.82 
| epoch   3 |   200/  216 batches | lr 0.00030 | ms/batch 75.57 | loss  5.95 | ppl   384.57 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 16.88s | valid loss  5.77 | valid ppl   321.06 | valid bpc    8.327
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  216 batches | lr 0.00030 | ms/batch 76.79 | loss  5.79 | ppl   327.31 
| epoch   4 |   200/  216 batches | lr 0.00030 | ms/batch 75.46 | loss  5.62 | ppl   274.62 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 16.91s | valid loss  5.53 | valid ppl   252.59 | valid bpc    7.981
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  216 batches | lr 0.00030 | ms/batch 76.99 | loss  5.51 | ppl   246.85 
| epoch   5 |   200/  216 batches | lr 0.00030 | ms/batch 75.30 | loss  5.38 | ppl   216.41 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 16.91s | valid loss  5.32 | valid ppl   204.89 | valid bpc    7.679
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  216 batches | lr 0.00030 | ms/batch 76.51 | loss  5.31 | ppl   201.42 
| epoch   6 |   200/  216 batches | lr 0.00030 | ms/batch 75.93 | loss  5.22 | ppl   184.35 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 16.92s | valid loss  5.18 | valid ppl   178.42 | valid bpc    7.479
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  216 batches | lr 0.00030 | ms/batch 77.14 | loss  5.15 | ppl   172.61 
| epoch   7 |   200/  216 batches | lr 0.00030 | ms/batch 75.62 | loss  5.07 | ppl   158.56 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 16.96s | valid loss  5.05 | valid ppl   156.59 | valid bpc    7.291
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  216 batches | lr 0.00030 | ms/batch 77.00 | loss  5.02 | ppl   151.87 
| epoch   8 |   200/  216 batches | lr 0.00030 | ms/batch 75.61 | loss  4.94 | ppl   139.89 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 16.95s | valid loss  4.99 | valid ppl   147.31 | valid bpc    7.203
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 8.0%
| epoch   9 |   100/  216 batches | lr 0.00030 | ms/batch 77.11 | loss  4.91 | ppl   135.86 
| epoch   9 |   200/  216 batches | lr 0.00030 | ms/batch 75.46 | loss  4.85 | ppl   128.37 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 16.94s | valid loss  4.90 | valid ppl   133.99 | valid bpc    7.066
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  216 batches | lr 0.00030 | ms/batch 76.81 | loss  4.82 | ppl   123.88 
| epoch  10 |   200/  216 batches | lr 0.00030 | ms/batch 75.66 | loss  4.76 | ppl   117.06 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 16.94s | valid loss  4.85 | valid ppl   128.08 | valid bpc    7.001
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  216 batches | lr 0.00030 | ms/batch 76.58 | loss  4.72 | ppl   111.80 
| epoch  11 |   200/  216 batches | lr 0.00030 | ms/batch 75.88 | loss  4.65 | ppl   105.03 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 16.93s | valid loss  4.77 | valid ppl   117.36 | valid bpc    6.875
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  216 batches | lr 0.00030 | ms/batch 76.76 | loss  4.62 | ppl   101.60 
| epoch  12 |   200/  216 batches | lr 0.00030 | ms/batch 75.86 | loss  4.58 | ppl    97.76 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 16.95s | valid loss  4.65 | valid ppl   104.94 | valid bpc    6.713
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 12.0%
| epoch  13 |   100/  216 batches | lr 0.00030 | ms/batch 77.18 | loss  4.54 | ppl    93.32 
| epoch  13 |   200/  216 batches | lr 0.00030 | ms/batch 75.25 | loss  4.49 | ppl    89.10 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 16.94s | valid loss  4.65 | valid ppl   104.73 | valid bpc    6.711
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 13.0%
| epoch  14 |   100/  216 batches | lr 0.00030 | ms/batch 77.12 | loss  4.46 | ppl    86.13 
| epoch  14 |   200/  216 batches | lr 0.00030 | ms/batch 75.55 | loss  4.44 | ppl    84.51 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 16.95s | valid loss  4.63 | valid ppl   102.12 | valid bpc    6.674
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  216 batches | lr 0.00030 | ms/batch 76.80 | loss  4.42 | ppl    83.17 
| epoch  15 |   200/  216 batches | lr 0.00030 | ms/batch 75.77 | loss  4.38 | ppl    79.86 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 16.94s | valid loss  4.58 | valid ppl    97.70 | valid bpc    6.610
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 15.0%
| epoch  16 |   100/  216 batches | lr 0.00030 | ms/batch 76.81 | loss  4.34 | ppl    76.82 
| epoch  16 |   200/  216 batches | lr 0.00030 | ms/batch 75.74 | loss  4.29 | ppl    72.81 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 16.94s | valid loss  4.50 | valid ppl    89.78 | valid bpc    6.488
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 16.0%
| epoch  17 |   100/  216 batches | lr 0.00030 | ms/batch 76.82 | loss  4.25 | ppl    70.07 
| epoch  17 |   200/  216 batches | lr 0.00030 | ms/batch 75.63 | loss  4.25 | ppl    70.36 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 16.94s | valid loss  4.49 | valid ppl    89.45 | valid bpc    6.483
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 17.0%
| epoch  18 |   100/  216 batches | lr 0.00030 | ms/batch 76.52 | loss  4.18 | ppl    65.68 
| epoch  18 |   200/  216 batches | lr 0.00030 | ms/batch 76.02 | loss  4.17 | ppl    64.71 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 16.95s | valid loss  4.48 | valid ppl    87.85 | valid bpc    6.457
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 18.0%
| epoch  19 |   100/  216 batches | lr 0.00030 | ms/batch 77.07 | loss  4.14 | ppl    62.87 
| epoch  19 |   200/  216 batches | lr 0.00030 | ms/batch 75.36 | loss  4.10 | ppl    60.64 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 16.94s | valid loss  4.43 | valid ppl    83.89 | valid bpc    6.390
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 19.0%
| epoch  20 |   100/  216 batches | lr 0.00030 | ms/batch 76.87 | loss  4.06 | ppl    57.92 
| epoch  20 |   200/  216 batches | lr 0.00030 | ms/batch 75.35 | loss  4.07 | ppl    58.82 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 16.95s | valid loss  4.45 | valid ppl    85.38 | valid bpc    6.416
-----------------------------------------------------------------------------------------
PROGRESS: 20.0%
| epoch  21 |   100/  216 batches | lr 0.00030 | ms/batch 77.05 | loss  4.02 | ppl    55.95 
| epoch  21 |   200/  216 batches | lr 0.00030 | ms/batch 75.61 | loss  4.00 | ppl    54.42 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 16.95s | valid loss  4.38 | valid ppl    80.16 | valid bpc    6.325
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 21.0%
| epoch  22 |   100/  216 batches | lr 0.00030 | ms/batch 77.10 | loss  3.97 | ppl    52.72 
| epoch  22 |   200/  216 batches | lr 0.00030 | ms/batch 75.67 | loss  3.96 | ppl    52.26 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 16.95s | valid loss  4.39 | valid ppl    81.04 | valid bpc    6.341
-----------------------------------------------------------------------------------------
PROGRESS: 22.0%
| epoch  23 |   100/  216 batches | lr 0.00030 | ms/batch 76.96 | loss  3.93 | ppl    50.72 
| epoch  23 |   200/  216 batches | lr 0.00030 | ms/batch 75.60 | loss  3.92 | ppl    50.24 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 16.94s | valid loss  4.37 | valid ppl    78.74 | valid bpc    6.299
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 23.0%
| epoch  24 |   100/  216 batches | lr 0.00030 | ms/batch 77.02 | loss  3.86 | ppl    47.57 
| epoch  24 |   200/  216 batches | lr 0.00030 | ms/batch 75.61 | loss  3.87 | ppl    47.93 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 16.94s | valid loss  4.32 | valid ppl    75.40 | valid bpc    6.237
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 24.0%
| epoch  25 |   100/  216 batches | lr 0.00030 | ms/batch 76.61 | loss  3.83 | ppl    46.28 
| epoch  25 |   200/  216 batches | lr 0.00030 | ms/batch 75.79 | loss  3.81 | ppl    45.00 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 16.94s | valid loss  4.38 | valid ppl    79.58 | valid bpc    6.314
-----------------------------------------------------------------------------------------
PROGRESS: 25.0%
| epoch  26 |   100/  216 batches | lr 0.00030 | ms/batch 76.71 | loss  3.77 | ppl    43.44 
| epoch  26 |   200/  216 batches | lr 0.00030 | ms/batch 75.81 | loss  3.80 | ppl    44.50 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 16.94s | valid loss  4.35 | valid ppl    77.37 | valid bpc    6.274
-----------------------------------------------------------------------------------------
PROGRESS: 26.0%
| epoch  27 |   100/  216 batches | lr 0.00030 | ms/batch 76.55 | loss  3.76 | ppl    42.82 
| epoch  27 |   200/  216 batches | lr 0.00030 | ms/batch 76.18 | loss  3.74 | ppl    42.12 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 16.96s | valid loss  4.32 | valid ppl    75.14 | valid bpc    6.231
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 27.0%
| epoch  28 |   100/  216 batches | lr 0.00030 | ms/batch 76.76 | loss  3.71 | ppl    40.84 
| epoch  28 |   200/  216 batches | lr 0.00030 | ms/batch 75.73 | loss  3.69 | ppl    40.18 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 16.93s | valid loss  4.31 | valid ppl    74.19 | valid bpc    6.213
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  216 batches | lr 0.00030 | ms/batch 76.47 | loss  3.66 | ppl    38.82 
| epoch  29 |   200/  216 batches | lr 0.00030 | ms/batch 75.57 | loss  3.65 | ppl    38.64 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 16.93s | valid loss  4.28 | valid ppl    72.28 | valid bpc    6.175
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  216 batches | lr 0.00030 | ms/batch 76.96 | loss  3.62 | ppl    37.25 
| epoch  30 |   200/  216 batches | lr 0.00030 | ms/batch 75.51 | loss  3.59 | ppl    36.33 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 16.94s | valid loss  4.27 | valid ppl    71.64 | valid bpc    6.163
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 30.0%
| epoch  31 |   100/  216 batches | lr 0.00030 | ms/batch 76.52 | loss  3.58 | ppl    35.97 
| epoch  31 |   200/  216 batches | lr 0.00030 | ms/batch 75.95 | loss  3.58 | ppl    35.75 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 16.93s | valid loss  4.25 | valid ppl    69.81 | valid bpc    6.125
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 31.0%
| epoch  32 |   100/  216 batches | lr 0.00030 | ms/batch 76.52 | loss  3.53 | ppl    34.17 
| epoch  32 |   200/  216 batches | lr 0.00030 | ms/batch 75.90 | loss  3.54 | ppl    34.47 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 16.92s | valid loss  4.27 | valid ppl    71.21 | valid bpc    6.154
-----------------------------------------------------------------------------------------
PROGRESS: 32.0%
| epoch  33 |   100/  216 batches | lr 0.00030 | ms/batch 76.58 | loss  3.51 | ppl    33.31 
| epoch  33 |   200/  216 batches | lr 0.00030 | ms/batch 75.67 | loss  3.52 | ppl    33.87 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 16.94s | valid loss  4.27 | valid ppl    71.46 | valid bpc    6.159
-----------------------------------------------------------------------------------------
PROGRESS: 33.0%
| epoch  34 |   100/  216 batches | lr 0.00030 | ms/batch 76.75 | loss  3.48 | ppl    32.36 
| epoch  34 |   200/  216 batches | lr 0.00030 | ms/batch 75.67 | loss  3.46 | ppl    31.94 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 16.94s | valid loss  4.26 | valid ppl    70.83 | valid bpc    6.146
-----------------------------------------------------------------------------------------
PROGRESS: 34.0%
| epoch  35 |   100/  216 batches | lr 0.00015 | ms/batch 76.74 | loss  3.38 | ppl    29.40 
| epoch  35 |   200/  216 batches | lr 0.00015 | ms/batch 75.70 | loss  3.35 | ppl    28.52 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 16.94s | valid loss  4.20 | valid ppl    66.62 | valid bpc    6.058
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 35.0%
| epoch  36 |   100/  216 batches | lr 0.00015 | ms/batch 76.98 | loss  3.32 | ppl    27.79 
| epoch  36 |   200/  216 batches | lr 0.00015 | ms/batch 75.67 | loss  3.30 | ppl    27.18 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 16.94s | valid loss  4.20 | valid ppl    66.52 | valid bpc    6.056
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 36.0%
| epoch  37 |   100/  216 batches | lr 0.00015 | ms/batch 76.71 | loss  3.30 | ppl    27.14 
| epoch  37 |   200/  216 batches | lr 0.00015 | ms/batch 75.71 | loss  3.28 | ppl    26.48 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 16.93s | valid loss  4.22 | valid ppl    67.86 | valid bpc    6.084
-----------------------------------------------------------------------------------------
PROGRESS: 37.0%
| epoch  38 |   100/  216 batches | lr 0.00015 | ms/batch 76.76 | loss  3.27 | ppl    26.32 
| epoch  38 |   200/  216 batches | lr 0.00015 | ms/batch 75.65 | loss  3.25 | ppl    25.81 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 16.94s | valid loss  4.21 | valid ppl    67.05 | valid bpc    6.067
-----------------------------------------------------------------------------------------
PROGRESS: 38.0%
| epoch  39 |   100/  216 batches | lr 0.00015 | ms/batch 76.90 | loss  3.24 | ppl    25.55 
| epoch  39 |   200/  216 batches | lr 0.00015 | ms/batch 75.48 | loss  3.23 | ppl    25.30 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 16.94s | valid loss  4.22 | valid ppl    67.97 | valid bpc    6.087
-----------------------------------------------------------------------------------------
PROGRESS: 39.0%
| epoch  40 |   100/  216 batches | lr 0.00007 | ms/batch 76.94 | loss  3.20 | ppl    24.52 
| epoch  40 |   200/  216 batches | lr 0.00007 | ms/batch 75.69 | loss  3.15 | ppl    23.30 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 16.95s | valid loss  4.20 | valid ppl    66.74 | valid bpc    6.060
-----------------------------------------------------------------------------------------
PROGRESS: 40.0%
| epoch  41 |   100/  216 batches | lr 0.00007 | ms/batch 76.97 | loss  3.18 | ppl    23.97 
| epoch  41 |   200/  216 batches | lr 0.00007 | ms/batch 75.53 | loss  3.14 | ppl    23.05 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 16.95s | valid loss  4.24 | valid ppl    69.09 | valid bpc    6.110
-----------------------------------------------------------------------------------------
PROGRESS: 41.0%
| epoch  42 |   100/  216 batches | lr 0.00007 | ms/batch 77.21 | loss  3.16 | ppl    23.58 
| epoch  42 |   200/  216 batches | lr 0.00007 | ms/batch 75.41 | loss  3.11 | ppl    22.35 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 16.95s | valid loss  4.17 | valid ppl    64.93 | valid bpc    6.021
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 42.0%
| epoch  43 |   100/  216 batches | lr 0.00007 | ms/batch 76.47 | loss  3.15 | ppl    23.22 
| epoch  43 |   200/  216 batches | lr 0.00007 | ms/batch 76.03 | loss  3.09 | ppl    21.91 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 16.94s | valid loss  4.20 | valid ppl    66.68 | valid bpc    6.059
-----------------------------------------------------------------------------------------
PROGRESS: 43.0%
| epoch  44 |   100/  216 batches | lr 0.00007 | ms/batch 76.74 | loss  3.10 | ppl    22.30 
| epoch  44 |   200/  216 batches | lr 0.00007 | ms/batch 75.49 | loss  3.11 | ppl    22.48 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 16.95s | valid loss  4.20 | valid ppl    66.90 | valid bpc    6.064
-----------------------------------------------------------------------------------------
PROGRESS: 44.0%
| epoch  45 |   100/  216 batches | lr 0.00007 | ms/batch 76.90 | loss  3.12 | ppl    22.61 
| epoch  45 |   200/  216 batches | lr 0.00007 | ms/batch 75.34 | loss  3.07 | ppl    21.52 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 16.94s | valid loss  4.16 | valid ppl    64.38 | valid bpc    6.009
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 45.0%
| epoch  46 |   100/  216 batches | lr 0.00007 | ms/batch 76.92 | loss  3.10 | ppl    22.14 
| epoch  46 |   200/  216 batches | lr 0.00007 | ms/batch 75.58 | loss  3.04 | ppl    20.88 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 16.94s | valid loss  4.21 | valid ppl    67.26 | valid bpc    6.072
-----------------------------------------------------------------------------------------
PROGRESS: 46.0%
| epoch  47 |   100/  216 batches | lr 0.00007 | ms/batch 76.58 | loss  3.08 | ppl    21.76 
| epoch  47 |   200/  216 batches | lr 0.00007 | ms/batch 76.13 | loss  3.07 | ppl    21.46 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 16.95s | valid loss  4.17 | valid ppl    64.52 | valid bpc    6.012
-----------------------------------------------------------------------------------------
PROGRESS: 47.0%
| epoch  48 |   100/  216 batches | lr 0.00007 | ms/batch 77.07 | loss  3.05 | ppl    21.16 
| epoch  48 |   200/  216 batches | lr 0.00007 | ms/batch 75.51 | loss  3.03 | ppl    20.76 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 16.95s | valid loss  4.18 | valid ppl    65.58 | valid bpc    6.035
-----------------------------------------------------------------------------------------
PROGRESS: 48.0%
| epoch  49 |   100/  216 batches | lr 0.00004 | ms/batch 76.69 | loss  3.03 | ppl    20.68 
| epoch  49 |   200/  216 batches | lr 0.00004 | ms/batch 75.85 | loss  3.01 | ppl    20.29 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 16.94s | valid loss  4.22 | valid ppl    67.90 | valid bpc    6.085
-----------------------------------------------------------------------------------------
PROGRESS: 49.0%
| epoch  50 |   100/  216 batches | lr 0.00004 | ms/batch 77.04 | loss  3.00 | ppl    20.11 
| epoch  50 |   200/  216 batches | lr 0.00004 | ms/batch 75.49 | loss  2.99 | ppl    19.86 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 16.95s | valid loss  4.17 | valid ppl    64.94 | valid bpc    6.021
-----------------------------------------------------------------------------------------
PROGRESS: 50.0%
| epoch  51 |   100/  216 batches | lr 0.00004 | ms/batch 76.60 | loss  3.00 | ppl    20.00 
| epoch  51 |   200/  216 batches | lr 0.00004 | ms/batch 76.00 | loss  2.98 | ppl    19.71 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 16.95s | valid loss  4.18 | valid ppl    65.50 | valid bpc    6.033
-----------------------------------------------------------------------------------------
PROGRESS: 51.0%
| epoch  52 |   100/  216 batches | lr 0.00002 | ms/batch 77.11 | loss  3.01 | ppl    20.19 
| epoch  52 |   200/  216 batches | lr 0.00002 | ms/batch 75.46 | loss  2.95 | ppl    19.18 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 16.94s | valid loss  4.21 | valid ppl    67.51 | valid bpc    6.077
-----------------------------------------------------------------------------------------
PROGRESS: 52.0%
| epoch  53 |   100/  216 batches | lr 0.00002 | ms/batch 76.98 | loss  3.01 | ppl    20.20 
| epoch  53 |   200/  216 batches | lr 0.00002 | ms/batch 75.57 | loss  2.94 | ppl    18.89 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 16.94s | valid loss  4.17 | valid ppl    64.45 | valid bpc    6.010
-----------------------------------------------------------------------------------------
PROGRESS: 53.0%
| epoch  54 |   100/  216 batches | lr 0.00002 | ms/batch 77.02 | loss  2.98 | ppl    19.68 
| epoch  54 |   200/  216 batches | lr 0.00002 | ms/batch 75.61 | loss  2.97 | ppl    19.57 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 16.95s | valid loss  4.18 | valid ppl    65.58 | valid bpc    6.035
-----------------------------------------------------------------------------------------
PROGRESS: 54.0%
| epoch  55 |   100/  216 batches | lr 0.00001 | ms/batch 76.55 | loss  2.97 | ppl    19.42 
| epoch  55 |   200/  216 batches | lr 0.00001 | ms/batch 75.97 | loss  2.94 | ppl    18.96 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 16.95s | valid loss  4.21 | valid ppl    67.27 | valid bpc    6.072
-----------------------------------------------------------------------------------------
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  216 batches | lr 0.00001 | ms/batch 76.64 | loss  2.97 | ppl    19.45 
| epoch  56 |   200/  216 batches | lr 0.00001 | ms/batch 75.68 | loss  2.93 | ppl    18.77 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 16.96s | valid loss  4.19 | valid ppl    65.80 | valid bpc    6.040
-----------------------------------------------------------------------------------------
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  216 batches | lr 0.00001 | ms/batch 77.09 | loss  2.97 | ppl    19.57 
| epoch  57 |   200/  216 batches | lr 0.00001 | ms/batch 75.70 | loss  2.95 | ppl    19.08 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 16.96s | valid loss  4.18 | valid ppl    65.53 | valid bpc    6.034
-----------------------------------------------------------------------------------------
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  216 batches | lr 0.00000 | ms/batch 76.85 | loss  2.96 | ppl    19.32 
| epoch  58 |   200/  216 batches | lr 0.00000 | ms/batch 75.74 | loss  2.93 | ppl    18.68 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 16.95s | valid loss  4.19 | valid ppl    65.93 | valid bpc    6.043
-----------------------------------------------------------------------------------------
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  216 batches | lr 0.00000 | ms/batch 76.91 | loss  2.94 | ppl    19.00 
| epoch  59 |   200/  216 batches | lr 0.00000 | ms/batch 75.68 | loss  2.94 | ppl    19.00 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 16.95s | valid loss  4.13 | valid ppl    62.18 | valid bpc    5.958
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 59.0%
| epoch  60 |   100/  216 batches | lr 0.00000 | ms/batch 77.19 | loss  2.95 | ppl    19.05 
| epoch  60 |   200/  216 batches | lr 0.00000 | ms/batch 75.22 | loss  2.95 | ppl    19.06 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 16.94s | valid loss  4.16 | valid ppl    64.22 | valid bpc    6.005
-----------------------------------------------------------------------------------------
PROGRESS: 60.0%
| epoch  61 |   100/  216 batches | lr 0.00000 | ms/batch 76.68 | loss  2.96 | ppl    19.34 
| epoch  61 |   200/  216 batches | lr 0.00000 | ms/batch 75.80 | loss  2.93 | ppl    18.81 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 16.95s | valid loss  4.21 | valid ppl    67.07 | valid bpc    6.068
-----------------------------------------------------------------------------------------
PROGRESS: 61.0%
| epoch  62 |   100/  216 batches | lr 0.00000 | ms/batch 76.82 | loss  2.95 | ppl    19.17 
| epoch  62 |   200/  216 batches | lr 0.00000 | ms/batch 75.95 | loss  2.94 | ppl    18.83 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 16.96s | valid loss  4.21 | valid ppl    67.54 | valid bpc    6.078
-----------------------------------------------------------------------------------------
PROGRESS: 62.0%
| epoch  63 |   100/  216 batches | lr 0.00000 | ms/batch 76.78 | loss  2.99 | ppl    19.94 
| epoch  63 |   200/  216 batches | lr 0.00000 | ms/batch 75.86 | loss  2.92 | ppl    18.57 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 16.95s | valid loss  4.21 | valid ppl    67.52 | valid bpc    6.077
-----------------------------------------------------------------------------------------
PROGRESS: 63.0%
| epoch  64 |   100/  216 batches | lr 0.00000 | ms/batch 76.75 | loss  2.95 | ppl    19.09 
| epoch  64 |   200/  216 batches | lr 0.00000 | ms/batch 75.53 | loss  2.95 | ppl    19.08 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 16.95s | valid loss  4.20 | valid ppl    66.58 | valid bpc    6.057
-----------------------------------------------------------------------------------------
PROGRESS: 64.0%
| epoch  65 |   100/  216 batches | lr 0.00000 | ms/batch 77.06 | loss  2.96 | ppl    19.38 
| epoch  65 |   200/  216 batches | lr 0.00000 | ms/batch 75.49 | loss  2.93 | ppl    18.79 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 16.96s | valid loss  4.21 | valid ppl    67.29 | valid bpc    6.072
-----------------------------------------------------------------------------------------
PROGRESS: 65.0%
| epoch  66 |   100/  216 batches | lr 0.00000 | ms/batch 76.51 | loss  2.96 | ppl    19.34 
| epoch  66 |   200/  216 batches | lr 0.00000 | ms/batch 76.09 | loss  2.91 | ppl    18.31 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 16.95s | valid loss  4.23 | valid ppl    69.03 | valid bpc    6.109
-----------------------------------------------------------------------------------------
PROGRESS: 66.0%
| epoch  67 |   100/  216 batches | lr 0.00000 | ms/batch 76.60 | loss  2.95 | ppl    19.07 
| epoch  67 |   200/  216 batches | lr 0.00000 | ms/batch 76.25 | loss  2.93 | ppl    18.66 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 16.97s | valid loss  4.16 | valid ppl    64.01 | valid bpc    6.000
-----------------------------------------------------------------------------------------
PROGRESS: 67.0%
| epoch  68 |   100/  216 batches | lr 0.00000 | ms/batch 76.59 | loss  2.96 | ppl    19.33 
| epoch  68 |   200/  216 batches | lr 0.00000 | ms/batch 75.92 | loss  2.92 | ppl    18.60 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 16.95s | valid loss  4.17 | valid ppl    64.68 | valid bpc    6.015
-----------------------------------------------------------------------------------------
PROGRESS: 68.0%
| epoch  69 |   100/  216 batches | lr 0.00000 | ms/batch 76.94 | loss  2.95 | ppl    19.17 
| epoch  69 |   200/  216 batches | lr 0.00000 | ms/batch 75.66 | loss  2.92 | ppl    18.54 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 16.94s | valid loss  4.24 | valid ppl    69.23 | valid bpc    6.113
-----------------------------------------------------------------------------------------
PROGRESS: 69.0%
| epoch  70 |   100/  216 batches | lr 0.00000 | ms/batch 77.06 | loss  2.98 | ppl    19.60 
| epoch  70 |   200/  216 batches | lr 0.00000 | ms/batch 75.59 | loss  2.91 | ppl    18.42 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 16.96s | valid loss  4.19 | valid ppl    66.12 | valid bpc    6.047
-----------------------------------------------------------------------------------------
PROGRESS: 70.0%
| epoch  71 |   100/  216 batches | lr 0.00000 | ms/batch 77.15 | loss  2.95 | ppl    19.18 
| epoch  71 |   200/  216 batches | lr 0.00000 | ms/batch 75.61 | loss  2.90 | ppl    18.21 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 16.96s | valid loss  4.20 | valid ppl    66.64 | valid bpc    6.058
-----------------------------------------------------------------------------------------
PROGRESS: 71.0%
| epoch  72 |   100/  216 batches | lr 0.00000 | ms/batch 76.56 | loss  2.95 | ppl    19.05 
| epoch  72 |   200/  216 batches | lr 0.00000 | ms/batch 75.96 | loss  2.92 | ppl    18.49 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 16.95s | valid loss  4.20 | valid ppl    66.92 | valid bpc    6.064
-----------------------------------------------------------------------------------------
PROGRESS: 72.0%
| epoch  73 |   100/  216 batches | lr 0.00000 | ms/batch 77.18 | loss  2.97 | ppl    19.42 
| epoch  73 |   200/  216 batches | lr 0.00000 | ms/batch 75.56 | loss  2.92 | ppl    18.52 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 16.95s | valid loss  4.19 | valid ppl    66.33 | valid bpc    6.052
-----------------------------------------------------------------------------------------
PROGRESS: 73.0%
| epoch  74 |   100/  216 batches | lr 0.00000 | ms/batch 77.31 | loss  2.96 | ppl    19.33 
| epoch  74 |   200/  216 batches | lr 0.00000 | ms/batch 75.42 | loss  2.91 | ppl    18.35 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 16.96s | valid loss  4.15 | valid ppl    63.74 | valid bpc    5.994
-----------------------------------------------------------------------------------------
PROGRESS: 74.0%
| epoch  75 |   100/  216 batches | lr 0.00000 | ms/batch 76.68 | loss  2.95 | ppl    19.15 
| epoch  75 |   200/  216 batches | lr 0.00000 | ms/batch 75.96 | loss  2.92 | ppl    18.49 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 16.95s | valid loss  4.21 | valid ppl    67.65 | valid bpc    6.080
-----------------------------------------------------------------------------------------
PROGRESS: 75.0%
| epoch  76 |   100/  216 batches | lr 0.00000 | ms/batch 77.07 | loss  2.96 | ppl    19.34 
| epoch  76 |   200/  216 batches | lr 0.00000 | ms/batch 75.52 | loss  2.92 | ppl    18.61 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 16.95s | valid loss  4.22 | valid ppl    67.72 | valid bpc    6.082
-----------------------------------------------------------------------------------------
PROGRESS: 76.0%
| epoch  77 |   100/  216 batches | lr 0.00000 | ms/batch 76.72 | loss  2.95 | ppl    19.15 
| epoch  77 |   200/  216 batches | lr 0.00000 | ms/batch 75.90 | loss  2.94 | ppl    18.98 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 16.95s | valid loss  4.20 | valid ppl    67.00 | valid bpc    6.066
-----------------------------------------------------------------------------------------
PROGRESS: 77.0%
| epoch  78 |   100/  216 batches | lr 0.00000 | ms/batch 77.12 | loss  2.96 | ppl    19.30 
| epoch  78 |   200/  216 batches | lr 0.00000 | ms/batch 75.62 | loss  2.94 | ppl    18.90 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 16.95s | valid loss  4.20 | valid ppl    66.57 | valid bpc    6.057
-----------------------------------------------------------------------------------------
PROGRESS: 78.0%
| epoch  79 |   100/  216 batches | lr 0.00000 | ms/batch 76.86 | loss  2.97 | ppl    19.52 
| epoch  79 |   200/  216 batches | lr 0.00000 | ms/batch 75.67 | loss  2.92 | ppl    18.52 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 16.94s | valid loss  4.19 | valid ppl    65.98 | valid bpc    6.044
-----------------------------------------------------------------------------------------
PROGRESS: 79.0%
| epoch  80 |   100/  216 batches | lr 0.00000 | ms/batch 76.99 | loss  2.95 | ppl    19.17 
| epoch  80 |   200/  216 batches | lr 0.00000 | ms/batch 75.63 | loss  2.93 | ppl    18.80 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 16.95s | valid loss  4.21 | valid ppl    67.13 | valid bpc    6.069
-----------------------------------------------------------------------------------------
PROGRESS: 80.0%
| epoch  81 |   100/  216 batches | lr 0.00000 | ms/batch 76.96 | loss  2.95 | ppl    19.11 
| epoch  81 |   200/  216 batches | lr 0.00000 | ms/batch 75.63 | loss  2.92 | ppl    18.63 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 16.94s | valid loss  4.15 | valid ppl    63.48 | valid bpc    5.988
-----------------------------------------------------------------------------------------
PROGRESS: 81.0%
| epoch  82 |   100/  216 batches | lr 0.00000 | ms/batch 76.72 | loss  2.94 | ppl    18.83 
| epoch  82 |   200/  216 batches | lr 0.00000 | ms/batch 75.92 | loss  2.94 | ppl    18.99 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 16.95s | valid loss  4.17 | valid ppl    64.94 | valid bpc    6.021
-----------------------------------------------------------------------------------------
PROGRESS: 82.0%
| epoch  83 |   100/  216 batches | lr 0.00000 | ms/batch 77.08 | loss  2.96 | ppl    19.22 
| epoch  83 |   200/  216 batches | lr 0.00000 | ms/batch 75.48 | loss  2.90 | ppl    18.16 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 16.95s | valid loss  4.17 | valid ppl    64.67 | valid bpc    6.015
-----------------------------------------------------------------------------------------
PROGRESS: 83.0%
| epoch  84 |   100/  216 batches | lr 0.00000 | ms/batch 76.71 | loss  2.95 | ppl    19.18 
| epoch  84 |   200/  216 batches | lr 0.00000 | ms/batch 75.97 | loss  2.92 | ppl    18.52 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 16.95s | valid loss  4.19 | valid ppl    66.31 | valid bpc    6.051
-----------------------------------------------------------------------------------------
PROGRESS: 84.0%
| epoch  85 |   100/  216 batches | lr 0.00000 | ms/batch 77.17 | loss  2.96 | ppl    19.37 
| epoch  85 |   200/  216 batches | lr 0.00000 | ms/batch 75.54 | loss  2.92 | ppl    18.54 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 16.95s | valid loss  4.21 | valid ppl    67.23 | valid bpc    6.071
-----------------------------------------------------------------------------------------
PROGRESS: 85.0%
| epoch  86 |   100/  216 batches | lr 0.00000 | ms/batch 76.57 | loss  2.93 | ppl    18.76 
| epoch  86 |   200/  216 batches | lr 0.00000 | ms/batch 76.08 | loss  2.93 | ppl    18.75 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 16.95s | valid loss  4.20 | valid ppl    66.77 | valid bpc    6.061
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  216 batches | lr 0.00000 | ms/batch 76.87 | loss  2.97 | ppl    19.45 
| epoch  87 |   200/  216 batches | lr 0.00000 | ms/batch 75.89 | loss  2.91 | ppl    18.43 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 16.97s | valid loss  4.17 | valid ppl    65.03 | valid bpc    6.023
-----------------------------------------------------------------------------------------
PROGRESS: 87.0%
| epoch  88 |   100/  216 batches | lr 0.00000 | ms/batch 77.08 | loss  2.96 | ppl    19.33 
| epoch  88 |   200/  216 batches | lr 0.00000 | ms/batch 75.44 | loss  2.91 | ppl    18.34 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 16.95s | valid loss  4.17 | valid ppl    64.83 | valid bpc    6.019
-----------------------------------------------------------------------------------------
PROGRESS: 88.0%
| epoch  89 |   100/  216 batches | lr 0.00000 | ms/batch 76.66 | loss  2.93 | ppl    18.81 
| epoch  89 |   200/  216 batches | lr 0.00000 | ms/batch 75.69 | loss  2.93 | ppl    18.80 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 16.96s | valid loss  4.16 | valid ppl    63.98 | valid bpc    5.999
-----------------------------------------------------------------------------------------
PROGRESS: 89.0%
| epoch  90 |   100/  216 batches | lr 0.00000 | ms/batch 76.90 | loss  2.93 | ppl    18.79 
| epoch  90 |   200/  216 batches | lr 0.00000 | ms/batch 75.71 | loss  2.93 | ppl    18.71 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 16.95s | valid loss  4.19 | valid ppl    65.73 | valid bpc    6.038
-----------------------------------------------------------------------------------------
PROGRESS: 90.0%
| epoch  91 |   100/  216 batches | lr 0.00000 | ms/batch 76.76 | loss  2.93 | ppl    18.78 
| epoch  91 |   200/  216 batches | lr 0.00000 | ms/batch 75.83 | loss  2.95 | ppl    19.03 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 16.95s | valid loss  4.18 | valid ppl    65.07 | valid bpc    6.024
-----------------------------------------------------------------------------------------
PROGRESS: 91.0%
| epoch  92 |   100/  216 batches | lr 0.00000 | ms/batch 77.10 | loss  2.96 | ppl    19.34 
| epoch  92 |   200/  216 batches | lr 0.00000 | ms/batch 75.39 | loss  2.92 | ppl    18.46 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 16.94s | valid loss  4.20 | valid ppl    66.36 | valid bpc    6.052
-----------------------------------------------------------------------------------------
PROGRESS: 92.0%
| epoch  93 |   100/  216 batches | lr 0.00000 | ms/batch 77.13 | loss  2.96 | ppl    19.39 
| epoch  93 |   200/  216 batches | lr 0.00000 | ms/batch 75.47 | loss  2.91 | ppl    18.29 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 16.95s | valid loss  4.21 | valid ppl    67.08 | valid bpc    6.068
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  216 batches | lr 0.00000 | ms/batch 76.89 | loss  2.94 | ppl    18.84 
| epoch  94 |   200/  216 batches | lr 0.00000 | ms/batch 75.79 | loss  2.94 | ppl    18.87 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 16.95s | valid loss  4.21 | valid ppl    67.07 | valid bpc    6.068
-----------------------------------------------------------------------------------------
PROGRESS: 94.0%
| epoch  95 |   100/  216 batches | lr 0.00000 | ms/batch 76.63 | loss  2.95 | ppl    19.07 
| epoch  95 |   200/  216 batches | lr 0.00000 | ms/batch 75.82 | loss  2.93 | ppl    18.73 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 16.95s | valid loss  4.18 | valid ppl    65.63 | valid bpc    6.036
-----------------------------------------------------------------------------------------
PROGRESS: 95.0%
| epoch  96 |   100/  216 batches | lr 0.00000 | ms/batch 77.21 | loss  2.97 | ppl    19.45 
| epoch  96 |   200/  216 batches | lr 0.00000 | ms/batch 75.43 | loss  2.93 | ppl    18.66 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 16.96s | valid loss  4.18 | valid ppl    65.23 | valid bpc    6.027
-----------------------------------------------------------------------------------------
PROGRESS: 96.0%
| epoch  97 |   100/  216 batches | lr 0.00000 | ms/batch 76.56 | loss  2.95 | ppl    19.11 
| epoch  97 |   200/  216 batches | lr 0.00000 | ms/batch 76.18 | loss  2.94 | ppl    18.94 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 16.96s | valid loss  4.15 | valid ppl    63.13 | valid bpc    5.980
-----------------------------------------------------------------------------------------
PROGRESS: 97.0%
| epoch  98 |   100/  216 batches | lr 0.00000 | ms/batch 77.00 | loss  2.95 | ppl    19.13 
| epoch  98 |   200/  216 batches | lr 0.00000 | ms/batch 75.55 | loss  2.93 | ppl    18.71 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 16.95s | valid loss  4.18 | valid ppl    65.29 | valid bpc    6.029
-----------------------------------------------------------------------------------------
PROGRESS: 98.0%
| epoch  99 |   100/  216 batches | lr 0.00000 | ms/batch 76.66 | loss  2.94 | ppl    18.99 
| epoch  99 |   200/  216 batches | lr 0.00000 | ms/batch 75.76 | loss  2.92 | ppl    18.49 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 16.96s | valid loss  4.17 | valid ppl    64.86 | valid bpc    6.019
-----------------------------------------------------------------------------------------
PROGRESS: 99.0%
| epoch 100 |   100/  216 batches | lr 0.00000 | ms/batch 76.81 | loss  2.94 | ppl    18.83 
| epoch 100 |   200/  216 batches | lr 0.00000 | ms/batch 75.93 | loss  2.92 | ppl    18.49 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 16.96s | valid loss  4.18 | valid ppl    65.66 | valid bpc    6.037
-----------------------------------------------------------------------------------------
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  4.12 | test ppl    61.41 | test bpc    5.940
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.4121, Mean Reca: 0.5685, Mean F1: 0.4696
Counter({'NP': 8453, 'PP': 4106, 'S': 3200, 'VP': 2979, 'SBAR': 473, 'ADJP': 283, 'QP': 275, 'ADVP': 162, 'SINV': 149, 'FRAG': 35, 'PRN': 34, 'WHNP': 28, 'NX': 13, 'NAC': 11, 'SQ': 11, 'UCP': 9, 'SBARQ': 8, 'WHPP': 6, 'CONJP': 4, 'X': 2})
Counter({'NP': 14432, 'VP': 8130, 'S': 5620, 'PP': 5484, 'SBAR': 1796, 'ADJP': 649, 'QP': 490, 'ADVP': 286, 'SINV': 157, 'PRN': 128, 'NX': 95, 'FRAG': 42, 'WHNP': 37, 'UCP': 32, 'NAC': 30, 'WHPP': 25, 'CONJP': 21, 'SQ': 18, 'SBARQ': 10, 'WHADVP': 9, 'X': 6, 'WHADJP': 4, 'INTJ': 1})
SBAR: 0.2634
NP: 0.5857
VP: 0.3664
PP: 0.7487
ADJP: 0.4361
ADVP: 0.5664
4.895721883846077
-----------------------------------------------------------------------------------------
Dependency parsing performance:
Conll-U Style:
DDA: 0.408
UDA: 0.552
=========================================================================================
Loading dataset...
Loading dictionary...
Number of tokens:  10001
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer_in_parser', nhid=512, nlayers=8, front_layers=5, rear_layers=3, n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=4444, nonmono=5, cuda=True, log_interval=100, save='trained_models/structformer_in_parser_4444_53.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 38475589
Model architecture: StructFormer_In_Parser(
  (transformer_front): Transformer_Front(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(10001, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-4): 5 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
  (transformer_rear): Transformer_Rear(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(10001, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-2): 3 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (output_layer): Linear(in_features=512, out_features=10001, bias=True)
  )
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  216 batches | lr 0.00030 | ms/batch 79.62 | loss  7.28 | ppl  1452.59 
| epoch   1 |   200/  216 batches | lr 0.00030 | ms/batch 74.78 | loss  6.84 | ppl   931.43 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 17.12s | valid loss  6.65 | valid ppl   770.81 | valid bpc    9.590
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  216 batches | lr 0.00030 | ms/batch 76.38 | loss  6.77 | ppl   873.78 
| epoch   2 |   200/  216 batches | lr 0.00030 | ms/batch 75.09 | loss  6.45 | ppl   635.28 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 16.83s | valid loss  6.25 | valid ppl   515.70 | valid bpc    9.010
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  216 batches | lr 0.00030 | ms/batch 76.63 | loss  6.26 | ppl   521.87 
| epoch   3 |   200/  216 batches | lr 0.00030 | ms/batch 75.47 | loss  5.99 | ppl   400.64 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 16.89s | valid loss  5.82 | valid ppl   338.41 | valid bpc    8.403
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  216 batches | lr 0.00030 | ms/batch 76.74 | loss  5.86 | ppl   351.31 
| epoch   4 |   200/  216 batches | lr 0.00030 | ms/batch 75.54 | loss  5.66 | ppl   286.20 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 16.91s | valid loss  5.57 | valid ppl   263.59 | valid bpc    8.042
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  216 batches | lr 0.00030 | ms/batch 76.88 | loss  5.58 | ppl   265.87 
| epoch   5 |   200/  216 batches | lr 0.00030 | ms/batch 75.50 | loss  5.44 | ppl   229.89 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 16.93s | valid loss  5.39 | valid ppl   220.06 | valid bpc    7.782
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  216 batches | lr 0.00030 | ms/batch 76.44 | loss  5.34 | ppl   209.30 
| epoch   6 |   200/  216 batches | lr 0.00030 | ms/batch 75.93 | loss  5.27 | ppl   195.26 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 16.93s | valid loss  5.22 | valid ppl   184.51 | valid bpc    7.528
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  216 batches | lr 0.00030 | ms/batch 77.16 | loss  5.23 | ppl   186.19 
| epoch   7 |   200/  216 batches | lr 0.00030 | ms/batch 75.28 | loss  5.09 | ppl   161.67 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 16.93s | valid loss  5.12 | valid ppl   168.00 | valid bpc    7.392
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  216 batches | lr 0.00030 | ms/batch 76.72 | loss  5.06 | ppl   158.05 
| epoch   8 |   200/  216 batches | lr 0.00030 | ms/batch 75.87 | loss  5.00 | ppl   148.18 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 16.94s | valid loss  5.02 | valid ppl   152.05 | valid bpc    7.248
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 8.0%
| epoch   9 |   100/  216 batches | lr 0.00030 | ms/batch 76.74 | loss  4.95 | ppl   141.06 
| epoch   9 |   200/  216 batches | lr 0.00030 | ms/batch 75.85 | loss  4.89 | ppl   132.76 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 16.94s | valid loss  4.97 | valid ppl   144.27 | valid bpc    7.173
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  216 batches | lr 0.00030 | ms/batch 76.45 | loss  4.84 | ppl   126.96 
| epoch  10 |   200/  216 batches | lr 0.00030 | ms/batch 76.06 | loss  4.78 | ppl   119.48 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 16.95s | valid loss  4.86 | valid ppl   129.15 | valid bpc    7.013
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  216 batches | lr 0.00030 | ms/batch 76.92 | loss  4.75 | ppl   116.11 
| epoch  11 |   200/  216 batches | lr 0.00030 | ms/batch 75.79 | loss  4.70 | ppl   109.59 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 16.95s | valid loss  4.80 | valid ppl   122.12 | valid bpc    6.932
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  216 batches | lr 0.00030 | ms/batch 76.83 | loss  4.67 | ppl   106.88 
| epoch  12 |   200/  216 batches | lr 0.00030 | ms/batch 75.57 | loss  4.62 | ppl   101.20 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 16.95s | valid loss  4.73 | valid ppl   112.90 | valid bpc    6.819
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 12.0%
| epoch  13 |   100/  216 batches | lr 0.00030 | ms/batch 77.14 | loss  4.60 | ppl    99.42 
| epoch  13 |   200/  216 batches | lr 0.00030 | ms/batch 75.38 | loss  4.53 | ppl    92.88 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 16.94s | valid loss  4.67 | valid ppl   106.73 | valid bpc    6.738
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 13.0%
| epoch  14 |   100/  216 batches | lr 0.00030 | ms/batch 76.50 | loss  4.49 | ppl    89.31 
| epoch  14 |   200/  216 batches | lr 0.00030 | ms/batch 76.11 | loss  4.47 | ppl    87.24 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 16.95s | valid loss  4.62 | valid ppl   101.48 | valid bpc    6.665
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  216 batches | lr 0.00030 | ms/batch 76.82 | loss  4.45 | ppl    85.58 
| epoch  15 |   200/  216 batches | lr 0.00030 | ms/batch 75.61 | loss  4.39 | ppl    80.70 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 16.96s | valid loss  4.60 | valid ppl    99.33 | valid bpc    6.634
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 15.0%
| epoch  16 |   100/  216 batches | lr 0.00030 | ms/batch 76.88 | loss  4.37 | ppl    79.12 
| epoch  16 |   200/  216 batches | lr 0.00030 | ms/batch 75.79 | loss  4.31 | ppl    74.73 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 16.96s | valid loss  4.58 | valid ppl    97.53 | valid bpc    6.608
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 16.0%
| epoch  17 |   100/  216 batches | lr 0.00030 | ms/batch 77.00 | loss  4.31 | ppl    74.47 
| epoch  17 |   200/  216 batches | lr 0.00030 | ms/batch 75.71 | loss  4.26 | ppl    71.13 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 16.96s | valid loss  4.56 | valid ppl    95.71 | valid bpc    6.581
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 17.0%
| epoch  18 |   100/  216 batches | lr 0.00030 | ms/batch 77.24 | loss  4.24 | ppl    69.61 
| epoch  18 |   200/  216 batches | lr 0.00030 | ms/batch 75.34 | loss  4.21 | ppl    67.19 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 16.95s | valid loss  4.50 | valid ppl    89.97 | valid bpc    6.491
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 18.0%
| epoch  19 |   100/  216 batches | lr 0.00030 | ms/batch 76.89 | loss  4.18 | ppl    65.66 
| epoch  19 |   200/  216 batches | lr 0.00030 | ms/batch 75.42 | loss  4.14 | ppl    63.01 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 16.95s | valid loss  4.46 | valid ppl    86.67 | valid bpc    6.438
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 19.0%
| epoch  20 |   100/  216 batches | lr 0.00030 | ms/batch 76.98 | loss  4.13 | ppl    62.26 
| epoch  20 |   200/  216 batches | lr 0.00030 | ms/batch 75.61 | loss  4.08 | ppl    59.30 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 16.94s | valid loss  4.46 | valid ppl    86.74 | valid bpc    6.439
-----------------------------------------------------------------------------------------
PROGRESS: 20.0%
| epoch  21 |   100/  216 batches | lr 0.00030 | ms/batch 77.24 | loss  4.08 | ppl    59.41 
| epoch  21 |   200/  216 batches | lr 0.00030 | ms/batch 75.24 | loss  4.05 | ppl    57.24 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 16.94s | valid loss  4.39 | valid ppl    80.91 | valid bpc    6.338
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 21.0%
| epoch  22 |   100/  216 batches | lr 0.00030 | ms/batch 77.07 | loss  4.00 | ppl    54.55 
| epoch  22 |   200/  216 batches | lr 0.00030 | ms/batch 75.57 | loss  4.01 | ppl    55.36 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 16.95s | valid loss  4.39 | valid ppl    80.70 | valid bpc    6.334
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 22.0%
| epoch  23 |   100/  216 batches | lr 0.00030 | ms/batch 76.91 | loss  3.98 | ppl    53.64 
| epoch  23 |   200/  216 batches | lr 0.00030 | ms/batch 75.59 | loss  3.94 | ppl    51.52 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 16.94s | valid loss  4.40 | valid ppl    81.14 | valid bpc    6.342
-----------------------------------------------------------------------------------------
PROGRESS: 23.0%
| epoch  24 |   100/  216 batches | lr 0.00030 | ms/batch 76.54 | loss  3.92 | ppl    50.43 
| epoch  24 |   200/  216 batches | lr 0.00030 | ms/batch 76.05 | loss  3.90 | ppl    49.58 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 16.94s | valid loss  4.41 | valid ppl    82.17 | valid bpc    6.361
-----------------------------------------------------------------------------------------
PROGRESS: 24.0%
| epoch  25 |   100/  216 batches | lr 0.00030 | ms/batch 77.30 | loss  3.86 | ppl    47.58 
| epoch  25 |   200/  216 batches | lr 0.00030 | ms/batch 75.22 | loss  3.86 | ppl    47.39 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 16.95s | valid loss  4.38 | valid ppl    79.60 | valid bpc    6.315
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 25.0%
| epoch  26 |   100/  216 batches | lr 0.00030 | ms/batch 76.56 | loss  3.83 | ppl    46.10 
| epoch  26 |   200/  216 batches | lr 0.00030 | ms/batch 75.74 | loss  3.84 | ppl    46.32 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 16.95s | valid loss  4.34 | valid ppl    76.69 | valid bpc    6.261
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 26.0%
| epoch  27 |   100/  216 batches | lr 0.00030 | ms/batch 77.35 | loss  3.81 | ppl    44.98 
| epoch  27 |   200/  216 batches | lr 0.00030 | ms/batch 75.30 | loss  3.77 | ppl    43.35 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 16.95s | valid loss  4.34 | valid ppl    76.36 | valid bpc    6.255
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 27.0%
| epoch  28 |   100/  216 batches | lr 0.00030 | ms/batch 76.61 | loss  3.75 | ppl    42.54 
| epoch  28 |   200/  216 batches | lr 0.00030 | ms/batch 75.95 | loss  3.73 | ppl    41.51 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 16.93s | valid loss  4.33 | valid ppl    75.92 | valid bpc    6.246
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  216 batches | lr 0.00030 | ms/batch 76.87 | loss  3.71 | ppl    40.75 
| epoch  29 |   200/  216 batches | lr 0.00030 | ms/batch 75.63 | loss  3.69 | ppl    40.00 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 16.94s | valid loss  4.28 | valid ppl    72.07 | valid bpc    6.171
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  216 batches | lr 0.00030 | ms/batch 76.65 | loss  3.68 | ppl    39.64 
| epoch  30 |   200/  216 batches | lr 0.00030 | ms/batch 75.73 | loss  3.64 | ppl    38.16 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 16.94s | valid loss  4.30 | valid ppl    73.69 | valid bpc    6.203
-----------------------------------------------------------------------------------------
PROGRESS: 30.0%
| epoch  31 |   100/  216 batches | lr 0.00030 | ms/batch 76.70 | loss  3.65 | ppl    38.65 
| epoch  31 |   200/  216 batches | lr 0.00030 | ms/batch 75.83 | loss  3.58 | ppl    35.86 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 16.94s | valid loss  4.25 | valid ppl    70.23 | valid bpc    6.134
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 31.0%
| epoch  32 |   100/  216 batches | lr 0.00030 | ms/batch 76.86 | loss  3.57 | ppl    35.65 
| epoch  32 |   200/  216 batches | lr 0.00030 | ms/batch 75.64 | loss  3.58 | ppl    35.93 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 16.94s | valid loss  4.28 | valid ppl    71.95 | valid bpc    6.169
-----------------------------------------------------------------------------------------
PROGRESS: 32.0%
| epoch  33 |   100/  216 batches | lr 0.00030 | ms/batch 76.78 | loss  3.55 | ppl    34.73 
| epoch  33 |   200/  216 batches | lr 0.00030 | ms/batch 75.81 | loss  3.57 | ppl    35.41 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 16.94s | valid loss  4.29 | valid ppl    73.12 | valid bpc    6.192
-----------------------------------------------------------------------------------------
PROGRESS: 33.0%
| epoch  34 |   100/  216 batches | lr 0.00030 | ms/batch 76.81 | loss  3.51 | ppl    33.60 
| epoch  34 |   200/  216 batches | lr 0.00030 | ms/batch 75.79 | loss  3.51 | ppl    33.42 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 16.94s | valid loss  4.31 | valid ppl    74.15 | valid bpc    6.212
-----------------------------------------------------------------------------------------
PROGRESS: 34.0%
| epoch  35 |   100/  216 batches | lr 0.00015 | ms/batch 76.66 | loss  3.45 | ppl    31.44 
| epoch  35 |   200/  216 batches | lr 0.00015 | ms/batch 75.98 | loss  3.38 | ppl    29.41 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 16.94s | valid loss  4.17 | valid ppl    64.49 | valid bpc    6.011
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 35.0%
| epoch  36 |   100/  216 batches | lr 0.00015 | ms/batch 76.53 | loss  3.36 | ppl    28.92 
| epoch  36 |   200/  216 batches | lr 0.00015 | ms/batch 75.93 | loss  3.36 | ppl    28.86 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 16.94s | valid loss  4.23 | valid ppl    68.49 | valid bpc    6.098
-----------------------------------------------------------------------------------------
PROGRESS: 36.0%
| epoch  37 |   100/  216 batches | lr 0.00015 | ms/batch 76.98 | loss  3.35 | ppl    28.64 
| epoch  37 |   200/  216 batches | lr 0.00015 | ms/batch 75.66 | loss  3.34 | ppl    28.19 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 16.94s | valid loss  4.24 | valid ppl    69.71 | valid bpc    6.123
-----------------------------------------------------------------------------------------
PROGRESS: 37.0%
| epoch  38 |   100/  216 batches | lr 0.00015 | ms/batch 77.07 | loss  3.31 | ppl    27.46 
| epoch  38 |   200/  216 batches | lr 0.00015 | ms/batch 75.36 | loss  3.30 | ppl    27.04 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 16.95s | valid loss  4.21 | valid ppl    67.11 | valid bpc    6.068
-----------------------------------------------------------------------------------------
PROGRESS: 38.0%
| epoch  39 |   100/  216 batches | lr 0.00007 | ms/batch 76.90 | loss  3.25 | ppl    25.86 
| epoch  39 |   200/  216 batches | lr 0.00007 | ms/batch 75.89 | loss  3.25 | ppl    25.71 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 16.96s | valid loss  4.21 | valid ppl    67.26 | valid bpc    6.072
-----------------------------------------------------------------------------------------
PROGRESS: 39.0%
| epoch  40 |   100/  216 batches | lr 0.00007 | ms/batch 77.07 | loss  3.25 | ppl    25.70 
| epoch  40 |   200/  216 batches | lr 0.00007 | ms/batch 75.74 | loss  3.21 | ppl    24.79 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 16.96s | valid loss  4.20 | valid ppl    66.98 | valid bpc    6.066
-----------------------------------------------------------------------------------------
PROGRESS: 40.0%
| epoch  41 |   100/  216 batches | lr 0.00007 | ms/batch 76.71 | loss  3.21 | ppl    24.89 
| epoch  41 |   200/  216 batches | lr 0.00007 | ms/batch 75.94 | loss  3.21 | ppl    24.68 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 16.96s | valid loss  4.22 | valid ppl    67.82 | valid bpc    6.084
-----------------------------------------------------------------------------------------
PROGRESS: 41.0%
| epoch  42 |   100/  216 batches | lr 0.00004 | ms/batch 76.68 | loss  3.20 | ppl    24.52 
| epoch  42 |   200/  216 batches | lr 0.00004 | ms/batch 75.67 | loss  3.15 | ppl    23.27 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 16.96s | valid loss  4.21 | valid ppl    67.44 | valid bpc    6.075
-----------------------------------------------------------------------------------------
PROGRESS: 42.0%
| epoch  43 |   100/  216 batches | lr 0.00004 | ms/batch 76.87 | loss  3.18 | ppl    23.94 
| epoch  43 |   200/  216 batches | lr 0.00004 | ms/batch 75.76 | loss  3.16 | ppl    23.48 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 16.95s | valid loss  4.18 | valid ppl    65.54 | valid bpc    6.034
-----------------------------------------------------------------------------------------
PROGRESS: 43.0%
| epoch  44 |   100/  216 batches | lr 0.00004 | ms/batch 76.70 | loss  3.18 | ppl    24.14 
| epoch  44 |   200/  216 batches | lr 0.00004 | ms/batch 75.95 | loss  3.16 | ppl    23.49 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 16.95s | valid loss  4.18 | valid ppl    65.50 | valid bpc    6.033
-----------------------------------------------------------------------------------------
PROGRESS: 44.0%
| epoch  45 |   100/  216 batches | lr 0.00002 | ms/batch 77.34 | loss  3.16 | ppl    23.54 
| epoch  45 |   200/  216 batches | lr 0.00002 | ms/batch 75.19 | loss  3.13 | ppl    22.79 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 16.96s | valid loss  4.17 | valid ppl    64.83 | valid bpc    6.019
-----------------------------------------------------------------------------------------
PROGRESS: 45.0%
| epoch  46 |   100/  216 batches | lr 0.00002 | ms/batch 77.25 | loss  3.12 | ppl    22.56 
| epoch  46 |   200/  216 batches | lr 0.00002 | ms/batch 75.41 | loss  3.12 | ppl    22.68 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 16.96s | valid loss  4.19 | valid ppl    66.26 | valid bpc    6.050
-----------------------------------------------------------------------------------------
PROGRESS: 46.0%
| epoch  47 |   100/  216 batches | lr 0.00002 | ms/batch 76.55 | loss  3.13 | ppl    22.98 
| epoch  47 |   200/  216 batches | lr 0.00002 | ms/batch 75.77 | loss  3.11 | ppl    22.39 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 16.96s | valid loss  4.21 | valid ppl    67.09 | valid bpc    6.068
-----------------------------------------------------------------------------------------
PROGRESS: 47.0%
| epoch  48 |   100/  216 batches | lr 0.00001 | ms/batch 77.19 | loss  3.12 | ppl    22.72 
| epoch  48 |   200/  216 batches | lr 0.00001 | ms/batch 75.48 | loss  3.09 | ppl    22.08 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 16.95s | valid loss  4.21 | valid ppl    67.06 | valid bpc    6.067
-----------------------------------------------------------------------------------------
PROGRESS: 48.0%
| epoch  49 |   100/  216 batches | lr 0.00001 | ms/batch 76.80 | loss  3.11 | ppl    22.45 
| epoch  49 |   200/  216 batches | lr 0.00001 | ms/batch 75.87 | loss  3.10 | ppl    22.15 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 16.96s | valid loss  4.19 | valid ppl    65.84 | valid bpc    6.041
-----------------------------------------------------------------------------------------
PROGRESS: 49.0%
| epoch  50 |   100/  216 batches | lr 0.00001 | ms/batch 76.75 | loss  3.12 | ppl    22.68 
| epoch  50 |   200/  216 batches | lr 0.00001 | ms/batch 75.88 | loss  3.08 | ppl    21.67 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 16.95s | valid loss  4.15 | valid ppl    63.19 | valid bpc    5.982
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 50.0%
| epoch  51 |   100/  216 batches | lr 0.00001 | ms/batch 77.09 | loss  3.13 | ppl    22.79 
| epoch  51 |   200/  216 batches | lr 0.00001 | ms/batch 75.49 | loss  3.08 | ppl    21.69 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 16.95s | valid loss  4.19 | valid ppl    66.15 | valid bpc    6.048
-----------------------------------------------------------------------------------------
PROGRESS: 51.0%
| epoch  52 |   100/  216 batches | lr 0.00001 | ms/batch 77.04 | loss  3.09 | ppl    21.94 
| epoch  52 |   200/  216 batches | lr 0.00001 | ms/batch 75.58 | loss  3.08 | ppl    21.74 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 16.95s | valid loss  4.17 | valid ppl    64.98 | valid bpc    6.022
-----------------------------------------------------------------------------------------
PROGRESS: 52.0%
| epoch  53 |   100/  216 batches | lr 0.00001 | ms/batch 76.70 | loss  3.11 | ppl    22.46 
| epoch  53 |   200/  216 batches | lr 0.00001 | ms/batch 75.90 | loss  3.10 | ppl    22.24 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 16.95s | valid loss  4.20 | valid ppl    66.70 | valid bpc    6.060
-----------------------------------------------------------------------------------------
PROGRESS: 53.0%
| epoch  54 |   100/  216 batches | lr 0.00000 | ms/batch 76.99 | loss  3.14 | ppl    23.15 
| epoch  54 |   200/  216 batches | lr 0.00000 | ms/batch 75.61 | loss  3.07 | ppl    21.59 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 16.95s | valid loss  4.17 | valid ppl    64.61 | valid bpc    6.014
-----------------------------------------------------------------------------------------
PROGRESS: 54.0%
| epoch  55 |   100/  216 batches | lr 0.00000 | ms/batch 76.87 | loss  3.11 | ppl    22.52 
| epoch  55 |   200/  216 batches | lr 0.00000 | ms/batch 75.28 | loss  3.08 | ppl    21.73 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 16.94s | valid loss  4.20 | valid ppl    66.61 | valid bpc    6.058
-----------------------------------------------------------------------------------------
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  216 batches | lr 0.00000 | ms/batch 76.95 | loss  3.10 | ppl    22.27 
| epoch  56 |   200/  216 batches | lr 0.00000 | ms/batch 75.83 | loss  3.09 | ppl    21.92 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 16.96s | valid loss  4.19 | valid ppl    65.91 | valid bpc    6.043
-----------------------------------------------------------------------------------------
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  216 batches | lr 0.00000 | ms/batch 77.25 | loss  3.11 | ppl    22.44 
| epoch  57 |   200/  216 batches | lr 0.00000 | ms/batch 75.42 | loss  3.07 | ppl    21.52 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 16.95s | valid loss  4.18 | valid ppl    65.28 | valid bpc    6.028
-----------------------------------------------------------------------------------------
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  216 batches | lr 0.00000 | ms/batch 77.33 | loss  3.12 | ppl    22.71 
| epoch  58 |   200/  216 batches | lr 0.00000 | ms/batch 75.36 | loss  3.08 | ppl    21.67 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 16.95s | valid loss  4.17 | valid ppl    64.66 | valid bpc    6.015
-----------------------------------------------------------------------------------------
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  216 batches | lr 0.00000 | ms/batch 77.01 | loss  3.11 | ppl    22.36 
| epoch  59 |   200/  216 batches | lr 0.00000 | ms/batch 75.52 | loss  3.07 | ppl    21.58 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 16.95s | valid loss  4.15 | valid ppl    63.70 | valid bpc    5.993
-----------------------------------------------------------------------------------------
PROGRESS: 59.0%
| epoch  60 |   100/  216 batches | lr 0.00000 | ms/batch 76.69 | loss  3.10 | ppl    22.09 
| epoch  60 |   200/  216 batches | lr 0.00000 | ms/batch 75.95 | loss  3.07 | ppl    21.45 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 16.96s | valid loss  4.20 | valid ppl    66.84 | valid bpc    6.063
-----------------------------------------------------------------------------------------
PROGRESS: 60.0%
| epoch  61 |   100/  216 batches | lr 0.00000 | ms/batch 76.92 | loss  3.09 | ppl    21.92 
| epoch  61 |   200/  216 batches | lr 0.00000 | ms/batch 75.62 | loss  3.07 | ppl    21.54 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 16.95s | valid loss  4.19 | valid ppl    66.27 | valid bpc    6.050
-----------------------------------------------------------------------------------------
PROGRESS: 61.0%
| epoch  62 |   100/  216 batches | lr 0.00000 | ms/batch 77.00 | loss  3.08 | ppl    21.86 
| epoch  62 |   200/  216 batches | lr 0.00000 | ms/batch 75.71 | loss  3.09 | ppl    21.93 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 16.96s | valid loss  4.18 | valid ppl    65.30 | valid bpc    6.029
-----------------------------------------------------------------------------------------
PROGRESS: 62.0%
| epoch  63 |   100/  216 batches | lr 0.00000 | ms/batch 77.17 | loss  3.12 | ppl    22.72 
| epoch  63 |   200/  216 batches | lr 0.00000 | ms/batch 75.56 | loss  3.05 | ppl    21.14 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 16.96s | valid loss  4.16 | valid ppl    64.17 | valid bpc    6.004
-----------------------------------------------------------------------------------------
PROGRESS: 63.0%
| epoch  64 |   100/  216 batches | lr 0.00000 | ms/batch 77.24 | loss  3.11 | ppl    22.39 
| epoch  64 |   200/  216 batches | lr 0.00000 | ms/batch 75.61 | loss  3.06 | ppl    21.28 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 16.98s | valid loss  4.17 | valid ppl    64.86 | valid bpc    6.019
-----------------------------------------------------------------------------------------
PROGRESS: 64.0%
| epoch  65 |   100/  216 batches | lr 0.00000 | ms/batch 76.97 | loss  3.09 | ppl    22.08 
| epoch  65 |   200/  216 batches | lr 0.00000 | ms/batch 75.71 | loss  3.06 | ppl    21.26 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 16.96s | valid loss  4.17 | valid ppl    64.80 | valid bpc    6.018
-----------------------------------------------------------------------------------------
PROGRESS: 65.0%
| epoch  66 |   100/  216 batches | lr 0.00000 | ms/batch 76.66 | loss  3.09 | ppl    21.96 
| epoch  66 |   200/  216 batches | lr 0.00000 | ms/batch 75.56 | loss  3.09 | ppl    21.87 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 16.95s | valid loss  4.22 | valid ppl    68.03 | valid bpc    6.088
-----------------------------------------------------------------------------------------
PROGRESS: 66.0%
| epoch  67 |   100/  216 batches | lr 0.00000 | ms/batch 76.61 | loss  3.10 | ppl    22.30 
| epoch  67 |   200/  216 batches | lr 0.00000 | ms/batch 76.13 | loss  3.06 | ppl    21.24 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 16.96s | valid loss  4.19 | valid ppl    66.21 | valid bpc    6.049
-----------------------------------------------------------------------------------------
PROGRESS: 67.0%
| epoch  68 |   100/  216 batches | lr 0.00000 | ms/batch 76.98 | loss  3.10 | ppl    22.09 
| epoch  68 |   200/  216 batches | lr 0.00000 | ms/batch 75.69 | loss  3.07 | ppl    21.55 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 16.96s | valid loss  4.18 | valid ppl    65.46 | valid bpc    6.032
-----------------------------------------------------------------------------------------
PROGRESS: 68.0%
| epoch  69 |   100/  216 batches | lr 0.00000 | ms/batch 76.90 | loss  3.11 | ppl    22.51 
| epoch  69 |   200/  216 batches | lr 0.00000 | ms/batch 75.74 | loss  3.07 | ppl    21.52 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 16.95s | valid loss  4.18 | valid ppl    65.65 | valid bpc    6.037
-----------------------------------------------------------------------------------------
PROGRESS: 69.0%
| epoch  70 |   100/  216 batches | lr 0.00000 | ms/batch 76.82 | loss  3.09 | ppl    21.92 
| epoch  70 |   200/  216 batches | lr 0.00000 | ms/batch 75.44 | loss  3.08 | ppl    21.75 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 16.95s | valid loss  4.19 | valid ppl    66.10 | valid bpc    6.047
-----------------------------------------------------------------------------------------
PROGRESS: 70.0%
| epoch  71 |   100/  216 batches | lr 0.00000 | ms/batch 77.13 | loss  3.11 | ppl    22.46 
| epoch  71 |   200/  216 batches | lr 0.00000 | ms/batch 75.60 | loss  3.08 | ppl    21.66 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 16.96s | valid loss  4.15 | valid ppl    63.51 | valid bpc    5.989
-----------------------------------------------------------------------------------------
PROGRESS: 71.0%
| epoch  72 |   100/  216 batches | lr 0.00000 | ms/batch 77.10 | loss  3.11 | ppl    22.41 
| epoch  72 |   200/  216 batches | lr 0.00000 | ms/batch 75.57 | loss  3.06 | ppl    21.41 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 16.96s | valid loss  4.17 | valid ppl    64.91 | valid bpc    6.020
-----------------------------------------------------------------------------------------
PROGRESS: 72.0%
| epoch  73 |   100/  216 batches | lr 0.00000 | ms/batch 77.23 | loss  3.11 | ppl    22.33 
| epoch  73 |   200/  216 batches | lr 0.00000 | ms/batch 75.36 | loss  3.06 | ppl    21.31 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 16.95s | valid loss  4.18 | valid ppl    65.68 | valid bpc    6.037
-----------------------------------------------------------------------------------------
PROGRESS: 73.0%
| epoch  74 |   100/  216 batches | lr 0.00000 | ms/batch 77.27 | loss  3.10 | ppl    22.30 
| epoch  74 |   200/  216 batches | lr 0.00000 | ms/batch 75.49 | loss  3.08 | ppl    21.69 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 16.95s | valid loss  4.17 | valid ppl    64.78 | valid bpc    6.017
-----------------------------------------------------------------------------------------
PROGRESS: 74.0%
| epoch  75 |   100/  216 batches | lr 0.00000 | ms/batch 76.92 | loss  3.10 | ppl    22.13 
| epoch  75 |   200/  216 batches | lr 0.00000 | ms/batch 75.62 | loss  3.06 | ppl    21.36 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 16.96s | valid loss  4.18 | valid ppl    65.45 | valid bpc    6.032
-----------------------------------------------------------------------------------------
PROGRESS: 75.0%
| epoch  76 |   100/  216 batches | lr 0.00000 | ms/batch 77.02 | loss  3.10 | ppl    22.15 
| epoch  76 |   200/  216 batches | lr 0.00000 | ms/batch 75.65 | loss  3.07 | ppl    21.59 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 16.95s | valid loss  4.15 | valid ppl    63.62 | valid bpc    5.991
-----------------------------------------------------------------------------------------
PROGRESS: 76.0%
| epoch  77 |   100/  216 batches | lr 0.00000 | ms/batch 77.18 | loss  3.09 | ppl    22.00 
| epoch  77 |   200/  216 batches | lr 0.00000 | ms/batch 75.41 | loss  3.08 | ppl    21.70 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 16.95s | valid loss  4.18 | valid ppl    65.05 | valid bpc    6.024
-----------------------------------------------------------------------------------------
PROGRESS: 77.0%
| epoch  78 |   100/  216 batches | lr 0.00000 | ms/batch 77.00 | loss  3.10 | ppl    22.29 
| epoch  78 |   200/  216 batches | lr 0.00000 | ms/batch 75.61 | loss  3.10 | ppl    22.15 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 16.96s | valid loss  4.15 | valid ppl    63.16 | valid bpc    5.981
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 78.0%
| epoch  79 |   100/  216 batches | lr 0.00000 | ms/batch 77.33 | loss  3.09 | ppl    21.99 
| epoch  79 |   200/  216 batches | lr 0.00000 | ms/batch 75.33 | loss  3.07 | ppl    21.64 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 16.95s | valid loss  4.18 | valid ppl    65.31 | valid bpc    6.029
-----------------------------------------------------------------------------------------
PROGRESS: 79.0%
| epoch  80 |   100/  216 batches | lr 0.00000 | ms/batch 76.67 | loss  3.09 | ppl    21.97 
| epoch  80 |   200/  216 batches | lr 0.00000 | ms/batch 76.03 | loss  3.08 | ppl    21.81 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 16.94s | valid loss  4.14 | valid ppl    63.01 | valid bpc    5.977
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 80.0%
| epoch  81 |   100/  216 batches | lr 0.00000 | ms/batch 77.05 | loss  3.11 | ppl    22.32 
| epoch  81 |   200/  216 batches | lr 0.00000 | ms/batch 75.52 | loss  3.05 | ppl    21.03 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 16.94s | valid loss  4.17 | valid ppl    64.88 | valid bpc    6.020
-----------------------------------------------------------------------------------------
PROGRESS: 81.0%
| epoch  82 |   100/  216 batches | lr 0.00000 | ms/batch 76.59 | loss  3.12 | ppl    22.65 
| epoch  82 |   200/  216 batches | lr 0.00000 | ms/batch 76.03 | loss  3.07 | ppl    21.56 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 16.95s | valid loss  4.16 | valid ppl    63.85 | valid bpc    5.997
-----------------------------------------------------------------------------------------
PROGRESS: 82.0%
| epoch  83 |   100/  216 batches | lr 0.00000 | ms/batch 77.01 | loss  3.09 | ppl    21.92 
| epoch  83 |   200/  216 batches | lr 0.00000 | ms/batch 75.54 | loss  3.07 | ppl    21.56 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 16.95s | valid loss  4.17 | valid ppl    64.79 | valid bpc    6.018
-----------------------------------------------------------------------------------------
PROGRESS: 83.0%
| epoch  84 |   100/  216 batches | lr 0.00000 | ms/batch 77.06 | loss  3.11 | ppl    22.44 
| epoch  84 |   200/  216 batches | lr 0.00000 | ms/batch 75.49 | loss  3.06 | ppl    21.43 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 16.95s | valid loss  4.13 | valid ppl    62.15 | valid bpc    5.958
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 84.0%
| epoch  85 |   100/  216 batches | lr 0.00000 | ms/batch 77.07 | loss  3.09 | ppl    22.02 
| epoch  85 |   200/  216 batches | lr 0.00000 | ms/batch 75.44 | loss  3.08 | ppl    21.68 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 16.94s | valid loss  4.19 | valid ppl    66.05 | valid bpc    6.045
-----------------------------------------------------------------------------------------
PROGRESS: 85.0%
| epoch  86 |   100/  216 batches | lr 0.00000 | ms/batch 76.90 | loss  3.09 | ppl    22.08 
| epoch  86 |   200/  216 batches | lr 0.00000 | ms/batch 75.53 | loss  3.08 | ppl    21.73 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 16.94s | valid loss  4.15 | valid ppl    63.23 | valid bpc    5.982
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  216 batches | lr 0.00000 | ms/batch 76.93 | loss  3.11 | ppl    22.42 
| epoch  87 |   200/  216 batches | lr 0.00000 | ms/batch 75.78 | loss  3.06 | ppl    21.26 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 16.95s | valid loss  4.21 | valid ppl    67.67 | valid bpc    6.080
-----------------------------------------------------------------------------------------
PROGRESS: 87.0%
| epoch  88 |   100/  216 batches | lr 0.00000 | ms/batch 76.70 | loss  3.09 | ppl    22.03 
| epoch  88 |   200/  216 batches | lr 0.00000 | ms/batch 75.91 | loss  3.07 | ppl    21.57 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 16.96s | valid loss  4.18 | valid ppl    65.31 | valid bpc    6.029
-----------------------------------------------------------------------------------------
PROGRESS: 88.0%
| epoch  89 |   100/  216 batches | lr 0.00000 | ms/batch 76.79 | loss  3.10 | ppl    22.13 
| epoch  89 |   200/  216 batches | lr 0.00000 | ms/batch 75.91 | loss  3.05 | ppl    21.15 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 16.96s | valid loss  4.18 | valid ppl    65.36 | valid bpc    6.030
-----------------------------------------------------------------------------------------
PROGRESS: 89.0%
| epoch  90 |   100/  216 batches | lr 0.00000 | ms/batch 77.11 | loss  3.10 | ppl    22.28 
| epoch  90 |   200/  216 batches | lr 0.00000 | ms/batch 75.72 | loss  3.06 | ppl    21.26 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 16.98s | valid loss  4.13 | valid ppl    62.04 | valid bpc    5.955
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 90.0%
| epoch  91 |   100/  216 batches | lr 0.00000 | ms/batch 76.49 | loss  3.10 | ppl    22.20 
| epoch  91 |   200/  216 batches | lr 0.00000 | ms/batch 76.18 | loss  3.06 | ppl    21.38 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 16.95s | valid loss  4.18 | valid ppl    65.13 | valid bpc    6.025
-----------------------------------------------------------------------------------------
PROGRESS: 91.0%
| epoch  92 |   100/  216 batches | lr 0.00000 | ms/batch 76.50 | loss  3.11 | ppl    22.37 
| epoch  92 |   200/  216 batches | lr 0.00000 | ms/batch 76.18 | loss  3.08 | ppl    21.75 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 16.95s | valid loss  4.14 | valid ppl    62.68 | valid bpc    5.970
-----------------------------------------------------------------------------------------
PROGRESS: 92.0%
| epoch  93 |   100/  216 batches | lr 0.00000 | ms/batch 77.23 | loss  3.10 | ppl    22.17 
| epoch  93 |   200/  216 batches | lr 0.00000 | ms/batch 75.45 | loss  3.08 | ppl    21.68 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 16.94s | valid loss  4.16 | valid ppl    64.18 | valid bpc    6.004
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  216 batches | lr 0.00000 | ms/batch 76.49 | loss  3.09 | ppl    21.91 
| epoch  94 |   200/  216 batches | lr 0.00000 | ms/batch 76.10 | loss  3.08 | ppl    21.75 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 16.95s | valid loss  4.12 | valid ppl    61.80 | valid bpc    5.950
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 94.0%
| epoch  95 |   100/  216 batches | lr 0.00000 | ms/batch 77.13 | loss  3.10 | ppl    22.25 
| epoch  95 |   200/  216 batches | lr 0.00000 | ms/batch 75.56 | loss  3.06 | ppl    21.25 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 16.95s | valid loss  4.16 | valid ppl    63.93 | valid bpc    5.998
-----------------------------------------------------------------------------------------
PROGRESS: 95.0%
| epoch  96 |   100/  216 batches | lr 0.00000 | ms/batch 77.24 | loss  3.07 | ppl    21.65 
| epoch  96 |   200/  216 batches | lr 0.00000 | ms/batch 75.59 | loss  3.08 | ppl    21.72 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 16.97s | valid loss  4.19 | valid ppl    65.78 | valid bpc    6.040
-----------------------------------------------------------------------------------------
PROGRESS: 96.0%
| epoch  97 |   100/  216 batches | lr 0.00000 | ms/batch 76.95 | loss  3.08 | ppl    21.68 
| epoch  97 |   200/  216 batches | lr 0.00000 | ms/batch 75.73 | loss  3.06 | ppl    21.43 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 16.95s | valid loss  4.21 | valid ppl    67.40 | valid bpc    6.075
-----------------------------------------------------------------------------------------
PROGRESS: 97.0%
| epoch  98 |   100/  216 batches | lr 0.00000 | ms/batch 76.81 | loss  3.10 | ppl    22.10 
| epoch  98 |   200/  216 batches | lr 0.00000 | ms/batch 75.86 | loss  3.07 | ppl    21.64 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 16.96s | valid loss  4.19 | valid ppl    66.23 | valid bpc    6.049
-----------------------------------------------------------------------------------------
PROGRESS: 98.0%
| epoch  99 |   100/  216 batches | lr 0.00000 | ms/batch 76.39 | loss  3.10 | ppl    22.12 
| epoch  99 |   200/  216 batches | lr 0.00000 | ms/batch 75.64 | loss  3.05 | ppl    21.15 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 16.93s | valid loss  4.18 | valid ppl    65.17 | valid bpc    6.026
-----------------------------------------------------------------------------------------
PROGRESS: 99.0%
| epoch 100 |   100/  216 batches | lr 0.00000 | ms/batch 76.63 | loss  3.11 | ppl    22.33 
| epoch 100 |   200/  216 batches | lr 0.00000 | ms/batch 75.93 | loss  3.08 | ppl    21.69 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 16.95s | valid loss  4.21 | valid ppl    67.37 | valid bpc    6.074
-----------------------------------------------------------------------------------------
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  4.14 | test ppl    62.91 | test bpc    5.975
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.4273, Mean Reca: 0.5898, Mean F1: 0.4873
Counter({'NP': 9045, 'PP': 4112, 'S': 3321, 'VP': 2802, 'SBAR': 658, 'ADJP': 282, 'QP': 267, 'ADVP': 177, 'SINV': 148, 'PRN': 52, 'FRAG': 34, 'WHNP': 28, 'NX': 21, 'WHPP': 13, 'SQ': 12, 'UCP': 11, 'NAC': 10, 'SBARQ': 8, 'CONJP': 5, 'WHADVP': 3, 'X': 3})
Counter({'NP': 14432, 'VP': 8130, 'S': 5620, 'PP': 5484, 'SBAR': 1796, 'ADJP': 649, 'QP': 490, 'ADVP': 286, 'SINV': 157, 'PRN': 128, 'NX': 95, 'FRAG': 42, 'WHNP': 37, 'UCP': 32, 'NAC': 30, 'WHPP': 25, 'CONJP': 21, 'SQ': 18, 'SBARQ': 10, 'WHADVP': 9, 'X': 6, 'WHADJP': 4, 'INTJ': 1})
SBAR: 0.3664
NP: 0.6267
VP: 0.3446
PP: 0.7498
ADJP: 0.4345
ADVP: 0.6189
4.888419432688523
-----------------------------------------------------------------------------------------
Dependency parsing performance:
Conll-U Style:
DDA: 0.425
UDA: 0.567
=========================================================================================
Loading dataset...
Loading dictionary...
Number of tokens:  10001
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer_in_parser', nhid=512, nlayers=8, front_layers=5, rear_layers=3, n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=5555, nonmono=5, cuda=True, log_interval=100, save='trained_models/structformer_in_parser_5555_53.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 38475589
Model architecture: StructFormer_In_Parser(
  (transformer_front): Transformer_Front(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(10001, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-4): 5 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
  (transformer_rear): Transformer_Rear(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(10001, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-2): 3 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (output_layer): Linear(in_features=512, out_features=10001, bias=True)
  )
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  216 batches | lr 0.00030 | ms/batch 79.80 | loss  7.32 | ppl  1505.24 
| epoch   1 |   200/  216 batches | lr 0.00030 | ms/batch 74.74 | loss  6.86 | ppl   955.34 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 17.12s | valid loss  6.70 | valid ppl   814.33 | valid bpc    9.669
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  216 batches | lr 0.00030 | ms/batch 76.22 | loss  6.80 | ppl   896.35 
| epoch   2 |   200/  216 batches | lr 0.00030 | ms/batch 75.27 | loss  6.52 | ppl   678.61 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 16.82s | valid loss  6.28 | valid ppl   535.54 | valid bpc    9.065
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  216 batches | lr 0.00030 | ms/batch 76.37 | loss  6.30 | ppl   547.28 
| epoch   3 |   200/  216 batches | lr 0.00030 | ms/batch 75.56 | loss  6.03 | ppl   417.76 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 16.87s | valid loss  5.84 | valid ppl   344.03 | valid bpc    8.426
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  216 batches | lr 0.00030 | ms/batch 76.27 | loss  5.85 | ppl   348.89 
| epoch   4 |   200/  216 batches | lr 0.00030 | ms/batch 75.91 | loss  5.68 | ppl   293.82 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 16.89s | valid loss  5.54 | valid ppl   254.86 | valid bpc    7.994
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  216 batches | lr 0.00030 | ms/batch 76.49 | loss  5.56 | ppl   259.82 
| epoch   5 |   200/  216 batches | lr 0.00030 | ms/batch 75.85 | loss  5.45 | ppl   233.68 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 16.91s | valid loss  5.39 | valid ppl   218.94 | valid bpc    7.774
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  216 batches | lr 0.00030 | ms/batch 76.82 | loss  5.34 | ppl   209.33 
| epoch   6 |   200/  216 batches | lr 0.00030 | ms/batch 75.67 | loss  5.26 | ppl   191.94 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 16.93s | valid loss  5.19 | valid ppl   180.19 | valid bpc    7.493
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  216 batches | lr 0.00030 | ms/batch 77.29 | loss  5.22 | ppl   184.09 
| epoch   7 |   200/  216 batches | lr 0.00030 | ms/batch 75.25 | loss  5.10 | ppl   164.55 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 16.94s | valid loss  5.11 | valid ppl   165.14 | valid bpc    7.368
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  216 batches | lr 0.00030 | ms/batch 76.34 | loss  5.05 | ppl   156.23 
| epoch   8 |   200/  216 batches | lr 0.00030 | ms/batch 75.73 | loss  4.98 | ppl   145.88 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 16.94s | valid loss  5.00 | valid ppl   148.12 | valid bpc    7.211
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 8.0%
| epoch   9 |   100/  216 batches | lr 0.00030 | ms/batch 77.08 | loss  4.97 | ppl   143.75 
| epoch   9 |   200/  216 batches | lr 0.00030 | ms/batch 75.54 | loss  4.87 | ppl   130.52 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 16.94s | valid loss  4.91 | valid ppl   135.63 | valid bpc    7.083
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  216 batches | lr 0.00030 | ms/batch 76.56 | loss  4.83 | ppl   125.61 
| epoch  10 |   200/  216 batches | lr 0.00030 | ms/batch 76.08 | loss  4.83 | ppl   125.22 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 16.95s | valid loss  4.86 | valid ppl   128.92 | valid bpc    7.010
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  216 batches | lr 0.00030 | ms/batch 76.49 | loss  4.73 | ppl   113.31 
| epoch  11 |   200/  216 batches | lr 0.00030 | ms/batch 76.18 | loss  4.72 | ppl   111.92 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 16.94s | valid loss  4.75 | valid ppl   115.35 | valid bpc    6.850
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  216 batches | lr 0.00030 | ms/batch 76.82 | loss  4.64 | ppl   103.84 
| epoch  12 |   200/  216 batches | lr 0.00030 | ms/batch 75.82 | loss  4.62 | ppl   101.12 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 16.95s | valid loss  4.76 | valid ppl   116.37 | valid bpc    6.863
-----------------------------------------------------------------------------------------
PROGRESS: 12.0%
| epoch  13 |   100/  216 batches | lr 0.00030 | ms/batch 76.71 | loss  4.57 | ppl    96.41 
| epoch  13 |   200/  216 batches | lr 0.00030 | ms/batch 76.23 | loss  4.57 | ppl    96.18 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 16.97s | valid loss  4.71 | valid ppl   111.25 | valid bpc    6.798
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 13.0%
| epoch  14 |   100/  216 batches | lr 0.00030 | ms/batch 76.88 | loss  4.52 | ppl    92.12 
| epoch  14 |   200/  216 batches | lr 0.00030 | ms/batch 75.76 | loss  4.44 | ppl    85.17 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 16.95s | valid loss  4.64 | valid ppl   103.04 | valid bpc    6.687
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  216 batches | lr 0.00030 | ms/batch 77.26 | loss  4.45 | ppl    85.75 
| epoch  15 |   200/  216 batches | lr 0.00030 | ms/batch 75.45 | loss  4.39 | ppl    80.32 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 16.95s | valid loss  4.57 | valid ppl    96.32 | valid bpc    6.590
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 15.0%
| epoch  16 |   100/  216 batches | lr 0.00030 | ms/batch 76.63 | loss  4.36 | ppl    77.88 
| epoch  16 |   200/  216 batches | lr 0.00030 | ms/batch 76.06 | loss  4.34 | ppl    76.85 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 16.94s | valid loss  4.54 | valid ppl    93.81 | valid bpc    6.552
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 16.0%
| epoch  17 |   100/  216 batches | lr 0.00030 | ms/batch 77.07 | loss  4.33 | ppl    76.31 
| epoch  17 |   200/  216 batches | lr 0.00030 | ms/batch 75.33 | loss  4.26 | ppl    70.49 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 16.94s | valid loss  4.55 | valid ppl    94.80 | valid bpc    6.567
-----------------------------------------------------------------------------------------
PROGRESS: 17.0%
| epoch  18 |   100/  216 batches | lr 0.00030 | ms/batch 77.04 | loss  4.26 | ppl    70.70 
| epoch  18 |   200/  216 batches | lr 0.00030 | ms/batch 75.65 | loss  4.21 | ppl    67.36 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 16.95s | valid loss  4.50 | valid ppl    89.73 | valid bpc    6.487
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 18.0%
| epoch  19 |   100/  216 batches | lr 0.00030 | ms/batch 76.79 | loss  4.20 | ppl    66.79 
| epoch  19 |   200/  216 batches | lr 0.00030 | ms/batch 75.82 | loss  4.14 | ppl    62.75 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 16.95s | valid loss  4.47 | valid ppl    87.07 | valid bpc    6.444
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 19.0%
| epoch  20 |   100/  216 batches | lr 0.00030 | ms/batch 77.13 | loss  4.13 | ppl    62.29 
| epoch  20 |   200/  216 batches | lr 0.00030 | ms/batch 75.59 | loss  4.09 | ppl    59.76 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 16.96s | valid loss  4.43 | valid ppl    83.84 | valid bpc    6.390
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 20.0%
| epoch  21 |   100/  216 batches | lr 0.00030 | ms/batch 77.24 | loss  4.08 | ppl    58.87 
| epoch  21 |   200/  216 batches | lr 0.00030 | ms/batch 75.33 | loss  4.05 | ppl    57.24 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 16.95s | valid loss  4.42 | valid ppl    82.99 | valid bpc    6.375
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 21.0%
| epoch  22 |   100/  216 batches | lr 0.00030 | ms/batch 76.89 | loss  4.06 | ppl    57.84 
| epoch  22 |   200/  216 batches | lr 0.00030 | ms/batch 75.61 | loss  4.00 | ppl    54.67 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 16.94s | valid loss  4.42 | valid ppl    82.98 | valid bpc    6.375
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 22.0%
| epoch  23 |   100/  216 batches | lr 0.00030 | ms/batch 77.10 | loss  3.99 | ppl    54.19 
| epoch  23 |   200/  216 batches | lr 0.00030 | ms/batch 75.44 | loss  3.95 | ppl    52.09 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 16.94s | valid loss  4.37 | valid ppl    79.07 | valid bpc    6.305
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 23.0%
| epoch  24 |   100/  216 batches | lr 0.00030 | ms/batch 76.94 | loss  3.93 | ppl    50.70 
| epoch  24 |   200/  216 batches | lr 0.00030 | ms/batch 75.70 | loss  3.93 | ppl    50.98 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 16.95s | valid loss  4.37 | valid ppl    79.02 | valid bpc    6.304
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 24.0%
| epoch  25 |   100/  216 batches | lr 0.00030 | ms/batch 76.88 | loss  3.90 | ppl    49.18 
| epoch  25 |   200/  216 batches | lr 0.00030 | ms/batch 76.10 | loss  3.87 | ppl    47.97 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 16.97s | valid loss  4.32 | valid ppl    75.09 | valid bpc    6.231
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 25.0%
| epoch  26 |   100/  216 batches | lr 0.00030 | ms/batch 76.68 | loss  3.82 | ppl    45.58 
| epoch  26 |   200/  216 batches | lr 0.00030 | ms/batch 75.86 | loss  3.87 | ppl    48.03 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 16.94s | valid loss  4.34 | valid ppl    76.51 | valid bpc    6.257
-----------------------------------------------------------------------------------------
PROGRESS: 26.0%
| epoch  27 |   100/  216 batches | lr 0.00030 | ms/batch 77.19 | loss  3.82 | ppl    45.50 
| epoch  27 |   200/  216 batches | lr 0.00030 | ms/batch 75.41 | loss  3.79 | ppl    44.06 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 16.94s | valid loss  4.30 | valid ppl    73.83 | valid bpc    6.206
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 27.0%
| epoch  28 |   100/  216 batches | lr 0.00030 | ms/batch 77.12 | loss  3.78 | ppl    43.64 
| epoch  28 |   200/  216 batches | lr 0.00030 | ms/batch 75.39 | loss  3.75 | ppl    42.47 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 16.94s | valid loss  4.33 | valid ppl    75.68 | valid bpc    6.242
-----------------------------------------------------------------------------------------
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  216 batches | lr 0.00030 | ms/batch 76.83 | loss  3.73 | ppl    41.88 
| epoch  29 |   200/  216 batches | lr 0.00030 | ms/batch 75.84 | loss  3.71 | ppl    40.68 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 16.95s | valid loss  4.29 | valid ppl    72.89 | valid bpc    6.188
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  216 batches | lr 0.00030 | ms/batch 77.18 | loss  3.69 | ppl    40.09 
| epoch  30 |   200/  216 batches | lr 0.00030 | ms/batch 75.52 | loss  3.67 | ppl    39.24 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 16.95s | valid loss  4.26 | valid ppl    70.99 | valid bpc    6.150
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 30.0%
| epoch  31 |   100/  216 batches | lr 0.00030 | ms/batch 76.55 | loss  3.66 | ppl    38.85 
| epoch  31 |   200/  216 batches | lr 0.00030 | ms/batch 76.15 | loss  3.63 | ppl    37.63 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 16.95s | valid loss  4.27 | valid ppl    71.81 | valid bpc    6.166
-----------------------------------------------------------------------------------------
PROGRESS: 31.0%
| epoch  32 |   100/  216 batches | lr 0.00030 | ms/batch 76.98 | loss  3.61 | ppl    37.01 
| epoch  32 |   200/  216 batches | lr 0.00030 | ms/batch 75.76 | loss  3.61 | ppl    36.80 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 16.95s | valid loss  4.28 | valid ppl    71.90 | valid bpc    6.168
-----------------------------------------------------------------------------------------
PROGRESS: 32.0%
| epoch  33 |   100/  216 batches | lr 0.00030 | ms/batch 76.88 | loss  3.57 | ppl    35.46 
| epoch  33 |   200/  216 batches | lr 0.00030 | ms/batch 75.88 | loss  3.58 | ppl    35.77 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 16.95s | valid loss  4.29 | valid ppl    72.84 | valid bpc    6.187
-----------------------------------------------------------------------------------------
PROGRESS: 33.0%
| epoch  34 |   100/  216 batches | lr 0.00015 | ms/batch 76.60 | loss  3.47 | ppl    32.25 
| epoch  34 |   200/  216 batches | lr 0.00015 | ms/batch 76.10 | loss  3.47 | ppl    31.98 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 16.95s | valid loss  4.23 | valid ppl    68.48 | valid bpc    6.098
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 34.0%
| epoch  35 |   100/  216 batches | lr 0.00015 | ms/batch 76.66 | loss  3.45 | ppl    31.58 
| epoch  35 |   200/  216 batches | lr 0.00015 | ms/batch 75.99 | loss  3.42 | ppl    30.72 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 16.95s | valid loss  4.21 | valid ppl    67.38 | valid bpc    6.074
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 35.0%
| epoch  36 |   100/  216 batches | lr 0.00015 | ms/batch 76.59 | loss  3.41 | ppl    30.24 
| epoch  36 |   200/  216 batches | lr 0.00015 | ms/batch 76.04 | loss  3.38 | ppl    29.30 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 16.95s | valid loss  4.18 | valid ppl    65.14 | valid bpc    6.026
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 36.0%
| epoch  37 |   100/  216 batches | lr 0.00015 | ms/batch 77.14 | loss  3.38 | ppl    29.37 
| epoch  37 |   200/  216 batches | lr 0.00015 | ms/batch 75.56 | loss  3.36 | ppl    28.68 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 16.96s | valid loss  4.23 | valid ppl    68.97 | valid bpc    6.108
-----------------------------------------------------------------------------------------
PROGRESS: 37.0%
| epoch  38 |   100/  216 batches | lr 0.00015 | ms/batch 77.00 | loss  3.34 | ppl    28.24 
| epoch  38 |   200/  216 batches | lr 0.00015 | ms/batch 75.80 | loss  3.33 | ppl    28.07 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 16.96s | valid loss  4.19 | valid ppl    65.84 | valid bpc    6.041
-----------------------------------------------------------------------------------------
PROGRESS: 38.0%
| epoch  39 |   100/  216 batches | lr 0.00015 | ms/batch 76.86 | loss  3.33 | ppl    27.96 
| epoch  39 |   200/  216 batches | lr 0.00015 | ms/batch 75.75 | loss  3.30 | ppl    27.23 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 16.95s | valid loss  4.16 | valid ppl    63.86 | valid bpc    5.997
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 39.0%
| epoch  40 |   100/  216 batches | lr 0.00015 | ms/batch 76.77 | loss  3.31 | ppl    27.49 
| epoch  40 |   200/  216 batches | lr 0.00015 | ms/batch 75.95 | loss  3.28 | ppl    26.61 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 16.95s | valid loss  4.20 | valid ppl    66.99 | valid bpc    6.066
-----------------------------------------------------------------------------------------
PROGRESS: 40.0%
| epoch  41 |   100/  216 batches | lr 0.00015 | ms/batch 77.14 | loss  3.27 | ppl    26.34 
| epoch  41 |   200/  216 batches | lr 0.00015 | ms/batch 75.60 | loss  3.26 | ppl    26.10 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 16.95s | valid loss  4.24 | valid ppl    69.07 | valid bpc    6.110
-----------------------------------------------------------------------------------------
PROGRESS: 41.0%
| epoch  42 |   100/  216 batches | lr 0.00015 | ms/batch 77.22 | loss  3.28 | ppl    26.68 
| epoch  42 |   200/  216 batches | lr 0.00015 | ms/batch 75.44 | loss  3.22 | ppl    25.05 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 16.95s | valid loss  4.22 | valid ppl    68.05 | valid bpc    6.089
-----------------------------------------------------------------------------------------
PROGRESS: 42.0%
| epoch  43 |   100/  216 batches | lr 0.00007 | ms/batch 76.83 | loss  3.22 | ppl    24.93 
| epoch  43 |   200/  216 batches | lr 0.00007 | ms/batch 75.80 | loss  3.19 | ppl    24.27 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 16.94s | valid loss  4.24 | valid ppl    69.14 | valid bpc    6.112
-----------------------------------------------------------------------------------------
PROGRESS: 43.0%
| epoch  44 |   100/  216 batches | lr 0.00007 | ms/batch 77.02 | loss  3.18 | ppl    23.97 
| epoch  44 |   200/  216 batches | lr 0.00007 | ms/batch 75.56 | loss  3.15 | ppl    23.23 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 16.95s | valid loss  4.16 | valid ppl    63.81 | valid bpc    5.996
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 44.0%
| epoch  45 |   100/  216 batches | lr 0.00007 | ms/batch 77.24 | loss  3.16 | ppl    23.50 
| epoch  45 |   200/  216 batches | lr 0.00007 | ms/batch 75.45 | loss  3.13 | ppl    22.95 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 16.95s | valid loss  4.21 | valid ppl    67.11 | valid bpc    6.068
-----------------------------------------------------------------------------------------
PROGRESS: 45.0%
| epoch  46 |   100/  216 batches | lr 0.00007 | ms/batch 77.07 | loss  3.13 | ppl    22.93 
| epoch  46 |   200/  216 batches | lr 0.00007 | ms/batch 75.57 | loss  3.14 | ppl    23.14 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 16.95s | valid loss  4.21 | valid ppl    67.51 | valid bpc    6.077
-----------------------------------------------------------------------------------------
PROGRESS: 46.0%
| epoch  47 |   100/  216 batches | lr 0.00007 | ms/batch 77.21 | loss  3.10 | ppl    22.22 
| epoch  47 |   200/  216 batches | lr 0.00007 | ms/batch 75.50 | loss  3.11 | ppl    22.41 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 16.95s | valid loss  4.19 | valid ppl    65.81 | valid bpc    6.040
-----------------------------------------------------------------------------------------
PROGRESS: 47.0%
| epoch  48 |   100/  216 batches | lr 0.00004 | ms/batch 76.80 | loss  3.10 | ppl    22.11 
| epoch  48 |   200/  216 batches | lr 0.00004 | ms/batch 75.93 | loss  3.09 | ppl    21.97 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 16.96s | valid loss  4.22 | valid ppl    67.96 | valid bpc    6.087
-----------------------------------------------------------------------------------------
PROGRESS: 48.0%
| epoch  49 |   100/  216 batches | lr 0.00004 | ms/batch 76.83 | loss  3.09 | ppl    21.94 
| epoch  49 |   200/  216 batches | lr 0.00004 | ms/batch 76.02 | loss  3.07 | ppl    21.57 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 16.96s | valid loss  4.19 | valid ppl    66.34 | valid bpc    6.052
-----------------------------------------------------------------------------------------
PROGRESS: 49.0%
| epoch  50 |   100/  216 batches | lr 0.00004 | ms/batch 77.07 | loss  3.08 | ppl    21.78 
| epoch  50 |   200/  216 batches | lr 0.00004 | ms/batch 75.58 | loss  3.05 | ppl    21.12 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 16.96s | valid loss  4.15 | valid ppl    63.26 | valid bpc    5.983
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 50.0%
| epoch  51 |   100/  216 batches | lr 0.00004 | ms/batch 76.67 | loss  3.06 | ppl    21.35 
| epoch  51 |   200/  216 batches | lr 0.00004 | ms/batch 76.02 | loss  3.07 | ppl    21.54 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 16.95s | valid loss  4.20 | valid ppl    66.74 | valid bpc    6.061
-----------------------------------------------------------------------------------------
PROGRESS: 51.0%
| epoch  52 |   100/  216 batches | lr 0.00004 | ms/batch 76.87 | loss  3.06 | ppl    21.32 
| epoch  52 |   200/  216 batches | lr 0.00004 | ms/batch 75.78 | loss  3.05 | ppl    21.15 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 16.95s | valid loss  4.19 | valid ppl    66.06 | valid bpc    6.046
-----------------------------------------------------------------------------------------
PROGRESS: 52.0%
| epoch  53 |   100/  216 batches | lr 0.00004 | ms/batch 76.96 | loss  3.07 | ppl    21.57 
| epoch  53 |   200/  216 batches | lr 0.00004 | ms/batch 75.74 | loss  3.01 | ppl    20.26 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 16.96s | valid loss  4.16 | valid ppl    63.77 | valid bpc    5.995
-----------------------------------------------------------------------------------------
PROGRESS: 53.0%
| epoch  54 |   100/  216 batches | lr 0.00002 | ms/batch 77.28 | loss  3.05 | ppl    21.21 
| epoch  54 |   200/  216 batches | lr 0.00002 | ms/batch 75.50 | loss  3.01 | ppl    20.32 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 16.96s | valid loss  4.16 | valid ppl    63.99 | valid bpc    6.000
-----------------------------------------------------------------------------------------
PROGRESS: 54.0%
| epoch  55 |   100/  216 batches | lr 0.00002 | ms/batch 76.80 | loss  3.04 | ppl    20.80 
| epoch  55 |   200/  216 batches | lr 0.00002 | ms/batch 75.82 | loss  3.02 | ppl    20.44 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 16.96s | valid loss  4.16 | valid ppl    63.78 | valid bpc    5.995
-----------------------------------------------------------------------------------------
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  216 batches | lr 0.00002 | ms/batch 76.82 | loss  3.04 | ppl    20.91 
| epoch  56 |   200/  216 batches | lr 0.00002 | ms/batch 75.86 | loss  3.01 | ppl    20.24 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 16.96s | valid loss  4.21 | valid ppl    67.37 | valid bpc    6.074
-----------------------------------------------------------------------------------------
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  216 batches | lr 0.00001 | ms/batch 76.81 | loss  3.03 | ppl    20.76 
| epoch  57 |   200/  216 batches | lr 0.00001 | ms/batch 75.91 | loss  2.99 | ppl    19.94 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 16.96s | valid loss  4.21 | valid ppl    67.63 | valid bpc    6.080
-----------------------------------------------------------------------------------------
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  216 batches | lr 0.00001 | ms/batch 76.68 | loss  3.03 | ppl    20.79 
| epoch  58 |   200/  216 batches | lr 0.00001 | ms/batch 76.02 | loss  2.99 | ppl    19.98 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 16.96s | valid loss  4.22 | valid ppl    67.91 | valid bpc    6.086
-----------------------------------------------------------------------------------------
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  216 batches | lr 0.00001 | ms/batch 77.07 | loss  3.02 | ppl    20.51 
| epoch  59 |   200/  216 batches | lr 0.00001 | ms/batch 75.32 | loss  2.98 | ppl    19.65 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 16.96s | valid loss  4.19 | valid ppl    65.74 | valid bpc    6.039
-----------------------------------------------------------------------------------------
PROGRESS: 59.0%
| epoch  60 |   100/  216 batches | lr 0.00000 | ms/batch 76.68 | loss  3.02 | ppl    20.56 
| epoch  60 |   200/  216 batches | lr 0.00000 | ms/batch 76.15 | loss  3.00 | ppl    20.02 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 16.96s | valid loss  4.16 | valid ppl    64.15 | valid bpc    6.003
-----------------------------------------------------------------------------------------
PROGRESS: 60.0%
| epoch  61 |   100/  216 batches | lr 0.00000 | ms/batch 77.31 | loss  3.03 | ppl    20.76 
| epoch  61 |   200/  216 batches | lr 0.00000 | ms/batch 75.31 | loss  2.97 | ppl    19.52 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 16.95s | valid loss  4.17 | valid ppl    64.75 | valid bpc    6.017
-----------------------------------------------------------------------------------------
PROGRESS: 61.0%
| epoch  62 |   100/  216 batches | lr 0.00000 | ms/batch 76.74 | loss  3.02 | ppl    20.46 
| epoch  62 |   200/  216 batches | lr 0.00000 | ms/batch 76.00 | loss  2.99 | ppl    19.89 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 16.97s | valid loss  4.17 | valid ppl    64.42 | valid bpc    6.009
-----------------------------------------------------------------------------------------
PROGRESS: 62.0%
| epoch  63 |   100/  216 batches | lr 0.00000 | ms/batch 77.05 | loss  3.02 | ppl    20.41 
| epoch  63 |   200/  216 batches | lr 0.00000 | ms/batch 75.66 | loss  2.98 | ppl    19.70 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 16.96s | valid loss  4.17 | valid ppl    64.97 | valid bpc    6.022
-----------------------------------------------------------------------------------------
PROGRESS: 63.0%
| epoch  64 |   100/  216 batches | lr 0.00000 | ms/batch 77.14 | loss  3.01 | ppl    20.24 
| epoch  64 |   200/  216 batches | lr 0.00000 | ms/batch 75.69 | loss  2.98 | ppl    19.75 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 16.96s | valid loss  4.22 | valid ppl    67.98 | valid bpc    6.087
-----------------------------------------------------------------------------------------
PROGRESS: 64.0%
| epoch  65 |   100/  216 batches | lr 0.00000 | ms/batch 77.10 | loss  3.01 | ppl    20.35 
| epoch  65 |   200/  216 batches | lr 0.00000 | ms/batch 75.63 | loss  2.98 | ppl    19.78 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 16.96s | valid loss  4.16 | valid ppl    64.26 | valid bpc    6.006
-----------------------------------------------------------------------------------------
PROGRESS: 65.0%
| epoch  66 |   100/  216 batches | lr 0.00000 | ms/batch 77.19 | loss  3.02 | ppl    20.52 
| epoch  66 |   200/  216 batches | lr 0.00000 | ms/batch 75.52 | loss  3.00 | ppl    20.02 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 16.95s | valid loss  4.20 | valid ppl    66.70 | valid bpc    6.060
-----------------------------------------------------------------------------------------
PROGRESS: 66.0%
| epoch  67 |   100/  216 batches | lr 0.00000 | ms/batch 76.50 | loss  3.00 | ppl    20.09 
| epoch  67 |   200/  216 batches | lr 0.00000 | ms/batch 75.96 | loss  2.98 | ppl    19.71 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 16.95s | valid loss  4.14 | valid ppl    62.63 | valid bpc    5.969
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 67.0%
| epoch  68 |   100/  216 batches | lr 0.00000 | ms/batch 77.05 | loss  3.00 | ppl    20.06 
| epoch  68 |   200/  216 batches | lr 0.00000 | ms/batch 75.63 | loss  2.97 | ppl    19.54 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 16.94s | valid loss  4.19 | valid ppl    66.01 | valid bpc    6.045
-----------------------------------------------------------------------------------------
PROGRESS: 68.0%
| epoch  69 |   100/  216 batches | lr 0.00000 | ms/batch 76.67 | loss  3.02 | ppl    20.52 
| epoch  69 |   200/  216 batches | lr 0.00000 | ms/batch 76.08 | loss  2.98 | ppl    19.76 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 16.96s | valid loss  4.20 | valid ppl    66.58 | valid bpc    6.057
-----------------------------------------------------------------------------------------
PROGRESS: 69.0%
| epoch  70 |   100/  216 batches | lr 0.00000 | ms/batch 76.93 | loss  3.01 | ppl    20.22 
| epoch  70 |   200/  216 batches | lr 0.00000 | ms/batch 75.76 | loss  2.98 | ppl    19.65 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 16.95s | valid loss  4.16 | valid ppl    63.97 | valid bpc    5.999
-----------------------------------------------------------------------------------------
PROGRESS: 70.0%
| epoch  71 |   100/  216 batches | lr 0.00000 | ms/batch 76.85 | loss  3.03 | ppl    20.60 
| epoch  71 |   200/  216 batches | lr 0.00000 | ms/batch 75.96 | loss  2.99 | ppl    19.90 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 16.96s | valid loss  4.19 | valid ppl    65.82 | valid bpc    6.041
-----------------------------------------------------------------------------------------
PROGRESS: 71.0%
| epoch  72 |   100/  216 batches | lr 0.00000 | ms/batch 76.45 | loss  2.99 | ppl    19.97 
| epoch  72 |   200/  216 batches | lr 0.00000 | ms/batch 76.23 | loss  2.99 | ppl    19.89 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 16.95s | valid loss  4.18 | valid ppl    65.63 | valid bpc    6.036
-----------------------------------------------------------------------------------------
PROGRESS: 72.0%
| epoch  73 |   100/  216 batches | lr 0.00000 | ms/batch 76.90 | loss  3.01 | ppl    20.20 
| epoch  73 |   200/  216 batches | lr 0.00000 | ms/batch 75.93 | loss  2.99 | ppl    19.83 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 16.96s | valid loss  4.21 | valid ppl    67.59 | valid bpc    6.079
-----------------------------------------------------------------------------------------
PROGRESS: 73.0%
| epoch  74 |   100/  216 batches | lr 0.00000 | ms/batch 77.05 | loss  3.02 | ppl    20.43 
| epoch  74 |   200/  216 batches | lr 0.00000 | ms/batch 75.51 | loss  2.96 | ppl    19.39 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 16.95s | valid loss  4.18 | valid ppl    65.49 | valid bpc    6.033
-----------------------------------------------------------------------------------------
PROGRESS: 74.0%
| epoch  75 |   100/  216 batches | lr 0.00000 | ms/batch 76.59 | loss  3.00 | ppl    20.07 
| epoch  75 |   200/  216 batches | lr 0.00000 | ms/batch 76.08 | loss  2.98 | ppl    19.64 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 16.95s | valid loss  4.20 | valid ppl    66.72 | valid bpc    6.060
-----------------------------------------------------------------------------------------
PROGRESS: 75.0%
| epoch  76 |   100/  216 batches | lr 0.00000 | ms/batch 77.22 | loss  3.01 | ppl    20.24 
| epoch  76 |   200/  216 batches | lr 0.00000 | ms/batch 75.61 | loss  2.99 | ppl    19.82 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 16.96s | valid loss  4.20 | valid ppl    66.71 | valid bpc    6.060
-----------------------------------------------------------------------------------------
PROGRESS: 76.0%
| epoch  77 |   100/  216 batches | lr 0.00000 | ms/batch 76.66 | loss  3.01 | ppl    20.31 
| epoch  77 |   200/  216 batches | lr 0.00000 | ms/batch 76.01 | loss  2.98 | ppl    19.78 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 16.96s | valid loss  4.20 | valid ppl    66.45 | valid bpc    6.054
-----------------------------------------------------------------------------------------
PROGRESS: 77.0%
| epoch  78 |   100/  216 batches | lr 0.00000 | ms/batch 77.07 | loss  3.02 | ppl    20.57 
| epoch  78 |   200/  216 batches | lr 0.00000 | ms/batch 75.66 | loss  2.97 | ppl    19.52 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 16.95s | valid loss  4.15 | valid ppl    63.41 | valid bpc    5.987
-----------------------------------------------------------------------------------------
PROGRESS: 78.0%
| epoch  79 |   100/  216 batches | lr 0.00000 | ms/batch 76.67 | loss  3.00 | ppl    20.14 
| epoch  79 |   200/  216 batches | lr 0.00000 | ms/batch 75.90 | loss  2.98 | ppl    19.74 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 16.95s | valid loss  4.19 | valid ppl    65.80 | valid bpc    6.040
-----------------------------------------------------------------------------------------
PROGRESS: 79.0%
| epoch  80 |   100/  216 batches | lr 0.00000 | ms/batch 76.97 | loss  3.03 | ppl    20.77 
| epoch  80 |   200/  216 batches | lr 0.00000 | ms/batch 75.73 | loss  2.95 | ppl    19.19 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 16.97s | valid loss  4.18 | valid ppl    65.30 | valid bpc    6.029
-----------------------------------------------------------------------------------------
PROGRESS: 80.0%
| epoch  81 |   100/  216 batches | lr 0.00000 | ms/batch 76.74 | loss  2.99 | ppl    19.80 
| epoch  81 |   200/  216 batches | lr 0.00000 | ms/batch 76.06 | loss  2.98 | ppl    19.76 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 16.96s | valid loss  4.20 | valid ppl    66.93 | valid bpc    6.065
-----------------------------------------------------------------------------------------
PROGRESS: 81.0%
| epoch  82 |   100/  216 batches | lr 0.00000 | ms/batch 77.02 | loss  3.03 | ppl    20.72 
| epoch  82 |   200/  216 batches | lr 0.00000 | ms/batch 75.73 | loss  2.97 | ppl    19.43 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 16.96s | valid loss  4.21 | valid ppl    67.42 | valid bpc    6.075
-----------------------------------------------------------------------------------------
PROGRESS: 82.0%
| epoch  83 |   100/  216 batches | lr 0.00000 | ms/batch 76.82 | loss  3.02 | ppl    20.46 
| epoch  83 |   200/  216 batches | lr 0.00000 | ms/batch 76.05 | loss  2.97 | ppl    19.52 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 16.96s | valid loss  4.19 | valid ppl    65.97 | valid bpc    6.044
-----------------------------------------------------------------------------------------
PROGRESS: 83.0%
| epoch  84 |   100/  216 batches | lr 0.00000 | ms/batch 76.78 | loss  2.99 | ppl    19.91 
| epoch  84 |   200/  216 batches | lr 0.00000 | ms/batch 75.92 | loss  2.99 | ppl    19.95 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 16.96s | valid loss  4.22 | valid ppl    67.86 | valid bpc    6.085
-----------------------------------------------------------------------------------------
PROGRESS: 84.0%
| epoch  85 |   100/  216 batches | lr 0.00000 | ms/batch 77.43 | loss  3.02 | ppl    20.49 
| epoch  85 |   200/  216 batches | lr 0.00000 | ms/batch 75.42 | loss  2.96 | ppl    19.29 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 16.97s | valid loss  4.20 | valid ppl    66.99 | valid bpc    6.066
-----------------------------------------------------------------------------------------
PROGRESS: 85.0%
| epoch  86 |   100/  216 batches | lr 0.00000 | ms/batch 76.80 | loss  2.99 | ppl    19.97 
| epoch  86 |   200/  216 batches | lr 0.00000 | ms/batch 75.49 | loss  2.98 | ppl    19.67 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 16.95s | valid loss  4.21 | valid ppl    67.44 | valid bpc    6.076
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  216 batches | lr 0.00000 | ms/batch 77.20 | loss  3.01 | ppl    20.39 
| epoch  87 |   200/  216 batches | lr 0.00000 | ms/batch 75.47 | loss  2.97 | ppl    19.43 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 16.95s | valid loss  4.23 | valid ppl    68.60 | valid bpc    6.100
-----------------------------------------------------------------------------------------
PROGRESS: 87.0%
| epoch  88 |   100/  216 batches | lr 0.00000 | ms/batch 77.13 | loss  3.01 | ppl    20.36 
| epoch  88 |   200/  216 batches | lr 0.00000 | ms/batch 75.66 | loss  2.98 | ppl    19.66 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 16.96s | valid loss  4.20 | valid ppl    66.63 | valid bpc    6.058
-----------------------------------------------------------------------------------------
PROGRESS: 88.0%
| epoch  89 |   100/  216 batches | lr 0.00000 | ms/batch 76.91 | loss  3.00 | ppl    20.13 
| epoch  89 |   200/  216 batches | lr 0.00000 | ms/batch 75.74 | loss  2.98 | ppl    19.71 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 16.95s | valid loss  4.20 | valid ppl    66.91 | valid bpc    6.064
-----------------------------------------------------------------------------------------
PROGRESS: 89.0%
| epoch  90 |   100/  216 batches | lr 0.00000 | ms/batch 76.86 | loss  3.02 | ppl    20.45 
| epoch  90 |   200/  216 batches | lr 0.00000 | ms/batch 75.88 | loss  2.98 | ppl    19.66 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 16.96s | valid loss  4.19 | valid ppl    66.16 | valid bpc    6.048
-----------------------------------------------------------------------------------------
PROGRESS: 90.0%
| epoch  91 |   100/  216 batches | lr 0.00000 | ms/batch 76.70 | loss  2.99 | ppl    19.98 
| epoch  91 |   200/  216 batches | lr 0.00000 | ms/batch 76.09 | loss  3.00 | ppl    20.16 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 16.97s | valid loss  4.21 | valid ppl    67.03 | valid bpc    6.067
-----------------------------------------------------------------------------------------
PROGRESS: 91.0%
| epoch  92 |   100/  216 batches | lr 0.00000 | ms/batch 76.43 | loss  2.99 | ppl    19.91 
| epoch  92 |   200/  216 batches | lr 0.00000 | ms/batch 76.22 | loss  3.00 | ppl    20.01 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 16.95s | valid loss  4.20 | valid ppl    66.36 | valid bpc    6.052
-----------------------------------------------------------------------------------------
PROGRESS: 92.0%
| epoch  93 |   100/  216 batches | lr 0.00000 | ms/batch 77.12 | loss  3.02 | ppl    20.48 
| epoch  93 |   200/  216 batches | lr 0.00000 | ms/batch 75.74 | loss  2.98 | ppl    19.68 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 16.96s | valid loss  4.19 | valid ppl    66.06 | valid bpc    6.046
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  216 batches | lr 0.00000 | ms/batch 76.79 | loss  3.00 | ppl    19.99 
| epoch  94 |   200/  216 batches | lr 0.00000 | ms/batch 75.87 | loss  3.00 | ppl    20.03 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 16.95s | valid loss  4.18 | valid ppl    65.44 | valid bpc    6.032
-----------------------------------------------------------------------------------------
PROGRESS: 94.0%
| epoch  95 |   100/  216 batches | lr 0.00000 | ms/batch 76.78 | loss  3.01 | ppl    20.33 
| epoch  95 |   200/  216 batches | lr 0.00000 | ms/batch 75.85 | loss  2.97 | ppl    19.51 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 16.96s | valid loss  4.18 | valid ppl    65.04 | valid bpc    6.023
-----------------------------------------------------------------------------------------
PROGRESS: 95.0%
| epoch  96 |   100/  216 batches | lr 0.00000 | ms/batch 76.84 | loss  2.98 | ppl    19.70 
| epoch  96 |   200/  216 batches | lr 0.00000 | ms/batch 75.92 | loss  2.97 | ppl    19.57 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 16.96s | valid loss  4.19 | valid ppl    66.13 | valid bpc    6.047
-----------------------------------------------------------------------------------------
PROGRESS: 96.0%
| epoch  97 |   100/  216 batches | lr 0.00000 | ms/batch 76.61 | loss  3.02 | ppl    20.56 
| epoch  97 |   200/  216 batches | lr 0.00000 | ms/batch 76.10 | loss  2.98 | ppl    19.65 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 16.96s | valid loss  4.19 | valid ppl    65.86 | valid bpc    6.041
-----------------------------------------------------------------------------------------
PROGRESS: 97.0%
| epoch  98 |   100/  216 batches | lr 0.00000 | ms/batch 76.97 | loss  2.99 | ppl    19.92 
| epoch  98 |   200/  216 batches | lr 0.00000 | ms/batch 75.69 | loss  2.98 | ppl    19.66 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 16.96s | valid loss  4.21 | valid ppl    67.60 | valid bpc    6.079
-----------------------------------------------------------------------------------------
PROGRESS: 98.0%
| epoch  99 |   100/  216 batches | lr 0.00000 | ms/batch 77.03 | loss  3.00 | ppl    20.02 
| epoch  99 |   200/  216 batches | lr 0.00000 | ms/batch 75.62 | loss  2.97 | ppl    19.56 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 16.96s | valid loss  4.16 | valid ppl    64.07 | valid bpc    6.002
-----------------------------------------------------------------------------------------
PROGRESS: 99.0%
| epoch 100 |   100/  216 batches | lr 0.00000 | ms/batch 77.32 | loss  3.01 | ppl    20.28 
| epoch 100 |   200/  216 batches | lr 0.00000 | ms/batch 75.65 | loss  2.99 | ppl    19.80 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 16.98s | valid loss  4.21 | valid ppl    67.22 | valid bpc    6.071
-----------------------------------------------------------------------------------------
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  4.12 | test ppl    61.57 | test bpc    5.944
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.3920, Mean Reca: 0.5414, Mean F1: 0.4467
Counter({'NP': 9083, 'PP': 3483, 'S': 3131, 'VP': 2270, 'SBAR': 428, 'QP': 333, 'ADJP': 280, 'ADVP': 156, 'SINV': 146, 'FRAG': 34, 'PRN': 32, 'WHNP': 28, 'NAC': 16, 'UCP': 11, 'CONJP': 10, 'SQ': 10, 'SBARQ': 9, 'NX': 8, 'WHPP': 6, 'X': 3, 'WHADVP': 2, 'WHADJP': 1})
Counter({'NP': 14432, 'VP': 8130, 'S': 5620, 'PP': 5484, 'SBAR': 1796, 'ADJP': 649, 'QP': 490, 'ADVP': 286, 'SINV': 157, 'PRN': 128, 'NX': 95, 'FRAG': 42, 'WHNP': 37, 'UCP': 32, 'NAC': 30, 'WHPP': 25, 'CONJP': 21, 'SQ': 18, 'SBARQ': 10, 'WHADVP': 9, 'X': 6, 'WHADJP': 4, 'INTJ': 1})
SBAR: 0.2383
NP: 0.6294
VP: 0.2792
PP: 0.6351
ADJP: 0.4314
ADVP: 0.5455
4.9686579432180045
-----------------------------------------------------------------------------------------
Dependency parsing performance:
Conll-U Style:
DDA: 0.406
UDA: 0.531
=========================================================================================
Loading dataset...
Loading dictionary...
Number of tokens:  10001
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer_in_parser', nhid=512, nlayers=8, front_layers=6, rear_layers=2, n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=1111, nonmono=5, cuda=True, log_interval=100, save='trained_models/structformer_in_parser_1111_62.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 38475573
Model architecture: StructFormer_In_Parser(
  (transformer_front): Transformer_Front(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(10001, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-5): 6 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
  (transformer_rear): Transformer_Rear(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(10001, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-1): 2 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (output_layer): Linear(in_features=512, out_features=10001, bias=True)
  )
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  216 batches | lr 0.00030 | ms/batch 78.35 | loss  7.31 | ppl  1497.81 
| epoch   1 |   200/  216 batches | lr 0.00030 | ms/batch 73.70 | loss  6.86 | ppl   951.00 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 16.86s | valid loss  6.73 | valid ppl   839.64 | valid bpc    9.714
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  216 batches | lr 0.00030 | ms/batch 75.49 | loss  6.83 | ppl   925.44 
| epoch   2 |   200/  216 batches | lr 0.00030 | ms/batch 73.70 | loss  6.51 | ppl   672.94 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 16.58s | valid loss  6.31 | valid ppl   547.54 | valid bpc    9.097
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  216 batches | lr 0.00030 | ms/batch 75.12 | loss  6.31 | ppl   552.02 
| epoch   3 |   200/  216 batches | lr 0.00030 | ms/batch 74.17 | loss  6.05 | ppl   424.75 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 16.62s | valid loss  5.86 | valid ppl   349.01 | valid bpc    8.447
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  216 batches | lr 0.00030 | ms/batch 75.08 | loss  5.86 | ppl   350.72 
| epoch   4 |   200/  216 batches | lr 0.00030 | ms/batch 74.21 | loss  5.68 | ppl   293.59 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 16.64s | valid loss  5.55 | valid ppl   257.90 | valid bpc    8.011
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  216 batches | lr 0.00030 | ms/batch 75.28 | loss  5.56 | ppl   259.39 
| epoch   5 |   200/  216 batches | lr 0.00030 | ms/batch 74.69 | loss  5.44 | ppl   230.95 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 16.66s | valid loss  5.37 | valid ppl   214.02 | valid bpc    7.742
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  216 batches | lr 0.00030 | ms/batch 75.96 | loss  5.37 | ppl   215.92 
| epoch   6 |   200/  216 batches | lr 0.00030 | ms/batch 74.15 | loss  5.26 | ppl   191.95 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 16.67s | valid loss  5.21 | valid ppl   182.64 | valid bpc    7.513
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  216 batches | lr 0.00030 | ms/batch 75.36 | loss  5.19 | ppl   180.13 
| epoch   7 |   200/  216 batches | lr 0.00030 | ms/batch 74.65 | loss  5.11 | ppl   166.49 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 16.66s | valid loss  5.11 | valid ppl   166.45 | valid bpc    7.379
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  216 batches | lr 0.00030 | ms/batch 75.39 | loss  5.06 | ppl   158.11 
| epoch   8 |   200/  216 batches | lr 0.00030 | ms/batch 74.67 | loss  4.98 | ppl   145.66 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 16.67s | valid loss  4.97 | valid ppl   143.39 | valid bpc    7.164
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 8.0%
| epoch   9 |   100/  216 batches | lr 0.00030 | ms/batch 75.69 | loss  4.94 | ppl   139.71 
| epoch   9 |   200/  216 batches | lr 0.00030 | ms/batch 74.36 | loss  4.90 | ppl   133.88 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 16.67s | valid loss  4.91 | valid ppl   136.11 | valid bpc    7.089
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  216 batches | lr 0.00030 | ms/batch 75.45 | loss  4.84 | ppl   126.94 
| epoch  10 |   200/  216 batches | lr 0.00030 | ms/batch 74.72 | loss  4.80 | ppl   121.27 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 16.68s | valid loss  4.85 | valid ppl   128.24 | valid bpc    7.003
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  216 batches | lr 0.00030 | ms/batch 75.55 | loss  4.75 | ppl   115.66 
| epoch  11 |   200/  216 batches | lr 0.00030 | ms/batch 74.60 | loss  4.71 | ppl   110.89 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 16.68s | valid loss  4.75 | valid ppl   116.06 | valid bpc    6.859
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  216 batches | lr 0.00030 | ms/batch 75.80 | loss  4.67 | ppl   106.49 
| epoch  12 |   200/  216 batches | lr 0.00030 | ms/batch 74.45 | loss  4.60 | ppl    99.03 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 16.68s | valid loss  4.69 | valid ppl   108.73 | valid bpc    6.765
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 12.0%
| epoch  13 |   100/  216 batches | lr 0.00030 | ms/batch 75.39 | loss  4.60 | ppl    99.93 
| epoch  13 |   200/  216 batches | lr 0.00030 | ms/batch 74.81 | loss  4.52 | ppl    91.85 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 16.68s | valid loss  4.70 | valid ppl   110.18 | valid bpc    6.784
-----------------------------------------------------------------------------------------
PROGRESS: 13.0%
| epoch  14 |   100/  216 batches | lr 0.00030 | ms/batch 76.06 | loss  4.52 | ppl    92.13 
| epoch  14 |   200/  216 batches | lr 0.00030 | ms/batch 74.15 | loss  4.46 | ppl    86.34 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 16.69s | valid loss  4.68 | valid ppl   107.25 | valid bpc    6.745
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  216 batches | lr 0.00030 | ms/batch 75.93 | loss  4.43 | ppl    83.88 
| epoch  15 |   200/  216 batches | lr 0.00030 | ms/batch 74.33 | loss  4.38 | ppl    80.15 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 16.69s | valid loss  4.60 | valid ppl    99.32 | valid bpc    6.634
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 15.0%
| epoch  16 |   100/  216 batches | lr 0.00030 | ms/batch 75.56 | loss  4.36 | ppl    78.05 
| epoch  16 |   200/  216 batches | lr 0.00030 | ms/batch 74.65 | loss  4.32 | ppl    75.11 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 16.68s | valid loss  4.56 | valid ppl    95.78 | valid bpc    6.582
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 16.0%
| epoch  17 |   100/  216 batches | lr 0.00030 | ms/batch 76.13 | loss  4.29 | ppl    73.32 
| epoch  17 |   200/  216 batches | lr 0.00030 | ms/batch 74.18 | loss  4.25 | ppl    70.33 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 16.69s | valid loss  4.52 | valid ppl    92.04 | valid bpc    6.524
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 17.0%
| epoch  18 |   100/  216 batches | lr 0.00030 | ms/batch 75.83 | loss  4.24 | ppl    69.18 
| epoch  18 |   200/  216 batches | lr 0.00030 | ms/batch 74.31 | loss  4.22 | ppl    67.82 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 16.68s | valid loss  4.53 | valid ppl    92.84 | valid bpc    6.537
-----------------------------------------------------------------------------------------
PROGRESS: 18.0%
| epoch  19 |   100/  216 batches | lr 0.00030 | ms/batch 75.75 | loss  4.19 | ppl    66.12 
| epoch  19 |   200/  216 batches | lr 0.00030 | ms/batch 74.39 | loss  4.16 | ppl    64.08 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 16.69s | valid loss  4.45 | valid ppl    85.60 | valid bpc    6.420
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 19.0%
| epoch  20 |   100/  216 batches | lr 0.00030 | ms/batch 75.69 | loss  4.15 | ppl    63.18 
| epoch  20 |   200/  216 batches | lr 0.00030 | ms/batch 74.49 | loss  4.11 | ppl    60.79 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 16.68s | valid loss  4.42 | valid ppl    83.11 | valid bpc    6.377
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 20.0%
| epoch  21 |   100/  216 batches | lr 0.00030 | ms/batch 75.38 | loss  4.08 | ppl    58.86 
| epoch  21 |   200/  216 batches | lr 0.00030 | ms/batch 74.81 | loss  4.05 | ppl    57.32 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 16.68s | valid loss  4.42 | valid ppl    83.35 | valid bpc    6.381
-----------------------------------------------------------------------------------------
PROGRESS: 21.0%
| epoch  22 |   100/  216 batches | lr 0.00030 | ms/batch 75.56 | loss  4.02 | ppl    55.77 
| epoch  22 |   200/  216 batches | lr 0.00030 | ms/batch 74.63 | loss  4.02 | ppl    55.81 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 16.68s | valid loss  4.42 | valid ppl    83.37 | valid bpc    6.381
-----------------------------------------------------------------------------------------
PROGRESS: 22.0%
| epoch  23 |   100/  216 batches | lr 0.00030 | ms/batch 75.93 | loss  3.97 | ppl    52.84 
| epoch  23 |   200/  216 batches | lr 0.00030 | ms/batch 74.36 | loss  3.97 | ppl    52.81 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 16.69s | valid loss  4.45 | valid ppl    85.69 | valid bpc    6.421
-----------------------------------------------------------------------------------------
PROGRESS: 23.0%
| epoch  24 |   100/  216 batches | lr 0.00015 | ms/batch 75.57 | loss  3.91 | ppl    49.92 
| epoch  24 |   200/  216 batches | lr 0.00015 | ms/batch 74.63 | loss  3.85 | ppl    46.87 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 16.69s | valid loss  4.36 | valid ppl    78.56 | valid bpc    6.296
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 24.0%
| epoch  25 |   100/  216 batches | lr 0.00015 | ms/batch 76.06 | loss  3.86 | ppl    47.50 
| epoch  25 |   200/  216 batches | lr 0.00015 | ms/batch 74.13 | loss  3.78 | ppl    44.03 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 16.68s | valid loss  4.29 | valid ppl    73.15 | valid bpc    6.193
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 25.0%
| epoch  26 |   100/  216 batches | lr 0.00015 | ms/batch 75.36 | loss  3.79 | ppl    44.21 
| epoch  26 |   200/  216 batches | lr 0.00015 | ms/batch 74.73 | loss  3.78 | ppl    43.94 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 16.68s | valid loss  4.31 | valid ppl    74.62 | valid bpc    6.221
-----------------------------------------------------------------------------------------
PROGRESS: 26.0%
| epoch  27 |   100/  216 batches | lr 0.00015 | ms/batch 75.80 | loss  3.78 | ppl    43.62 
| epoch  27 |   200/  216 batches | lr 0.00015 | ms/batch 74.42 | loss  3.72 | ppl    41.43 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 16.69s | valid loss  4.29 | valid ppl    72.90 | valid bpc    6.188
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 27.0%
| epoch  28 |   100/  216 batches | lr 0.00015 | ms/batch 75.74 | loss  3.75 | ppl    42.31 
| epoch  28 |   200/  216 batches | lr 0.00015 | ms/batch 74.39 | loss  3.70 | ppl    40.62 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 16.68s | valid loss  4.31 | valid ppl    74.65 | valid bpc    6.222
-----------------------------------------------------------------------------------------
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  216 batches | lr 0.00015 | ms/batch 75.41 | loss  3.70 | ppl    40.33 
| epoch  29 |   200/  216 batches | lr 0.00015 | ms/batch 74.81 | loss  3.68 | ppl    39.79 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 16.69s | valid loss  4.27 | valid ppl    71.35 | valid bpc    6.157
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  216 batches | lr 0.00015 | ms/batch 75.87 | loss  3.67 | ppl    39.36 
| epoch  30 |   200/  216 batches | lr 0.00015 | ms/batch 74.25 | loss  3.65 | ppl    38.65 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 16.68s | valid loss  4.28 | valid ppl    71.94 | valid bpc    6.169
-----------------------------------------------------------------------------------------
PROGRESS: 30.0%
| epoch  31 |   100/  216 batches | lr 0.00015 | ms/batch 75.31 | loss  3.64 | ppl    38.15 
| epoch  31 |   200/  216 batches | lr 0.00015 | ms/batch 74.82 | loss  3.65 | ppl    38.36 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 16.68s | valid loss  4.28 | valid ppl    72.23 | valid bpc    6.175
-----------------------------------------------------------------------------------------
PROGRESS: 31.0%
| epoch  32 |   100/  216 batches | lr 0.00015 | ms/batch 75.84 | loss  3.65 | ppl    38.34 
| epoch  32 |   200/  216 batches | lr 0.00015 | ms/batch 74.33 | loss  3.61 | ppl    37.02 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 16.68s | valid loss  4.25 | valid ppl    69.76 | valid bpc    6.124
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 32.0%
| epoch  33 |   100/  216 batches | lr 0.00015 | ms/batch 75.53 | loss  3.60 | ppl    36.57 
| epoch  33 |   200/  216 batches | lr 0.00015 | ms/batch 74.67 | loss  3.57 | ppl    35.69 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 16.68s | valid loss  4.29 | valid ppl    72.87 | valid bpc    6.187
-----------------------------------------------------------------------------------------
PROGRESS: 33.0%
| epoch  34 |   100/  216 batches | lr 0.00015 | ms/batch 75.96 | loss  3.58 | ppl    35.91 
| epoch  34 |   200/  216 batches | lr 0.00015 | ms/batch 74.24 | loss  3.54 | ppl    34.46 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 16.69s | valid loss  4.26 | valid ppl    70.81 | valid bpc    6.146
-----------------------------------------------------------------------------------------
PROGRESS: 34.0%
| epoch  35 |   100/  216 batches | lr 0.00015 | ms/batch 75.45 | loss  3.55 | ppl    34.75 
| epoch  35 |   200/  216 batches | lr 0.00015 | ms/batch 74.75 | loss  3.55 | ppl    34.88 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 16.68s | valid loss  4.25 | valid ppl    70.29 | valid bpc    6.135
-----------------------------------------------------------------------------------------
PROGRESS: 35.0%
| epoch  36 |   100/  216 batches | lr 0.00007 | ms/batch 75.82 | loss  3.51 | ppl    33.34 
| epoch  36 |   200/  216 batches | lr 0.00007 | ms/batch 74.42 | loss  3.46 | ppl    31.96 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 16.69s | valid loss  4.25 | valid ppl    70.02 | valid bpc    6.130
-----------------------------------------------------------------------------------------
PROGRESS: 36.0%
| epoch  37 |   100/  216 batches | lr 0.00007 | ms/batch 75.70 | loss  3.46 | ppl    31.83 
| epoch  37 |   200/  216 batches | lr 0.00007 | ms/batch 74.55 | loss  3.44 | ppl    31.08 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 16.69s | valid loss  4.23 | valid ppl    68.71 | valid bpc    6.103
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 37.0%
| epoch  38 |   100/  216 batches | lr 0.00007 | ms/batch 75.67 | loss  3.45 | ppl    31.63 
| epoch  38 |   200/  216 batches | lr 0.00007 | ms/batch 74.50 | loss  3.45 | ppl    31.34 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 16.68s | valid loss  4.23 | valid ppl    68.42 | valid bpc    6.096
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 38.0%
| epoch  39 |   100/  216 batches | lr 0.00007 | ms/batch 75.69 | loss  3.45 | ppl    31.62 
| epoch  39 |   200/  216 batches | lr 0.00007 | ms/batch 74.52 | loss  3.41 | ppl    30.16 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 16.68s | valid loss  4.22 | valid ppl    68.05 | valid bpc    6.089
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 39.0%
| epoch  40 |   100/  216 batches | lr 0.00007 | ms/batch 75.57 | loss  3.44 | ppl    31.21 
| epoch  40 |   200/  216 batches | lr 0.00007 | ms/batch 74.56 | loss  3.42 | ppl    30.42 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 16.68s | valid loss  4.23 | valid ppl    68.82 | valid bpc    6.105
-----------------------------------------------------------------------------------------
PROGRESS: 40.0%
| epoch  41 |   100/  216 batches | lr 0.00007 | ms/batch 75.96 | loss  3.42 | ppl    30.49 
| epoch  41 |   200/  216 batches | lr 0.00007 | ms/batch 74.21 | loss  3.38 | ppl    29.35 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 16.69s | valid loss  4.22 | valid ppl    68.35 | valid bpc    6.095
-----------------------------------------------------------------------------------------
PROGRESS: 41.0%
| epoch  42 |   100/  216 batches | lr 0.00007 | ms/batch 76.10 | loss  3.40 | ppl    29.97 
| epoch  42 |   200/  216 batches | lr 0.00007 | ms/batch 74.02 | loss  3.37 | ppl    29.05 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 16.68s | valid loss  4.21 | valid ppl    67.42 | valid bpc    6.075
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 42.0%
| epoch  43 |   100/  216 batches | lr 0.00007 | ms/batch 75.89 | loss  3.39 | ppl    29.70 
| epoch  43 |   200/  216 batches | lr 0.00007 | ms/batch 74.18 | loss  3.37 | ppl    28.99 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 16.67s | valid loss  4.20 | valid ppl    66.40 | valid bpc    6.053
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 43.0%
| epoch  44 |   100/  216 batches | lr 0.00007 | ms/batch 75.30 | loss  3.38 | ppl    29.44 
| epoch  44 |   200/  216 batches | lr 0.00007 | ms/batch 74.76 | loss  3.32 | ppl    27.56 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 16.68s | valid loss  4.21 | valid ppl    67.43 | valid bpc    6.075
-----------------------------------------------------------------------------------------
PROGRESS: 44.0%
| epoch  45 |   100/  216 batches | lr 0.00007 | ms/batch 75.83 | loss  3.34 | ppl    28.09 
| epoch  45 |   200/  216 batches | lr 0.00007 | ms/batch 74.40 | loss  3.33 | ppl    27.89 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 16.69s | valid loss  4.21 | valid ppl    67.31 | valid bpc    6.073
-----------------------------------------------------------------------------------------
PROGRESS: 45.0%
| epoch  46 |   100/  216 batches | lr 0.00007 | ms/batch 75.95 | loss  3.35 | ppl    28.47 
| epoch  46 |   200/  216 batches | lr 0.00007 | ms/batch 74.22 | loss  3.28 | ppl    26.71 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 16.69s | valid loss  4.23 | valid ppl    69.00 | valid bpc    6.109
-----------------------------------------------------------------------------------------
PROGRESS: 46.0%
| epoch  47 |   100/  216 batches | lr 0.00004 | ms/batch 75.69 | loss  3.31 | ppl    27.52 
| epoch  47 |   200/  216 batches | lr 0.00004 | ms/batch 74.54 | loss  3.29 | ppl    26.86 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 16.69s | valid loss  4.23 | valid ppl    68.55 | valid bpc    6.099
-----------------------------------------------------------------------------------------
PROGRESS: 47.0%
| epoch  48 |   100/  216 batches | lr 0.00004 | ms/batch 75.73 | loss  3.31 | ppl    27.34 
| epoch  48 |   200/  216 batches | lr 0.00004 | ms/batch 74.12 | loss  3.26 | ppl    26.10 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 16.69s | valid loss  4.19 | valid ppl    65.78 | valid bpc    6.040
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 48.0%
| epoch  49 |   100/  216 batches | lr 0.00004 | ms/batch 75.52 | loss  3.28 | ppl    26.59 
| epoch  49 |   200/  216 batches | lr 0.00004 | ms/batch 74.72 | loss  3.27 | ppl    26.18 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 16.68s | valid loss  4.20 | valid ppl    66.87 | valid bpc    6.063
-----------------------------------------------------------------------------------------
PROGRESS: 49.0%
| epoch  50 |   100/  216 batches | lr 0.00004 | ms/batch 75.37 | loss  3.27 | ppl    26.29 
| epoch  50 |   200/  216 batches | lr 0.00004 | ms/batch 74.89 | loss  3.25 | ppl    25.73 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 16.69s | valid loss  4.25 | valid ppl    69.76 | valid bpc    6.124
-----------------------------------------------------------------------------------------
PROGRESS: 50.0%
| epoch  51 |   100/  216 batches | lr 0.00004 | ms/batch 75.91 | loss  3.25 | ppl    25.90 
| epoch  51 |   200/  216 batches | lr 0.00004 | ms/batch 74.28 | loss  3.24 | ppl    25.58 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 16.68s | valid loss  4.21 | valid ppl    67.20 | valid bpc    6.070
-----------------------------------------------------------------------------------------
PROGRESS: 51.0%
| epoch  52 |   100/  216 batches | lr 0.00002 | ms/batch 75.43 | loss  3.26 | ppl    26.08 
| epoch  52 |   200/  216 batches | lr 0.00002 | ms/batch 74.77 | loss  3.23 | ppl    25.33 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 16.69s | valid loss  4.19 | valid ppl    66.13 | valid bpc    6.047
-----------------------------------------------------------------------------------------
PROGRESS: 52.0%
| epoch  53 |   100/  216 batches | lr 0.00002 | ms/batch 76.08 | loss  3.28 | ppl    26.47 
| epoch  53 |   200/  216 batches | lr 0.00002 | ms/batch 74.14 | loss  3.21 | ppl    24.82 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 16.69s | valid loss  4.23 | valid ppl    68.80 | valid bpc    6.104
-----------------------------------------------------------------------------------------
PROGRESS: 53.0%
| epoch  54 |   100/  216 batches | lr 0.00002 | ms/batch 75.50 | loss  3.25 | ppl    25.85 
| epoch  54 |   200/  216 batches | lr 0.00002 | ms/batch 74.76 | loss  3.19 | ppl    24.34 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 16.68s | valid loss  4.20 | valid ppl    66.72 | valid bpc    6.060
-----------------------------------------------------------------------------------------
PROGRESS: 54.0%
| epoch  55 |   100/  216 batches | lr 0.00001 | ms/batch 75.76 | loss  3.24 | ppl    25.47 
| epoch  55 |   200/  216 batches | lr 0.00001 | ms/batch 74.13 | loss  3.23 | ppl    25.34 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 16.69s | valid loss  4.20 | valid ppl    66.53 | valid bpc    6.056
-----------------------------------------------------------------------------------------
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  216 batches | lr 0.00001 | ms/batch 75.39 | loss  3.22 | ppl    24.91 
| epoch  56 |   200/  216 batches | lr 0.00001 | ms/batch 74.82 | loss  3.20 | ppl    24.64 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 16.69s | valid loss  4.20 | valid ppl    66.96 | valid bpc    6.065
-----------------------------------------------------------------------------------------
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  216 batches | lr 0.00001 | ms/batch 75.90 | loss  3.22 | ppl    24.96 
| epoch  57 |   200/  216 batches | lr 0.00001 | ms/batch 74.45 | loss  3.20 | ppl    24.44 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 16.69s | valid loss  4.22 | valid ppl    68.25 | valid bpc    6.093
-----------------------------------------------------------------------------------------
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  216 batches | lr 0.00000 | ms/batch 76.01 | loss  3.23 | ppl    25.31 
| epoch  58 |   200/  216 batches | lr 0.00000 | ms/batch 74.22 | loss  3.20 | ppl    24.54 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 16.69s | valid loss  4.17 | valid ppl    64.65 | valid bpc    6.015
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  216 batches | lr 0.00000 | ms/batch 75.84 | loss  3.23 | ppl    25.31 
| epoch  59 |   200/  216 batches | lr 0.00000 | ms/batch 74.30 | loss  3.20 | ppl    24.51 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 16.69s | valid loss  4.17 | valid ppl    64.97 | valid bpc    6.022
-----------------------------------------------------------------------------------------
PROGRESS: 59.0%
| epoch  60 |   100/  216 batches | lr 0.00000 | ms/batch 75.61 | loss  3.22 | ppl    25.13 
| epoch  60 |   200/  216 batches | lr 0.00000 | ms/batch 74.73 | loss  3.20 | ppl    24.46 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 16.69s | valid loss  4.17 | valid ppl    64.97 | valid bpc    6.022
-----------------------------------------------------------------------------------------
PROGRESS: 60.0%
| epoch  61 |   100/  216 batches | lr 0.00000 | ms/batch 75.60 | loss  3.22 | ppl    25.03 
| epoch  61 |   200/  216 batches | lr 0.00000 | ms/batch 74.70 | loss  3.20 | ppl    24.47 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 16.69s | valid loss  4.20 | valid ppl    67.01 | valid bpc    6.066
-----------------------------------------------------------------------------------------
PROGRESS: 61.0%
| epoch  62 |   100/  216 batches | lr 0.00000 | ms/batch 75.54 | loss  3.22 | ppl    25.02 
| epoch  62 |   200/  216 batches | lr 0.00000 | ms/batch 74.61 | loss  3.21 | ppl    24.81 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 16.69s | valid loss  4.20 | valid ppl    66.43 | valid bpc    6.054
-----------------------------------------------------------------------------------------
PROGRESS: 62.0%
| epoch  63 |   100/  216 batches | lr 0.00000 | ms/batch 75.58 | loss  3.22 | ppl    24.98 
| epoch  63 |   200/  216 batches | lr 0.00000 | ms/batch 74.35 | loss  3.20 | ppl    24.59 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 16.69s | valid loss  4.18 | valid ppl    65.30 | valid bpc    6.029
-----------------------------------------------------------------------------------------
PROGRESS: 63.0%
| epoch  64 |   100/  216 batches | lr 0.00000 | ms/batch 75.66 | loss  3.23 | ppl    25.21 
| epoch  64 |   200/  216 batches | lr 0.00000 | ms/batch 74.48 | loss  3.16 | ppl    23.59 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 16.69s | valid loss  4.18 | valid ppl    65.30 | valid bpc    6.029
-----------------------------------------------------------------------------------------
PROGRESS: 64.0%
| epoch  65 |   100/  216 batches | lr 0.00000 | ms/batch 75.49 | loss  3.22 | ppl    24.98 
| epoch  65 |   200/  216 batches | lr 0.00000 | ms/batch 74.65 | loss  3.18 | ppl    24.08 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 16.69s | valid loss  4.19 | valid ppl    66.25 | valid bpc    6.050
-----------------------------------------------------------------------------------------
PROGRESS: 65.0%
| epoch  66 |   100/  216 batches | lr 0.00000 | ms/batch 76.07 | loss  3.23 | ppl    25.37 
| epoch  66 |   200/  216 batches | lr 0.00000 | ms/batch 74.15 | loss  3.19 | ppl    24.17 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 16.69s | valid loss  4.20 | valid ppl    66.66 | valid bpc    6.059
-----------------------------------------------------------------------------------------
PROGRESS: 66.0%
| epoch  67 |   100/  216 batches | lr 0.00000 | ms/batch 75.94 | loss  3.25 | ppl    25.74 
| epoch  67 |   200/  216 batches | lr 0.00000 | ms/batch 74.33 | loss  3.17 | ppl    23.77 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 16.69s | valid loss  4.19 | valid ppl    66.04 | valid bpc    6.045
-----------------------------------------------------------------------------------------
PROGRESS: 67.0%
| epoch  68 |   100/  216 batches | lr 0.00000 | ms/batch 75.49 | loss  3.21 | ppl    24.88 
| epoch  68 |   200/  216 batches | lr 0.00000 | ms/batch 74.77 | loss  3.21 | ppl    24.79 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 16.69s | valid loss  4.17 | valid ppl    64.94 | valid bpc    6.021
-----------------------------------------------------------------------------------------
PROGRESS: 68.0%
| epoch  69 |   100/  216 batches | lr 0.00000 | ms/batch 76.04 | loss  3.23 | ppl    25.22 
| epoch  69 |   200/  216 batches | lr 0.00000 | ms/batch 74.32 | loss  3.18 | ppl    24.14 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 16.68s | valid loss  4.21 | valid ppl    67.11 | valid bpc    6.068
-----------------------------------------------------------------------------------------
PROGRESS: 69.0%
| epoch  70 |   100/  216 batches | lr 0.00000 | ms/batch 75.43 | loss  3.21 | ppl    24.82 
| epoch  70 |   200/  216 batches | lr 0.00000 | ms/batch 74.84 | loss  3.18 | ppl    23.93 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 16.68s | valid loss  4.22 | valid ppl    67.71 | valid bpc    6.081
-----------------------------------------------------------------------------------------
PROGRESS: 70.0%
| epoch  71 |   100/  216 batches | lr 0.00000 | ms/batch 75.38 | loss  3.23 | ppl    25.39 
| epoch  71 |   200/  216 batches | lr 0.00000 | ms/batch 74.61 | loss  3.19 | ppl    24.29 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 16.68s | valid loss  4.18 | valid ppl    65.18 | valid bpc    6.026
-----------------------------------------------------------------------------------------
PROGRESS: 71.0%
| epoch  72 |   100/  216 batches | lr 0.00000 | ms/batch 75.45 | loss  3.25 | ppl    25.69 
| epoch  72 |   200/  216 batches | lr 0.00000 | ms/batch 74.82 | loss  3.16 | ppl    23.62 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 16.69s | valid loss  4.16 | valid ppl    64.37 | valid bpc    6.008
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 72.0%
| epoch  73 |   100/  216 batches | lr 0.00000 | ms/batch 75.73 | loss  3.24 | ppl    25.44 
| epoch  73 |   200/  216 batches | lr 0.00000 | ms/batch 74.45 | loss  3.17 | ppl    23.86 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 16.68s | valid loss  4.19 | valid ppl    66.03 | valid bpc    6.045
-----------------------------------------------------------------------------------------
PROGRESS: 73.0%
| epoch  74 |   100/  216 batches | lr 0.00000 | ms/batch 75.23 | loss  3.23 | ppl    25.35 
| epoch  74 |   200/  216 batches | lr 0.00000 | ms/batch 74.86 | loss  3.18 | ppl    24.16 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 16.68s | valid loss  4.14 | valid ppl    63.11 | valid bpc    5.980
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 74.0%
| epoch  75 |   100/  216 batches | lr 0.00000 | ms/batch 75.43 | loss  3.22 | ppl    24.91 
| epoch  75 |   200/  216 batches | lr 0.00000 | ms/batch 74.71 | loss  3.17 | ppl    23.73 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 16.68s | valid loss  4.18 | valid ppl    65.62 | valid bpc    6.036
-----------------------------------------------------------------------------------------
PROGRESS: 75.0%
| epoch  76 |   100/  216 batches | lr 0.00000 | ms/batch 75.31 | loss  3.21 | ppl    24.74 
| epoch  76 |   200/  216 batches | lr 0.00000 | ms/batch 74.92 | loss  3.17 | ppl    23.84 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 16.68s | valid loss  4.15 | valid ppl    63.23 | valid bpc    5.982
-----------------------------------------------------------------------------------------
PROGRESS: 76.0%
| epoch  77 |   100/  216 batches | lr 0.00000 | ms/batch 75.90 | loss  3.23 | ppl    25.24 
| epoch  77 |   200/  216 batches | lr 0.00000 | ms/batch 74.31 | loss  3.19 | ppl    24.19 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 16.69s | valid loss  4.19 | valid ppl    66.33 | valid bpc    6.052
-----------------------------------------------------------------------------------------
PROGRESS: 77.0%
| epoch  78 |   100/  216 batches | lr 0.00000 | ms/batch 75.88 | loss  3.20 | ppl    24.61 
| epoch  78 |   200/  216 batches | lr 0.00000 | ms/batch 74.30 | loss  3.18 | ppl    24.07 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 16.69s | valid loss  4.21 | valid ppl    67.17 | valid bpc    6.070
-----------------------------------------------------------------------------------------
PROGRESS: 78.0%
| epoch  79 |   100/  216 batches | lr 0.00000 | ms/batch 75.64 | loss  3.20 | ppl    24.46 
| epoch  79 |   200/  216 batches | lr 0.00000 | ms/batch 74.66 | loss  3.19 | ppl    24.23 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 16.69s | valid loss  4.19 | valid ppl    66.28 | valid bpc    6.051
-----------------------------------------------------------------------------------------
PROGRESS: 79.0%
| epoch  80 |   100/  216 batches | lr 0.00000 | ms/batch 75.80 | loss  3.23 | ppl    25.18 
| epoch  80 |   200/  216 batches | lr 0.00000 | ms/batch 74.26 | loss  3.18 | ppl    24.09 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 16.69s | valid loss  4.19 | valid ppl    66.04 | valid bpc    6.045
-----------------------------------------------------------------------------------------
PROGRESS: 80.0%
| epoch  81 |   100/  216 batches | lr 0.00000 | ms/batch 75.34 | loss  3.22 | ppl    25.10 
| epoch  81 |   200/  216 batches | lr 0.00000 | ms/batch 74.91 | loss  3.18 | ppl    23.98 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 16.69s | valid loss  4.18 | valid ppl    65.14 | valid bpc    6.026
-----------------------------------------------------------------------------------------
PROGRESS: 81.0%
| epoch  82 |   100/  216 batches | lr 0.00000 | ms/batch 75.44 | loss  3.23 | ppl    25.16 
| epoch  82 |   200/  216 batches | lr 0.00000 | ms/batch 74.83 | loss  3.18 | ppl    24.05 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 16.69s | valid loss  4.21 | valid ppl    67.32 | valid bpc    6.073
-----------------------------------------------------------------------------------------
PROGRESS: 82.0%
| epoch  83 |   100/  216 batches | lr 0.00000 | ms/batch 75.88 | loss  3.21 | ppl    24.72 
| epoch  83 |   200/  216 batches | lr 0.00000 | ms/batch 74.37 | loss  3.19 | ppl    24.41 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 16.69s | valid loss  4.19 | valid ppl    65.96 | valid bpc    6.044
-----------------------------------------------------------------------------------------
PROGRESS: 83.0%
| epoch  84 |   100/  216 batches | lr 0.00000 | ms/batch 75.57 | loss  3.21 | ppl    24.88 
| epoch  84 |   200/  216 batches | lr 0.00000 | ms/batch 74.71 | loss  3.18 | ppl    24.02 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 16.69s | valid loss  4.20 | valid ppl    66.97 | valid bpc    6.065
-----------------------------------------------------------------------------------------
PROGRESS: 84.0%
| epoch  85 |   100/  216 batches | lr 0.00000 | ms/batch 75.84 | loss  3.22 | ppl    24.98 
| epoch  85 |   200/  216 batches | lr 0.00000 | ms/batch 74.46 | loss  3.20 | ppl    24.49 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 16.69s | valid loss  4.16 | valid ppl    64.37 | valid bpc    6.008
-----------------------------------------------------------------------------------------
PROGRESS: 85.0%
| epoch  86 |   100/  216 batches | lr 0.00000 | ms/batch 75.61 | loss  3.21 | ppl    24.90 
| epoch  86 |   200/  216 batches | lr 0.00000 | ms/batch 74.31 | loss  3.19 | ppl    24.21 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 16.70s | valid loss  4.20 | valid ppl    66.88 | valid bpc    6.063
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  216 batches | lr 0.00000 | ms/batch 75.66 | loss  3.22 | ppl    24.98 
| epoch  87 |   200/  216 batches | lr 0.00000 | ms/batch 74.61 | loss  3.18 | ppl    23.94 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 16.69s | valid loss  4.20 | valid ppl    66.77 | valid bpc    6.061
-----------------------------------------------------------------------------------------
PROGRESS: 87.0%
| epoch  88 |   100/  216 batches | lr 0.00000 | ms/batch 75.57 | loss  3.22 | ppl    25.13 
| epoch  88 |   200/  216 batches | lr 0.00000 | ms/batch 74.67 | loss  3.17 | ppl    23.70 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 16.70s | valid loss  4.19 | valid ppl    66.07 | valid bpc    6.046
-----------------------------------------------------------------------------------------
PROGRESS: 88.0%
| epoch  89 |   100/  216 batches | lr 0.00000 | ms/batch 75.48 | loss  3.21 | ppl    24.72 
| epoch  89 |   200/  216 batches | lr 0.00000 | ms/batch 74.79 | loss  3.19 | ppl    24.20 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 16.69s | valid loss  4.18 | valid ppl    65.06 | valid bpc    6.024
-----------------------------------------------------------------------------------------
PROGRESS: 89.0%
| epoch  90 |   100/  216 batches | lr 0.00000 | ms/batch 75.74 | loss  3.19 | ppl    24.24 
| epoch  90 |   200/  216 batches | lr 0.00000 | ms/batch 74.54 | loss  3.21 | ppl    24.73 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 16.69s | valid loss  4.20 | valid ppl    66.69 | valid bpc    6.059
-----------------------------------------------------------------------------------------
PROGRESS: 90.0%
| epoch  91 |   100/  216 batches | lr 0.00000 | ms/batch 75.57 | loss  3.21 | ppl    24.82 
| epoch  91 |   200/  216 batches | lr 0.00000 | ms/batch 74.72 | loss  3.20 | ppl    24.60 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 16.69s | valid loss  4.20 | valid ppl    66.51 | valid bpc    6.056
-----------------------------------------------------------------------------------------
PROGRESS: 91.0%
| epoch  92 |   100/  216 batches | lr 0.00000 | ms/batch 75.80 | loss  3.21 | ppl    24.88 
| epoch  92 |   200/  216 batches | lr 0.00000 | ms/batch 74.36 | loss  3.19 | ppl    24.19 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 16.69s | valid loss  4.22 | valid ppl    68.24 | valid bpc    6.093
-----------------------------------------------------------------------------------------
PROGRESS: 92.0%
| epoch  93 |   100/  216 batches | lr 0.00000 | ms/batch 75.63 | loss  3.21 | ppl    24.75 
| epoch  93 |   200/  216 batches | lr 0.00000 | ms/batch 74.69 | loss  3.20 | ppl    24.59 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 16.69s | valid loss  4.22 | valid ppl    67.79 | valid bpc    6.083
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  216 batches | lr 0.00000 | ms/batch 75.92 | loss  3.22 | ppl    25.12 
| epoch  94 |   200/  216 batches | lr 0.00000 | ms/batch 74.14 | loss  3.17 | ppl    23.80 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 16.69s | valid loss  4.18 | valid ppl    65.61 | valid bpc    6.036
-----------------------------------------------------------------------------------------
PROGRESS: 94.0%
| epoch  95 |   100/  216 batches | lr 0.00000 | ms/batch 75.86 | loss  3.23 | ppl    25.25 
| epoch  95 |   200/  216 batches | lr 0.00000 | ms/batch 74.30 | loss  3.19 | ppl    24.20 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 16.68s | valid loss  4.18 | valid ppl    65.18 | valid bpc    6.026
-----------------------------------------------------------------------------------------
PROGRESS: 95.0%
| epoch  96 |   100/  216 batches | lr 0.00000 | ms/batch 75.52 | loss  3.23 | ppl    25.32 
| epoch  96 |   200/  216 batches | lr 0.00000 | ms/batch 74.63 | loss  3.17 | ppl    23.86 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 16.68s | valid loss  4.15 | valid ppl    63.15 | valid bpc    5.981
-----------------------------------------------------------------------------------------
PROGRESS: 96.0%
| epoch  97 |   100/  216 batches | lr 0.00000 | ms/batch 75.43 | loss  3.20 | ppl    24.42 
| epoch  97 |   200/  216 batches | lr 0.00000 | ms/batch 74.49 | loss  3.19 | ppl    24.23 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 16.68s | valid loss  4.16 | valid ppl    63.84 | valid bpc    5.996
-----------------------------------------------------------------------------------------
PROGRESS: 97.0%
| epoch  98 |   100/  216 batches | lr 0.00000 | ms/batch 75.36 | loss  3.21 | ppl    24.82 
| epoch  98 |   200/  216 batches | lr 0.00000 | ms/batch 74.85 | loss  3.17 | ppl    23.85 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 16.69s | valid loss  4.22 | valid ppl    67.72 | valid bpc    6.082
-----------------------------------------------------------------------------------------
PROGRESS: 98.0%
| epoch  99 |   100/  216 batches | lr 0.00000 | ms/batch 75.74 | loss  3.22 | ppl    25.13 
| epoch  99 |   200/  216 batches | lr 0.00000 | ms/batch 74.41 | loss  3.17 | ppl    23.78 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 16.69s | valid loss  4.20 | valid ppl    66.79 | valid bpc    6.061
-----------------------------------------------------------------------------------------
PROGRESS: 99.0%
| epoch 100 |   100/  216 batches | lr 0.00000 | ms/batch 75.33 | loss  3.22 | ppl    25.03 
| epoch 100 |   200/  216 batches | lr 0.00000 | ms/batch 74.53 | loss  3.18 | ppl    24.06 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 16.69s | valid loss  4.20 | valid ppl    66.66 | valid bpc    6.059
-----------------------------------------------------------------------------------------
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  4.13 | test ppl    61.93 | test bpc    5.953
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.4911, Mean Reca: 0.6739, Mean F1: 0.5597
Counter({'NP': 9657, 'VP': 4477, 'PP': 4317, 'S': 3783, 'SBAR': 1001, 'ADJP': 283, 'QP': 247, 'ADVP': 168, 'SINV': 148, 'PRN': 58, 'NX': 36, 'FRAG': 32, 'WHNP': 28, 'NAC': 15, 'SQ': 15, 'WHPP': 9, 'SBARQ': 9, 'CONJP': 8, 'UCP': 7, 'X': 3, 'WHADVP': 2, 'WHADJP': 1})
Counter({'NP': 14432, 'VP': 8130, 'S': 5620, 'PP': 5484, 'SBAR': 1796, 'ADJP': 649, 'QP': 490, 'ADVP': 286, 'SINV': 157, 'PRN': 128, 'NX': 95, 'FRAG': 42, 'WHNP': 37, 'UCP': 32, 'NAC': 30, 'WHPP': 25, 'CONJP': 21, 'SQ': 18, 'SBARQ': 10, 'WHADVP': 9, 'X': 6, 'WHADJP': 4, 'INTJ': 1})
SBAR: 0.5573
NP: 0.6691
VP: 0.5507
PP: 0.7872
ADJP: 0.4361
ADVP: 0.5874
5.159181628169437
-----------------------------------------------------------------------------------------
Dependency parsing performance:
Conll-U Style:
DDA: 0.084
UDA: 0.342
=========================================================================================
Loading dataset...
Loading dictionary...
Number of tokens:  10001
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer_in_parser', nhid=512, nlayers=8, front_layers=6, rear_layers=2, n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=2222, nonmono=5, cuda=True, log_interval=100, save='trained_models/structformer_in_parser_2222_62.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 38475573
Model architecture: StructFormer_In_Parser(
  (transformer_front): Transformer_Front(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(10001, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-5): 6 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
  (transformer_rear): Transformer_Rear(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(10001, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-1): 2 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (output_layer): Linear(in_features=512, out_features=10001, bias=True)
  )
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  216 batches | lr 0.00030 | ms/batch 78.80 | loss  7.32 | ppl  1505.96 
| epoch   1 |   200/  216 batches | lr 0.00030 | ms/batch 73.51 | loss  6.85 | ppl   945.93 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 16.87s | valid loss  6.71 | valid ppl   823.08 | valid bpc    9.685
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  216 batches | lr 0.00030 | ms/batch 75.51 | loss  6.80 | ppl   897.23 
| epoch   2 |   200/  216 batches | lr 0.00030 | ms/batch 73.74 | loss  6.57 | ppl   716.00 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 16.58s | valid loss  6.34 | valid ppl   566.23 | valid bpc    9.145
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  216 batches | lr 0.00030 | ms/batch 75.09 | loss  6.36 | ppl   578.11 
| epoch   3 |   200/  216 batches | lr 0.00030 | ms/batch 74.46 | loss  6.09 | ppl   442.96 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 16.61s | valid loss  5.87 | valid ppl   354.35 | valid bpc    8.469
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  216 batches | lr 0.00030 | ms/batch 75.54 | loss  5.90 | ppl   366.10 
| epoch   4 |   200/  216 batches | lr 0.00030 | ms/batch 74.10 | loss  5.72 | ppl   303.84 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 16.63s | valid loss  5.60 | valid ppl   270.19 | valid bpc    8.078
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  216 batches | lr 0.00030 | ms/batch 75.31 | loss  5.59 | ppl   268.03 
| epoch   5 |   200/  216 batches | lr 0.00030 | ms/batch 74.57 | loss  5.47 | ppl   237.63 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 16.65s | valid loss  5.39 | valid ppl   220.06 | valid bpc    7.782
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  216 batches | lr 0.00030 | ms/batch 75.44 | loss  5.38 | ppl   217.41 
| epoch   6 |   200/  216 batches | lr 0.00030 | ms/batch 74.53 | loss  5.28 | ppl   196.32 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 16.66s | valid loss  5.25 | valid ppl   191.33 | valid bpc    7.580
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  216 batches | lr 0.00030 | ms/batch 75.28 | loss  5.23 | ppl   186.29 
| epoch   7 |   200/  216 batches | lr 0.00030 | ms/batch 74.65 | loss  5.15 | ppl   171.92 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 16.66s | valid loss  5.12 | valid ppl   167.72 | valid bpc    7.390
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  216 batches | lr 0.00030 | ms/batch 75.84 | loss  5.12 | ppl   166.74 
| epoch   8 |   200/  216 batches | lr 0.00030 | ms/batch 74.10 | loss  5.01 | ppl   150.18 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 16.66s | valid loss  5.03 | valid ppl   152.86 | valid bpc    7.256
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 8.0%
| epoch   9 |   100/  216 batches | lr 0.00030 | ms/batch 75.50 | loss  4.99 | ppl   147.37 
| epoch   9 |   200/  216 batches | lr 0.00030 | ms/batch 74.24 | loss  4.91 | ppl   135.58 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 16.67s | valid loss  4.95 | valid ppl   141.63 | valid bpc    7.146
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  216 batches | lr 0.00030 | ms/batch 75.75 | loss  4.87 | ppl   130.65 
| epoch  10 |   200/  216 batches | lr 0.00030 | ms/batch 74.43 | loss  4.81 | ppl   122.32 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 16.68s | valid loss  4.85 | valid ppl   127.55 | valid bpc    6.995
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  216 batches | lr 0.00030 | ms/batch 75.52 | loss  4.78 | ppl   119.51 
| epoch  11 |   200/  216 batches | lr 0.00030 | ms/batch 74.23 | loss  4.71 | ppl   111.28 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 16.67s | valid loss  4.80 | valid ppl   121.30 | valid bpc    6.922
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  216 batches | lr 0.00030 | ms/batch 75.47 | loss  4.68 | ppl   108.30 
| epoch  12 |   200/  216 batches | lr 0.00030 | ms/batch 74.61 | loss  4.65 | ppl   104.59 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 16.67s | valid loss  4.78 | valid ppl   118.88 | valid bpc    6.893
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 12.0%
| epoch  13 |   100/  216 batches | lr 0.00030 | ms/batch 75.74 | loss  4.59 | ppl    98.84 
| epoch  13 |   200/  216 batches | lr 0.00030 | ms/batch 74.35 | loss  4.54 | ppl    94.06 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 16.68s | valid loss  4.70 | valid ppl   110.22 | valid bpc    6.784
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 13.0%
| epoch  14 |   100/  216 batches | lr 0.00030 | ms/batch 75.22 | loss  4.54 | ppl    93.90 
| epoch  14 |   200/  216 batches | lr 0.00030 | ms/batch 74.78 | loss  4.48 | ppl    88.48 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 16.67s | valid loss  4.65 | valid ppl   104.51 | valid bpc    6.708
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  216 batches | lr 0.00030 | ms/batch 75.38 | loss  4.45 | ppl    85.37 
| epoch  15 |   200/  216 batches | lr 0.00030 | ms/batch 74.66 | loss  4.43 | ppl    83.66 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 16.67s | valid loss  4.65 | valid ppl   104.07 | valid bpc    6.701
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 15.0%
| epoch  16 |   100/  216 batches | lr 0.00030 | ms/batch 75.77 | loss  4.37 | ppl    78.82 
| epoch  16 |   200/  216 batches | lr 0.00030 | ms/batch 74.29 | loss  4.36 | ppl    78.34 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 16.67s | valid loss  4.57 | valid ppl    96.85 | valid bpc    6.598
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 16.0%
| epoch  17 |   100/  216 batches | lr 0.00030 | ms/batch 75.75 | loss  4.32 | ppl    75.08 
| epoch  17 |   200/  216 batches | lr 0.00030 | ms/batch 74.34 | loss  4.30 | ppl    73.36 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 16.67s | valid loss  4.56 | valid ppl    95.16 | valid bpc    6.572
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 17.0%
| epoch  18 |   100/  216 batches | lr 0.00030 | ms/batch 75.91 | loss  4.25 | ppl    70.03 
| epoch  18 |   200/  216 batches | lr 0.00030 | ms/batch 74.27 | loss  4.25 | ppl    69.97 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 16.68s | valid loss  4.55 | valid ppl    94.44 | valid bpc    6.561
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 18.0%
| epoch  19 |   100/  216 batches | lr 0.00030 | ms/batch 75.81 | loss  4.21 | ppl    67.07 
| epoch  19 |   200/  216 batches | lr 0.00030 | ms/batch 74.32 | loss  4.17 | ppl    64.88 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 16.68s | valid loss  4.49 | valid ppl    89.54 | valid bpc    6.484
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 19.0%
| epoch  20 |   100/  216 batches | lr 0.00030 | ms/batch 75.55 | loss  4.13 | ppl    62.30 
| epoch  20 |   200/  216 batches | lr 0.00030 | ms/batch 74.65 | loss  4.15 | ppl    63.41 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 16.68s | valid loss  4.49 | valid ppl    89.23 | valid bpc    6.479
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 20.0%
| epoch  21 |   100/  216 batches | lr 0.00030 | ms/batch 75.39 | loss  4.09 | ppl    59.95 
| epoch  21 |   200/  216 batches | lr 0.00030 | ms/batch 74.65 | loss  4.06 | ppl    58.26 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 16.67s | valid loss  4.45 | valid ppl    85.67 | valid bpc    6.421
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 21.0%
| epoch  22 |   100/  216 batches | lr 0.00030 | ms/batch 75.74 | loss  4.04 | ppl    56.93 
| epoch  22 |   200/  216 batches | lr 0.00030 | ms/batch 74.40 | loss  4.02 | ppl    55.66 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 16.68s | valid loss  4.38 | valid ppl    79.65 | valid bpc    6.316
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 22.0%
| epoch  23 |   100/  216 batches | lr 0.00030 | ms/batch 75.42 | loss  4.01 | ppl    55.14 
| epoch  23 |   200/  216 batches | lr 0.00030 | ms/batch 74.26 | loss  3.98 | ppl    53.38 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 16.67s | valid loss  4.38 | valid ppl    80.13 | valid bpc    6.324
-----------------------------------------------------------------------------------------
PROGRESS: 23.0%
| epoch  24 |   100/  216 batches | lr 0.00030 | ms/batch 75.65 | loss  3.96 | ppl    52.42 
| epoch  24 |   200/  216 batches | lr 0.00030 | ms/batch 74.47 | loss  3.91 | ppl    49.74 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 16.68s | valid loss  4.35 | valid ppl    77.73 | valid bpc    6.280
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 24.0%
| epoch  25 |   100/  216 batches | lr 0.00030 | ms/batch 75.58 | loss  3.90 | ppl    49.40 
| epoch  25 |   200/  216 batches | lr 0.00030 | ms/batch 74.62 | loss  3.89 | ppl    49.01 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 16.68s | valid loss  4.41 | valid ppl    82.07 | valid bpc    6.359
-----------------------------------------------------------------------------------------
PROGRESS: 25.0%
| epoch  26 |   100/  216 batches | lr 0.00030 | ms/batch 75.64 | loss  3.85 | ppl    47.12 
| epoch  26 |   200/  216 batches | lr 0.00030 | ms/batch 74.58 | loss  3.86 | ppl    47.34 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 16.69s | valid loss  4.35 | valid ppl    77.50 | valid bpc    6.276
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 26.0%
| epoch  27 |   100/  216 batches | lr 0.00030 | ms/batch 75.49 | loss  3.81 | ppl    45.07 
| epoch  27 |   200/  216 batches | lr 0.00030 | ms/batch 74.74 | loss  3.80 | ppl    44.73 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 16.68s | valid loss  4.29 | valid ppl    73.10 | valid bpc    6.192
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 27.0%
| epoch  28 |   100/  216 batches | lr 0.00030 | ms/batch 75.36 | loss  3.77 | ppl    43.27 
| epoch  28 |   200/  216 batches | lr 0.00030 | ms/batch 74.42 | loss  3.77 | ppl    43.48 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 16.68s | valid loss  4.29 | valid ppl    73.12 | valid bpc    6.192
-----------------------------------------------------------------------------------------
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  216 batches | lr 0.00030 | ms/batch 75.48 | loss  3.73 | ppl    41.50 
| epoch  29 |   200/  216 batches | lr 0.00030 | ms/batch 74.67 | loss  3.73 | ppl    41.81 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 16.68s | valid loss  4.26 | valid ppl    70.91 | valid bpc    6.148
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  216 batches | lr 0.00030 | ms/batch 75.30 | loss  3.72 | ppl    41.12 
| epoch  30 |   200/  216 batches | lr 0.00030 | ms/batch 74.84 | loss  3.67 | ppl    39.45 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 16.68s | valid loss  4.28 | valid ppl    71.91 | valid bpc    6.168
-----------------------------------------------------------------------------------------
PROGRESS: 30.0%
| epoch  31 |   100/  216 batches | lr 0.00030 | ms/batch 75.41 | loss  3.67 | ppl    39.29 
| epoch  31 |   200/  216 batches | lr 0.00030 | ms/batch 74.78 | loss  3.66 | ppl    38.97 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 16.68s | valid loss  4.27 | valid ppl    71.22 | valid bpc    6.154
-----------------------------------------------------------------------------------------
PROGRESS: 31.0%
| epoch  32 |   100/  216 batches | lr 0.00030 | ms/batch 75.50 | loss  3.61 | ppl    36.79 
| epoch  32 |   200/  216 batches | lr 0.00030 | ms/batch 74.74 | loss  3.62 | ppl    37.40 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 16.69s | valid loss  4.28 | valid ppl    71.92 | valid bpc    6.168
-----------------------------------------------------------------------------------------
PROGRESS: 32.0%
| epoch  33 |   100/  216 batches | lr 0.00015 | ms/batch 75.94 | loss  3.54 | ppl    34.56 
| epoch  33 |   200/  216 batches | lr 0.00015 | ms/batch 74.17 | loss  3.48 | ppl    32.57 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 16.69s | valid loss  4.28 | valid ppl    72.45 | valid bpc    6.179
-----------------------------------------------------------------------------------------
PROGRESS: 33.0%
| epoch  34 |   100/  216 batches | lr 0.00015 | ms/batch 75.70 | loss  3.49 | ppl    32.94 
| epoch  34 |   200/  216 batches | lr 0.00015 | ms/batch 74.64 | loss  3.43 | ppl    30.97 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 16.69s | valid loss  4.22 | valid ppl    68.32 | valid bpc    6.094
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 34.0%
| epoch  35 |   100/  216 batches | lr 0.00015 | ms/batch 76.09 | loss  3.44 | ppl    31.29 
| epoch  35 |   200/  216 batches | lr 0.00015 | ms/batch 74.17 | loss  3.42 | ppl    30.47 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 16.69s | valid loss  4.23 | valid ppl    68.41 | valid bpc    6.096
-----------------------------------------------------------------------------------------
PROGRESS: 35.0%
| epoch  36 |   100/  216 batches | lr 0.00015 | ms/batch 75.50 | loss  3.43 | ppl    30.88 
| epoch  36 |   200/  216 batches | lr 0.00015 | ms/batch 74.71 | loss  3.40 | ppl    29.97 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 16.69s | valid loss  4.23 | valid ppl    68.73 | valid bpc    6.103
-----------------------------------------------------------------------------------------
PROGRESS: 36.0%
| epoch  37 |   100/  216 batches | lr 0.00015 | ms/batch 75.56 | loss  3.38 | ppl    29.52 
| epoch  37 |   200/  216 batches | lr 0.00015 | ms/batch 74.69 | loss  3.38 | ppl    29.49 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 16.69s | valid loss  4.22 | valid ppl    67.91 | valid bpc    6.086
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 37.0%
| epoch  38 |   100/  216 batches | lr 0.00015 | ms/batch 75.44 | loss  3.37 | ppl    29.05 
| epoch  38 |   200/  216 batches | lr 0.00015 | ms/batch 74.69 | loss  3.35 | ppl    28.42 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 16.68s | valid loss  4.22 | valid ppl    68.15 | valid bpc    6.091
-----------------------------------------------------------------------------------------
PROGRESS: 38.0%
| epoch  39 |   100/  216 batches | lr 0.00015 | ms/batch 75.39 | loss  3.32 | ppl    27.65 
| epoch  39 |   200/  216 batches | lr 0.00015 | ms/batch 74.53 | loss  3.34 | ppl    28.26 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 16.68s | valid loss  4.19 | valid ppl    66.14 | valid bpc    6.048
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 39.0%
| epoch  40 |   100/  216 batches | lr 0.00015 | ms/batch 75.61 | loss  3.30 | ppl    27.05 
| epoch  40 |   200/  216 batches | lr 0.00015 | ms/batch 74.59 | loss  3.31 | ppl    27.46 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 16.68s | valid loss  4.24 | valid ppl    69.72 | valid bpc    6.123
-----------------------------------------------------------------------------------------
PROGRESS: 40.0%
| epoch  41 |   100/  216 batches | lr 0.00015 | ms/batch 75.59 | loss  3.32 | ppl    27.55 
| epoch  41 |   200/  216 batches | lr 0.00015 | ms/batch 74.28 | loss  3.27 | ppl    26.43 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 16.69s | valid loss  4.24 | valid ppl    69.42 | valid bpc    6.117
-----------------------------------------------------------------------------------------
PROGRESS: 41.0%
| epoch  42 |   100/  216 batches | lr 0.00015 | ms/batch 75.56 | loss  3.28 | ppl    26.59 
| epoch  42 |   200/  216 batches | lr 0.00015 | ms/batch 74.64 | loss  3.25 | ppl    25.91 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 16.68s | valid loss  4.26 | valid ppl    70.72 | valid bpc    6.144
-----------------------------------------------------------------------------------------
PROGRESS: 42.0%
| epoch  43 |   100/  216 batches | lr 0.00007 | ms/batch 75.58 | loss  3.20 | ppl    24.55 
| epoch  43 |   200/  216 batches | lr 0.00007 | ms/batch 74.64 | loss  3.21 | ppl    24.66 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 16.68s | valid loss  4.19 | valid ppl    66.24 | valid bpc    6.050
-----------------------------------------------------------------------------------------
PROGRESS: 43.0%
| epoch  44 |   100/  216 batches | lr 0.00007 | ms/batch 75.69 | loss  3.20 | ppl    24.64 
| epoch  44 |   200/  216 batches | lr 0.00007 | ms/batch 74.58 | loss  3.15 | ppl    23.42 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 16.69s | valid loss  4.21 | valid ppl    67.41 | valid bpc    6.075
-----------------------------------------------------------------------------------------
PROGRESS: 44.0%
| epoch  45 |   100/  216 batches | lr 0.00007 | ms/batch 75.48 | loss  3.18 | ppl    23.93 
| epoch  45 |   200/  216 batches | lr 0.00007 | ms/batch 74.71 | loss  3.18 | ppl    23.98 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 16.68s | valid loss  4.19 | valid ppl    66.07 | valid bpc    6.046
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 45.0%
| epoch  46 |   100/  216 batches | lr 0.00007 | ms/batch 75.85 | loss  3.15 | ppl    23.42 
| epoch  46 |   200/  216 batches | lr 0.00007 | ms/batch 74.36 | loss  3.14 | ppl    23.11 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 16.68s | valid loss  4.18 | valid ppl    65.29 | valid bpc    6.029
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 46.0%
| epoch  47 |   100/  216 batches | lr 0.00007 | ms/batch 75.41 | loss  3.14 | ppl    23.13 
| epoch  47 |   200/  216 batches | lr 0.00007 | ms/batch 74.71 | loss  3.12 | ppl    22.63 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 16.68s | valid loss  4.19 | valid ppl    66.29 | valid bpc    6.051
-----------------------------------------------------------------------------------------
PROGRESS: 47.0%
| epoch  48 |   100/  216 batches | lr 0.00007 | ms/batch 75.81 | loss  3.13 | ppl    22.94 
| epoch  48 |   200/  216 batches | lr 0.00007 | ms/batch 74.45 | loss  3.11 | ppl    22.37 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 16.68s | valid loss  4.18 | valid ppl    65.27 | valid bpc    6.028
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 48.0%
| epoch  49 |   100/  216 batches | lr 0.00007 | ms/batch 75.49 | loss  3.13 | ppl    22.79 
| epoch  49 |   200/  216 batches | lr 0.00007 | ms/batch 74.60 | loss  3.10 | ppl    22.14 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 16.67s | valid loss  4.18 | valid ppl    65.36 | valid bpc    6.030
-----------------------------------------------------------------------------------------
PROGRESS: 49.0%
| epoch  50 |   100/  216 batches | lr 0.00007 | ms/batch 75.34 | loss  3.09 | ppl    21.98 
| epoch  50 |   200/  216 batches | lr 0.00007 | ms/batch 74.80 | loss  3.10 | ppl    22.28 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 16.67s | valid loss  4.21 | valid ppl    67.50 | valid bpc    6.077
-----------------------------------------------------------------------------------------
PROGRESS: 50.0%
| epoch  51 |   100/  216 batches | lr 0.00007 | ms/batch 75.44 | loss  3.10 | ppl    22.24 
| epoch  51 |   200/  216 batches | lr 0.00007 | ms/batch 74.71 | loss  3.08 | ppl    21.75 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 16.68s | valid loss  4.17 | valid ppl    64.58 | valid bpc    6.013
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 51.0%
| epoch  52 |   100/  216 batches | lr 0.00007 | ms/batch 75.88 | loss  3.08 | ppl    21.75 
| epoch  52 |   200/  216 batches | lr 0.00007 | ms/batch 74.21 | loss  3.06 | ppl    21.39 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 16.68s | valid loss  4.17 | valid ppl    64.97 | valid bpc    6.022
-----------------------------------------------------------------------------------------
PROGRESS: 52.0%
| epoch  53 |   100/  216 batches | lr 0.00007 | ms/batch 75.55 | loss  3.07 | ppl    21.57 
| epoch  53 |   200/  216 batches | lr 0.00007 | ms/batch 74.33 | loss  3.03 | ppl    20.75 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 16.68s | valid loss  4.21 | valid ppl    67.43 | valid bpc    6.075
-----------------------------------------------------------------------------------------
PROGRESS: 53.0%
| epoch  54 |   100/  216 batches | lr 0.00007 | ms/batch 76.05 | loss  3.04 | ppl    21.00 
| epoch  54 |   200/  216 batches | lr 0.00007 | ms/batch 74.17 | loss  3.05 | ppl    21.07 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 16.69s | valid loss  4.22 | valid ppl    68.01 | valid bpc    6.088
-----------------------------------------------------------------------------------------
PROGRESS: 54.0%
| epoch  55 |   100/  216 batches | lr 0.00004 | ms/batch 75.80 | loss  3.03 | ppl    20.77 
| epoch  55 |   200/  216 batches | lr 0.00004 | ms/batch 74.31 | loss  2.98 | ppl    19.63 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 16.68s | valid loss  4.20 | valid ppl    66.57 | valid bpc    6.057
-----------------------------------------------------------------------------------------
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  216 batches | lr 0.00004 | ms/batch 76.09 | loss  3.06 | ppl    21.33 
| epoch  56 |   200/  216 batches | lr 0.00004 | ms/batch 74.11 | loss  2.98 | ppl    19.67 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 16.68s | valid loss  4.16 | valid ppl    64.08 | valid bpc    6.002
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  216 batches | lr 0.00004 | ms/batch 76.09 | loss  3.00 | ppl    20.02 
| epoch  57 |   200/  216 batches | lr 0.00004 | ms/batch 74.52 | loss  2.99 | ppl    19.85 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 16.73s | valid loss  4.17 | valid ppl    65.01 | valid bpc    6.022
-----------------------------------------------------------------------------------------
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  216 batches | lr 0.00004 | ms/batch 75.85 | loss  3.01 | ppl    20.24 
| epoch  58 |   200/  216 batches | lr 0.00004 | ms/batch 74.43 | loss  2.98 | ppl    19.62 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 16.69s | valid loss  4.21 | valid ppl    67.40 | valid bpc    6.075
-----------------------------------------------------------------------------------------
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  216 batches | lr 0.00004 | ms/batch 75.81 | loss  2.99 | ppl    19.97 
| epoch  59 |   200/  216 batches | lr 0.00004 | ms/batch 74.39 | loss  2.98 | ppl    19.62 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 16.68s | valid loss  4.24 | valid ppl    69.27 | valid bpc    6.114
-----------------------------------------------------------------------------------------
PROGRESS: 59.0%
| epoch  60 |   100/  216 batches | lr 0.00002 | ms/batch 75.49 | loss  2.98 | ppl    19.73 
| epoch  60 |   200/  216 batches | lr 0.00002 | ms/batch 74.20 | loss  2.93 | ppl    18.68 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 16.67s | valid loss  4.25 | valid ppl    69.93 | valid bpc    6.128
-----------------------------------------------------------------------------------------
PROGRESS: 60.0%
| epoch  61 |   100/  216 batches | lr 0.00002 | ms/batch 75.44 | loss  2.97 | ppl    19.41 
| epoch  61 |   200/  216 batches | lr 0.00002 | ms/batch 74.69 | loss  2.95 | ppl    19.07 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 16.68s | valid loss  4.19 | valid ppl    65.95 | valid bpc    6.043
-----------------------------------------------------------------------------------------
PROGRESS: 61.0%
| epoch  62 |   100/  216 batches | lr 0.00002 | ms/batch 75.36 | loss  2.96 | ppl    19.38 
| epoch  62 |   200/  216 batches | lr 0.00002 | ms/batch 74.50 | loss  2.95 | ppl    19.04 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 16.68s | valid loss  4.16 | valid ppl    63.81 | valid bpc    5.996
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 62.0%
| epoch  63 |   100/  216 batches | lr 0.00002 | ms/batch 75.40 | loss  2.97 | ppl    19.43 
| epoch  63 |   200/  216 batches | lr 0.00002 | ms/batch 74.68 | loss  2.93 | ppl    18.71 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 16.68s | valid loss  4.17 | valid ppl    65.02 | valid bpc    6.023
-----------------------------------------------------------------------------------------
PROGRESS: 63.0%
| epoch  64 |   100/  216 batches | lr 0.00002 | ms/batch 75.46 | loss  2.94 | ppl    19.00 
| epoch  64 |   200/  216 batches | lr 0.00002 | ms/batch 74.65 | loss  2.94 | ppl    18.92 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 16.68s | valid loss  4.17 | valid ppl    64.89 | valid bpc    6.020
-----------------------------------------------------------------------------------------
PROGRESS: 64.0%
| epoch  65 |   100/  216 batches | lr 0.00002 | ms/batch 75.68 | loss  2.95 | ppl    19.18 
| epoch  65 |   200/  216 batches | lr 0.00002 | ms/batch 74.47 | loss  2.95 | ppl    19.07 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 16.68s | valid loss  4.23 | valid ppl    68.90 | valid bpc    6.106
-----------------------------------------------------------------------------------------
PROGRESS: 65.0%
| epoch  66 |   100/  216 batches | lr 0.00001 | ms/batch 75.80 | loss  2.94 | ppl    18.84 
| epoch  66 |   200/  216 batches | lr 0.00001 | ms/batch 74.43 | loss  2.92 | ppl    18.56 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 16.69s | valid loss  4.15 | valid ppl    63.64 | valid bpc    5.992
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 66.0%
| epoch  67 |   100/  216 batches | lr 0.00001 | ms/batch 75.99 | loss  2.96 | ppl    19.29 
| epoch  67 |   200/  216 batches | lr 0.00001 | ms/batch 74.16 | loss  2.91 | ppl    18.40 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 16.68s | valid loss  4.21 | valid ppl    67.35 | valid bpc    6.074
-----------------------------------------------------------------------------------------
PROGRESS: 67.0%
| epoch  68 |   100/  216 batches | lr 0.00001 | ms/batch 75.49 | loss  2.94 | ppl    18.84 
| epoch  68 |   200/  216 batches | lr 0.00001 | ms/batch 74.67 | loss  2.94 | ppl    18.91 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 16.68s | valid loss  4.23 | valid ppl    68.44 | valid bpc    6.097
-----------------------------------------------------------------------------------------
PROGRESS: 68.0%
| epoch  69 |   100/  216 batches | lr 0.00001 | ms/batch 75.71 | loss  2.94 | ppl    18.89 
| epoch  69 |   200/  216 batches | lr 0.00001 | ms/batch 74.39 | loss  2.91 | ppl    18.31 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 16.68s | valid loss  4.25 | valid ppl    70.38 | valid bpc    6.137
-----------------------------------------------------------------------------------------
PROGRESS: 69.0%
| epoch  70 |   100/  216 batches | lr 0.00000 | ms/batch 75.80 | loss  2.94 | ppl    18.92 
| epoch  70 |   200/  216 batches | lr 0.00000 | ms/batch 74.50 | loss  2.91 | ppl    18.38 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 16.68s | valid loss  4.23 | valid ppl    68.86 | valid bpc    6.106
-----------------------------------------------------------------------------------------
PROGRESS: 70.0%
| epoch  71 |   100/  216 batches | lr 0.00000 | ms/batch 75.61 | loss  2.92 | ppl    18.52 
| epoch  71 |   200/  216 batches | lr 0.00000 | ms/batch 74.54 | loss  2.90 | ppl    18.25 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 16.68s | valid loss  4.21 | valid ppl    67.39 | valid bpc    6.075
-----------------------------------------------------------------------------------------
PROGRESS: 71.0%
| epoch  72 |   100/  216 batches | lr 0.00000 | ms/batch 75.73 | loss  2.95 | ppl    19.15 
| epoch  72 |   200/  216 batches | lr 0.00000 | ms/batch 74.61 | loss  2.90 | ppl    18.18 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 16.69s | valid loss  4.19 | valid ppl    66.33 | valid bpc    6.052
-----------------------------------------------------------------------------------------
PROGRESS: 72.0%
| epoch  73 |   100/  216 batches | lr 0.00000 | ms/batch 75.61 | loss  2.94 | ppl    18.92 
| epoch  73 |   200/  216 batches | lr 0.00000 | ms/batch 74.60 | loss  2.90 | ppl    18.11 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 16.68s | valid loss  4.22 | valid ppl    68.18 | valid bpc    6.091
-----------------------------------------------------------------------------------------
PROGRESS: 73.0%
| epoch  74 |   100/  216 batches | lr 0.00000 | ms/batch 75.40 | loss  2.93 | ppl    18.75 
| epoch  74 |   200/  216 batches | lr 0.00000 | ms/batch 74.84 | loss  2.91 | ppl    18.34 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 16.69s | valid loss  4.22 | valid ppl    67.73 | valid bpc    6.082
-----------------------------------------------------------------------------------------
PROGRESS: 74.0%
| epoch  75 |   100/  216 batches | lr 0.00000 | ms/batch 75.87 | loss  2.95 | ppl    19.03 
| epoch  75 |   200/  216 batches | lr 0.00000 | ms/batch 74.38 | loss  2.88 | ppl    17.75 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 16.69s | valid loss  4.18 | valid ppl    65.23 | valid bpc    6.027
-----------------------------------------------------------------------------------------
PROGRESS: 75.0%
| epoch  76 |   100/  216 batches | lr 0.00000 | ms/batch 75.57 | loss  2.94 | ppl    18.99 
| epoch  76 |   200/  216 batches | lr 0.00000 | ms/batch 74.73 | loss  2.88 | ppl    17.73 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 16.69s | valid loss  4.24 | valid ppl    69.25 | valid bpc    6.114
-----------------------------------------------------------------------------------------
PROGRESS: 76.0%
| epoch  77 |   100/  216 batches | lr 0.00000 | ms/batch 75.91 | loss  2.94 | ppl    18.95 
| epoch  77 |   200/  216 batches | lr 0.00000 | ms/batch 74.30 | loss  2.88 | ppl    17.89 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 16.69s | valid loss  4.22 | valid ppl    68.11 | valid bpc    6.090
-----------------------------------------------------------------------------------------
PROGRESS: 77.0%
| epoch  78 |   100/  216 batches | lr 0.00000 | ms/batch 75.79 | loss  2.94 | ppl    18.87 
| epoch  78 |   200/  216 batches | lr 0.00000 | ms/batch 74.42 | loss  2.89 | ppl    18.03 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 16.68s | valid loss  4.20 | valid ppl    66.84 | valid bpc    6.063
-----------------------------------------------------------------------------------------
PROGRESS: 78.0%
| epoch  79 |   100/  216 batches | lr 0.00000 | ms/batch 75.86 | loss  2.92 | ppl    18.60 
| epoch  79 |   200/  216 batches | lr 0.00000 | ms/batch 74.22 | loss  2.92 | ppl    18.53 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 16.68s | valid loss  4.22 | valid ppl    67.96 | valid bpc    6.087
-----------------------------------------------------------------------------------------
PROGRESS: 79.0%
| epoch  80 |   100/  216 batches | lr 0.00000 | ms/batch 75.85 | loss  2.92 | ppl    18.45 
| epoch  80 |   200/  216 batches | lr 0.00000 | ms/batch 74.30 | loss  2.90 | ppl    18.17 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 16.68s | valid loss  4.17 | valid ppl    65.03 | valid bpc    6.023
-----------------------------------------------------------------------------------------
PROGRESS: 80.0%
| epoch  81 |   100/  216 batches | lr 0.00000 | ms/batch 75.85 | loss  2.94 | ppl    19.00 
| epoch  81 |   200/  216 batches | lr 0.00000 | ms/batch 74.27 | loss  2.88 | ppl    17.88 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 16.68s | valid loss  4.20 | valid ppl    66.82 | valid bpc    6.062
-----------------------------------------------------------------------------------------
PROGRESS: 81.0%
| epoch  82 |   100/  216 batches | lr 0.00000 | ms/batch 75.52 | loss  2.92 | ppl    18.63 
| epoch  82 |   200/  216 batches | lr 0.00000 | ms/batch 74.53 | loss  2.90 | ppl    18.26 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 16.67s | valid loss  4.21 | valid ppl    67.46 | valid bpc    6.076
-----------------------------------------------------------------------------------------
PROGRESS: 82.0%
| epoch  83 |   100/  216 batches | lr 0.00000 | ms/batch 75.63 | loss  2.94 | ppl    18.85 
| epoch  83 |   200/  216 batches | lr 0.00000 | ms/batch 74.52 | loss  2.89 | ppl    17.99 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 16.68s | valid loss  4.18 | valid ppl    65.20 | valid bpc    6.027
-----------------------------------------------------------------------------------------
PROGRESS: 83.0%
| epoch  84 |   100/  216 batches | lr 0.00000 | ms/batch 75.48 | loss  2.91 | ppl    18.35 
| epoch  84 |   200/  216 batches | lr 0.00000 | ms/batch 74.59 | loss  2.91 | ppl    18.31 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 16.68s | valid loss  4.19 | valid ppl    66.09 | valid bpc    6.046
-----------------------------------------------------------------------------------------
PROGRESS: 84.0%
| epoch  85 |   100/  216 batches | lr 0.00000 | ms/batch 75.40 | loss  2.93 | ppl    18.71 
| epoch  85 |   200/  216 batches | lr 0.00000 | ms/batch 74.72 | loss  2.90 | ppl    18.25 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 16.68s | valid loss  4.21 | valid ppl    67.08 | valid bpc    6.068
-----------------------------------------------------------------------------------------
PROGRESS: 85.0%
| epoch  86 |   100/  216 batches | lr 0.00000 | ms/batch 75.74 | loss  2.95 | ppl    19.05 
| epoch  86 |   200/  216 batches | lr 0.00000 | ms/batch 74.52 | loss  2.89 | ppl    17.91 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 16.68s | valid loss  4.21 | valid ppl    67.15 | valid bpc    6.069
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  216 batches | lr 0.00000 | ms/batch 75.84 | loss  2.90 | ppl    18.25 
| epoch  87 |   200/  216 batches | lr 0.00000 | ms/batch 74.27 | loss  2.89 | ppl    18.05 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 16.68s | valid loss  4.22 | valid ppl    67.78 | valid bpc    6.083
-----------------------------------------------------------------------------------------
PROGRESS: 87.0%
| epoch  88 |   100/  216 batches | lr 0.00000 | ms/batch 75.79 | loss  2.91 | ppl    18.31 
| epoch  88 |   200/  216 batches | lr 0.00000 | ms/batch 74.33 | loss  2.91 | ppl    18.30 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 16.68s | valid loss  4.21 | valid ppl    67.03 | valid bpc    6.067
-----------------------------------------------------------------------------------------
PROGRESS: 88.0%
| epoch  89 |   100/  216 batches | lr 0.00000 | ms/batch 75.94 | loss  2.91 | ppl    18.40 
| epoch  89 |   200/  216 batches | lr 0.00000 | ms/batch 74.32 | loss  2.89 | ppl    17.92 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 16.68s | valid loss  4.22 | valid ppl    67.99 | valid bpc    6.087
-----------------------------------------------------------------------------------------
PROGRESS: 89.0%
| epoch  90 |   100/  216 batches | lr 0.00000 | ms/batch 75.53 | loss  2.93 | ppl    18.78 
| epoch  90 |   200/  216 batches | lr 0.00000 | ms/batch 74.59 | loss  2.87 | ppl    17.67 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 16.68s | valid loss  4.20 | valid ppl    66.55 | valid bpc    6.056
-----------------------------------------------------------------------------------------
PROGRESS: 90.0%
| epoch  91 |   100/  216 batches | lr 0.00000 | ms/batch 75.58 | loss  2.96 | ppl    19.22 
| epoch  91 |   200/  216 batches | lr 0.00000 | ms/batch 74.63 | loss  2.90 | ppl    18.15 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 16.68s | valid loss  4.20 | valid ppl    66.73 | valid bpc    6.060
-----------------------------------------------------------------------------------------
PROGRESS: 91.0%
| epoch  92 |   100/  216 batches | lr 0.00000 | ms/batch 75.91 | loss  2.93 | ppl    18.77 
| epoch  92 |   200/  216 batches | lr 0.00000 | ms/batch 74.24 | loss  2.89 | ppl    18.02 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 16.67s | valid loss  4.20 | valid ppl    66.76 | valid bpc    6.061
-----------------------------------------------------------------------------------------
PROGRESS: 92.0%
| epoch  93 |   100/  216 batches | lr 0.00000 | ms/batch 76.00 | loss  2.92 | ppl    18.62 
| epoch  93 |   200/  216 batches | lr 0.00000 | ms/batch 74.16 | loss  2.89 | ppl    17.93 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 16.67s | valid loss  4.18 | valid ppl    65.64 | valid bpc    6.037
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  216 batches | lr 0.00000 | ms/batch 75.54 | loss  2.92 | ppl    18.54 
| epoch  94 |   200/  216 batches | lr 0.00000 | ms/batch 74.52 | loss  2.89 | ppl    18.07 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 16.68s | valid loss  4.21 | valid ppl    67.67 | valid bpc    6.080
-----------------------------------------------------------------------------------------
PROGRESS: 94.0%
| epoch  95 |   100/  216 batches | lr 0.00000 | ms/batch 75.67 | loss  2.93 | ppl    18.81 
| epoch  95 |   200/  216 batches | lr 0.00000 | ms/batch 74.47 | loss  2.89 | ppl    17.99 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 16.68s | valid loss  4.20 | valid ppl    66.75 | valid bpc    6.061
-----------------------------------------------------------------------------------------
PROGRESS: 95.0%
| epoch  96 |   100/  216 batches | lr 0.00000 | ms/batch 75.27 | loss  2.93 | ppl    18.78 
| epoch  96 |   200/  216 batches | lr 0.00000 | ms/batch 74.81 | loss  2.89 | ppl    18.07 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 16.68s | valid loss  4.22 | valid ppl    68.25 | valid bpc    6.093
-----------------------------------------------------------------------------------------
PROGRESS: 96.0%
| epoch  97 |   100/  216 batches | lr 0.00000 | ms/batch 75.89 | loss  2.91 | ppl    18.43 
| epoch  97 |   200/  216 batches | lr 0.00000 | ms/batch 74.31 | loss  2.90 | ppl    18.21 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 16.68s | valid loss  4.20 | valid ppl    66.62 | valid bpc    6.058
-----------------------------------------------------------------------------------------
PROGRESS: 97.0%
| epoch  98 |   100/  216 batches | lr 0.00000 | ms/batch 75.76 | loss  2.92 | ppl    18.56 
| epoch  98 |   200/  216 batches | lr 0.00000 | ms/batch 74.41 | loss  2.89 | ppl    18.05 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 16.68s | valid loss  4.23 | valid ppl    68.92 | valid bpc    6.107
-----------------------------------------------------------------------------------------
PROGRESS: 98.0%
| epoch  99 |   100/  216 batches | lr 0.00000 | ms/batch 75.95 | loss  2.92 | ppl    18.61 
| epoch  99 |   200/  216 batches | lr 0.00000 | ms/batch 74.25 | loss  2.89 | ppl    18.06 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 16.68s | valid loss  4.20 | valid ppl    66.66 | valid bpc    6.059
-----------------------------------------------------------------------------------------
PROGRESS: 99.0%
| epoch 100 |   100/  216 batches | lr 0.00000 | ms/batch 76.05 | loss  2.93 | ppl    18.67 
| epoch 100 |   200/  216 batches | lr 0.00000 | ms/batch 74.10 | loss  2.89 | ppl    18.02 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 16.68s | valid loss  4.18 | valid ppl    65.68 | valid bpc    6.037
-----------------------------------------------------------------------------------------
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  4.16 | test ppl    64.07 | test bpc    6.002
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.4232, Mean Reca: 0.5836, Mean F1: 0.4825
Counter({'NP': 8734, 'PP': 4188, 'S': 3200, 'VP': 2945, 'SBAR': 591, 'ADJP': 263, 'QP': 216, 'ADVP': 180, 'SINV': 149, 'PRN': 51, 'FRAG': 35, 'WHNP': 29, 'UCP': 15, 'NX': 15, 'SQ': 14, 'NAC': 12, 'SBARQ': 8, 'WHPP': 7, 'CONJP': 3, 'X': 2, 'WHADVP': 1})
Counter({'NP': 14432, 'VP': 8130, 'S': 5620, 'PP': 5484, 'SBAR': 1796, 'ADJP': 649, 'QP': 490, 'ADVP': 286, 'SINV': 157, 'PRN': 128, 'NX': 95, 'FRAG': 42, 'WHNP': 37, 'UCP': 32, 'NAC': 30, 'WHPP': 25, 'CONJP': 21, 'SQ': 18, 'SBARQ': 10, 'WHADVP': 9, 'X': 6, 'WHADJP': 4, 'INTJ': 1})
SBAR: 0.3291
NP: 0.6052
VP: 0.3622
PP: 0.7637
ADJP: 0.4052
ADVP: 0.6294
4.860107437571763
-----------------------------------------------------------------------------------------
Dependency parsing performance:
Conll-U Style:
DDA: 0.409
UDA: 0.545
=========================================================================================
Loading dataset...
Loading dictionary...
Number of tokens:  10001
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer_in_parser', nhid=512, nlayers=8, front_layers=6, rear_layers=2, n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=3333, nonmono=5, cuda=True, log_interval=100, save='trained_models/structformer_in_parser_3333_62.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 38475573
Model architecture: StructFormer_In_Parser(
  (transformer_front): Transformer_Front(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(10001, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-5): 6 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
  (transformer_rear): Transformer_Rear(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(10001, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-1): 2 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (output_layer): Linear(in_features=512, out_features=10001, bias=True)
  )
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  216 batches | lr 0.00030 | ms/batch 78.70 | loss  7.28 | ppl  1452.43 
| epoch   1 |   200/  216 batches | lr 0.00030 | ms/batch 73.63 | loss  6.86 | ppl   955.21 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 16.90s | valid loss  6.71 | valid ppl   823.44 | valid bpc    9.686
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  216 batches | lr 0.00030 | ms/batch 75.13 | loss  6.78 | ppl   879.52 
| epoch   2 |   200/  216 batches | lr 0.00030 | ms/batch 73.86 | loss  6.44 | ppl   627.69 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 16.56s | valid loss  6.21 | valid ppl   495.50 | valid bpc    8.953
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  216 batches | lr 0.00030 | ms/batch 75.39 | loss  6.23 | ppl   508.81 
| epoch   3 |   200/  216 batches | lr 0.00030 | ms/batch 74.06 | loss  5.95 | ppl   384.02 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 16.60s | valid loss  5.81 | valid ppl   333.50 | valid bpc    8.382
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  216 batches | lr 0.00030 | ms/batch 75.60 | loss  5.79 | ppl   327.59 
| epoch   4 |   200/  216 batches | lr 0.00030 | ms/batch 74.22 | loss  5.63 | ppl   277.73 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 16.63s | valid loss  5.52 | valid ppl   250.29 | valid bpc    7.967
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  216 batches | lr 0.00030 | ms/batch 75.77 | loss  5.53 | ppl   251.77 
| epoch   5 |   200/  216 batches | lr 0.00030 | ms/batch 74.11 | loss  5.38 | ppl   217.06 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 16.64s | valid loss  5.32 | valid ppl   203.72 | valid bpc    7.670
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  216 batches | lr 0.00030 | ms/batch 75.46 | loss  5.32 | ppl   205.15 
| epoch   6 |   200/  216 batches | lr 0.00030 | ms/batch 74.50 | loss  5.23 | ppl   186.18 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 16.65s | valid loss  5.20 | valid ppl   182.00 | valid bpc    7.508
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  216 batches | lr 0.00030 | ms/batch 75.46 | loss  5.18 | ppl   177.34 
| epoch   7 |   200/  216 batches | lr 0.00030 | ms/batch 74.54 | loss  5.08 | ppl   161.37 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 16.66s | valid loss  5.09 | valid ppl   162.72 | valid bpc    7.346
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  216 batches | lr 0.00030 | ms/batch 75.31 | loss  5.01 | ppl   150.46 
| epoch   8 |   200/  216 batches | lr 0.00030 | ms/batch 74.71 | loss  4.98 | ppl   144.79 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 16.67s | valid loss  5.01 | valid ppl   149.68 | valid bpc    7.226
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 8.0%
| epoch   9 |   100/  216 batches | lr 0.00030 | ms/batch 75.38 | loss  4.92 | ppl   137.19 
| epoch   9 |   200/  216 batches | lr 0.00030 | ms/batch 74.70 | loss  4.85 | ppl   127.32 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 16.67s | valid loss  4.85 | valid ppl   127.94 | valid bpc    6.999
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  216 batches | lr 0.00030 | ms/batch 75.82 | loss  4.84 | ppl   126.04 
| epoch  10 |   200/  216 batches | lr 0.00030 | ms/batch 74.32 | loss  4.77 | ppl   117.38 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 16.67s | valid loss  4.84 | valid ppl   126.90 | valid bpc    6.988
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  216 batches | lr 0.00030 | ms/batch 75.76 | loss  4.76 | ppl   116.83 
| epoch  11 |   200/  216 batches | lr 0.00030 | ms/batch 74.38 | loss  4.66 | ppl   106.09 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 16.67s | valid loss  4.77 | valid ppl   117.47 | valid bpc    6.876
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  216 batches | lr 0.00030 | ms/batch 75.45 | loss  4.65 | ppl   104.98 
| epoch  12 |   200/  216 batches | lr 0.00030 | ms/batch 74.62 | loss  4.57 | ppl    96.42 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 16.68s | valid loss  4.74 | valid ppl   114.60 | valid bpc    6.840
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 12.0%
| epoch  13 |   100/  216 batches | lr 0.00030 | ms/batch 75.52 | loss  4.57 | ppl    96.36 
| epoch  13 |   200/  216 batches | lr 0.00030 | ms/batch 74.65 | loss  4.50 | ppl    89.90 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 16.68s | valid loss  4.71 | valid ppl   110.79 | valid bpc    6.792
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 13.0%
| epoch  14 |   100/  216 batches | lr 0.00030 | ms/batch 75.74 | loss  4.49 | ppl    88.92 
| epoch  14 |   200/  216 batches | lr 0.00030 | ms/batch 74.39 | loss  4.45 | ppl    85.78 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 16.68s | valid loss  4.62 | valid ppl   101.83 | valid bpc    6.670
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  216 batches | lr 0.00030 | ms/batch 75.55 | loss  4.42 | ppl    83.39 
| epoch  15 |   200/  216 batches | lr 0.00030 | ms/batch 74.63 | loss  4.36 | ppl    78.62 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 16.67s | valid loss  4.61 | valid ppl   100.27 | valid bpc    6.648
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 15.0%
| epoch  16 |   100/  216 batches | lr 0.00030 | ms/batch 75.65 | loss  4.35 | ppl    77.10 
| epoch  16 |   200/  216 batches | lr 0.00030 | ms/batch 74.50 | loss  4.30 | ppl    73.83 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 16.68s | valid loss  4.57 | valid ppl    96.39 | valid bpc    6.591
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 16.0%
| epoch  17 |   100/  216 batches | lr 0.00030 | ms/batch 75.76 | loss  4.29 | ppl    72.99 
| epoch  17 |   200/  216 batches | lr 0.00030 | ms/batch 74.20 | loss  4.23 | ppl    68.61 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 16.67s | valid loss  4.44 | valid ppl    84.43 | valid bpc    6.400
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 17.0%
| epoch  18 |   100/  216 batches | lr 0.00030 | ms/batch 75.37 | loss  4.20 | ppl    67.00 
| epoch  18 |   200/  216 batches | lr 0.00030 | ms/batch 74.33 | loss  4.19 | ppl    65.84 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 16.67s | valid loss  4.52 | valid ppl    92.26 | valid bpc    6.528
-----------------------------------------------------------------------------------------
PROGRESS: 18.0%
| epoch  19 |   100/  216 batches | lr 0.00030 | ms/batch 75.76 | loss  4.18 | ppl    65.21 
| epoch  19 |   200/  216 batches | lr 0.00030 | ms/batch 74.41 | loss  4.11 | ppl    60.65 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 16.68s | valid loss  4.46 | valid ppl    86.24 | valid bpc    6.430
-----------------------------------------------------------------------------------------
PROGRESS: 19.0%
| epoch  20 |   100/  216 batches | lr 0.00030 | ms/batch 75.73 | loss  4.12 | ppl    61.45 
| epoch  20 |   200/  216 batches | lr 0.00030 | ms/batch 74.44 | loss  4.06 | ppl    57.69 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 16.68s | valid loss  4.46 | valid ppl    86.61 | valid bpc    6.436
-----------------------------------------------------------------------------------------
PROGRESS: 20.0%
| epoch  21 |   100/  216 batches | lr 0.00015 | ms/batch 75.70 | loss  3.99 | ppl    54.22 
| epoch  21 |   200/  216 batches | lr 0.00015 | ms/batch 74.63 | loss  3.96 | ppl    52.38 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 16.69s | valid loss  4.42 | valid ppl    83.29 | valid bpc    6.380
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 21.0%
| epoch  22 |   100/  216 batches | lr 0.00015 | ms/batch 75.48 | loss  3.94 | ppl    51.54 
| epoch  22 |   200/  216 batches | lr 0.00015 | ms/batch 74.73 | loss  3.91 | ppl    50.03 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 16.69s | valid loss  4.35 | valid ppl    77.10 | valid bpc    6.269
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 22.0%
| epoch  23 |   100/  216 batches | lr 0.00015 | ms/batch 75.46 | loss  3.89 | ppl    48.80 
| epoch  23 |   200/  216 batches | lr 0.00015 | ms/batch 74.68 | loss  3.88 | ppl    48.23 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 16.68s | valid loss  4.34 | valid ppl    76.51 | valid bpc    6.257
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 23.0%
| epoch  24 |   100/  216 batches | lr 0.00015 | ms/batch 75.39 | loss  3.89 | ppl    48.94 
| epoch  24 |   200/  216 batches | lr 0.00015 | ms/batch 74.81 | loss  3.83 | ppl    45.87 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 16.68s | valid loss  4.33 | valid ppl    76.12 | valid bpc    6.250
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 24.0%
| epoch  25 |   100/  216 batches | lr 0.00015 | ms/batch 75.62 | loss  3.83 | ppl    46.26 
| epoch  25 |   200/  216 batches | lr 0.00015 | ms/batch 74.51 | loss  3.81 | ppl    45.00 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 16.68s | valid loss  4.35 | valid ppl    77.57 | valid bpc    6.278
-----------------------------------------------------------------------------------------
PROGRESS: 25.0%
| epoch  26 |   100/  216 batches | lr 0.00015 | ms/batch 75.67 | loss  3.80 | ppl    44.55 
| epoch  26 |   200/  216 batches | lr 0.00015 | ms/batch 74.54 | loss  3.80 | ppl    44.79 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 16.69s | valid loss  4.35 | valid ppl    77.32 | valid bpc    6.273
-----------------------------------------------------------------------------------------
PROGRESS: 26.0%
| epoch  27 |   100/  216 batches | lr 0.00015 | ms/batch 75.47 | loss  3.77 | ppl    43.51 
| epoch  27 |   200/  216 batches | lr 0.00015 | ms/batch 74.75 | loss  3.76 | ppl    42.75 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 16.69s | valid loss  4.32 | valid ppl    75.53 | valid bpc    6.239
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 27.0%
| epoch  28 |   100/  216 batches | lr 0.00015 | ms/batch 75.74 | loss  3.75 | ppl    42.59 
| epoch  28 |   200/  216 batches | lr 0.00015 | ms/batch 74.45 | loss  3.73 | ppl    41.60 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 16.68s | valid loss  4.26 | valid ppl    70.95 | valid bpc    6.149
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  216 batches | lr 0.00015 | ms/batch 75.90 | loss  3.70 | ppl    40.57 
| epoch  29 |   200/  216 batches | lr 0.00015 | ms/batch 74.26 | loss  3.71 | ppl    40.86 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 16.68s | valid loss  4.27 | valid ppl    71.38 | valid bpc    6.158
-----------------------------------------------------------------------------------------
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  216 batches | lr 0.00015 | ms/batch 75.29 | loss  3.70 | ppl    40.26 
| epoch  30 |   200/  216 batches | lr 0.00015 | ms/batch 74.85 | loss  3.68 | ppl    39.83 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 16.68s | valid loss  4.30 | valid ppl    73.53 | valid bpc    6.200
-----------------------------------------------------------------------------------------
PROGRESS: 30.0%
| epoch  31 |   100/  216 batches | lr 0.00015 | ms/batch 75.85 | loss  3.66 | ppl    38.80 
| epoch  31 |   200/  216 batches | lr 0.00015 | ms/batch 74.30 | loss  3.65 | ppl    38.50 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 16.69s | valid loss  4.28 | valid ppl    72.59 | valid bpc    6.182
-----------------------------------------------------------------------------------------
PROGRESS: 31.0%
| epoch  32 |   100/  216 batches | lr 0.00007 | ms/batch 75.99 | loss  3.64 | ppl    38.06 
| epoch  32 |   200/  216 batches | lr 0.00007 | ms/batch 74.24 | loss  3.55 | ppl    34.97 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 16.68s | valid loss  4.28 | valid ppl    72.51 | valid bpc    6.180
-----------------------------------------------------------------------------------------
PROGRESS: 32.0%
| epoch  33 |   100/  216 batches | lr 0.00007 | ms/batch 75.56 | loss  3.59 | ppl    36.11 
| epoch  33 |   200/  216 batches | lr 0.00007 | ms/batch 74.60 | loss  3.56 | ppl    35.22 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 16.68s | valid loss  4.23 | valid ppl    68.65 | valid bpc    6.101
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 33.0%
| epoch  34 |   100/  216 batches | lr 0.00007 | ms/batch 75.88 | loss  3.58 | ppl    35.89 
| epoch  34 |   200/  216 batches | lr 0.00007 | ms/batch 74.33 | loss  3.53 | ppl    34.29 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 16.68s | valid loss  4.23 | valid ppl    68.77 | valid bpc    6.104
-----------------------------------------------------------------------------------------
PROGRESS: 34.0%
| epoch  35 |   100/  216 batches | lr 0.00007 | ms/batch 75.44 | loss  3.54 | ppl    34.31 
| epoch  35 |   200/  216 batches | lr 0.00007 | ms/batch 74.81 | loss  3.55 | ppl    34.75 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 16.68s | valid loss  4.18 | valid ppl    65.25 | valid bpc    6.028
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 35.0%
| epoch  36 |   100/  216 batches | lr 0.00007 | ms/batch 75.77 | loss  3.53 | ppl    34.14 
| epoch  36 |   200/  216 batches | lr 0.00007 | ms/batch 74.44 | loss  3.49 | ppl    32.85 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 16.69s | valid loss  4.25 | valid ppl    70.28 | valid bpc    6.135
-----------------------------------------------------------------------------------------
PROGRESS: 36.0%
| epoch  37 |   100/  216 batches | lr 0.00007 | ms/batch 75.90 | loss  3.52 | ppl    33.70 
| epoch  37 |   200/  216 batches | lr 0.00007 | ms/batch 74.31 | loss  3.49 | ppl    32.84 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 16.69s | valid loss  4.30 | valid ppl    73.70 | valid bpc    6.204
-----------------------------------------------------------------------------------------
PROGRESS: 37.0%
| epoch  38 |   100/  216 batches | lr 0.00007 | ms/batch 75.95 | loss  3.50 | ppl    33.25 
| epoch  38 |   200/  216 batches | lr 0.00007 | ms/batch 74.22 | loss  3.46 | ppl    31.94 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 16.68s | valid loss  4.20 | valid ppl    66.67 | valid bpc    6.059
-----------------------------------------------------------------------------------------
PROGRESS: 38.0%
| epoch  39 |   100/  216 batches | lr 0.00004 | ms/batch 75.73 | loss  3.47 | ppl    32.21 
| epoch  39 |   200/  216 batches | lr 0.00004 | ms/batch 74.13 | loss  3.45 | ppl    31.43 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 16.68s | valid loss  4.20 | valid ppl    66.42 | valid bpc    6.054
-----------------------------------------------------------------------------------------
PROGRESS: 39.0%
| epoch  40 |   100/  216 batches | lr 0.00004 | ms/batch 75.71 | loss  3.47 | ppl    32.06 
| epoch  40 |   200/  216 batches | lr 0.00004 | ms/batch 74.52 | loss  3.42 | ppl    30.62 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 16.68s | valid loss  4.20 | valid ppl    67.00 | valid bpc    6.066
-----------------------------------------------------------------------------------------
PROGRESS: 40.0%
| epoch  41 |   100/  216 batches | lr 0.00004 | ms/batch 75.59 | loss  3.45 | ppl    31.48 
| epoch  41 |   200/  216 batches | lr 0.00004 | ms/batch 74.66 | loss  3.41 | ppl    30.35 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 16.69s | valid loss  4.24 | valid ppl    69.09 | valid bpc    6.110
-----------------------------------------------------------------------------------------
PROGRESS: 41.0%
| epoch  42 |   100/  216 batches | lr 0.00002 | ms/batch 75.41 | loss  3.41 | ppl    30.36 
| epoch  42 |   200/  216 batches | lr 0.00002 | ms/batch 74.69 | loss  3.39 | ppl    29.63 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 16.68s | valid loss  4.22 | valid ppl    67.78 | valid bpc    6.083
-----------------------------------------------------------------------------------------
PROGRESS: 42.0%
| epoch  43 |   100/  216 batches | lr 0.00002 | ms/batch 75.58 | loss  3.43 | ppl    31.03 
| epoch  43 |   200/  216 batches | lr 0.00002 | ms/batch 74.62 | loss  3.38 | ppl    29.50 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 16.68s | valid loss  4.23 | valid ppl    68.73 | valid bpc    6.103
-----------------------------------------------------------------------------------------
PROGRESS: 43.0%
| epoch  44 |   100/  216 batches | lr 0.00002 | ms/batch 75.98 | loss  3.45 | ppl    31.43 
| epoch  44 |   200/  216 batches | lr 0.00002 | ms/batch 74.21 | loss  3.37 | ppl    29.04 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 16.69s | valid loss  4.21 | valid ppl    67.08 | valid bpc    6.068
-----------------------------------------------------------------------------------------
PROGRESS: 44.0%
| epoch  45 |   100/  216 batches | lr 0.00001 | ms/batch 75.37 | loss  3.43 | ppl    30.77 
| epoch  45 |   200/  216 batches | lr 0.00001 | ms/batch 74.86 | loss  3.38 | ppl    29.49 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 16.68s | valid loss  4.21 | valid ppl    67.12 | valid bpc    6.069
-----------------------------------------------------------------------------------------
PROGRESS: 45.0%
| epoch  46 |   100/  216 batches | lr 0.00001 | ms/batch 75.55 | loss  3.41 | ppl    30.33 
| epoch  46 |   200/  216 batches | lr 0.00001 | ms/batch 74.68 | loss  3.38 | ppl    29.26 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 16.69s | valid loss  4.20 | valid ppl    66.59 | valid bpc    6.057
-----------------------------------------------------------------------------------------
PROGRESS: 46.0%
| epoch  47 |   100/  216 batches | lr 0.00001 | ms/batch 75.62 | loss  3.40 | ppl    29.98 
| epoch  47 |   200/  216 batches | lr 0.00001 | ms/batch 74.62 | loss  3.40 | ppl    30.10 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 16.68s | valid loss  4.23 | valid ppl    68.46 | valid bpc    6.097
-----------------------------------------------------------------------------------------
PROGRESS: 47.0%
| epoch  48 |   100/  216 batches | lr 0.00000 | ms/batch 75.73 | loss  3.40 | ppl    30.06 
| epoch  48 |   200/  216 batches | lr 0.00000 | ms/batch 74.41 | loss  3.38 | ppl    29.27 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 16.68s | valid loss  4.20 | valid ppl    66.41 | valid bpc    6.053
-----------------------------------------------------------------------------------------
PROGRESS: 48.0%
| epoch  49 |   100/  216 batches | lr 0.00000 | ms/batch 75.46 | loss  3.38 | ppl    29.29 
| epoch  49 |   200/  216 batches | lr 0.00000 | ms/batch 74.43 | loss  3.38 | ppl    29.40 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 16.68s | valid loss  4.24 | valid ppl    69.29 | valid bpc    6.115
-----------------------------------------------------------------------------------------
PROGRESS: 49.0%
| epoch  50 |   100/  216 batches | lr 0.00000 | ms/batch 75.93 | loss  3.38 | ppl    29.29 
| epoch  50 |   200/  216 batches | lr 0.00000 | ms/batch 74.15 | loss  3.38 | ppl    29.23 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 16.69s | valid loss  4.19 | valid ppl    66.11 | valid bpc    6.047
-----------------------------------------------------------------------------------------
PROGRESS: 50.0%
| epoch  51 |   100/  216 batches | lr 0.00000 | ms/batch 76.03 | loss  3.40 | ppl    29.97 
| epoch  51 |   200/  216 batches | lr 0.00000 | ms/batch 74.23 | loss  3.39 | ppl    29.57 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 16.68s | valid loss  4.21 | valid ppl    67.53 | valid bpc    6.077
-----------------------------------------------------------------------------------------
PROGRESS: 51.0%
| epoch  52 |   100/  216 batches | lr 0.00000 | ms/batch 75.89 | loss  3.38 | ppl    29.41 
| epoch  52 |   200/  216 batches | lr 0.00000 | ms/batch 74.36 | loss  3.37 | ppl    28.96 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 16.68s | valid loss  4.21 | valid ppl    67.63 | valid bpc    6.080
-----------------------------------------------------------------------------------------
PROGRESS: 52.0%
| epoch  53 |   100/  216 batches | lr 0.00000 | ms/batch 75.43 | loss  3.40 | ppl    30.06 
| epoch  53 |   200/  216 batches | lr 0.00000 | ms/batch 74.80 | loss  3.37 | ppl    29.21 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 16.69s | valid loss  4.17 | valid ppl    65.01 | valid bpc    6.023
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 53.0%
| epoch  54 |   100/  216 batches | lr 0.00000 | ms/batch 75.49 | loss  3.39 | ppl    29.68 
| epoch  54 |   200/  216 batches | lr 0.00000 | ms/batch 74.53 | loss  3.39 | ppl    29.78 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 16.68s | valid loss  4.20 | valid ppl    66.59 | valid bpc    6.057
-----------------------------------------------------------------------------------------
PROGRESS: 54.0%
| epoch  55 |   100/  216 batches | lr 0.00000 | ms/batch 75.46 | loss  3.39 | ppl    29.78 
| epoch  55 |   200/  216 batches | lr 0.00000 | ms/batch 74.68 | loss  3.34 | ppl    28.20 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 16.68s | valid loss  4.19 | valid ppl    65.94 | valid bpc    6.043
-----------------------------------------------------------------------------------------
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  216 batches | lr 0.00000 | ms/batch 75.42 | loss  3.38 | ppl    29.42 
| epoch  56 |   200/  216 batches | lr 0.00000 | ms/batch 74.69 | loss  3.36 | ppl    28.78 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 16.68s | valid loss  4.21 | valid ppl    67.57 | valid bpc    6.078
-----------------------------------------------------------------------------------------
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  216 batches | lr 0.00000 | ms/batch 75.81 | loss  3.38 | ppl    29.36 
| epoch  57 |   200/  216 batches | lr 0.00000 | ms/batch 74.29 | loss  3.40 | ppl    29.84 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 16.68s | valid loss  4.19 | valid ppl    66.02 | valid bpc    6.045
-----------------------------------------------------------------------------------------
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  216 batches | lr 0.00000 | ms/batch 75.72 | loss  3.40 | ppl    29.94 
| epoch  58 |   200/  216 batches | lr 0.00000 | ms/batch 74.42 | loss  3.35 | ppl    28.44 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 16.68s | valid loss  4.22 | valid ppl    68.14 | valid bpc    6.091
-----------------------------------------------------------------------------------------
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  216 batches | lr 0.00000 | ms/batch 75.89 | loss  3.40 | ppl    30.06 
| epoch  59 |   200/  216 batches | lr 0.00000 | ms/batch 74.26 | loss  3.37 | ppl    29.21 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 16.68s | valid loss  4.20 | valid ppl    66.88 | valid bpc    6.064
-----------------------------------------------------------------------------------------
PROGRESS: 59.0%
| epoch  60 |   100/  216 batches | lr 0.00000 | ms/batch 75.50 | loss  3.38 | ppl    29.32 
| epoch  60 |   200/  216 batches | lr 0.00000 | ms/batch 74.76 | loss  3.36 | ppl    28.77 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 16.69s | valid loss  4.20 | valid ppl    66.81 | valid bpc    6.062
-----------------------------------------------------------------------------------------
PROGRESS: 60.0%
| epoch  61 |   100/  216 batches | lr 0.00000 | ms/batch 75.68 | loss  3.38 | ppl    29.50 
| epoch  61 |   200/  216 batches | lr 0.00000 | ms/batch 74.64 | loss  3.36 | ppl    28.88 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 16.69s | valid loss  4.19 | valid ppl    65.75 | valid bpc    6.039
-----------------------------------------------------------------------------------------
PROGRESS: 61.0%
| epoch  62 |   100/  216 batches | lr 0.00000 | ms/batch 75.94 | loss  3.41 | ppl    30.14 
| epoch  62 |   200/  216 batches | lr 0.00000 | ms/batch 74.26 | loss  3.33 | ppl    28.01 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 16.68s | valid loss  4.24 | valid ppl    69.45 | valid bpc    6.118
-----------------------------------------------------------------------------------------
PROGRESS: 62.0%
| epoch  63 |   100/  216 batches | lr 0.00000 | ms/batch 75.58 | loss  3.39 | ppl    29.78 
| epoch  63 |   200/  216 batches | lr 0.00000 | ms/batch 74.74 | loss  3.36 | ppl    28.85 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 16.69s | valid loss  4.18 | valid ppl    65.67 | valid bpc    6.037
-----------------------------------------------------------------------------------------
PROGRESS: 63.0%
| epoch  64 |   100/  216 batches | lr 0.00000 | ms/batch 75.53 | loss  3.38 | ppl    29.43 
| epoch  64 |   200/  216 batches | lr 0.00000 | ms/batch 74.67 | loss  3.38 | ppl    29.23 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 16.68s | valid loss  4.18 | valid ppl    65.66 | valid bpc    6.037
-----------------------------------------------------------------------------------------
PROGRESS: 64.0%
| epoch  65 |   100/  216 batches | lr 0.00000 | ms/batch 75.79 | loss  3.38 | ppl    29.27 
| epoch  65 |   200/  216 batches | lr 0.00000 | ms/batch 74.48 | loss  3.37 | ppl    29.02 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 16.69s | valid loss  4.23 | valid ppl    68.74 | valid bpc    6.103
-----------------------------------------------------------------------------------------
PROGRESS: 65.0%
| epoch  66 |   100/  216 batches | lr 0.00000 | ms/batch 75.50 | loss  3.40 | ppl    29.90 
| epoch  66 |   200/  216 batches | lr 0.00000 | ms/batch 74.71 | loss  3.37 | ppl    29.12 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 16.69s | valid loss  4.22 | valid ppl    67.74 | valid bpc    6.082
-----------------------------------------------------------------------------------------
PROGRESS: 66.0%
| epoch  67 |   100/  216 batches | lr 0.00000 | ms/batch 76.09 | loss  3.40 | ppl    29.96 
| epoch  67 |   200/  216 batches | lr 0.00000 | ms/batch 74.12 | loss  3.34 | ppl    28.18 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 16.69s | valid loss  4.20 | valid ppl    66.77 | valid bpc    6.061
-----------------------------------------------------------------------------------------
PROGRESS: 67.0%
| epoch  68 |   100/  216 batches | lr 0.00000 | ms/batch 75.86 | loss  3.40 | ppl    29.85 
| epoch  68 |   200/  216 batches | lr 0.00000 | ms/batch 74.29 | loss  3.36 | ppl    28.69 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 16.69s | valid loss  4.24 | valid ppl    69.72 | valid bpc    6.124
-----------------------------------------------------------------------------------------
PROGRESS: 68.0%
| epoch  69 |   100/  216 batches | lr 0.00000 | ms/batch 75.64 | loss  3.40 | ppl    29.92 
| epoch  69 |   200/  216 batches | lr 0.00000 | ms/batch 74.55 | loss  3.36 | ppl    28.77 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 16.69s | valid loss  4.19 | valid ppl    66.32 | valid bpc    6.051
-----------------------------------------------------------------------------------------
PROGRESS: 69.0%
| epoch  70 |   100/  216 batches | lr 0.00000 | ms/batch 75.95 | loss  3.40 | ppl    30.07 
| epoch  70 |   200/  216 batches | lr 0.00000 | ms/batch 74.30 | loss  3.35 | ppl    28.57 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 16.69s | valid loss  4.18 | valid ppl    65.22 | valid bpc    6.027
-----------------------------------------------------------------------------------------
PROGRESS: 70.0%
| epoch  71 |   100/  216 batches | lr 0.00000 | ms/batch 75.40 | loss  3.39 | ppl    29.80 
| epoch  71 |   200/  216 batches | lr 0.00000 | ms/batch 74.83 | loss  3.34 | ppl    28.35 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 16.68s | valid loss  4.21 | valid ppl    67.49 | valid bpc    6.077
-----------------------------------------------------------------------------------------
PROGRESS: 71.0%
| epoch  72 |   100/  216 batches | lr 0.00000 | ms/batch 75.28 | loss  3.41 | ppl    30.28 
| epoch  72 |   200/  216 batches | lr 0.00000 | ms/batch 74.89 | loss  3.34 | ppl    28.22 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 16.68s | valid loss  4.20 | valid ppl    66.42 | valid bpc    6.054
-----------------------------------------------------------------------------------------
PROGRESS: 72.0%
| epoch  73 |   100/  216 batches | lr 0.00000 | ms/batch 75.88 | loss  3.41 | ppl    30.41 
| epoch  73 |   200/  216 batches | lr 0.00000 | ms/batch 74.39 | loss  3.34 | ppl    28.13 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 16.69s | valid loss  4.20 | valid ppl    66.88 | valid bpc    6.064
-----------------------------------------------------------------------------------------
PROGRESS: 73.0%
| epoch  74 |   100/  216 batches | lr 0.00000 | ms/batch 75.52 | loss  3.40 | ppl    29.96 
| epoch  74 |   200/  216 batches | lr 0.00000 | ms/batch 74.42 | loss  3.33 | ppl    27.86 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 16.69s | valid loss  4.22 | valid ppl    67.81 | valid bpc    6.083
-----------------------------------------------------------------------------------------
PROGRESS: 74.0%
| epoch  75 |   100/  216 batches | lr 0.00000 | ms/batch 75.64 | loss  3.38 | ppl    29.33 
| epoch  75 |   200/  216 batches | lr 0.00000 | ms/batch 74.59 | loss  3.36 | ppl    28.72 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 16.69s | valid loss  4.23 | valid ppl    68.97 | valid bpc    6.108
-----------------------------------------------------------------------------------------
PROGRESS: 75.0%
| epoch  76 |   100/  216 batches | lr 0.00000 | ms/batch 75.53 | loss  3.40 | ppl    29.92 
| epoch  76 |   200/  216 batches | lr 0.00000 | ms/batch 74.71 | loss  3.34 | ppl    28.11 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 16.70s | valid loss  4.18 | valid ppl    65.39 | valid bpc    6.031
-----------------------------------------------------------------------------------------
PROGRESS: 76.0%
| epoch  77 |   100/  216 batches | lr 0.00000 | ms/batch 75.40 | loss  3.40 | ppl    30.01 
| epoch  77 |   200/  216 batches | lr 0.00000 | ms/batch 74.88 | loss  3.35 | ppl    28.55 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 16.69s | valid loss  4.19 | valid ppl    65.75 | valid bpc    6.039
-----------------------------------------------------------------------------------------
PROGRESS: 77.0%
| epoch  78 |   100/  216 batches | lr 0.00000 | ms/batch 75.63 | loss  3.41 | ppl    30.37 
| epoch  78 |   200/  216 batches | lr 0.00000 | ms/batch 74.52 | loss  3.35 | ppl    28.54 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 16.69s | valid loss  4.22 | valid ppl    68.24 | valid bpc    6.093
-----------------------------------------------------------------------------------------
PROGRESS: 78.0%
| epoch  79 |   100/  216 batches | lr 0.00000 | ms/batch 75.80 | loss  3.39 | ppl    29.52 
| epoch  79 |   200/  216 batches | lr 0.00000 | ms/batch 74.37 | loss  3.37 | ppl    29.03 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 16.69s | valid loss  4.20 | valid ppl    66.70 | valid bpc    6.060
-----------------------------------------------------------------------------------------
PROGRESS: 79.0%
| epoch  80 |   100/  216 batches | lr 0.00000 | ms/batch 75.50 | loss  3.38 | ppl    29.45 
| epoch  80 |   200/  216 batches | lr 0.00000 | ms/batch 74.66 | loss  3.35 | ppl    28.60 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 16.68s | valid loss  4.26 | valid ppl    70.48 | valid bpc    6.139
-----------------------------------------------------------------------------------------
PROGRESS: 80.0%
| epoch  81 |   100/  216 batches | lr 0.00000 | ms/batch 75.88 | loss  3.40 | ppl    30.11 
| epoch  81 |   200/  216 batches | lr 0.00000 | ms/batch 74.40 | loss  3.35 | ppl    28.63 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 16.69s | valid loss  4.19 | valid ppl    65.76 | valid bpc    6.039
-----------------------------------------------------------------------------------------
PROGRESS: 81.0%
| epoch  82 |   100/  216 batches | lr 0.00000 | ms/batch 75.66 | loss  3.36 | ppl    28.91 
| epoch  82 |   200/  216 batches | lr 0.00000 | ms/batch 74.59 | loss  3.38 | ppl    29.47 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 16.69s | valid loss  4.26 | valid ppl    70.71 | valid bpc    6.144
-----------------------------------------------------------------------------------------
PROGRESS: 82.0%
| epoch  83 |   100/  216 batches | lr 0.00000 | ms/batch 75.87 | loss  3.40 | ppl    30.02 
| epoch  83 |   200/  216 batches | lr 0.00000 | ms/batch 74.36 | loss  3.36 | ppl    28.85 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 16.69s | valid loss  4.19 | valid ppl    66.34 | valid bpc    6.052
-----------------------------------------------------------------------------------------
PROGRESS: 83.0%
| epoch  84 |   100/  216 batches | lr 0.00000 | ms/batch 75.80 | loss  3.38 | ppl    29.44 
| epoch  84 |   200/  216 batches | lr 0.00000 | ms/batch 74.47 | loss  3.35 | ppl    28.41 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 16.69s | valid loss  4.23 | valid ppl    68.80 | valid bpc    6.104
-----------------------------------------------------------------------------------------
PROGRESS: 84.0%
| epoch  85 |   100/  216 batches | lr 0.00000 | ms/batch 75.62 | loss  3.37 | ppl    29.10 
| epoch  85 |   200/  216 batches | lr 0.00000 | ms/batch 74.58 | loss  3.37 | ppl    29.19 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 16.68s | valid loss  4.21 | valid ppl    67.32 | valid bpc    6.073
-----------------------------------------------------------------------------------------
PROGRESS: 85.0%
| epoch  86 |   100/  216 batches | lr 0.00000 | ms/batch 75.71 | loss  3.41 | ppl    30.24 
| epoch  86 |   200/  216 batches | lr 0.00000 | ms/batch 74.49 | loss  3.36 | ppl    28.93 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 16.69s | valid loss  4.27 | valid ppl    71.17 | valid bpc    6.153
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  216 batches | lr 0.00000 | ms/batch 75.44 | loss  3.39 | ppl    29.56 
| epoch  87 |   200/  216 batches | lr 0.00000 | ms/batch 74.83 | loss  3.38 | ppl    29.34 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 16.68s | valid loss  4.17 | valid ppl    64.77 | valid bpc    6.017
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 87.0%
| epoch  88 |   100/  216 batches | lr 0.00000 | ms/batch 75.69 | loss  3.37 | ppl    29.15 
| epoch  88 |   200/  216 batches | lr 0.00000 | ms/batch 74.53 | loss  3.36 | ppl    28.84 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 16.68s | valid loss  4.23 | valid ppl    68.55 | valid bpc    6.099
-----------------------------------------------------------------------------------------
PROGRESS: 88.0%
| epoch  89 |   100/  216 batches | lr 0.00000 | ms/batch 75.60 | loss  3.39 | ppl    29.57 
| epoch  89 |   200/  216 batches | lr 0.00000 | ms/batch 74.57 | loss  3.34 | ppl    28.35 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 16.68s | valid loss  4.26 | valid ppl    70.67 | valid bpc    6.143
-----------------------------------------------------------------------------------------
PROGRESS: 89.0%
| epoch  90 |   100/  216 batches | lr 0.00000 | ms/batch 75.36 | loss  3.39 | ppl    29.60 
| epoch  90 |   200/  216 batches | lr 0.00000 | ms/batch 74.77 | loss  3.35 | ppl    28.61 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 16.68s | valid loss  4.22 | valid ppl    67.90 | valid bpc    6.085
-----------------------------------------------------------------------------------------
PROGRESS: 90.0%
| epoch  91 |   100/  216 batches | lr 0.00000 | ms/batch 75.53 | loss  3.40 | ppl    29.99 
| epoch  91 |   200/  216 batches | lr 0.00000 | ms/batch 74.67 | loss  3.35 | ppl    28.56 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 16.68s | valid loss  4.24 | valid ppl    69.63 | valid bpc    6.122
-----------------------------------------------------------------------------------------
PROGRESS: 91.0%
| epoch  92 |   100/  216 batches | lr 0.00000 | ms/batch 75.96 | loss  3.40 | ppl    29.95 
| epoch  92 |   200/  216 batches | lr 0.00000 | ms/batch 74.23 | loss  3.36 | ppl    28.74 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 16.68s | valid loss  4.23 | valid ppl    68.60 | valid bpc    6.100
-----------------------------------------------------------------------------------------
PROGRESS: 92.0%
| epoch  93 |   100/  216 batches | lr 0.00000 | ms/batch 75.23 | loss  3.37 | ppl    29.13 
| epoch  93 |   200/  216 batches | lr 0.00000 | ms/batch 74.81 | loss  3.35 | ppl    28.55 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 16.68s | valid loss  4.22 | valid ppl    67.76 | valid bpc    6.082
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  216 batches | lr 0.00000 | ms/batch 75.51 | loss  3.39 | ppl    29.55 
| epoch  94 |   200/  216 batches | lr 0.00000 | ms/batch 74.66 | loss  3.37 | ppl    29.00 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 16.68s | valid loss  4.23 | valid ppl    68.49 | valid bpc    6.098
-----------------------------------------------------------------------------------------
PROGRESS: 94.0%
| epoch  95 |   100/  216 batches | lr 0.00000 | ms/batch 75.63 | loss  3.36 | ppl    28.88 
| epoch  95 |   200/  216 batches | lr 0.00000 | ms/batch 74.46 | loss  3.39 | ppl    29.63 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 16.68s | valid loss  4.22 | valid ppl    68.17 | valid bpc    6.091
-----------------------------------------------------------------------------------------
PROGRESS: 95.0%
| epoch  96 |   100/  216 batches | lr 0.00000 | ms/batch 75.94 | loss  3.40 | ppl    29.93 
| epoch  96 |   200/  216 batches | lr 0.00000 | ms/batch 74.23 | loss  3.36 | ppl    28.70 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 16.68s | valid loss  4.18 | valid ppl    65.29 | valid bpc    6.029
-----------------------------------------------------------------------------------------
PROGRESS: 96.0%
| epoch  97 |   100/  216 batches | lr 0.00000 | ms/batch 76.07 | loss  3.37 | ppl    29.15 
| epoch  97 |   200/  216 batches | lr 0.00000 | ms/batch 74.19 | loss  3.36 | ppl    28.81 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 16.68s | valid loss  4.20 | valid ppl    66.61 | valid bpc    6.058
-----------------------------------------------------------------------------------------
PROGRESS: 97.0%
| epoch  98 |   100/  216 batches | lr 0.00000 | ms/batch 75.78 | loss  3.40 | ppl    29.91 
| epoch  98 |   200/  216 batches | lr 0.00000 | ms/batch 74.42 | loss  3.33 | ppl    27.99 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 16.69s | valid loss  4.24 | valid ppl    69.07 | valid bpc    6.110
-----------------------------------------------------------------------------------------
PROGRESS: 98.0%
| epoch  99 |   100/  216 batches | lr 0.00000 | ms/batch 76.14 | loss  3.36 | ppl    28.92 
| epoch  99 |   200/  216 batches | lr 0.00000 | ms/batch 74.16 | loss  3.36 | ppl    28.70 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 16.69s | valid loss  4.20 | valid ppl    66.43 | valid bpc    6.054
-----------------------------------------------------------------------------------------
PROGRESS: 99.0%
| epoch 100 |   100/  216 batches | lr 0.00000 | ms/batch 75.85 | loss  3.38 | ppl    29.41 
| epoch 100 |   200/  216 batches | lr 0.00000 | ms/batch 74.34 | loss  3.34 | ppl    28.11 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 16.68s | valid loss  4.19 | valid ppl    66.14 | valid bpc    6.047
-----------------------------------------------------------------------------------------
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  4.19 | test ppl    66.27 | test bpc    6.050
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.4334, Mean Reca: 0.5971, Mean F1: 0.4940
Counter({'NP': 9009, 'PP': 4293, 'S': 3265, 'VP': 2972, 'SBAR': 633, 'ADJP': 261, 'QP': 241, 'ADVP': 171, 'SINV': 149, 'PRN': 55, 'FRAG': 34, 'WHNP': 31, 'NX': 19, 'SQ': 15, 'UCP': 10, 'WHPP': 9, 'NAC': 8, 'SBARQ': 8, 'CONJP': 5, 'X': 3, 'WHADVP': 2})
Counter({'NP': 14432, 'VP': 8130, 'S': 5620, 'PP': 5484, 'SBAR': 1796, 'ADJP': 649, 'QP': 490, 'ADVP': 286, 'SINV': 157, 'PRN': 128, 'NX': 95, 'FRAG': 42, 'WHNP': 37, 'UCP': 32, 'NAC': 30, 'WHPP': 25, 'CONJP': 21, 'SQ': 18, 'SBARQ': 10, 'WHADVP': 9, 'X': 6, 'WHADJP': 4, 'INTJ': 1})
SBAR: 0.3524
NP: 0.6242
VP: 0.3656
PP: 0.7828
ADJP: 0.4022
ADVP: 0.5979
4.853120503072451
-----------------------------------------------------------------------------------------
Dependency parsing performance:
Conll-U Style:
DDA: 0.426
UDA: 0.572
=========================================================================================
Loading dataset...
Loading dictionary...
Number of tokens:  10001
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer_in_parser', nhid=512, nlayers=8, front_layers=6, rear_layers=2, n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=4444, nonmono=5, cuda=True, log_interval=100, save='trained_models/structformer_in_parser_4444_62.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 38475573
Model architecture: StructFormer_In_Parser(
  (transformer_front): Transformer_Front(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(10001, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-5): 6 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
  (transformer_rear): Transformer_Rear(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(10001, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-1): 2 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (output_layer): Linear(in_features=512, out_features=10001, bias=True)
  )
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  216 batches | lr 0.00030 | ms/batch 79.35 | loss  7.31 | ppl  1492.69 
| epoch   1 |   200/  216 batches | lr 0.00030 | ms/batch 73.71 | loss  6.86 | ppl   953.95 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 16.96s | valid loss  6.71 | valid ppl   820.63 | valid bpc    9.681
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  216 batches | lr 0.00030 | ms/batch 75.01 | loss  6.84 | ppl   929.95 
| epoch   2 |   200/  216 batches | lr 0.00030 | ms/batch 73.87 | loss  6.59 | ppl   727.79 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 16.58s | valid loss  6.34 | valid ppl   569.40 | valid bpc    9.153
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  216 batches | lr 0.00030 | ms/batch 75.34 | loss  6.36 | ppl   577.25 
| epoch   3 |   200/  216 batches | lr 0.00030 | ms/batch 74.26 | loss  6.07 | ppl   434.81 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 16.62s | valid loss  5.87 | valid ppl   354.87 | valid bpc    8.471
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  216 batches | lr 0.00030 | ms/batch 75.34 | loss  5.91 | ppl   368.05 
| epoch   4 |   200/  216 batches | lr 0.00030 | ms/batch 74.13 | loss  5.74 | ppl   311.03 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 16.65s | valid loss  5.63 | valid ppl   277.61 | valid bpc    8.117
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  216 batches | lr 0.00030 | ms/batch 75.31 | loss  5.61 | ppl   272.39 
| epoch   5 |   200/  216 batches | lr 0.00030 | ms/batch 74.66 | loss  5.46 | ppl   234.90 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 16.67s | valid loss  5.37 | valid ppl   213.84 | valid bpc    7.740
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  216 batches | lr 0.00030 | ms/batch 75.82 | loss  5.42 | ppl   225.09 
| epoch   6 |   200/  216 batches | lr 0.00030 | ms/batch 74.24 | loss  5.27 | ppl   194.04 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 16.68s | valid loss  5.20 | valid ppl   181.94 | valid bpc    7.507
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  216 batches | lr 0.00030 | ms/batch 75.52 | loss  5.22 | ppl   184.70 
| epoch   7 |   200/  216 batches | lr 0.00030 | ms/batch 74.68 | loss  5.15 | ppl   172.58 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 16.68s | valid loss  5.16 | valid ppl   173.52 | valid bpc    7.439
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  216 batches | lr 0.00030 | ms/batch 75.86 | loss  5.12 | ppl   166.69 
| epoch   8 |   200/  216 batches | lr 0.00030 | ms/batch 74.20 | loss  5.03 | ppl   153.01 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 16.69s | valid loss  5.07 | valid ppl   158.55 | valid bpc    7.309
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 8.0%
| epoch   9 |   100/  216 batches | lr 0.00030 | ms/batch 75.59 | loss  4.98 | ppl   145.60 
| epoch   9 |   200/  216 batches | lr 0.00030 | ms/batch 74.69 | loss  4.94 | ppl   140.36 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 16.69s | valid loss  4.92 | valid ppl   136.70 | valid bpc    7.095
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  216 batches | lr 0.00030 | ms/batch 75.62 | loss  4.90 | ppl   134.72 
| epoch  10 |   200/  216 batches | lr 0.00030 | ms/batch 74.62 | loss  4.81 | ppl   122.46 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 16.70s | valid loss  4.88 | valid ppl   131.60 | valid bpc    7.040
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  216 batches | lr 0.00030 | ms/batch 75.66 | loss  4.78 | ppl   119.61 
| epoch  11 |   200/  216 batches | lr 0.00030 | ms/batch 74.27 | loss  4.76 | ppl   116.93 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 16.70s | valid loss  4.84 | valid ppl   126.77 | valid bpc    6.986
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  216 batches | lr 0.00030 | ms/batch 75.38 | loss  4.72 | ppl   111.83 
| epoch  12 |   200/  216 batches | lr 0.00030 | ms/batch 74.74 | loss  4.65 | ppl   104.71 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 16.69s | valid loss  4.77 | valid ppl   117.91 | valid bpc    6.882
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 12.0%
| epoch  13 |   100/  216 batches | lr 0.00030 | ms/batch 75.62 | loss  4.64 | ppl   103.30 
| epoch  13 |   200/  216 batches | lr 0.00030 | ms/batch 74.78 | loss  4.58 | ppl    97.67 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 16.70s | valid loss  4.72 | valid ppl   112.66 | valid bpc    6.816
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 13.0%
| epoch  14 |   100/  216 batches | lr 0.00030 | ms/batch 75.58 | loss  4.56 | ppl    95.89 
| epoch  14 |   200/  216 batches | lr 0.00030 | ms/batch 74.65 | loss  4.50 | ppl    90.02 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 16.69s | valid loss  4.68 | valid ppl   107.38 | valid bpc    6.747
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  216 batches | lr 0.00030 | ms/batch 75.42 | loss  4.47 | ppl    87.13 
| epoch  15 |   200/  216 batches | lr 0.00030 | ms/batch 74.77 | loss  4.45 | ppl    85.96 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 16.70s | valid loss  4.61 | valid ppl   100.65 | valid bpc    6.653
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 15.0%
| epoch  16 |   100/  216 batches | lr 0.00030 | ms/batch 75.57 | loss  4.44 | ppl    84.46 
| epoch  16 |   200/  216 batches | lr 0.00030 | ms/batch 74.32 | loss  4.36 | ppl    78.43 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 16.70s | valid loss  4.59 | valid ppl    98.17 | valid bpc    6.617
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 16.0%
| epoch  17 |   100/  216 batches | lr 0.00030 | ms/batch 75.81 | loss  4.36 | ppl    77.96 
| epoch  17 |   200/  216 batches | lr 0.00030 | ms/batch 74.42 | loss  4.32 | ppl    74.94 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 16.69s | valid loss  4.53 | valid ppl    92.43 | valid bpc    6.530
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 17.0%
| epoch  18 |   100/  216 batches | lr 0.00030 | ms/batch 75.68 | loss  4.32 | ppl    75.02 
| epoch  18 |   200/  216 batches | lr 0.00030 | ms/batch 74.56 | loss  4.25 | ppl    70.18 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 16.69s | valid loss  4.53 | valid ppl    92.31 | valid bpc    6.528
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 18.0%
| epoch  19 |   100/  216 batches | lr 0.00030 | ms/batch 76.00 | loss  4.23 | ppl    68.51 
| epoch  19 |   200/  216 batches | lr 0.00030 | ms/batch 74.17 | loss  4.18 | ppl    65.58 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 16.69s | valid loss  4.48 | valid ppl    87.82 | valid bpc    6.457
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 19.0%
| epoch  20 |   100/  216 batches | lr 0.00030 | ms/batch 75.42 | loss  4.19 | ppl    65.85 
| epoch  20 |   200/  216 batches | lr 0.00030 | ms/batch 74.75 | loss  4.15 | ppl    63.24 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 16.69s | valid loss  4.46 | valid ppl    86.25 | valid bpc    6.431
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 20.0%
| epoch  21 |   100/  216 batches | lr 0.00030 | ms/batch 75.91 | loss  4.14 | ppl    62.69 
| epoch  21 |   200/  216 batches | lr 0.00030 | ms/batch 74.30 | loss  4.08 | ppl    59.40 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 16.69s | valid loss  4.45 | valid ppl    85.96 | valid bpc    6.426
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 21.0%
| epoch  22 |   100/  216 batches | lr 0.00030 | ms/batch 75.95 | loss  4.08 | ppl    59.03 
| epoch  22 |   200/  216 batches | lr 0.00030 | ms/batch 74.22 | loss  4.07 | ppl    58.53 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 16.69s | valid loss  4.44 | valid ppl    85.14 | valid bpc    6.412
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 22.0%
| epoch  23 |   100/  216 batches | lr 0.00030 | ms/batch 75.77 | loss  4.04 | ppl    57.04 
| epoch  23 |   200/  216 batches | lr 0.00030 | ms/batch 74.50 | loss  3.99 | ppl    54.22 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 16.69s | valid loss  4.41 | valid ppl    82.35 | valid bpc    6.364
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 23.0%
| epoch  24 |   100/  216 batches | lr 0.00030 | ms/batch 75.86 | loss  3.99 | ppl    54.21 
| epoch  24 |   200/  216 batches | lr 0.00030 | ms/batch 74.31 | loss  3.96 | ppl    52.33 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 16.69s | valid loss  4.42 | valid ppl    83.09 | valid bpc    6.377
-----------------------------------------------------------------------------------------
PROGRESS: 24.0%
| epoch  25 |   100/  216 batches | lr 0.00030 | ms/batch 75.47 | loss  3.95 | ppl    51.71 
| epoch  25 |   200/  216 batches | lr 0.00030 | ms/batch 74.78 | loss  3.91 | ppl    49.87 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 16.69s | valid loss  4.37 | valid ppl    79.44 | valid bpc    6.312
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 25.0%
| epoch  26 |   100/  216 batches | lr 0.00030 | ms/batch 75.38 | loss  3.89 | ppl    49.03 
| epoch  26 |   200/  216 batches | lr 0.00030 | ms/batch 74.87 | loss  3.88 | ppl    48.64 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 16.69s | valid loss  4.37 | valid ppl    79.02 | valid bpc    6.304
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 26.0%
| epoch  27 |   100/  216 batches | lr 0.00030 | ms/batch 75.82 | loss  3.85 | ppl    46.95 
| epoch  27 |   200/  216 batches | lr 0.00030 | ms/batch 74.37 | loss  3.83 | ppl    46.07 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 16.69s | valid loss  4.35 | valid ppl    77.68 | valid bpc    6.280
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 27.0%
| epoch  28 |   100/  216 batches | lr 0.00030 | ms/batch 75.36 | loss  3.81 | ppl    45.00 
| epoch  28 |   200/  216 batches | lr 0.00030 | ms/batch 74.78 | loss  3.78 | ppl    43.94 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 16.69s | valid loss  4.34 | valid ppl    76.95 | valid bpc    6.266
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  216 batches | lr 0.00030 | ms/batch 75.60 | loss  3.78 | ppl    43.82 
| epoch  29 |   200/  216 batches | lr 0.00030 | ms/batch 74.62 | loss  3.73 | ppl    41.54 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 16.69s | valid loss  4.32 | valid ppl    74.83 | valid bpc    6.226
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  216 batches | lr 0.00030 | ms/batch 75.58 | loss  3.71 | ppl    40.91 
| epoch  30 |   200/  216 batches | lr 0.00030 | ms/batch 74.78 | loss  3.73 | ppl    41.47 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 16.70s | valid loss  4.30 | valid ppl    73.62 | valid bpc    6.202
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 30.0%
| epoch  31 |   100/  216 batches | lr 0.00030 | ms/batch 75.36 | loss  3.69 | ppl    40.00 
| epoch  31 |   200/  216 batches | lr 0.00030 | ms/batch 74.92 | loss  3.67 | ppl    39.40 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 16.69s | valid loss  4.32 | valid ppl    75.19 | valid bpc    6.232
-----------------------------------------------------------------------------------------
PROGRESS: 31.0%
| epoch  32 |   100/  216 batches | lr 0.00030 | ms/batch 75.93 | loss  3.65 | ppl    38.43 
| epoch  32 |   200/  216 batches | lr 0.00030 | ms/batch 74.35 | loss  3.63 | ppl    37.69 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 16.69s | valid loss  4.31 | valid ppl    74.18 | valid bpc    6.213
-----------------------------------------------------------------------------------------
PROGRESS: 32.0%
| epoch  33 |   100/  216 batches | lr 0.00030 | ms/batch 75.60 | loss  3.61 | ppl    36.81 
| epoch  33 |   200/  216 batches | lr 0.00030 | ms/batch 74.67 | loss  3.61 | ppl    37.01 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 16.70s | valid loss  4.32 | valid ppl    75.27 | valid bpc    6.234
-----------------------------------------------------------------------------------------
PROGRESS: 33.0%
| epoch  34 |   100/  216 batches | lr 0.00015 | ms/batch 75.62 | loss  3.53 | ppl    33.98 
| epoch  34 |   200/  216 batches | lr 0.00015 | ms/batch 74.65 | loss  3.48 | ppl    32.40 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 16.70s | valid loss  4.25 | valid ppl    69.99 | valid bpc    6.129
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 34.0%
| epoch  35 |   100/  216 batches | lr 0.00015 | ms/batch 75.97 | loss  3.48 | ppl    32.53 
| epoch  35 |   200/  216 batches | lr 0.00015 | ms/batch 74.25 | loss  3.45 | ppl    31.59 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 16.70s | valid loss  4.26 | valid ppl    70.51 | valid bpc    6.140
-----------------------------------------------------------------------------------------
PROGRESS: 35.0%
| epoch  36 |   100/  216 batches | lr 0.00015 | ms/batch 75.64 | loss  3.45 | ppl    31.62 
| epoch  36 |   200/  216 batches | lr 0.00015 | ms/batch 74.35 | loss  3.41 | ppl    30.18 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 16.70s | valid loss  4.22 | valid ppl    67.99 | valid bpc    6.087
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 36.0%
| epoch  37 |   100/  216 batches | lr 0.00015 | ms/batch 75.61 | loss  3.43 | ppl    30.98 
| epoch  37 |   200/  216 batches | lr 0.00015 | ms/batch 74.65 | loss  3.41 | ppl    30.17 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 16.71s | valid loss  4.26 | valid ppl    70.84 | valid bpc    6.147
-----------------------------------------------------------------------------------------
PROGRESS: 37.0%
| epoch  38 |   100/  216 batches | lr 0.00015 | ms/batch 76.05 | loss  3.38 | ppl    29.49 
| epoch  38 |   200/  216 batches | lr 0.00015 | ms/batch 74.32 | loss  3.36 | ppl    28.75 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 16.71s | valid loss  4.23 | valid ppl    68.38 | valid bpc    6.096
-----------------------------------------------------------------------------------------
PROGRESS: 38.0%
| epoch  39 |   100/  216 batches | lr 0.00015 | ms/batch 75.75 | loss  3.35 | ppl    28.61 
| epoch  39 |   200/  216 batches | lr 0.00015 | ms/batch 74.50 | loss  3.34 | ppl    28.08 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 16.70s | valid loss  4.25 | valid ppl    70.07 | valid bpc    6.131
-----------------------------------------------------------------------------------------
PROGRESS: 39.0%
| epoch  40 |   100/  216 batches | lr 0.00007 | ms/batch 75.45 | loss  3.30 | ppl    26.99 
| epoch  40 |   200/  216 batches | lr 0.00007 | ms/batch 74.85 | loss  3.29 | ppl    26.92 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 16.71s | valid loss  4.23 | valid ppl    68.95 | valid bpc    6.108
-----------------------------------------------------------------------------------------
PROGRESS: 40.0%
| epoch  41 |   100/  216 batches | lr 0.00007 | ms/batch 75.50 | loss  3.29 | ppl    26.89 
| epoch  41 |   200/  216 batches | lr 0.00007 | ms/batch 74.86 | loss  3.26 | ppl    26.07 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 16.71s | valid loss  4.20 | valid ppl    66.56 | valid bpc    6.057
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 41.0%
| epoch  42 |   100/  216 batches | lr 0.00007 | ms/batch 75.84 | loss  3.31 | ppl    27.30 
| epoch  42 |   200/  216 batches | lr 0.00007 | ms/batch 74.48 | loss  3.22 | ppl    25.03 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 16.71s | valid loss  4.23 | valid ppl    68.66 | valid bpc    6.101
-----------------------------------------------------------------------------------------
PROGRESS: 42.0%
| epoch  43 |   100/  216 batches | lr 0.00007 | ms/batch 75.81 | loss  3.25 | ppl    25.83 
| epoch  43 |   200/  216 batches | lr 0.00007 | ms/batch 74.57 | loss  3.24 | ppl    25.60 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 16.70s | valid loss  4.22 | valid ppl    68.04 | valid bpc    6.088
-----------------------------------------------------------------------------------------
PROGRESS: 43.0%
| epoch  44 |   100/  216 batches | lr 0.00007 | ms/batch 75.47 | loss  3.24 | ppl    25.51 
| epoch  44 |   200/  216 batches | lr 0.00007 | ms/batch 74.78 | loss  3.23 | ppl    25.16 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 16.70s | valid loss  4.26 | valid ppl    70.49 | valid bpc    6.139
-----------------------------------------------------------------------------------------
PROGRESS: 44.0%
| epoch  45 |   100/  216 batches | lr 0.00004 | ms/batch 75.90 | loss  3.22 | ppl    24.96 
| epoch  45 |   200/  216 batches | lr 0.00004 | ms/batch 74.42 | loss  3.18 | ppl    24.08 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 16.70s | valid loss  4.19 | valid ppl    65.95 | valid bpc    6.043
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 45.0%
| epoch  46 |   100/  216 batches | lr 0.00004 | ms/batch 75.60 | loss  3.18 | ppl    24.10 
| epoch  46 |   200/  216 batches | lr 0.00004 | ms/batch 74.53 | loss  3.19 | ppl    24.30 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 16.70s | valid loss  4.18 | valid ppl    65.28 | valid bpc    6.029
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 46.0%
| epoch  47 |   100/  216 batches | lr 0.00004 | ms/batch 75.38 | loss  3.22 | ppl    25.11 
| epoch  47 |   200/  216 batches | lr 0.00004 | ms/batch 74.83 | loss  3.17 | ppl    23.73 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 16.69s | valid loss  4.21 | valid ppl    67.66 | valid bpc    6.080
-----------------------------------------------------------------------------------------
PROGRESS: 47.0%
| epoch  48 |   100/  216 batches | lr 0.00004 | ms/batch 75.75 | loss  3.17 | ppl    23.74 
| epoch  48 |   200/  216 batches | lr 0.00004 | ms/batch 74.44 | loss  3.16 | ppl    23.67 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 16.69s | valid loss  4.21 | valid ppl    67.25 | valid bpc    6.071
-----------------------------------------------------------------------------------------
PROGRESS: 48.0%
| epoch  49 |   100/  216 batches | lr 0.00004 | ms/batch 75.73 | loss  3.16 | ppl    23.61 
| epoch  49 |   200/  216 batches | lr 0.00004 | ms/batch 74.46 | loss  3.15 | ppl    23.26 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 16.70s | valid loss  4.18 | valid ppl    65.38 | valid bpc    6.031
-----------------------------------------------------------------------------------------
PROGRESS: 49.0%
| epoch  50 |   100/  216 batches | lr 0.00002 | ms/batch 75.42 | loss  3.18 | ppl    23.95 
| epoch  50 |   200/  216 batches | lr 0.00002 | ms/batch 74.84 | loss  3.13 | ppl    22.85 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 16.70s | valid loss  4.16 | valid ppl    64.32 | valid bpc    6.007
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 50.0%
| epoch  51 |   100/  216 batches | lr 0.00002 | ms/batch 75.53 | loss  3.15 | ppl    23.35 
| epoch  51 |   200/  216 batches | lr 0.00002 | ms/batch 74.68 | loss  3.10 | ppl    22.24 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 16.69s | valid loss  4.23 | valid ppl    68.43 | valid bpc    6.097
-----------------------------------------------------------------------------------------
PROGRESS: 51.0%
| epoch  52 |   100/  216 batches | lr 0.00002 | ms/batch 75.98 | loss  3.15 | ppl    23.31 
| epoch  52 |   200/  216 batches | lr 0.00002 | ms/batch 74.24 | loss  3.13 | ppl    22.80 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 16.70s | valid loss  4.23 | valid ppl    68.85 | valid bpc    6.105
-----------------------------------------------------------------------------------------
PROGRESS: 52.0%
| epoch  53 |   100/  216 batches | lr 0.00002 | ms/batch 75.68 | loss  3.15 | ppl    23.36 
| epoch  53 |   200/  216 batches | lr 0.00002 | ms/batch 74.55 | loss  3.12 | ppl    22.63 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 16.70s | valid loss  4.17 | valid ppl    65.03 | valid bpc    6.023
-----------------------------------------------------------------------------------------
PROGRESS: 53.0%
| epoch  54 |   100/  216 batches | lr 0.00001 | ms/batch 75.48 | loss  3.15 | ppl    23.32 
| epoch  54 |   200/  216 batches | lr 0.00001 | ms/batch 74.77 | loss  3.10 | ppl    22.21 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 16.70s | valid loss  4.21 | valid ppl    67.44 | valid bpc    6.076
-----------------------------------------------------------------------------------------
PROGRESS: 54.0%
| epoch  55 |   100/  216 batches | lr 0.00001 | ms/batch 75.61 | loss  3.16 | ppl    23.56 
| epoch  55 |   200/  216 batches | lr 0.00001 | ms/batch 74.71 | loss  3.08 | ppl    21.84 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 16.69s | valid loss  4.26 | valid ppl    70.63 | valid bpc    6.142
-----------------------------------------------------------------------------------------
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  216 batches | lr 0.00001 | ms/batch 75.54 | loss  3.13 | ppl    22.83 
| epoch  56 |   200/  216 batches | lr 0.00001 | ms/batch 74.62 | loss  3.11 | ppl    22.32 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 16.69s | valid loss  4.19 | valid ppl    65.84 | valid bpc    6.041
-----------------------------------------------------------------------------------------
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  216 batches | lr 0.00000 | ms/batch 75.66 | loss  3.14 | ppl    23.17 
| epoch  57 |   200/  216 batches | lr 0.00000 | ms/batch 74.53 | loss  3.08 | ppl    21.65 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 16.69s | valid loss  4.16 | valid ppl    64.23 | valid bpc    6.005
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  216 batches | lr 0.00000 | ms/batch 75.58 | loss  3.14 | ppl    23.01 
| epoch  58 |   200/  216 batches | lr 0.00000 | ms/batch 74.68 | loss  3.10 | ppl    22.21 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 16.69s | valid loss  4.20 | valid ppl    66.57 | valid bpc    6.057
-----------------------------------------------------------------------------------------
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  216 batches | lr 0.00000 | ms/batch 75.82 | loss  3.14 | ppl    22.99 
| epoch  59 |   200/  216 batches | lr 0.00000 | ms/batch 74.37 | loss  3.08 | ppl    21.82 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 16.70s | valid loss  4.19 | valid ppl    65.98 | valid bpc    6.044
-----------------------------------------------------------------------------------------
PROGRESS: 59.0%
| epoch  60 |   100/  216 batches | lr 0.00000 | ms/batch 75.80 | loss  3.13 | ppl    22.86 
| epoch  60 |   200/  216 batches | lr 0.00000 | ms/batch 74.39 | loss  3.10 | ppl    22.21 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 16.70s | valid loss  4.21 | valid ppl    67.46 | valid bpc    6.076
-----------------------------------------------------------------------------------------
PROGRESS: 60.0%
| epoch  61 |   100/  216 batches | lr 0.00000 | ms/batch 75.63 | loss  3.12 | ppl    22.58 
| epoch  61 |   200/  216 batches | lr 0.00000 | ms/batch 74.30 | loss  3.09 | ppl    22.05 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 16.70s | valid loss  4.20 | valid ppl    66.71 | valid bpc    6.060
-----------------------------------------------------------------------------------------
PROGRESS: 61.0%
| epoch  62 |   100/  216 batches | lr 0.00000 | ms/batch 75.53 | loss  3.12 | ppl    22.68 
| epoch  62 |   200/  216 batches | lr 0.00000 | ms/batch 74.70 | loss  3.09 | ppl    21.94 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 16.69s | valid loss  4.24 | valid ppl    69.17 | valid bpc    6.112
-----------------------------------------------------------------------------------------
PROGRESS: 62.0%
| epoch  63 |   100/  216 batches | lr 0.00000 | ms/batch 75.53 | loss  3.12 | ppl    22.55 
| epoch  63 |   200/  216 batches | lr 0.00000 | ms/batch 74.82 | loss  3.10 | ppl    22.13 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 16.70s | valid loss  4.21 | valid ppl    67.05 | valid bpc    6.067
-----------------------------------------------------------------------------------------
PROGRESS: 63.0%
| epoch  64 |   100/  216 batches | lr 0.00000 | ms/batch 75.49 | loss  3.13 | ppl    22.76 
| epoch  64 |   200/  216 batches | lr 0.00000 | ms/batch 74.72 | loss  3.08 | ppl    21.74 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 16.70s | valid loss  4.19 | valid ppl    66.25 | valid bpc    6.050
-----------------------------------------------------------------------------------------
PROGRESS: 64.0%
| epoch  65 |   100/  216 batches | lr 0.00000 | ms/batch 75.48 | loss  3.10 | ppl    22.22 
| epoch  65 |   200/  216 batches | lr 0.00000 | ms/batch 74.76 | loss  3.12 | ppl    22.63 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 16.69s | valid loss  4.22 | valid ppl    68.28 | valid bpc    6.093
-----------------------------------------------------------------------------------------
PROGRESS: 65.0%
| epoch  66 |   100/  216 batches | lr 0.00000 | ms/batch 75.41 | loss  3.11 | ppl    22.53 
| epoch  66 |   200/  216 batches | lr 0.00000 | ms/batch 74.81 | loss  3.09 | ppl    22.00 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 16.70s | valid loss  4.22 | valid ppl    67.81 | valid bpc    6.083
-----------------------------------------------------------------------------------------
PROGRESS: 66.0%
| epoch  67 |   100/  216 batches | lr 0.00000 | ms/batch 76.03 | loss  3.12 | ppl    22.70 
| epoch  67 |   200/  216 batches | lr 0.00000 | ms/batch 74.17 | loss  3.09 | ppl    22.00 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 16.70s | valid loss  4.19 | valid ppl    65.80 | valid bpc    6.040
-----------------------------------------------------------------------------------------
PROGRESS: 67.0%
| epoch  68 |   100/  216 batches | lr 0.00000 | ms/batch 75.59 | loss  3.12 | ppl    22.68 
| epoch  68 |   200/  216 batches | lr 0.00000 | ms/batch 74.69 | loss  3.10 | ppl    22.09 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 16.70s | valid loss  4.22 | valid ppl    67.80 | valid bpc    6.083
-----------------------------------------------------------------------------------------
PROGRESS: 68.0%
| epoch  69 |   100/  216 batches | lr 0.00000 | ms/batch 75.60 | loss  3.13 | ppl    22.96 
| epoch  69 |   200/  216 batches | lr 0.00000 | ms/batch 74.73 | loss  3.09 | ppl    22.07 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 16.70s | valid loss  4.19 | valid ppl    66.26 | valid bpc    6.050
-----------------------------------------------------------------------------------------
PROGRESS: 69.0%
| epoch  70 |   100/  216 batches | lr 0.00000 | ms/batch 75.59 | loss  3.14 | ppl    23.16 
| epoch  70 |   200/  216 batches | lr 0.00000 | ms/batch 74.37 | loss  3.08 | ppl    21.71 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 16.70s | valid loss  4.24 | valid ppl    69.10 | valid bpc    6.111
-----------------------------------------------------------------------------------------
PROGRESS: 70.0%
| epoch  71 |   100/  216 batches | lr 0.00000 | ms/batch 75.55 | loss  3.09 | ppl    22.06 
| epoch  71 |   200/  216 batches | lr 0.00000 | ms/batch 74.81 | loss  3.10 | ppl    22.11 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 16.70s | valid loss  4.19 | valid ppl    66.31 | valid bpc    6.051
-----------------------------------------------------------------------------------------
PROGRESS: 71.0%
| epoch  72 |   100/  216 batches | lr 0.00000 | ms/batch 75.67 | loss  3.11 | ppl    22.33 
| epoch  72 |   200/  216 batches | lr 0.00000 | ms/batch 74.62 | loss  3.11 | ppl    22.43 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 16.70s | valid loss  4.20 | valid ppl    67.02 | valid bpc    6.066
-----------------------------------------------------------------------------------------
PROGRESS: 72.0%
| epoch  73 |   100/  216 batches | lr 0.00000 | ms/batch 75.79 | loss  3.11 | ppl    22.48 
| epoch  73 |   200/  216 batches | lr 0.00000 | ms/batch 74.39 | loss  3.09 | ppl    22.02 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 16.70s | valid loss  4.20 | valid ppl    66.94 | valid bpc    6.065
-----------------------------------------------------------------------------------------
PROGRESS: 73.0%
| epoch  74 |   100/  216 batches | lr 0.00000 | ms/batch 75.69 | loss  3.13 | ppl    22.80 
| epoch  74 |   200/  216 batches | lr 0.00000 | ms/batch 74.34 | loss  3.09 | ppl    21.95 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 16.70s | valid loss  4.18 | valid ppl    65.63 | valid bpc    6.036
-----------------------------------------------------------------------------------------
PROGRESS: 74.0%
| epoch  75 |   100/  216 batches | lr 0.00000 | ms/batch 75.44 | loss  3.10 | ppl    22.15 
| epoch  75 |   200/  216 batches | lr 0.00000 | ms/batch 74.85 | loss  3.09 | ppl    21.95 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 16.69s | valid loss  4.19 | valid ppl    66.15 | valid bpc    6.048
-----------------------------------------------------------------------------------------
PROGRESS: 75.0%
| epoch  76 |   100/  216 batches | lr 0.00000 | ms/batch 75.45 | loss  3.12 | ppl    22.67 
| epoch  76 |   200/  216 batches | lr 0.00000 | ms/batch 74.75 | loss  3.07 | ppl    21.58 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 16.69s | valid loss  4.20 | valid ppl    66.46 | valid bpc    6.054
-----------------------------------------------------------------------------------------
PROGRESS: 76.0%
| epoch  77 |   100/  216 batches | lr 0.00000 | ms/batch 75.88 | loss  3.12 | ppl    22.64 
| epoch  77 |   200/  216 batches | lr 0.00000 | ms/batch 74.32 | loss  3.08 | ppl    21.84 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 16.69s | valid loss  4.17 | valid ppl    64.98 | valid bpc    6.022
-----------------------------------------------------------------------------------------
PROGRESS: 77.0%
| epoch  78 |   100/  216 batches | lr 0.00000 | ms/batch 75.52 | loss  3.11 | ppl    22.38 
| epoch  78 |   200/  216 batches | lr 0.00000 | ms/batch 74.71 | loss  3.10 | ppl    22.23 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 16.69s | valid loss  4.21 | valid ppl    67.09 | valid bpc    6.068
-----------------------------------------------------------------------------------------
PROGRESS: 78.0%
| epoch  79 |   100/  216 batches | lr 0.00000 | ms/batch 75.40 | loss  3.14 | ppl    23.08 
| epoch  79 |   200/  216 batches | lr 0.00000 | ms/batch 74.88 | loss  3.08 | ppl    21.86 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 16.69s | valid loss  4.15 | valid ppl    63.68 | valid bpc    5.993
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 79.0%
| epoch  80 |   100/  216 batches | lr 0.00000 | ms/batch 75.82 | loss  3.10 | ppl    22.21 
| epoch  80 |   200/  216 batches | lr 0.00000 | ms/batch 74.25 | loss  3.10 | ppl    22.26 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 16.68s | valid loss  4.22 | valid ppl    68.19 | valid bpc    6.091
-----------------------------------------------------------------------------------------
PROGRESS: 80.0%
| epoch  81 |   100/  216 batches | lr 0.00000 | ms/batch 76.00 | loss  3.14 | ppl    23.03 
| epoch  81 |   200/  216 batches | lr 0.00000 | ms/batch 74.20 | loss  3.06 | ppl    21.43 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 16.69s | valid loss  4.22 | valid ppl    68.15 | valid bpc    6.091
-----------------------------------------------------------------------------------------
PROGRESS: 81.0%
| epoch  82 |   100/  216 batches | lr 0.00000 | ms/batch 75.59 | loss  3.13 | ppl    22.77 
| epoch  82 |   200/  216 batches | lr 0.00000 | ms/batch 74.62 | loss  3.08 | ppl    21.78 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 16.68s | valid loss  4.22 | valid ppl    67.95 | valid bpc    6.086
-----------------------------------------------------------------------------------------
PROGRESS: 82.0%
| epoch  83 |   100/  216 batches | lr 0.00000 | ms/batch 75.82 | loss  3.12 | ppl    22.73 
| epoch  83 |   200/  216 batches | lr 0.00000 | ms/batch 74.22 | loss  3.09 | ppl    21.90 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 16.69s | valid loss  4.23 | valid ppl    68.57 | valid bpc    6.100
-----------------------------------------------------------------------------------------
PROGRESS: 83.0%
| epoch  84 |   100/  216 batches | lr 0.00000 | ms/batch 75.47 | loss  3.10 | ppl    22.16 
| epoch  84 |   200/  216 batches | lr 0.00000 | ms/batch 74.68 | loss  3.10 | ppl    22.13 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 16.69s | valid loss  4.18 | valid ppl    65.61 | valid bpc    6.036
-----------------------------------------------------------------------------------------
PROGRESS: 84.0%
| epoch  85 |   100/  216 batches | lr 0.00000 | ms/batch 75.49 | loss  3.10 | ppl    22.17 
| epoch  85 |   200/  216 batches | lr 0.00000 | ms/batch 74.76 | loss  3.10 | ppl    22.19 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 16.69s | valid loss  4.19 | valid ppl    65.80 | valid bpc    6.040
-----------------------------------------------------------------------------------------
PROGRESS: 85.0%
| epoch  86 |   100/  216 batches | lr 0.00000 | ms/batch 75.85 | loss  3.12 | ppl    22.68 
| epoch  86 |   200/  216 batches | lr 0.00000 | ms/batch 74.40 | loss  3.08 | ppl    21.73 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 16.70s | valid loss  4.21 | valid ppl    67.05 | valid bpc    6.067
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  216 batches | lr 0.00000 | ms/batch 75.63 | loss  3.12 | ppl    22.67 
| epoch  87 |   200/  216 batches | lr 0.00000 | ms/batch 74.59 | loss  3.09 | ppl    22.05 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 16.70s | valid loss  4.20 | valid ppl    66.51 | valid bpc    6.055
-----------------------------------------------------------------------------------------
PROGRESS: 87.0%
| epoch  88 |   100/  216 batches | lr 0.00000 | ms/batch 75.91 | loss  3.12 | ppl    22.71 
| epoch  88 |   200/  216 batches | lr 0.00000 | ms/batch 74.33 | loss  3.09 | ppl    21.93 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 16.70s | valid loss  4.17 | valid ppl    65.02 | valid bpc    6.023
-----------------------------------------------------------------------------------------
PROGRESS: 88.0%
| epoch  89 |   100/  216 batches | lr 0.00000 | ms/batch 75.46 | loss  3.13 | ppl    22.89 
| epoch  89 |   200/  216 batches | lr 0.00000 | ms/batch 74.77 | loss  3.08 | ppl    21.82 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 16.70s | valid loss  4.17 | valid ppl    64.59 | valid bpc    6.013
-----------------------------------------------------------------------------------------
PROGRESS: 89.0%
| epoch  90 |   100/  216 batches | lr 0.00000 | ms/batch 75.37 | loss  3.10 | ppl    22.25 
| epoch  90 |   200/  216 batches | lr 0.00000 | ms/batch 74.84 | loss  3.12 | ppl    22.55 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 16.69s | valid loss  4.20 | valid ppl    66.69 | valid bpc    6.059
-----------------------------------------------------------------------------------------
PROGRESS: 90.0%
| epoch  91 |   100/  216 batches | lr 0.00000 | ms/batch 75.58 | loss  3.12 | ppl    22.65 
| epoch  91 |   200/  216 batches | lr 0.00000 | ms/batch 74.67 | loss  3.11 | ppl    22.35 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 16.70s | valid loss  4.19 | valid ppl    65.70 | valid bpc    6.038
-----------------------------------------------------------------------------------------
PROGRESS: 91.0%
| epoch  92 |   100/  216 batches | lr 0.00000 | ms/batch 75.72 | loss  3.11 | ppl    22.36 
| epoch  92 |   200/  216 batches | lr 0.00000 | ms/batch 74.47 | loss  3.10 | ppl    22.16 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 16.70s | valid loss  4.18 | valid ppl    65.32 | valid bpc    6.029
-----------------------------------------------------------------------------------------
PROGRESS: 92.0%
| epoch  93 |   100/  216 batches | lr 0.00000 | ms/batch 75.66 | loss  3.11 | ppl    22.42 
| epoch  93 |   200/  216 batches | lr 0.00000 | ms/batch 74.22 | loss  3.08 | ppl    21.78 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 16.70s | valid loss  4.20 | valid ppl    66.63 | valid bpc    6.058
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  216 batches | lr 0.00000 | ms/batch 75.53 | loss  3.12 | ppl    22.71 
| epoch  94 |   200/  216 batches | lr 0.00000 | ms/batch 74.71 | loss  3.10 | ppl    22.19 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 16.69s | valid loss  4.19 | valid ppl    65.89 | valid bpc    6.042
-----------------------------------------------------------------------------------------
PROGRESS: 94.0%
| epoch  95 |   100/  216 batches | lr 0.00000 | ms/batch 75.55 | loss  3.11 | ppl    22.41 
| epoch  95 |   200/  216 batches | lr 0.00000 | ms/batch 74.68 | loss  3.09 | ppl    22.05 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 16.69s | valid loss  4.18 | valid ppl    65.63 | valid bpc    6.036
-----------------------------------------------------------------------------------------
PROGRESS: 95.0%
| epoch  96 |   100/  216 batches | lr 0.00000 | ms/batch 75.56 | loss  3.09 | ppl    21.88 
| epoch  96 |   200/  216 batches | lr 0.00000 | ms/batch 74.32 | loss  3.10 | ppl    22.25 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 16.70s | valid loss  4.22 | valid ppl    67.72 | valid bpc    6.081
-----------------------------------------------------------------------------------------
PROGRESS: 96.0%
| epoch  97 |   100/  216 batches | lr 0.00000 | ms/batch 75.82 | loss  3.11 | ppl    22.43 
| epoch  97 |   200/  216 batches | lr 0.00000 | ms/batch 74.42 | loss  3.09 | ppl    21.88 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 16.70s | valid loss  4.16 | valid ppl    63.95 | valid bpc    5.999
-----------------------------------------------------------------------------------------
PROGRESS: 97.0%
| epoch  98 |   100/  216 batches | lr 0.00000 | ms/batch 75.87 | loss  3.11 | ppl    22.36 
| epoch  98 |   200/  216 batches | lr 0.00000 | ms/batch 74.45 | loss  3.08 | ppl    21.72 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 16.70s | valid loss  4.20 | valid ppl    66.87 | valid bpc    6.063
-----------------------------------------------------------------------------------------
PROGRESS: 98.0%
| epoch  99 |   100/  216 batches | lr 0.00000 | ms/batch 75.88 | loss  3.11 | ppl    22.42 
| epoch  99 |   200/  216 batches | lr 0.00000 | ms/batch 74.36 | loss  3.07 | ppl    21.55 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 16.69s | valid loss  4.15 | valid ppl    63.71 | valid bpc    5.994
-----------------------------------------------------------------------------------------
PROGRESS: 99.0%
| epoch 100 |   100/  216 batches | lr 0.00000 | ms/batch 75.90 | loss  3.11 | ppl    22.47 
| epoch 100 |   200/  216 batches | lr 0.00000 | ms/batch 74.42 | loss  3.09 | ppl    21.92 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 16.70s | valid loss  4.15 | valid ppl    63.51 | valid bpc    5.989
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  4.11 | test ppl    61.22 | test bpc    5.936
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.4898, Mean Reca: 0.6719, Mean F1: 0.5580
Counter({'NP': 10066, 'VP': 4281, 'PP': 4220, 'S': 3612, 'SBAR': 884, 'QP': 276, 'ADJP': 256, 'ADVP': 160, 'SINV': 150, 'PRN': 67, 'NX': 50, 'FRAG': 32, 'WHNP': 29, 'SQ': 16, 'NAC': 13, 'WHPP': 9, 'UCP': 8, 'SBARQ': 8, 'CONJP': 7, 'X': 2})
Counter({'NP': 14432, 'VP': 8130, 'S': 5620, 'PP': 5484, 'SBAR': 1796, 'ADJP': 649, 'QP': 490, 'ADVP': 286, 'SINV': 157, 'PRN': 128, 'NX': 95, 'FRAG': 42, 'WHNP': 37, 'UCP': 32, 'NAC': 30, 'WHPP': 25, 'CONJP': 21, 'SQ': 18, 'SBARQ': 10, 'WHADVP': 9, 'X': 6, 'WHADJP': 4, 'INTJ': 1})
SBAR: 0.4922
NP: 0.6975
VP: 0.5266
PP: 0.7695
ADJP: 0.3945
ADVP: 0.5594
5.123384445074406
-----------------------------------------------------------------------------------------
Dependency parsing performance:
Conll-U Style:
DDA: 0.065
UDA: 0.334
=========================================================================================
Loading dataset...
Loading dictionary...
Number of tokens:  10001
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer_in_parser', nhid=512, nlayers=8, front_layers=6, rear_layers=2, n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=5555, nonmono=5, cuda=True, log_interval=100, save='trained_models/structformer_in_parser_5555_62.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 38475573
Model architecture: StructFormer_In_Parser(
  (transformer_front): Transformer_Front(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(10001, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-5): 6 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
  (transformer_rear): Transformer_Rear(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(10001, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-1): 2 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (output_layer): Linear(in_features=512, out_features=10001, bias=True)
  )
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  216 batches | lr 0.00030 | ms/batch 78.81 | loss  7.30 | ppl  1483.59 
| epoch   1 |   200/  216 batches | lr 0.00030 | ms/batch 73.45 | loss  6.87 | ppl   962.45 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 16.88s | valid loss  6.73 | valid ppl   836.27 | valid bpc    9.708
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  216 batches | lr 0.00030 | ms/batch 74.96 | loss  6.76 | ppl   862.50 
| epoch   2 |   200/  216 batches | lr 0.00030 | ms/batch 74.23 | loss  6.50 | ppl   663.25 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 16.58s | valid loss  6.22 | valid ppl   501.14 | valid bpc    8.969
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  216 batches | lr 0.00030 | ms/batch 75.27 | loss  6.22 | ppl   503.91 
| epoch   3 |   200/  216 batches | lr 0.00030 | ms/batch 74.24 | loss  6.02 | ppl   411.98 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 16.62s | valid loss  5.80 | valid ppl   330.85 | valid bpc    8.370
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  216 batches | lr 0.00030 | ms/batch 75.58 | loss  5.84 | ppl   344.56 
| epoch   4 |   200/  216 batches | lr 0.00030 | ms/batch 74.19 | loss  5.65 | ppl   283.02 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 16.64s | valid loss  5.54 | valid ppl   253.53 | valid bpc    7.986
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  216 batches | lr 0.00030 | ms/batch 75.57 | loss  5.57 | ppl   261.72 
| epoch   5 |   200/  216 batches | lr 0.00030 | ms/batch 74.39 | loss  5.43 | ppl   227.38 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 16.66s | valid loss  5.33 | valid ppl   207.37 | valid bpc    7.696
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  216 batches | lr 0.00030 | ms/batch 75.62 | loss  5.36 | ppl   212.47 
| epoch   6 |   200/  216 batches | lr 0.00030 | ms/batch 74.31 | loss  5.25 | ppl   190.25 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 16.67s | valid loss  5.21 | valid ppl   183.22 | valid bpc    7.517
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  216 batches | lr 0.00030 | ms/batch 75.45 | loss  5.19 | ppl   179.54 
| epoch   7 |   200/  216 batches | lr 0.00030 | ms/batch 74.57 | loss  5.14 | ppl   170.30 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 16.67s | valid loss  5.05 | valid ppl   156.27 | valid bpc    7.288
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  216 batches | lr 0.00030 | ms/batch 75.45 | loss  5.06 | ppl   158.21 
| epoch   8 |   200/  216 batches | lr 0.00030 | ms/batch 74.55 | loss  4.97 | ppl   144.68 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 16.68s | valid loss  5.06 | valid ppl   157.34 | valid bpc    7.298
-----------------------------------------------------------------------------------------
PROGRESS: 8.0%
| epoch   9 |   100/  216 batches | lr 0.00030 | ms/batch 75.49 | loss  4.94 | ppl   140.43 
| epoch   9 |   200/  216 batches | lr 0.00030 | ms/batch 74.85 | loss  4.90 | ppl   134.06 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 16.71s | valid loss  4.93 | valid ppl   137.94 | valid bpc    7.108
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  216 batches | lr 0.00030 | ms/batch 75.95 | loss  4.84 | ppl   125.87 
| epoch  10 |   200/  216 batches | lr 0.00030 | ms/batch 74.45 | loss  4.80 | ppl   121.47 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 16.71s | valid loss  4.89 | valid ppl   132.84 | valid bpc    7.053
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  216 batches | lr 0.00030 | ms/batch 75.58 | loss  4.75 | ppl   115.01 
| epoch  11 |   200/  216 batches | lr 0.00030 | ms/batch 74.92 | loss  4.70 | ppl   110.34 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 16.72s | valid loss  4.79 | valid ppl   120.27 | valid bpc    6.910
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  216 batches | lr 0.00030 | ms/batch 75.70 | loss  4.68 | ppl   107.48 
| epoch  12 |   200/  216 batches | lr 0.00030 | ms/batch 74.68 | loss  4.61 | ppl   100.68 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 16.72s | valid loss  4.74 | valid ppl   114.81 | valid bpc    6.843
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 12.0%
| epoch  13 |   100/  216 batches | lr 0.00030 | ms/batch 75.82 | loss  4.61 | ppl   100.72 
| epoch  13 |   200/  216 batches | lr 0.00030 | ms/batch 74.65 | loss  4.52 | ppl    91.58 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 16.72s | valid loss  4.64 | valid ppl   103.12 | valid bpc    6.688
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 13.0%
| epoch  14 |   100/  216 batches | lr 0.00030 | ms/batch 75.93 | loss  4.50 | ppl    90.22 
| epoch  14 |   200/  216 batches | lr 0.00030 | ms/batch 74.47 | loss  4.48 | ppl    88.02 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 16.71s | valid loss  4.64 | valid ppl   103.36 | valid bpc    6.692
-----------------------------------------------------------------------------------------
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  216 batches | lr 0.00030 | ms/batch 76.20 | loss  4.45 | ppl    85.31 
| epoch  15 |   200/  216 batches | lr 0.00030 | ms/batch 74.28 | loss  4.40 | ppl    81.57 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 16.72s | valid loss  4.57 | valid ppl    96.11 | valid bpc    6.587
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 15.0%
| epoch  16 |   100/  216 batches | lr 0.00030 | ms/batch 75.47 | loss  4.38 | ppl    79.54 
| epoch  16 |   200/  216 batches | lr 0.00030 | ms/batch 74.60 | loss  4.37 | ppl    78.77 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 16.71s | valid loss  4.54 | valid ppl    93.89 | valid bpc    6.553
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 16.0%
| epoch  17 |   100/  216 batches | lr 0.00030 | ms/batch 75.88 | loss  4.32 | ppl    75.24 
| epoch  17 |   200/  216 batches | lr 0.00030 | ms/batch 74.45 | loss  4.25 | ppl    70.31 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 16.71s | valid loss  4.56 | valid ppl    95.38 | valid bpc    6.576
-----------------------------------------------------------------------------------------
PROGRESS: 17.0%
| epoch  18 |   100/  216 batches | lr 0.00030 | ms/batch 76.00 | loss  4.28 | ppl    71.89 
| epoch  18 |   200/  216 batches | lr 0.00030 | ms/batch 74.43 | loss  4.19 | ppl    66.17 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 16.72s | valid loss  4.54 | valid ppl    93.82 | valid bpc    6.552
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 18.0%
| epoch  19 |   100/  216 batches | lr 0.00030 | ms/batch 75.64 | loss  4.18 | ppl    65.13 
| epoch  19 |   200/  216 batches | lr 0.00030 | ms/batch 74.79 | loss  4.16 | ppl    64.18 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 16.72s | valid loss  4.49 | valid ppl    89.22 | valid bpc    6.479
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 19.0%
| epoch  20 |   100/  216 batches | lr 0.00030 | ms/batch 75.63 | loss  4.12 | ppl    61.61 
| epoch  20 |   200/  216 batches | lr 0.00030 | ms/batch 74.86 | loss  4.12 | ppl    61.34 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 16.71s | valid loss  4.48 | valid ppl    87.85 | valid bpc    6.457
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 20.0%
| epoch  21 |   100/  216 batches | lr 0.00030 | ms/batch 76.13 | loss  4.09 | ppl    59.63 
| epoch  21 |   200/  216 batches | lr 0.00030 | ms/batch 74.27 | loss  4.06 | ppl    57.88 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 16.71s | valid loss  4.43 | valid ppl    83.56 | valid bpc    6.385
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 21.0%
| epoch  22 |   100/  216 batches | lr 0.00030 | ms/batch 75.76 | loss  4.04 | ppl    56.79 
| epoch  22 |   200/  216 batches | lr 0.00030 | ms/batch 74.38 | loss  4.00 | ppl    54.53 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 16.68s | valid loss  4.42 | valid ppl    83.26 | valid bpc    6.380
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 22.0%
| epoch  23 |   100/  216 batches | lr 0.00030 | ms/batch 75.86 | loss  3.98 | ppl    53.67 
| epoch  23 |   200/  216 batches | lr 0.00030 | ms/batch 74.35 | loss  3.96 | ppl    52.20 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 16.68s | valid loss  4.40 | valid ppl    81.15 | valid bpc    6.342
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 23.0%
| epoch  24 |   100/  216 batches | lr 0.00030 | ms/batch 75.21 | loss  3.94 | ppl    51.51 
| epoch  24 |   200/  216 batches | lr 0.00030 | ms/batch 74.89 | loss  3.90 | ppl    49.62 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 16.69s | valid loss  4.37 | valid ppl    78.66 | valid bpc    6.297
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 24.0%
| epoch  25 |   100/  216 batches | lr 0.00030 | ms/batch 75.84 | loss  3.90 | ppl    49.61 
| epoch  25 |   200/  216 batches | lr 0.00030 | ms/batch 74.26 | loss  3.85 | ppl    47.04 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 16.68s | valid loss  4.35 | valid ppl    77.17 | valid bpc    6.270
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 25.0%
| epoch  26 |   100/  216 batches | lr 0.00030 | ms/batch 75.40 | loss  3.84 | ppl    46.74 
| epoch  26 |   200/  216 batches | lr 0.00030 | ms/batch 74.80 | loss  3.84 | ppl    46.30 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 16.70s | valid loss  4.34 | valid ppl    76.96 | valid bpc    6.266
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 26.0%
| epoch  27 |   100/  216 batches | lr 0.00030 | ms/batch 75.84 | loss  3.81 | ppl    45.11 
| epoch  27 |   200/  216 batches | lr 0.00030 | ms/batch 74.47 | loss  3.76 | ppl    43.04 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 16.70s | valid loss  4.34 | valid ppl    76.90 | valid bpc    6.265
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 27.0%
| epoch  28 |   100/  216 batches | lr 0.00030 | ms/batch 75.67 | loss  3.76 | ppl    42.91 
| epoch  28 |   200/  216 batches | lr 0.00030 | ms/batch 74.48 | loss  3.77 | ppl    43.52 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 16.70s | valid loss  4.33 | valid ppl    76.32 | valid bpc    6.254
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  216 batches | lr 0.00030 | ms/batch 75.39 | loss  3.74 | ppl    41.93 
| epoch  29 |   200/  216 batches | lr 0.00030 | ms/batch 74.66 | loss  3.70 | ppl    40.47 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 16.68s | valid loss  4.30 | valid ppl    73.43 | valid bpc    6.198
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  216 batches | lr 0.00030 | ms/batch 75.64 | loss  3.69 | ppl    39.95 
| epoch  30 |   200/  216 batches | lr 0.00030 | ms/batch 74.83 | loss  3.66 | ppl    38.95 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 16.71s | valid loss  4.32 | valid ppl    75.35 | valid bpc    6.235
-----------------------------------------------------------------------------------------
PROGRESS: 30.0%
| epoch  31 |   100/  216 batches | lr 0.00030 | ms/batch 75.89 | loss  3.67 | ppl    39.19 
| epoch  31 |   200/  216 batches | lr 0.00030 | ms/batch 74.54 | loss  3.62 | ppl    37.45 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 16.71s | valid loss  4.29 | valid ppl    72.83 | valid bpc    6.186
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 31.0%
| epoch  32 |   100/  216 batches | lr 0.00030 | ms/batch 75.41 | loss  3.59 | ppl    36.10 
| epoch  32 |   200/  216 batches | lr 0.00030 | ms/batch 74.77 | loss  3.60 | ppl    36.63 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 16.69s | valid loss  4.29 | valid ppl    73.19 | valid bpc    6.194
-----------------------------------------------------------------------------------------
PROGRESS: 32.0%
| epoch  33 |   100/  216 batches | lr 0.00030 | ms/batch 75.70 | loss  3.55 | ppl    34.98 
| epoch  33 |   200/  216 batches | lr 0.00030 | ms/batch 74.61 | loss  3.57 | ppl    35.61 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 16.70s | valid loss  4.32 | valid ppl    75.29 | valid bpc    6.234
-----------------------------------------------------------------------------------------
PROGRESS: 33.0%
| epoch  34 |   100/  216 batches | lr 0.00030 | ms/batch 76.00 | loss  3.55 | ppl    34.80 
| epoch  34 |   200/  216 batches | lr 0.00030 | ms/batch 74.34 | loss  3.50 | ppl    33.21 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 16.70s | valid loss  4.28 | valid ppl    72.26 | valid bpc    6.175
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 34.0%
| epoch  35 |   100/  216 batches | lr 0.00030 | ms/batch 76.00 | loss  3.50 | ppl    33.25 
| epoch  35 |   200/  216 batches | lr 0.00030 | ms/batch 74.35 | loss  3.48 | ppl    32.40 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 16.70s | valid loss  4.27 | valid ppl    71.48 | valid bpc    6.159
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 35.0%
| epoch  36 |   100/  216 batches | lr 0.00030 | ms/batch 75.86 | loss  3.47 | ppl    32.22 
| epoch  36 |   200/  216 batches | lr 0.00030 | ms/batch 74.35 | loss  3.46 | ppl    31.67 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 16.71s | valid loss  4.32 | valid ppl    75.26 | valid bpc    6.234
-----------------------------------------------------------------------------------------
PROGRESS: 36.0%
| epoch  37 |   100/  216 batches | lr 0.00030 | ms/batch 75.70 | loss  3.41 | ppl    30.17 
| epoch  37 |   200/  216 batches | lr 0.00030 | ms/batch 74.72 | loss  3.44 | ppl    31.34 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 16.71s | valid loss  4.33 | valid ppl    75.75 | valid bpc    6.243
-----------------------------------------------------------------------------------------
PROGRESS: 37.0%
| epoch  38 |   100/  216 batches | lr 0.00030 | ms/batch 75.58 | loss  3.38 | ppl    29.49 
| epoch  38 |   200/  216 batches | lr 0.00030 | ms/batch 74.76 | loss  3.40 | ppl    29.89 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 16.71s | valid loss  4.28 | valid ppl    71.98 | valid bpc    6.170
-----------------------------------------------------------------------------------------
PROGRESS: 38.0%
| epoch  39 |   100/  216 batches | lr 0.00015 | ms/batch 75.56 | loss  3.31 | ppl    27.40 
| epoch  39 |   200/  216 batches | lr 0.00015 | ms/batch 74.88 | loss  3.30 | ppl    27.22 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 16.71s | valid loss  4.23 | valid ppl    69.03 | valid bpc    6.109
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 39.0%
| epoch  40 |   100/  216 batches | lr 0.00015 | ms/batch 75.65 | loss  3.28 | ppl    26.47 
| epoch  40 |   200/  216 batches | lr 0.00015 | ms/batch 74.66 | loss  3.21 | ppl    24.85 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 16.71s | valid loss  4.21 | valid ppl    67.34 | valid bpc    6.073
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 40.0%
| epoch  41 |   100/  216 batches | lr 0.00015 | ms/batch 75.73 | loss  3.21 | ppl    24.88 
| epoch  41 |   200/  216 batches | lr 0.00015 | ms/batch 74.60 | loss  3.20 | ppl    24.42 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 16.70s | valid loss  4.23 | valid ppl    68.65 | valid bpc    6.101
-----------------------------------------------------------------------------------------
PROGRESS: 41.0%
| epoch  42 |   100/  216 batches | lr 0.00015 | ms/batch 76.00 | loss  3.21 | ppl    24.70 
| epoch  42 |   200/  216 batches | lr 0.00015 | ms/batch 74.39 | loss  3.16 | ppl    23.62 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 16.71s | valid loss  4.24 | valid ppl    69.48 | valid bpc    6.119
-----------------------------------------------------------------------------------------
PROGRESS: 42.0%
| epoch  43 |   100/  216 batches | lr 0.00015 | ms/batch 75.91 | loss  3.19 | ppl    24.24 
| epoch  43 |   200/  216 batches | lr 0.00015 | ms/batch 74.35 | loss  3.15 | ppl    23.38 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 16.70s | valid loss  4.23 | valid ppl    69.00 | valid bpc    6.109
-----------------------------------------------------------------------------------------
PROGRESS: 43.0%
| epoch  44 |   100/  216 batches | lr 0.00007 | ms/batch 75.56 | loss  3.13 | ppl    22.86 
| epoch  44 |   200/  216 batches | lr 0.00007 | ms/batch 74.71 | loss  3.10 | ppl    22.12 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 16.70s | valid loss  4.20 | valid ppl    67.02 | valid bpc    6.066
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 44.0%
| epoch  45 |   100/  216 batches | lr 0.00007 | ms/batch 75.46 | loss  3.10 | ppl    22.09 
| epoch  45 |   200/  216 batches | lr 0.00007 | ms/batch 74.81 | loss  3.07 | ppl    21.60 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 16.70s | valid loss  4.24 | valid ppl    69.37 | valid bpc    6.116
-----------------------------------------------------------------------------------------
PROGRESS: 45.0%
| epoch  46 |   100/  216 batches | lr 0.00007 | ms/batch 75.61 | loss  3.08 | ppl    21.82 
| epoch  46 |   200/  216 batches | lr 0.00007 | ms/batch 74.80 | loss  3.06 | ppl    21.42 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 16.71s | valid loss  4.21 | valid ppl    67.40 | valid bpc    6.075
-----------------------------------------------------------------------------------------
PROGRESS: 46.0%
| epoch  47 |   100/  216 batches | lr 0.00007 | ms/batch 75.74 | loss  3.05 | ppl    21.09 
| epoch  47 |   200/  216 batches | lr 0.00007 | ms/batch 74.59 | loss  3.05 | ppl    21.13 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 16.71s | valid loss  4.20 | valid ppl    66.90 | valid bpc    6.064
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 47.0%
| epoch  48 |   100/  216 batches | lr 0.00007 | ms/batch 75.91 | loss  3.03 | ppl    20.77 
| epoch  48 |   200/  216 batches | lr 0.00007 | ms/batch 74.46 | loss  3.04 | ppl    20.98 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 16.71s | valid loss  4.25 | valid ppl    69.84 | valid bpc    6.126
-----------------------------------------------------------------------------------------
PROGRESS: 48.0%
| epoch  49 |   100/  216 batches | lr 0.00007 | ms/batch 75.78 | loss  3.03 | ppl    20.73 
| epoch  49 |   200/  216 batches | lr 0.00007 | ms/batch 74.62 | loss  3.02 | ppl    20.42 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 16.71s | valid loss  4.24 | valid ppl    69.19 | valid bpc    6.113
-----------------------------------------------------------------------------------------
PROGRESS: 49.0%
| epoch  50 |   100/  216 batches | lr 0.00007 | ms/batch 75.45 | loss  3.04 | ppl    20.82 
| epoch  50 |   200/  216 batches | lr 0.00007 | ms/batch 74.76 | loss  2.98 | ppl    19.72 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 16.70s | valid loss  4.22 | valid ppl    67.93 | valid bpc    6.086
-----------------------------------------------------------------------------------------
PROGRESS: 50.0%
| epoch  51 |   100/  216 batches | lr 0.00004 | ms/batch 75.49 | loss  3.00 | ppl    20.01 
| epoch  51 |   200/  216 batches | lr 0.00004 | ms/batch 74.87 | loss  2.96 | ppl    19.36 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 16.71s | valid loss  4.18 | valid ppl    65.45 | valid bpc    6.032
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 51.0%
| epoch  52 |   100/  216 batches | lr 0.00004 | ms/batch 75.67 | loss  2.99 | ppl    19.83 
| epoch  52 |   200/  216 batches | lr 0.00004 | ms/batch 74.82 | loss  2.93 | ppl    18.71 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 16.71s | valid loss  4.22 | valid ppl    67.93 | valid bpc    6.086
-----------------------------------------------------------------------------------------
PROGRESS: 52.0%
| epoch  53 |   100/  216 batches | lr 0.00004 | ms/batch 75.73 | loss  2.97 | ppl    19.45 
| epoch  53 |   200/  216 batches | lr 0.00004 | ms/batch 74.53 | loss  2.94 | ppl    18.89 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 16.71s | valid loss  4.23 | valid ppl    68.89 | valid bpc    6.106
-----------------------------------------------------------------------------------------
PROGRESS: 53.0%
| epoch  54 |   100/  216 batches | lr 0.00004 | ms/batch 75.98 | loss  2.94 | ppl    18.98 
| epoch  54 |   200/  216 batches | lr 0.00004 | ms/batch 74.39 | loss  2.94 | ppl    18.97 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 16.71s | valid loss  4.20 | valid ppl    66.94 | valid bpc    6.065
-----------------------------------------------------------------------------------------
PROGRESS: 54.0%
| epoch  55 |   100/  216 batches | lr 0.00002 | ms/batch 76.04 | loss  2.96 | ppl    19.25 
| epoch  55 |   200/  216 batches | lr 0.00002 | ms/batch 74.33 | loss  2.92 | ppl    18.60 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 16.71s | valid loss  4.22 | valid ppl    67.99 | valid bpc    6.087
-----------------------------------------------------------------------------------------
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  216 batches | lr 0.00002 | ms/batch 76.06 | loss  2.92 | ppl    18.60 
| epoch  56 |   200/  216 batches | lr 0.00002 | ms/batch 74.29 | loss  2.92 | ppl    18.47 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 16.71s | valid loss  4.20 | valid ppl    66.57 | valid bpc    6.057
-----------------------------------------------------------------------------------------
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  216 batches | lr 0.00002 | ms/batch 75.61 | loss  2.92 | ppl    18.59 
| epoch  57 |   200/  216 batches | lr 0.00002 | ms/batch 74.65 | loss  2.93 | ppl    18.66 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 16.71s | valid loss  4.23 | valid ppl    68.81 | valid bpc    6.105
-----------------------------------------------------------------------------------------
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  216 batches | lr 0.00001 | ms/batch 76.02 | loss  2.94 | ppl    19.00 
| epoch  58 |   200/  216 batches | lr 0.00001 | ms/batch 74.34 | loss  2.88 | ppl    17.85 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 16.71s | valid loss  4.18 | valid ppl    65.43 | valid bpc    6.032
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  216 batches | lr 0.00001 | ms/batch 75.53 | loss  2.93 | ppl    18.70 
| epoch  59 |   200/  216 batches | lr 0.00001 | ms/batch 74.41 | loss  2.88 | ppl    17.77 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 16.71s | valid loss  4.21 | valid ppl    67.20 | valid bpc    6.070
-----------------------------------------------------------------------------------------
PROGRESS: 59.0%
| epoch  60 |   100/  216 batches | lr 0.00001 | ms/batch 75.75 | loss  2.92 | ppl    18.53 
| epoch  60 |   200/  216 batches | lr 0.00001 | ms/batch 74.53 | loss  2.91 | ppl    18.29 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 16.71s | valid loss  4.20 | valid ppl    66.77 | valid bpc    6.061
-----------------------------------------------------------------------------------------
PROGRESS: 60.0%
| epoch  61 |   100/  216 batches | lr 0.00001 | ms/batch 76.01 | loss  2.91 | ppl    18.44 
| epoch  61 |   200/  216 batches | lr 0.00001 | ms/batch 74.32 | loss  2.90 | ppl    18.14 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 16.71s | valid loss  4.23 | valid ppl    68.49 | valid bpc    6.098
-----------------------------------------------------------------------------------------
PROGRESS: 61.0%
| epoch  62 |   100/  216 batches | lr 0.00000 | ms/batch 75.59 | loss  2.92 | ppl    18.51 
| epoch  62 |   200/  216 batches | lr 0.00000 | ms/batch 74.74 | loss  2.86 | ppl    17.44 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 16.71s | valid loss  4.21 | valid ppl    67.23 | valid bpc    6.071
-----------------------------------------------------------------------------------------
PROGRESS: 62.0%
| epoch  63 |   100/  216 batches | lr 0.00000 | ms/batch 75.65 | loss  2.92 | ppl    18.48 
| epoch  63 |   200/  216 batches | lr 0.00000 | ms/batch 74.63 | loss  2.88 | ppl    17.86 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 16.71s | valid loss  4.25 | valid ppl    70.41 | valid bpc    6.138
-----------------------------------------------------------------------------------------
PROGRESS: 63.0%
| epoch  64 |   100/  216 batches | lr 0.00000 | ms/batch 75.48 | loss  2.93 | ppl    18.64 
| epoch  64 |   200/  216 batches | lr 0.00000 | ms/batch 74.41 | loss  2.88 | ppl    17.77 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 16.70s | valid loss  4.24 | valid ppl    69.34 | valid bpc    6.116
-----------------------------------------------------------------------------------------
PROGRESS: 64.0%
| epoch  65 |   100/  216 batches | lr 0.00000 | ms/batch 75.91 | loss  2.91 | ppl    18.36 
| epoch  65 |   200/  216 batches | lr 0.00000 | ms/batch 74.35 | loss  2.90 | ppl    18.26 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 16.71s | valid loss  4.20 | valid ppl    66.42 | valid bpc    6.053
-----------------------------------------------------------------------------------------
PROGRESS: 65.0%
| epoch  66 |   100/  216 batches | lr 0.00000 | ms/batch 75.75 | loss  2.90 | ppl    18.21 
| epoch  66 |   200/  216 batches | lr 0.00000 | ms/batch 74.67 | loss  2.91 | ppl    18.31 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 16.72s | valid loss  4.22 | valid ppl    68.05 | valid bpc    6.088
-----------------------------------------------------------------------------------------
PROGRESS: 66.0%
| epoch  67 |   100/  216 batches | lr 0.00000 | ms/batch 75.95 | loss  2.94 | ppl    18.83 
| epoch  67 |   200/  216 batches | lr 0.00000 | ms/batch 74.38 | loss  2.87 | ppl    17.64 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 16.71s | valid loss  4.20 | valid ppl    66.97 | valid bpc    6.065
-----------------------------------------------------------------------------------------
PROGRESS: 67.0%
| epoch  68 |   100/  216 batches | lr 0.00000 | ms/batch 75.46 | loss  2.89 | ppl    18.04 
| epoch  68 |   200/  216 batches | lr 0.00000 | ms/batch 74.84 | loss  2.88 | ppl    17.80 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 16.71s | valid loss  4.19 | valid ppl    65.95 | valid bpc    6.043
-----------------------------------------------------------------------------------------
PROGRESS: 68.0%
| epoch  69 |   100/  216 batches | lr 0.00000 | ms/batch 75.44 | loss  2.91 | ppl    18.45 
| epoch  69 |   200/  216 batches | lr 0.00000 | ms/batch 74.88 | loss  2.90 | ppl    18.12 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 16.70s | valid loss  4.22 | valid ppl    67.76 | valid bpc    6.082
-----------------------------------------------------------------------------------------
PROGRESS: 69.0%
| epoch  70 |   100/  216 batches | lr 0.00000 | ms/batch 75.59 | loss  2.91 | ppl    18.35 
| epoch  70 |   200/  216 batches | lr 0.00000 | ms/batch 74.76 | loss  2.88 | ppl    17.88 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 16.72s | valid loss  4.21 | valid ppl    67.36 | valid bpc    6.074
-----------------------------------------------------------------------------------------
PROGRESS: 70.0%
| epoch  71 |   100/  216 batches | lr 0.00000 | ms/batch 75.63 | loss  2.89 | ppl    17.95 
| epoch  71 |   200/  216 batches | lr 0.00000 | ms/batch 74.63 | loss  2.88 | ppl    17.90 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 16.70s | valid loss  4.22 | valid ppl    67.85 | valid bpc    6.084
-----------------------------------------------------------------------------------------
PROGRESS: 71.0%
| epoch  72 |   100/  216 batches | lr 0.00000 | ms/batch 75.62 | loss  2.90 | ppl    18.16 
| epoch  72 |   200/  216 batches | lr 0.00000 | ms/batch 74.72 | loss  2.88 | ppl    17.87 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 16.71s | valid loss  4.20 | valid ppl    66.97 | valid bpc    6.065
-----------------------------------------------------------------------------------------
PROGRESS: 72.0%
| epoch  73 |   100/  216 batches | lr 0.00000 | ms/batch 75.52 | loss  2.94 | ppl    18.84 
| epoch  73 |   200/  216 batches | lr 0.00000 | ms/batch 74.81 | loss  2.85 | ppl    17.26 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 16.71s | valid loss  4.22 | valid ppl    68.20 | valid bpc    6.092
-----------------------------------------------------------------------------------------
PROGRESS: 73.0%
| epoch  74 |   100/  216 batches | lr 0.00000 | ms/batch 75.91 | loss  2.92 | ppl    18.55 
| epoch  74 |   200/  216 batches | lr 0.00000 | ms/batch 74.47 | loss  2.88 | ppl    17.75 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 16.70s | valid loss  4.20 | valid ppl    66.65 | valid bpc    6.058
-----------------------------------------------------------------------------------------
PROGRESS: 74.0%
| epoch  75 |   100/  216 batches | lr 0.00000 | ms/batch 75.75 | loss  2.90 | ppl    18.20 
| epoch  75 |   200/  216 batches | lr 0.00000 | ms/batch 74.67 | loss  2.88 | ppl    17.74 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 16.71s | valid loss  4.21 | valid ppl    67.59 | valid bpc    6.079
-----------------------------------------------------------------------------------------
PROGRESS: 75.0%
| epoch  76 |   100/  216 batches | lr 0.00000 | ms/batch 75.61 | loss  2.92 | ppl    18.60 
| epoch  76 |   200/  216 batches | lr 0.00000 | ms/batch 74.79 | loss  2.87 | ppl    17.66 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 16.71s | valid loss  4.21 | valid ppl    67.54 | valid bpc    6.078
-----------------------------------------------------------------------------------------
PROGRESS: 76.0%
| epoch  77 |   100/  216 batches | lr 0.00000 | ms/batch 75.69 | loss  2.91 | ppl    18.28 
| epoch  77 |   200/  216 batches | lr 0.00000 | ms/batch 74.81 | loss  2.89 | ppl    17.98 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 16.72s | valid loss  4.23 | valid ppl    69.00 | valid bpc    6.109
-----------------------------------------------------------------------------------------
PROGRESS: 77.0%
| epoch  78 |   100/  216 batches | lr 0.00000 | ms/batch 75.58 | loss  2.91 | ppl    18.29 
| epoch  78 |   200/  216 batches | lr 0.00000 | ms/batch 74.80 | loss  2.89 | ppl    17.95 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 16.72s | valid loss  4.22 | valid ppl    67.87 | valid bpc    6.085
-----------------------------------------------------------------------------------------
PROGRESS: 78.0%
| epoch  79 |   100/  216 batches | lr 0.00000 | ms/batch 75.72 | loss  2.88 | ppl    17.86 
| epoch  79 |   200/  216 batches | lr 0.00000 | ms/batch 74.70 | loss  2.90 | ppl    18.17 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 16.71s | valid loss  4.20 | valid ppl    66.78 | valid bpc    6.061
-----------------------------------------------------------------------------------------
PROGRESS: 79.0%
| epoch  80 |   100/  216 batches | lr 0.00000 | ms/batch 76.18 | loss  2.90 | ppl    18.23 
| epoch  80 |   200/  216 batches | lr 0.00000 | ms/batch 74.29 | loss  2.87 | ppl    17.72 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 16.72s | valid loss  4.19 | valid ppl    65.85 | valid bpc    6.041
-----------------------------------------------------------------------------------------
PROGRESS: 80.0%
| epoch  81 |   100/  216 batches | lr 0.00000 | ms/batch 75.95 | loss  2.92 | ppl    18.60 
| epoch  81 |   200/  216 batches | lr 0.00000 | ms/batch 74.48 | loss  2.87 | ppl    17.55 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 16.72s | valid loss  4.25 | valid ppl    69.76 | valid bpc    6.124
-----------------------------------------------------------------------------------------
PROGRESS: 81.0%
| epoch  82 |   100/  216 batches | lr 0.00000 | ms/batch 75.66 | loss  2.89 | ppl    18.05 
| epoch  82 |   200/  216 batches | lr 0.00000 | ms/batch 74.74 | loss  2.88 | ppl    17.85 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 16.71s | valid loss  4.18 | valid ppl    65.44 | valid bpc    6.032
-----------------------------------------------------------------------------------------
PROGRESS: 82.0%
| epoch  83 |   100/  216 batches | lr 0.00000 | ms/batch 75.52 | loss  2.92 | ppl    18.55 
| epoch  83 |   200/  216 batches | lr 0.00000 | ms/batch 74.92 | loss  2.87 | ppl    17.72 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 16.71s | valid loss  4.20 | valid ppl    66.39 | valid bpc    6.053
-----------------------------------------------------------------------------------------
PROGRESS: 83.0%
| epoch  84 |   100/  216 batches | lr 0.00000 | ms/batch 75.87 | loss  2.90 | ppl    18.10 
| epoch  84 |   200/  216 batches | lr 0.00000 | ms/batch 74.46 | loss  2.89 | ppl    17.93 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 16.71s | valid loss  4.21 | valid ppl    67.08 | valid bpc    6.068
-----------------------------------------------------------------------------------------
PROGRESS: 84.0%
| epoch  85 |   100/  216 batches | lr 0.00000 | ms/batch 75.76 | loss  2.91 | ppl    18.37 
| epoch  85 |   200/  216 batches | lr 0.00000 | ms/batch 74.63 | loss  2.85 | ppl    17.37 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 16.71s | valid loss  4.25 | valid ppl    70.23 | valid bpc    6.134
-----------------------------------------------------------------------------------------
PROGRESS: 85.0%
| epoch  86 |   100/  216 batches | lr 0.00000 | ms/batch 75.65 | loss  2.88 | ppl    17.80 
| epoch  86 |   200/  216 batches | lr 0.00000 | ms/batch 74.78 | loss  2.89 | ppl    18.07 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 16.71s | valid loss  4.22 | valid ppl    68.30 | valid bpc    6.094
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  216 batches | lr 0.00000 | ms/batch 75.75 | loss  2.91 | ppl    18.44 
| epoch  87 |   200/  216 batches | lr 0.00000 | ms/batch 74.62 | loss  2.87 | ppl    17.64 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 16.71s | valid loss  4.21 | valid ppl    67.52 | valid bpc    6.077
-----------------------------------------------------------------------------------------
PROGRESS: 87.0%
| epoch  88 |   100/  216 batches | lr 0.00000 | ms/batch 75.92 | loss  2.92 | ppl    18.51 
| epoch  88 |   200/  216 batches | lr 0.00000 | ms/batch 74.39 | loss  2.87 | ppl    17.68 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 16.71s | valid loss  4.22 | valid ppl    68.36 | valid bpc    6.095
-----------------------------------------------------------------------------------------
PROGRESS: 88.0%
| epoch  89 |   100/  216 batches | lr 0.00000 | ms/batch 75.75 | loss  2.91 | ppl    18.37 
| epoch  89 |   200/  216 batches | lr 0.00000 | ms/batch 74.67 | loss  2.88 | ppl    17.80 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 16.72s | valid loss  4.19 | valid ppl    65.84 | valid bpc    6.041
-----------------------------------------------------------------------------------------
PROGRESS: 89.0%
| epoch  90 |   100/  216 batches | lr 0.00000 | ms/batch 75.95 | loss  2.91 | ppl    18.30 
| epoch  90 |   200/  216 batches | lr 0.00000 | ms/batch 74.37 | loss  2.88 | ppl    17.84 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 16.71s | valid loss  4.23 | valid ppl    68.73 | valid bpc    6.103
-----------------------------------------------------------------------------------------
PROGRESS: 90.0%
| epoch  91 |   100/  216 batches | lr 0.00000 | ms/batch 75.46 | loss  2.89 | ppl    17.93 
| epoch  91 |   200/  216 batches | lr 0.00000 | ms/batch 74.96 | loss  2.90 | ppl    18.14 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 16.71s | valid loss  4.21 | valid ppl    67.05 | valid bpc    6.067
-----------------------------------------------------------------------------------------
PROGRESS: 91.0%
| epoch  92 |   100/  216 batches | lr 0.00000 | ms/batch 75.87 | loss  2.89 | ppl    18.05 
| epoch  92 |   200/  216 batches | lr 0.00000 | ms/batch 74.35 | loss  2.88 | ppl    17.89 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 16.71s | valid loss  4.20 | valid ppl    66.78 | valid bpc    6.061
-----------------------------------------------------------------------------------------
PROGRESS: 92.0%
| epoch  93 |   100/  216 batches | lr 0.00000 | ms/batch 75.69 | loss  2.90 | ppl    18.13 
| epoch  93 |   200/  216 batches | lr 0.00000 | ms/batch 74.75 | loss  2.89 | ppl    17.96 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 16.71s | valid loss  4.23 | valid ppl    69.04 | valid bpc    6.109
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  216 batches | lr 0.00000 | ms/batch 75.71 | loss  2.89 | ppl    17.93 
| epoch  94 |   200/  216 batches | lr 0.00000 | ms/batch 74.71 | loss  2.88 | ppl    17.82 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 16.71s | valid loss  4.19 | valid ppl    66.23 | valid bpc    6.049
-----------------------------------------------------------------------------------------
PROGRESS: 94.0%
| epoch  95 |   100/  216 batches | lr 0.00000 | ms/batch 76.06 | loss  2.91 | ppl    18.34 
| epoch  95 |   200/  216 batches | lr 0.00000 | ms/batch 74.32 | loss  2.85 | ppl    17.30 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 16.71s | valid loss  4.18 | valid ppl    65.63 | valid bpc    6.036
-----------------------------------------------------------------------------------------
PROGRESS: 95.0%
| epoch  96 |   100/  216 batches | lr 0.00000 | ms/batch 75.66 | loss  2.91 | ppl    18.39 
| epoch  96 |   200/  216 batches | lr 0.00000 | ms/batch 74.72 | loss  2.88 | ppl    17.87 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 16.71s | valid loss  4.19 | valid ppl    66.03 | valid bpc    6.045
-----------------------------------------------------------------------------------------
PROGRESS: 96.0%
| epoch  97 |   100/  216 batches | lr 0.00000 | ms/batch 75.87 | loss  2.92 | ppl    18.58 
| epoch  97 |   200/  216 batches | lr 0.00000 | ms/batch 74.48 | loss  2.88 | ppl    17.87 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 16.71s | valid loss  4.21 | valid ppl    67.12 | valid bpc    6.069
-----------------------------------------------------------------------------------------
PROGRESS: 97.0%
| epoch  98 |   100/  216 batches | lr 0.00000 | ms/batch 75.73 | loss  2.90 | ppl    18.21 
| epoch  98 |   200/  216 batches | lr 0.00000 | ms/batch 74.62 | loss  2.88 | ppl    17.75 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 16.72s | valid loss  4.20 | valid ppl    66.98 | valid bpc    6.066
-----------------------------------------------------------------------------------------
PROGRESS: 98.0%
| epoch  99 |   100/  216 batches | lr 0.00000 | ms/batch 76.03 | loss  2.92 | ppl    18.58 
| epoch  99 |   200/  216 batches | lr 0.00000 | ms/batch 74.50 | loss  2.86 | ppl    17.54 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 16.72s | valid loss  4.23 | valid ppl    68.47 | valid bpc    6.097
-----------------------------------------------------------------------------------------
PROGRESS: 99.0%
| epoch 100 |   100/  216 batches | lr 0.00000 | ms/batch 76.01 | loss  2.91 | ppl    18.28 
| epoch 100 |   200/  216 batches | lr 0.00000 | ms/batch 74.44 | loss  2.87 | ppl    17.59 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 16.71s | valid loss  4.25 | valid ppl    70.26 | valid bpc    6.135
-----------------------------------------------------------------------------------------
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  4.15 | test ppl    63.42 | test bpc    5.987
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.4247, Mean Reca: 0.5862, Mean F1: 0.4843
Counter({'NP': 8698, 'PP': 4238, 'S': 3274, 'VP': 3060, 'SBAR': 547, 'ADJP': 272, 'QP': 249, 'ADVP': 166, 'SINV': 150, 'PRN': 55, 'FRAG': 36, 'WHNP': 29, 'NX': 19, 'NAC': 13, 'UCP': 13, 'SQ': 13, 'WHPP': 10, 'SBARQ': 9, 'CONJP': 7, 'WHADVP': 4, 'X': 4})
Counter({'NP': 14432, 'VP': 8130, 'S': 5620, 'PP': 5484, 'SBAR': 1796, 'ADJP': 649, 'QP': 490, 'ADVP': 286, 'SINV': 157, 'PRN': 128, 'NX': 95, 'FRAG': 42, 'WHNP': 37, 'UCP': 32, 'NAC': 30, 'WHPP': 25, 'CONJP': 21, 'SQ': 18, 'SBARQ': 10, 'WHADVP': 9, 'X': 6, 'WHADJP': 4, 'INTJ': 1})
SBAR: 0.3046
NP: 0.6027
VP: 0.3764
PP: 0.7728
ADJP: 0.4191
ADVP: 0.5804
4.85457934252132
-----------------------------------------------------------------------------------------
Dependency parsing performance:
Conll-U Style:
DDA: 0.426
UDA: 0.575
=========================================================================================
Loading dataset...
Loading dictionary...
Number of tokens:  10001
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer_in_parser', nhid=512, nlayers=8, front_layers=7, rear_layers=1, n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=1111, nonmono=5, cuda=True, log_interval=100, save='trained_models/structformer_in_parser_1111_71.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 38475557
Model architecture: StructFormer_In_Parser(
  (transformer_front): Transformer_Front(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(10001, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-6): 7 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
  (transformer_rear): Transformer_Rear(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(10001, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0): TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (output_layer): Linear(in_features=512, out_features=10001, bias=True)
  )
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  216 batches | lr 0.00030 | ms/batch 78.24 | loss  7.29 | ppl  1472.44 
| epoch   1 |   200/  216 batches | lr 0.00030 | ms/batch 73.58 | loss  6.88 | ppl   970.62 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 16.86s | valid loss  6.72 | valid ppl   831.32 | valid bpc    9.699
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  216 batches | lr 0.00030 | ms/batch 75.25 | loss  6.84 | ppl   937.23 
| epoch   2 |   200/  216 batches | lr 0.00030 | ms/batch 73.79 | loss  6.54 | ppl   693.63 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 16.55s | valid loss  6.27 | valid ppl   529.61 | valid bpc    9.049
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  216 batches | lr 0.00030 | ms/batch 75.00 | loss  6.31 | ppl   552.45 
| epoch   3 |   200/  216 batches | lr 0.00030 | ms/batch 74.51 | loss  6.05 | ppl   423.98 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 16.61s | valid loss  5.82 | valid ppl   338.01 | valid bpc    8.401
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  216 batches | lr 0.00030 | ms/batch 75.27 | loss  5.89 | ppl   359.97 
| epoch   4 |   200/  216 batches | lr 0.00030 | ms/batch 74.59 | loss  5.71 | ppl   303.35 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 16.64s | valid loss  5.58 | valid ppl   264.83 | valid bpc    8.049
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  216 batches | lr 0.00030 | ms/batch 75.40 | loss  5.60 | ppl   270.92 
| epoch   5 |   200/  216 batches | lr 0.00030 | ms/batch 74.62 | loss  5.44 | ppl   230.25 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 16.65s | valid loss  5.36 | valid ppl   212.65 | valid bpc    7.732
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  216 batches | lr 0.00030 | ms/batch 75.95 | loss  5.40 | ppl   220.56 
| epoch   6 |   200/  216 batches | lr 0.00030 | ms/batch 74.12 | loss  5.27 | ppl   195.34 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 16.67s | valid loss  5.25 | valid ppl   189.73 | valid bpc    7.568
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  216 batches | lr 0.00030 | ms/batch 75.41 | loss  5.20 | ppl   181.46 
| epoch   7 |   200/  216 batches | lr 0.00030 | ms/batch 74.70 | loss  5.15 | ppl   171.93 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 16.67s | valid loss  5.11 | valid ppl   165.59 | valid bpc    7.371
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  216 batches | lr 0.00030 | ms/batch 75.35 | loss  5.08 | ppl   160.65 
| epoch   8 |   200/  216 batches | lr 0.00030 | ms/batch 74.70 | loss  5.01 | ppl   150.46 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 16.67s | valid loss  5.04 | valid ppl   154.01 | valid bpc    7.267
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 8.0%
| epoch   9 |   100/  216 batches | lr 0.00030 | ms/batch 75.70 | loss  4.99 | ppl   146.53 
| epoch   9 |   200/  216 batches | lr 0.00030 | ms/batch 74.44 | loss  4.90 | ppl   133.72 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 16.68s | valid loss  4.97 | valid ppl   144.36 | valid bpc    7.173
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  216 batches | lr 0.00030 | ms/batch 75.76 | loss  4.85 | ppl   128.04 
| epoch  10 |   200/  216 batches | lr 0.00030 | ms/batch 74.37 | loss  4.82 | ppl   124.20 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 16.67s | valid loss  4.89 | valid ppl   132.64 | valid bpc    7.051
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  216 batches | lr 0.00030 | ms/batch 75.67 | loss  4.78 | ppl   118.58 
| epoch  11 |   200/  216 batches | lr 0.00030 | ms/batch 74.48 | loss  4.73 | ppl   113.15 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 16.68s | valid loss  4.82 | valid ppl   123.54 | valid bpc    6.949
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  216 batches | lr 0.00030 | ms/batch 75.65 | loss  4.70 | ppl   110.11 
| epoch  12 |   200/  216 batches | lr 0.00030 | ms/batch 74.64 | loss  4.62 | ppl   101.58 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 16.68s | valid loss  4.74 | valid ppl   114.37 | valid bpc    6.838
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 12.0%
| epoch  13 |   100/  216 batches | lr 0.00030 | ms/batch 76.05 | loss  4.61 | ppl   100.78 
| epoch  13 |   200/  216 batches | lr 0.00030 | ms/batch 74.12 | loss  4.53 | ppl    93.05 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 16.68s | valid loss  4.69 | valid ppl   109.27 | valid bpc    6.772
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 13.0%
| epoch  14 |   100/  216 batches | lr 0.00030 | ms/batch 75.56 | loss  4.50 | ppl    90.46 
| epoch  14 |   200/  216 batches | lr 0.00030 | ms/batch 74.20 | loss  4.48 | ppl    88.22 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 16.68s | valid loss  4.65 | valid ppl   104.89 | valid bpc    6.713
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  216 batches | lr 0.00030 | ms/batch 75.57 | loss  4.44 | ppl    84.75 
| epoch  15 |   200/  216 batches | lr 0.00030 | ms/batch 74.57 | loss  4.43 | ppl    84.05 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 16.68s | valid loss  4.63 | valid ppl   102.52 | valid bpc    6.680
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 15.0%
| epoch  16 |   100/  216 batches | lr 0.00030 | ms/batch 75.87 | loss  4.38 | ppl    79.81 
| epoch  16 |   200/  216 batches | lr 0.00030 | ms/batch 74.39 | loss  4.35 | ppl    77.81 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 16.68s | valid loss  4.58 | valid ppl    97.71 | valid bpc    6.610
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 16.0%
| epoch  17 |   100/  216 batches | lr 0.00030 | ms/batch 75.51 | loss  4.30 | ppl    73.82 
| epoch  17 |   200/  216 batches | lr 0.00030 | ms/batch 74.34 | loss  4.30 | ppl    73.79 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 16.68s | valid loss  4.56 | valid ppl    95.19 | valid bpc    6.573
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 17.0%
| epoch  18 |   100/  216 batches | lr 0.00030 | ms/batch 75.67 | loss  4.26 | ppl    70.79 
| epoch  18 |   200/  216 batches | lr 0.00030 | ms/batch 74.55 | loss  4.24 | ppl    69.55 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 16.68s | valid loss  4.55 | valid ppl    94.21 | valid bpc    6.558
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 18.0%
| epoch  19 |   100/  216 batches | lr 0.00030 | ms/batch 75.96 | loss  4.21 | ppl    67.48 
| epoch  19 |   200/  216 batches | lr 0.00030 | ms/batch 74.16 | loss  4.17 | ppl    64.85 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 16.68s | valid loss  4.48 | valid ppl    87.88 | valid bpc    6.458
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 19.0%
| epoch  20 |   100/  216 batches | lr 0.00030 | ms/batch 75.82 | loss  4.15 | ppl    63.55 
| epoch  20 |   200/  216 batches | lr 0.00030 | ms/batch 74.35 | loss  4.12 | ppl    61.76 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 16.68s | valid loss  4.48 | valid ppl    88.26 | valid bpc    6.464
-----------------------------------------------------------------------------------------
PROGRESS: 20.0%
| epoch  21 |   100/  216 batches | lr 0.00030 | ms/batch 75.89 | loss  4.11 | ppl    60.78 
| epoch  21 |   200/  216 batches | lr 0.00030 | ms/batch 74.41 | loss  4.05 | ppl    57.43 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 16.68s | valid loss  4.45 | valid ppl    86.00 | valid bpc    6.426
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 21.0%
| epoch  22 |   100/  216 batches | lr 0.00030 | ms/batch 75.51 | loss  4.04 | ppl    56.97 
| epoch  22 |   200/  216 batches | lr 0.00030 | ms/batch 74.61 | loss  4.03 | ppl    56.47 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 16.68s | valid loss  4.41 | valid ppl    82.16 | valid bpc    6.360
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 22.0%
| epoch  23 |   100/  216 batches | lr 0.00030 | ms/batch 75.29 | loss  4.02 | ppl    55.89 
| epoch  23 |   200/  216 batches | lr 0.00030 | ms/batch 74.70 | loss  3.98 | ppl    53.66 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 16.67s | valid loss  4.44 | valid ppl    84.43 | valid bpc    6.400
-----------------------------------------------------------------------------------------
PROGRESS: 23.0%
| epoch  24 |   100/  216 batches | lr 0.00030 | ms/batch 75.88 | loss  3.95 | ppl    51.97 
| epoch  24 |   200/  216 batches | lr 0.00030 | ms/batch 74.30 | loss  3.93 | ppl    50.98 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 16.68s | valid loss  4.38 | valid ppl    79.97 | valid bpc    6.321
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 24.0%
| epoch  25 |   100/  216 batches | lr 0.00030 | ms/batch 76.01 | loss  3.90 | ppl    49.58 
| epoch  25 |   200/  216 batches | lr 0.00030 | ms/batch 74.24 | loss  3.88 | ppl    48.24 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 16.68s | valid loss  4.39 | valid ppl    80.56 | valid bpc    6.332
-----------------------------------------------------------------------------------------
PROGRESS: 25.0%
| epoch  26 |   100/  216 batches | lr 0.00030 | ms/batch 75.60 | loss  3.87 | ppl    47.97 
| epoch  26 |   200/  216 batches | lr 0.00030 | ms/batch 74.52 | loss  3.85 | ppl    47.02 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 16.69s | valid loss  4.34 | valid ppl    76.94 | valid bpc    6.266
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 26.0%
| epoch  27 |   100/  216 batches | lr 0.00030 | ms/batch 75.45 | loss  3.81 | ppl    45.00 
| epoch  27 |   200/  216 batches | lr 0.00030 | ms/batch 74.80 | loss  3.82 | ppl    45.65 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 16.68s | valid loss  4.38 | valid ppl    79.98 | valid bpc    6.322
-----------------------------------------------------------------------------------------
PROGRESS: 27.0%
| epoch  28 |   100/  216 batches | lr 0.00030 | ms/batch 75.56 | loss  3.78 | ppl    43.87 
| epoch  28 |   200/  216 batches | lr 0.00030 | ms/batch 74.67 | loss  3.76 | ppl    42.86 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 16.68s | valid loss  4.30 | valid ppl    74.03 | valid bpc    6.210
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  216 batches | lr 0.00030 | ms/batch 75.43 | loss  3.73 | ppl    41.73 
| epoch  29 |   200/  216 batches | lr 0.00030 | ms/batch 74.73 | loss  3.70 | ppl    40.62 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 16.68s | valid loss  4.33 | valid ppl    76.27 | valid bpc    6.253
-----------------------------------------------------------------------------------------
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  216 batches | lr 0.00030 | ms/batch 75.83 | loss  3.71 | ppl    40.82 
| epoch  30 |   200/  216 batches | lr 0.00030 | ms/batch 74.42 | loss  3.68 | ppl    39.74 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 16.69s | valid loss  4.34 | valid ppl    76.43 | valid bpc    6.256
-----------------------------------------------------------------------------------------
PROGRESS: 30.0%
| epoch  31 |   100/  216 batches | lr 0.00030 | ms/batch 75.83 | loss  3.66 | ppl    39.05 
| epoch  31 |   200/  216 batches | lr 0.00030 | ms/batch 74.36 | loss  3.65 | ppl    38.30 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 16.68s | valid loss  4.36 | valid ppl    78.12 | valid bpc    6.288
-----------------------------------------------------------------------------------------
PROGRESS: 31.0%
| epoch  32 |   100/  216 batches | lr 0.00015 | ms/batch 75.93 | loss  3.59 | ppl    36.12 
| epoch  32 |   200/  216 batches | lr 0.00015 | ms/batch 74.15 | loss  3.53 | ppl    34.08 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 16.68s | valid loss  4.30 | valid ppl    74.00 | valid bpc    6.209
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 32.0%
| epoch  33 |   100/  216 batches | lr 0.00015 | ms/batch 75.37 | loss  3.53 | ppl    34.06 
| epoch  33 |   200/  216 batches | lr 0.00015 | ms/batch 74.76 | loss  3.51 | ppl    33.29 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 16.68s | valid loss  4.33 | valid ppl    76.07 | valid bpc    6.249
-----------------------------------------------------------------------------------------
PROGRESS: 33.0%
| epoch  34 |   100/  216 batches | lr 0.00015 | ms/batch 75.51 | loss  3.47 | ppl    32.15 
| epoch  34 |   200/  216 batches | lr 0.00015 | ms/batch 74.76 | loss  3.46 | ppl    31.97 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 16.68s | valid loss  4.26 | valid ppl    70.59 | valid bpc    6.141
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 34.0%
| epoch  35 |   100/  216 batches | lr 0.00015 | ms/batch 75.63 | loss  3.44 | ppl    31.14 
| epoch  35 |   200/  216 batches | lr 0.00015 | ms/batch 74.59 | loss  3.45 | ppl    31.38 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 16.68s | valid loss  4.29 | valid ppl    72.66 | valid bpc    6.183
-----------------------------------------------------------------------------------------
PROGRESS: 35.0%
| epoch  36 |   100/  216 batches | lr 0.00015 | ms/batch 75.70 | loss  3.43 | ppl    30.74 
| epoch  36 |   200/  216 batches | lr 0.00015 | ms/batch 74.56 | loss  3.41 | ppl    30.37 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 16.68s | valid loss  4.25 | valid ppl    69.91 | valid bpc    6.127
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 36.0%
| epoch  37 |   100/  216 batches | lr 0.00015 | ms/batch 75.71 | loss  3.40 | ppl    29.90 
| epoch  37 |   200/  216 batches | lr 0.00015 | ms/batch 74.45 | loss  3.41 | ppl    30.19 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 16.68s | valid loss  4.28 | valid ppl    72.15 | valid bpc    6.173
-----------------------------------------------------------------------------------------
PROGRESS: 37.0%
| epoch  38 |   100/  216 batches | lr 0.00015 | ms/batch 75.61 | loss  3.39 | ppl    29.72 
| epoch  38 |   200/  216 batches | lr 0.00015 | ms/batch 74.24 | loss  3.35 | ppl    28.61 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 16.68s | valid loss  4.26 | valid ppl    70.58 | valid bpc    6.141
-----------------------------------------------------------------------------------------
PROGRESS: 38.0%
| epoch  39 |   100/  216 batches | lr 0.00015 | ms/batch 75.47 | loss  3.35 | ppl    28.37 
| epoch  39 |   200/  216 batches | lr 0.00015 | ms/batch 74.73 | loss  3.33 | ppl    28.04 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 16.68s | valid loss  4.30 | valid ppl    73.51 | valid bpc    6.200
-----------------------------------------------------------------------------------------
PROGRESS: 39.0%
| epoch  40 |   100/  216 batches | lr 0.00007 | ms/batch 75.48 | loss  3.33 | ppl    27.81 
| epoch  40 |   200/  216 batches | lr 0.00007 | ms/batch 74.72 | loss  3.28 | ppl    26.49 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 16.69s | valid loss  4.24 | valid ppl    69.39 | valid bpc    6.117
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 40.0%
| epoch  41 |   100/  216 batches | lr 0.00007 | ms/batch 75.45 | loss  3.31 | ppl    27.28 
| epoch  41 |   200/  216 batches | lr 0.00007 | ms/batch 74.42 | loss  3.23 | ppl    25.38 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 16.68s | valid loss  4.23 | valid ppl    68.48 | valid bpc    6.098
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 41.0%
| epoch  42 |   100/  216 batches | lr 0.00007 | ms/batch 76.10 | loss  3.27 | ppl    26.24 
| epoch  42 |   200/  216 batches | lr 0.00007 | ms/batch 74.08 | loss  3.23 | ppl    25.20 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 16.68s | valid loss  4.26 | valid ppl    70.93 | valid bpc    6.148
-----------------------------------------------------------------------------------------
PROGRESS: 42.0%
| epoch  43 |   100/  216 batches | lr 0.00007 | ms/batch 75.51 | loss  3.25 | ppl    25.78 
| epoch  43 |   200/  216 batches | lr 0.00007 | ms/batch 74.72 | loss  3.22 | ppl    24.98 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 16.68s | valid loss  4.23 | valid ppl    68.46 | valid bpc    6.097
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 43.0%
| epoch  44 |   100/  216 batches | lr 0.00007 | ms/batch 75.72 | loss  3.23 | ppl    25.19 
| epoch  44 |   200/  216 batches | lr 0.00007 | ms/batch 74.44 | loss  3.20 | ppl    24.64 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 16.68s | valid loss  4.22 | valid ppl    67.81 | valid bpc    6.083
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 44.0%
| epoch  45 |   100/  216 batches | lr 0.00007 | ms/batch 75.78 | loss  3.21 | ppl    24.75 
| epoch  45 |   200/  216 batches | lr 0.00007 | ms/batch 74.29 | loss  3.18 | ppl    24.04 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 16.67s | valid loss  4.25 | valid ppl    70.26 | valid bpc    6.135
-----------------------------------------------------------------------------------------
PROGRESS: 45.0%
| epoch  46 |   100/  216 batches | lr 0.00007 | ms/batch 75.88 | loss  3.21 | ppl    24.68 
| epoch  46 |   200/  216 batches | lr 0.00007 | ms/batch 74.32 | loss  3.18 | ppl    23.96 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 16.68s | valid loss  4.24 | valid ppl    69.53 | valid bpc    6.120
-----------------------------------------------------------------------------------------
PROGRESS: 46.0%
| epoch  47 |   100/  216 batches | lr 0.00007 | ms/batch 75.40 | loss  3.20 | ppl    24.45 
| epoch  47 |   200/  216 batches | lr 0.00007 | ms/batch 74.76 | loss  3.17 | ppl    23.83 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 16.67s | valid loss  4.24 | valid ppl    69.45 | valid bpc    6.118
-----------------------------------------------------------------------------------------
PROGRESS: 47.0%
| epoch  48 |   100/  216 batches | lr 0.00004 | ms/batch 75.59 | loss  3.16 | ppl    23.62 
| epoch  48 |   200/  216 batches | lr 0.00004 | ms/batch 74.65 | loss  3.14 | ppl    23.06 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 16.69s | valid loss  4.23 | valid ppl    68.75 | valid bpc    6.103
-----------------------------------------------------------------------------------------
PROGRESS: 48.0%
| epoch  49 |   100/  216 batches | lr 0.00004 | ms/batch 75.55 | loss  3.15 | ppl    23.35 
| epoch  49 |   200/  216 batches | lr 0.00004 | ms/batch 74.65 | loss  3.14 | ppl    23.10 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 16.68s | valid loss  4.24 | valid ppl    69.21 | valid bpc    6.113
-----------------------------------------------------------------------------------------
PROGRESS: 49.0%
| epoch  50 |   100/  216 batches | lr 0.00004 | ms/batch 75.39 | loss  3.12 | ppl    22.65 
| epoch  50 |   200/  216 batches | lr 0.00004 | ms/batch 74.75 | loss  3.12 | ppl    22.71 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 16.68s | valid loss  4.25 | valid ppl    70.06 | valid bpc    6.130
-----------------------------------------------------------------------------------------
PROGRESS: 50.0%
| epoch  51 |   100/  216 batches | lr 0.00002 | ms/batch 75.38 | loss  3.12 | ppl    22.53 
| epoch  51 |   200/  216 batches | lr 0.00002 | ms/batch 74.51 | loss  3.11 | ppl    22.48 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 16.69s | valid loss  4.25 | valid ppl    70.13 | valid bpc    6.132
-----------------------------------------------------------------------------------------
PROGRESS: 51.0%
| epoch  52 |   100/  216 batches | lr 0.00002 | ms/batch 75.94 | loss  3.13 | ppl    22.79 
| epoch  52 |   200/  216 batches | lr 0.00002 | ms/batch 74.45 | loss  3.09 | ppl    22.02 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 16.70s | valid loss  4.21 | valid ppl    67.49 | valid bpc    6.077
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 52.0%
| epoch  53 |   100/  216 batches | lr 0.00002 | ms/batch 75.62 | loss  3.12 | ppl    22.55 
| epoch  53 |   200/  216 batches | lr 0.00002 | ms/batch 74.65 | loss  3.08 | ppl    21.77 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 16.69s | valid loss  4.25 | valid ppl    70.22 | valid bpc    6.134
-----------------------------------------------------------------------------------------
PROGRESS: 53.0%
| epoch  54 |   100/  216 batches | lr 0.00002 | ms/batch 75.50 | loss  3.11 | ppl    22.51 
| epoch  54 |   200/  216 batches | lr 0.00002 | ms/batch 74.70 | loss  3.07 | ppl    21.58 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 16.68s | valid loss  4.23 | valid ppl    69.02 | valid bpc    6.109
-----------------------------------------------------------------------------------------
PROGRESS: 54.0%
| epoch  55 |   100/  216 batches | lr 0.00002 | ms/batch 76.09 | loss  3.12 | ppl    22.67 
| epoch  55 |   200/  216 batches | lr 0.00002 | ms/batch 74.19 | loss  3.07 | ppl    21.53 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 16.68s | valid loss  4.25 | valid ppl    70.09 | valid bpc    6.131
-----------------------------------------------------------------------------------------
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  216 batches | lr 0.00001 | ms/batch 75.49 | loss  3.08 | ppl    21.78 
| epoch  56 |   200/  216 batches | lr 0.00001 | ms/batch 74.81 | loss  3.09 | ppl    21.91 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 16.69s | valid loss  4.20 | valid ppl    66.35 | valid bpc    6.052
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  216 batches | lr 0.00001 | ms/batch 75.94 | loss  3.10 | ppl    22.31 
| epoch  57 |   200/  216 batches | lr 0.00001 | ms/batch 74.34 | loss  3.04 | ppl    20.86 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 16.68s | valid loss  4.19 | valid ppl    66.28 | valid bpc    6.050
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  216 batches | lr 0.00001 | ms/batch 75.59 | loss  3.11 | ppl    22.35 
| epoch  58 |   200/  216 batches | lr 0.00001 | ms/batch 74.28 | loss  3.04 | ppl    20.98 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 16.67s | valid loss  4.22 | valid ppl    68.11 | valid bpc    6.090
-----------------------------------------------------------------------------------------
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  216 batches | lr 0.00001 | ms/batch 75.73 | loss  3.09 | ppl    22.03 
| epoch  59 |   200/  216 batches | lr 0.00001 | ms/batch 74.24 | loss  3.06 | ppl    21.42 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 16.68s | valid loss  4.25 | valid ppl    69.98 | valid bpc    6.129
-----------------------------------------------------------------------------------------
PROGRESS: 59.0%
| epoch  60 |   100/  216 batches | lr 0.00001 | ms/batch 75.31 | loss  3.07 | ppl    21.59 
| epoch  60 |   200/  216 batches | lr 0.00001 | ms/batch 74.91 | loss  3.06 | ppl    21.23 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 16.68s | valid loss  4.26 | valid ppl    70.90 | valid bpc    6.148
-----------------------------------------------------------------------------------------
PROGRESS: 60.0%
| epoch  61 |   100/  216 batches | lr 0.00000 | ms/batch 75.83 | loss  3.06 | ppl    21.40 
| epoch  61 |   200/  216 batches | lr 0.00000 | ms/batch 74.41 | loss  3.06 | ppl    21.29 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 16.68s | valid loss  4.25 | valid ppl    70.14 | valid bpc    6.132
-----------------------------------------------------------------------------------------
PROGRESS: 61.0%
| epoch  62 |   100/  216 batches | lr 0.00000 | ms/batch 75.44 | loss  3.07 | ppl    21.61 
| epoch  62 |   200/  216 batches | lr 0.00000 | ms/batch 74.80 | loss  3.07 | ppl    21.56 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 16.68s | valid loss  4.25 | valid ppl    69.85 | valid bpc    6.126
-----------------------------------------------------------------------------------------
PROGRESS: 62.0%
| epoch  63 |   100/  216 batches | lr 0.00000 | ms/batch 75.49 | loss  3.08 | ppl    21.85 
| epoch  63 |   200/  216 batches | lr 0.00000 | ms/batch 74.36 | loss  3.04 | ppl    20.83 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 16.68s | valid loss  4.24 | valid ppl    69.75 | valid bpc    6.124
-----------------------------------------------------------------------------------------
PROGRESS: 63.0%
| epoch  64 |   100/  216 batches | lr 0.00000 | ms/batch 76.01 | loss  3.05 | ppl    21.17 
| epoch  64 |   200/  216 batches | lr 0.00000 | ms/batch 74.17 | loss  3.06 | ppl    21.39 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 16.68s | valid loss  4.24 | valid ppl    69.73 | valid bpc    6.124
-----------------------------------------------------------------------------------------
PROGRESS: 64.0%
| epoch  65 |   100/  216 batches | lr 0.00000 | ms/batch 75.91 | loss  3.09 | ppl    22.00 
| epoch  65 |   200/  216 batches | lr 0.00000 | ms/batch 74.33 | loss  3.05 | ppl    21.14 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 16.68s | valid loss  4.26 | valid ppl    71.00 | valid bpc    6.150
-----------------------------------------------------------------------------------------
PROGRESS: 65.0%
| epoch  66 |   100/  216 batches | lr 0.00000 | ms/batch 75.49 | loss  3.08 | ppl    21.80 
| epoch  66 |   200/  216 batches | lr 0.00000 | ms/batch 74.73 | loss  3.06 | ppl    21.35 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 16.68s | valid loss  4.23 | valid ppl    68.59 | valid bpc    6.100
-----------------------------------------------------------------------------------------
PROGRESS: 66.0%
| epoch  67 |   100/  216 batches | lr 0.00000 | ms/batch 75.86 | loss  3.08 | ppl    21.71 
| epoch  67 |   200/  216 batches | lr 0.00000 | ms/batch 74.33 | loss  3.05 | ppl    21.03 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 16.69s | valid loss  4.24 | valid ppl    69.07 | valid bpc    6.110
-----------------------------------------------------------------------------------------
PROGRESS: 67.0%
| epoch  68 |   100/  216 batches | lr 0.00000 | ms/batch 75.69 | loss  3.08 | ppl    21.71 
| epoch  68 |   200/  216 batches | lr 0.00000 | ms/batch 74.62 | loss  3.06 | ppl    21.23 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 16.68s | valid loss  4.20 | valid ppl    66.45 | valid bpc    6.054
-----------------------------------------------------------------------------------------
PROGRESS: 68.0%
| epoch  69 |   100/  216 batches | lr 0.00000 | ms/batch 75.88 | loss  3.09 | ppl    22.00 
| epoch  69 |   200/  216 batches | lr 0.00000 | ms/batch 74.39 | loss  3.03 | ppl    20.76 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 16.69s | valid loss  4.22 | valid ppl    68.29 | valid bpc    6.094
-----------------------------------------------------------------------------------------
PROGRESS: 69.0%
| epoch  70 |   100/  216 batches | lr 0.00000 | ms/batch 75.47 | loss  3.07 | ppl    21.54 
| epoch  70 |   200/  216 batches | lr 0.00000 | ms/batch 74.77 | loss  3.05 | ppl    21.03 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 16.68s | valid loss  4.21 | valid ppl    67.35 | valid bpc    6.074
-----------------------------------------------------------------------------------------
PROGRESS: 70.0%
| epoch  71 |   100/  216 batches | lr 0.00000 | ms/batch 75.46 | loss  3.08 | ppl    21.70 
| epoch  71 |   200/  216 batches | lr 0.00000 | ms/batch 74.83 | loss  3.04 | ppl    20.99 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 16.68s | valid loss  4.24 | valid ppl    69.44 | valid bpc    6.118
-----------------------------------------------------------------------------------------
PROGRESS: 71.0%
| epoch  72 |   100/  216 batches | lr 0.00000 | ms/batch 75.86 | loss  3.08 | ppl    21.75 
| epoch  72 |   200/  216 batches | lr 0.00000 | ms/batch 74.23 | loss  3.02 | ppl    20.59 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 16.68s | valid loss  4.26 | valid ppl    70.85 | valid bpc    6.147
-----------------------------------------------------------------------------------------
PROGRESS: 72.0%
| epoch  73 |   100/  216 batches | lr 0.00000 | ms/batch 75.95 | loss  3.06 | ppl    21.40 
| epoch  73 |   200/  216 batches | lr 0.00000 | ms/batch 74.36 | loss  3.06 | ppl    21.30 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 16.69s | valid loss  4.26 | valid ppl    70.69 | valid bpc    6.143
-----------------------------------------------------------------------------------------
PROGRESS: 73.0%
| epoch  74 |   100/  216 batches | lr 0.00000 | ms/batch 75.89 | loss  3.11 | ppl    22.45 
| epoch  74 |   200/  216 batches | lr 0.00000 | ms/batch 74.34 | loss  3.02 | ppl    20.48 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 16.68s | valid loss  4.20 | valid ppl    66.91 | valid bpc    6.064
-----------------------------------------------------------------------------------------
PROGRESS: 74.0%
| epoch  75 |   100/  216 batches | lr 0.00000 | ms/batch 75.71 | loss  3.05 | ppl    21.04 
| epoch  75 |   200/  216 batches | lr 0.00000 | ms/batch 74.47 | loss  3.06 | ppl    21.28 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 16.68s | valid loss  4.21 | valid ppl    67.54 | valid bpc    6.078
-----------------------------------------------------------------------------------------
PROGRESS: 75.0%
| epoch  76 |   100/  216 batches | lr 0.00000 | ms/batch 75.65 | loss  3.08 | ppl    21.84 
| epoch  76 |   200/  216 batches | lr 0.00000 | ms/batch 74.64 | loss  3.05 | ppl    21.12 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 16.68s | valid loss  4.24 | valid ppl    69.28 | valid bpc    6.114
-----------------------------------------------------------------------------------------
PROGRESS: 76.0%
| epoch  77 |   100/  216 batches | lr 0.00000 | ms/batch 75.72 | loss  3.08 | ppl    21.83 
| epoch  77 |   200/  216 batches | lr 0.00000 | ms/batch 74.47 | loss  3.05 | ppl    21.04 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 16.68s | valid loss  4.26 | valid ppl    70.65 | valid bpc    6.143
-----------------------------------------------------------------------------------------
PROGRESS: 77.0%
| epoch  78 |   100/  216 batches | lr 0.00000 | ms/batch 75.32 | loss  3.07 | ppl    21.51 
| epoch  78 |   200/  216 batches | lr 0.00000 | ms/batch 74.47 | loss  3.03 | ppl    20.79 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 16.68s | valid loss  4.23 | valid ppl    68.95 | valid bpc    6.107
-----------------------------------------------------------------------------------------
PROGRESS: 78.0%
| epoch  79 |   100/  216 batches | lr 0.00000 | ms/batch 75.34 | loss  3.06 | ppl    21.40 
| epoch  79 |   200/  216 batches | lr 0.00000 | ms/batch 74.87 | loss  3.06 | ppl    21.32 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 16.68s | valid loss  4.17 | valid ppl    64.98 | valid bpc    6.022
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 79.0%
| epoch  80 |   100/  216 batches | lr 0.00000 | ms/batch 76.05 | loss  3.11 | ppl    22.35 
| epoch  80 |   200/  216 batches | lr 0.00000 | ms/batch 74.23 | loss  3.02 | ppl    20.52 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 16.68s | valid loss  4.23 | valid ppl    68.95 | valid bpc    6.108
-----------------------------------------------------------------------------------------
PROGRESS: 80.0%
| epoch  81 |   100/  216 batches | lr 0.00000 | ms/batch 75.39 | loss  3.08 | ppl    21.78 
| epoch  81 |   200/  216 batches | lr 0.00000 | ms/batch 74.92 | loss  3.06 | ppl    21.27 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 16.68s | valid loss  4.18 | valid ppl    65.64 | valid bpc    6.037
-----------------------------------------------------------------------------------------
PROGRESS: 81.0%
| epoch  82 |   100/  216 batches | lr 0.00000 | ms/batch 75.60 | loss  3.08 | ppl    21.75 
| epoch  82 |   200/  216 batches | lr 0.00000 | ms/batch 74.66 | loss  3.03 | ppl    20.71 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 16.68s | valid loss  4.25 | valid ppl    69.79 | valid bpc    6.125
-----------------------------------------------------------------------------------------
PROGRESS: 82.0%
| epoch  83 |   100/  216 batches | lr 0.00000 | ms/batch 75.82 | loss  3.06 | ppl    21.40 
| epoch  83 |   200/  216 batches | lr 0.00000 | ms/batch 74.28 | loss  3.07 | ppl    21.47 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 16.68s | valid loss  4.22 | valid ppl    67.99 | valid bpc    6.087
-----------------------------------------------------------------------------------------
PROGRESS: 83.0%
| epoch  84 |   100/  216 batches | lr 0.00000 | ms/batch 75.73 | loss  3.07 | ppl    21.55 
| epoch  84 |   200/  216 batches | lr 0.00000 | ms/batch 74.58 | loss  3.04 | ppl    20.85 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 16.69s | valid loss  4.25 | valid ppl    70.18 | valid bpc    6.133
-----------------------------------------------------------------------------------------
PROGRESS: 84.0%
| epoch  85 |   100/  216 batches | lr 0.00000 | ms/batch 76.05 | loss  3.08 | ppl    21.69 
| epoch  85 |   200/  216 batches | lr 0.00000 | ms/batch 74.22 | loss  3.05 | ppl    21.14 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 16.68s | valid loss  4.21 | valid ppl    67.29 | valid bpc    6.072
-----------------------------------------------------------------------------------------
PROGRESS: 85.0%
| epoch  86 |   100/  216 batches | lr 0.00000 | ms/batch 75.58 | loss  3.08 | ppl    21.66 
| epoch  86 |   200/  216 batches | lr 0.00000 | ms/batch 74.66 | loss  3.05 | ppl    21.02 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 16.68s | valid loss  4.23 | valid ppl    68.53 | valid bpc    6.099
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  216 batches | lr 0.00000 | ms/batch 75.61 | loss  3.09 | ppl    21.91 
| epoch  87 |   200/  216 batches | lr 0.00000 | ms/batch 74.59 | loss  3.04 | ppl    20.93 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 16.68s | valid loss  4.25 | valid ppl    69.85 | valid bpc    6.126
-----------------------------------------------------------------------------------------
PROGRESS: 87.0%
| epoch  88 |   100/  216 batches | lr 0.00000 | ms/batch 75.85 | loss  3.06 | ppl    21.27 
| epoch  88 |   200/  216 batches | lr 0.00000 | ms/batch 74.35 | loss  3.03 | ppl    20.79 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 16.68s | valid loss  4.25 | valid ppl    70.25 | valid bpc    6.134
-----------------------------------------------------------------------------------------
PROGRESS: 88.0%
| epoch  89 |   100/  216 batches | lr 0.00000 | ms/batch 76.02 | loss  3.07 | ppl    21.61 
| epoch  89 |   200/  216 batches | lr 0.00000 | ms/batch 74.22 | loss  3.04 | ppl    20.99 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 16.68s | valid loss  4.23 | valid ppl    68.53 | valid bpc    6.099
-----------------------------------------------------------------------------------------
PROGRESS: 89.0%
| epoch  90 |   100/  216 batches | lr 0.00000 | ms/batch 75.53 | loss  3.07 | ppl    21.50 
| epoch  90 |   200/  216 batches | lr 0.00000 | ms/batch 74.67 | loss  3.04 | ppl    21.00 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 16.68s | valid loss  4.26 | valid ppl    70.57 | valid bpc    6.141
-----------------------------------------------------------------------------------------
PROGRESS: 90.0%
| epoch  91 |   100/  216 batches | lr 0.00000 | ms/batch 75.39 | loss  3.09 | ppl    22.01 
| epoch  91 |   200/  216 batches | lr 0.00000 | ms/batch 74.88 | loss  3.04 | ppl    20.96 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 16.68s | valid loss  4.26 | valid ppl    70.80 | valid bpc    6.146
-----------------------------------------------------------------------------------------
PROGRESS: 91.0%
| epoch  92 |   100/  216 batches | lr 0.00000 | ms/batch 75.73 | loss  3.08 | ppl    21.71 
| epoch  92 |   200/  216 batches | lr 0.00000 | ms/batch 74.45 | loss  3.06 | ppl    21.33 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 16.68s | valid loss  4.27 | valid ppl    71.72 | valid bpc    6.164
-----------------------------------------------------------------------------------------
PROGRESS: 92.0%
| epoch  93 |   100/  216 batches | lr 0.00000 | ms/batch 75.49 | loss  3.09 | ppl    22.02 
| epoch  93 |   200/  216 batches | lr 0.00000 | ms/batch 74.76 | loss  3.06 | ppl    21.27 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 16.68s | valid loss  4.22 | valid ppl    67.78 | valid bpc    6.083
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  216 batches | lr 0.00000 | ms/batch 75.96 | loss  3.09 | ppl    21.90 
| epoch  94 |   200/  216 batches | lr 0.00000 | ms/batch 74.29 | loss  3.01 | ppl    20.36 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 16.69s | valid loss  4.25 | valid ppl    70.16 | valid bpc    6.133
-----------------------------------------------------------------------------------------
PROGRESS: 94.0%
| epoch  95 |   100/  216 batches | lr 0.00000 | ms/batch 75.67 | loss  3.09 | ppl    21.99 
| epoch  95 |   200/  216 batches | lr 0.00000 | ms/batch 74.64 | loss  3.04 | ppl    20.92 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 16.68s | valid loss  4.22 | valid ppl    67.86 | valid bpc    6.085
-----------------------------------------------------------------------------------------
PROGRESS: 95.0%
| epoch  96 |   100/  216 batches | lr 0.00000 | ms/batch 75.54 | loss  3.09 | ppl    21.89 
| epoch  96 |   200/  216 batches | lr 0.00000 | ms/batch 74.70 | loss  3.03 | ppl    20.74 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 16.68s | valid loss  4.22 | valid ppl    68.34 | valid bpc    6.095
-----------------------------------------------------------------------------------------
PROGRESS: 96.0%
| epoch  97 |   100/  216 batches | lr 0.00000 | ms/batch 75.44 | loss  3.06 | ppl    21.42 
| epoch  97 |   200/  216 batches | lr 0.00000 | ms/batch 74.80 | loss  3.05 | ppl    21.01 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 16.68s | valid loss  4.21 | valid ppl    67.27 | valid bpc    6.072
-----------------------------------------------------------------------------------------
PROGRESS: 97.0%
| epoch  98 |   100/  216 batches | lr 0.00000 | ms/batch 75.53 | loss  3.09 | ppl    22.03 
| epoch  98 |   200/  216 batches | lr 0.00000 | ms/batch 74.74 | loss  3.02 | ppl    20.42 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 16.69s | valid loss  4.23 | valid ppl    68.56 | valid bpc    6.099
-----------------------------------------------------------------------------------------
PROGRESS: 98.0%
| epoch  99 |   100/  216 batches | lr 0.00000 | ms/batch 75.33 | loss  3.08 | ppl    21.79 
| epoch  99 |   200/  216 batches | lr 0.00000 | ms/batch 74.53 | loss  3.04 | ppl    20.94 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 16.68s | valid loss  4.23 | valid ppl    68.61 | valid bpc    6.100
-----------------------------------------------------------------------------------------
PROGRESS: 99.0%
| epoch 100 |   100/  216 batches | lr 0.00000 | ms/batch 75.22 | loss  3.08 | ppl    21.84 
| epoch 100 |   200/  216 batches | lr 0.00000 | ms/batch 74.86 | loss  3.06 | ppl    21.25 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 16.68s | valid loss  4.21 | valid ppl    67.22 | valid bpc    6.071
-----------------------------------------------------------------------------------------
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  4.15 | test ppl    63.72 | test bpc    5.994
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.4814, Mean Reca: 0.6617, Mean F1: 0.5488
Counter({'NP': 10398, 'PP': 4042, 'VP': 3814, 'S': 3581, 'SBAR': 912, 'ADJP': 297, 'QP': 272, 'ADVP': 160, 'SINV': 152, 'PRN': 66, 'NX': 45, 'FRAG': 34, 'WHNP': 25, 'NAC': 12, 'SQ': 12, 'UCP': 10, 'SBARQ': 9, 'CONJP': 4, 'X': 2, 'WHPP': 1})
Counter({'NP': 14432, 'VP': 8130, 'S': 5620, 'PP': 5484, 'SBAR': 1796, 'ADJP': 649, 'QP': 490, 'ADVP': 286, 'SINV': 157, 'PRN': 128, 'NX': 95, 'FRAG': 42, 'WHNP': 37, 'UCP': 32, 'NAC': 30, 'WHPP': 25, 'CONJP': 21, 'SQ': 18, 'SBARQ': 10, 'WHADVP': 9, 'X': 6, 'WHADJP': 4, 'INTJ': 1})
SBAR: 0.5078
NP: 0.7205
VP: 0.4691
PP: 0.7371
ADJP: 0.4576
ADVP: 0.5594
5.047226841287627
-----------------------------------------------------------------------------------------
Dependency parsing performance:
Conll-U Style:
DDA: 0.082
UDA: 0.352
=========================================================================================
Loading dataset...
Loading dictionary...
Number of tokens:  10001
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer_in_parser', nhid=512, nlayers=8, front_layers=7, rear_layers=1, n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=2222, nonmono=5, cuda=True, log_interval=100, save='trained_models/structformer_in_parser_2222_71.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 38475557
Model architecture: StructFormer_In_Parser(
  (transformer_front): Transformer_Front(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(10001, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-6): 7 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
  (transformer_rear): Transformer_Rear(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(10001, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0): TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (output_layer): Linear(in_features=512, out_features=10001, bias=True)
  )
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  216 batches | lr 0.00030 | ms/batch 78.42 | loss  7.30 | ppl  1475.11 
| epoch   1 |   200/  216 batches | lr 0.00030 | ms/batch 73.46 | loss  6.88 | ppl   972.48 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 16.86s | valid loss  6.77 | valid ppl   867.94 | valid bpc    9.761
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  216 batches | lr 0.00030 | ms/batch 74.78 | loss  6.82 | ppl   917.46 
| epoch   2 |   200/  216 batches | lr 0.00030 | ms/batch 74.09 | loss  6.59 | ppl   728.42 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 16.54s | valid loss  6.32 | valid ppl   553.86 | valid bpc    9.113
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  216 batches | lr 0.00030 | ms/batch 75.14 | loss  6.33 | ppl   559.05 
| epoch   3 |   200/  216 batches | lr 0.00030 | ms/batch 74.16 | loss  6.11 | ppl   448.24 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 16.58s | valid loss  5.87 | valid ppl   355.22 | valid bpc    8.473
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  216 batches | lr 0.00030 | ms/batch 75.10 | loss  5.92 | ppl   373.50 
| epoch   4 |   200/  216 batches | lr 0.00030 | ms/batch 74.61 | loss  5.73 | ppl   308.76 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 16.62s | valid loss  5.59 | valid ppl   268.89 | valid bpc    8.071
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  216 batches | lr 0.00030 | ms/batch 75.46 | loss  5.61 | ppl   273.70 
| epoch   5 |   200/  216 batches | lr 0.00030 | ms/batch 74.45 | loss  5.49 | ppl   242.37 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 16.64s | valid loss  5.43 | valid ppl   227.44 | valid bpc    7.829
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  216 batches | lr 0.00030 | ms/batch 75.67 | loss  5.41 | ppl   223.63 
| epoch   6 |   200/  216 batches | lr 0.00030 | ms/batch 74.17 | loss  5.30 | ppl   200.17 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 16.65s | valid loss  5.26 | valid ppl   191.64 | valid bpc    7.582
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  216 batches | lr 0.00030 | ms/batch 75.69 | loss  5.23 | ppl   187.33 
| epoch   7 |   200/  216 batches | lr 0.00030 | ms/batch 74.27 | loss  5.16 | ppl   174.20 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 16.66s | valid loss  5.12 | valid ppl   167.24 | valid bpc    7.386
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  216 batches | lr 0.00030 | ms/batch 75.35 | loss  5.08 | ppl   160.38 
| epoch   8 |   200/  216 batches | lr 0.00030 | ms/batch 74.63 | loss  5.04 | ppl   154.11 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 16.66s | valid loss  5.08 | valid ppl   160.73 | valid bpc    7.329
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 8.0%
| epoch   9 |   100/  216 batches | lr 0.00030 | ms/batch 75.58 | loss  4.99 | ppl   146.76 
| epoch   9 |   200/  216 batches | lr 0.00030 | ms/batch 74.46 | loss  4.90 | ppl   134.11 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 16.67s | valid loss  4.96 | valid ppl   142.37 | valid bpc    7.153
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  216 batches | lr 0.00030 | ms/batch 75.45 | loss  4.86 | ppl   129.32 
| epoch  10 |   200/  216 batches | lr 0.00030 | ms/batch 74.65 | loss  4.83 | ppl   125.10 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 16.67s | valid loss  4.86 | valid ppl   129.64 | valid bpc    7.018
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  216 batches | lr 0.00030 | ms/batch 75.73 | loss  4.79 | ppl   120.89 
| epoch  11 |   200/  216 batches | lr 0.00030 | ms/batch 74.45 | loss  4.73 | ppl   112.81 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 16.67s | valid loss  4.83 | valid ppl   125.42 | valid bpc    6.971
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  216 batches | lr 0.00030 | ms/batch 75.46 | loss  4.71 | ppl   110.51 
| epoch  12 |   200/  216 batches | lr 0.00030 | ms/batch 74.67 | loss  4.65 | ppl   104.12 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 16.67s | valid loss  4.77 | valid ppl   117.44 | valid bpc    6.876
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 12.0%
| epoch  13 |   100/  216 batches | lr 0.00030 | ms/batch 75.34 | loss  4.60 | ppl    99.74 
| epoch  13 |   200/  216 batches | lr 0.00030 | ms/batch 74.68 | loss  4.58 | ppl    97.66 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 16.67s | valid loss  4.73 | valid ppl   113.33 | valid bpc    6.824
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 13.0%
| epoch  14 |   100/  216 batches | lr 0.00030 | ms/batch 75.57 | loss  4.54 | ppl    94.12 
| epoch  14 |   200/  216 batches | lr 0.00030 | ms/batch 74.61 | loss  4.49 | ppl    88.76 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 16.68s | valid loss  4.68 | valid ppl   107.42 | valid bpc    6.747
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  216 batches | lr 0.00030 | ms/batch 75.88 | loss  4.47 | ppl    87.27 
| epoch  15 |   200/  216 batches | lr 0.00030 | ms/batch 74.28 | loss  4.40 | ppl    81.81 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 16.68s | valid loss  4.60 | valid ppl    99.58 | valid bpc    6.638
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 15.0%
| epoch  16 |   100/  216 batches | lr 0.00030 | ms/batch 75.46 | loss  4.37 | ppl    78.74 
| epoch  16 |   200/  216 batches | lr 0.00030 | ms/batch 74.67 | loss  4.38 | ppl    79.49 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 16.68s | valid loss  4.60 | valid ppl    99.11 | valid bpc    6.631
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 16.0%
| epoch  17 |   100/  216 batches | lr 0.00030 | ms/batch 75.84 | loss  4.33 | ppl    76.32 
| epoch  17 |   200/  216 batches | lr 0.00030 | ms/batch 74.19 | loss  4.29 | ppl    73.04 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 16.68s | valid loss  4.52 | valid ppl    92.24 | valid bpc    6.527
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 17.0%
| epoch  18 |   100/  216 batches | lr 0.00030 | ms/batch 75.84 | loss  4.26 | ppl    70.86 
| epoch  18 |   200/  216 batches | lr 0.00030 | ms/batch 74.37 | loss  4.27 | ppl    71.45 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 16.67s | valid loss  4.49 | valid ppl    89.53 | valid bpc    6.484
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 18.0%
| epoch  19 |   100/  216 batches | lr 0.00030 | ms/batch 75.50 | loss  4.22 | ppl    68.36 
| epoch  19 |   200/  216 batches | lr 0.00030 | ms/batch 74.53 | loss  4.17 | ppl    64.78 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 16.67s | valid loss  4.53 | valid ppl    93.02 | valid bpc    6.539
-----------------------------------------------------------------------------------------
PROGRESS: 19.0%
| epoch  20 |   100/  216 batches | lr 0.00030 | ms/batch 76.04 | loss  4.18 | ppl    65.35 
| epoch  20 |   200/  216 batches | lr 0.00030 | ms/batch 74.17 | loss  4.11 | ppl    61.13 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 16.67s | valid loss  4.49 | valid ppl    89.24 | valid bpc    6.480
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 20.0%
| epoch  21 |   100/  216 batches | lr 0.00030 | ms/batch 75.55 | loss  4.12 | ppl    61.80 
| epoch  21 |   200/  216 batches | lr 0.00030 | ms/batch 74.55 | loss  4.05 | ppl    57.42 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 16.67s | valid loss  4.44 | valid ppl    84.61 | valid bpc    6.403
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 21.0%
| epoch  22 |   100/  216 batches | lr 0.00030 | ms/batch 75.51 | loss  4.04 | ppl    57.00 
| epoch  22 |   200/  216 batches | lr 0.00030 | ms/batch 74.67 | loss  4.05 | ppl    57.31 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 16.67s | valid loss  4.43 | valid ppl    83.64 | valid bpc    6.386
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 22.0%
| epoch  23 |   100/  216 batches | lr 0.00030 | ms/batch 75.32 | loss  4.01 | ppl    55.36 
| epoch  23 |   200/  216 batches | lr 0.00030 | ms/batch 74.41 | loss  3.99 | ppl    53.81 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 16.67s | valid loss  4.42 | valid ppl    82.72 | valid bpc    6.370
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 23.0%
| epoch  24 |   100/  216 batches | lr 0.00030 | ms/batch 75.47 | loss  3.95 | ppl    51.89 
| epoch  24 |   200/  216 batches | lr 0.00030 | ms/batch 74.64 | loss  3.96 | ppl    52.41 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 16.67s | valid loss  4.37 | valid ppl    79.44 | valid bpc    6.312
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 24.0%
| epoch  25 |   100/  216 batches | lr 0.00030 | ms/batch 75.51 | loss  3.92 | ppl    50.29 
| epoch  25 |   200/  216 batches | lr 0.00030 | ms/batch 74.60 | loss  3.90 | ppl    49.46 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 16.67s | valid loss  4.37 | valid ppl    79.08 | valid bpc    6.305
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 25.0%
| epoch  26 |   100/  216 batches | lr 0.00030 | ms/batch 75.50 | loss  3.85 | ppl    47.13 
| epoch  26 |   200/  216 batches | lr 0.00030 | ms/batch 74.59 | loss  3.86 | ppl    47.33 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 16.67s | valid loss  4.37 | valid ppl    78.66 | valid bpc    6.297
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 26.0%
| epoch  27 |   100/  216 batches | lr 0.00030 | ms/batch 75.26 | loss  3.82 | ppl    45.73 
| epoch  27 |   200/  216 batches | lr 0.00030 | ms/batch 74.85 | loss  3.80 | ppl    44.75 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 16.66s | valid loss  4.31 | valid ppl    74.50 | valid bpc    6.219
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 27.0%
| epoch  28 |   100/  216 batches | lr 0.00030 | ms/batch 75.68 | loss  3.80 | ppl    44.91 
| epoch  28 |   200/  216 batches | lr 0.00030 | ms/batch 74.43 | loss  3.76 | ppl    42.89 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 16.67s | valid loss  4.32 | valid ppl    75.25 | valid bpc    6.234
-----------------------------------------------------------------------------------------
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  216 batches | lr 0.00030 | ms/batch 75.91 | loss  3.75 | ppl    42.70 
| epoch  29 |   200/  216 batches | lr 0.00030 | ms/batch 74.27 | loss  3.72 | ppl    41.20 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 16.67s | valid loss  4.31 | valid ppl    74.79 | valid bpc    6.225
-----------------------------------------------------------------------------------------
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  216 batches | lr 0.00030 | ms/batch 75.85 | loss  3.70 | ppl    40.44 
| epoch  30 |   200/  216 batches | lr 0.00030 | ms/batch 74.20 | loss  3.68 | ppl    39.74 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 16.67s | valid loss  4.32 | valid ppl    75.29 | valid bpc    6.234
-----------------------------------------------------------------------------------------
PROGRESS: 30.0%
| epoch  31 |   100/  216 batches | lr 0.00015 | ms/batch 75.68 | loss  3.61 | ppl    37.15 
| epoch  31 |   200/  216 batches | lr 0.00015 | ms/batch 74.45 | loss  3.55 | ppl    34.73 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 16.68s | valid loss  4.26 | valid ppl    71.13 | valid bpc    6.152
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 31.0%
| epoch  32 |   100/  216 batches | lr 0.00015 | ms/batch 75.82 | loss  3.54 | ppl    34.44 
| epoch  32 |   200/  216 batches | lr 0.00015 | ms/batch 74.29 | loss  3.55 | ppl    34.95 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 16.67s | valid loss  4.30 | valid ppl    73.42 | valid bpc    6.198
-----------------------------------------------------------------------------------------
PROGRESS: 32.0%
| epoch  33 |   100/  216 batches | lr 0.00015 | ms/batch 75.40 | loss  3.54 | ppl    34.44 
| epoch  33 |   200/  216 batches | lr 0.00015 | ms/batch 74.74 | loss  3.49 | ppl    32.87 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 16.67s | valid loss  4.30 | valid ppl    73.82 | valid bpc    6.206
-----------------------------------------------------------------------------------------
PROGRESS: 33.0%
| epoch  34 |   100/  216 batches | lr 0.00015 | ms/batch 75.52 | loss  3.48 | ppl    32.36 
| epoch  34 |   200/  216 batches | lr 0.00015 | ms/batch 74.32 | loss  3.47 | ppl    32.16 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 16.68s | valid loss  4.28 | valid ppl    72.56 | valid bpc    6.181
-----------------------------------------------------------------------------------------
PROGRESS: 34.0%
| epoch  35 |   100/  216 batches | lr 0.00007 | ms/batch 75.69 | loss  3.42 | ppl    30.61 
| epoch  35 |   200/  216 batches | lr 0.00007 | ms/batch 74.35 | loss  3.41 | ppl    30.21 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 16.68s | valid loss  4.30 | valid ppl    73.81 | valid bpc    6.206
-----------------------------------------------------------------------------------------
PROGRESS: 35.0%
| epoch  36 |   100/  216 batches | lr 0.00007 | ms/batch 75.82 | loss  3.42 | ppl    30.60 
| epoch  36 |   200/  216 batches | lr 0.00007 | ms/batch 74.38 | loss  3.40 | ppl    30.03 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 16.68s | valid loss  4.30 | valid ppl    73.45 | valid bpc    6.199
-----------------------------------------------------------------------------------------
PROGRESS: 36.0%
| epoch  37 |   100/  216 batches | lr 0.00007 | ms/batch 75.30 | loss  3.40 | ppl    29.82 
| epoch  37 |   200/  216 batches | lr 0.00007 | ms/batch 74.49 | loss  3.35 | ppl    28.64 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 16.68s | valid loss  4.25 | valid ppl    70.45 | valid bpc    6.138
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 37.0%
| epoch  38 |   100/  216 batches | lr 0.00007 | ms/batch 75.36 | loss  3.38 | ppl    29.29 
| epoch  38 |   200/  216 batches | lr 0.00007 | ms/batch 74.81 | loss  3.36 | ppl    28.92 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 16.68s | valid loss  4.26 | valid ppl    71.04 | valid bpc    6.150
-----------------------------------------------------------------------------------------
PROGRESS: 38.0%
| epoch  39 |   100/  216 batches | lr 0.00007 | ms/batch 75.89 | loss  3.35 | ppl    28.49 
| epoch  39 |   200/  216 batches | lr 0.00007 | ms/batch 74.27 | loss  3.35 | ppl    28.52 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 16.69s | valid loss  4.24 | valid ppl    69.45 | valid bpc    6.118
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 39.0%
| epoch  40 |   100/  216 batches | lr 0.00007 | ms/batch 75.89 | loss  3.34 | ppl    28.22 
| epoch  40 |   200/  216 batches | lr 0.00007 | ms/batch 74.25 | loss  3.33 | ppl    28.08 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 16.68s | valid loss  4.21 | valid ppl    67.24 | valid bpc    6.071
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 40.0%
| epoch  41 |   100/  216 batches | lr 0.00007 | ms/batch 75.89 | loss  3.33 | ppl    27.85 
| epoch  41 |   200/  216 batches | lr 0.00007 | ms/batch 74.13 | loss  3.31 | ppl    27.27 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 16.67s | valid loss  4.19 | valid ppl    65.97 | valid bpc    6.044
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 41.0%
| epoch  42 |   100/  216 batches | lr 0.00007 | ms/batch 75.60 | loss  3.29 | ppl    26.73 
| epoch  42 |   200/  216 batches | lr 0.00007 | ms/batch 74.47 | loss  3.31 | ppl    27.34 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 16.67s | valid loss  4.23 | valid ppl    68.47 | valid bpc    6.097
-----------------------------------------------------------------------------------------
PROGRESS: 42.0%
| epoch  43 |   100/  216 batches | lr 0.00007 | ms/batch 75.74 | loss  3.31 | ppl    27.32 
| epoch  43 |   200/  216 batches | lr 0.00007 | ms/batch 74.02 | loss  3.26 | ppl    26.17 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 16.68s | valid loss  4.19 | valid ppl    66.06 | valid bpc    6.046
-----------------------------------------------------------------------------------------
PROGRESS: 43.0%
| epoch  44 |   100/  216 batches | lr 0.00007 | ms/batch 75.51 | loss  3.30 | ppl    27.07 
| epoch  44 |   200/  216 batches | lr 0.00007 | ms/batch 74.72 | loss  3.25 | ppl    25.90 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 16.68s | valid loss  4.23 | valid ppl    68.42 | valid bpc    6.096
-----------------------------------------------------------------------------------------
PROGRESS: 44.0%
| epoch  45 |   100/  216 batches | lr 0.00004 | ms/batch 75.54 | loss  3.27 | ppl    26.34 
| epoch  45 |   200/  216 batches | lr 0.00004 | ms/batch 74.66 | loss  3.22 | ppl    25.08 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 16.68s | valid loss  4.24 | valid ppl    69.52 | valid bpc    6.119
-----------------------------------------------------------------------------------------
PROGRESS: 45.0%
| epoch  46 |   100/  216 batches | lr 0.00004 | ms/batch 75.87 | loss  3.24 | ppl    25.44 
| epoch  46 |   200/  216 batches | lr 0.00004 | ms/batch 74.32 | loss  3.22 | ppl    25.10 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 16.68s | valid loss  4.21 | valid ppl    67.39 | valid bpc    6.074
-----------------------------------------------------------------------------------------
PROGRESS: 46.0%
| epoch  47 |   100/  216 batches | lr 0.00004 | ms/batch 75.47 | loss  3.24 | ppl    25.60 
| epoch  47 |   200/  216 batches | lr 0.00004 | ms/batch 74.72 | loss  3.22 | ppl    25.14 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 16.68s | valid loss  4.24 | valid ppl    69.48 | valid bpc    6.118
-----------------------------------------------------------------------------------------
PROGRESS: 47.0%
| epoch  48 |   100/  216 batches | lr 0.00002 | ms/batch 75.91 | loss  3.23 | ppl    25.32 
| epoch  48 |   200/  216 batches | lr 0.00002 | ms/batch 74.29 | loss  3.21 | ppl    24.70 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 16.68s | valid loss  4.24 | valid ppl    69.41 | valid bpc    6.117
-----------------------------------------------------------------------------------------
PROGRESS: 48.0%
| epoch  49 |   100/  216 batches | lr 0.00002 | ms/batch 75.61 | loss  3.23 | ppl    25.24 
| epoch  49 |   200/  216 batches | lr 0.00002 | ms/batch 74.64 | loss  3.19 | ppl    24.25 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 16.70s | valid loss  4.19 | valid ppl    66.17 | valid bpc    6.048
-----------------------------------------------------------------------------------------
PROGRESS: 49.0%
| epoch  50 |   100/  216 batches | lr 0.00002 | ms/batch 76.51 | loss  3.21 | ppl    24.90 
| epoch  50 |   200/  216 batches | lr 0.00002 | ms/batch 74.36 | loss  3.19 | ppl    24.32 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 16.75s | valid loss  4.25 | valid ppl    70.38 | valid bpc    6.137
-----------------------------------------------------------------------------------------
PROGRESS: 50.0%
| epoch  51 |   100/  216 batches | lr 0.00001 | ms/batch 75.99 | loss  3.21 | ppl    24.81 
| epoch  51 |   200/  216 batches | lr 0.00001 | ms/batch 74.37 | loss  3.18 | ppl    24.03 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 16.70s | valid loss  4.18 | valid ppl    65.39 | valid bpc    6.031
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 51.0%
| epoch  52 |   100/  216 batches | lr 0.00001 | ms/batch 75.46 | loss  3.20 | ppl    24.51 
| epoch  52 |   200/  216 batches | lr 0.00001 | ms/batch 74.69 | loss  3.16 | ppl    23.58 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 16.68s | valid loss  4.20 | valid ppl    66.75 | valid bpc    6.061
-----------------------------------------------------------------------------------------
PROGRESS: 52.0%
| epoch  53 |   100/  216 batches | lr 0.00001 | ms/batch 75.58 | loss  3.20 | ppl    24.62 
| epoch  53 |   200/  216 batches | lr 0.00001 | ms/batch 74.32 | loss  3.15 | ppl    23.44 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 16.68s | valid loss  4.22 | valid ppl    68.06 | valid bpc    6.089
-----------------------------------------------------------------------------------------
PROGRESS: 53.0%
| epoch  54 |   100/  216 batches | lr 0.00001 | ms/batch 75.47 | loss  3.21 | ppl    24.77 
| epoch  54 |   200/  216 batches | lr 0.00001 | ms/batch 74.75 | loss  3.18 | ppl    23.93 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 16.69s | valid loss  4.23 | valid ppl    68.40 | valid bpc    6.096
-----------------------------------------------------------------------------------------
PROGRESS: 54.0%
| epoch  55 |   100/  216 batches | lr 0.00000 | ms/batch 76.03 | loss  3.17 | ppl    23.91 
| epoch  55 |   200/  216 batches | lr 0.00000 | ms/batch 74.19 | loss  3.17 | ppl    23.70 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 16.69s | valid loss  4.20 | valid ppl    66.69 | valid bpc    6.059
-----------------------------------------------------------------------------------------
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  216 batches | lr 0.00000 | ms/batch 75.37 | loss  3.20 | ppl    24.43 
| epoch  56 |   200/  216 batches | lr 0.00000 | ms/batch 74.79 | loss  3.17 | ppl    23.86 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 16.68s | valid loss  4.23 | valid ppl    68.55 | valid bpc    6.099
-----------------------------------------------------------------------------------------
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  216 batches | lr 0.00000 | ms/batch 75.75 | loss  3.19 | ppl    24.26 
| epoch  57 |   200/  216 batches | lr 0.00000 | ms/batch 74.36 | loss  3.16 | ppl    23.49 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 16.68s | valid loss  4.21 | valid ppl    67.42 | valid bpc    6.075
-----------------------------------------------------------------------------------------
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  216 batches | lr 0.00000 | ms/batch 75.72 | loss  3.19 | ppl    24.41 
| epoch  58 |   200/  216 batches | lr 0.00000 | ms/batch 74.46 | loss  3.16 | ppl    23.62 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 16.69s | valid loss  4.21 | valid ppl    67.52 | valid bpc    6.077
-----------------------------------------------------------------------------------------
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  216 batches | lr 0.00000 | ms/batch 75.84 | loss  3.19 | ppl    24.36 
| epoch  59 |   200/  216 batches | lr 0.00000 | ms/batch 74.39 | loss  3.15 | ppl    23.35 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 16.68s | valid loss  4.19 | valid ppl    66.16 | valid bpc    6.048
-----------------------------------------------------------------------------------------
PROGRESS: 59.0%
| epoch  60 |   100/  216 batches | lr 0.00000 | ms/batch 75.34 | loss  3.20 | ppl    24.55 
| epoch  60 |   200/  216 batches | lr 0.00000 | ms/batch 74.88 | loss  3.14 | ppl    23.15 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 16.68s | valid loss  4.22 | valid ppl    67.79 | valid bpc    6.083
-----------------------------------------------------------------------------------------
PROGRESS: 60.0%
| epoch  61 |   100/  216 batches | lr 0.00000 | ms/batch 75.48 | loss  3.18 | ppl    24.12 
| epoch  61 |   200/  216 batches | lr 0.00000 | ms/batch 74.67 | loss  3.17 | ppl    23.75 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 16.68s | valid loss  4.22 | valid ppl    68.28 | valid bpc    6.093
-----------------------------------------------------------------------------------------
PROGRESS: 61.0%
| epoch  62 |   100/  216 batches | lr 0.00000 | ms/batch 75.69 | loss  3.17 | ppl    23.70 
| epoch  62 |   200/  216 batches | lr 0.00000 | ms/batch 74.52 | loss  3.16 | ppl    23.53 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 16.68s | valid loss  4.24 | valid ppl    69.24 | valid bpc    6.114
-----------------------------------------------------------------------------------------
PROGRESS: 62.0%
| epoch  63 |   100/  216 batches | lr 0.00000 | ms/batch 75.79 | loss  3.20 | ppl    24.43 
| epoch  63 |   200/  216 batches | lr 0.00000 | ms/batch 74.45 | loss  3.14 | ppl    23.11 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 16.69s | valid loss  4.23 | valid ppl    68.46 | valid bpc    6.097
-----------------------------------------------------------------------------------------
PROGRESS: 63.0%
| epoch  64 |   100/  216 batches | lr 0.00000 | ms/batch 75.74 | loss  3.19 | ppl    24.26 
| epoch  64 |   200/  216 batches | lr 0.00000 | ms/batch 74.33 | loss  3.15 | ppl    23.22 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 16.68s | valid loss  4.20 | valid ppl    66.98 | valid bpc    6.066
-----------------------------------------------------------------------------------------
PROGRESS: 64.0%
| epoch  65 |   100/  216 batches | lr 0.00000 | ms/batch 75.41 | loss  3.20 | ppl    24.49 
| epoch  65 |   200/  216 batches | lr 0.00000 | ms/batch 74.71 | loss  3.17 | ppl    23.85 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 16.68s | valid loss  4.23 | valid ppl    68.69 | valid bpc    6.102
-----------------------------------------------------------------------------------------
PROGRESS: 65.0%
| epoch  66 |   100/  216 batches | lr 0.00000 | ms/batch 75.74 | loss  3.18 | ppl    23.95 
| epoch  66 |   200/  216 batches | lr 0.00000 | ms/batch 74.45 | loss  3.16 | ppl    23.62 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 16.68s | valid loss  4.20 | valid ppl    66.50 | valid bpc    6.055
-----------------------------------------------------------------------------------------
PROGRESS: 66.0%
| epoch  67 |   100/  216 batches | lr 0.00000 | ms/batch 75.38 | loss  3.17 | ppl    23.91 
| epoch  67 |   200/  216 batches | lr 0.00000 | ms/batch 74.66 | loss  3.16 | ppl    23.58 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 16.68s | valid loss  4.26 | valid ppl    70.51 | valid bpc    6.140
-----------------------------------------------------------------------------------------
PROGRESS: 67.0%
| epoch  68 |   100/  216 batches | lr 0.00000 | ms/batch 75.91 | loss  3.17 | ppl    23.82 
| epoch  68 |   200/  216 batches | lr 0.00000 | ms/batch 74.31 | loss  3.17 | ppl    23.75 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 16.68s | valid loss  4.22 | valid ppl    67.73 | valid bpc    6.082
-----------------------------------------------------------------------------------------
PROGRESS: 68.0%
| epoch  69 |   100/  216 batches | lr 0.00000 | ms/batch 75.61 | loss  3.17 | ppl    23.87 
| epoch  69 |   200/  216 batches | lr 0.00000 | ms/batch 74.52 | loss  3.16 | ppl    23.66 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 16.68s | valid loss  4.20 | valid ppl    66.89 | valid bpc    6.064
-----------------------------------------------------------------------------------------
PROGRESS: 69.0%
| epoch  70 |   100/  216 batches | lr 0.00000 | ms/batch 75.89 | loss  3.21 | ppl    24.70 
| epoch  70 |   200/  216 batches | lr 0.00000 | ms/batch 74.29 | loss  3.15 | ppl    23.27 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 16.68s | valid loss  4.24 | valid ppl    69.21 | valid bpc    6.113
-----------------------------------------------------------------------------------------
PROGRESS: 70.0%
| epoch  71 |   100/  216 batches | lr 0.00000 | ms/batch 75.74 | loss  3.18 | ppl    24.08 
| epoch  71 |   200/  216 batches | lr 0.00000 | ms/batch 74.41 | loss  3.16 | ppl    23.54 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 16.69s | valid loss  4.24 | valid ppl    69.58 | valid bpc    6.121
-----------------------------------------------------------------------------------------
PROGRESS: 71.0%
| epoch  72 |   100/  216 batches | lr 0.00000 | ms/batch 75.60 | loss  3.18 | ppl    24.02 
| epoch  72 |   200/  216 batches | lr 0.00000 | ms/batch 74.66 | loss  3.17 | ppl    23.70 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 16.68s | valid loss  4.21 | valid ppl    67.39 | valid bpc    6.074
-----------------------------------------------------------------------------------------
PROGRESS: 72.0%
| epoch  73 |   100/  216 batches | lr 0.00000 | ms/batch 75.94 | loss  3.20 | ppl    24.58 
| epoch  73 |   200/  216 batches | lr 0.00000 | ms/batch 74.28 | loss  3.14 | ppl    23.05 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 16.68s | valid loss  4.21 | valid ppl    67.63 | valid bpc    6.079
-----------------------------------------------------------------------------------------
PROGRESS: 73.0%
| epoch  74 |   100/  216 batches | lr 0.00000 | ms/batch 75.33 | loss  3.16 | ppl    23.61 
| epoch  74 |   200/  216 batches | lr 0.00000 | ms/batch 74.93 | loss  3.17 | ppl    23.77 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 16.69s | valid loss  4.20 | valid ppl    66.74 | valid bpc    6.061
-----------------------------------------------------------------------------------------
PROGRESS: 74.0%
| epoch  75 |   100/  216 batches | lr 0.00000 | ms/batch 75.83 | loss  3.17 | ppl    23.81 
| epoch  75 |   200/  216 batches | lr 0.00000 | ms/batch 74.33 | loss  3.15 | ppl    23.42 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 16.68s | valid loss  4.20 | valid ppl    66.98 | valid bpc    6.066
-----------------------------------------------------------------------------------------
PROGRESS: 75.0%
| epoch  76 |   100/  216 batches | lr 0.00000 | ms/batch 75.48 | loss  3.18 | ppl    24.14 
| epoch  76 |   200/  216 batches | lr 0.00000 | ms/batch 74.71 | loss  3.15 | ppl    23.31 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 16.68s | valid loss  4.21 | valid ppl    67.18 | valid bpc    6.070
-----------------------------------------------------------------------------------------
PROGRESS: 76.0%
| epoch  77 |   100/  216 batches | lr 0.00000 | ms/batch 75.86 | loss  3.19 | ppl    24.27 
| epoch  77 |   200/  216 batches | lr 0.00000 | ms/batch 74.39 | loss  3.16 | ppl    23.50 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 16.68s | valid loss  4.22 | valid ppl    68.22 | valid bpc    6.092
-----------------------------------------------------------------------------------------
PROGRESS: 77.0%
| epoch  78 |   100/  216 batches | lr 0.00000 | ms/batch 75.55 | loss  3.19 | ppl    24.17 
| epoch  78 |   200/  216 batches | lr 0.00000 | ms/batch 74.64 | loss  3.15 | ppl    23.41 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 16.68s | valid loss  4.23 | valid ppl    69.06 | valid bpc    6.110
-----------------------------------------------------------------------------------------
PROGRESS: 78.0%
| epoch  79 |   100/  216 batches | lr 0.00000 | ms/batch 75.54 | loss  3.18 | ppl    23.95 
| epoch  79 |   200/  216 batches | lr 0.00000 | ms/batch 74.75 | loss  3.15 | ppl    23.26 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 16.68s | valid loss  4.19 | valid ppl    66.10 | valid bpc    6.047
-----------------------------------------------------------------------------------------
PROGRESS: 79.0%
| epoch  80 |   100/  216 batches | lr 0.00000 | ms/batch 76.06 | loss  3.18 | ppl    24.08 
| epoch  80 |   200/  216 batches | lr 0.00000 | ms/batch 74.07 | loss  3.13 | ppl    22.81 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 16.68s | valid loss  4.19 | valid ppl    66.17 | valid bpc    6.048
-----------------------------------------------------------------------------------------
PROGRESS: 80.0%
| epoch  81 |   100/  216 batches | lr 0.00000 | ms/batch 75.55 | loss  3.19 | ppl    24.29 
| epoch  81 |   200/  216 batches | lr 0.00000 | ms/batch 74.75 | loss  3.15 | ppl    23.27 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 16.68s | valid loss  4.21 | valid ppl    67.24 | valid bpc    6.071
-----------------------------------------------------------------------------------------
PROGRESS: 81.0%
| epoch  82 |   100/  216 batches | lr 0.00000 | ms/batch 76.02 | loss  3.18 | ppl    23.98 
| epoch  82 |   200/  216 batches | lr 0.00000 | ms/batch 74.25 | loss  3.17 | ppl    23.89 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 16.68s | valid loss  4.21 | valid ppl    67.21 | valid bpc    6.071
-----------------------------------------------------------------------------------------
PROGRESS: 82.0%
| epoch  83 |   100/  216 batches | lr 0.00000 | ms/batch 75.90 | loss  3.18 | ppl    23.95 
| epoch  83 |   200/  216 batches | lr 0.00000 | ms/batch 74.29 | loss  3.14 | ppl    23.21 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 16.68s | valid loss  4.23 | valid ppl    68.77 | valid bpc    6.104
-----------------------------------------------------------------------------------------
PROGRESS: 83.0%
| epoch  84 |   100/  216 batches | lr 0.00000 | ms/batch 75.92 | loss  3.17 | ppl    23.85 
| epoch  84 |   200/  216 batches | lr 0.00000 | ms/batch 74.28 | loss  3.18 | ppl    23.98 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 16.68s | valid loss  4.20 | valid ppl    66.46 | valid bpc    6.054
-----------------------------------------------------------------------------------------
PROGRESS: 84.0%
| epoch  85 |   100/  216 batches | lr 0.00000 | ms/batch 75.97 | loss  3.20 | ppl    24.54 
| epoch  85 |   200/  216 batches | lr 0.00000 | ms/batch 74.26 | loss  3.14 | ppl    23.06 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 16.68s | valid loss  4.18 | valid ppl    65.29 | valid bpc    6.029
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 85.0%
| epoch  86 |   100/  216 batches | lr 0.00000 | ms/batch 75.79 | loss  3.21 | ppl    24.78 
| epoch  86 |   200/  216 batches | lr 0.00000 | ms/batch 74.37 | loss  3.14 | ppl    23.21 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 16.67s | valid loss  4.20 | valid ppl    66.70 | valid bpc    6.060
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  216 batches | lr 0.00000 | ms/batch 75.49 | loss  3.16 | ppl    23.69 
| epoch  87 |   200/  216 batches | lr 0.00000 | ms/batch 74.60 | loss  3.18 | ppl    24.07 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 16.67s | valid loss  4.21 | valid ppl    67.37 | valid bpc    6.074
-----------------------------------------------------------------------------------------
PROGRESS: 87.0%
| epoch  88 |   100/  216 batches | lr 0.00000 | ms/batch 75.42 | loss  3.18 | ppl    24.03 
| epoch  88 |   200/  216 batches | lr 0.00000 | ms/batch 74.56 | loss  3.17 | ppl    23.84 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 16.67s | valid loss  4.25 | valid ppl    69.94 | valid bpc    6.128
-----------------------------------------------------------------------------------------
PROGRESS: 88.0%
| epoch  89 |   100/  216 batches | lr 0.00000 | ms/batch 75.67 | loss  3.19 | ppl    24.25 
| epoch  89 |   200/  216 batches | lr 0.00000 | ms/batch 74.21 | loss  3.14 | ppl    23.12 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 16.68s | valid loss  4.23 | valid ppl    68.47 | valid bpc    6.097
-----------------------------------------------------------------------------------------
PROGRESS: 89.0%
| epoch  90 |   100/  216 batches | lr 0.00000 | ms/batch 75.83 | loss  3.18 | ppl    23.97 
| epoch  90 |   200/  216 batches | lr 0.00000 | ms/batch 74.26 | loss  3.16 | ppl    23.66 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 16.68s | valid loss  4.22 | valid ppl    68.32 | valid bpc    6.094
-----------------------------------------------------------------------------------------
PROGRESS: 90.0%
| epoch  91 |   100/  216 batches | lr 0.00000 | ms/batch 75.72 | loss  3.18 | ppl    24.05 
| epoch  91 |   200/  216 batches | lr 0.00000 | ms/batch 74.31 | loss  3.16 | ppl    23.51 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 16.68s | valid loss  4.20 | valid ppl    66.76 | valid bpc    6.061
-----------------------------------------------------------------------------------------
PROGRESS: 91.0%
| epoch  92 |   100/  216 batches | lr 0.00000 | ms/batch 75.39 | loss  3.19 | ppl    24.27 
| epoch  92 |   200/  216 batches | lr 0.00000 | ms/batch 74.85 | loss  3.15 | ppl    23.26 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 16.68s | valid loss  4.20 | valid ppl    66.38 | valid bpc    6.053
-----------------------------------------------------------------------------------------
PROGRESS: 92.0%
| epoch  93 |   100/  216 batches | lr 0.00000 | ms/batch 75.74 | loss  3.19 | ppl    24.35 
| epoch  93 |   200/  216 batches | lr 0.00000 | ms/batch 74.41 | loss  3.16 | ppl    23.57 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 16.68s | valid loss  4.20 | valid ppl    66.96 | valid bpc    6.065
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  216 batches | lr 0.00000 | ms/batch 75.76 | loss  3.17 | ppl    23.90 
| epoch  94 |   200/  216 batches | lr 0.00000 | ms/batch 74.44 | loss  3.17 | ppl    23.80 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 16.68s | valid loss  4.23 | valid ppl    68.82 | valid bpc    6.105
-----------------------------------------------------------------------------------------
PROGRESS: 94.0%
| epoch  95 |   100/  216 batches | lr 0.00000 | ms/batch 75.79 | loss  3.19 | ppl    24.41 
| epoch  95 |   200/  216 batches | lr 0.00000 | ms/batch 74.43 | loss  3.14 | ppl    23.07 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 16.68s | valid loss  4.20 | valid ppl    66.45 | valid bpc    6.054
-----------------------------------------------------------------------------------------
PROGRESS: 95.0%
| epoch  96 |   100/  216 batches | lr 0.00000 | ms/batch 75.50 | loss  3.18 | ppl    24.16 
| epoch  96 |   200/  216 batches | lr 0.00000 | ms/batch 74.68 | loss  3.16 | ppl    23.59 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 16.68s | valid loss  4.20 | valid ppl    66.38 | valid bpc    6.053
-----------------------------------------------------------------------------------------
PROGRESS: 96.0%
| epoch  97 |   100/  216 batches | lr 0.00000 | ms/batch 75.50 | loss  3.17 | ppl    23.88 
| epoch  97 |   200/  216 batches | lr 0.00000 | ms/batch 74.65 | loss  3.15 | ppl    23.30 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 16.68s | valid loss  4.20 | valid ppl    66.96 | valid bpc    6.065
-----------------------------------------------------------------------------------------
PROGRESS: 97.0%
| epoch  98 |   100/  216 batches | lr 0.00000 | ms/batch 75.79 | loss  3.16 | ppl    23.50 
| epoch  98 |   200/  216 batches | lr 0.00000 | ms/batch 74.33 | loss  3.19 | ppl    24.30 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 16.68s | valid loss  4.19 | valid ppl    66.34 | valid bpc    6.052
-----------------------------------------------------------------------------------------
PROGRESS: 98.0%
| epoch  99 |   100/  216 batches | lr 0.00000 | ms/batch 75.65 | loss  3.18 | ppl    24.03 
| epoch  99 |   200/  216 batches | lr 0.00000 | ms/batch 74.51 | loss  3.16 | ppl    23.56 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 16.68s | valid loss  4.17 | valid ppl    64.91 | valid bpc    6.020
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 99.0%
| epoch 100 |   100/  216 batches | lr 0.00000 | ms/batch 75.94 | loss  3.20 | ppl    24.62 
| epoch 100 |   200/  216 batches | lr 0.00000 | ms/batch 74.20 | loss  3.16 | ppl    23.62 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 16.68s | valid loss  4.19 | valid ppl    66.26 | valid bpc    6.050
-----------------------------------------------------------------------------------------
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  4.17 | test ppl    64.97 | test bpc    6.022
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.4764, Mean Reca: 0.6547, Mean F1: 0.5430
Counter({'NP': 10023, 'PP': 4231, 'VP': 3655, 'S': 3623, 'SBAR': 959, 'QP': 284, 'ADJP': 252, 'ADVP': 158, 'SINV': 150, 'PRN': 66, 'NX': 43, 'FRAG': 34, 'WHNP': 27, 'SQ': 13, 'NAC': 9, 'SBARQ': 9, 'UCP': 7, 'CONJP': 7, 'WHPP': 7, 'X': 3, 'WHADVP': 2, 'WHADJP': 1})
Counter({'NP': 14432, 'VP': 8130, 'S': 5620, 'PP': 5484, 'SBAR': 1796, 'ADJP': 649, 'QP': 490, 'ADVP': 286, 'SINV': 157, 'PRN': 128, 'NX': 95, 'FRAG': 42, 'WHNP': 37, 'UCP': 32, 'NAC': 30, 'WHPP': 25, 'CONJP': 21, 'SQ': 18, 'SBARQ': 10, 'WHADVP': 9, 'X': 6, 'WHADJP': 4, 'INTJ': 1})
SBAR: 0.5340
NP: 0.6945
VP: 0.4496
PP: 0.7715
ADJP: 0.3883
ADVP: 0.5524
5.037326715706112
-----------------------------------------------------------------------------------------
Dependency parsing performance:
Conll-U Style:
DDA: 0.078
UDA: 0.348
=========================================================================================
Loading dataset...
Loading dictionary...
Number of tokens:  10001
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer_in_parser', nhid=512, nlayers=8, front_layers=7, rear_layers=1, n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=3333, nonmono=5, cuda=True, log_interval=100, save='trained_models/structformer_in_parser_3333_71.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 38475557
Model architecture: StructFormer_In_Parser(
  (transformer_front): Transformer_Front(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(10001, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-6): 7 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
  (transformer_rear): Transformer_Rear(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(10001, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0): TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (output_layer): Linear(in_features=512, out_features=10001, bias=True)
  )
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  216 batches | lr 0.00030 | ms/batch 78.14 | loss  7.32 | ppl  1512.83 
| epoch   1 |   200/  216 batches | lr 0.00030 | ms/batch 73.55 | loss  6.89 | ppl   978.16 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 16.85s | valid loss  6.74 | valid ppl   841.62 | valid bpc    9.717
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  216 batches | lr 0.00030 | ms/batch 74.93 | loss  6.82 | ppl   912.10 
| epoch   2 |   200/  216 batches | lr 0.00030 | ms/batch 74.00 | loss  6.55 | ppl   701.70 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 16.55s | valid loss  6.33 | valid ppl   560.64 | valid bpc    9.131
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  216 batches | lr 0.00030 | ms/batch 75.05 | loss  6.34 | ppl   568.51 
| epoch   3 |   200/  216 batches | lr 0.00030 | ms/batch 74.57 | loss  6.07 | ppl   434.14 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 16.62s | valid loss  5.87 | valid ppl   353.19 | valid bpc    8.464
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  216 batches | lr 0.00030 | ms/batch 75.34 | loss  5.88 | ppl   357.62 
| epoch   4 |   200/  216 batches | lr 0.00030 | ms/batch 74.49 | loss  5.71 | ppl   301.96 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 16.64s | valid loss  5.58 | valid ppl   263.86 | valid bpc    8.044
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  216 batches | lr 0.00030 | ms/batch 75.32 | loss  5.60 | ppl   271.22 
| epoch   5 |   200/  216 batches | lr 0.00030 | ms/batch 74.51 | loss  5.43 | ppl   228.34 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 16.65s | valid loss  5.35 | valid ppl   210.79 | valid bpc    7.720
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  216 batches | lr 0.00030 | ms/batch 75.36 | loss  5.35 | ppl   209.60 
| epoch   6 |   200/  216 batches | lr 0.00030 | ms/batch 74.57 | loss  5.27 | ppl   194.27 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 16.66s | valid loss  5.24 | valid ppl   189.54 | valid bpc    7.566
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  216 batches | lr 0.00030 | ms/batch 75.81 | loss  5.20 | ppl   181.65 
| epoch   7 |   200/  216 batches | lr 0.00030 | ms/batch 74.24 | loss  5.13 | ppl   168.20 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 16.67s | valid loss  5.10 | valid ppl   163.80 | valid bpc    7.356
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  216 batches | lr 0.00030 | ms/batch 75.91 | loss  5.08 | ppl   161.57 
| epoch   8 |   200/  216 batches | lr 0.00030 | ms/batch 74.26 | loss  5.00 | ppl   147.83 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 16.68s | valid loss  5.00 | valid ppl   147.90 | valid bpc    7.209
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 8.0%
| epoch   9 |   100/  216 batches | lr 0.00030 | ms/batch 75.85 | loss  4.98 | ppl   145.07 
| epoch   9 |   200/  216 batches | lr 0.00030 | ms/batch 74.23 | loss  4.88 | ppl   131.52 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 16.68s | valid loss  4.95 | valid ppl   141.28 | valid bpc    7.142
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  216 batches | lr 0.00030 | ms/batch 75.75 | loss  4.87 | ppl   130.42 
| epoch  10 |   200/  216 batches | lr 0.00030 | ms/batch 74.45 | loss  4.81 | ppl   122.74 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 16.68s | valid loss  4.91 | valid ppl   135.47 | valid bpc    7.082
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  216 batches | lr 0.00030 | ms/batch 75.49 | loss  4.77 | ppl   118.22 
| epoch  11 |   200/  216 batches | lr 0.00030 | ms/batch 74.63 | loss  4.73 | ppl   113.81 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 16.68s | valid loss  4.81 | valid ppl   122.75 | valid bpc    6.940
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  216 batches | lr 0.00030 | ms/batch 75.61 | loss  4.68 | ppl   107.96 
| epoch  12 |   200/  216 batches | lr 0.00030 | ms/batch 74.56 | loss  4.62 | ppl   101.74 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 16.68s | valid loss  4.73 | valid ppl   113.40 | valid bpc    6.825
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 12.0%
| epoch  13 |   100/  216 batches | lr 0.00030 | ms/batch 76.00 | loss  4.60 | ppl    99.41 
| epoch  13 |   200/  216 batches | lr 0.00030 | ms/batch 74.21 | loss  4.57 | ppl    96.70 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 16.68s | valid loss  4.73 | valid ppl   113.14 | valid bpc    6.822
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 13.0%
| epoch  14 |   100/  216 batches | lr 0.00030 | ms/batch 75.98 | loss  4.53 | ppl    92.68 
| epoch  14 |   200/  216 batches | lr 0.00030 | ms/batch 74.25 | loss  4.48 | ppl    88.62 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 16.69s | valid loss  4.70 | valid ppl   109.68 | valid bpc    6.777
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  216 batches | lr 0.00030 | ms/batch 75.60 | loss  4.43 | ppl    84.25 
| epoch  15 |   200/  216 batches | lr 0.00030 | ms/batch 74.51 | loss  4.42 | ppl    83.43 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 16.68s | valid loss  4.63 | valid ppl   102.98 | valid bpc    6.686
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 15.0%
| epoch  16 |   100/  216 batches | lr 0.00030 | ms/batch 75.76 | loss  4.38 | ppl    79.55 
| epoch  16 |   200/  216 batches | lr 0.00030 | ms/batch 74.41 | loss  4.36 | ppl    77.97 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 16.68s | valid loss  4.57 | valid ppl    96.07 | valid bpc    6.586
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 16.0%
| epoch  17 |   100/  216 batches | lr 0.00030 | ms/batch 75.84 | loss  4.33 | ppl    75.84 
| epoch  17 |   200/  216 batches | lr 0.00030 | ms/batch 74.43 | loss  4.30 | ppl    73.82 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 16.68s | valid loss  4.53 | valid ppl    93.15 | valid bpc    6.542
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 17.0%
| epoch  18 |   100/  216 batches | lr 0.00030 | ms/batch 75.80 | loss  4.25 | ppl    69.88 
| epoch  18 |   200/  216 batches | lr 0.00030 | ms/batch 74.45 | loss  4.23 | ppl    68.71 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 16.68s | valid loss  4.49 | valid ppl    88.80 | valid bpc    6.473
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 18.0%
| epoch  19 |   100/  216 batches | lr 0.00030 | ms/batch 75.92 | loss  4.23 | ppl    68.52 
| epoch  19 |   200/  216 batches | lr 0.00030 | ms/batch 74.34 | loss  4.14 | ppl    62.61 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 16.69s | valid loss  4.49 | valid ppl    88.87 | valid bpc    6.474
-----------------------------------------------------------------------------------------
PROGRESS: 19.0%
| epoch  20 |   100/  216 batches | lr 0.00030 | ms/batch 75.64 | loss  4.14 | ppl    62.62 
| epoch  20 |   200/  216 batches | lr 0.00030 | ms/batch 74.61 | loss  4.13 | ppl    62.19 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 16.68s | valid loss  4.51 | valid ppl    90.91 | valid bpc    6.506
-----------------------------------------------------------------------------------------
PROGRESS: 20.0%
| epoch  21 |   100/  216 batches | lr 0.00030 | ms/batch 75.66 | loss  4.08 | ppl    59.33 
| epoch  21 |   200/  216 batches | lr 0.00030 | ms/batch 74.63 | loss  4.08 | ppl    59.43 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 16.69s | valid loss  4.47 | valid ppl    87.31 | valid bpc    6.448
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 21.0%
| epoch  22 |   100/  216 batches | lr 0.00030 | ms/batch 75.63 | loss  4.06 | ppl    58.21 
| epoch  22 |   200/  216 batches | lr 0.00030 | ms/batch 74.57 | loss  4.01 | ppl    55.16 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 16.68s | valid loss  4.45 | valid ppl    86.03 | valid bpc    6.427
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 22.0%
| epoch  23 |   100/  216 batches | lr 0.00030 | ms/batch 75.99 | loss  3.99 | ppl    53.87 
| epoch  23 |   200/  216 batches | lr 0.00030 | ms/batch 74.18 | loss  3.97 | ppl    53.08 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 16.68s | valid loss  4.38 | valid ppl    79.84 | valid bpc    6.319
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 23.0%
| epoch  24 |   100/  216 batches | lr 0.00030 | ms/batch 75.63 | loss  3.95 | ppl    52.15 
| epoch  24 |   200/  216 batches | lr 0.00030 | ms/batch 74.55 | loss  3.92 | ppl    50.40 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 16.68s | valid loss  4.41 | valid ppl    82.21 | valid bpc    6.361
-----------------------------------------------------------------------------------------
PROGRESS: 24.0%
| epoch  25 |   100/  216 batches | lr 0.00030 | ms/batch 75.66 | loss  3.91 | ppl    50.04 
| epoch  25 |   200/  216 batches | lr 0.00030 | ms/batch 74.53 | loss  3.86 | ppl    47.41 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 16.68s | valid loss  4.41 | valid ppl    81.92 | valid bpc    6.356
-----------------------------------------------------------------------------------------
PROGRESS: 25.0%
| epoch  26 |   100/  216 batches | lr 0.00030 | ms/batch 75.47 | loss  3.85 | ppl    46.89 
| epoch  26 |   200/  216 batches | lr 0.00030 | ms/batch 74.74 | loss  3.82 | ppl    45.60 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 16.68s | valid loss  4.35 | valid ppl    77.75 | valid bpc    6.281
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 26.0%
| epoch  27 |   100/  216 batches | lr 0.00030 | ms/batch 75.94 | loss  3.83 | ppl    45.95 
| epoch  27 |   200/  216 batches | lr 0.00030 | ms/batch 74.23 | loss  3.77 | ppl    43.45 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 16.68s | valid loss  4.36 | valid ppl    78.47 | valid bpc    6.294
-----------------------------------------------------------------------------------------
PROGRESS: 27.0%
| epoch  28 |   100/  216 batches | lr 0.00030 | ms/batch 75.52 | loss  3.78 | ppl    43.87 
| epoch  28 |   200/  216 batches | lr 0.00030 | ms/batch 74.30 | loss  3.75 | ppl    42.37 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 16.68s | valid loss  4.39 | valid ppl    81.01 | valid bpc    6.340
-----------------------------------------------------------------------------------------
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  216 batches | lr 0.00030 | ms/batch 76.03 | loss  3.73 | ppl    41.57 
| epoch  29 |   200/  216 batches | lr 0.00030 | ms/batch 74.18 | loss  3.72 | ppl    41.35 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 16.69s | valid loss  4.35 | valid ppl    77.12 | valid bpc    6.269
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  216 batches | lr 0.00030 | ms/batch 75.62 | loss  3.72 | ppl    41.33 
| epoch  30 |   200/  216 batches | lr 0.00030 | ms/batch 74.62 | loss  3.66 | ppl    38.95 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 16.68s | valid loss  4.33 | valid ppl    75.61 | valid bpc    6.241
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 30.0%
| epoch  31 |   100/  216 batches | lr 0.00030 | ms/batch 75.39 | loss  3.67 | ppl    39.08 
| epoch  31 |   200/  216 batches | lr 0.00030 | ms/batch 74.52 | loss  3.63 | ppl    37.81 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 16.68s | valid loss  4.33 | valid ppl    76.04 | valid bpc    6.249
-----------------------------------------------------------------------------------------
PROGRESS: 31.0%
| epoch  32 |   100/  216 batches | lr 0.00030 | ms/batch 75.62 | loss  3.62 | ppl    37.47 
| epoch  32 |   200/  216 batches | lr 0.00030 | ms/batch 74.63 | loss  3.59 | ppl    36.17 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 16.68s | valid loss  4.30 | valid ppl    73.76 | valid bpc    6.205
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 32.0%
| epoch  33 |   100/  216 batches | lr 0.00030 | ms/batch 75.82 | loss  3.57 | ppl    35.49 
| epoch  33 |   200/  216 batches | lr 0.00030 | ms/batch 74.32 | loss  3.57 | ppl    35.57 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 16.68s | valid loss  4.32 | valid ppl    75.20 | valid bpc    6.233
-----------------------------------------------------------------------------------------
PROGRESS: 33.0%
| epoch  34 |   100/  216 batches | lr 0.00030 | ms/batch 75.85 | loss  3.51 | ppl    33.52 
| epoch  34 |   200/  216 batches | lr 0.00030 | ms/batch 74.19 | loss  3.54 | ppl    34.61 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 16.68s | valid loss  4.27 | valid ppl    71.60 | valid bpc    6.162
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 34.0%
| epoch  35 |   100/  216 batches | lr 0.00030 | ms/batch 75.41 | loss  3.52 | ppl    33.62 
| epoch  35 |   200/  216 batches | lr 0.00030 | ms/batch 74.78 | loss  3.49 | ppl    32.64 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 16.68s | valid loss  4.24 | valid ppl    69.11 | valid bpc    6.111
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 35.0%
| epoch  36 |   100/  216 batches | lr 0.00030 | ms/batch 75.63 | loss  3.46 | ppl    31.82 
| epoch  36 |   200/  216 batches | lr 0.00030 | ms/batch 74.49 | loss  3.47 | ppl    32.19 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 16.68s | valid loss  4.30 | valid ppl    74.01 | valid bpc    6.210
-----------------------------------------------------------------------------------------
PROGRESS: 36.0%
| epoch  37 |   100/  216 batches | lr 0.00030 | ms/batch 75.40 | loss  3.44 | ppl    31.33 
| epoch  37 |   200/  216 batches | lr 0.00030 | ms/batch 74.84 | loss  3.42 | ppl    30.58 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 16.68s | valid loss  4.31 | valid ppl    74.51 | valid bpc    6.219
-----------------------------------------------------------------------------------------
PROGRESS: 37.0%
| epoch  38 |   100/  216 batches | lr 0.00030 | ms/batch 75.49 | loss  3.39 | ppl    29.62 
| epoch  38 |   200/  216 batches | lr 0.00030 | ms/batch 74.73 | loss  3.40 | ppl    30.05 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 16.69s | valid loss  4.28 | valid ppl    72.57 | valid bpc    6.181
-----------------------------------------------------------------------------------------
PROGRESS: 38.0%
| epoch  39 |   100/  216 batches | lr 0.00015 | ms/batch 75.72 | loss  3.32 | ppl    27.66 
| epoch  39 |   200/  216 batches | lr 0.00015 | ms/batch 74.47 | loss  3.25 | ppl    25.88 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 16.69s | valid loss  4.26 | valid ppl    70.87 | valid bpc    6.147
-----------------------------------------------------------------------------------------
PROGRESS: 39.0%
| epoch  40 |   100/  216 batches | lr 0.00015 | ms/batch 75.29 | loss  3.27 | ppl    26.34 
| epoch  40 |   200/  216 batches | lr 0.00015 | ms/batch 74.50 | loss  3.22 | ppl    25.12 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 16.68s | valid loss  4.27 | valid ppl    71.34 | valid bpc    6.157
-----------------------------------------------------------------------------------------
PROGRESS: 40.0%
| epoch  41 |   100/  216 batches | lr 0.00015 | ms/batch 75.41 | loss  3.23 | ppl    25.16 
| epoch  41 |   200/  216 batches | lr 0.00015 | ms/batch 74.89 | loss  3.20 | ppl    24.52 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 16.69s | valid loss  4.27 | valid ppl    71.26 | valid bpc    6.155
-----------------------------------------------------------------------------------------
PROGRESS: 41.0%
| epoch  42 |   100/  216 batches | lr 0.00007 | ms/batch 75.33 | loss  3.17 | ppl    23.85 
| epoch  42 |   200/  216 batches | lr 0.00007 | ms/batch 74.83 | loss  3.15 | ppl    23.30 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 16.68s | valid loss  4.28 | valid ppl    72.15 | valid bpc    6.173
-----------------------------------------------------------------------------------------
PROGRESS: 42.0%
| epoch  43 |   100/  216 batches | lr 0.00007 | ms/batch 75.56 | loss  3.14 | ppl    23.18 
| epoch  43 |   200/  216 batches | lr 0.00007 | ms/batch 74.72 | loss  3.12 | ppl    22.54 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 16.69s | valid loss  4.25 | valid ppl    70.04 | valid bpc    6.130
-----------------------------------------------------------------------------------------
PROGRESS: 43.0%
| epoch  44 |   100/  216 batches | lr 0.00007 | ms/batch 75.95 | loss  3.14 | ppl    22.99 
| epoch  44 |   200/  216 batches | lr 0.00007 | ms/batch 74.26 | loss  3.10 | ppl    22.22 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 16.69s | valid loss  4.24 | valid ppl    69.73 | valid bpc    6.124
-----------------------------------------------------------------------------------------
PROGRESS: 44.0%
| epoch  45 |   100/  216 batches | lr 0.00004 | ms/batch 75.95 | loss  3.13 | ppl    22.89 
| epoch  45 |   200/  216 batches | lr 0.00004 | ms/batch 74.21 | loss  3.06 | ppl    21.42 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 16.69s | valid loss  4.27 | valid ppl    71.52 | valid bpc    6.160
-----------------------------------------------------------------------------------------
PROGRESS: 45.0%
| epoch  46 |   100/  216 batches | lr 0.00004 | ms/batch 75.77 | loss  3.08 | ppl    21.65 
| epoch  46 |   200/  216 batches | lr 0.00004 | ms/batch 74.47 | loss  3.05 | ppl    21.11 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 16.69s | valid loss  4.26 | valid ppl    70.89 | valid bpc    6.148
-----------------------------------------------------------------------------------------
PROGRESS: 46.0%
| epoch  47 |   100/  216 batches | lr 0.00004 | ms/batch 75.52 | loss  3.09 | ppl    22.02 
| epoch  47 |   200/  216 batches | lr 0.00004 | ms/batch 74.73 | loss  3.05 | ppl    21.12 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 16.69s | valid loss  4.23 | valid ppl    68.81 | valid bpc    6.104
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 47.0%
| epoch  48 |   100/  216 batches | lr 0.00004 | ms/batch 75.47 | loss  3.07 | ppl    21.52 
| epoch  48 |   200/  216 batches | lr 0.00004 | ms/batch 74.73 | loss  3.02 | ppl    20.59 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 16.68s | valid loss  4.19 | valid ppl    66.11 | valid bpc    6.047
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 48.0%
| epoch  49 |   100/  216 batches | lr 0.00004 | ms/batch 75.41 | loss  3.06 | ppl    21.34 
| epoch  49 |   200/  216 batches | lr 0.00004 | ms/batch 74.75 | loss  3.04 | ppl    20.82 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 16.68s | valid loss  4.27 | valid ppl    71.31 | valid bpc    6.156
-----------------------------------------------------------------------------------------
PROGRESS: 49.0%
| epoch  50 |   100/  216 batches | lr 0.00004 | ms/batch 75.91 | loss  3.05 | ppl    21.03 
| epoch  50 |   200/  216 batches | lr 0.00004 | ms/batch 74.16 | loss  3.03 | ppl    20.75 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 16.68s | valid loss  4.25 | valid ppl    69.88 | valid bpc    6.127
-----------------------------------------------------------------------------------------
PROGRESS: 50.0%
| epoch  51 |   100/  216 batches | lr 0.00004 | ms/batch 75.41 | loss  3.02 | ppl    20.53 
| epoch  51 |   200/  216 batches | lr 0.00004 | ms/batch 74.42 | loss  3.01 | ppl    20.21 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 16.68s | valid loss  4.21 | valid ppl    67.28 | valid bpc    6.072
-----------------------------------------------------------------------------------------
PROGRESS: 51.0%
| epoch  52 |   100/  216 batches | lr 0.00002 | ms/batch 75.62 | loss  3.02 | ppl    20.56 
| epoch  52 |   200/  216 batches | lr 0.00002 | ms/batch 74.59 | loss  3.00 | ppl    20.17 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 16.68s | valid loss  4.23 | valid ppl    68.90 | valid bpc    6.106
-----------------------------------------------------------------------------------------
PROGRESS: 52.0%
| epoch  53 |   100/  216 batches | lr 0.00002 | ms/batch 75.81 | loss  3.03 | ppl    20.76 
| epoch  53 |   200/  216 batches | lr 0.00002 | ms/batch 74.34 | loss  2.96 | ppl    19.34 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 16.68s | valid loss  4.22 | valid ppl    67.79 | valid bpc    6.083
-----------------------------------------------------------------------------------------
PROGRESS: 53.0%
| epoch  54 |   100/  216 batches | lr 0.00002 | ms/batch 75.60 | loss  3.03 | ppl    20.74 
| epoch  54 |   200/  216 batches | lr 0.00002 | ms/batch 74.61 | loss  2.99 | ppl    19.80 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 16.69s | valid loss  4.23 | valid ppl    68.82 | valid bpc    6.105
-----------------------------------------------------------------------------------------
PROGRESS: 54.0%
| epoch  55 |   100/  216 batches | lr 0.00001 | ms/batch 76.15 | loss  3.01 | ppl    20.21 
| epoch  55 |   200/  216 batches | lr 0.00001 | ms/batch 74.18 | loss  2.99 | ppl    19.89 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 16.69s | valid loss  4.27 | valid ppl    71.38 | valid bpc    6.157
-----------------------------------------------------------------------------------------
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  216 batches | lr 0.00001 | ms/batch 75.91 | loss  3.01 | ppl    20.24 
| epoch  56 |   200/  216 batches | lr 0.00001 | ms/batch 74.39 | loss  2.98 | ppl    19.73 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 16.69s | valid loss  4.25 | valid ppl    70.06 | valid bpc    6.131
-----------------------------------------------------------------------------------------
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  216 batches | lr 0.00001 | ms/batch 75.47 | loss  2.98 | ppl    19.76 
| epoch  57 |   200/  216 batches | lr 0.00001 | ms/batch 74.83 | loss  2.98 | ppl    19.60 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 16.69s | valid loss  4.19 | valid ppl    66.27 | valid bpc    6.050
-----------------------------------------------------------------------------------------
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  216 batches | lr 0.00000 | ms/batch 75.59 | loss  3.00 | ppl    20.05 
| epoch  58 |   200/  216 batches | lr 0.00000 | ms/batch 74.71 | loss  2.96 | ppl    19.24 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 16.69s | valid loss  4.20 | valid ppl    66.94 | valid bpc    6.065
-----------------------------------------------------------------------------------------
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  216 batches | lr 0.00000 | ms/batch 75.36 | loss  3.00 | ppl    20.13 
| epoch  59 |   200/  216 batches | lr 0.00000 | ms/batch 74.68 | loss  2.97 | ppl    19.45 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 16.68s | valid loss  4.21 | valid ppl    67.33 | valid bpc    6.073
-----------------------------------------------------------------------------------------
PROGRESS: 59.0%
| epoch  60 |   100/  216 batches | lr 0.00000 | ms/batch 75.49 | loss  2.99 | ppl    19.85 
| epoch  60 |   200/  216 batches | lr 0.00000 | ms/batch 74.60 | loss  2.97 | ppl    19.54 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 16.68s | valid loss  4.22 | valid ppl    67.83 | valid bpc    6.084
-----------------------------------------------------------------------------------------
PROGRESS: 60.0%
| epoch  61 |   100/  216 batches | lr 0.00000 | ms/batch 75.81 | loss  2.99 | ppl    19.90 
| epoch  61 |   200/  216 batches | lr 0.00000 | ms/batch 74.27 | loss  2.97 | ppl    19.52 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 16.68s | valid loss  4.27 | valid ppl    71.48 | valid bpc    6.160
-----------------------------------------------------------------------------------------
PROGRESS: 61.0%
| epoch  62 |   100/  216 batches | lr 0.00000 | ms/batch 75.85 | loss  2.99 | ppl    19.94 
| epoch  62 |   200/  216 batches | lr 0.00000 | ms/batch 74.38 | loss  2.95 | ppl    19.12 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 16.68s | valid loss  4.20 | valid ppl    67.00 | valid bpc    6.066
-----------------------------------------------------------------------------------------
PROGRESS: 62.0%
| epoch  63 |   100/  216 batches | lr 0.00000 | ms/batch 75.81 | loss  3.00 | ppl    20.12 
| epoch  63 |   200/  216 batches | lr 0.00000 | ms/batch 74.36 | loss  2.95 | ppl    19.07 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 16.68s | valid loss  4.23 | valid ppl    68.38 | valid bpc    6.095
-----------------------------------------------------------------------------------------
PROGRESS: 63.0%
| epoch  64 |   100/  216 batches | lr 0.00000 | ms/batch 75.72 | loss  3.02 | ppl    20.39 
| epoch  64 |   200/  216 batches | lr 0.00000 | ms/batch 74.35 | loss  2.96 | ppl    19.21 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 16.67s | valid loss  4.17 | valid ppl    64.65 | valid bpc    6.014
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 64.0%
| epoch  65 |   100/  216 batches | lr 0.00000 | ms/batch 75.46 | loss  2.98 | ppl    19.64 
| epoch  65 |   200/  216 batches | lr 0.00000 | ms/batch 74.31 | loss  2.96 | ppl    19.27 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 16.67s | valid loss  4.22 | valid ppl    67.79 | valid bpc    6.083
-----------------------------------------------------------------------------------------
PROGRESS: 65.0%
| epoch  66 |   100/  216 batches | lr 0.00000 | ms/batch 75.83 | loss  2.98 | ppl    19.63 
| epoch  66 |   200/  216 batches | lr 0.00000 | ms/batch 74.43 | loss  2.96 | ppl    19.24 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 16.68s | valid loss  4.20 | valid ppl    67.00 | valid bpc    6.066
-----------------------------------------------------------------------------------------
PROGRESS: 66.0%
| epoch  67 |   100/  216 batches | lr 0.00000 | ms/batch 75.52 | loss  2.98 | ppl    19.61 
| epoch  67 |   200/  216 batches | lr 0.00000 | ms/batch 74.54 | loss  2.96 | ppl    19.36 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 16.67s | valid loss  4.19 | valid ppl    66.28 | valid bpc    6.050
-----------------------------------------------------------------------------------------
PROGRESS: 67.0%
| epoch  68 |   100/  216 batches | lr 0.00000 | ms/batch 75.82 | loss  3.00 | ppl    20.13 
| epoch  68 |   200/  216 batches | lr 0.00000 | ms/batch 74.27 | loss  2.97 | ppl    19.47 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 16.68s | valid loss  4.24 | valid ppl    69.07 | valid bpc    6.110
-----------------------------------------------------------------------------------------
PROGRESS: 68.0%
| epoch  69 |   100/  216 batches | lr 0.00000 | ms/batch 75.41 | loss  3.00 | ppl    20.08 
| epoch  69 |   200/  216 batches | lr 0.00000 | ms/batch 74.76 | loss  2.96 | ppl    19.28 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 16.68s | valid loss  4.24 | valid ppl    69.40 | valid bpc    6.117
-----------------------------------------------------------------------------------------
PROGRESS: 69.0%
| epoch  70 |   100/  216 batches | lr 0.00000 | ms/batch 75.61 | loss  2.97 | ppl    19.47 
| epoch  70 |   200/  216 batches | lr 0.00000 | ms/batch 74.58 | loss  2.97 | ppl    19.44 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 16.69s | valid loss  4.24 | valid ppl    69.57 | valid bpc    6.120
-----------------------------------------------------------------------------------------
PROGRESS: 70.0%
| epoch  71 |   100/  216 batches | lr 0.00000 | ms/batch 75.51 | loss  2.99 | ppl    19.94 
| epoch  71 |   200/  216 batches | lr 0.00000 | ms/batch 74.35 | loss  2.94 | ppl    18.84 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 16.68s | valid loss  4.26 | valid ppl    71.12 | valid bpc    6.152
-----------------------------------------------------------------------------------------
PROGRESS: 71.0%
| epoch  72 |   100/  216 batches | lr 0.00000 | ms/batch 75.42 | loss  3.00 | ppl    19.99 
| epoch  72 |   200/  216 batches | lr 0.00000 | ms/batch 74.48 | loss  2.97 | ppl    19.42 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 16.68s | valid loss  4.27 | valid ppl    71.77 | valid bpc    6.165
-----------------------------------------------------------------------------------------
PROGRESS: 72.0%
| epoch  73 |   100/  216 batches | lr 0.00000 | ms/batch 75.86 | loss  2.99 | ppl    19.81 
| epoch  73 |   200/  216 batches | lr 0.00000 | ms/batch 74.41 | loss  2.97 | ppl    19.47 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 16.68s | valid loss  4.22 | valid ppl    67.71 | valid bpc    6.081
-----------------------------------------------------------------------------------------
PROGRESS: 73.0%
| epoch  74 |   100/  216 batches | lr 0.00000 | ms/batch 75.50 | loss  2.99 | ppl    19.93 
| epoch  74 |   200/  216 batches | lr 0.00000 | ms/batch 74.76 | loss  2.94 | ppl    18.94 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 16.69s | valid loss  4.20 | valid ppl    66.97 | valid bpc    6.066
-----------------------------------------------------------------------------------------
PROGRESS: 74.0%
| epoch  75 |   100/  216 batches | lr 0.00000 | ms/batch 75.89 | loss  3.00 | ppl    20.03 
| epoch  75 |   200/  216 batches | lr 0.00000 | ms/batch 74.34 | loss  2.96 | ppl    19.25 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 16.69s | valid loss  4.24 | valid ppl    69.46 | valid bpc    6.118
-----------------------------------------------------------------------------------------
PROGRESS: 75.0%
| epoch  76 |   100/  216 batches | lr 0.00000 | ms/batch 75.42 | loss  2.98 | ppl    19.65 
| epoch  76 |   200/  216 batches | lr 0.00000 | ms/batch 74.88 | loss  2.96 | ppl    19.37 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 16.69s | valid loss  4.21 | valid ppl    67.10 | valid bpc    6.068
-----------------------------------------------------------------------------------------
PROGRESS: 76.0%
| epoch  77 |   100/  216 batches | lr 0.00000 | ms/batch 75.94 | loss  3.00 | ppl    20.14 
| epoch  77 |   200/  216 batches | lr 0.00000 | ms/batch 74.33 | loss  2.95 | ppl    19.14 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 16.69s | valid loss  4.20 | valid ppl    66.74 | valid bpc    6.061
-----------------------------------------------------------------------------------------
PROGRESS: 77.0%
| epoch  78 |   100/  216 batches | lr 0.00000 | ms/batch 75.68 | loss  2.98 | ppl    19.65 
| epoch  78 |   200/  216 batches | lr 0.00000 | ms/batch 74.61 | loss  2.97 | ppl    19.56 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 16.69s | valid loss  4.25 | valid ppl    69.90 | valid bpc    6.127
-----------------------------------------------------------------------------------------
PROGRESS: 78.0%
| epoch  79 |   100/  216 batches | lr 0.00000 | ms/batch 75.81 | loss  3.00 | ppl    20.16 
| epoch  79 |   200/  216 batches | lr 0.00000 | ms/batch 74.44 | loss  2.95 | ppl    19.09 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 16.69s | valid loss  4.23 | valid ppl    68.66 | valid bpc    6.101
-----------------------------------------------------------------------------------------
PROGRESS: 79.0%
| epoch  80 |   100/  216 batches | lr 0.00000 | ms/batch 76.10 | loss  2.99 | ppl    19.81 
| epoch  80 |   200/  216 batches | lr 0.00000 | ms/batch 74.14 | loss  2.96 | ppl    19.39 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 16.68s | valid loss  4.21 | valid ppl    67.31 | valid bpc    6.073
-----------------------------------------------------------------------------------------
PROGRESS: 80.0%
| epoch  81 |   100/  216 batches | lr 0.00000 | ms/batch 75.41 | loss  2.99 | ppl    19.82 
| epoch  81 |   200/  216 batches | lr 0.00000 | ms/batch 74.81 | loss  2.98 | ppl    19.60 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 16.69s | valid loss  4.26 | valid ppl    70.73 | valid bpc    6.144
-----------------------------------------------------------------------------------------
PROGRESS: 81.0%
| epoch  82 |   100/  216 batches | lr 0.00000 | ms/batch 75.82 | loss  3.00 | ppl    20.16 
| epoch  82 |   200/  216 batches | lr 0.00000 | ms/batch 74.44 | loss  2.94 | ppl    18.96 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 16.69s | valid loss  4.25 | valid ppl    70.30 | valid bpc    6.135
-----------------------------------------------------------------------------------------
PROGRESS: 82.0%
| epoch  83 |   100/  216 batches | lr 0.00000 | ms/batch 75.47 | loss  2.98 | ppl    19.70 
| epoch  83 |   200/  216 batches | lr 0.00000 | ms/batch 74.43 | loss  2.95 | ppl    19.05 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 16.69s | valid loss  4.21 | valid ppl    67.31 | valid bpc    6.073
-----------------------------------------------------------------------------------------
PROGRESS: 83.0%
| epoch  84 |   100/  216 batches | lr 0.00000 | ms/batch 75.39 | loss  3.00 | ppl    20.06 
| epoch  84 |   200/  216 batches | lr 0.00000 | ms/batch 74.53 | loss  2.95 | ppl    19.03 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 16.69s | valid loss  4.25 | valid ppl    70.17 | valid bpc    6.133
-----------------------------------------------------------------------------------------
PROGRESS: 84.0%
| epoch  85 |   100/  216 batches | lr 0.00000 | ms/batch 75.44 | loss  2.98 | ppl    19.65 
| epoch  85 |   200/  216 batches | lr 0.00000 | ms/batch 74.76 | loss  2.96 | ppl    19.25 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 16.69s | valid loss  4.26 | valid ppl    71.08 | valid bpc    6.151
-----------------------------------------------------------------------------------------
PROGRESS: 85.0%
| epoch  86 |   100/  216 batches | lr 0.00000 | ms/batch 75.91 | loss  2.98 | ppl    19.71 
| epoch  86 |   200/  216 batches | lr 0.00000 | ms/batch 74.39 | loss  2.95 | ppl    19.13 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 16.69s | valid loss  4.22 | valid ppl    67.90 | valid bpc    6.085
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  216 batches | lr 0.00000 | ms/batch 75.93 | loss  3.00 | ppl    20.17 
| epoch  87 |   200/  216 batches | lr 0.00000 | ms/batch 74.35 | loss  2.95 | ppl    19.19 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 16.69s | valid loss  4.21 | valid ppl    67.47 | valid bpc    6.076
-----------------------------------------------------------------------------------------
PROGRESS: 87.0%
| epoch  88 |   100/  216 batches | lr 0.00000 | ms/batch 75.71 | loss  2.99 | ppl    19.90 
| epoch  88 |   200/  216 batches | lr 0.00000 | ms/batch 74.45 | loss  2.93 | ppl    18.78 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 16.69s | valid loss  4.21 | valid ppl    67.57 | valid bpc    6.078
-----------------------------------------------------------------------------------------
PROGRESS: 88.0%
| epoch  89 |   100/  216 batches | lr 0.00000 | ms/batch 75.39 | loss  2.98 | ppl    19.75 
| epoch  89 |   200/  216 batches | lr 0.00000 | ms/batch 74.91 | loss  2.94 | ppl    18.92 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 16.69s | valid loss  4.26 | valid ppl    70.84 | valid bpc    6.146
-----------------------------------------------------------------------------------------
PROGRESS: 89.0%
| epoch  90 |   100/  216 batches | lr 0.00000 | ms/batch 75.50 | loss  2.99 | ppl    19.88 
| epoch  90 |   200/  216 batches | lr 0.00000 | ms/batch 74.81 | loss  2.97 | ppl    19.45 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 16.69s | valid loss  4.22 | valid ppl    68.11 | valid bpc    6.090
-----------------------------------------------------------------------------------------
PROGRESS: 90.0%
| epoch  91 |   100/  216 batches | lr 0.00000 | ms/batch 75.69 | loss  3.00 | ppl    20.18 
| epoch  91 |   200/  216 batches | lr 0.00000 | ms/batch 74.51 | loss  2.93 | ppl    18.78 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 16.69s | valid loss  4.22 | valid ppl    67.85 | valid bpc    6.084
-----------------------------------------------------------------------------------------
PROGRESS: 91.0%
| epoch  92 |   100/  216 batches | lr 0.00000 | ms/batch 75.36 | loss  2.97 | ppl    19.51 
| epoch  92 |   200/  216 batches | lr 0.00000 | ms/batch 74.66 | loss  2.95 | ppl    19.15 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 16.68s | valid loss  4.26 | valid ppl    70.69 | valid bpc    6.143
-----------------------------------------------------------------------------------------
PROGRESS: 92.0%
| epoch  93 |   100/  216 batches | lr 0.00000 | ms/batch 75.81 | loss  2.97 | ppl    19.41 
| epoch  93 |   200/  216 batches | lr 0.00000 | ms/batch 74.44 | loss  2.97 | ppl    19.44 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 16.69s | valid loss  4.20 | valid ppl    66.49 | valid bpc    6.055
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  216 batches | lr 0.00000 | ms/batch 75.33 | loss  2.98 | ppl    19.77 
| epoch  94 |   200/  216 batches | lr 0.00000 | ms/batch 74.95 | loss  2.96 | ppl    19.26 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 16.69s | valid loss  4.22 | valid ppl    68.04 | valid bpc    6.088
-----------------------------------------------------------------------------------------
PROGRESS: 94.0%
| epoch  95 |   100/  216 batches | lr 0.00000 | ms/batch 75.85 | loss  2.98 | ppl    19.74 
| epoch  95 |   200/  216 batches | lr 0.00000 | ms/batch 74.49 | loss  2.95 | ppl    19.03 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 16.69s | valid loss  4.17 | valid ppl    64.78 | valid bpc    6.017
-----------------------------------------------------------------------------------------
PROGRESS: 95.0%
| epoch  96 |   100/  216 batches | lr 0.00000 | ms/batch 75.62 | loss  2.98 | ppl    19.71 
| epoch  96 |   200/  216 batches | lr 0.00000 | ms/batch 74.71 | loss  2.95 | ppl    19.10 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 16.69s | valid loss  4.22 | valid ppl    67.84 | valid bpc    6.084
-----------------------------------------------------------------------------------------
PROGRESS: 96.0%
| epoch  97 |   100/  216 batches | lr 0.00000 | ms/batch 75.82 | loss  2.98 | ppl    19.63 
| epoch  97 |   200/  216 batches | lr 0.00000 | ms/batch 74.56 | loss  2.96 | ppl    19.38 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 16.69s | valid loss  4.23 | valid ppl    68.99 | valid bpc    6.108
-----------------------------------------------------------------------------------------
PROGRESS: 97.0%
| epoch  98 |   100/  216 batches | lr 0.00000 | ms/batch 76.15 | loss  2.96 | ppl    19.30 
| epoch  98 |   200/  216 batches | lr 0.00000 | ms/batch 74.20 | loss  2.98 | ppl    19.69 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 16.69s | valid loss  4.22 | valid ppl    68.07 | valid bpc    6.089
-----------------------------------------------------------------------------------------
PROGRESS: 98.0%
| epoch  99 |   100/  216 batches | lr 0.00000 | ms/batch 75.58 | loss  2.98 | ppl    19.60 
| epoch  99 |   200/  216 batches | lr 0.00000 | ms/batch 74.77 | loss  2.95 | ppl    19.12 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 16.69s | valid loss  4.22 | valid ppl    68.13 | valid bpc    6.090
-----------------------------------------------------------------------------------------
PROGRESS: 99.0%
| epoch 100 |   100/  216 batches | lr 0.00000 | ms/batch 75.79 | loss  2.99 | ppl    19.94 
| epoch 100 |   200/  216 batches | lr 0.00000 | ms/batch 74.54 | loss  2.96 | ppl    19.32 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 16.69s | valid loss  4.18 | valid ppl    65.11 | valid bpc    6.025
-----------------------------------------------------------------------------------------
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  4.15 | test ppl    63.61 | test bpc    5.991
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.4733, Mean Reca: 0.6510, Mean F1: 0.5397
Counter({'NP': 9586, 'PP': 4306, 'VP': 4038, 'S': 3592, 'SBAR': 880, 'QP': 281, 'ADJP': 248, 'ADVP': 158, 'SINV': 152, 'PRN': 62, 'NX': 39, 'FRAG': 33, 'WHNP': 26, 'SQ': 14, 'NAC': 12, 'UCP': 8, 'SBARQ': 8, 'WHPP': 4, 'X': 3, 'WHADVP': 2, 'CONJP': 2, 'WHADJP': 1})
Counter({'NP': 14432, 'VP': 8130, 'S': 5620, 'PP': 5484, 'SBAR': 1796, 'ADJP': 649, 'QP': 490, 'ADVP': 286, 'SINV': 157, 'PRN': 128, 'NX': 95, 'FRAG': 42, 'WHNP': 37, 'UCP': 32, 'NAC': 30, 'WHPP': 25, 'CONJP': 21, 'SQ': 18, 'SBARQ': 10, 'WHADVP': 9, 'X': 6, 'WHADJP': 4, 'INTJ': 1})
SBAR: 0.4900
NP: 0.6642
VP: 0.4967
PP: 0.7852
ADJP: 0.3821
ADVP: 0.5524
5.01122908802088
-----------------------------------------------------------------------------------------
Dependency parsing performance:
Conll-U Style:
DDA: 0.085
UDA: 0.346
=========================================================================================
Loading dataset...
Loading dictionary...
Number of tokens:  10001
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer_in_parser', nhid=512, nlayers=8, front_layers=7, rear_layers=1, n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=4444, nonmono=5, cuda=True, log_interval=100, save='trained_models/structformer_in_parser_4444_71.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 38475557
Model architecture: StructFormer_In_Parser(
  (transformer_front): Transformer_Front(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(10001, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-6): 7 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
  (transformer_rear): Transformer_Rear(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(10001, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0): TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (output_layer): Linear(in_features=512, out_features=10001, bias=True)
  )
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  216 batches | lr 0.00030 | ms/batch 78.59 | loss  7.28 | ppl  1452.39 
| epoch   1 |   200/  216 batches | lr 0.00030 | ms/batch 73.60 | loss  6.86 | ppl   955.39 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 16.85s | valid loss  6.68 | valid ppl   796.07 | valid bpc    9.637
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  216 batches | lr 0.00030 | ms/batch 74.77 | loss  6.73 | ppl   838.06 
| epoch   2 |   200/  216 batches | lr 0.00030 | ms/batch 74.32 | loss  6.45 | ppl   631.62 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 16.56s | valid loss  6.16 | valid ppl   472.66 | valid bpc    8.885
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  216 batches | lr 0.00030 | ms/batch 75.30 | loss  6.18 | ppl   484.10 
| epoch   3 |   200/  216 batches | lr 0.00030 | ms/batch 74.12 | loss  5.92 | ppl   373.72 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 16.60s | valid loss  5.75 | valid ppl   314.98 | valid bpc    8.299
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  216 batches | lr 0.00030 | ms/batch 75.28 | loss  5.75 | ppl   314.12 
| epoch   4 |   200/  216 batches | lr 0.00030 | ms/batch 74.47 | loss  5.62 | ppl   274.66 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 16.63s | valid loss  5.45 | valid ppl   231.90 | valid bpc    7.857
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  216 batches | lr 0.00030 | ms/batch 75.26 | loss  5.51 | ppl   246.00 
| epoch   5 |   200/  216 batches | lr 0.00030 | ms/batch 74.44 | loss  5.38 | ppl   217.20 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 16.64s | valid loss  5.30 | valid ppl   199.96 | valid bpc    7.644
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  216 batches | lr 0.00030 | ms/batch 75.38 | loss  5.31 | ppl   201.92 
| epoch   6 |   200/  216 batches | lr 0.00030 | ms/batch 74.18 | loss  5.23 | ppl   187.07 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 16.65s | valid loss  5.19 | valid ppl   179.88 | valid bpc    7.491
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  216 batches | lr 0.00030 | ms/batch 75.61 | loss  5.17 | ppl   175.99 
| epoch   7 |   200/  216 batches | lr 0.00030 | ms/batch 74.36 | loss  5.09 | ppl   162.40 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 16.66s | valid loss  5.08 | valid ppl   160.93 | valid bpc    7.330
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  216 batches | lr 0.00030 | ms/batch 75.73 | loss  5.07 | ppl   158.69 
| epoch   8 |   200/  216 batches | lr 0.00030 | ms/batch 74.32 | loss  4.95 | ppl   141.05 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 16.66s | valid loss  4.97 | valid ppl   144.21 | valid bpc    7.172
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 8.0%
| epoch   9 |   100/  216 batches | lr 0.00030 | ms/batch 75.71 | loss  4.93 | ppl   137.74 
| epoch   9 |   200/  216 batches | lr 0.00030 | ms/batch 74.37 | loss  4.90 | ppl   134.12 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 16.67s | valid loss  4.94 | valid ppl   139.79 | valid bpc    7.127
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  216 batches | lr 0.00030 | ms/batch 75.89 | loss  4.84 | ppl   126.81 
| epoch  10 |   200/  216 batches | lr 0.00030 | ms/batch 74.26 | loss  4.78 | ppl   119.22 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 16.67s | valid loss  4.90 | valid ppl   133.91 | valid bpc    7.065
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  216 batches | lr 0.00030 | ms/batch 75.73 | loss  4.76 | ppl   116.92 
| epoch  11 |   200/  216 batches | lr 0.00030 | ms/batch 74.27 | loss  4.68 | ppl   107.34 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 16.66s | valid loss  4.79 | valid ppl   120.35 | valid bpc    6.911
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  216 batches | lr 0.00030 | ms/batch 75.45 | loss  4.65 | ppl   104.79 
| epoch  12 |   200/  216 batches | lr 0.00030 | ms/batch 74.35 | loss  4.61 | ppl   100.96 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 16.67s | valid loss  4.75 | valid ppl   115.61 | valid bpc    6.853
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 12.0%
| epoch  13 |   100/  216 batches | lr 0.00030 | ms/batch 75.82 | loss  4.61 | ppl   100.12 
| epoch  13 |   200/  216 batches | lr 0.00030 | ms/batch 74.31 | loss  4.52 | ppl    91.91 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 16.67s | valid loss  4.71 | valid ppl   110.87 | valid bpc    6.793
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 13.0%
| epoch  14 |   100/  216 batches | lr 0.00030 | ms/batch 75.44 | loss  4.50 | ppl    90.07 
| epoch  14 |   200/  216 batches | lr 0.00030 | ms/batch 74.66 | loss  4.47 | ppl    87.19 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 16.67s | valid loss  4.67 | valid ppl   106.19 | valid bpc    6.731
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  216 batches | lr 0.00030 | ms/batch 75.93 | loss  4.43 | ppl    83.73 
| epoch  15 |   200/  216 batches | lr 0.00030 | ms/batch 74.29 | loss  4.40 | ppl    81.16 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 16.70s | valid loss  4.62 | valid ppl   101.63 | valid bpc    6.667
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 15.0%
| epoch  16 |   100/  216 batches | lr 0.00030 | ms/batch 76.00 | loss  4.39 | ppl    81.04 
| epoch  16 |   200/  216 batches | lr 0.00030 | ms/batch 74.26 | loss  4.32 | ppl    74.96 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 16.69s | valid loss  4.55 | valid ppl    94.63 | valid bpc    6.564
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 16.0%
| epoch  17 |   100/  216 batches | lr 0.00030 | ms/batch 75.86 | loss  4.30 | ppl    73.98 
| epoch  17 |   200/  216 batches | lr 0.00030 | ms/batch 74.35 | loss  4.28 | ppl    71.99 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 16.68s | valid loss  4.56 | valid ppl    95.44 | valid bpc    6.576
-----------------------------------------------------------------------------------------
PROGRESS: 17.0%
| epoch  18 |   100/  216 batches | lr 0.00030 | ms/batch 75.67 | loss  4.27 | ppl    71.78 
| epoch  18 |   200/  216 batches | lr 0.00030 | ms/batch 74.62 | loss  4.21 | ppl    67.51 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 16.68s | valid loss  4.51 | valid ppl    90.75 | valid bpc    6.504
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 18.0%
| epoch  19 |   100/  216 batches | lr 0.00030 | ms/batch 75.77 | loss  4.19 | ppl    66.27 
| epoch  19 |   200/  216 batches | lr 0.00030 | ms/batch 74.39 | loss  4.14 | ppl    63.09 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 16.67s | valid loss  4.51 | valid ppl    90.95 | valid bpc    6.507
-----------------------------------------------------------------------------------------
PROGRESS: 19.0%
| epoch  20 |   100/  216 batches | lr 0.00030 | ms/batch 75.61 | loss  4.13 | ppl    62.14 
| epoch  20 |   200/  216 batches | lr 0.00030 | ms/batch 74.56 | loss  4.12 | ppl    61.83 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 16.68s | valid loss  4.48 | valid ppl    87.86 | valid bpc    6.457
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 20.0%
| epoch  21 |   100/  216 batches | lr 0.00030 | ms/batch 75.95 | loss  4.09 | ppl    59.47 
| epoch  21 |   200/  216 batches | lr 0.00030 | ms/batch 74.27 | loss  4.05 | ppl    57.60 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 16.68s | valid loss  4.46 | valid ppl    86.10 | valid bpc    6.428
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 21.0%
| epoch  22 |   100/  216 batches | lr 0.00030 | ms/batch 75.53 | loss  4.03 | ppl    56.52 
| epoch  22 |   200/  216 batches | lr 0.00030 | ms/batch 74.60 | loss  4.01 | ppl    54.92 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 16.67s | valid loss  4.41 | valid ppl    82.34 | valid bpc    6.364
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 22.0%
| epoch  23 |   100/  216 batches | lr 0.00030 | ms/batch 75.60 | loss  3.97 | ppl    53.22 
| epoch  23 |   200/  216 batches | lr 0.00030 | ms/batch 74.47 | loss  3.98 | ppl    53.37 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 16.68s | valid loss  4.39 | valid ppl    80.98 | valid bpc    6.339
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 23.0%
| epoch  24 |   100/  216 batches | lr 0.00030 | ms/batch 75.56 | loss  3.94 | ppl    51.56 
| epoch  24 |   200/  216 batches | lr 0.00030 | ms/batch 74.64 | loss  3.94 | ppl    51.19 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 16.67s | valid loss  4.38 | valid ppl    79.85 | valid bpc    6.319
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 24.0%
| epoch  25 |   100/  216 batches | lr 0.00030 | ms/batch 75.90 | loss  3.90 | ppl    49.54 
| epoch  25 |   200/  216 batches | lr 0.00030 | ms/batch 74.16 | loss  3.87 | ppl    47.85 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 16.67s | valid loss  4.36 | valid ppl    78.19 | valid bpc    6.289
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 25.0%
| epoch  26 |   100/  216 batches | lr 0.00030 | ms/batch 75.50 | loss  3.86 | ppl    47.26 
| epoch  26 |   200/  216 batches | lr 0.00030 | ms/batch 74.59 | loss  3.84 | ppl    46.34 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 16.67s | valid loss  4.36 | valid ppl    78.42 | valid bpc    6.293
-----------------------------------------------------------------------------------------
PROGRESS: 26.0%
| epoch  27 |   100/  216 batches | lr 0.00030 | ms/batch 75.85 | loss  3.82 | ppl    45.79 
| epoch  27 |   200/  216 batches | lr 0.00030 | ms/batch 74.32 | loss  3.78 | ppl    43.72 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 16.67s | valid loss  4.33 | valid ppl    76.20 | valid bpc    6.252
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 27.0%
| epoch  28 |   100/  216 batches | lr 0.00030 | ms/batch 75.91 | loss  3.76 | ppl    42.87 
| epoch  28 |   200/  216 batches | lr 0.00030 | ms/batch 74.30 | loss  3.75 | ppl    42.37 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 16.68s | valid loss  4.35 | valid ppl    77.80 | valid bpc    6.282
-----------------------------------------------------------------------------------------
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  216 batches | lr 0.00030 | ms/batch 75.35 | loss  3.73 | ppl    41.56 
| epoch  29 |   200/  216 batches | lr 0.00030 | ms/batch 74.74 | loss  3.71 | ppl    40.72 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 16.67s | valid loss  4.36 | valid ppl    78.34 | valid bpc    6.292
-----------------------------------------------------------------------------------------
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  216 batches | lr 0.00030 | ms/batch 75.33 | loss  3.67 | ppl    39.30 
| epoch  30 |   200/  216 batches | lr 0.00030 | ms/batch 74.78 | loss  3.70 | ppl    40.31 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 16.67s | valid loss  4.27 | valid ppl    71.69 | valid bpc    6.164
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 30.0%
| epoch  31 |   100/  216 batches | lr 0.00030 | ms/batch 75.46 | loss  3.66 | ppl    38.80 
| epoch  31 |   200/  216 batches | lr 0.00030 | ms/batch 74.51 | loss  3.62 | ppl    37.28 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 16.67s | valid loss  4.36 | valid ppl    78.45 | valid bpc    6.294
-----------------------------------------------------------------------------------------
PROGRESS: 31.0%
| epoch  32 |   100/  216 batches | lr 0.00030 | ms/batch 75.47 | loss  3.60 | ppl    36.55 
| epoch  32 |   200/  216 batches | lr 0.00030 | ms/batch 74.43 | loss  3.60 | ppl    36.73 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 16.67s | valid loss  4.31 | valid ppl    74.62 | valid bpc    6.221
-----------------------------------------------------------------------------------------
PROGRESS: 32.0%
| epoch  33 |   100/  216 batches | lr 0.00030 | ms/batch 76.04 | loss  3.58 | ppl    35.82 
| epoch  33 |   200/  216 batches | lr 0.00030 | ms/batch 74.07 | loss  3.57 | ppl    35.51 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 16.67s | valid loss  4.31 | valid ppl    74.37 | valid bpc    6.217
-----------------------------------------------------------------------------------------
PROGRESS: 33.0%
| epoch  34 |   100/  216 batches | lr 0.00015 | ms/batch 75.50 | loss  3.49 | ppl    32.80 
| epoch  34 |   200/  216 batches | lr 0.00015 | ms/batch 74.61 | loss  3.44 | ppl    31.13 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 16.67s | valid loss  4.27 | valid ppl    71.23 | valid bpc    6.154
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 34.0%
| epoch  35 |   100/  216 batches | lr 0.00015 | ms/batch 75.80 | loss  3.43 | ppl    30.99 
| epoch  35 |   200/  216 batches | lr 0.00015 | ms/batch 74.38 | loss  3.41 | ppl    30.12 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 16.67s | valid loss  4.30 | valid ppl    73.62 | valid bpc    6.202
-----------------------------------------------------------------------------------------
PROGRESS: 35.0%
| epoch  36 |   100/  216 batches | lr 0.00015 | ms/batch 75.96 | loss  3.41 | ppl    30.19 
| epoch  36 |   200/  216 batches | lr 0.00015 | ms/batch 74.17 | loss  3.38 | ppl    29.25 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 16.67s | valid loss  4.24 | valid ppl    69.48 | valid bpc    6.119
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 36.0%
| epoch  37 |   100/  216 batches | lr 0.00015 | ms/batch 75.66 | loss  3.36 | ppl    28.87 
| epoch  37 |   200/  216 batches | lr 0.00015 | ms/batch 74.46 | loss  3.36 | ppl    28.88 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 16.67s | valid loss  4.26 | valid ppl    71.07 | valid bpc    6.151
-----------------------------------------------------------------------------------------
PROGRESS: 37.0%
| epoch  38 |   100/  216 batches | lr 0.00015 | ms/batch 75.58 | loss  3.34 | ppl    28.13 
| epoch  38 |   200/  216 batches | lr 0.00015 | ms/batch 74.55 | loss  3.32 | ppl    27.62 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 16.67s | valid loss  4.24 | valid ppl    69.57 | valid bpc    6.120
-----------------------------------------------------------------------------------------
PROGRESS: 38.0%
| epoch  39 |   100/  216 batches | lr 0.00015 | ms/batch 75.82 | loss  3.31 | ppl    27.28 
| epoch  39 |   200/  216 batches | lr 0.00015 | ms/batch 74.33 | loss  3.30 | ppl    27.19 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 16.67s | valid loss  4.21 | valid ppl    67.57 | valid bpc    6.078
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 39.0%
| epoch  40 |   100/  216 batches | lr 0.00015 | ms/batch 75.37 | loss  3.30 | ppl    27.01 
| epoch  40 |   200/  216 batches | lr 0.00015 | ms/batch 74.53 | loss  3.28 | ppl    26.45 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 16.66s | valid loss  4.28 | valid ppl    72.40 | valid bpc    6.178
-----------------------------------------------------------------------------------------
PROGRESS: 40.0%
| epoch  41 |   100/  216 batches | lr 0.00015 | ms/batch 75.78 | loss  3.27 | ppl    26.35 
| epoch  41 |   200/  216 batches | lr 0.00015 | ms/batch 74.36 | loss  3.27 | ppl    26.39 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 16.66s | valid loss  4.26 | valid ppl    70.79 | valid bpc    6.146
-----------------------------------------------------------------------------------------
PROGRESS: 41.0%
| epoch  42 |   100/  216 batches | lr 0.00015 | ms/batch 75.84 | loss  3.26 | ppl    26.07 
| epoch  42 |   200/  216 batches | lr 0.00015 | ms/batch 74.28 | loss  3.23 | ppl    25.38 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 16.67s | valid loss  4.27 | valid ppl    71.65 | valid bpc    6.163
-----------------------------------------------------------------------------------------
PROGRESS: 42.0%
| epoch  43 |   100/  216 batches | lr 0.00007 | ms/batch 75.92 | loss  3.20 | ppl    24.61 
| epoch  43 |   200/  216 batches | lr 0.00007 | ms/batch 74.15 | loss  3.17 | ppl    23.83 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 16.66s | valid loss  4.21 | valid ppl    67.62 | valid bpc    6.079
-----------------------------------------------------------------------------------------
PROGRESS: 43.0%
| epoch  44 |   100/  216 batches | lr 0.00007 | ms/batch 75.43 | loss  3.16 | ppl    23.66 
| epoch  44 |   200/  216 batches | lr 0.00007 | ms/batch 74.57 | loss  3.17 | ppl    23.74 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 16.67s | valid loss  4.21 | valid ppl    67.51 | valid bpc    6.077
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 44.0%
| epoch  45 |   100/  216 batches | lr 0.00007 | ms/batch 75.45 | loss  3.15 | ppl    23.41 
| epoch  45 |   200/  216 batches | lr 0.00007 | ms/batch 74.60 | loss  3.12 | ppl    22.60 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 16.66s | valid loss  4.25 | valid ppl    69.87 | valid bpc    6.127
-----------------------------------------------------------------------------------------
PROGRESS: 45.0%
| epoch  46 |   100/  216 batches | lr 0.00007 | ms/batch 75.37 | loss  3.14 | ppl    23.10 
| epoch  46 |   200/  216 batches | lr 0.00007 | ms/batch 74.72 | loss  3.11 | ppl    22.48 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 16.67s | valid loss  4.27 | valid ppl    71.77 | valid bpc    6.165
-----------------------------------------------------------------------------------------
PROGRESS: 46.0%
| epoch  47 |   100/  216 batches | lr 0.00007 | ms/batch 75.73 | loss  3.14 | ppl    23.05 
| epoch  47 |   200/  216 batches | lr 0.00007 | ms/batch 74.19 | loss  3.10 | ppl    22.10 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 16.67s | valid loss  4.23 | valid ppl    68.66 | valid bpc    6.101
-----------------------------------------------------------------------------------------
PROGRESS: 47.0%
| epoch  48 |   100/  216 batches | lr 0.00004 | ms/batch 75.74 | loss  3.08 | ppl    21.79 
| epoch  48 |   200/  216 batches | lr 0.00004 | ms/batch 74.35 | loss  3.08 | ppl    21.69 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 16.67s | valid loss  4.25 | valid ppl    70.13 | valid bpc    6.132
-----------------------------------------------------------------------------------------
PROGRESS: 48.0%
| epoch  49 |   100/  216 batches | lr 0.00004 | ms/batch 75.71 | loss  3.09 | ppl    21.96 
| epoch  49 |   200/  216 batches | lr 0.00004 | ms/batch 74.39 | loss  3.06 | ppl    21.29 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 16.67s | valid loss  4.20 | valid ppl    66.94 | valid bpc    6.065
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 49.0%
| epoch  50 |   100/  216 batches | lr 0.00004 | ms/batch 75.65 | loss  3.08 | ppl    21.72 
| epoch  50 |   200/  216 batches | lr 0.00004 | ms/batch 74.39 | loss  3.04 | ppl    20.84 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 16.66s | valid loss  4.18 | valid ppl    65.52 | valid bpc    6.034
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 50.0%
| epoch  51 |   100/  216 batches | lr 0.00004 | ms/batch 75.62 | loss  3.05 | ppl    21.18 
| epoch  51 |   200/  216 batches | lr 0.00004 | ms/batch 74.48 | loss  3.04 | ppl    20.93 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 16.66s | valid loss  4.22 | valid ppl    68.10 | valid bpc    6.090
-----------------------------------------------------------------------------------------
PROGRESS: 51.0%
| epoch  52 |   100/  216 batches | lr 0.00004 | ms/batch 75.70 | loss  3.07 | ppl    21.48 
| epoch  52 |   200/  216 batches | lr 0.00004 | ms/batch 74.34 | loss  3.03 | ppl    20.75 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 16.66s | valid loss  4.27 | valid ppl    71.31 | valid bpc    6.156
-----------------------------------------------------------------------------------------
PROGRESS: 52.0%
| epoch  53 |   100/  216 batches | lr 0.00004 | ms/batch 75.62 | loss  3.06 | ppl    21.25 
| epoch  53 |   200/  216 batches | lr 0.00004 | ms/batch 74.44 | loss  3.02 | ppl    20.46 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 16.66s | valid loss  4.19 | valid ppl    66.34 | valid bpc    6.052
-----------------------------------------------------------------------------------------
PROGRESS: 53.0%
| epoch  54 |   100/  216 batches | lr 0.00002 | ms/batch 75.78 | loss  3.03 | ppl    20.67 
| epoch  54 |   200/  216 batches | lr 0.00002 | ms/batch 74.35 | loss  3.02 | ppl    20.51 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 16.67s | valid loss  4.25 | valid ppl    69.87 | valid bpc    6.127
-----------------------------------------------------------------------------------------
PROGRESS: 54.0%
| epoch  55 |   100/  216 batches | lr 0.00002 | ms/batch 75.74 | loss  3.04 | ppl    20.82 
| epoch  55 |   200/  216 batches | lr 0.00002 | ms/batch 74.36 | loss  3.00 | ppl    20.18 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 16.67s | valid loss  4.21 | valid ppl    67.15 | valid bpc    6.069
-----------------------------------------------------------------------------------------
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  216 batches | lr 0.00002 | ms/batch 75.98 | loss  3.03 | ppl    20.70 
| epoch  56 |   200/  216 batches | lr 0.00002 | ms/batch 74.15 | loss  3.01 | ppl    20.23 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 16.67s | valid loss  4.25 | valid ppl    70.43 | valid bpc    6.138
-----------------------------------------------------------------------------------------
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  216 batches | lr 0.00001 | ms/batch 75.36 | loss  3.02 | ppl    20.54 
| epoch  57 |   200/  216 batches | lr 0.00001 | ms/batch 74.36 | loss  2.98 | ppl    19.72 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 16.67s | valid loss  4.23 | valid ppl    68.50 | valid bpc    6.098
-----------------------------------------------------------------------------------------
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  216 batches | lr 0.00001 | ms/batch 75.81 | loss  3.00 | ppl    20.18 
| epoch  58 |   200/  216 batches | lr 0.00001 | ms/batch 74.29 | loss  2.98 | ppl    19.77 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 16.67s | valid loss  4.22 | valid ppl    67.85 | valid bpc    6.084
-----------------------------------------------------------------------------------------
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  216 batches | lr 0.00001 | ms/batch 75.62 | loss  3.01 | ppl    20.28 
| epoch  59 |   200/  216 batches | lr 0.00001 | ms/batch 74.46 | loss  2.98 | ppl    19.72 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 16.66s | valid loss  4.25 | valid ppl    70.35 | valid bpc    6.136
-----------------------------------------------------------------------------------------
PROGRESS: 59.0%
| epoch  60 |   100/  216 batches | lr 0.00000 | ms/batch 75.57 | loss  2.99 | ppl    19.98 
| epoch  60 |   200/  216 batches | lr 0.00000 | ms/batch 74.63 | loss  2.99 | ppl    19.84 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 16.67s | valid loss  4.21 | valid ppl    67.67 | valid bpc    6.080
-----------------------------------------------------------------------------------------
PROGRESS: 60.0%
| epoch  61 |   100/  216 batches | lr 0.00000 | ms/batch 75.35 | loss  2.99 | ppl    19.91 
| epoch  61 |   200/  216 batches | lr 0.00000 | ms/batch 74.75 | loss  2.97 | ppl    19.58 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 16.67s | valid loss  4.19 | valid ppl    66.09 | valid bpc    6.046
-----------------------------------------------------------------------------------------
PROGRESS: 61.0%
| epoch  62 |   100/  216 batches | lr 0.00000 | ms/batch 75.86 | loss  2.99 | ppl    19.93 
| epoch  62 |   200/  216 batches | lr 0.00000 | ms/batch 74.26 | loss  2.98 | ppl    19.60 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 16.67s | valid loss  4.26 | valid ppl    71.12 | valid bpc    6.152
-----------------------------------------------------------------------------------------
PROGRESS: 62.0%
| epoch  63 |   100/  216 batches | lr 0.00000 | ms/batch 75.40 | loss  2.99 | ppl    19.88 
| epoch  63 |   200/  216 batches | lr 0.00000 | ms/batch 74.60 | loss  2.99 | ppl    19.84 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 16.68s | valid loss  4.24 | valid ppl    69.69 | valid bpc    6.123
-----------------------------------------------------------------------------------------
PROGRESS: 63.0%
| epoch  64 |   100/  216 batches | lr 0.00000 | ms/batch 75.51 | loss  2.97 | ppl    19.49 
| epoch  64 |   200/  216 batches | lr 0.00000 | ms/batch 74.71 | loss  2.99 | ppl    19.92 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 16.68s | valid loss  4.23 | valid ppl    68.95 | valid bpc    6.107
-----------------------------------------------------------------------------------------
PROGRESS: 64.0%
| epoch  65 |   100/  216 batches | lr 0.00000 | ms/batch 75.84 | loss  2.98 | ppl    19.77 
| epoch  65 |   200/  216 batches | lr 0.00000 | ms/batch 74.29 | loss  2.98 | ppl    19.62 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 16.68s | valid loss  4.24 | valid ppl    69.61 | valid bpc    6.121
-----------------------------------------------------------------------------------------
PROGRESS: 65.0%
| epoch  66 |   100/  216 batches | lr 0.00000 | ms/batch 75.48 | loss  2.99 | ppl    19.85 
| epoch  66 |   200/  216 batches | lr 0.00000 | ms/batch 74.70 | loss  2.97 | ppl    19.57 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 16.67s | valid loss  4.25 | valid ppl    69.95 | valid bpc    6.128
-----------------------------------------------------------------------------------------
PROGRESS: 66.0%
| epoch  67 |   100/  216 batches | lr 0.00000 | ms/batch 76.00 | loss  3.00 | ppl    20.11 
| epoch  67 |   200/  216 batches | lr 0.00000 | ms/batch 74.21 | loss  2.98 | ppl    19.69 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 16.67s | valid loss  4.23 | valid ppl    68.51 | valid bpc    6.098
-----------------------------------------------------------------------------------------
PROGRESS: 67.0%
| epoch  68 |   100/  216 batches | lr 0.00000 | ms/batch 75.36 | loss  2.99 | ppl    19.83 
| epoch  68 |   200/  216 batches | lr 0.00000 | ms/batch 74.76 | loss  2.99 | ppl    19.89 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 16.67s | valid loss  4.23 | valid ppl    68.95 | valid bpc    6.107
-----------------------------------------------------------------------------------------
PROGRESS: 68.0%
| epoch  69 |   100/  216 batches | lr 0.00000 | ms/batch 75.96 | loss  3.01 | ppl    20.20 
| epoch  69 |   200/  216 batches | lr 0.00000 | ms/batch 74.21 | loss  2.97 | ppl    19.59 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 16.67s | valid loss  4.19 | valid ppl    66.12 | valid bpc    6.047
-----------------------------------------------------------------------------------------
PROGRESS: 69.0%
| epoch  70 |   100/  216 batches | lr 0.00000 | ms/batch 75.59 | loss  2.99 | ppl    19.97 
| epoch  70 |   200/  216 batches | lr 0.00000 | ms/batch 74.54 | loss  2.98 | ppl    19.70 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 16.67s | valid loss  4.22 | valid ppl    67.70 | valid bpc    6.081
-----------------------------------------------------------------------------------------
PROGRESS: 70.0%
| epoch  71 |   100/  216 batches | lr 0.00000 | ms/batch 75.55 | loss  2.99 | ppl    19.79 
| epoch  71 |   200/  216 batches | lr 0.00000 | ms/batch 74.62 | loss  2.99 | ppl    19.87 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 16.67s | valid loss  4.20 | valid ppl    66.44 | valid bpc    6.054
-----------------------------------------------------------------------------------------
PROGRESS: 71.0%
| epoch  72 |   100/  216 batches | lr 0.00000 | ms/batch 75.66 | loss  2.98 | ppl    19.77 
| epoch  72 |   200/  216 batches | lr 0.00000 | ms/batch 74.47 | loss  2.95 | ppl    19.12 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 16.67s | valid loss  4.22 | valid ppl    67.87 | valid bpc    6.085
-----------------------------------------------------------------------------------------
PROGRESS: 72.0%
| epoch  73 |   100/  216 batches | lr 0.00000 | ms/batch 75.49 | loss  3.01 | ppl    20.25 
| epoch  73 |   200/  216 batches | lr 0.00000 | ms/batch 74.69 | loss  2.95 | ppl    19.15 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 16.67s | valid loss  4.25 | valid ppl    69.90 | valid bpc    6.127
-----------------------------------------------------------------------------------------
PROGRESS: 73.0%
| epoch  74 |   100/  216 batches | lr 0.00000 | ms/batch 75.46 | loss  3.01 | ppl    20.38 
| epoch  74 |   200/  216 batches | lr 0.00000 | ms/batch 74.32 | loss  2.97 | ppl    19.42 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 16.68s | valid loss  4.21 | valid ppl    67.10 | valid bpc    6.068
-----------------------------------------------------------------------------------------
PROGRESS: 74.0%
| epoch  75 |   100/  216 batches | lr 0.00000 | ms/batch 75.72 | loss  3.00 | ppl    20.15 
| epoch  75 |   200/  216 batches | lr 0.00000 | ms/batch 74.38 | loss  2.95 | ppl    19.20 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 16.67s | valid loss  4.25 | valid ppl    69.84 | valid bpc    6.126
-----------------------------------------------------------------------------------------
PROGRESS: 75.0%
| epoch  76 |   100/  216 batches | lr 0.00000 | ms/batch 75.47 | loss  3.00 | ppl    20.06 
| epoch  76 |   200/  216 batches | lr 0.00000 | ms/batch 74.71 | loss  2.97 | ppl    19.46 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 16.67s | valid loss  4.22 | valid ppl    67.99 | valid bpc    6.087
-----------------------------------------------------------------------------------------
PROGRESS: 76.0%
| epoch  77 |   100/  216 batches | lr 0.00000 | ms/batch 75.71 | loss  3.01 | ppl    20.23 
| epoch  77 |   200/  216 batches | lr 0.00000 | ms/batch 74.40 | loss  2.95 | ppl    19.05 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 16.67s | valid loss  4.21 | valid ppl    67.63 | valid bpc    6.080
-----------------------------------------------------------------------------------------
PROGRESS: 77.0%
| epoch  78 |   100/  216 batches | lr 0.00000 | ms/batch 75.48 | loss  2.98 | ppl    19.69 
| epoch  78 |   200/  216 batches | lr 0.00000 | ms/batch 74.52 | loss  2.98 | ppl    19.69 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 16.67s | valid loss  4.19 | valid ppl    65.92 | valid bpc    6.043
-----------------------------------------------------------------------------------------
PROGRESS: 78.0%
| epoch  79 |   100/  216 batches | lr 0.00000 | ms/batch 75.34 | loss  3.00 | ppl    20.04 
| epoch  79 |   200/  216 batches | lr 0.00000 | ms/batch 74.81 | loss  2.97 | ppl    19.57 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 16.67s | valid loss  4.21 | valid ppl    67.39 | valid bpc    6.074
-----------------------------------------------------------------------------------------
PROGRESS: 79.0%
| epoch  80 |   100/  216 batches | lr 0.00000 | ms/batch 75.38 | loss  2.97 | ppl    19.49 
| epoch  80 |   200/  216 batches | lr 0.00000 | ms/batch 74.61 | loss  2.98 | ppl    19.67 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 16.67s | valid loss  4.22 | valid ppl    67.70 | valid bpc    6.081
-----------------------------------------------------------------------------------------
PROGRESS: 80.0%
| epoch  81 |   100/  216 batches | lr 0.00000 | ms/batch 75.75 | loss  3.01 | ppl    20.28 
| epoch  81 |   200/  216 batches | lr 0.00000 | ms/batch 74.32 | loss  2.97 | ppl    19.41 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 16.67s | valid loss  4.21 | valid ppl    67.65 | valid bpc    6.080
-----------------------------------------------------------------------------------------
PROGRESS: 81.0%
| epoch  82 |   100/  216 batches | lr 0.00000 | ms/batch 75.43 | loss  3.00 | ppl    20.03 
| epoch  82 |   200/  216 batches | lr 0.00000 | ms/batch 74.59 | loss  2.96 | ppl    19.35 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 16.67s | valid loss  4.18 | valid ppl    65.64 | valid bpc    6.036
-----------------------------------------------------------------------------------------
PROGRESS: 82.0%
| epoch  83 |   100/  216 batches | lr 0.00000 | ms/batch 75.92 | loss  3.01 | ppl    20.27 
| epoch  83 |   200/  216 batches | lr 0.00000 | ms/batch 74.19 | loss  2.97 | ppl    19.53 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 16.67s | valid loss  4.23 | valid ppl    68.81 | valid bpc    6.105
-----------------------------------------------------------------------------------------
PROGRESS: 83.0%
| epoch  84 |   100/  216 batches | lr 0.00000 | ms/batch 75.89 | loss  2.99 | ppl    19.93 
| epoch  84 |   200/  216 batches | lr 0.00000 | ms/batch 74.23 | loss  2.96 | ppl    19.35 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 16.67s | valid loss  4.21 | valid ppl    67.11 | valid bpc    6.069
-----------------------------------------------------------------------------------------
PROGRESS: 84.0%
| epoch  85 |   100/  216 batches | lr 0.00000 | ms/batch 75.64 | loss  2.99 | ppl    19.87 
| epoch  85 |   200/  216 batches | lr 0.00000 | ms/batch 74.54 | loss  2.98 | ppl    19.75 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 16.68s | valid loss  4.20 | valid ppl    66.63 | valid bpc    6.058
-----------------------------------------------------------------------------------------
PROGRESS: 85.0%
| epoch  86 |   100/  216 batches | lr 0.00000 | ms/batch 75.90 | loss  3.01 | ppl    20.23 
| epoch  86 |   200/  216 batches | lr 0.00000 | ms/batch 74.23 | loss  2.96 | ppl    19.32 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 16.67s | valid loss  4.22 | valid ppl    68.30 | valid bpc    6.094
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  216 batches | lr 0.00000 | ms/batch 75.85 | loss  3.01 | ppl    20.23 
| epoch  87 |   200/  216 batches | lr 0.00000 | ms/batch 74.32 | loss  2.98 | ppl    19.66 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 16.67s | valid loss  4.21 | valid ppl    67.28 | valid bpc    6.072
-----------------------------------------------------------------------------------------
PROGRESS: 87.0%
| epoch  88 |   100/  216 batches | lr 0.00000 | ms/batch 75.64 | loss  2.98 | ppl    19.59 
| epoch  88 |   200/  216 batches | lr 0.00000 | ms/batch 74.46 | loss  2.97 | ppl    19.47 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 16.67s | valid loss  4.24 | valid ppl    69.43 | valid bpc    6.118
-----------------------------------------------------------------------------------------
PROGRESS: 88.0%
| epoch  89 |   100/  216 batches | lr 0.00000 | ms/batch 75.75 | loss  2.99 | ppl    19.81 
| epoch  89 |   200/  216 batches | lr 0.00000 | ms/batch 74.45 | loss  2.96 | ppl    19.35 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 16.67s | valid loss  4.20 | valid ppl    66.77 | valid bpc    6.061
-----------------------------------------------------------------------------------------
PROGRESS: 89.0%
| epoch  90 |   100/  216 batches | lr 0.00000 | ms/batch 75.83 | loss  2.99 | ppl    19.90 
| epoch  90 |   200/  216 batches | lr 0.00000 | ms/batch 74.36 | loss  2.97 | ppl    19.47 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 16.67s | valid loss  4.25 | valid ppl    70.01 | valid bpc    6.130
-----------------------------------------------------------------------------------------
PROGRESS: 90.0%
| epoch  91 |   100/  216 batches | lr 0.00000 | ms/batch 75.52 | loss  3.00 | ppl    20.14 
| epoch  91 |   200/  216 batches | lr 0.00000 | ms/batch 74.70 | loss  2.97 | ppl    19.51 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 16.68s | valid loss  4.21 | valid ppl    67.64 | valid bpc    6.080
-----------------------------------------------------------------------------------------
PROGRESS: 91.0%
| epoch  92 |   100/  216 batches | lr 0.00000 | ms/batch 75.81 | loss  3.01 | ppl    20.20 
| epoch  92 |   200/  216 batches | lr 0.00000 | ms/batch 74.36 | loss  2.98 | ppl    19.63 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 16.68s | valid loss  4.22 | valid ppl    68.00 | valid bpc    6.087
-----------------------------------------------------------------------------------------
PROGRESS: 92.0%
| epoch  93 |   100/  216 batches | lr 0.00000 | ms/batch 75.36 | loss  2.99 | ppl    19.96 
| epoch  93 |   200/  216 batches | lr 0.00000 | ms/batch 74.85 | loss  2.98 | ppl    19.71 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 16.68s | valid loss  4.21 | valid ppl    67.49 | valid bpc    6.077
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  216 batches | lr 0.00000 | ms/batch 75.82 | loss  3.00 | ppl    20.09 
| epoch  94 |   200/  216 batches | lr 0.00000 | ms/batch 74.37 | loss  2.95 | ppl    19.16 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 16.68s | valid loss  4.19 | valid ppl    65.84 | valid bpc    6.041
-----------------------------------------------------------------------------------------
PROGRESS: 94.0%
| epoch  95 |   100/  216 batches | lr 0.00000 | ms/batch 76.01 | loss  3.01 | ppl    20.21 
| epoch  95 |   200/  216 batches | lr 0.00000 | ms/batch 74.16 | loss  2.96 | ppl    19.27 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 16.68s | valid loss  4.17 | valid ppl    65.03 | valid bpc    6.023
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 95.0%
| epoch  96 |   100/  216 batches | lr 0.00000 | ms/batch 75.55 | loss  3.00 | ppl    20.11 
| epoch  96 |   200/  216 batches | lr 0.00000 | ms/batch 74.57 | loss  2.97 | ppl    19.57 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 16.67s | valid loss  4.21 | valid ppl    67.31 | valid bpc    6.073
-----------------------------------------------------------------------------------------
PROGRESS: 96.0%
| epoch  97 |   100/  216 batches | lr 0.00000 | ms/batch 75.87 | loss  2.98 | ppl    19.59 
| epoch  97 |   200/  216 batches | lr 0.00000 | ms/batch 74.28 | loss  2.96 | ppl    19.37 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 16.67s | valid loss  4.23 | valid ppl    68.55 | valid bpc    6.099
-----------------------------------------------------------------------------------------
PROGRESS: 97.0%
| epoch  98 |   100/  216 batches | lr 0.00000 | ms/batch 75.27 | loss  2.99 | ppl    19.89 
| epoch  98 |   200/  216 batches | lr 0.00000 | ms/batch 74.89 | loss  2.97 | ppl    19.56 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 16.67s | valid loss  4.22 | valid ppl    67.73 | valid bpc    6.082
-----------------------------------------------------------------------------------------
PROGRESS: 98.0%
| epoch  99 |   100/  216 batches | lr 0.00000 | ms/batch 75.90 | loss  2.99 | ppl    19.98 
| epoch  99 |   200/  216 batches | lr 0.00000 | ms/batch 74.26 | loss  2.96 | ppl    19.26 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 16.68s | valid loss  4.24 | valid ppl    69.73 | valid bpc    6.124
-----------------------------------------------------------------------------------------
PROGRESS: 99.0%
| epoch 100 |   100/  216 batches | lr 0.00000 | ms/batch 75.30 | loss  2.99 | ppl    19.98 
| epoch 100 |   200/  216 batches | lr 0.00000 | ms/batch 74.83 | loss  2.96 | ppl    19.28 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 16.68s | valid loss  4.23 | valid ppl    68.75 | valid bpc    6.103
-----------------------------------------------------------------------------------------
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  4.14 | test ppl    62.83 | test bpc    5.973
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.3997, Mean Reca: 0.5523, Mean F1: 0.4557
Counter({'NP': 8070, 'PP': 4207, 'S': 2959, 'VP': 2720, 'SBAR': 530, 'QP': 204, 'ADJP': 200, 'ADVP': 166, 'SINV': 150, 'PRN': 53, 'FRAG': 33, 'WHNP': 27, 'UCP': 13, 'SQ': 13, 'WHPP': 10, 'NX': 9, 'SBARQ': 8, 'NAC': 7, 'CONJP': 5, 'X': 3})
Counter({'NP': 14432, 'VP': 8130, 'S': 5620, 'PP': 5484, 'SBAR': 1796, 'ADJP': 649, 'QP': 490, 'ADVP': 286, 'SINV': 157, 'PRN': 128, 'NX': 95, 'FRAG': 42, 'WHNP': 37, 'UCP': 32, 'NAC': 30, 'WHPP': 25, 'CONJP': 21, 'SQ': 18, 'SBARQ': 10, 'WHADVP': 9, 'X': 6, 'WHADJP': 4, 'INTJ': 1})
SBAR: 0.2951
NP: 0.5592
VP: 0.3346
PP: 0.7671
ADJP: 0.3082
ADVP: 0.5804
4.782563898562473
-----------------------------------------------------------------------------------------
Dependency parsing performance:
Conll-U Style:
DDA: 0.419
UDA: 0.573
=========================================================================================
Loading dataset...
Loading dictionary...
Number of tokens:  10001
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer_in_parser', nhid=512, nlayers=8, front_layers=7, rear_layers=1, n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=5555, nonmono=5, cuda=True, log_interval=100, save='trained_models/structformer_in_parser_5555_71.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 38475557
Model architecture: StructFormer_In_Parser(
  (transformer_front): Transformer_Front(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(10001, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-6): 7 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
  (transformer_rear): Transformer_Rear(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(10001, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0): TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (output_layer): Linear(in_features=512, out_features=10001, bias=True)
  )
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  216 batches | lr 0.00030 | ms/batch 78.48 | loss  7.31 | ppl  1491.15 
| epoch   1 |   200/  216 batches | lr 0.00030 | ms/batch 73.75 | loss  6.85 | ppl   939.93 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 16.87s | valid loss  6.62 | valid ppl   750.54 | valid bpc    9.552
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  216 batches | lr 0.00030 | ms/batch 74.72 | loss  6.76 | ppl   865.15 
| epoch   2 |   200/  216 batches | lr 0.00030 | ms/batch 74.42 | loss  6.45 | ppl   633.48 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 16.57s | valid loss  6.19 | valid ppl   487.93 | valid bpc    8.931
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  216 batches | lr 0.00030 | ms/batch 75.42 | loss  6.23 | ppl   507.11 
| epoch   3 |   200/  216 batches | lr 0.00030 | ms/batch 74.10 | loss  5.93 | ppl   376.75 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 16.62s | valid loss  5.76 | valid ppl   318.51 | valid bpc    8.315
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  216 batches | lr 0.00030 | ms/batch 75.08 | loss  5.80 | ppl   329.39 
| epoch   4 |   200/  216 batches | lr 0.00030 | ms/batch 74.71 | loss  5.64 | ppl   281.68 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 16.64s | valid loss  5.52 | valid ppl   250.28 | valid bpc    7.967
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  216 batches | lr 0.00030 | ms/batch 75.53 | loss  5.53 | ppl   252.17 
| epoch   5 |   200/  216 batches | lr 0.00030 | ms/batch 74.12 | loss  5.42 | ppl   226.07 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 16.65s | valid loss  5.34 | valid ppl   208.32 | valid bpc    7.703
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  216 batches | lr 0.00030 | ms/batch 75.71 | loss  5.37 | ppl   214.04 
| epoch   6 |   200/  216 batches | lr 0.00030 | ms/batch 74.36 | loss  5.26 | ppl   191.68 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 16.66s | valid loss  5.22 | valid ppl   185.01 | valid bpc    7.531
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  216 batches | lr 0.00030 | ms/batch 75.74 | loss  5.20 | ppl   180.67 
| epoch   7 |   200/  216 batches | lr 0.00030 | ms/batch 74.38 | loss  5.13 | ppl   169.28 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 16.67s | valid loss  5.11 | valid ppl   165.66 | valid bpc    7.372
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  216 batches | lr 0.00030 | ms/batch 75.62 | loss  5.09 | ppl   162.59 
| epoch   8 |   200/  216 batches | lr 0.00030 | ms/batch 74.43 | loss  5.01 | ppl   150.27 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 16.67s | valid loss  5.03 | valid ppl   152.71 | valid bpc    7.255
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 8.0%
| epoch   9 |   100/  216 batches | lr 0.00030 | ms/batch 75.84 | loss  5.00 | ppl   148.58 
| epoch   9 |   200/  216 batches | lr 0.00030 | ms/batch 74.35 | loss  4.88 | ppl   131.94 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 16.68s | valid loss  4.91 | valid ppl   135.75 | valid bpc    7.085
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  216 batches | lr 0.00030 | ms/batch 75.52 | loss  4.87 | ppl   129.71 
| epoch  10 |   200/  216 batches | lr 0.00030 | ms/batch 74.29 | loss  4.78 | ppl   119.52 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 16.68s | valid loss  4.86 | valid ppl   129.62 | valid bpc    7.018
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  216 batches | lr 0.00030 | ms/batch 75.83 | loss  4.76 | ppl   116.99 
| epoch  11 |   200/  216 batches | lr 0.00030 | ms/batch 74.43 | loss  4.72 | ppl   112.36 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 16.69s | valid loss  4.84 | valid ppl   126.03 | valid bpc    6.978
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  216 batches | lr 0.00030 | ms/batch 75.38 | loss  4.66 | ppl   106.03 
| epoch  12 |   200/  216 batches | lr 0.00030 | ms/batch 74.88 | loss  4.64 | ppl   103.55 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 16.68s | valid loss  4.77 | valid ppl   117.92 | valid bpc    6.882
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 12.0%
| epoch  13 |   100/  216 batches | lr 0.00030 | ms/batch 75.49 | loss  4.63 | ppl   102.08 
| epoch  13 |   200/  216 batches | lr 0.00030 | ms/batch 74.72 | loss  4.54 | ppl    93.49 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 16.68s | valid loss  4.70 | valid ppl   109.96 | valid bpc    6.781
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 13.0%
| epoch  14 |   100/  216 batches | lr 0.00030 | ms/batch 75.51 | loss  4.52 | ppl    91.50 
| epoch  14 |   200/  216 batches | lr 0.00030 | ms/batch 74.64 | loss  4.49 | ppl    89.26 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 16.68s | valid loss  4.63 | valid ppl   102.80 | valid bpc    6.684
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  216 batches | lr 0.00030 | ms/batch 75.85 | loss  4.44 | ppl    85.12 
| epoch  15 |   200/  216 batches | lr 0.00030 | ms/batch 74.31 | loss  4.41 | ppl    82.32 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 16.68s | valid loss  4.60 | valid ppl    99.10 | valid bpc    6.631
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 15.0%
| epoch  16 |   100/  216 batches | lr 0.00030 | ms/batch 75.85 | loss  4.39 | ppl    80.75 
| epoch  16 |   200/  216 batches | lr 0.00030 | ms/batch 74.33 | loss  4.35 | ppl    77.40 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 16.68s | valid loss  4.61 | valid ppl   100.44 | valid bpc    6.650
-----------------------------------------------------------------------------------------
PROGRESS: 16.0%
| epoch  17 |   100/  216 batches | lr 0.00030 | ms/batch 75.89 | loss  4.33 | ppl    75.88 
| epoch  17 |   200/  216 batches | lr 0.00030 | ms/batch 74.32 | loss  4.28 | ppl    72.00 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 16.68s | valid loss  4.56 | valid ppl    95.59 | valid bpc    6.579
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 17.0%
| epoch  18 |   100/  216 batches | lr 0.00030 | ms/batch 75.56 | loss  4.27 | ppl    71.30 
| epoch  18 |   200/  216 batches | lr 0.00030 | ms/batch 74.56 | loss  4.20 | ppl    66.80 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 16.69s | valid loss  4.50 | valid ppl    89.82 | valid bpc    6.489
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 18.0%
| epoch  19 |   100/  216 batches | lr 0.00030 | ms/batch 75.48 | loss  4.20 | ppl    66.53 
| epoch  19 |   200/  216 batches | lr 0.00030 | ms/batch 74.76 | loss  4.17 | ppl    64.74 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 16.68s | valid loss  4.50 | valid ppl    90.36 | valid bpc    6.498
-----------------------------------------------------------------------------------------
PROGRESS: 19.0%
| epoch  20 |   100/  216 batches | lr 0.00030 | ms/batch 75.64 | loss  4.14 | ppl    62.52 
| epoch  20 |   200/  216 batches | lr 0.00030 | ms/batch 74.73 | loss  4.10 | ppl    60.36 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 16.69s | valid loss  4.49 | valid ppl    89.42 | valid bpc    6.483
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 20.0%
| epoch  21 |   100/  216 batches | lr 0.00030 | ms/batch 75.97 | loss  4.12 | ppl    61.30 
| epoch  21 |   200/  216 batches | lr 0.00030 | ms/batch 74.20 | loss  4.06 | ppl    57.80 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 16.68s | valid loss  4.45 | valid ppl    86.02 | valid bpc    6.427
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 21.0%
| epoch  22 |   100/  216 batches | lr 0.00030 | ms/batch 75.73 | loss  4.03 | ppl    56.08 
| epoch  22 |   200/  216 batches | lr 0.00030 | ms/batch 74.53 | loss  4.02 | ppl    55.73 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 16.68s | valid loss  4.43 | valid ppl    83.73 | valid bpc    6.388
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 22.0%
| epoch  23 |   100/  216 batches | lr 0.00030 | ms/batch 75.71 | loss  4.00 | ppl    54.64 
| epoch  23 |   200/  216 batches | lr 0.00030 | ms/batch 74.38 | loss  3.94 | ppl    51.46 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 16.68s | valid loss  4.38 | valid ppl    79.49 | valid bpc    6.313
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 23.0%
| epoch  24 |   100/  216 batches | lr 0.00030 | ms/batch 75.79 | loss  3.92 | ppl    50.39 
| epoch  24 |   200/  216 batches | lr 0.00030 | ms/batch 74.27 | loss  3.91 | ppl    49.88 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 16.67s | valid loss  4.39 | valid ppl    80.70 | valid bpc    6.335
-----------------------------------------------------------------------------------------
PROGRESS: 24.0%
| epoch  25 |   100/  216 batches | lr 0.00030 | ms/batch 75.84 | loss  3.89 | ppl    49.15 
| epoch  25 |   200/  216 batches | lr 0.00030 | ms/batch 74.34 | loss  3.89 | ppl    49.07 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 16.69s | valid loss  4.38 | valid ppl    79.48 | valid bpc    6.312
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 25.0%
| epoch  26 |   100/  216 batches | lr 0.00030 | ms/batch 75.37 | loss  3.83 | ppl    46.07 
| epoch  26 |   200/  216 batches | lr 0.00030 | ms/batch 74.38 | loss  3.83 | ppl    46.19 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 16.68s | valid loss  4.36 | valid ppl    77.88 | valid bpc    6.283
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 26.0%
| epoch  27 |   100/  216 batches | lr 0.00030 | ms/batch 75.97 | loss  3.80 | ppl    44.61 
| epoch  27 |   200/  216 batches | lr 0.00030 | ms/batch 74.16 | loss  3.80 | ppl    44.54 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 16.68s | valid loss  4.35 | valid ppl    77.59 | valid bpc    6.278
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 27.0%
| epoch  28 |   100/  216 batches | lr 0.00030 | ms/batch 75.61 | loss  3.76 | ppl    42.94 
| epoch  28 |   200/  216 batches | lr 0.00030 | ms/batch 74.54 | loss  3.75 | ppl    42.35 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 16.67s | valid loss  4.35 | valid ppl    77.84 | valid bpc    6.282
-----------------------------------------------------------------------------------------
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  216 batches | lr 0.00030 | ms/batch 75.42 | loss  3.71 | ppl    41.03 
| epoch  29 |   200/  216 batches | lr 0.00030 | ms/batch 74.59 | loss  3.69 | ppl    40.14 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 16.68s | valid loss  4.31 | valid ppl    74.45 | valid bpc    6.218
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  216 batches | lr 0.00030 | ms/batch 75.44 | loss  3.68 | ppl    39.60 
| epoch  30 |   200/  216 batches | lr 0.00030 | ms/batch 74.70 | loss  3.68 | ppl    39.66 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 16.68s | valid loss  4.33 | valid ppl    76.24 | valid bpc    6.253
-----------------------------------------------------------------------------------------
PROGRESS: 30.0%
| epoch  31 |   100/  216 batches | lr 0.00030 | ms/batch 75.33 | loss  3.64 | ppl    38.20 
| epoch  31 |   200/  216 batches | lr 0.00030 | ms/batch 74.67 | loss  3.64 | ppl    37.99 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 16.67s | valid loss  4.30 | valid ppl    73.48 | valid bpc    6.199
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 31.0%
| epoch  32 |   100/  216 batches | lr 0.00030 | ms/batch 75.80 | loss  3.59 | ppl    36.23 
| epoch  32 |   200/  216 batches | lr 0.00030 | ms/batch 74.36 | loss  3.60 | ppl    36.58 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 16.68s | valid loss  4.33 | valid ppl    76.04 | valid bpc    6.249
-----------------------------------------------------------------------------------------
PROGRESS: 32.0%
| epoch  33 |   100/  216 batches | lr 0.00030 | ms/batch 75.64 | loss  3.56 | ppl    35.01 
| epoch  33 |   200/  216 batches | lr 0.00030 | ms/batch 74.56 | loss  3.56 | ppl    35.17 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 16.68s | valid loss  4.32 | valid ppl    74.94 | valid bpc    6.228
-----------------------------------------------------------------------------------------
PROGRESS: 33.0%
| epoch  34 |   100/  216 batches | lr 0.00030 | ms/batch 75.55 | loss  3.52 | ppl    33.76 
| epoch  34 |   200/  216 batches | lr 0.00030 | ms/batch 74.76 | loss  3.49 | ppl    32.95 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 16.68s | valid loss  4.28 | valid ppl    72.07 | valid bpc    6.171
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 34.0%
| epoch  35 |   100/  216 batches | lr 0.00030 | ms/batch 75.36 | loss  3.46 | ppl    31.86 
| epoch  35 |   200/  216 batches | lr 0.00030 | ms/batch 74.83 | loss  3.51 | ppl    33.31 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 16.69s | valid loss  4.24 | valid ppl    69.13 | valid bpc    6.111
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 35.0%
| epoch  36 |   100/  216 batches | lr 0.00030 | ms/batch 75.44 | loss  3.45 | ppl    31.46 
| epoch  36 |   200/  216 batches | lr 0.00030 | ms/batch 74.69 | loss  3.44 | ppl    31.24 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 16.68s | valid loss  4.28 | valid ppl    72.06 | valid bpc    6.171
-----------------------------------------------------------------------------------------
PROGRESS: 36.0%
| epoch  37 |   100/  216 batches | lr 0.00030 | ms/batch 75.60 | loss  3.42 | ppl    30.48 
| epoch  37 |   200/  216 batches | lr 0.00030 | ms/batch 74.60 | loss  3.40 | ppl    30.10 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 16.68s | valid loss  4.26 | valid ppl    70.90 | valid bpc    6.148
-----------------------------------------------------------------------------------------
PROGRESS: 37.0%
| epoch  38 |   100/  216 batches | lr 0.00030 | ms/batch 75.75 | loss  3.37 | ppl    29.08 
| epoch  38 |   200/  216 batches | lr 0.00030 | ms/batch 74.42 | loss  3.37 | ppl    29.17 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 16.68s | valid loss  4.29 | valid ppl    73.04 | valid bpc    6.191
-----------------------------------------------------------------------------------------
PROGRESS: 38.0%
| epoch  39 |   100/  216 batches | lr 0.00015 | ms/batch 75.88 | loss  3.30 | ppl    27.18 
| epoch  39 |   200/  216 batches | lr 0.00015 | ms/batch 74.31 | loss  3.25 | ppl    25.91 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 16.68s | valid loss  4.26 | valid ppl    70.62 | valid bpc    6.142
-----------------------------------------------------------------------------------------
PROGRESS: 39.0%
| epoch  40 |   100/  216 batches | lr 0.00015 | ms/batch 75.77 | loss  3.24 | ppl    25.62 
| epoch  40 |   200/  216 batches | lr 0.00015 | ms/batch 74.45 | loss  3.24 | ppl    25.52 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 16.68s | valid loss  4.29 | valid ppl    72.68 | valid bpc    6.183
-----------------------------------------------------------------------------------------
PROGRESS: 40.0%
| epoch  41 |   100/  216 batches | lr 0.00015 | ms/batch 75.44 | loss  3.22 | ppl    25.08 
| epoch  41 |   200/  216 batches | lr 0.00015 | ms/batch 74.41 | loss  3.19 | ppl    24.19 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 16.68s | valid loss  4.27 | valid ppl    71.53 | valid bpc    6.160
-----------------------------------------------------------------------------------------
PROGRESS: 41.0%
| epoch  42 |   100/  216 batches | lr 0.00007 | ms/batch 75.75 | loss  3.16 | ppl    23.48 
| epoch  42 |   200/  216 batches | lr 0.00007 | ms/batch 74.49 | loss  3.12 | ppl    22.74 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 16.69s | valid loss  4.24 | valid ppl    69.57 | valid bpc    6.120
-----------------------------------------------------------------------------------------
PROGRESS: 42.0%
| epoch  43 |   100/  216 batches | lr 0.00007 | ms/batch 75.89 | loss  3.14 | ppl    23.08 
| epoch  43 |   200/  216 batches | lr 0.00007 | ms/batch 74.34 | loss  3.11 | ppl    22.42 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 16.69s | valid loss  4.25 | valid ppl    69.96 | valid bpc    6.128
-----------------------------------------------------------------------------------------
PROGRESS: 43.0%
| epoch  44 |   100/  216 batches | lr 0.00007 | ms/batch 75.46 | loss  3.11 | ppl    22.42 
| epoch  44 |   200/  216 batches | lr 0.00007 | ms/batch 74.98 | loss  3.08 | ppl    21.76 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 16.71s | valid loss  4.23 | valid ppl    68.93 | valid bpc    6.107
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 44.0%
| epoch  45 |   100/  216 batches | lr 0.00007 | ms/batch 75.93 | loss  3.08 | ppl    21.67 
| epoch  45 |   200/  216 batches | lr 0.00007 | ms/batch 74.29 | loss  3.08 | ppl    21.85 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 16.69s | valid loss  4.29 | valid ppl    73.14 | valid bpc    6.193
-----------------------------------------------------------------------------------------
PROGRESS: 45.0%
| epoch  46 |   100/  216 batches | lr 0.00007 | ms/batch 75.65 | loss  3.06 | ppl    21.29 
| epoch  46 |   200/  216 batches | lr 0.00007 | ms/batch 74.63 | loss  3.06 | ppl    21.23 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 16.70s | valid loss  4.21 | valid ppl    67.66 | valid bpc    6.080
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 46.0%
| epoch  47 |   100/  216 batches | lr 0.00007 | ms/batch 75.49 | loss  3.06 | ppl    21.35 
| epoch  47 |   200/  216 batches | lr 0.00007 | ms/batch 74.86 | loss  3.02 | ppl    20.57 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 16.69s | valid loss  4.23 | valid ppl    68.79 | valid bpc    6.104
-----------------------------------------------------------------------------------------
PROGRESS: 47.0%
| epoch  48 |   100/  216 batches | lr 0.00007 | ms/batch 75.58 | loss  3.05 | ppl    21.07 
| epoch  48 |   200/  216 batches | lr 0.00007 | ms/batch 74.78 | loss  3.03 | ppl    20.64 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 16.70s | valid loss  4.23 | valid ppl    68.95 | valid bpc    6.107
-----------------------------------------------------------------------------------------
PROGRESS: 48.0%
| epoch  49 |   100/  216 batches | lr 0.00007 | ms/batch 75.52 | loss  3.00 | ppl    20.07 
| epoch  49 |   200/  216 batches | lr 0.00007 | ms/batch 79.23 | loss  3.00 | ppl    20.16 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 17.31s | valid loss  4.19 | valid ppl    66.23 | valid bpc    6.049
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 49.0%
| epoch  50 |   100/  216 batches | lr 0.00007 | ms/batch 77.27 | loss  2.99 | ppl    19.94 
| epoch  50 |   200/  216 batches | lr 0.00007 | ms/batch 74.96 | loss  3.00 | ppl    20.09 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 16.89s | valid loss  4.19 | valid ppl    66.07 | valid bpc    6.046
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 50.0%
| epoch  51 |   100/  216 batches | lr 0.00007 | ms/batch 77.96 | loss  2.98 | ppl    19.62 
| epoch  51 |   200/  216 batches | lr 0.00007 | ms/batch 74.68 | loss  3.00 | ppl    20.14 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 16.93s | valid loss  4.25 | valid ppl    70.10 | valid bpc    6.131
-----------------------------------------------------------------------------------------
PROGRESS: 51.0%
| epoch  52 |   100/  216 batches | lr 0.00007 | ms/batch 75.71 | loss  2.97 | ppl    19.55 
| epoch  52 |   200/  216 batches | lr 0.00007 | ms/batch 74.55 | loss  2.96 | ppl    19.28 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 16.69s | valid loss  4.26 | valid ppl    71.11 | valid bpc    6.152
-----------------------------------------------------------------------------------------
PROGRESS: 52.0%
| epoch  53 |   100/  216 batches | lr 0.00007 | ms/batch 75.82 | loss  2.97 | ppl    19.58 
| epoch  53 |   200/  216 batches | lr 0.00007 | ms/batch 74.52 | loss  2.93 | ppl    18.81 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 16.69s | valid loss  4.22 | valid ppl    67.89 | valid bpc    6.085
-----------------------------------------------------------------------------------------
PROGRESS: 53.0%
| epoch  54 |   100/  216 batches | lr 0.00004 | ms/batch 75.72 | loss  2.94 | ppl    18.85 
| epoch  54 |   200/  216 batches | lr 0.00004 | ms/batch 74.62 | loss  2.92 | ppl    18.59 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 16.70s | valid loss  4.25 | valid ppl    70.26 | valid bpc    6.135
-----------------------------------------------------------------------------------------
PROGRESS: 54.0%
| epoch  55 |   100/  216 batches | lr 0.00004 | ms/batch 75.79 | loss  2.94 | ppl    18.85 
| epoch  55 |   200/  216 batches | lr 0.00004 | ms/batch 74.51 | loss  2.93 | ppl    18.75 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 16.69s | valid loss  4.29 | valid ppl    73.31 | valid bpc    6.196
-----------------------------------------------------------------------------------------
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  216 batches | lr 0.00004 | ms/batch 75.91 | loss  2.92 | ppl    18.55 
| epoch  56 |   200/  216 batches | lr 0.00004 | ms/batch 74.49 | loss  2.92 | ppl    18.51 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 16.71s | valid loss  4.21 | valid ppl    67.67 | valid bpc    6.080
-----------------------------------------------------------------------------------------
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  216 batches | lr 0.00002 | ms/batch 75.86 | loss  2.89 | ppl    18.06 
| epoch  57 |   200/  216 batches | lr 0.00002 | ms/batch 74.31 | loss  2.88 | ppl    17.81 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 16.72s | valid loss  4.27 | valid ppl    71.75 | valid bpc    6.165
-----------------------------------------------------------------------------------------
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  216 batches | lr 0.00002 | ms/batch 75.80 | loss  2.91 | ppl    18.37 
| epoch  58 |   200/  216 batches | lr 0.00002 | ms/batch 74.56 | loss  2.86 | ppl    17.48 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 16.70s | valid loss  4.28 | valid ppl    71.94 | valid bpc    6.169
-----------------------------------------------------------------------------------------
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  216 batches | lr 0.00002 | ms/batch 75.70 | loss  2.90 | ppl    18.23 
| epoch  59 |   200/  216 batches | lr 0.00002 | ms/batch 74.62 | loss  2.87 | ppl    17.68 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 16.70s | valid loss  4.24 | valid ppl    69.36 | valid bpc    6.116
-----------------------------------------------------------------------------------------
PROGRESS: 59.0%
| epoch  60 |   100/  216 batches | lr 0.00001 | ms/batch 75.82 | loss  2.89 | ppl    17.98 
| epoch  60 |   200/  216 batches | lr 0.00001 | ms/batch 74.50 | loss  2.86 | ppl    17.53 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 16.70s | valid loss  4.29 | valid ppl    73.19 | valid bpc    6.193
-----------------------------------------------------------------------------------------
PROGRESS: 60.0%
| epoch  61 |   100/  216 batches | lr 0.00001 | ms/batch 75.59 | loss  2.87 | ppl    17.56 
| epoch  61 |   200/  216 batches | lr 0.00001 | ms/batch 74.82 | loss  2.86 | ppl    17.41 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 16.69s | valid loss  4.24 | valid ppl    69.32 | valid bpc    6.115
-----------------------------------------------------------------------------------------
PROGRESS: 61.0%
| epoch  62 |   100/  216 batches | lr 0.00001 | ms/batch 75.61 | loss  2.87 | ppl    17.68 
| epoch  62 |   200/  216 batches | lr 0.00001 | ms/batch 74.65 | loss  2.86 | ppl    17.46 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 16.69s | valid loss  4.25 | valid ppl    70.40 | valid bpc    6.138
-----------------------------------------------------------------------------------------
PROGRESS: 62.0%
| epoch  63 |   100/  216 batches | lr 0.00000 | ms/batch 75.51 | loss  2.88 | ppl    17.80 
| epoch  63 |   200/  216 batches | lr 0.00000 | ms/batch 74.57 | loss  2.84 | ppl    17.13 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 16.69s | valid loss  4.22 | valid ppl    67.99 | valid bpc    6.087
-----------------------------------------------------------------------------------------
PROGRESS: 63.0%
| epoch  64 |   100/  216 batches | lr 0.00000 | ms/batch 76.07 | loss  2.88 | ppl    17.83 
| epoch  64 |   200/  216 batches | lr 0.00000 | ms/batch 74.34 | loss  2.85 | ppl    17.22 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 16.70s | valid loss  4.21 | valid ppl    67.33 | valid bpc    6.073
-----------------------------------------------------------------------------------------
PROGRESS: 64.0%
| epoch  65 |   100/  216 batches | lr 0.00000 | ms/batch 75.66 | loss  2.87 | ppl    17.70 
| epoch  65 |   200/  216 batches | lr 0.00000 | ms/batch 74.58 | loss  2.86 | ppl    17.44 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 16.69s | valid loss  4.25 | valid ppl    70.26 | valid bpc    6.135
-----------------------------------------------------------------------------------------
PROGRESS: 65.0%
| epoch  66 |   100/  216 batches | lr 0.00000 | ms/batch 75.41 | loss  2.88 | ppl    17.82 
| epoch  66 |   200/  216 batches | lr 0.00000 | ms/batch 74.79 | loss  2.86 | ppl    17.44 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 16.70s | valid loss  4.20 | valid ppl    66.56 | valid bpc    6.056
-----------------------------------------------------------------------------------------
PROGRESS: 66.0%
| epoch  67 |   100/  216 batches | lr 0.00000 | ms/batch 76.15 | loss  2.88 | ppl    17.73 
| epoch  67 |   200/  216 batches | lr 0.00000 | ms/batch 74.21 | loss  2.86 | ppl    17.48 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 16.69s | valid loss  4.26 | valid ppl    70.90 | valid bpc    6.148
-----------------------------------------------------------------------------------------
PROGRESS: 67.0%
| epoch  68 |   100/  216 batches | lr 0.00000 | ms/batch 75.89 | loss  2.86 | ppl    17.53 
| epoch  68 |   200/  216 batches | lr 0.00000 | ms/batch 74.50 | loss  2.83 | ppl    16.92 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 16.69s | valid loss  4.23 | valid ppl    69.02 | valid bpc    6.109
-----------------------------------------------------------------------------------------
PROGRESS: 68.0%
| epoch  69 |   100/  216 batches | lr 0.00000 | ms/batch 75.59 | loss  2.88 | ppl    17.79 
| epoch  69 |   200/  216 batches | lr 0.00000 | ms/batch 74.82 | loss  2.85 | ppl    17.26 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 16.69s | valid loss  4.24 | valid ppl    69.54 | valid bpc    6.120
-----------------------------------------------------------------------------------------
PROGRESS: 69.0%
| epoch  70 |   100/  216 batches | lr 0.00000 | ms/batch 76.00 | loss  2.91 | ppl    18.43 
| epoch  70 |   200/  216 batches | lr 0.00000 | ms/batch 74.17 | loss  2.82 | ppl    16.86 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 16.69s | valid loss  4.27 | valid ppl    71.21 | valid bpc    6.154
-----------------------------------------------------------------------------------------
PROGRESS: 70.0%
| epoch  71 |   100/  216 batches | lr 0.00000 | ms/batch 75.80 | loss  2.89 | ppl    17.93 
| epoch  71 |   200/  216 batches | lr 0.00000 | ms/batch 74.45 | loss  2.82 | ppl    16.84 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 16.69s | valid loss  4.23 | valid ppl    69.01 | valid bpc    6.109
-----------------------------------------------------------------------------------------
PROGRESS: 71.0%
| epoch  72 |   100/  216 batches | lr 0.00000 | ms/batch 75.33 | loss  2.87 | ppl    17.56 
| epoch  72 |   200/  216 batches | lr 0.00000 | ms/batch 74.87 | loss  2.85 | ppl    17.31 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 16.68s | valid loss  4.25 | valid ppl    69.90 | valid bpc    6.127
-----------------------------------------------------------------------------------------
PROGRESS: 72.0%
| epoch  73 |   100/  216 batches | lr 0.00000 | ms/batch 75.81 | loss  2.87 | ppl    17.71 
| epoch  73 |   200/  216 batches | lr 0.00000 | ms/batch 74.43 | loss  2.82 | ppl    16.80 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 16.69s | valid loss  4.26 | valid ppl    71.10 | valid bpc    6.152
-----------------------------------------------------------------------------------------
PROGRESS: 73.0%
| epoch  74 |   100/  216 batches | lr 0.00000 | ms/batch 75.67 | loss  2.89 | ppl    17.93 
| epoch  74 |   200/  216 batches | lr 0.00000 | ms/batch 74.55 | loss  2.85 | ppl    17.30 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 16.69s | valid loss  4.26 | valid ppl    71.12 | valid bpc    6.152
-----------------------------------------------------------------------------------------
PROGRESS: 74.0%
| epoch  75 |   100/  216 batches | lr 0.00000 | ms/batch 75.95 | loss  2.88 | ppl    17.73 
| epoch  75 |   200/  216 batches | lr 0.00000 | ms/batch 74.30 | loss  2.83 | ppl    17.01 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 16.69s | valid loss  4.24 | valid ppl    69.73 | valid bpc    6.124
-----------------------------------------------------------------------------------------
PROGRESS: 75.0%
| epoch  76 |   100/  216 batches | lr 0.00000 | ms/batch 75.55 | loss  2.88 | ppl    17.86 
| epoch  76 |   200/  216 batches | lr 0.00000 | ms/batch 74.37 | loss  2.84 | ppl    17.08 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 16.69s | valid loss  4.23 | valid ppl    68.63 | valid bpc    6.101
-----------------------------------------------------------------------------------------
PROGRESS: 76.0%
| epoch  77 |   100/  216 batches | lr 0.00000 | ms/batch 75.78 | loss  2.88 | ppl    17.80 
| epoch  77 |   200/  216 batches | lr 0.00000 | ms/batch 74.43 | loss  2.86 | ppl    17.39 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 16.69s | valid loss  4.21 | valid ppl    67.24 | valid bpc    6.071
-----------------------------------------------------------------------------------------
PROGRESS: 77.0%
| epoch  78 |   100/  216 batches | lr 0.00000 | ms/batch 76.02 | loss  2.86 | ppl    17.42 
| epoch  78 |   200/  216 batches | lr 0.00000 | ms/batch 74.28 | loss  2.83 | ppl    16.98 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 16.69s | valid loss  4.23 | valid ppl    68.88 | valid bpc    6.106
-----------------------------------------------------------------------------------------
PROGRESS: 78.0%
| epoch  79 |   100/  216 batches | lr 0.00000 | ms/batch 75.96 | loss  2.86 | ppl    17.47 
| epoch  79 |   200/  216 batches | lr 0.00000 | ms/batch 74.28 | loss  2.84 | ppl    17.20 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 16.69s | valid loss  4.25 | valid ppl    70.34 | valid bpc    6.136
-----------------------------------------------------------------------------------------
PROGRESS: 79.0%
| epoch  80 |   100/  216 batches | lr 0.00000 | ms/batch 75.86 | loss  2.88 | ppl    17.76 
| epoch  80 |   200/  216 batches | lr 0.00000 | ms/batch 74.46 | loss  2.84 | ppl    17.04 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 16.69s | valid loss  4.23 | valid ppl    68.51 | valid bpc    6.098
-----------------------------------------------------------------------------------------
PROGRESS: 80.0%
| epoch  81 |   100/  216 batches | lr 0.00000 | ms/batch 75.85 | loss  2.87 | ppl    17.60 
| epoch  81 |   200/  216 batches | lr 0.00000 | ms/batch 74.35 | loss  2.84 | ppl    17.04 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 16.69s | valid loss  4.23 | valid ppl    68.75 | valid bpc    6.103
-----------------------------------------------------------------------------------------
PROGRESS: 81.0%
| epoch  82 |   100/  216 batches | lr 0.00000 | ms/batch 75.40 | loss  2.89 | ppl    17.96 
| epoch  82 |   200/  216 batches | lr 0.00000 | ms/batch 74.85 | loss  2.83 | ppl    16.93 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 16.69s | valid loss  4.20 | valid ppl    66.77 | valid bpc    6.061
-----------------------------------------------------------------------------------------
PROGRESS: 82.0%
| epoch  83 |   100/  216 batches | lr 0.00000 | ms/batch 75.75 | loss  2.88 | ppl    17.73 
| epoch  83 |   200/  216 batches | lr 0.00000 | ms/batch 74.49 | loss  2.85 | ppl    17.34 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 16.69s | valid loss  4.27 | valid ppl    71.51 | valid bpc    6.160
-----------------------------------------------------------------------------------------
PROGRESS: 83.0%
| epoch  84 |   100/  216 batches | lr 0.00000 | ms/batch 75.51 | loss  2.85 | ppl    17.37 
| epoch  84 |   200/  216 batches | lr 0.00000 | ms/batch 74.70 | loss  2.85 | ppl    17.31 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 16.69s | valid loss  4.26 | valid ppl    70.82 | valid bpc    6.146
-----------------------------------------------------------------------------------------
PROGRESS: 84.0%
| epoch  85 |   100/  216 batches | lr 0.00000 | ms/batch 75.56 | loss  2.88 | ppl    17.87 
| epoch  85 |   200/  216 batches | lr 0.00000 | ms/batch 74.65 | loss  2.85 | ppl    17.27 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 16.68s | valid loss  4.23 | valid ppl    68.51 | valid bpc    6.098
-----------------------------------------------------------------------------------------
PROGRESS: 85.0%
| epoch  86 |   100/  216 batches | lr 0.00000 | ms/batch 75.40 | loss  2.86 | ppl    17.53 
| epoch  86 |   200/  216 batches | lr 0.00000 | ms/batch 74.90 | loss  2.82 | ppl    16.83 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 16.69s | valid loss  4.25 | valid ppl    70.00 | valid bpc    6.129
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  216 batches | lr 0.00000 | ms/batch 75.60 | loss  2.86 | ppl    17.52 
| epoch  87 |   200/  216 batches | lr 0.00000 | ms/batch 74.79 | loss  2.83 | ppl    16.91 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 16.70s | valid loss  4.26 | valid ppl    71.01 | valid bpc    6.150
-----------------------------------------------------------------------------------------
PROGRESS: 87.0%
| epoch  88 |   100/  216 batches | lr 0.00000 | ms/batch 75.96 | loss  2.88 | ppl    17.77 
| epoch  88 |   200/  216 batches | lr 0.00000 | ms/batch 74.35 | loss  2.84 | ppl    17.11 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 16.70s | valid loss  4.23 | valid ppl    68.98 | valid bpc    6.108
-----------------------------------------------------------------------------------------
PROGRESS: 88.0%
| epoch  89 |   100/  216 batches | lr 0.00000 | ms/batch 75.61 | loss  2.86 | ppl    17.39 
| epoch  89 |   200/  216 batches | lr 0.00000 | ms/batch 74.71 | loss  2.85 | ppl    17.32 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 16.69s | valid loss  4.18 | valid ppl    65.57 | valid bpc    6.035
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 89.0%
| epoch  90 |   100/  216 batches | lr 0.00000 | ms/batch 75.77 | loss  2.91 | ppl    18.28 
| epoch  90 |   200/  216 batches | lr 0.00000 | ms/batch 74.54 | loss  2.84 | ppl    17.13 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 16.69s | valid loss  4.22 | valid ppl    68.15 | valid bpc    6.091
-----------------------------------------------------------------------------------------
PROGRESS: 90.0%
| epoch  91 |   100/  216 batches | lr 0.00000 | ms/batch 75.86 | loss  2.86 | ppl    17.41 
| epoch  91 |   200/  216 batches | lr 0.00000 | ms/batch 74.46 | loss  2.85 | ppl    17.32 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 16.69s | valid loss  4.23 | valid ppl    68.90 | valid bpc    6.106
-----------------------------------------------------------------------------------------
PROGRESS: 91.0%
| epoch  92 |   100/  216 batches | lr 0.00000 | ms/batch 75.39 | loss  2.85 | ppl    17.28 
| epoch  92 |   200/  216 batches | lr 0.00000 | ms/batch 74.89 | loss  2.85 | ppl    17.36 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 16.69s | valid loss  4.24 | valid ppl    69.70 | valid bpc    6.123
-----------------------------------------------------------------------------------------
PROGRESS: 92.0%
| epoch  93 |   100/  216 batches | lr 0.00000 | ms/batch 75.91 | loss  2.86 | ppl    17.51 
| epoch  93 |   200/  216 batches | lr 0.00000 | ms/batch 74.40 | loss  2.86 | ppl    17.55 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 16.69s | valid loss  4.24 | valid ppl    69.28 | valid bpc    6.114
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  216 batches | lr 0.00000 | ms/batch 75.81 | loss  2.86 | ppl    17.50 
| epoch  94 |   200/  216 batches | lr 0.00000 | ms/batch 74.50 | loss  2.86 | ppl    17.44 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 16.70s | valid loss  4.24 | valid ppl    69.13 | valid bpc    6.111
-----------------------------------------------------------------------------------------
PROGRESS: 94.0%
| epoch  95 |   100/  216 batches | lr 0.00000 | ms/batch 75.76 | loss  2.86 | ppl    17.44 
| epoch  95 |   200/  216 batches | lr 0.00000 | ms/batch 74.44 | loss  2.84 | ppl    17.04 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 16.69s | valid loss  4.21 | valid ppl    67.51 | valid bpc    6.077
-----------------------------------------------------------------------------------------
PROGRESS: 95.0%
| epoch  96 |   100/  216 batches | lr 0.00000 | ms/batch 75.55 | loss  2.85 | ppl    17.31 
| epoch  96 |   200/  216 batches | lr 0.00000 | ms/batch 74.29 | loss  2.82 | ppl    16.80 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 16.69s | valid loss  4.22 | valid ppl    67.76 | valid bpc    6.082
-----------------------------------------------------------------------------------------
PROGRESS: 96.0%
| epoch  97 |   100/  216 batches | lr 0.00000 | ms/batch 76.00 | loss  2.87 | ppl    17.64 
| epoch  97 |   200/  216 batches | lr 0.00000 | ms/batch 74.31 | loss  2.84 | ppl    17.19 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 16.70s | valid loss  4.21 | valid ppl    67.04 | valid bpc    6.067
-----------------------------------------------------------------------------------------
PROGRESS: 97.0%
| epoch  98 |   100/  216 batches | lr 0.00000 | ms/batch 75.33 | loss  2.86 | ppl    17.49 
| epoch  98 |   200/  216 batches | lr 0.00000 | ms/batch 75.01 | loss  2.85 | ppl    17.33 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 16.69s | valid loss  4.25 | valid ppl    70.21 | valid bpc    6.134
-----------------------------------------------------------------------------------------
PROGRESS: 98.0%
| epoch  99 |   100/  216 batches | lr 0.00000 | ms/batch 75.59 | loss  2.84 | ppl    17.11 
| epoch  99 |   200/  216 batches | lr 0.00000 | ms/batch 74.67 | loss  2.86 | ppl    17.41 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 16.69s | valid loss  4.24 | valid ppl    69.17 | valid bpc    6.112
-----------------------------------------------------------------------------------------
PROGRESS: 99.0%
| epoch 100 |   100/  216 batches | lr 0.00000 | ms/batch 75.42 | loss  2.87 | ppl    17.64 
| epoch 100 |   200/  216 batches | lr 0.00000 | ms/batch 74.91 | loss  2.84 | ppl    17.06 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 16.70s | valid loss  4.25 | valid ppl    70.28 | valid bpc    6.135
-----------------------------------------------------------------------------------------
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  4.20 | test ppl    66.81 | test bpc    6.062
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.3862, Mean Reca: 0.5333, Mean F1: 0.4401
Counter({'NP': 6365, 'PP': 4134, 'VP': 3641, 'S': 3433, 'SBAR': 813, 'QP': 193, 'ADJP': 188, 'SINV': 149, 'ADVP': 147, 'PRN': 44, 'FRAG': 34, 'WHNP': 28, 'SQ': 15, 'WHPP': 11, 'NX': 10, 'SBARQ': 9, 'NAC': 8, 'UCP': 7, 'WHADVP': 6, 'CONJP': 2, 'X': 2, 'WHADJP': 1})
Counter({'NP': 14432, 'VP': 8130, 'S': 5620, 'PP': 5484, 'SBAR': 1796, 'ADJP': 649, 'QP': 490, 'ADVP': 286, 'SINV': 157, 'PRN': 128, 'NX': 95, 'FRAG': 42, 'WHNP': 37, 'UCP': 32, 'NAC': 30, 'WHPP': 25, 'CONJP': 21, 'SQ': 18, 'SBARQ': 10, 'WHADVP': 9, 'X': 6, 'WHADJP': 4, 'INTJ': 1})
SBAR: 0.4527
NP: 0.4410
VP: 0.4478
PP: 0.7538
ADJP: 0.2897
ADVP: 0.5140
4.946526317302153
-----------------------------------------------------------------------------------------
Dependency parsing performance:
Conll-U Style:
DDA: 0.393
UDA: 0.546
=========================================================================================
