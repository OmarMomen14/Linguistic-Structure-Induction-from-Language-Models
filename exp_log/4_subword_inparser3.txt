Loading dataset...
Using subword tokenizer...
Number of tokens:  8000
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer_in_parser', nhid=512, nlayers=8, front_layers=5, rear_layers=3, subword='omarmomen/ptb_filtered_lowcase_bpe_tokenizer_8', n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=1111, nonmono=5, cuda=True, log_interval=100, save='trained_models/subword_structformer_in_parser_1111_53.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 37449076
Model architecture: StructFormer_In_Parser(
  (transformer_front): Transformer_Front(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(8000, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-4): 5 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
  (transformer_rear): Transformer_Rear(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(8000, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-2): 3 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (output_layer): Linear(in_features=512, out_features=8000, bias=True)
  )
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  269 batches | lr 0.00030 | ms/batch 251.89 | loss  7.78 | ppl  2381.81 
| epoch   1 |   200/  269 batches | lr 0.00030 | ms/batch 225.79 | loss  7.37 | ppl  1591.24 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 65.34s | valid loss  7.08 | valid ppl  1190.56 | valid bpc   10.217
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  269 batches | lr 0.00030 | ms/batch 241.50 | loss  7.30 | ppl  1480.22 
| epoch   2 |   200/  269 batches | lr 0.00030 | ms/batch 226.61 | loss  7.16 | ppl  1289.82 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 64.20s | valid loss  6.97 | valid ppl  1060.06 | valid bpc   10.050
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  269 batches | lr 0.00030 | ms/batch 240.25 | loss  7.15 | ppl  1279.91 
| epoch   3 |   200/  269 batches | lr 0.00030 | ms/batch 227.91 | loss  6.98 | ppl  1074.29 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 64.34s | valid loss  6.48 | valid ppl   653.07 | valid bpc    9.351
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  269 batches | lr 0.00030 | ms/batch 239.81 | loss  6.56 | ppl   708.01 
| epoch   4 |   200/  269 batches | lr 0.00030 | ms/batch 227.77 | loss  6.33 | ppl   563.22 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 64.29s | valid loss  5.93 | valid ppl   375.43 | valid bpc    8.552
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  269 batches | lr 0.00030 | ms/batch 245.73 | loss  6.12 | ppl   453.23 
| epoch   5 |   200/  269 batches | lr 0.00030 | ms/batch 224.04 | loss  5.93 | ppl   375.23 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 64.33s | valid loss  5.65 | valid ppl   283.69 | valid bpc    8.148
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  269 batches | lr 0.00030 | ms/batch 248.88 | loss  5.80 | ppl   328.75 
| epoch   6 |   200/  269 batches | lr 0.00030 | ms/batch 220.04 | loss  5.68 | ppl   292.69 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 64.44s | valid loss  5.44 | valid ppl   230.12 | valid bpc    7.846
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  269 batches | lr 0.00030 | ms/batch 250.54 | loss  5.60 | ppl   269.75 
| epoch   7 |   200/  269 batches | lr 0.00030 | ms/batch 216.87 | loss  5.51 | ppl   246.24 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 64.32s | valid loss  5.28 | valid ppl   196.66 | valid bpc    7.620
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  269 batches | lr 0.00030 | ms/batch 251.62 | loss  5.44 | ppl   231.09 
| epoch   8 |   200/  269 batches | lr 0.00030 | ms/batch 217.63 | loss  5.35 | ppl   210.51 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 64.41s | valid loss  5.15 | valid ppl   173.07 | valid bpc    7.435
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 8.0%
| epoch   9 |   100/  269 batches | lr 0.00030 | ms/batch 251.54 | loss  5.33 | ppl   206.53 
| epoch   9 |   200/  269 batches | lr 0.00030 | ms/batch 219.72 | loss  5.24 | ppl   189.13 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 64.65s | valid loss  5.04 | valid ppl   154.00 | valid bpc    7.267
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  269 batches | lr 0.00030 | ms/batch 251.60 | loss  5.20 | ppl   182.13 
| epoch  10 |   200/  269 batches | lr 0.00030 | ms/batch 217.76 | loss  5.12 | ppl   167.58 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 64.40s | valid loss  4.98 | valid ppl   146.07 | valid bpc    7.191
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  269 batches | lr 0.00030 | ms/batch 251.56 | loss  5.11 | ppl   165.17 
| epoch  11 |   200/  269 batches | lr 0.00030 | ms/batch 217.20 | loss  5.01 | ppl   149.40 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 64.41s | valid loss  4.87 | valid ppl   130.10 | valid bpc    7.023
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  269 batches | lr 0.00030 | ms/batch 251.75 | loss  5.03 | ppl   152.69 
| epoch  12 |   200/  269 batches | lr 0.00030 | ms/batch 217.98 | loss  4.91 | ppl   136.11 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 64.42s | valid loss  4.80 | valid ppl   121.17 | valid bpc    6.921
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 12.0%
| epoch  13 |   100/  269 batches | lr 0.00030 | ms/batch 250.55 | loss  4.91 | ppl   135.28 
| epoch  13 |   200/  269 batches | lr 0.00030 | ms/batch 217.93 | loss  4.84 | ppl   126.78 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 64.35s | valid loss  4.68 | valid ppl   107.30 | valid bpc    6.746
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 13.0%
| epoch  14 |   100/  269 batches | lr 0.00030 | ms/batch 250.59 | loss  4.83 | ppl   124.83 
| epoch  14 |   200/  269 batches | lr 0.00030 | ms/batch 218.55 | loss  4.76 | ppl   116.57 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 64.48s | valid loss  4.62 | valid ppl   101.53 | valid bpc    6.666
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  269 batches | lr 0.00030 | ms/batch 250.52 | loss  4.74 | ppl   114.92 
| epoch  15 |   200/  269 batches | lr 0.00030 | ms/batch 221.68 | loss  4.68 | ppl   108.26 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 64.76s | valid loss  4.55 | valid ppl    94.47 | valid bpc    6.562
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 15.0%
| epoch  16 |   100/  269 batches | lr 0.00030 | ms/batch 250.87 | loss  4.65 | ppl   104.09 
| epoch  16 |   200/  269 batches | lr 0.00030 | ms/batch 220.00 | loss  4.64 | ppl   103.73 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 64.57s | valid loss  4.53 | valid ppl    93.13 | valid bpc    6.541
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 16.0%
| epoch  17 |   100/  269 batches | lr 0.00030 | ms/batch 251.63 | loss  4.59 | ppl    98.26 
| epoch  17 |   200/  269 batches | lr 0.00030 | ms/batch 219.47 | loss  4.54 | ppl    93.91 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 64.65s | valid loss  4.48 | valid ppl    88.13 | valid bpc    6.462
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 17.0%
| epoch  18 |   100/  269 batches | lr 0.00030 | ms/batch 250.19 | loss  4.52 | ppl    92.06 
| epoch  18 |   200/  269 batches | lr 0.00030 | ms/batch 222.89 | loss  4.48 | ppl    88.00 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 64.86s | valid loss  4.46 | valid ppl    86.35 | valid bpc    6.432
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 18.0%
| epoch  19 |   100/  269 batches | lr 0.00030 | ms/batch 251.21 | loss  4.48 | ppl    87.88 
| epoch  19 |   200/  269 batches | lr 0.00030 | ms/batch 222.31 | loss  4.40 | ppl    81.63 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 65.01s | valid loss  4.39 | valid ppl    80.97 | valid bpc    6.339
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 19.0%
| epoch  20 |   100/  269 batches | lr 0.00030 | ms/batch 252.76 | loss  4.39 | ppl    80.54 
| epoch  20 |   200/  269 batches | lr 0.00030 | ms/batch 220.35 | loss  4.33 | ppl    76.24 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 64.76s | valid loss  4.30 | valid ppl    73.79 | valid bpc    6.205
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 20.0%
| epoch  21 |   100/  269 batches | lr 0.00030 | ms/batch 250.20 | loss  4.32 | ppl    75.45 
| epoch  21 |   200/  269 batches | lr 0.00030 | ms/batch 217.49 | loss  4.32 | ppl    75.12 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 64.40s | valid loss  4.28 | valid ppl    71.93 | valid bpc    6.168
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 21.0%
| epoch  22 |   100/  269 batches | lr 0.00030 | ms/batch 251.42 | loss  4.27 | ppl    71.63 
| epoch  22 |   200/  269 batches | lr 0.00030 | ms/batch 226.42 | loss  4.24 | ppl    69.62 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 65.26s | valid loss  4.23 | valid ppl    68.63 | valid bpc    6.101
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 22.0%
| epoch  23 |   100/  269 batches | lr 0.00030 | ms/batch 251.64 | loss  4.24 | ppl    69.16 
| epoch  23 |   200/  269 batches | lr 0.00030 | ms/batch 204.96 | loss  4.18 | ppl    65.43 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 63.18s | valid loss  4.20 | valid ppl    66.46 | valid bpc    6.054
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 23.0%
| epoch  24 |   100/  269 batches | lr 0.00030 | ms/batch 250.30 | loss  4.17 | ppl    64.59 
| epoch  24 |   200/  269 batches | lr 0.00030 | ms/batch 221.83 | loss  4.14 | ppl    62.83 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 63.37s | valid loss  4.20 | valid ppl    66.72 | valid bpc    6.060
-----------------------------------------------------------------------------------------
PROGRESS: 24.0%
| epoch  25 |   100/  269 batches | lr 0.00030 | ms/batch 251.64 | loss  4.14 | ppl    62.51 
| epoch  25 |   200/  269 batches | lr 0.00030 | ms/batch 236.40 | loss  4.06 | ppl    57.87 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 65.31s | valid loss  4.15 | valid ppl    63.43 | valid bpc    5.987
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 25.0%
| epoch  26 |   100/  269 batches | lr 0.00030 | ms/batch 251.32 | loss  4.08 | ppl    59.07 
| epoch  26 |   200/  269 batches | lr 0.00030 | ms/batch 237.42 | loss  4.03 | ppl    55.98 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 64.95s | valid loss  4.14 | valid ppl    62.67 | valid bpc    5.970
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 26.0%
| epoch  27 |   100/  269 batches | lr 0.00030 | ms/batch 251.39 | loss  4.00 | ppl    54.61 
| epoch  27 |   200/  269 batches | lr 0.00030 | ms/batch 236.26 | loss  3.99 | ppl    54.01 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 65.26s | valid loss  4.12 | valid ppl    61.49 | valid bpc    5.942
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 27.0%
| epoch  28 |   100/  269 batches | lr 0.00030 | ms/batch 250.24 | loss  3.97 | ppl    52.97 
| epoch  28 |   200/  269 batches | lr 0.00030 | ms/batch 237.57 | loss  3.93 | ppl    50.86 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 64.98s | valid loss  4.11 | valid ppl    60.83 | valid bpc    5.927
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  269 batches | lr 0.00030 | ms/batch 250.59 | loss  3.93 | ppl    50.70 
| epoch  29 |   200/  269 batches | lr 0.00030 | ms/batch 237.19 | loss  3.90 | ppl    49.19 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 64.90s | valid loss  4.07 | valid ppl    58.73 | valid bpc    5.876
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  269 batches | lr 0.00030 | ms/batch 251.31 | loss  3.88 | ppl    48.38 
| epoch  30 |   200/  269 batches | lr 0.00030 | ms/batch 237.65 | loss  3.84 | ppl    46.76 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 65.02s | valid loss  4.04 | valid ppl    56.91 | valid bpc    5.831
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 30.0%
| epoch  31 |   100/  269 batches | lr 0.00030 | ms/batch 250.81 | loss  3.85 | ppl    46.89 
| epoch  31 |   200/  269 batches | lr 0.00030 | ms/batch 237.37 | loss  3.84 | ppl    46.31 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 64.54s | valid loss  4.02 | valid ppl    55.62 | valid bpc    5.798
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 31.0%
| epoch  32 |   100/  269 batches | lr 0.00030 | ms/batch 250.62 | loss  3.78 | ppl    43.95 
| epoch  32 |   200/  269 batches | lr 0.00030 | ms/batch 238.47 | loss  3.79 | ppl    44.26 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 65.01s | valid loss  4.07 | valid ppl    58.50 | valid bpc    5.870
-----------------------------------------------------------------------------------------
PROGRESS: 32.0%
| epoch  33 |   100/  269 batches | lr 0.00030 | ms/batch 252.16 | loss  3.78 | ppl    43.93 
| epoch  33 |   200/  269 batches | lr 0.00030 | ms/batch 236.83 | loss  3.74 | ppl    41.92 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 64.98s | valid loss  3.96 | valid ppl    52.40 | valid bpc    5.712
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 33.0%
| epoch  34 |   100/  269 batches | lr 0.00030 | ms/batch 250.57 | loss  3.72 | ppl    41.38 
| epoch  34 |   200/  269 batches | lr 0.00030 | ms/batch 237.06 | loss  3.69 | ppl    40.18 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 64.91s | valid loss  3.94 | valid ppl    51.21 | valid bpc    5.678
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 34.0%
| epoch  35 |   100/  269 batches | lr 0.00030 | ms/batch 251.36 | loss  3.67 | ppl    39.06 
| epoch  35 |   200/  269 batches | lr 0.00030 | ms/batch 237.36 | loss  3.70 | ppl    40.41 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 64.97s | valid loss  3.99 | valid ppl    54.19 | valid bpc    5.760
-----------------------------------------------------------------------------------------
PROGRESS: 35.0%
| epoch  36 |   100/  269 batches | lr 0.00030 | ms/batch 251.70 | loss  3.67 | ppl    39.25 
| epoch  36 |   200/  269 batches | lr 0.00030 | ms/batch 238.16 | loss  3.66 | ppl    38.83 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 65.01s | valid loss  3.92 | valid ppl    50.62 | valid bpc    5.662
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 36.0%
| epoch  37 |   100/  269 batches | lr 0.00030 | ms/batch 250.84 | loss  3.63 | ppl    37.87 
| epoch  37 |   200/  269 batches | lr 0.00030 | ms/batch 237.19 | loss  3.64 | ppl    38.04 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 65.30s | valid loss  3.93 | valid ppl    51.06 | valid bpc    5.674
-----------------------------------------------------------------------------------------
PROGRESS: 37.0%
| epoch  38 |   100/  269 batches | lr 0.00030 | ms/batch 251.31 | loss  3.59 | ppl    36.26 
| epoch  38 |   200/  269 batches | lr 0.00030 | ms/batch 237.11 | loss  3.59 | ppl    36.22 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 65.27s | valid loss  3.91 | valid ppl    49.87 | valid bpc    5.640
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 38.0%
| epoch  39 |   100/  269 batches | lr 0.00030 | ms/batch 252.13 | loss  3.57 | ppl    35.57 
| epoch  39 |   200/  269 batches | lr 0.00030 | ms/batch 236.82 | loss  3.55 | ppl    34.90 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 64.94s | valid loss  3.92 | valid ppl    50.42 | valid bpc    5.656
-----------------------------------------------------------------------------------------
PROGRESS: 39.0%
| epoch  40 |   100/  269 batches | lr 0.00030 | ms/batch 252.56 | loss  3.54 | ppl    34.31 
| epoch  40 |   200/  269 batches | lr 0.00030 | ms/batch 236.61 | loss  3.51 | ppl    33.43 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 65.18s | valid loss  3.91 | valid ppl    49.92 | valid bpc    5.641
-----------------------------------------------------------------------------------------
PROGRESS: 40.0%
| epoch  41 |   100/  269 batches | lr 0.00030 | ms/batch 244.42 | loss  3.49 | ppl    32.94 
| epoch  41 |   200/  269 batches | lr 0.00030 | ms/batch 238.28 | loss  3.50 | ppl    32.97 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 64.93s | valid loss  3.91 | valid ppl    49.67 | valid bpc    5.634
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 41.0%
| epoch  42 |   100/  269 batches | lr 0.00030 | ms/batch 245.22 | loss  3.45 | ppl    31.48 
| epoch  42 |   200/  269 batches | lr 0.00030 | ms/batch 238.28 | loss  3.45 | ppl    31.66 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 64.95s | valid loss  3.96 | valid ppl    52.20 | valid bpc    5.706
-----------------------------------------------------------------------------------------
PROGRESS: 42.0%
| epoch  43 |   100/  269 batches | lr 0.00030 | ms/batch 245.79 | loss  3.45 | ppl    31.35 
| epoch  43 |   200/  269 batches | lr 0.00030 | ms/batch 236.23 | loss  3.43 | ppl    30.89 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 65.26s | valid loss  3.86 | valid ppl    47.57 | valid bpc    5.572
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 43.0%
| epoch  44 |   100/  269 batches | lr 0.00030 | ms/batch 245.00 | loss  3.41 | ppl    30.38 
| epoch  44 |   200/  269 batches | lr 0.00030 | ms/batch 237.72 | loss  3.39 | ppl    29.76 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 65.36s | valid loss  3.92 | valid ppl    50.39 | valid bpc    5.655
-----------------------------------------------------------------------------------------
PROGRESS: 44.0%
| epoch  45 |   100/  269 batches | lr 0.00030 | ms/batch 245.31 | loss  3.40 | ppl    29.84 
| epoch  45 |   200/  269 batches | lr 0.00030 | ms/batch 238.83 | loss  3.39 | ppl    29.73 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 65.00s | valid loss  3.85 | valid ppl    47.15 | valid bpc    5.559
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 45.0%
| epoch  46 |   100/  269 batches | lr 0.00030 | ms/batch 242.17 | loss  3.38 | ppl    29.26 
| epoch  46 |   200/  269 batches | lr 0.00030 | ms/batch 237.47 | loss  3.35 | ppl    28.40 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 64.95s | valid loss  3.86 | valid ppl    47.24 | valid bpc    5.562
-----------------------------------------------------------------------------------------
PROGRESS: 46.0%
| epoch  47 |   100/  269 batches | lr 0.00030 | ms/batch 246.25 | loss  3.35 | ppl    28.39 
| epoch  47 |   200/  269 batches | lr 0.00030 | ms/batch 237.69 | loss  3.31 | ppl    27.28 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 65.34s | valid loss  3.85 | valid ppl    46.86 | valid bpc    5.550
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 47.0%
| epoch  48 |   100/  269 batches | lr 0.00030 | ms/batch 245.19 | loss  3.30 | ppl    27.12 
| epoch  48 |   200/  269 batches | lr 0.00030 | ms/batch 238.13 | loss  3.31 | ppl    27.29 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 65.33s | valid loss  3.88 | valid ppl    48.56 | valid bpc    5.602
-----------------------------------------------------------------------------------------
PROGRESS: 48.0%
| epoch  49 |   100/  269 batches | lr 0.00030 | ms/batch 245.89 | loss  3.25 | ppl    25.85 
| epoch  49 |   200/  269 batches | lr 0.00030 | ms/batch 237.49 | loss  3.29 | ppl    26.84 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 65.35s | valid loss  3.81 | valid ppl    45.17 | valid bpc    5.497
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 49.0%
| epoch  50 |   100/  269 batches | lr 0.00030 | ms/batch 246.17 | loss  3.27 | ppl    26.28 
| epoch  50 |   200/  269 batches | lr 0.00030 | ms/batch 237.46 | loss  3.26 | ppl    26.13 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 64.94s | valid loss  3.87 | valid ppl    48.13 | valid bpc    5.589
-----------------------------------------------------------------------------------------
PROGRESS: 50.0%
| epoch  51 |   100/  269 batches | lr 0.00030 | ms/batch 246.23 | loss  3.25 | ppl    25.85 
| epoch  51 |   200/  269 batches | lr 0.00030 | ms/batch 237.99 | loss  3.23 | ppl    25.30 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 65.35s | valid loss  3.81 | valid ppl    45.36 | valid bpc    5.503
-----------------------------------------------------------------------------------------
PROGRESS: 51.0%
| epoch  52 |   100/  269 batches | lr 0.00030 | ms/batch 245.11 | loss  3.18 | ppl    24.01 
| epoch  52 |   200/  269 batches | lr 0.00030 | ms/batch 239.31 | loss  3.22 | ppl    24.97 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 65.34s | valid loss  3.80 | valid ppl    44.92 | valid bpc    5.489
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 52.0%
| epoch  53 |   100/  269 batches | lr 0.00030 | ms/batch 246.28 | loss  3.20 | ppl    24.51 
| epoch  53 |   200/  269 batches | lr 0.00030 | ms/batch 236.52 | loss  3.17 | ppl    23.82 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 65.02s | valid loss  3.82 | valid ppl    45.69 | valid bpc    5.514
-----------------------------------------------------------------------------------------
PROGRESS: 53.0%
| epoch  54 |   100/  269 batches | lr 0.00030 | ms/batch 246.20 | loss  3.17 | ppl    23.72 
| epoch  54 |   200/  269 batches | lr 0.00030 | ms/batch 238.22 | loss  3.18 | ppl    23.99 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 65.38s | valid loss  3.87 | valid ppl    47.71 | valid bpc    5.576
-----------------------------------------------------------------------------------------
PROGRESS: 54.0%
| epoch  55 |   100/  269 batches | lr 0.00030 | ms/batch 246.23 | loss  3.13 | ppl    22.79 
| epoch  55 |   200/  269 batches | lr 0.00030 | ms/batch 237.65 | loss  3.15 | ppl    23.32 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 65.35s | valid loss  3.84 | valid ppl    46.52 | valid bpc    5.540
-----------------------------------------------------------------------------------------
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  269 batches | lr 0.00015 | ms/batch 246.37 | loss  3.08 | ppl    21.81 
| epoch  56 |   200/  269 batches | lr 0.00015 | ms/batch 237.24 | loss  3.04 | ppl    20.95 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 65.35s | valid loss  3.78 | valid ppl    43.88 | valid bpc    5.455
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  269 batches | lr 0.00015 | ms/batch 246.37 | loss  3.03 | ppl    20.74 
| epoch  57 |   200/  269 batches | lr 0.00015 | ms/batch 237.16 | loss  3.02 | ppl    20.44 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 65.36s | valid loss  3.76 | valid ppl    42.93 | valid bpc    5.424
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  269 batches | lr 0.00015 | ms/batch 247.06 | loss  2.99 | ppl    19.94 
| epoch  58 |   200/  269 batches | lr 0.00015 | ms/batch 236.37 | loss  2.98 | ppl    19.62 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 65.28s | valid loss  3.75 | valid ppl    42.50 | valid bpc    5.409
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  269 batches | lr 0.00015 | ms/batch 245.70 | loss  2.97 | ppl    19.51 
| epoch  59 |   200/  269 batches | lr 0.00015 | ms/batch 238.08 | loss  2.98 | ppl    19.64 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 65.33s | valid loss  3.81 | valid ppl    45.13 | valid bpc    5.496
-----------------------------------------------------------------------------------------
PROGRESS: 59.0%
| epoch  60 |   100/  269 batches | lr 0.00015 | ms/batch 241.88 | loss  2.97 | ppl    19.50 
| epoch  60 |   200/  269 batches | lr 0.00015 | ms/batch 236.98 | loss  2.94 | ppl    18.99 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 64.98s | valid loss  3.78 | valid ppl    43.98 | valid bpc    5.459
-----------------------------------------------------------------------------------------
PROGRESS: 60.0%
| epoch  61 |   100/  269 batches | lr 0.00015 | ms/batch 245.74 | loss  2.94 | ppl    18.98 
| epoch  61 |   200/  269 batches | lr 0.00015 | ms/batch 236.56 | loss  2.92 | ppl    18.52 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 65.31s | valid loss  3.77 | valid ppl    43.39 | valid bpc    5.439
-----------------------------------------------------------------------------------------
PROGRESS: 61.0%
| epoch  62 |   100/  269 batches | lr 0.00007 | ms/batch 248.32 | loss  2.91 | ppl    18.33 
| epoch  62 |   200/  269 batches | lr 0.00007 | ms/batch 235.89 | loss  2.86 | ppl    17.54 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 65.31s | valid loss  3.79 | valid ppl    44.15 | valid bpc    5.464
-----------------------------------------------------------------------------------------
PROGRESS: 62.0%
| epoch  63 |   100/  269 batches | lr 0.00007 | ms/batch 251.59 | loss  2.88 | ppl    17.73 
| epoch  63 |   200/  269 batches | lr 0.00007 | ms/batch 232.03 | loss  2.83 | ppl    16.92 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 65.30s | valid loss  3.80 | valid ppl    44.89 | valid bpc    5.488
-----------------------------------------------------------------------------------------
PROGRESS: 63.0%
| epoch  64 |   100/  269 batches | lr 0.00007 | ms/batch 252.55 | loss  2.87 | ppl    17.71 
| epoch  64 |   200/  269 batches | lr 0.00007 | ms/batch 231.55 | loss  2.86 | ppl    17.51 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 65.46s | valid loss  3.76 | valid ppl    42.98 | valid bpc    5.426
-----------------------------------------------------------------------------------------
PROGRESS: 64.0%
| epoch  65 |   100/  269 batches | lr 0.00004 | ms/batch 250.83 | loss  2.84 | ppl    17.06 
| epoch  65 |   200/  269 batches | lr 0.00004 | ms/batch 230.66 | loss  2.80 | ppl    16.49 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 65.55s | valid loss  3.74 | valid ppl    42.06 | valid bpc    5.394
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 65.0%
| epoch  66 |   100/  269 batches | lr 0.00004 | ms/batch 252.10 | loss  2.84 | ppl    17.06 
| epoch  66 |   200/  269 batches | lr 0.00004 | ms/batch 231.83 | loss  2.82 | ppl    16.72 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 65.34s | valid loss  3.76 | valid ppl    42.83 | valid bpc    5.420
-----------------------------------------------------------------------------------------
PROGRESS: 66.0%
| epoch  67 |   100/  269 batches | lr 0.00004 | ms/batch 251.66 | loss  2.78 | ppl    16.18 
| epoch  67 |   200/  269 batches | lr 0.00004 | ms/batch 232.41 | loss  2.79 | ppl    16.33 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 65.52s | valid loss  3.70 | valid ppl    40.43 | valid bpc    5.337
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 67.0%
| epoch  68 |   100/  269 batches | lr 0.00004 | ms/batch 252.88 | loss  2.80 | ppl    16.40 
| epoch  68 |   200/  269 batches | lr 0.00004 | ms/batch 227.79 | loss  2.76 | ppl    15.78 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 64.99s | valid loss  3.72 | valid ppl    41.18 | valid bpc    5.364
-----------------------------------------------------------------------------------------
PROGRESS: 68.0%
| epoch  69 |   100/  269 batches | lr 0.00004 | ms/batch 251.70 | loss  2.81 | ppl    16.67 
| epoch  69 |   200/  269 batches | lr 0.00004 | ms/batch 231.14 | loss  2.78 | ppl    16.07 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 65.49s | valid loss  3.76 | valid ppl    42.86 | valid bpc    5.421
-----------------------------------------------------------------------------------------
PROGRESS: 69.0%
| epoch  70 |   100/  269 batches | lr 0.00004 | ms/batch 247.78 | loss  2.78 | ppl    16.11 
| epoch  70 |   200/  269 batches | lr 0.00004 | ms/batch 230.75 | loss  2.76 | ppl    15.76 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 65.40s | valid loss  3.78 | valid ppl    43.65 | valid bpc    5.448
-----------------------------------------------------------------------------------------
PROGRESS: 70.0%
| epoch  71 |   100/  269 batches | lr 0.00002 | ms/batch 240.74 | loss  2.79 | ppl    16.22 
| epoch  71 |   200/  269 batches | lr 0.00002 | ms/batch 232.42 | loss  2.75 | ppl    15.65 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 64.80s | valid loss  3.73 | valid ppl    41.74 | valid bpc    5.383
-----------------------------------------------------------------------------------------
PROGRESS: 71.0%
| epoch  72 |   100/  269 batches | lr 0.00002 | ms/batch 246.70 | loss  2.76 | ppl    15.83 
| epoch  72 |   200/  269 batches | lr 0.00002 | ms/batch 228.77 | loss  2.76 | ppl    15.74 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 65.04s | valid loss  3.74 | valid ppl    42.22 | valid bpc    5.400
-----------------------------------------------------------------------------------------
PROGRESS: 72.0%
| epoch  73 |   100/  269 batches | lr 0.00002 | ms/batch 246.20 | loss  2.78 | ppl    16.09 
| epoch  73 |   200/  269 batches | lr 0.00002 | ms/batch 230.12 | loss  2.73 | ppl    15.35 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 65.25s | valid loss  3.73 | valid ppl    41.62 | valid bpc    5.379
-----------------------------------------------------------------------------------------
PROGRESS: 73.0%
| epoch  74 |   100/  269 batches | lr 0.00001 | ms/batch 246.05 | loss  2.77 | ppl    15.98 
| epoch  74 |   200/  269 batches | lr 0.00001 | ms/batch 230.63 | loss  2.75 | ppl    15.65 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 65.31s | valid loss  3.81 | valid ppl    45.05 | valid bpc    5.493
-----------------------------------------------------------------------------------------
PROGRESS: 74.0%
| epoch  75 |   100/  269 batches | lr 0.00001 | ms/batch 245.91 | loss  2.78 | ppl    16.09 
| epoch  75 |   200/  269 batches | lr 0.00001 | ms/batch 229.99 | loss  2.74 | ppl    15.42 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 65.28s | valid loss  3.66 | valid ppl    38.73 | valid bpc    5.275
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 75.0%
| epoch  76 |   100/  269 batches | lr 0.00001 | ms/batch 245.11 | loss  2.74 | ppl    15.55 
| epoch  76 |   200/  269 batches | lr 0.00001 | ms/batch 231.89 | loss  2.75 | ppl    15.60 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 65.39s | valid loss  3.76 | valid ppl    43.08 | valid bpc    5.429
-----------------------------------------------------------------------------------------
PROGRESS: 76.0%
| epoch  77 |   100/  269 batches | lr 0.00001 | ms/batch 246.05 | loss  2.75 | ppl    15.69 
| epoch  77 |   200/  269 batches | lr 0.00001 | ms/batch 232.43 | loss  2.75 | ppl    15.59 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 65.29s | valid loss  3.68 | valid ppl    39.63 | valid bpc    5.308
-----------------------------------------------------------------------------------------
PROGRESS: 77.0%
| epoch  78 |   100/  269 batches | lr 0.00001 | ms/batch 247.40 | loss  2.74 | ppl    15.43 
| epoch  78 |   200/  269 batches | lr 0.00001 | ms/batch 230.87 | loss  2.73 | ppl    15.35 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 65.34s | valid loss  3.69 | valid ppl    40.23 | valid bpc    5.330
-----------------------------------------------------------------------------------------
PROGRESS: 78.0%
| epoch  79 |   100/  269 batches | lr 0.00000 | ms/batch 245.48 | loss  2.75 | ppl    15.63 
| epoch  79 |   200/  269 batches | lr 0.00000 | ms/batch 236.79 | loss  2.72 | ppl    15.23 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 65.32s | valid loss  3.69 | valid ppl    40.06 | valid bpc    5.324
-----------------------------------------------------------------------------------------
PROGRESS: 79.0%
| epoch  80 |   100/  269 batches | lr 0.00000 | ms/batch 243.93 | loss  2.75 | ppl    15.66 
| epoch  80 |   200/  269 batches | lr 0.00000 | ms/batch 239.38 | loss  2.73 | ppl    15.33 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 65.35s | valid loss  3.80 | valid ppl    44.55 | valid bpc    5.477
-----------------------------------------------------------------------------------------
PROGRESS: 80.0%
| epoch  81 |   100/  269 batches | lr 0.00000 | ms/batch 246.54 | loss  2.77 | ppl    15.98 
| epoch  81 |   200/  269 batches | lr 0.00000 | ms/batch 237.30 | loss  2.71 | ppl    14.97 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 65.32s | valid loss  3.76 | valid ppl    42.77 | valid bpc    5.418
-----------------------------------------------------------------------------------------
PROGRESS: 81.0%
| epoch  82 |   100/  269 batches | lr 0.00000 | ms/batch 245.76 | loss  2.73 | ppl    15.30 
| epoch  82 |   200/  269 batches | lr 0.00000 | ms/batch 237.89 | loss  2.74 | ppl    15.56 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 65.31s | valid loss  3.73 | valid ppl    41.88 | valid bpc    5.388
-----------------------------------------------------------------------------------------
PROGRESS: 82.0%
| epoch  83 |   100/  269 batches | lr 0.00000 | ms/batch 245.86 | loss  2.73 | ppl    15.35 
| epoch  83 |   200/  269 batches | lr 0.00000 | ms/batch 237.27 | loss  2.73 | ppl    15.35 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 65.35s | valid loss  3.76 | valid ppl    42.95 | valid bpc    5.424
-----------------------------------------------------------------------------------------
PROGRESS: 83.0%
| epoch  84 |   100/  269 batches | lr 0.00000 | ms/batch 245.21 | loss  2.75 | ppl    15.68 
| epoch  84 |   200/  269 batches | lr 0.00000 | ms/batch 237.56 | loss  2.73 | ppl    15.40 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 65.30s | valid loss  3.74 | valid ppl    42.14 | valid bpc    5.397
-----------------------------------------------------------------------------------------
PROGRESS: 84.0%
| epoch  85 |   100/  269 batches | lr 0.00000 | ms/batch 246.37 | loss  2.75 | ppl    15.60 
| epoch  85 |   200/  269 batches | lr 0.00000 | ms/batch 237.47 | loss  2.70 | ppl    14.93 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 65.37s | valid loss  3.74 | valid ppl    42.28 | valid bpc    5.402
-----------------------------------------------------------------------------------------
PROGRESS: 85.0%
| epoch  86 |   100/  269 batches | lr 0.00000 | ms/batch 245.29 | loss  2.73 | ppl    15.34 
| epoch  86 |   200/  269 batches | lr 0.00000 | ms/batch 237.36 | loss  2.73 | ppl    15.37 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 65.31s | valid loss  3.71 | valid ppl    40.69 | valid bpc    5.347
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  269 batches | lr 0.00000 | ms/batch 247.83 | loss  2.75 | ppl    15.62 
| epoch  87 |   200/  269 batches | lr 0.00000 | ms/batch 236.19 | loss  2.69 | ppl    14.74 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 65.36s | valid loss  3.79 | valid ppl    44.07 | valid bpc    5.462
-----------------------------------------------------------------------------------------
PROGRESS: 87.0%
| epoch  88 |   100/  269 batches | lr 0.00000 | ms/batch 246.66 | loss  2.76 | ppl    15.77 
| epoch  88 |   200/  269 batches | lr 0.00000 | ms/batch 237.00 | loss  2.72 | ppl    15.16 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 65.33s | valid loss  3.77 | valid ppl    43.52 | valid bpc    5.444
-----------------------------------------------------------------------------------------
PROGRESS: 88.0%
| epoch  89 |   100/  269 batches | lr 0.00000 | ms/batch 246.14 | loss  2.74 | ppl    15.47 
| epoch  89 |   200/  269 batches | lr 0.00000 | ms/batch 236.14 | loss  2.74 | ppl    15.56 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 65.32s | valid loss  3.70 | valid ppl    40.48 | valid bpc    5.339
-----------------------------------------------------------------------------------------
PROGRESS: 89.0%
| epoch  90 |   100/  269 batches | lr 0.00000 | ms/batch 244.95 | loss  2.74 | ppl    15.48 
| epoch  90 |   200/  269 batches | lr 0.00000 | ms/batch 237.41 | loss  2.70 | ppl    14.95 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 65.57s | valid loss  3.72 | valid ppl    41.25 | valid bpc    5.366
-----------------------------------------------------------------------------------------
PROGRESS: 90.0%
| epoch  91 |   100/  269 batches | lr 0.00000 | ms/batch 244.09 | loss  2.75 | ppl    15.66 
| epoch  91 |   200/  269 batches | lr 0.00000 | ms/batch 237.33 | loss  2.74 | ppl    15.49 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 65.66s | valid loss  3.76 | valid ppl    43.02 | valid bpc    5.427
-----------------------------------------------------------------------------------------
PROGRESS: 91.0%
| epoch  92 |   100/  269 batches | lr 0.00000 | ms/batch 233.03 | loss  2.76 | ppl    15.80 
| epoch  92 |   200/  269 batches | lr 0.00000 | ms/batch 237.85 | loss  2.71 | ppl    15.07 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 64.69s | valid loss  3.74 | valid ppl    42.08 | valid bpc    5.395
-----------------------------------------------------------------------------------------
PROGRESS: 92.0%
| epoch  93 |   100/  269 batches | lr 0.00000 | ms/batch 186.09 | loss  2.75 | ppl    15.62 
| epoch  93 |   200/  269 batches | lr 0.00000 | ms/batch 170.33 | loss  2.70 | ppl    14.86 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 48.15s | valid loss  3.72 | valid ppl    41.20 | valid bpc    5.365
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  269 batches | lr 0.00000 | ms/batch 171.87 | loss  2.74 | ppl    15.44 
| epoch  94 |   200/  269 batches | lr 0.00000 | ms/batch 163.67 | loss  2.71 | ppl    15.10 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 45.27s | valid loss  3.72 | valid ppl    41.31 | valid bpc    5.368
-----------------------------------------------------------------------------------------
PROGRESS: 94.0%
| epoch  95 |   100/  269 batches | lr 0.00000 | ms/batch 160.80 | loss  2.75 | ppl    15.60 
| epoch  95 |   200/  269 batches | lr 0.00000 | ms/batch 217.46 | loss  2.71 | ppl    15.08 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 55.37s | valid loss  3.76 | valid ppl    42.95 | valid bpc    5.425
-----------------------------------------------------------------------------------------
PROGRESS: 95.0%
| epoch  96 |   100/  269 batches | lr 0.00000 | ms/batch 246.41 | loss  2.73 | ppl    15.38 
| epoch  96 |   200/  269 batches | lr 0.00000 | ms/batch 227.96 | loss  2.72 | ppl    15.19 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 64.94s | valid loss  3.76 | valid ppl    42.81 | valid bpc    5.420
-----------------------------------------------------------------------------------------
PROGRESS: 96.0%
| epoch  97 |   100/  269 batches | lr 0.00000 | ms/batch 245.33 | loss  2.76 | ppl    15.79 
| epoch  97 |   200/  269 batches | lr 0.00000 | ms/batch 228.30 | loss  2.72 | ppl    15.23 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 64.96s | valid loss  3.76 | valid ppl    42.98 | valid bpc    5.426
-----------------------------------------------------------------------------------------
PROGRESS: 97.0%
| epoch  98 |   100/  269 batches | lr 0.00000 | ms/batch 245.00 | loss  2.74 | ppl    15.50 
| epoch  98 |   200/  269 batches | lr 0.00000 | ms/batch 228.92 | loss  2.73 | ppl    15.26 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 65.04s | valid loss  3.73 | valid ppl    41.69 | valid bpc    5.382
-----------------------------------------------------------------------------------------
PROGRESS: 98.0%
| epoch  99 |   100/  269 batches | lr 0.00000 | ms/batch 235.85 | loss  2.74 | ppl    15.47 
| epoch  99 |   200/  269 batches | lr 0.00000 | ms/batch 157.26 | loss  2.71 | ppl    15.08 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 51.91s | valid loss  3.73 | valid ppl    41.68 | valid bpc    5.381
-----------------------------------------------------------------------------------------
PROGRESS: 99.0%
| epoch 100 |   100/  269 batches | lr 0.00000 | ms/batch 177.44 | loss  2.74 | ppl    15.51 
| epoch 100 |   200/  269 batches | lr 0.00000 | ms/batch 155.86 | loss  2.70 | ppl    14.93 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 45.13s | valid loss  3.75 | valid ppl    42.57 | valid bpc    5.412
-----------------------------------------------------------------------------------------
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  3.84 | test ppl    46.72 | test bpc    5.546
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.4320, Mean Reca: 0.6092, Mean F1: 0.5013, Mean Subword_Reca: 0.8581
-----------------------------------------------------------------------------------------
=========================================================================================
Loading dataset...
Using subword tokenizer...
Number of tokens:  8000
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer_in_parser', nhid=512, nlayers=8, front_layers=5, rear_layers=3, subword='omarmomen/ptb_filtered_lowcase_bpe_tokenizer_8', n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=2222, nonmono=5, cuda=True, log_interval=100, save='trained_models/subword_structformer_in_parser_2222_53.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 37449076
Model architecture: StructFormer_In_Parser(
  (transformer_front): Transformer_Front(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(8000, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-4): 5 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
  (transformer_rear): Transformer_Rear(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(8000, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-2): 3 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (output_layer): Linear(in_features=512, out_features=8000, bias=True)
  )
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  269 batches | lr 0.00030 | ms/batch 259.43 | loss  7.76 | ppl  2337.74 
| epoch   1 |   200/  269 batches | lr 0.00030 | ms/batch 227.86 | loss  7.35 | ppl  1563.29 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 65.44s | valid loss  7.09 | valid ppl  1195.69 | valid bpc   10.224
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  269 batches | lr 0.00030 | ms/batch 251.43 | loss  7.32 | ppl  1512.17 
| epoch   2 |   200/  269 batches | lr 0.00030 | ms/batch 228.70 | loss  7.15 | ppl  1269.93 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 64.56s | valid loss  6.92 | valid ppl  1009.45 | valid bpc    9.979
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  269 batches | lr 0.00030 | ms/batch 250.44 | loss  7.05 | ppl  1154.17 
| epoch   3 |   200/  269 batches | lr 0.00030 | ms/batch 227.86 | loss  6.88 | ppl   969.68 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 64.51s | valid loss  6.56 | valid ppl   706.66 | valid bpc    9.465
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  269 batches | lr 0.00030 | ms/batch 251.11 | loss  6.68 | ppl   795.57 
| epoch   4 |   200/  269 batches | lr 0.00030 | ms/batch 227.42 | loss  6.47 | ppl   642.74 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 64.60s | valid loss  6.12 | valid ppl   452.88 | valid bpc    8.823
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  269 batches | lr 0.00030 | ms/batch 252.25 | loss  6.25 | ppl   519.17 
| epoch   5 |   200/  269 batches | lr 0.00030 | ms/batch 228.78 | loss  6.08 | ppl   436.45 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 64.74s | valid loss  5.79 | valid ppl   327.47 | valid bpc    8.355
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  269 batches | lr 0.00030 | ms/batch 250.55 | loss  5.95 | ppl   384.52 
| epoch   6 |   200/  269 batches | lr 0.00030 | ms/batch 229.16 | loss  5.85 | ppl   345.67 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 64.59s | valid loss  5.56 | valid ppl   260.34 | valid bpc    8.024
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  269 batches | lr 0.00030 | ms/batch 252.85 | loss  5.74 | ppl   310.57 
| epoch   7 |   200/  269 batches | lr 0.00030 | ms/batch 226.74 | loss  5.63 | ppl   277.55 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 64.58s | valid loss  5.43 | valid ppl   228.05 | valid bpc    7.833
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  269 batches | lr 0.00030 | ms/batch 252.46 | loss  5.57 | ppl   261.59 
| epoch   8 |   200/  269 batches | lr 0.00030 | ms/batch 227.58 | loss  5.48 | ppl   240.91 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 64.63s | valid loss  5.28 | valid ppl   195.45 | valid bpc    7.611
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 8.0%
| epoch   9 |   100/  269 batches | lr 0.00030 | ms/batch 251.35 | loss  5.45 | ppl   232.09 
| epoch   9 |   200/  269 batches | lr 0.00030 | ms/batch 228.16 | loss  5.36 | ppl   213.16 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 64.65s | valid loss  5.19 | valid ppl   178.80 | valid bpc    7.482
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  269 batches | lr 0.00030 | ms/batch 252.35 | loss  5.34 | ppl   207.73 
| epoch  10 |   200/  269 batches | lr 0.00030 | ms/batch 226.78 | loss  5.22 | ppl   184.59 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 64.60s | valid loss  5.06 | valid ppl   158.01 | valid bpc    7.304
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  269 batches | lr 0.00030 | ms/batch 252.69 | loss  5.22 | ppl   184.06 
| epoch  11 |   200/  269 batches | lr 0.00030 | ms/batch 231.43 | loss  5.15 | ppl   172.54 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 65.33s | valid loss  4.96 | valid ppl   143.04 | valid bpc    7.160
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  269 batches | lr 0.00030 | ms/batch 251.55 | loss  5.10 | ppl   164.24 
| epoch  12 |   200/  269 batches | lr 0.00030 | ms/batch 231.41 | loss  5.03 | ppl   152.82 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 65.35s | valid loss  4.94 | valid ppl   140.23 | valid bpc    7.132
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 12.0%
| epoch  13 |   100/  269 batches | lr 0.00030 | ms/batch 250.97 | loss  5.01 | ppl   150.07 
| epoch  13 |   200/  269 batches | lr 0.00030 | ms/batch 229.52 | loss  4.96 | ppl   142.53 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 64.60s | valid loss  4.84 | valid ppl   126.10 | valid bpc    6.978
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 13.0%
| epoch  14 |   100/  269 batches | lr 0.00030 | ms/batch 250.89 | loss  4.90 | ppl   134.58 
| epoch  14 |   200/  269 batches | lr 0.00030 | ms/batch 229.39 | loss  4.89 | ppl   133.51 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 64.63s | valid loss  4.74 | valid ppl   114.99 | valid bpc    6.845
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  269 batches | lr 0.00030 | ms/batch 251.53 | loss  4.86 | ppl   129.00 
| epoch  15 |   200/  269 batches | lr 0.00030 | ms/batch 227.28 | loss  4.78 | ppl   119.12 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 64.58s | valid loss  4.68 | valid ppl   107.88 | valid bpc    6.753
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 15.0%
| epoch  16 |   100/  269 batches | lr 0.00030 | ms/batch 251.88 | loss  4.74 | ppl   114.01 
| epoch  16 |   200/  269 batches | lr 0.00030 | ms/batch 227.18 | loss  4.71 | ppl   111.58 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 64.64s | valid loss  4.63 | valid ppl   102.11 | valid bpc    6.674
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 16.0%
| epoch  17 |   100/  269 batches | lr 0.00030 | ms/batch 251.86 | loss  4.69 | ppl   108.52 
| epoch  17 |   200/  269 batches | lr 0.00030 | ms/batch 228.71 | loss  4.63 | ppl   103.02 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 64.73s | valid loss  4.51 | valid ppl    90.82 | valid bpc    6.505
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 17.0%
| epoch  18 |   100/  269 batches | lr 0.00030 | ms/batch 251.10 | loss  4.61 | ppl   100.26 
| epoch  18 |   200/  269 batches | lr 0.00030 | ms/batch 229.59 | loss  4.58 | ppl    97.54 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 64.94s | valid loss  4.50 | valid ppl    89.93 | valid bpc    6.491
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 18.0%
| epoch  19 |   100/  269 batches | lr 0.00030 | ms/batch 251.00 | loss  4.54 | ppl    93.37 
| epoch  19 |   200/  269 batches | lr 0.00030 | ms/batch 233.71 | loss  4.48 | ppl    88.51 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 65.04s | valid loss  4.47 | valid ppl    87.65 | valid bpc    6.454
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 19.0%
| epoch  20 |   100/  269 batches | lr 0.00030 | ms/batch 251.33 | loss  4.49 | ppl    89.54 
| epoch  20 |   200/  269 batches | lr 0.00030 | ms/batch 236.93 | loss  4.43 | ppl    84.02 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 65.45s | valid loss  4.38 | valid ppl    80.16 | valid bpc    6.325
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 20.0%
| epoch  21 |   100/  269 batches | lr 0.00030 | ms/batch 251.37 | loss  4.43 | ppl    84.04 
| epoch  21 |   200/  269 batches | lr 0.00030 | ms/batch 236.11 | loss  4.36 | ppl    77.94 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 65.09s | valid loss  4.42 | valid ppl    83.10 | valid bpc    6.377
-----------------------------------------------------------------------------------------
PROGRESS: 21.0%
| epoch  22 |   100/  269 batches | lr 0.00030 | ms/batch 246.58 | loss  4.36 | ppl    78.59 
| epoch  22 |   200/  269 batches | lr 0.00030 | ms/batch 237.48 | loss  4.33 | ppl    76.15 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 65.44s | valid loss  4.33 | valid ppl    75.72 | valid bpc    6.243
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 22.0%
| epoch  23 |   100/  269 batches | lr 0.00030 | ms/batch 252.62 | loss  4.30 | ppl    73.95 
| epoch  23 |   200/  269 batches | lr 0.00030 | ms/batch 236.82 | loss  4.28 | ppl    72.07 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 65.56s | valid loss  4.31 | valid ppl    74.21 | valid bpc    6.214
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 23.0%
| epoch  24 |   100/  269 batches | lr 0.00030 | ms/batch 251.81 | loss  4.27 | ppl    71.35 
| epoch  24 |   200/  269 batches | lr 0.00030 | ms/batch 236.85 | loss  4.23 | ppl    68.54 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 65.27s | valid loss  4.24 | valid ppl    69.57 | valid bpc    6.120
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 24.0%
| epoch  25 |   100/  269 batches | lr 0.00030 | ms/batch 252.76 | loss  4.22 | ppl    67.85 
| epoch  25 |   200/  269 batches | lr 0.00030 | ms/batch 236.46 | loss  4.18 | ppl    65.30 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 65.04s | valid loss  4.22 | valid ppl    67.92 | valid bpc    6.086
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 25.0%
| epoch  26 |   100/  269 batches | lr 0.00030 | ms/batch 252.03 | loss  4.17 | ppl    64.40 
| epoch  26 |   200/  269 batches | lr 0.00030 | ms/batch 237.20 | loss  4.13 | ppl    62.25 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 65.09s | valid loss  4.16 | valid ppl    63.78 | valid bpc    5.995
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 26.0%
| epoch  27 |   100/  269 batches | lr 0.00030 | ms/batch 252.09 | loss  4.11 | ppl    60.85 
| epoch  27 |   200/  269 batches | lr 0.00030 | ms/batch 237.21 | loss  4.07 | ppl    58.75 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 65.45s | valid loss  4.14 | valid ppl    62.73 | valid bpc    5.971
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 27.0%
| epoch  28 |   100/  269 batches | lr 0.00030 | ms/batch 252.02 | loss  4.07 | ppl    58.82 
| epoch  28 |   200/  269 batches | lr 0.00030 | ms/batch 236.81 | loss  4.05 | ppl    57.67 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 65.39s | valid loss  4.08 | valid ppl    59.00 | valid bpc    5.883
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  269 batches | lr 0.00030 | ms/batch 251.89 | loss  4.03 | ppl    56.29 
| epoch  29 |   200/  269 batches | lr 0.00030 | ms/batch 236.83 | loss  3.97 | ppl    52.90 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 65.46s | valid loss  4.10 | valid ppl    60.06 | valid bpc    5.908
-----------------------------------------------------------------------------------------
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  269 batches | lr 0.00030 | ms/batch 246.66 | loss  3.98 | ppl    53.41 
| epoch  30 |   200/  269 batches | lr 0.00030 | ms/batch 237.44 | loss  3.95 | ppl    51.70 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 65.44s | valid loss  4.10 | valid ppl    60.64 | valid bpc    5.922
-----------------------------------------------------------------------------------------
PROGRESS: 30.0%
| epoch  31 |   100/  269 batches | lr 0.00030 | ms/batch 239.48 | loss  3.93 | ppl    50.70 
| epoch  31 |   200/  269 batches | lr 0.00030 | ms/batch 237.86 | loss  3.90 | ppl    49.51 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 64.26s | valid loss  4.04 | valid ppl    57.09 | valid bpc    5.835
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 31.0%
| epoch  32 |   100/  269 batches | lr 0.00030 | ms/batch 242.98 | loss  3.90 | ppl    49.21 
| epoch  32 |   200/  269 batches | lr 0.00030 | ms/batch 237.14 | loss  3.86 | ppl    47.59 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 64.99s | valid loss  4.02 | valid ppl    55.78 | valid bpc    5.802
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 32.0%
| epoch  33 |   100/  269 batches | lr 0.00030 | ms/batch 241.99 | loss  3.86 | ppl    47.58 
| epoch  33 |   200/  269 batches | lr 0.00030 | ms/batch 237.26 | loss  3.85 | ppl    46.95 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 65.01s | valid loss  4.00 | valid ppl    54.72 | valid bpc    5.774
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 33.0%
| epoch  34 |   100/  269 batches | lr 0.00030 | ms/batch 243.69 | loss  3.84 | ppl    46.35 
| epoch  34 |   200/  269 batches | lr 0.00030 | ms/batch 236.39 | loss  3.81 | ppl    45.02 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 64.91s | valid loss  4.03 | valid ppl    56.22 | valid bpc    5.813
-----------------------------------------------------------------------------------------
PROGRESS: 34.0%
| epoch  35 |   100/  269 batches | lr 0.00030 | ms/batch 246.86 | loss  3.80 | ppl    44.67 
| epoch  35 |   200/  269 batches | lr 0.00030 | ms/batch 236.19 | loss  3.75 | ppl    42.63 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 65.35s | valid loss  4.01 | valid ppl    55.31 | valid bpc    5.789
-----------------------------------------------------------------------------------------
PROGRESS: 35.0%
| epoch  36 |   100/  269 batches | lr 0.00030 | ms/batch 245.72 | loss  3.76 | ppl    42.94 
| epoch  36 |   200/  269 batches | lr 0.00030 | ms/batch 238.08 | loss  3.74 | ppl    42.01 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 64.95s | valid loss  3.98 | valid ppl    53.64 | valid bpc    5.745
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 36.0%
| epoch  37 |   100/  269 batches | lr 0.00030 | ms/batch 242.86 | loss  3.73 | ppl    41.69 
| epoch  37 |   200/  269 batches | lr 0.00030 | ms/batch 237.62 | loss  3.70 | ppl    40.33 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 64.71s | valid loss  3.97 | valid ppl    53.21 | valid bpc    5.734
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 37.0%
| epoch  38 |   100/  269 batches | lr 0.00030 | ms/batch 246.26 | loss  3.67 | ppl    39.39 
| epoch  38 |   200/  269 batches | lr 0.00030 | ms/batch 236.15 | loss  3.66 | ppl    38.85 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 65.54s | valid loss  3.94 | valid ppl    51.28 | valid bpc    5.680
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 38.0%
| epoch  39 |   100/  269 batches | lr 0.00030 | ms/batch 243.59 | loss  3.66 | ppl    38.81 
| epoch  39 |   200/  269 batches | lr 0.00030 | ms/batch 236.95 | loss  3.62 | ppl    37.51 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 65.39s | valid loss  4.01 | valid ppl    55.33 | valid bpc    5.790
-----------------------------------------------------------------------------------------
PROGRESS: 39.0%
| epoch  40 |   100/  269 batches | lr 0.00030 | ms/batch 237.74 | loss  3.62 | ppl    37.29 
| epoch  40 |   200/  269 batches | lr 0.00030 | ms/batch 237.63 | loss  3.61 | ppl    37.06 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 65.17s | valid loss  3.92 | valid ppl    50.54 | valid bpc    5.659
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 40.0%
| epoch  41 |   100/  269 batches | lr 0.00030 | ms/batch 240.98 | loss  3.58 | ppl    35.78 
| epoch  41 |   200/  269 batches | lr 0.00030 | ms/batch 237.05 | loss  3.60 | ppl    36.60 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 65.39s | valid loss  3.91 | valid ppl    50.02 | valid bpc    5.644
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 41.0%
| epoch  42 |   100/  269 batches | lr 0.00030 | ms/batch 240.42 | loss  3.56 | ppl    35.10 
| epoch  42 |   200/  269 batches | lr 0.00030 | ms/batch 237.30 | loss  3.55 | ppl    34.64 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 65.31s | valid loss  3.91 | valid ppl    49.97 | valid bpc    5.643
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 42.0%
| epoch  43 |   100/  269 batches | lr 0.00030 | ms/batch 235.75 | loss  3.55 | ppl    34.70 
| epoch  43 |   200/  269 batches | lr 0.00030 | ms/batch 238.41 | loss  3.52 | ppl    33.72 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 64.95s | valid loss  3.87 | valid ppl    48.03 | valid bpc    5.586
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 43.0%
| epoch  44 |   100/  269 batches | lr 0.00030 | ms/batch 240.81 | loss  3.49 | ppl    32.67 
| epoch  44 |   200/  269 batches | lr 0.00030 | ms/batch 236.53 | loss  3.49 | ppl    32.89 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 65.31s | valid loss  3.91 | valid ppl    50.02 | valid bpc    5.644
-----------------------------------------------------------------------------------------
PROGRESS: 44.0%
| epoch  45 |   100/  269 batches | lr 0.00030 | ms/batch 236.74 | loss  3.47 | ppl    32.12 
| epoch  45 |   200/  269 batches | lr 0.00030 | ms/batch 237.81 | loss  3.47 | ppl    32.18 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 65.04s | valid loss  3.82 | valid ppl    45.66 | valid bpc    5.513
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 45.0%
| epoch  46 |   100/  269 batches | lr 0.00030 | ms/batch 240.97 | loss  3.48 | ppl    32.35 
| epoch  46 |   200/  269 batches | lr 0.00030 | ms/batch 237.31 | loss  3.44 | ppl    31.18 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 65.30s | valid loss  3.82 | valid ppl    45.72 | valid bpc    5.515
-----------------------------------------------------------------------------------------
PROGRESS: 46.0%
| epoch  47 |   100/  269 batches | lr 0.00030 | ms/batch 239.25 | loss  3.42 | ppl    30.48 
| epoch  47 |   200/  269 batches | lr 0.00030 | ms/batch 237.60 | loss  3.42 | ppl    30.67 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 65.31s | valid loss  3.88 | valid ppl    48.56 | valid bpc    5.602
-----------------------------------------------------------------------------------------
PROGRESS: 47.0%
| epoch  48 |   100/  269 batches | lr 0.00030 | ms/batch 239.93 | loss  3.40 | ppl    29.98 
| epoch  48 |   200/  269 batches | lr 0.00030 | ms/batch 237.90 | loss  3.39 | ppl    29.66 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 65.34s | valid loss  3.91 | valid ppl    49.83 | valid bpc    5.639
-----------------------------------------------------------------------------------------
PROGRESS: 48.0%
| epoch  49 |   100/  269 batches | lr 0.00015 | ms/batch 231.85 | loss  3.32 | ppl    27.56 
| epoch  49 |   200/  269 batches | lr 0.00015 | ms/batch 238.72 | loss  3.29 | ppl    26.95 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 64.61s | valid loss  3.83 | valid ppl    46.01 | valid bpc    5.524
-----------------------------------------------------------------------------------------
PROGRESS: 49.0%
| epoch  50 |   100/  269 batches | lr 0.00015 | ms/batch 240.85 | loss  3.29 | ppl    26.72 
| epoch  50 |   200/  269 batches | lr 0.00015 | ms/batch 237.24 | loss  3.21 | ppl    24.82 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 65.33s | valid loss  3.76 | valid ppl    43.05 | valid bpc    5.428
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 50.0%
| epoch  51 |   100/  269 batches | lr 0.00015 | ms/batch 239.63 | loss  3.24 | ppl    25.61 
| epoch  51 |   200/  269 batches | lr 0.00015 | ms/batch 237.03 | loss  3.22 | ppl    25.15 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 65.36s | valid loss  3.83 | valid ppl    45.96 | valid bpc    5.522
-----------------------------------------------------------------------------------------
PROGRESS: 51.0%
| epoch  52 |   100/  269 batches | lr 0.00015 | ms/batch 235.84 | loss  3.22 | ppl    24.91 
| epoch  52 |   200/  269 batches | lr 0.00015 | ms/batch 236.89 | loss  3.19 | ppl    24.20 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 64.92s | valid loss  3.81 | valid ppl    45.08 | valid bpc    5.494
-----------------------------------------------------------------------------------------
PROGRESS: 52.0%
| epoch  53 |   100/  269 batches | lr 0.00015 | ms/batch 233.56 | loss  3.21 | ppl    24.78 
| epoch  53 |   200/  269 batches | lr 0.00015 | ms/batch 237.35 | loss  3.18 | ppl    24.16 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 64.70s | valid loss  3.81 | valid ppl    45.16 | valid bpc    5.497
-----------------------------------------------------------------------------------------
PROGRESS: 53.0%
| epoch  54 |   100/  269 batches | lr 0.00007 | ms/batch 239.86 | loss  3.18 | ppl    23.97 
| epoch  54 |   200/  269 batches | lr 0.00007 | ms/batch 238.99 | loss  3.14 | ppl    23.08 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 65.42s | valid loss  3.77 | valid ppl    43.33 | valid bpc    5.437
-----------------------------------------------------------------------------------------
PROGRESS: 54.0%
| epoch  55 |   100/  269 batches | lr 0.00007 | ms/batch 234.22 | loss  3.13 | ppl    22.84 
| epoch  55 |   200/  269 batches | lr 0.00007 | ms/batch 236.61 | loss  3.12 | ppl    22.55 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 64.75s | valid loss  3.73 | valid ppl    41.70 | valid bpc    5.382
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  269 batches | lr 0.00007 | ms/batch 234.13 | loss  3.13 | ppl    22.78 
| epoch  56 |   200/  269 batches | lr 0.00007 | ms/batch 239.22 | loss  3.11 | ppl    22.36 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 64.93s | valid loss  3.72 | valid ppl    41.36 | valid bpc    5.370
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  269 batches | lr 0.00007 | ms/batch 239.47 | loss  3.10 | ppl    22.13 
| epoch  57 |   200/  269 batches | lr 0.00007 | ms/batch 237.86 | loss  3.09 | ppl    21.90 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 65.38s | valid loss  3.79 | valid ppl    44.13 | valid bpc    5.464
-----------------------------------------------------------------------------------------
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  269 batches | lr 0.00007 | ms/batch 241.07 | loss  3.10 | ppl    22.15 
| epoch  58 |   200/  269 batches | lr 0.00007 | ms/batch 237.54 | loss  3.06 | ppl    21.37 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 65.38s | valid loss  3.76 | valid ppl    43.10 | valid bpc    5.430
-----------------------------------------------------------------------------------------
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  269 batches | lr 0.00007 | ms/batch 233.33 | loss  3.09 | ppl    22.00 
| epoch  59 |   200/  269 batches | lr 0.00007 | ms/batch 237.89 | loss  3.06 | ppl    21.43 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 64.75s | valid loss  3.76 | valid ppl    42.79 | valid bpc    5.419
-----------------------------------------------------------------------------------------
PROGRESS: 59.0%
| epoch  60 |   100/  269 batches | lr 0.00004 | ms/batch 240.52 | loss  3.06 | ppl    21.36 
| epoch  60 |   200/  269 batches | lr 0.00004 | ms/batch 238.21 | loss  3.04 | ppl    20.96 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 65.35s | valid loss  3.77 | valid ppl    43.32 | valid bpc    5.437
-----------------------------------------------------------------------------------------
PROGRESS: 60.0%
| epoch  61 |   100/  269 batches | lr 0.00004 | ms/batch 246.66 | loss  3.05 | ppl    21.22 
| epoch  61 |   200/  269 batches | lr 0.00004 | ms/batch 231.95 | loss  3.02 | ppl    20.49 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 65.30s | valid loss  3.76 | valid ppl    42.79 | valid bpc    5.419
-----------------------------------------------------------------------------------------
PROGRESS: 61.0%
| epoch  62 |   100/  269 batches | lr 0.00004 | ms/batch 247.33 | loss  3.06 | ppl    21.22 
| epoch  62 |   200/  269 batches | lr 0.00004 | ms/batch 230.72 | loss  3.02 | ppl    20.41 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 65.36s | valid loss  3.78 | valid ppl    43.61 | valid bpc    5.447
-----------------------------------------------------------------------------------------
PROGRESS: 62.0%
| epoch  63 |   100/  269 batches | lr 0.00002 | ms/batch 246.40 | loss  3.04 | ppl    21.00 
| epoch  63 |   200/  269 batches | lr 0.00002 | ms/batch 231.76 | loss  3.01 | ppl    20.21 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 65.30s | valid loss  3.77 | valid ppl    43.26 | valid bpc    5.435
-----------------------------------------------------------------------------------------
PROGRESS: 63.0%
| epoch  64 |   100/  269 batches | lr 0.00002 | ms/batch 244.20 | loss  3.01 | ppl    20.25 
| epoch  64 |   200/  269 batches | lr 0.00002 | ms/batch 229.69 | loss  2.99 | ppl    19.94 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 64.94s | valid loss  3.77 | valid ppl    43.31 | valid bpc    5.437
-----------------------------------------------------------------------------------------
PROGRESS: 64.0%
| epoch  65 |   100/  269 batches | lr 0.00002 | ms/batch 250.60 | loss  3.03 | ppl    20.66 
| epoch  65 |   200/  269 batches | lr 0.00002 | ms/batch 228.58 | loss  2.99 | ppl    19.82 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 65.34s | valid loss  3.78 | valid ppl    43.77 | valid bpc    5.452
-----------------------------------------------------------------------------------------
PROGRESS: 65.0%
| epoch  66 |   100/  269 batches | lr 0.00001 | ms/batch 251.66 | loss  3.01 | ppl    20.36 
| epoch  66 |   200/  269 batches | lr 0.00001 | ms/batch 225.25 | loss  3.01 | ppl    20.25 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 65.37s | valid loss  3.72 | valid ppl    41.43 | valid bpc    5.373
-----------------------------------------------------------------------------------------
PROGRESS: 66.0%
| epoch  67 |   100/  269 batches | lr 0.00001 | ms/batch 251.51 | loss  3.03 | ppl    20.59 
| epoch  67 |   200/  269 batches | lr 0.00001 | ms/batch 226.21 | loss  2.97 | ppl    19.41 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 65.38s | valid loss  3.71 | valid ppl    40.97 | valid bpc    5.356
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 67.0%
| epoch  68 |   100/  269 batches | lr 0.00001 | ms/batch 251.99 | loss  3.00 | ppl    20.15 
| epoch  68 |   200/  269 batches | lr 0.00001 | ms/batch 221.87 | loss  2.98 | ppl    19.65 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 65.03s | valid loss  3.71 | valid ppl    40.76 | valid bpc    5.349
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 68.0%
| epoch  69 |   100/  269 batches | lr 0.00001 | ms/batch 251.47 | loss  3.00 | ppl    20.02 
| epoch  69 |   200/  269 batches | lr 0.00001 | ms/batch 224.81 | loss  2.98 | ppl    19.64 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 65.34s | valid loss  3.80 | valid ppl    44.58 | valid bpc    5.478
-----------------------------------------------------------------------------------------
PROGRESS: 69.0%
| epoch  70 |   100/  269 batches | lr 0.00001 | ms/batch 251.50 | loss  2.99 | ppl    19.98 
| epoch  70 |   200/  269 batches | lr 0.00001 | ms/batch 225.34 | loss  2.99 | ppl    19.91 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 65.31s | valid loss  3.78 | valid ppl    43.75 | valid bpc    5.451
-----------------------------------------------------------------------------------------
PROGRESS: 70.0%
| epoch  71 |   100/  269 batches | lr 0.00001 | ms/batch 252.79 | loss  3.00 | ppl    20.07 
| epoch  71 |   200/  269 batches | lr 0.00001 | ms/batch 226.11 | loss  2.96 | ppl    19.30 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 65.34s | valid loss  3.74 | valid ppl    41.95 | valid bpc    5.391
-----------------------------------------------------------------------------------------
PROGRESS: 71.0%
| epoch  72 |   100/  269 batches | lr 0.00000 | ms/batch 251.42 | loss  2.99 | ppl    19.79 
| epoch  72 |   200/  269 batches | lr 0.00000 | ms/batch 224.92 | loss  2.96 | ppl    19.37 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 65.38s | valid loss  3.72 | valid ppl    41.11 | valid bpc    5.361
-----------------------------------------------------------------------------------------
PROGRESS: 72.0%
| epoch  73 |   100/  269 batches | lr 0.00000 | ms/batch 251.32 | loss  2.99 | ppl    19.84 
| epoch  73 |   200/  269 batches | lr 0.00000 | ms/batch 225.91 | loss  2.97 | ppl    19.59 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 65.27s | valid loss  3.78 | valid ppl    43.90 | valid bpc    5.456
-----------------------------------------------------------------------------------------
PROGRESS: 73.0%
| epoch  74 |   100/  269 batches | lr 0.00000 | ms/batch 252.30 | loss  2.99 | ppl    19.97 
| epoch  74 |   200/  269 batches | lr 0.00000 | ms/batch 226.06 | loss  2.94 | ppl    18.99 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 65.36s | valid loss  3.71 | valid ppl    40.80 | valid bpc    5.350
-----------------------------------------------------------------------------------------
PROGRESS: 74.0%
| epoch  75 |   100/  269 batches | lr 0.00000 | ms/batch 251.68 | loss  3.00 | ppl    20.00 
| epoch  75 |   200/  269 batches | lr 0.00000 | ms/batch 225.34 | loss  2.98 | ppl    19.60 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 65.36s | valid loss  3.77 | valid ppl    43.23 | valid bpc    5.434
-----------------------------------------------------------------------------------------
PROGRESS: 75.0%
| epoch  76 |   100/  269 batches | lr 0.00000 | ms/batch 252.42 | loss  2.98 | ppl    19.74 
| epoch  76 |   200/  269 batches | lr 0.00000 | ms/batch 226.52 | loss  2.97 | ppl    19.45 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 65.32s | valid loss  3.77 | valid ppl    43.23 | valid bpc    5.434
-----------------------------------------------------------------------------------------
PROGRESS: 76.0%
| epoch  77 |   100/  269 batches | lr 0.00000 | ms/batch 251.93 | loss  2.99 | ppl    19.88 
| epoch  77 |   200/  269 batches | lr 0.00000 | ms/batch 227.23 | loss  2.97 | ppl    19.54 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 65.39s | valid loss  3.79 | valid ppl    44.07 | valid bpc    5.462
-----------------------------------------------------------------------------------------
PROGRESS: 77.0%
| epoch  78 |   100/  269 batches | lr 0.00000 | ms/batch 251.82 | loss  2.98 | ppl    19.76 
| epoch  78 |   200/  269 batches | lr 0.00000 | ms/batch 231.60 | loss  2.96 | ppl    19.27 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 65.32s | valid loss  3.74 | valid ppl    42.30 | valid bpc    5.403
-----------------------------------------------------------------------------------------
PROGRESS: 78.0%
| epoch  79 |   100/  269 batches | lr 0.00000 | ms/batch 251.90 | loss  3.00 | ppl    20.16 
| epoch  79 |   200/  269 batches | lr 0.00000 | ms/batch 232.00 | loss  2.95 | ppl    19.15 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 65.37s | valid loss  3.72 | valid ppl    41.31 | valid bpc    5.369
-----------------------------------------------------------------------------------------
PROGRESS: 79.0%
| epoch  80 |   100/  269 batches | lr 0.00000 | ms/batch 252.83 | loss  2.99 | ppl    19.81 
| epoch  80 |   200/  269 batches | lr 0.00000 | ms/batch 230.96 | loss  2.95 | ppl    19.11 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 65.36s | valid loss  3.72 | valid ppl    41.21 | valid bpc    5.365
-----------------------------------------------------------------------------------------
PROGRESS: 80.0%
| epoch  81 |   100/  269 batches | lr 0.00000 | ms/batch 251.85 | loss  2.98 | ppl    19.79 
| epoch  81 |   200/  269 batches | lr 0.00000 | ms/batch 231.49 | loss  2.96 | ppl    19.23 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 65.34s | valid loss  3.74 | valid ppl    42.17 | valid bpc    5.398
-----------------------------------------------------------------------------------------
PROGRESS: 81.0%
| epoch  82 |   100/  269 batches | lr 0.00000 | ms/batch 252.28 | loss  2.99 | ppl    19.92 
| epoch  82 |   200/  269 batches | lr 0.00000 | ms/batch 231.76 | loss  2.96 | ppl    19.20 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 65.36s | valid loss  3.75 | valid ppl    42.72 | valid bpc    5.417
-----------------------------------------------------------------------------------------
PROGRESS: 82.0%
| epoch  83 |   100/  269 batches | lr 0.00000 | ms/batch 252.78 | loss  2.98 | ppl    19.78 
| epoch  83 |   200/  269 batches | lr 0.00000 | ms/batch 230.93 | loss  2.95 | ppl    19.05 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 65.35s | valid loss  3.76 | valid ppl    42.86 | valid bpc    5.422
-----------------------------------------------------------------------------------------
PROGRESS: 83.0%
| epoch  84 |   100/  269 batches | lr 0.00000 | ms/batch 252.90 | loss  2.98 | ppl    19.61 
| epoch  84 |   200/  269 batches | lr 0.00000 | ms/batch 231.83 | loss  2.97 | ppl    19.51 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 65.43s | valid loss  3.76 | valid ppl    42.96 | valid bpc    5.425
-----------------------------------------------------------------------------------------
PROGRESS: 84.0%
| epoch  85 |   100/  269 batches | lr 0.00000 | ms/batch 251.65 | loss  2.98 | ppl    19.60 
| epoch  85 |   200/  269 batches | lr 0.00000 | ms/batch 231.95 | loss  2.95 | ppl    19.03 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 65.28s | valid loss  3.74 | valid ppl    41.95 | valid bpc    5.391
-----------------------------------------------------------------------------------------
PROGRESS: 85.0%
| epoch  86 |   100/  269 batches | lr 0.00000 | ms/batch 252.45 | loss  2.99 | ppl    19.98 
| epoch  86 |   200/  269 batches | lr 0.00000 | ms/batch 230.99 | loss  2.97 | ppl    19.50 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 65.34s | valid loss  3.72 | valid ppl    41.22 | valid bpc    5.365
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  269 batches | lr 0.00000 | ms/batch 251.23 | loss  3.00 | ppl    20.11 
| epoch  87 |   200/  269 batches | lr 0.00000 | ms/batch 231.65 | loss  2.96 | ppl    19.31 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 65.31s | valid loss  3.78 | valid ppl    43.93 | valid bpc    5.457
-----------------------------------------------------------------------------------------
PROGRESS: 87.0%
| epoch  88 |   100/  269 batches | lr 0.00000 | ms/batch 251.45 | loss  2.99 | ppl    19.88 
| epoch  88 |   200/  269 batches | lr 0.00000 | ms/batch 232.08 | loss  2.95 | ppl    19.18 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 65.34s | valid loss  3.77 | valid ppl    43.23 | valid bpc    5.434
-----------------------------------------------------------------------------------------
PROGRESS: 88.0%
| epoch  89 |   100/  269 batches | lr 0.00000 | ms/batch 252.34 | loss  2.99 | ppl    19.83 
| epoch  89 |   200/  269 batches | lr 0.00000 | ms/batch 231.34 | loss  2.95 | ppl    19.15 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 65.83s | valid loss  3.77 | valid ppl    43.36 | valid bpc    5.438
-----------------------------------------------------------------------------------------
PROGRESS: 89.0%
| epoch  90 |   100/  269 batches | lr 0.00000 | ms/batch 246.87 | loss  2.98 | ppl    19.75 
| epoch  90 |   200/  269 batches | lr 0.00000 | ms/batch 232.89 | loss  2.96 | ppl    19.32 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 65.59s | valid loss  3.70 | valid ppl    40.63 | valid bpc    5.344
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 90.0%
| epoch  91 |   100/  269 batches | lr 0.00000 | ms/batch 247.25 | loss  2.99 | ppl    19.96 
| epoch  91 |   200/  269 batches | lr 0.00000 | ms/batch 232.19 | loss  2.96 | ppl    19.24 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 65.42s | valid loss  3.76 | valid ppl    42.90 | valid bpc    5.423
-----------------------------------------------------------------------------------------
PROGRESS: 91.0%
| epoch  92 |   100/  269 batches | lr 0.00000 | ms/batch 244.87 | loss  3.00 | ppl    20.10 
| epoch  92 |   200/  269 batches | lr 0.00000 | ms/batch 232.12 | loss  2.98 | ppl    19.61 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 65.32s | valid loss  3.76 | valid ppl    43.05 | valid bpc    5.428
-----------------------------------------------------------------------------------------
PROGRESS: 92.0%
| epoch  93 |   100/  269 batches | lr 0.00000 | ms/batch 244.95 | loss  2.98 | ppl    19.72 
| epoch  93 |   200/  269 batches | lr 0.00000 | ms/batch 232.16 | loss  2.96 | ppl    19.35 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 65.33s | valid loss  3.72 | valid ppl    41.38 | valid bpc    5.371
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  269 batches | lr 0.00000 | ms/batch 247.10 | loss  3.00 | ppl    20.05 
| epoch  94 |   200/  269 batches | lr 0.00000 | ms/batch 230.97 | loss  2.95 | ppl    19.20 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 65.33s | valid loss  3.73 | valid ppl    41.64 | valid bpc    5.380
-----------------------------------------------------------------------------------------
PROGRESS: 94.0%
| epoch  95 |   100/  269 batches | lr 0.00000 | ms/batch 197.50 | loss  2.99 | ppl    19.90 
| epoch  95 |   200/  269 batches | lr 0.00000 | ms/batch 163.48 | loss  2.95 | ppl    19.14 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 48.66s | valid loss  3.74 | valid ppl    42.15 | valid bpc    5.397
-----------------------------------------------------------------------------------------
PROGRESS: 95.0%
| epoch  96 |   100/  269 batches | lr 0.00000 | ms/batch 177.38 | loss  2.98 | ppl    19.61 
| epoch  96 |   200/  269 batches | lr 0.00000 | ms/batch 158.59 | loss  2.95 | ppl    19.15 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 45.32s | valid loss  3.74 | valid ppl    42.03 | valid bpc    5.393
-----------------------------------------------------------------------------------------
PROGRESS: 96.0%
| epoch  97 |   100/  269 batches | lr 0.00000 | ms/batch 165.34 | loss  2.98 | ppl    19.70 
| epoch  97 |   200/  269 batches | lr 0.00000 | ms/batch 186.04 | loss  2.98 | ppl    19.60 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 52.71s | valid loss  3.75 | valid ppl    42.45 | valid bpc    5.408
-----------------------------------------------------------------------------------------
PROGRESS: 97.0%
| epoch  98 |   100/  269 batches | lr 0.00000 | ms/batch 251.93 | loss  3.00 | ppl    20.06 
| epoch  98 |   200/  269 batches | lr 0.00000 | ms/batch 222.74 | loss  2.95 | ppl    19.07 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 64.99s | valid loss  3.70 | valid ppl    40.41 | valid bpc    5.337
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 98.0%
| epoch  99 |   100/  269 batches | lr 0.00000 | ms/batch 251.59 | loss  2.99 | ppl    19.92 
| epoch  99 |   200/  269 batches | lr 0.00000 | ms/batch 221.19 | loss  2.96 | ppl    19.28 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 65.05s | valid loss  3.71 | valid ppl    40.72 | valid bpc    5.348
-----------------------------------------------------------------------------------------
PROGRESS: 99.0%
| epoch 100 |   100/  269 batches | lr 0.00000 | ms/batch 252.15 | loss  2.98 | ppl    19.71 
| epoch 100 |   200/  269 batches | lr 0.00000 | ms/batch 215.55 | loss  2.97 | ppl    19.46 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 59.42s | valid loss  3.75 | valid ppl    42.40 | valid bpc    5.406
-----------------------------------------------------------------------------------------
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  3.82 | test ppl    45.56 | test bpc    5.510
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.3871, Mean Reca: 0.5455, Mean F1: 0.4490, Mean Subword_Reca: 0.7489
-----------------------------------------------------------------------------------------
=========================================================================================
Loading dataset...
Using subword tokenizer...
Number of tokens:  8000
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer_in_parser', nhid=512, nlayers=8, front_layers=5, rear_layers=3, subword='omarmomen/ptb_filtered_lowcase_bpe_tokenizer_8', n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=3333, nonmono=5, cuda=True, log_interval=100, save='trained_models/subword_structformer_in_parser_3333_53.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 37449076
Model architecture: StructFormer_In_Parser(
  (transformer_front): Transformer_Front(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(8000, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-4): 5 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
  (transformer_rear): Transformer_Rear(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(8000, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-2): 3 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (output_layer): Linear(in_features=512, out_features=8000, bias=True)
  )
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  269 batches | lr 0.00030 | ms/batch 260.35 | loss  7.75 | ppl  2321.29 
| epoch   1 |   200/  269 batches | lr 0.00030 | ms/batch 227.45 | loss  7.37 | ppl  1592.19 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 65.43s | valid loss  7.10 | valid ppl  1209.86 | valid bpc   10.241
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  269 batches | lr 0.00030 | ms/batch 251.95 | loss  7.30 | ppl  1482.65 
| epoch   2 |   200/  269 batches | lr 0.00030 | ms/batch 228.85 | loss  7.12 | ppl  1240.67 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 64.68s | valid loss  6.75 | valid ppl   853.31 | valid bpc    9.737
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  269 batches | lr 0.00030 | ms/batch 251.32 | loss  6.89 | ppl   982.13 
| epoch   3 |   200/  269 batches | lr 0.00030 | ms/batch 227.68 | loss  6.62 | ppl   749.27 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 64.61s | valid loss  6.17 | valid ppl   478.09 | valid bpc    8.901
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  269 batches | lr 0.00030 | ms/batch 251.37 | loss  6.31 | ppl   548.32 
| epoch   4 |   200/  269 batches | lr 0.00030 | ms/batch 229.62 | loss  6.09 | ppl   439.64 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 64.67s | valid loss  5.70 | valid ppl   299.09 | valid bpc    8.224
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  269 batches | lr 0.00030 | ms/batch 251.82 | loss  5.94 | ppl   380.63 
| epoch   5 |   200/  269 batches | lr 0.00030 | ms/batch 227.89 | loss  5.80 | ppl   331.15 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 64.71s | valid loss  5.51 | valid ppl   246.32 | valid bpc    7.944
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  269 batches | lr 0.00030 | ms/batch 252.70 | loss  5.70 | ppl   298.44 
| epoch   6 |   200/  269 batches | lr 0.00030 | ms/batch 227.01 | loss  5.59 | ppl   266.91 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 64.69s | valid loss  5.38 | valid ppl   216.80 | valid bpc    7.760
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  269 batches | lr 0.00030 | ms/batch 250.89 | loss  5.51 | ppl   247.92 
| epoch   7 |   200/  269 batches | lr 0.00030 | ms/batch 228.96 | loss  5.43 | ppl   228.51 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 64.66s | valid loss  5.22 | valid ppl   184.87 | valid bpc    7.530
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  269 batches | lr 0.00030 | ms/batch 251.80 | loss  5.37 | ppl   215.57 
| epoch   8 |   200/  269 batches | lr 0.00030 | ms/batch 233.87 | loss  5.30 | ppl   200.00 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 64.65s | valid loss  5.13 | valid ppl   169.26 | valid bpc    7.403
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 8.0%
| epoch   9 |   100/  269 batches | lr 0.00030 | ms/batch 253.45 | loss  5.28 | ppl   197.07 
| epoch   9 |   200/  269 batches | lr 0.00030 | ms/batch 235.75 | loss  5.18 | ppl   177.44 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 64.67s | valid loss  5.03 | valid ppl   153.18 | valid bpc    7.259
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  269 batches | lr 0.00030 | ms/batch 253.37 | loss  5.15 | ppl   171.91 
| epoch  10 |   200/  269 batches | lr 0.00030 | ms/batch 237.10 | loss  5.09 | ppl   163.02 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 64.77s | valid loss  4.93 | valid ppl   138.10 | valid bpc    7.110
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  269 batches | lr 0.00030 | ms/batch 251.06 | loss  5.04 | ppl   154.88 
| epoch  11 |   200/  269 batches | lr 0.00030 | ms/batch 237.98 | loss  4.99 | ppl   146.33 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 64.70s | valid loss  4.83 | valid ppl   124.83 | valid bpc    6.964
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  269 batches | lr 0.00030 | ms/batch 252.17 | loss  4.95 | ppl   141.62 
| epoch  12 |   200/  269 batches | lr 0.00030 | ms/batch 238.50 | loss  4.91 | ppl   135.79 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 64.74s | valid loss  4.76 | valid ppl   116.63 | valid bpc    6.866
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 12.0%
| epoch  13 |   100/  269 batches | lr 0.00030 | ms/batch 252.38 | loss  4.89 | ppl   133.22 
| epoch  13 |   200/  269 batches | lr 0.00030 | ms/batch 238.74 | loss  4.81 | ppl   122.37 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 65.11s | valid loss  4.71 | valid ppl   110.87 | valid bpc    6.793
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 13.0%
| epoch  14 |   100/  269 batches | lr 0.00030 | ms/batch 250.98 | loss  4.77 | ppl   117.83 
| epoch  14 |   200/  269 batches | lr 0.00030 | ms/batch 239.23 | loss  4.73 | ppl   112.79 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 64.71s | valid loss  4.63 | valid ppl   102.29 | valid bpc    6.677
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  269 batches | lr 0.00030 | ms/batch 251.97 | loss  4.70 | ppl   109.83 
| epoch  15 |   200/  269 batches | lr 0.00030 | ms/batch 238.48 | loss  4.66 | ppl   105.86 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 64.69s | valid loss  4.56 | valid ppl    95.65 | valid bpc    6.580
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 15.0%
| epoch  16 |   100/  269 batches | lr 0.00030 | ms/batch 253.16 | loss  4.64 | ppl   103.13 
| epoch  16 |   200/  269 batches | lr 0.00030 | ms/batch 236.19 | loss  4.59 | ppl    98.87 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 64.81s | valid loss  4.48 | valid ppl    87.83 | valid bpc    6.457
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 16.0%
| epoch  17 |   100/  269 batches | lr 0.00030 | ms/batch 252.00 | loss  4.55 | ppl    94.40 
| epoch  17 |   200/  269 batches | lr 0.00030 | ms/batch 238.72 | loss  4.53 | ppl    92.98 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 64.74s | valid loss  4.46 | valid ppl    86.33 | valid bpc    6.432
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 17.0%
| epoch  18 |   100/  269 batches | lr 0.00030 | ms/batch 251.07 | loss  4.51 | ppl    90.91 
| epoch  18 |   200/  269 batches | lr 0.00030 | ms/batch 237.44 | loss  4.45 | ppl    85.26 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 65.03s | valid loss  4.44 | valid ppl    84.40 | valid bpc    6.399
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 18.0%
| epoch  19 |   100/  269 batches | lr 0.00030 | ms/batch 253.27 | loss  4.42 | ppl    83.15 
| epoch  19 |   200/  269 batches | lr 0.00030 | ms/batch 237.21 | loss  4.41 | ppl    82.55 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 64.97s | valid loss  4.40 | valid ppl    81.42 | valid bpc    6.347
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 19.0%
| epoch  20 |   100/  269 batches | lr 0.00030 | ms/batch 253.07 | loss  4.37 | ppl    79.09 
| epoch  20 |   200/  269 batches | lr 0.00030 | ms/batch 237.56 | loss  4.35 | ppl    77.15 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 65.39s | valid loss  4.30 | valid ppl    73.53 | valid bpc    6.200
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 20.0%
| epoch  21 |   100/  269 batches | lr 0.00030 | ms/batch 251.67 | loss  4.29 | ppl    73.15 
| epoch  21 |   200/  269 batches | lr 0.00030 | ms/batch 237.44 | loss  4.27 | ppl    71.52 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 65.51s | valid loss  4.28 | valid ppl    72.22 | valid bpc    6.174
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 21.0%
| epoch  22 |   100/  269 batches | lr 0.00030 | ms/batch 251.40 | loss  4.27 | ppl    71.44 
| epoch  22 |   200/  269 batches | lr 0.00030 | ms/batch 237.83 | loss  4.20 | ppl    67.00 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 65.19s | valid loss  4.29 | valid ppl    72.94 | valid bpc    6.189
-----------------------------------------------------------------------------------------
PROGRESS: 22.0%
| epoch  23 |   100/  269 batches | lr 0.00030 | ms/batch 246.61 | loss  4.19 | ppl    66.01 
| epoch  23 |   200/  269 batches | lr 0.00030 | ms/batch 237.36 | loss  4.17 | ppl    64.52 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 65.71s | valid loss  4.23 | valid ppl    68.85 | valid bpc    6.105
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 23.0%
| epoch  24 |   100/  269 batches | lr 0.00030 | ms/batch 243.41 | loss  4.12 | ppl    61.84 
| epoch  24 |   200/  269 batches | lr 0.00030 | ms/batch 238.99 | loss  4.13 | ppl    62.12 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 65.32s | valid loss  4.22 | valid ppl    67.83 | valid bpc    6.084
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 24.0%
| epoch  25 |   100/  269 batches | lr 0.00030 | ms/batch 241.34 | loss  4.09 | ppl    59.49 
| epoch  25 |   200/  269 batches | lr 0.00030 | ms/batch 238.34 | loss  4.04 | ppl    56.72 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 64.95s | valid loss  4.13 | valid ppl    61.98 | valid bpc    5.954
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 25.0%
| epoch  26 |   100/  269 batches | lr 0.00030 | ms/batch 241.81 | loss  4.07 | ppl    58.48 
| epoch  26 |   200/  269 batches | lr 0.00030 | ms/batch 237.64 | loss  4.02 | ppl    55.45 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 65.13s | valid loss  4.16 | valid ppl    64.22 | valid bpc    6.005
-----------------------------------------------------------------------------------------
PROGRESS: 26.0%
| epoch  27 |   100/  269 batches | lr 0.00030 | ms/batch 239.63 | loss  4.02 | ppl    55.71 
| epoch  27 |   200/  269 batches | lr 0.00030 | ms/batch 236.80 | loss  3.97 | ppl    53.11 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 65.24s | valid loss  4.19 | valid ppl    65.76 | valid bpc    6.039
-----------------------------------------------------------------------------------------
PROGRESS: 27.0%
| epoch  28 |   100/  269 batches | lr 0.00030 | ms/batch 233.27 | loss  3.96 | ppl    52.34 
| epoch  28 |   200/  269 batches | lr 0.00030 | ms/batch 237.26 | loss  3.93 | ppl    50.82 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 64.65s | valid loss  4.10 | valid ppl    60.16 | valid bpc    5.911
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  269 batches | lr 0.00030 | ms/batch 233.02 | loss  3.93 | ppl    50.84 
| epoch  29 |   200/  269 batches | lr 0.00030 | ms/batch 238.15 | loss  3.87 | ppl    47.87 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 64.76s | valid loss  4.01 | valid ppl    54.89 | valid bpc    5.778
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  269 batches | lr 0.00030 | ms/batch 237.01 | loss  3.90 | ppl    49.16 
| epoch  30 |   200/  269 batches | lr 0.00030 | ms/batch 237.70 | loss  3.84 | ppl    46.39 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 65.00s | valid loss  4.06 | valid ppl    57.75 | valid bpc    5.852
-----------------------------------------------------------------------------------------
PROGRESS: 30.0%
| epoch  31 |   100/  269 batches | lr 0.00030 | ms/batch 236.69 | loss  3.84 | ppl    46.60 
| epoch  31 |   200/  269 batches | lr 0.00030 | ms/batch 238.97 | loss  3.82 | ppl    45.82 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 65.17s | valid loss  3.99 | valid ppl    53.91 | valid bpc    5.752
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 31.0%
| epoch  32 |   100/  269 batches | lr 0.00030 | ms/batch 241.36 | loss  3.80 | ppl    44.87 
| epoch  32 |   200/  269 batches | lr 0.00030 | ms/batch 237.41 | loss  3.76 | ppl    42.90 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 65.45s | valid loss  4.03 | valid ppl    56.34 | valid bpc    5.816
-----------------------------------------------------------------------------------------
PROGRESS: 32.0%
| epoch  33 |   100/  269 batches | lr 0.00030 | ms/batch 235.31 | loss  3.75 | ppl    42.44 
| epoch  33 |   200/  269 batches | lr 0.00030 | ms/batch 238.97 | loss  3.72 | ppl    41.11 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 64.99s | valid loss  4.00 | valid ppl    54.42 | valid bpc    5.766
-----------------------------------------------------------------------------------------
PROGRESS: 33.0%
| epoch  34 |   100/  269 batches | lr 0.00030 | ms/batch 241.03 | loss  3.72 | ppl    41.23 
| epoch  34 |   200/  269 batches | lr 0.00030 | ms/batch 238.03 | loss  3.67 | ppl    39.20 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 65.49s | valid loss  4.02 | valid ppl    55.73 | valid bpc    5.800
-----------------------------------------------------------------------------------------
PROGRESS: 34.0%
| epoch  35 |   100/  269 batches | lr 0.00015 | ms/batch 240.70 | loss  3.65 | ppl    38.43 
| epoch  35 |   200/  269 batches | lr 0.00015 | ms/batch 237.08 | loss  3.57 | ppl    35.68 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 65.43s | valid loss  3.92 | valid ppl    50.52 | valid bpc    5.659
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 35.0%
| epoch  36 |   100/  269 batches | lr 0.00015 | ms/batch 240.00 | loss  3.59 | ppl    36.08 
| epoch  36 |   200/  269 batches | lr 0.00015 | ms/batch 238.27 | loss  3.55 | ppl    34.75 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 65.37s | valid loss  3.94 | valid ppl    51.37 | valid bpc    5.683
-----------------------------------------------------------------------------------------
PROGRESS: 36.0%
| epoch  37 |   100/  269 batches | lr 0.00015 | ms/batch 233.99 | loss  3.55 | ppl    34.74 
| epoch  37 |   200/  269 batches | lr 0.00015 | ms/batch 237.02 | loss  3.51 | ppl    33.57 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 64.71s | valid loss  3.87 | valid ppl    47.83 | valid bpc    5.580
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 37.0%
| epoch  38 |   100/  269 batches | lr 0.00015 | ms/batch 236.74 | loss  3.50 | ppl    33.15 
| epoch  38 |   200/  269 batches | lr 0.00015 | ms/batch 238.91 | loss  3.50 | ppl    32.98 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 65.06s | valid loss  3.85 | valid ppl    46.80 | valid bpc    5.549
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 38.0%
| epoch  39 |   100/  269 batches | lr 0.00015 | ms/batch 237.81 | loss  3.49 | ppl    32.79 
| epoch  39 |   200/  269 batches | lr 0.00015 | ms/batch 237.49 | loss  3.47 | ppl    32.03 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 65.09s | valid loss  3.90 | valid ppl    49.39 | valid bpc    5.626
-----------------------------------------------------------------------------------------
PROGRESS: 39.0%
| epoch  40 |   100/  269 batches | lr 0.00015 | ms/batch 240.16 | loss  3.46 | ppl    31.68 
| epoch  40 |   200/  269 batches | lr 0.00015 | ms/batch 238.15 | loss  3.45 | ppl    31.53 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 65.39s | valid loss  3.88 | valid ppl    48.63 | valid bpc    5.604
-----------------------------------------------------------------------------------------
PROGRESS: 40.0%
| epoch  41 |   100/  269 batches | lr 0.00015 | ms/batch 241.17 | loss  3.44 | ppl    31.11 
| epoch  41 |   200/  269 batches | lr 0.00015 | ms/batch 236.88 | loss  3.44 | ppl    31.20 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 65.44s | valid loss  3.89 | valid ppl    48.84 | valid bpc    5.610
-----------------------------------------------------------------------------------------
PROGRESS: 41.0%
| epoch  42 |   100/  269 batches | lr 0.00007 | ms/batch 240.57 | loss  3.41 | ppl    30.15 
| epoch  42 |   200/  269 batches | lr 0.00007 | ms/batch 237.00 | loss  3.39 | ppl    29.57 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 65.37s | valid loss  3.82 | valid ppl    45.42 | valid bpc    5.505
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 42.0%
| epoch  43 |   100/  269 batches | lr 0.00007 | ms/batch 238.22 | loss  3.38 | ppl    29.39 
| epoch  43 |   200/  269 batches | lr 0.00007 | ms/batch 237.63 | loss  3.35 | ppl    28.51 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 65.11s | valid loss  3.85 | valid ppl    47.02 | valid bpc    5.555
-----------------------------------------------------------------------------------------
PROGRESS: 43.0%
| epoch  44 |   100/  269 batches | lr 0.00007 | ms/batch 241.12 | loss  3.36 | ppl    28.91 
| epoch  44 |   200/  269 batches | lr 0.00007 | ms/batch 237.38 | loss  3.34 | ppl    28.26 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 65.43s | valid loss  3.82 | valid ppl    45.46 | valid bpc    5.507
-----------------------------------------------------------------------------------------
PROGRESS: 44.0%
| epoch  45 |   100/  269 batches | lr 0.00007 | ms/batch 239.20 | loss  3.34 | ppl    28.30 
| epoch  45 |   200/  269 batches | lr 0.00007 | ms/batch 239.75 | loss  3.31 | ppl    27.52 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 65.40s | valid loss  3.84 | valid ppl    46.41 | valid bpc    5.537
-----------------------------------------------------------------------------------------
PROGRESS: 45.0%
| epoch  46 |   100/  269 batches | lr 0.00004 | ms/batch 239.72 | loss  3.31 | ppl    27.48 
| epoch  46 |   200/  269 batches | lr 0.00004 | ms/batch 235.51 | loss  3.30 | ppl    27.17 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 65.00s | valid loss  3.82 | valid ppl    45.59 | valid bpc    5.511
-----------------------------------------------------------------------------------------
PROGRESS: 46.0%
| epoch  47 |   100/  269 batches | lr 0.00004 | ms/batch 242.43 | loss  3.30 | ppl    27.11 
| epoch  47 |   200/  269 batches | lr 0.00004 | ms/batch 231.76 | loss  3.27 | ppl    26.43 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 65.00s | valid loss  3.83 | valid ppl    45.99 | valid bpc    5.523
-----------------------------------------------------------------------------------------
PROGRESS: 47.0%
| epoch  48 |   100/  269 batches | lr 0.00004 | ms/batch 247.14 | loss  3.31 | ppl    27.50 
| epoch  48 |   200/  269 batches | lr 0.00004 | ms/batch 231.35 | loss  3.25 | ppl    25.90 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 65.46s | valid loss  3.85 | valid ppl    46.84 | valid bpc    5.550
-----------------------------------------------------------------------------------------
PROGRESS: 48.0%
| epoch  49 |   100/  269 batches | lr 0.00002 | ms/batch 246.81 | loss  3.28 | ppl    26.69 
| epoch  49 |   200/  269 batches | lr 0.00002 | ms/batch 228.18 | loss  3.23 | ppl    25.36 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 65.12s | valid loss  3.77 | valid ppl    43.25 | valid bpc    5.435
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 49.0%
| epoch  50 |   100/  269 batches | lr 0.00002 | ms/batch 246.12 | loss  3.28 | ppl    26.69 
| epoch  50 |   200/  269 batches | lr 0.00002 | ms/batch 232.33 | loss  3.24 | ppl    25.42 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 65.40s | valid loss  3.76 | valid ppl    43.04 | valid bpc    5.428
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 50.0%
| epoch  51 |   100/  269 batches | lr 0.00002 | ms/batch 246.58 | loss  3.26 | ppl    25.97 
| epoch  51 |   200/  269 batches | lr 0.00002 | ms/batch 232.55 | loss  3.25 | ppl    25.83 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 65.44s | valid loss  3.82 | valid ppl    45.41 | valid bpc    5.505
-----------------------------------------------------------------------------------------
PROGRESS: 51.0%
| epoch  52 |   100/  269 batches | lr 0.00002 | ms/batch 246.45 | loss  3.25 | ppl    25.92 
| epoch  52 |   200/  269 batches | lr 0.00002 | ms/batch 228.05 | loss  3.23 | ppl    25.16 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 65.00s | valid loss  3.78 | valid ppl    43.72 | valid bpc    5.450
-----------------------------------------------------------------------------------------
PROGRESS: 52.0%
| epoch  53 |   100/  269 batches | lr 0.00002 | ms/batch 245.18 | loss  3.26 | ppl    26.09 
| epoch  53 |   200/  269 batches | lr 0.00002 | ms/batch 233.28 | loss  3.24 | ppl    25.51 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 65.38s | valid loss  3.77 | valid ppl    43.54 | valid bpc    5.444
-----------------------------------------------------------------------------------------
PROGRESS: 53.0%
| epoch  54 |   100/  269 batches | lr 0.00001 | ms/batch 245.87 | loss  3.27 | ppl    26.30 
| epoch  54 |   200/  269 batches | lr 0.00001 | ms/batch 232.03 | loss  3.23 | ppl    25.33 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 65.47s | valid loss  3.78 | valid ppl    43.91 | valid bpc    5.456
-----------------------------------------------------------------------------------------
PROGRESS: 54.0%
| epoch  55 |   100/  269 batches | lr 0.00001 | ms/batch 244.68 | loss  3.25 | ppl    25.72 
| epoch  55 |   200/  269 batches | lr 0.00001 | ms/batch 229.78 | loss  3.22 | ppl    25.14 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 65.02s | valid loss  3.81 | valid ppl    45.10 | valid bpc    5.495
-----------------------------------------------------------------------------------------
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  269 batches | lr 0.00001 | ms/batch 251.06 | loss  3.25 | ppl    25.80 
| epoch  56 |   200/  269 batches | lr 0.00001 | ms/batch 229.02 | loss  3.22 | ppl    25.07 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 65.37s | valid loss  3.83 | valid ppl    46.22 | valid bpc    5.530
-----------------------------------------------------------------------------------------
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  269 batches | lr 0.00000 | ms/batch 251.37 | loss  3.25 | ppl    25.84 
| epoch  57 |   200/  269 batches | lr 0.00000 | ms/batch 226.86 | loss  3.22 | ppl    25.04 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 65.42s | valid loss  3.84 | valid ppl    46.50 | valid bpc    5.539
-----------------------------------------------------------------------------------------
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  269 batches | lr 0.00000 | ms/batch 252.40 | loss  3.27 | ppl    26.36 
| epoch  58 |   200/  269 batches | lr 0.00000 | ms/batch 226.51 | loss  3.23 | ppl    25.23 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 65.40s | valid loss  3.78 | valid ppl    43.79 | valid bpc    5.452
-----------------------------------------------------------------------------------------
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  269 batches | lr 0.00000 | ms/batch 251.68 | loss  3.24 | ppl    25.58 
| epoch  59 |   200/  269 batches | lr 0.00000 | ms/batch 226.69 | loss  3.23 | ppl    25.32 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 65.40s | valid loss  3.81 | valid ppl    45.02 | valid bpc    5.492
-----------------------------------------------------------------------------------------
PROGRESS: 59.0%
| epoch  60 |   100/  269 batches | lr 0.00000 | ms/batch 252.13 | loss  3.23 | ppl    25.27 
| epoch  60 |   200/  269 batches | lr 0.00000 | ms/batch 225.53 | loss  3.19 | ppl    24.30 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 65.43s | valid loss  3.74 | valid ppl    42.30 | valid bpc    5.403
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 60.0%
| epoch  61 |   100/  269 batches | lr 0.00000 | ms/batch 253.75 | loss  3.23 | ppl    25.19 
| epoch  61 |   200/  269 batches | lr 0.00000 | ms/batch 225.64 | loss  3.21 | ppl    24.69 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 65.45s | valid loss  3.83 | valid ppl    46.00 | valid bpc    5.524
-----------------------------------------------------------------------------------------
PROGRESS: 61.0%
| epoch  62 |   100/  269 batches | lr 0.00000 | ms/batch 252.61 | loss  3.25 | ppl    25.68 
| epoch  62 |   200/  269 batches | lr 0.00000 | ms/batch 226.95 | loss  3.22 | ppl    25.07 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 65.41s | valid loss  3.78 | valid ppl    43.79 | valid bpc    5.452
-----------------------------------------------------------------------------------------
PROGRESS: 62.0%
| epoch  63 |   100/  269 batches | lr 0.00000 | ms/batch 251.28 | loss  3.25 | ppl    25.88 
| epoch  63 |   200/  269 batches | lr 0.00000 | ms/batch 233.05 | loss  3.21 | ppl    24.73 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 65.42s | valid loss  3.80 | valid ppl    44.83 | valid bpc    5.486
-----------------------------------------------------------------------------------------
PROGRESS: 63.0%
| epoch  64 |   100/  269 batches | lr 0.00000 | ms/batch 252.69 | loss  3.23 | ppl    25.40 
| epoch  64 |   200/  269 batches | lr 0.00000 | ms/batch 233.35 | loss  3.19 | ppl    24.34 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 65.46s | valid loss  3.80 | valid ppl    44.50 | valid bpc    5.476
-----------------------------------------------------------------------------------------
PROGRESS: 64.0%
| epoch  65 |   100/  269 batches | lr 0.00000 | ms/batch 252.24 | loss  3.22 | ppl    24.94 
| epoch  65 |   200/  269 batches | lr 0.00000 | ms/batch 231.35 | loss  3.22 | ppl    25.04 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 65.44s | valid loss  3.82 | valid ppl    45.54 | valid bpc    5.509
-----------------------------------------------------------------------------------------
PROGRESS: 65.0%
| epoch  66 |   100/  269 batches | lr 0.00000 | ms/batch 251.51 | loss  3.22 | ppl    24.98 
| epoch  66 |   200/  269 batches | lr 0.00000 | ms/batch 232.20 | loss  3.22 | ppl    25.07 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 65.40s | valid loss  3.82 | valid ppl    45.70 | valid bpc    5.514
-----------------------------------------------------------------------------------------
PROGRESS: 66.0%
| epoch  67 |   100/  269 batches | lr 0.00000 | ms/batch 252.21 | loss  3.24 | ppl    25.49 
| epoch  67 |   200/  269 batches | lr 0.00000 | ms/batch 231.90 | loss  3.21 | ppl    24.71 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 65.37s | valid loss  3.79 | valid ppl    44.34 | valid bpc    5.471
-----------------------------------------------------------------------------------------
PROGRESS: 67.0%
| epoch  68 |   100/  269 batches | lr 0.00000 | ms/batch 251.76 | loss  3.24 | ppl    25.57 
| epoch  68 |   200/  269 batches | lr 0.00000 | ms/batch 231.14 | loss  3.21 | ppl    24.74 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 64.98s | valid loss  3.84 | valid ppl    46.74 | valid bpc    5.547
-----------------------------------------------------------------------------------------
PROGRESS: 68.0%
| epoch  69 |   100/  269 batches | lr 0.00000 | ms/batch 251.44 | loss  3.23 | ppl    25.40 
| epoch  69 |   200/  269 batches | lr 0.00000 | ms/batch 231.79 | loss  3.19 | ppl    24.32 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 65.31s | valid loss  3.79 | valid ppl    44.21 | valid bpc    5.466
-----------------------------------------------------------------------------------------
PROGRESS: 69.0%
| epoch  70 |   100/  269 batches | lr 0.00000 | ms/batch 252.94 | loss  3.25 | ppl    25.78 
| epoch  70 |   200/  269 batches | lr 0.00000 | ms/batch 231.81 | loss  3.19 | ppl    24.38 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 65.12s | valid loss  3.79 | valid ppl    44.19 | valid bpc    5.466
-----------------------------------------------------------------------------------------
PROGRESS: 70.0%
| epoch  71 |   100/  269 batches | lr 0.00000 | ms/batch 252.13 | loss  3.22 | ppl    25.10 
| epoch  71 |   200/  269 batches | lr 0.00000 | ms/batch 232.14 | loss  3.21 | ppl    24.71 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 65.40s | valid loss  3.80 | valid ppl    44.82 | valid bpc    5.486
-----------------------------------------------------------------------------------------
PROGRESS: 71.0%
| epoch  72 |   100/  269 batches | lr 0.00000 | ms/batch 253.83 | loss  3.25 | ppl    25.67 
| epoch  72 |   200/  269 batches | lr 0.00000 | ms/batch 231.03 | loss  3.19 | ppl    24.41 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 65.48s | valid loss  3.78 | valid ppl    43.66 | valid bpc    5.448
-----------------------------------------------------------------------------------------
PROGRESS: 72.0%
| epoch  73 |   100/  269 batches | lr 0.00000 | ms/batch 251.56 | loss  3.21 | ppl    24.85 
| epoch  73 |   200/  269 batches | lr 0.00000 | ms/batch 230.56 | loss  3.20 | ppl    24.54 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 65.89s | valid loss  3.77 | valid ppl    43.51 | valid bpc    5.443
-----------------------------------------------------------------------------------------
PROGRESS: 73.0%
| epoch  74 |   100/  269 batches | lr 0.00000 | ms/batch 246.05 | loss  3.23 | ppl    25.30 
| epoch  74 |   200/  269 batches | lr 0.00000 | ms/batch 231.87 | loss  3.18 | ppl    23.97 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 65.46s | valid loss  3.79 | valid ppl    44.18 | valid bpc    5.465
-----------------------------------------------------------------------------------------
PROGRESS: 74.0%
| epoch  75 |   100/  269 batches | lr 0.00000 | ms/batch 247.14 | loss  3.23 | ppl    25.28 
| epoch  75 |   200/  269 batches | lr 0.00000 | ms/batch 231.32 | loss  3.21 | ppl    24.76 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 65.38s | valid loss  3.79 | valid ppl    44.17 | valid bpc    5.465
-----------------------------------------------------------------------------------------
PROGRESS: 75.0%
| epoch  76 |   100/  269 batches | lr 0.00000 | ms/batch 246.57 | loss  3.23 | ppl    25.32 
| epoch  76 |   200/  269 batches | lr 0.00000 | ms/batch 231.15 | loss  3.22 | ppl    25.05 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 65.39s | valid loss  3.84 | valid ppl    46.66 | valid bpc    5.544
-----------------------------------------------------------------------------------------
PROGRESS: 76.0%
| epoch  77 |   100/  269 batches | lr 0.00000 | ms/batch 246.06 | loss  3.26 | ppl    25.97 
| epoch  77 |   200/  269 batches | lr 0.00000 | ms/batch 231.14 | loss  3.19 | ppl    24.32 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 65.37s | valid loss  3.77 | valid ppl    43.51 | valid bpc    5.443
-----------------------------------------------------------------------------------------
PROGRESS: 77.0%
| epoch  78 |   100/  269 batches | lr 0.00000 | ms/batch 247.32 | loss  3.24 | ppl    25.43 
| epoch  78 |   200/  269 batches | lr 0.00000 | ms/batch 232.06 | loss  3.21 | ppl    24.83 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 65.42s | valid loss  3.83 | valid ppl    46.27 | valid bpc    5.532
-----------------------------------------------------------------------------------------
PROGRESS: 78.0%
| epoch  79 |   100/  269 batches | lr 0.00000 | ms/batch 246.76 | loss  3.24 | ppl    25.58 
| epoch  79 |   200/  269 batches | lr 0.00000 | ms/batch 231.47 | loss  3.20 | ppl    24.46 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 65.40s | valid loss  3.77 | valid ppl    43.48 | valid bpc    5.442
-----------------------------------------------------------------------------------------
PROGRESS: 79.0%
| epoch  80 |   100/  269 batches | lr 0.00000 | ms/batch 247.20 | loss  3.25 | ppl    25.83 
| epoch  80 |   200/  269 batches | lr 0.00000 | ms/batch 231.31 | loss  3.21 | ppl    24.82 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 65.38s | valid loss  3.84 | valid ppl    46.66 | valid bpc    5.544
-----------------------------------------------------------------------------------------
PROGRESS: 80.0%
| epoch  81 |   100/  269 batches | lr 0.00000 | ms/batch 244.52 | loss  3.23 | ppl    25.30 
| epoch  81 |   200/  269 batches | lr 0.00000 | ms/batch 233.70 | loss  3.19 | ppl    24.38 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 65.48s | valid loss  3.82 | valid ppl    45.61 | valid bpc    5.511
-----------------------------------------------------------------------------------------
PROGRESS: 81.0%
| epoch  82 |   100/  269 batches | lr 0.00000 | ms/batch 246.49 | loss  3.23 | ppl    25.30 
| epoch  82 |   200/  269 batches | lr 0.00000 | ms/batch 232.83 | loss  3.19 | ppl    24.22 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 65.47s | valid loss  3.81 | valid ppl    45.30 | valid bpc    5.501
-----------------------------------------------------------------------------------------
PROGRESS: 82.0%
| epoch  83 |   100/  269 batches | lr 0.00000 | ms/batch 246.77 | loss  3.25 | ppl    25.80 
| epoch  83 |   200/  269 batches | lr 0.00000 | ms/batch 232.09 | loss  3.22 | ppl    24.90 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 65.47s | valid loss  3.82 | valid ppl    45.64 | valid bpc    5.512
-----------------------------------------------------------------------------------------
PROGRESS: 83.0%
| epoch  84 |   100/  269 batches | lr 0.00000 | ms/batch 246.32 | loss  3.21 | ppl    24.82 
| epoch  84 |   200/  269 batches | lr 0.00000 | ms/batch 232.41 | loss  3.21 | ppl    24.73 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 65.43s | valid loss  3.83 | valid ppl    46.19 | valid bpc    5.530
-----------------------------------------------------------------------------------------
PROGRESS: 84.0%
| epoch  85 |   100/  269 batches | lr 0.00000 | ms/batch 246.60 | loss  3.24 | ppl    25.55 
| epoch  85 |   200/  269 batches | lr 0.00000 | ms/batch 231.38 | loss  3.20 | ppl    24.58 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 65.41s | valid loss  3.81 | valid ppl    44.98 | valid bpc    5.491
-----------------------------------------------------------------------------------------
PROGRESS: 85.0%
| epoch  86 |   100/  269 batches | lr 0.00000 | ms/batch 246.82 | loss  3.26 | ppl    26.16 
| epoch  86 |   200/  269 batches | lr 0.00000 | ms/batch 231.00 | loss  3.19 | ppl    24.32 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 65.39s | valid loss  3.79 | valid ppl    44.23 | valid bpc    5.467
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  269 batches | lr 0.00000 | ms/batch 247.25 | loss  3.24 | ppl    25.44 
| epoch  87 |   200/  269 batches | lr 0.00000 | ms/batch 232.36 | loss  3.21 | ppl    24.84 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 65.51s | valid loss  3.81 | valid ppl    45.09 | valid bpc    5.495
-----------------------------------------------------------------------------------------
PROGRESS: 87.0%
| epoch  88 |   100/  269 batches | lr 0.00000 | ms/batch 245.45 | loss  3.21 | ppl    24.88 
| epoch  88 |   200/  269 batches | lr 0.00000 | ms/batch 231.62 | loss  3.21 | ppl    24.76 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 65.44s | valid loss  3.82 | valid ppl    45.59 | valid bpc    5.511
-----------------------------------------------------------------------------------------
PROGRESS: 88.0%
| epoch  89 |   100/  269 batches | lr 0.00000 | ms/batch 246.71 | loss  3.24 | ppl    25.47 
| epoch  89 |   200/  269 batches | lr 0.00000 | ms/batch 231.84 | loss  3.21 | ppl    24.74 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 65.43s | valid loss  3.81 | valid ppl    45.11 | valid bpc    5.495
-----------------------------------------------------------------------------------------
PROGRESS: 89.0%
| epoch  90 |   100/  269 batches | lr 0.00000 | ms/batch 247.28 | loss  3.22 | ppl    24.92 
| epoch  90 |   200/  269 batches | lr 0.00000 | ms/batch 231.73 | loss  3.20 | ppl    24.51 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 65.43s | valid loss  3.77 | valid ppl    43.49 | valid bpc    5.443
-----------------------------------------------------------------------------------------
PROGRESS: 90.0%
| epoch  91 |   100/  269 batches | lr 0.00000 | ms/batch 250.67 | loss  3.23 | ppl    25.27 
| epoch  91 |   200/  269 batches | lr 0.00000 | ms/batch 227.29 | loss  3.20 | ppl    24.45 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 65.42s | valid loss  3.84 | valid ppl    46.41 | valid bpc    5.536
-----------------------------------------------------------------------------------------
PROGRESS: 91.0%
| epoch  92 |   100/  269 batches | lr 0.00000 | ms/batch 252.77 | loss  3.25 | ppl    25.77 
| epoch  92 |   200/  269 batches | lr 0.00000 | ms/batch 225.32 | loss  3.18 | ppl    24.11 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 65.42s | valid loss  3.80 | valid ppl    44.71 | valid bpc    5.483
-----------------------------------------------------------------------------------------
PROGRESS: 92.0%
| epoch  93 |   100/  269 batches | lr 0.00000 | ms/batch 252.15 | loss  3.24 | ppl    25.54 
| epoch  93 |   200/  269 batches | lr 0.00000 | ms/batch 229.52 | loss  3.19 | ppl    24.41 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 65.44s | valid loss  3.76 | valid ppl    42.88 | valid bpc    5.422
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  269 batches | lr 0.00000 | ms/batch 252.78 | loss  3.24 | ppl    25.65 
| epoch  94 |   200/  269 batches | lr 0.00000 | ms/batch 230.86 | loss  3.20 | ppl    24.62 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 65.47s | valid loss  3.77 | valid ppl    43.35 | valid bpc    5.438
-----------------------------------------------------------------------------------------
PROGRESS: 94.0%
| epoch  95 |   100/  269 batches | lr 0.00000 | ms/batch 251.40 | loss  3.23 | ppl    25.29 
| epoch  95 |   200/  269 batches | lr 0.00000 | ms/batch 231.88 | loss  3.20 | ppl    24.63 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 65.10s | valid loss  3.80 | valid ppl    44.76 | valid bpc    5.484
-----------------------------------------------------------------------------------------
PROGRESS: 95.0%
| epoch  96 |   100/  269 batches | lr 0.00000 | ms/batch 251.69 | loss  3.22 | ppl    25.14 
| epoch  96 |   200/  269 batches | lr 0.00000 | ms/batch 193.45 | loss  3.21 | ppl    24.87 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 56.55s | valid loss  3.82 | valid ppl    45.45 | valid bpc    5.506
-----------------------------------------------------------------------------------------
PROGRESS: 96.0%
| epoch  97 |   100/  269 batches | lr 0.00000 | ms/batch 177.60 | loss  3.23 | ppl    25.27 
| epoch  97 |   200/  269 batches | lr 0.00000 | ms/batch 170.51 | loss  3.21 | ppl    24.70 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 46.54s | valid loss  3.80 | valid ppl    44.55 | valid bpc    5.477
-----------------------------------------------------------------------------------------
PROGRESS: 97.0%
| epoch  98 |   100/  269 batches | lr 0.00000 | ms/batch 166.53 | loss  3.23 | ppl    25.30 
| epoch  98 |   200/  269 batches | lr 0.00000 | ms/batch 158.40 | loss  3.23 | ppl    25.18 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 45.12s | valid loss  3.78 | valid ppl    43.71 | valid bpc    5.450
-----------------------------------------------------------------------------------------
PROGRESS: 98.0%
| epoch  99 |   100/  269 batches | lr 0.00000 | ms/batch 251.69 | loss  3.23 | ppl    25.32 
| epoch  99 |   200/  269 batches | lr 0.00000 | ms/batch 238.37 | loss  3.20 | ppl    24.65 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 64.58s | valid loss  3.82 | valid ppl    45.65 | valid bpc    5.513
-----------------------------------------------------------------------------------------
PROGRESS: 99.0%
| epoch 100 |   100/  269 batches | lr 0.00000 | ms/batch 252.22 | loss  3.24 | ppl    25.43 
| epoch 100 |   200/  269 batches | lr 0.00000 | ms/batch 237.34 | loss  3.20 | ppl    24.50 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 65.84s | valid loss  3.76 | valid ppl    42.94 | valid bpc    5.424
-----------------------------------------------------------------------------------------
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  3.91 | test ppl    50.14 | test bpc    5.648
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.4640, Mean Reca: 0.6515, Mean F1: 0.5378, Mean Subword_Reca: 0.8222
-----------------------------------------------------------------------------------------
=========================================================================================
Loading dataset...
Using subword tokenizer...
Number of tokens:  8000
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer_in_parser', nhid=512, nlayers=8, front_layers=5, rear_layers=3, subword='omarmomen/ptb_filtered_lowcase_bpe_tokenizer_8', n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=4444, nonmono=5, cuda=True, log_interval=100, save='trained_models/subword_structformer_in_parser_4444_53.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 37449076
Model architecture: StructFormer_In_Parser(
  (transformer_front): Transformer_Front(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(8000, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-4): 5 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
  (transformer_rear): Transformer_Rear(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(8000, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-2): 3 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (output_layer): Linear(in_features=512, out_features=8000, bias=True)
  )
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  269 batches | lr 0.00030 | ms/batch 173.75 | loss  7.72 | ppl  2253.67 
| epoch   1 |   200/  269 batches | lr 0.00030 | ms/batch 228.46 | loss  7.35 | ppl  1557.92 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 57.74s | valid loss  7.09 | valid ppl  1198.25 | valid bpc   10.227
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  269 batches | lr 0.00030 | ms/batch 244.80 | loss  7.28 | ppl  1457.84 
| epoch   2 |   200/  269 batches | lr 0.00030 | ms/batch 231.71 | loss  7.15 | ppl  1272.66 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 64.60s | valid loss  6.86 | valid ppl   957.21 | valid bpc    9.903
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  269 batches | lr 0.00030 | ms/batch 246.99 | loss  7.03 | ppl  1125.52 
| epoch   3 |   200/  269 batches | lr 0.00030 | ms/batch 233.81 | loss  6.71 | ppl   820.02 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 64.69s | valid loss  6.22 | valid ppl   501.43 | valid bpc    8.970
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  269 batches | lr 0.00030 | ms/batch 249.03 | loss  6.34 | ppl   569.42 
| epoch   4 |   200/  269 batches | lr 0.00030 | ms/batch 231.67 | loss  6.14 | ppl   466.26 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 64.71s | valid loss  5.78 | valid ppl   322.50 | valid bpc    8.333
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  269 batches | lr 0.00030 | ms/batch 251.26 | loss  5.96 | ppl   388.53 
| epoch   5 |   200/  269 batches | lr 0.00030 | ms/batch 229.30 | loss  5.83 | ppl   340.51 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 64.77s | valid loss  5.55 | valid ppl   256.92 | valid bpc    8.005
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  269 batches | lr 0.00030 | ms/batch 251.70 | loss  5.73 | ppl   308.42 
| epoch   6 |   200/  269 batches | lr 0.00030 | ms/batch 228.79 | loss  5.63 | ppl   278.78 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 64.74s | valid loss  5.35 | valid ppl   211.20 | valid bpc    7.722
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  269 batches | lr 0.00030 | ms/batch 251.96 | loss  5.55 | ppl   257.80 
| epoch   7 |   200/  269 batches | lr 0.00030 | ms/batch 227.97 | loss  5.44 | ppl   231.25 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 64.77s | valid loss  5.20 | valid ppl   180.68 | valid bpc    7.497
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  269 batches | lr 0.00030 | ms/batch 250.94 | loss  5.38 | ppl   216.72 
| epoch   8 |   200/  269 batches | lr 0.00030 | ms/batch 230.13 | loss  5.32 | ppl   203.80 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 64.79s | valid loss  5.11 | valid ppl   165.54 | valid bpc    7.371
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 8.0%
| epoch   9 |   100/  269 batches | lr 0.00030 | ms/batch 252.18 | loss  5.27 | ppl   195.32 
| epoch   9 |   200/  269 batches | lr 0.00030 | ms/batch 228.31 | loss  5.23 | ppl   186.46 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 64.73s | valid loss  4.98 | valid ppl   145.18 | valid bpc    7.182
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  269 batches | lr 0.00030 | ms/batch 252.42 | loss  5.16 | ppl   173.88 
| epoch  10 |   200/  269 batches | lr 0.00030 | ms/batch 227.91 | loss  5.08 | ppl   161.11 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 64.74s | valid loss  4.94 | valid ppl   139.24 | valid bpc    7.121
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  269 batches | lr 0.00030 | ms/batch 252.18 | loss  5.05 | ppl   155.61 
| epoch  11 |   200/  269 batches | lr 0.00030 | ms/batch 229.40 | loss  5.01 | ppl   149.26 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 64.73s | valid loss  4.87 | valid ppl   130.75 | valid bpc    7.031
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  269 batches | lr 0.00030 | ms/batch 251.29 | loss  4.96 | ppl   142.51 
| epoch  12 |   200/  269 batches | lr 0.00030 | ms/batch 228.74 | loss  4.92 | ppl   137.05 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 64.70s | valid loss  4.78 | valid ppl   118.63 | valid bpc    6.890
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 12.0%
| epoch  13 |   100/  269 batches | lr 0.00030 | ms/batch 251.49 | loss  4.87 | ppl   130.10 
| epoch  13 |   200/  269 batches | lr 0.00030 | ms/batch 229.57 | loss  4.81 | ppl   122.35 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 65.02s | valid loss  4.67 | valid ppl   106.58 | valid bpc    6.736
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 13.0%
| epoch  14 |   100/  269 batches | lr 0.00030 | ms/batch 250.78 | loss  4.79 | ppl   120.47 
| epoch  14 |   200/  269 batches | lr 0.00030 | ms/batch 228.44 | loss  4.73 | ppl   113.40 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 65.35s | valid loss  4.63 | valid ppl   102.32 | valid bpc    6.677
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  269 batches | lr 0.00030 | ms/batch 251.14 | loss  4.69 | ppl   108.34 
| epoch  15 |   200/  269 batches | lr 0.00030 | ms/batch 229.08 | loss  4.65 | ppl   104.26 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 65.49s | valid loss  4.56 | valid ppl    95.39 | valid bpc    6.576
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 15.0%
| epoch  16 |   100/  269 batches | lr 0.00030 | ms/batch 251.33 | loss  4.62 | ppl   101.44 
| epoch  16 |   200/  269 batches | lr 0.00030 | ms/batch 229.54 | loss  4.60 | ppl    99.30 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 65.43s | valid loss  4.51 | valid ppl    90.49 | valid bpc    6.500
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 16.0%
| epoch  17 |   100/  269 batches | lr 0.00030 | ms/batch 249.82 | loss  4.56 | ppl    95.68 
| epoch  17 |   200/  269 batches | lr 0.00030 | ms/batch 227.74 | loss  4.51 | ppl    90.93 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 65.32s | valid loss  4.42 | valid ppl    83.44 | valid bpc    6.383
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 17.0%
| epoch  18 |   100/  269 batches | lr 0.00030 | ms/batch 248.70 | loss  4.47 | ppl    87.27 
| epoch  18 |   200/  269 batches | lr 0.00030 | ms/batch 228.61 | loss  4.45 | ppl    85.62 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 65.28s | valid loss  4.36 | valid ppl    77.95 | valid bpc    6.284
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 18.0%
| epoch  19 |   100/  269 batches | lr 0.00030 | ms/batch 240.79 | loss  4.42 | ppl    83.49 
| epoch  19 |   200/  269 batches | lr 0.00030 | ms/batch 227.84 | loss  4.37 | ppl    78.80 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 64.47s | valid loss  4.36 | valid ppl    78.03 | valid bpc    6.286
-----------------------------------------------------------------------------------------
PROGRESS: 19.0%
| epoch  20 |   100/  269 batches | lr 0.00030 | ms/batch 242.27 | loss  4.36 | ppl    78.25 
| epoch  20 |   200/  269 batches | lr 0.00030 | ms/batch 228.52 | loss  4.33 | ppl    75.58 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 64.72s | valid loss  4.30 | valid ppl    73.35 | valid bpc    6.197
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 20.0%
| epoch  21 |   100/  269 batches | lr 0.00030 | ms/batch 246.54 | loss  4.31 | ppl    74.51 
| epoch  21 |   200/  269 batches | lr 0.00030 | ms/batch 227.70 | loss  4.25 | ppl    70.00 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 65.07s | valid loss  4.27 | valid ppl    71.73 | valid bpc    6.164
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 21.0%
| epoch  22 |   100/  269 batches | lr 0.00030 | ms/batch 242.82 | loss  4.24 | ppl    69.08 
| epoch  22 |   200/  269 batches | lr 0.00030 | ms/batch 228.68 | loss  4.21 | ppl    67.15 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 64.67s | valid loss  4.26 | valid ppl    70.50 | valid bpc    6.140
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 22.0%
| epoch  23 |   100/  269 batches | lr 0.00030 | ms/batch 247.11 | loss  4.18 | ppl    65.38 
| epoch  23 |   200/  269 batches | lr 0.00030 | ms/batch 228.77 | loss  4.14 | ppl    63.09 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 65.11s | valid loss  4.23 | valid ppl    68.68 | valid bpc    6.102
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 23.0%
| epoch  24 |   100/  269 batches | lr 0.00030 | ms/batch 242.08 | loss  4.13 | ppl    62.22 
| epoch  24 |   200/  269 batches | lr 0.00030 | ms/batch 229.59 | loss  4.10 | ppl    60.20 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 64.71s | valid loss  4.20 | valid ppl    66.71 | valid bpc    6.060
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 24.0%
| epoch  25 |   100/  269 batches | lr 0.00030 | ms/batch 241.69 | loss  4.03 | ppl    56.50 
| epoch  25 |   200/  269 batches | lr 0.00030 | ms/batch 230.17 | loss  4.06 | ppl    58.24 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 64.72s | valid loss  4.16 | valid ppl    64.38 | valid bpc    6.008
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 25.0%
| epoch  26 |   100/  269 batches | lr 0.00030 | ms/batch 244.26 | loss  4.02 | ppl    55.65 
| epoch  26 |   200/  269 batches | lr 0.00030 | ms/batch 228.45 | loss  4.00 | ppl    54.70 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 64.73s | valid loss  4.10 | valid ppl    60.59 | valid bpc    5.921
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 26.0%
| epoch  27 |   100/  269 batches | lr 0.00030 | ms/batch 243.02 | loss  3.98 | ppl    53.48 
| epoch  27 |   200/  269 batches | lr 0.00030 | ms/batch 228.61 | loss  3.94 | ppl    51.63 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 64.70s | valid loss  4.09 | valid ppl    59.58 | valid bpc    5.897
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 27.0%
| epoch  28 |   100/  269 batches | lr 0.00030 | ms/batch 246.30 | loss  3.93 | ppl    50.95 
| epoch  28 |   200/  269 batches | lr 0.00030 | ms/batch 231.47 | loss  3.92 | ppl    50.61 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 65.40s | valid loss  4.12 | valid ppl    61.28 | valid bpc    5.937
-----------------------------------------------------------------------------------------
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  269 batches | lr 0.00030 | ms/batch 246.59 | loss  3.88 | ppl    48.42 
| epoch  29 |   200/  269 batches | lr 0.00030 | ms/batch 228.85 | loss  3.88 | ppl    48.34 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 65.16s | valid loss  4.05 | valid ppl    57.55 | valid bpc    5.847
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  269 batches | lr 0.00030 | ms/batch 246.67 | loss  3.85 | ppl    46.80 
| epoch  30 |   200/  269 batches | lr 0.00030 | ms/batch 227.68 | loss  3.82 | ppl    45.68 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 65.05s | valid loss  4.04 | valid ppl    56.94 | valid bpc    5.831
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 30.0%
| epoch  31 |   100/  269 batches | lr 0.00030 | ms/batch 246.18 | loss  3.80 | ppl    44.56 
| epoch  31 |   200/  269 batches | lr 0.00030 | ms/batch 231.52 | loss  3.77 | ppl    43.51 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 65.40s | valid loss  4.01 | valid ppl    55.09 | valid bpc    5.784
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 31.0%
| epoch  32 |   100/  269 batches | lr 0.00030 | ms/batch 243.86 | loss  3.76 | ppl    43.13 
| epoch  32 |   200/  269 batches | lr 0.00030 | ms/batch 227.40 | loss  3.73 | ppl    41.72 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 64.76s | valid loss  4.02 | valid ppl    55.68 | valid bpc    5.799
-----------------------------------------------------------------------------------------
PROGRESS: 32.0%
| epoch  33 |   100/  269 batches | lr 0.00030 | ms/batch 243.83 | loss  3.72 | ppl    41.36 
| epoch  33 |   200/  269 batches | lr 0.00030 | ms/batch 231.45 | loss  3.72 | ppl    41.17 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 65.14s | valid loss  3.99 | valid ppl    54.20 | valid bpc    5.760
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 33.0%
| epoch  34 |   100/  269 batches | lr 0.00030 | ms/batch 246.79 | loss  3.69 | ppl    40.17 
| epoch  34 |   200/  269 batches | lr 0.00030 | ms/batch 232.48 | loss  3.67 | ppl    39.30 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 65.49s | valid loss  3.97 | valid ppl    53.03 | valid bpc    5.729
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 34.0%
| epoch  35 |   100/  269 batches | lr 0.00030 | ms/batch 246.33 | loss  3.65 | ppl    38.38 
| epoch  35 |   200/  269 batches | lr 0.00030 | ms/batch 232.07 | loss  3.64 | ppl    38.06 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 65.49s | valid loss  3.95 | valid ppl    51.80 | valid bpc    5.695
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 35.0%
| epoch  36 |   100/  269 batches | lr 0.00030 | ms/batch 245.86 | loss  3.63 | ppl    37.88 
| epoch  36 |   200/  269 batches | lr 0.00030 | ms/batch 227.95 | loss  3.60 | ppl    36.65 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 65.05s | valid loss  3.95 | valid ppl    51.74 | valid bpc    5.693
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 36.0%
| epoch  37 |   100/  269 batches | lr 0.00030 | ms/batch 242.73 | loss  3.58 | ppl    36.03 
| epoch  37 |   200/  269 batches | lr 0.00030 | ms/batch 233.08 | loss  3.55 | ppl    34.89 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 65.10s | valid loss  3.90 | valid ppl    49.37 | valid bpc    5.625
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 37.0%
| epoch  38 |   100/  269 batches | lr 0.00030 | ms/batch 246.00 | loss  3.55 | ppl    34.74 
| epoch  38 |   200/  269 batches | lr 0.00030 | ms/batch 232.27 | loss  3.55 | ppl    34.71 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 65.44s | valid loss  3.97 | valid ppl    52.95 | valid bpc    5.727
-----------------------------------------------------------------------------------------
PROGRESS: 38.0%
| epoch  39 |   100/  269 batches | lr 0.00030 | ms/batch 248.81 | loss  3.52 | ppl    33.72 
| epoch  39 |   200/  269 batches | lr 0.00030 | ms/batch 226.67 | loss  3.51 | ppl    33.53 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 65.04s | valid loss  3.95 | valid ppl    51.75 | valid bpc    5.693
-----------------------------------------------------------------------------------------
PROGRESS: 39.0%
| epoch  40 |   100/  269 batches | lr 0.00030 | ms/batch 252.33 | loss  3.50 | ppl    33.03 
| epoch  40 |   200/  269 batches | lr 0.00030 | ms/batch 218.47 | loss  3.47 | ppl    32.26 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 64.72s | valid loss  3.95 | valid ppl    51.73 | valid bpc    5.693
-----------------------------------------------------------------------------------------
PROGRESS: 40.0%
| epoch  41 |   100/  269 batches | lr 0.00015 | ms/batch 251.84 | loss  3.42 | ppl    30.55 
| epoch  41 |   200/  269 batches | lr 0.00015 | ms/batch 225.67 | loss  3.36 | ppl    28.92 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 65.44s | valid loss  3.90 | valid ppl    49.33 | valid bpc    5.624
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 41.0%
| epoch  42 |   100/  269 batches | lr 0.00015 | ms/batch 252.65 | loss  3.38 | ppl    29.28 
| epoch  42 |   200/  269 batches | lr 0.00015 | ms/batch 222.03 | loss  3.32 | ppl    27.65 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 65.07s | valid loss  3.84 | valid ppl    46.71 | valid bpc    5.546
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 42.0%
| epoch  43 |   100/  269 batches | lr 0.00015 | ms/batch 253.21 | loss  3.35 | ppl    28.51 
| epoch  43 |   200/  269 batches | lr 0.00015 | ms/batch 221.70 | loss  3.28 | ppl    26.62 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 65.08s | valid loss  3.90 | valid ppl    49.22 | valid bpc    5.621
-----------------------------------------------------------------------------------------
PROGRESS: 43.0%
| epoch  44 |   100/  269 batches | lr 0.00015 | ms/batch 252.08 | loss  3.28 | ppl    26.61 
| epoch  44 |   200/  269 batches | lr 0.00015 | ms/batch 226.00 | loss  3.28 | ppl    26.66 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 65.39s | valid loss  3.81 | valid ppl    45.30 | valid bpc    5.502
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 44.0%
| epoch  45 |   100/  269 batches | lr 0.00015 | ms/batch 251.69 | loss  3.28 | ppl    26.64 
| epoch  45 |   200/  269 batches | lr 0.00015 | ms/batch 223.02 | loss  3.25 | ppl    25.76 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 65.07s | valid loss  3.84 | valid ppl    46.33 | valid bpc    5.534
-----------------------------------------------------------------------------------------
PROGRESS: 45.0%
| epoch  46 |   100/  269 batches | lr 0.00015 | ms/batch 252.51 | loss  3.28 | ppl    26.48 
| epoch  46 |   200/  269 batches | lr 0.00015 | ms/batch 222.54 | loss  3.23 | ppl    25.23 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 65.11s | valid loss  3.83 | valid ppl    46.19 | valid bpc    5.530
-----------------------------------------------------------------------------------------
PROGRESS: 46.0%
| epoch  47 |   100/  269 batches | lr 0.00015 | ms/batch 252.44 | loss  3.23 | ppl    25.25 
| epoch  47 |   200/  269 batches | lr 0.00015 | ms/batch 227.52 | loss  3.20 | ppl    24.51 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 65.47s | valid loss  3.89 | valid ppl    48.99 | valid bpc    5.614
-----------------------------------------------------------------------------------------
PROGRESS: 47.0%
| epoch  48 |   100/  269 batches | lr 0.00007 | ms/batch 252.21 | loss  3.23 | ppl    25.18 
| epoch  48 |   200/  269 batches | lr 0.00007 | ms/batch 229.27 | loss  3.15 | ppl    23.40 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 65.42s | valid loss  3.81 | valid ppl    45.20 | valid bpc    5.498
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 48.0%
| epoch  49 |   100/  269 batches | lr 0.00007 | ms/batch 252.00 | loss  3.17 | ppl    23.75 
| epoch  49 |   200/  269 batches | lr 0.00007 | ms/batch 227.47 | loss  3.16 | ppl    23.52 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 65.49s | valid loss  3.80 | valid ppl    44.83 | valid bpc    5.487
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 49.0%
| epoch  50 |   100/  269 batches | lr 0.00007 | ms/batch 252.44 | loss  3.15 | ppl    23.35 
| epoch  50 |   200/  269 batches | lr 0.00007 | ms/batch 225.55 | loss  3.14 | ppl    23.03 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 65.31s | valid loss  3.82 | valid ppl    45.79 | valid bpc    5.517
-----------------------------------------------------------------------------------------
PROGRESS: 50.0%
| epoch  51 |   100/  269 batches | lr 0.00007 | ms/batch 252.66 | loss  3.14 | ppl    23.05 
| epoch  51 |   200/  269 batches | lr 0.00007 | ms/batch 228.45 | loss  3.12 | ppl    22.63 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 65.41s | valid loss  3.78 | valid ppl    43.63 | valid bpc    5.447
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 51.0%
| epoch  52 |   100/  269 batches | lr 0.00007 | ms/batch 251.49 | loss  3.13 | ppl    22.92 
| epoch  52 |   200/  269 batches | lr 0.00007 | ms/batch 227.92 | loss  3.08 | ppl    21.83 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 65.07s | valid loss  3.80 | valid ppl    44.86 | valid bpc    5.487
-----------------------------------------------------------------------------------------
PROGRESS: 52.0%
| epoch  53 |   100/  269 batches | lr 0.00007 | ms/batch 252.46 | loss  3.13 | ppl    22.79 
| epoch  53 |   200/  269 batches | lr 0.00007 | ms/batch 232.19 | loss  3.09 | ppl    21.88 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 65.42s | valid loss  3.81 | valid ppl    45.23 | valid bpc    5.499
-----------------------------------------------------------------------------------------
PROGRESS: 53.0%
| epoch  54 |   100/  269 batches | lr 0.00007 | ms/batch 251.87 | loss  3.09 | ppl    21.95 
| epoch  54 |   200/  269 batches | lr 0.00007 | ms/batch 232.25 | loss  3.06 | ppl    21.33 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 65.37s | valid loss  3.79 | valid ppl    44.25 | valid bpc    5.468
-----------------------------------------------------------------------------------------
PROGRESS: 54.0%
| epoch  55 |   100/  269 batches | lr 0.00004 | ms/batch 251.71 | loss  3.09 | ppl    21.99 
| epoch  55 |   200/  269 batches | lr 0.00004 | ms/batch 231.44 | loss  3.05 | ppl    21.04 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 65.43s | valid loss  3.76 | valid ppl    43.04 | valid bpc    5.427
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  269 batches | lr 0.00004 | ms/batch 251.83 | loss  3.06 | ppl    21.41 
| epoch  56 |   200/  269 batches | lr 0.00004 | ms/batch 232.29 | loss  3.03 | ppl    20.67 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 65.38s | valid loss  3.73 | valid ppl    41.64 | valid bpc    5.380
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  269 batches | lr 0.00004 | ms/batch 251.22 | loss  3.05 | ppl    21.01 
| epoch  57 |   200/  269 batches | lr 0.00004 | ms/batch 231.45 | loss  3.04 | ppl    20.86 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 65.00s | valid loss  3.78 | valid ppl    43.73 | valid bpc    5.451
-----------------------------------------------------------------------------------------
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  269 batches | lr 0.00004 | ms/batch 253.04 | loss  3.05 | ppl    21.02 
| epoch  58 |   200/  269 batches | lr 0.00004 | ms/batch 232.03 | loss  3.02 | ppl    20.45 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 65.48s | valid loss  3.79 | valid ppl    44.40 | valid bpc    5.473
-----------------------------------------------------------------------------------------
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  269 batches | lr 0.00004 | ms/batch 253.98 | loss  3.05 | ppl    21.13 
| epoch  59 |   200/  269 batches | lr 0.00004 | ms/batch 233.82 | loss  3.01 | ppl    20.21 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 65.38s | valid loss  3.78 | valid ppl    43.78 | valid bpc    5.452
-----------------------------------------------------------------------------------------
PROGRESS: 59.0%
| epoch  60 |   100/  269 batches | lr 0.00002 | ms/batch 252.44 | loss  3.02 | ppl    20.55 
| epoch  60 |   200/  269 batches | lr 0.00002 | ms/batch 237.82 | loss  3.01 | ppl    20.35 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 65.42s | valid loss  3.75 | valid ppl    42.34 | valid bpc    5.404
-----------------------------------------------------------------------------------------
PROGRESS: 60.0%
| epoch  61 |   100/  269 batches | lr 0.00002 | ms/batch 251.38 | loss  3.00 | ppl    20.10 
| epoch  61 |   200/  269 batches | lr 0.00002 | ms/batch 237.51 | loss  3.00 | ppl    20.14 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 65.36s | valid loss  3.77 | valid ppl    43.59 | valid bpc    5.446
-----------------------------------------------------------------------------------------
PROGRESS: 61.0%
| epoch  62 |   100/  269 batches | lr 0.00002 | ms/batch 252.23 | loss  3.03 | ppl    20.61 
| epoch  62 |   200/  269 batches | lr 0.00002 | ms/batch 238.07 | loss  3.01 | ppl    20.26 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 65.43s | valid loss  3.77 | valid ppl    43.39 | valid bpc    5.439
-----------------------------------------------------------------------------------------
PROGRESS: 62.0%
| epoch  63 |   100/  269 batches | lr 0.00001 | ms/batch 252.25 | loss  2.99 | ppl    19.79 
| epoch  63 |   200/  269 batches | lr 0.00001 | ms/batch 237.44 | loss  3.00 | ppl    20.13 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 65.38s | valid loss  3.77 | valid ppl    43.26 | valid bpc    5.435
-----------------------------------------------------------------------------------------
PROGRESS: 63.0%
| epoch  64 |   100/  269 batches | lr 0.00001 | ms/batch 251.56 | loss  3.01 | ppl    20.22 
| epoch  64 |   200/  269 batches | lr 0.00001 | ms/batch 237.41 | loss  2.96 | ppl    19.33 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 64.78s | valid loss  3.78 | valid ppl    43.98 | valid bpc    5.459
-----------------------------------------------------------------------------------------
PROGRESS: 64.0%
| epoch  65 |   100/  269 batches | lr 0.00001 | ms/batch 252.43 | loss  3.01 | ppl    20.27 
| epoch  65 |   200/  269 batches | lr 0.00001 | ms/batch 237.40 | loss  2.96 | ppl    19.30 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 65.49s | valid loss  3.76 | valid ppl    43.01 | valid bpc    5.427
-----------------------------------------------------------------------------------------
PROGRESS: 65.0%
| epoch  66 |   100/  269 batches | lr 0.00000 | ms/batch 251.58 | loss  3.00 | ppl    20.12 
| epoch  66 |   200/  269 batches | lr 0.00000 | ms/batch 237.81 | loss  2.98 | ppl    19.72 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 65.46s | valid loss  3.78 | valid ppl    44.01 | valid bpc    5.460
-----------------------------------------------------------------------------------------
PROGRESS: 66.0%
| epoch  67 |   100/  269 batches | lr 0.00000 | ms/batch 253.08 | loss  3.00 | ppl    20.14 
| epoch  67 |   200/  269 batches | lr 0.00000 | ms/batch 236.57 | loss  2.95 | ppl    19.19 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 65.40s | valid loss  3.79 | valid ppl    44.12 | valid bpc    5.463
-----------------------------------------------------------------------------------------
PROGRESS: 67.0%
| epoch  68 |   100/  269 batches | lr 0.00000 | ms/batch 252.61 | loss  3.00 | ppl    20.09 
| epoch  68 |   200/  269 batches | lr 0.00000 | ms/batch 238.04 | loss  2.95 | ppl    19.20 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 65.45s | valid loss  3.71 | valid ppl    40.80 | valid bpc    5.350
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 68.0%
| epoch  69 |   100/  269 batches | lr 0.00000 | ms/batch 251.29 | loss  3.00 | ppl    20.06 
| epoch  69 |   200/  269 batches | lr 0.00000 | ms/batch 237.72 | loss  2.97 | ppl    19.41 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 65.43s | valid loss  3.75 | valid ppl    42.57 | valid bpc    5.412
-----------------------------------------------------------------------------------------
PROGRESS: 69.0%
| epoch  70 |   100/  269 batches | lr 0.00000 | ms/batch 252.32 | loss  2.99 | ppl    19.88 
| epoch  70 |   200/  269 batches | lr 0.00000 | ms/batch 238.19 | loss  2.96 | ppl    19.39 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 65.46s | valid loss  3.80 | valid ppl    44.61 | valid bpc    5.479
-----------------------------------------------------------------------------------------
PROGRESS: 70.0%
| epoch  71 |   100/  269 batches | lr 0.00000 | ms/batch 252.96 | loss  3.00 | ppl    20.10 
| epoch  71 |   200/  269 batches | lr 0.00000 | ms/batch 237.56 | loss  2.95 | ppl    19.20 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 65.71s | valid loss  3.71 | valid ppl    40.99 | valid bpc    5.357
-----------------------------------------------------------------------------------------
PROGRESS: 71.0%
| epoch  72 |   100/  269 batches | lr 0.00000 | ms/batch 244.97 | loss  2.99 | ppl    19.98 
| epoch  72 |   200/  269 batches | lr 0.00000 | ms/batch 237.49 | loss  2.97 | ppl    19.48 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 65.28s | valid loss  3.76 | valid ppl    42.93 | valid bpc    5.424
-----------------------------------------------------------------------------------------
PROGRESS: 72.0%
| epoch  73 |   100/  269 batches | lr 0.00000 | ms/batch 247.42 | loss  2.99 | ppl    19.85 
| epoch  73 |   200/  269 batches | lr 0.00000 | ms/batch 238.94 | loss  2.97 | ppl    19.56 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 65.47s | valid loss  3.82 | valid ppl    45.43 | valid bpc    5.506
-----------------------------------------------------------------------------------------
PROGRESS: 73.0%
| epoch  74 |   100/  269 batches | lr 0.00000 | ms/batch 246.20 | loss  2.97 | ppl    19.56 
| epoch  74 |   200/  269 batches | lr 0.00000 | ms/batch 237.51 | loss  2.99 | ppl    19.88 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 65.43s | valid loss  3.76 | valid ppl    42.76 | valid bpc    5.418
-----------------------------------------------------------------------------------------
PROGRESS: 74.0%
| epoch  75 |   100/  269 batches | lr 0.00000 | ms/batch 247.38 | loss  2.98 | ppl    19.69 
| epoch  75 |   200/  269 batches | lr 0.00000 | ms/batch 236.93 | loss  2.97 | ppl    19.45 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 65.41s | valid loss  3.75 | valid ppl    42.71 | valid bpc    5.416
-----------------------------------------------------------------------------------------
PROGRESS: 75.0%
| epoch  76 |   100/  269 batches | lr 0.00000 | ms/batch 245.92 | loss  2.98 | ppl    19.74 
| epoch  76 |   200/  269 batches | lr 0.00000 | ms/batch 238.42 | loss  2.98 | ppl    19.67 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 65.41s | valid loss  3.77 | valid ppl    43.56 | valid bpc    5.445
-----------------------------------------------------------------------------------------
PROGRESS: 76.0%
| epoch  77 |   100/  269 batches | lr 0.00000 | ms/batch 245.17 | loss  3.00 | ppl    20.01 
| epoch  77 |   200/  269 batches | lr 0.00000 | ms/batch 238.92 | loss  2.98 | ppl    19.64 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 65.40s | valid loss  3.74 | valid ppl    42.10 | valid bpc    5.396
-----------------------------------------------------------------------------------------
PROGRESS: 77.0%
| epoch  78 |   100/  269 batches | lr 0.00000 | ms/batch 247.44 | loss  3.00 | ppl    20.13 
| epoch  78 |   200/  269 batches | lr 0.00000 | ms/batch 236.54 | loss  2.95 | ppl    19.19 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 65.49s | valid loss  3.79 | valid ppl    44.14 | valid bpc    5.464
-----------------------------------------------------------------------------------------
PROGRESS: 78.0%
| epoch  79 |   100/  269 batches | lr 0.00000 | ms/batch 245.93 | loss  2.98 | ppl    19.79 
| epoch  79 |   200/  269 batches | lr 0.00000 | ms/batch 238.96 | loss  2.97 | ppl    19.44 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 65.64s | valid loss  3.76 | valid ppl    42.88 | valid bpc    5.422
-----------------------------------------------------------------------------------------
PROGRESS: 79.0%
| epoch  80 |   100/  269 batches | lr 0.00000 | ms/batch 245.10 | loss  3.01 | ppl    20.26 
| epoch  80 |   200/  269 batches | lr 0.00000 | ms/batch 236.99 | loss  2.99 | ppl    19.79 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 65.62s | valid loss  3.75 | valid ppl    42.47 | valid bpc    5.408
-----------------------------------------------------------------------------------------
PROGRESS: 80.0%
| epoch  81 |   100/  269 batches | lr 0.00000 | ms/batch 240.95 | loss  2.98 | ppl    19.76 
| epoch  81 |   200/  269 batches | lr 0.00000 | ms/batch 238.51 | loss  2.97 | ppl    19.49 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 65.54s | valid loss  3.78 | valid ppl    43.68 | valid bpc    5.449
-----------------------------------------------------------------------------------------
PROGRESS: 81.0%
| epoch  82 |   100/  269 batches | lr 0.00000 | ms/batch 240.02 | loss  2.98 | ppl    19.68 
| epoch  82 |   200/  269 batches | lr 0.00000 | ms/batch 236.86 | loss  2.96 | ppl    19.21 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 65.40s | valid loss  3.74 | valid ppl    41.93 | valid bpc    5.390
-----------------------------------------------------------------------------------------
PROGRESS: 82.0%
| epoch  83 |   100/  269 batches | lr 0.00000 | ms/batch 240.88 | loss  2.97 | ppl    19.43 
| epoch  83 |   200/  269 batches | lr 0.00000 | ms/batch 237.07 | loss  2.96 | ppl    19.29 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 65.36s | valid loss  3.77 | valid ppl    43.25 | valid bpc    5.435
-----------------------------------------------------------------------------------------
PROGRESS: 83.0%
| epoch  84 |   100/  269 batches | lr 0.00000 | ms/batch 240.62 | loss  3.00 | ppl    20.02 
| epoch  84 |   200/  269 batches | lr 0.00000 | ms/batch 237.39 | loss  2.97 | ppl    19.41 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 65.40s | valid loss  3.74 | valid ppl    42.30 | valid bpc    5.403
-----------------------------------------------------------------------------------------
PROGRESS: 84.0%
| epoch  85 |   100/  269 batches | lr 0.00000 | ms/batch 238.60 | loss  2.98 | ppl    19.73 
| epoch  85 |   200/  269 batches | lr 0.00000 | ms/batch 237.82 | loss  2.95 | ppl    19.12 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 65.43s | valid loss  3.76 | valid ppl    42.74 | valid bpc    5.417
-----------------------------------------------------------------------------------------
PROGRESS: 85.0%
| epoch  86 |   100/  269 batches | lr 0.00000 | ms/batch 237.67 | loss  2.99 | ppl    19.94 
| epoch  86 |   200/  269 batches | lr 0.00000 | ms/batch 237.13 | loss  2.96 | ppl    19.35 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 65.07s | valid loss  3.83 | valid ppl    45.97 | valid bpc    5.523
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  269 batches | lr 0.00000 | ms/batch 240.04 | loss  2.99 | ppl    19.90 
| epoch  87 |   200/  269 batches | lr 0.00000 | ms/batch 238.86 | loss  2.96 | ppl    19.24 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 65.43s | valid loss  3.79 | valid ppl    44.28 | valid bpc    5.468
-----------------------------------------------------------------------------------------
PROGRESS: 87.0%
| epoch  88 |   100/  269 batches | lr 0.00000 | ms/batch 242.45 | loss  2.99 | ppl    19.81 
| epoch  88 |   200/  269 batches | lr 0.00000 | ms/batch 236.93 | loss  2.95 | ppl    19.13 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 65.45s | valid loss  3.76 | valid ppl    42.87 | valid bpc    5.422
-----------------------------------------------------------------------------------------
PROGRESS: 88.0%
| epoch  89 |   100/  269 batches | lr 0.00000 | ms/batch 245.48 | loss  2.98 | ppl    19.69 
| epoch  89 |   200/  269 batches | lr 0.00000 | ms/batch 232.43 | loss  2.97 | ppl    19.53 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 65.39s | valid loss  3.77 | valid ppl    43.48 | valid bpc    5.442
-----------------------------------------------------------------------------------------
PROGRESS: 89.0%
| epoch  90 |   100/  269 batches | lr 0.00000 | ms/batch 246.65 | loss  2.99 | ppl    19.96 
| epoch  90 |   200/  269 batches | lr 0.00000 | ms/batch 231.71 | loss  2.95 | ppl    19.02 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 65.41s | valid loss  3.79 | valid ppl    44.30 | valid bpc    5.469
-----------------------------------------------------------------------------------------
PROGRESS: 90.0%
| epoch  91 |   100/  269 batches | lr 0.00000 | ms/batch 246.82 | loss  3.00 | ppl    20.09 
| epoch  91 |   200/  269 batches | lr 0.00000 | ms/batch 231.03 | loss  2.95 | ppl    19.14 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 65.42s | valid loss  3.77 | valid ppl    43.51 | valid bpc    5.443
-----------------------------------------------------------------------------------------
PROGRESS: 91.0%
| epoch  92 |   100/  269 batches | lr 0.00000 | ms/batch 246.39 | loss  3.01 | ppl    20.29 
| epoch  92 |   200/  269 batches | lr 0.00000 | ms/batch 231.85 | loss  2.96 | ppl    19.35 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 65.41s | valid loss  3.75 | valid ppl    42.41 | valid bpc    5.406
-----------------------------------------------------------------------------------------
PROGRESS: 92.0%
| epoch  93 |   100/  269 batches | lr 0.00000 | ms/batch 246.42 | loss  2.99 | ppl    19.96 
| epoch  93 |   200/  269 batches | lr 0.00000 | ms/batch 231.97 | loss  2.98 | ppl    19.70 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 65.41s | valid loss  3.75 | valid ppl    42.53 | valid bpc    5.411
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  269 batches | lr 0.00000 | ms/batch 246.32 | loss  2.99 | ppl    19.95 
| epoch  94 |   200/  269 batches | lr 0.00000 | ms/batch 232.19 | loss  2.95 | ppl    19.15 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 65.43s | valid loss  3.82 | valid ppl    45.52 | valid bpc    5.508
-----------------------------------------------------------------------------------------
PROGRESS: 94.0%
| epoch  95 |   100/  269 batches | lr 0.00000 | ms/batch 245.83 | loss  3.00 | ppl    20.02 
| epoch  95 |   200/  269 batches | lr 0.00000 | ms/batch 231.49 | loss  2.98 | ppl    19.68 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 65.39s | valid loss  3.77 | valid ppl    43.55 | valid bpc    5.445
-----------------------------------------------------------------------------------------
PROGRESS: 95.0%
| epoch  96 |   100/  269 batches | lr 0.00000 | ms/batch 247.47 | loss  3.00 | ppl    20.11 
| epoch  96 |   200/  269 batches | lr 0.00000 | ms/batch 231.41 | loss  2.94 | ppl    18.96 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 65.44s | valid loss  3.75 | valid ppl    42.43 | valid bpc    5.407
-----------------------------------------------------------------------------------------
PROGRESS: 96.0%
| epoch  97 |   100/  269 batches | lr 0.00000 | ms/batch 246.72 | loss  3.00 | ppl    20.14 
| epoch  97 |   200/  269 batches | lr 0.00000 | ms/batch 207.00 | loss  2.98 | ppl    19.74 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 57.96s | valid loss  3.79 | valid ppl    44.36 | valid bpc    5.471
-----------------------------------------------------------------------------------------
PROGRESS: 97.0%
| epoch  98 |   100/  269 batches | lr 0.00000 | ms/batch 172.65 | loss  2.98 | ppl    19.65 
| epoch  98 |   200/  269 batches | lr 0.00000 | ms/batch 169.34 | loss  2.98 | ppl    19.70 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 46.70s | valid loss  3.75 | valid ppl    42.63 | valid bpc    5.414
-----------------------------------------------------------------------------------------
PROGRESS: 98.0%
| epoch  99 |   100/  269 batches | lr 0.00000 | ms/batch 161.36 | loss  2.99 | ppl    19.85 
| epoch  99 |   200/  269 batches | lr 0.00000 | ms/batch 159.38 | loss  2.96 | ppl    19.25 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 44.04s | valid loss  3.75 | valid ppl    42.49 | valid bpc    5.409
-----------------------------------------------------------------------------------------
PROGRESS: 99.0%
| epoch 100 |   100/  269 batches | lr 0.00000 | ms/batch 246.18 | loss  3.02 | ppl    20.43 
| epoch 100 |   200/  269 batches | lr 0.00000 | ms/batch 237.76 | loss  2.95 | ppl    19.17 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 65.69s | valid loss  3.75 | valid ppl    42.48 | valid bpc    5.409
-----------------------------------------------------------------------------------------
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  3.85 | test ppl    46.81 | test bpc    5.549
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.4656, Mean Reca: 0.6534, Mean F1: 0.5397, Mean Subword_Reca: 0.8220
-----------------------------------------------------------------------------------------
=========================================================================================
Loading dataset...
Using subword tokenizer...
Number of tokens:  8000
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer_in_parser', nhid=512, nlayers=8, front_layers=5, rear_layers=3, subword='omarmomen/ptb_filtered_lowcase_bpe_tokenizer_8', n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=5555, nonmono=5, cuda=True, log_interval=100, save='trained_models/subword_structformer_in_parser_5555_53.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 37449076
Model architecture: StructFormer_In_Parser(
  (transformer_front): Transformer_Front(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(8000, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-4): 5 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
  (transformer_rear): Transformer_Rear(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(8000, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-2): 3 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (output_layer): Linear(in_features=512, out_features=8000, bias=True)
  )
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  269 batches | lr 0.00030 | ms/batch 172.24 | loss  7.74 | ppl  2294.61 
| epoch   1 |   200/  269 batches | lr 0.00030 | ms/batch 169.89 | loss  7.37 | ppl  1594.33 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 50.75s | valid loss  7.12 | valid ppl  1231.73 | valid bpc   10.266
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  269 batches | lr 0.00030 | ms/batch 251.35 | loss  7.30 | ppl  1486.30 
| epoch   2 |   200/  269 batches | lr 0.00030 | ms/batch 227.97 | loss  7.19 | ppl  1321.36 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 64.64s | valid loss  6.95 | valid ppl  1043.89 | valid bpc   10.028
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  269 batches | lr 0.00030 | ms/batch 250.95 | loss  7.18 | ppl  1309.81 
| epoch   3 |   200/  269 batches | lr 0.00030 | ms/batch 228.39 | loss  6.99 | ppl  1089.24 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 64.68s | valid loss  6.52 | valid ppl   676.30 | valid bpc    9.402
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  269 batches | lr 0.00030 | ms/batch 251.06 | loss  6.65 | ppl   773.19 
| epoch   4 |   200/  269 batches | lr 0.00030 | ms/batch 228.49 | loss  6.35 | ppl   570.12 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 65.17s | valid loss  5.96 | valid ppl   385.89 | valid bpc    8.592
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  269 batches | lr 0.00030 | ms/batch 251.71 | loss  6.11 | ppl   452.56 
| epoch   5 |   200/  269 batches | lr 0.00030 | ms/batch 228.69 | loss  5.95 | ppl   385.51 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 65.49s | valid loss  5.65 | valid ppl   283.33 | valid bpc    8.146
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  269 batches | lr 0.00030 | ms/batch 249.52 | loss  5.83 | ppl   339.08 
| epoch   6 |   200/  269 batches | lr 0.00030 | ms/batch 227.22 | loss  5.72 | ppl   305.86 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 65.37s | valid loss  5.48 | valid ppl   240.65 | valid bpc    7.911
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  269 batches | lr 0.00030 | ms/batch 243.78 | loss  5.66 | ppl   287.00 
| epoch   7 |   200/  269 batches | lr 0.00030 | ms/batch 229.52 | loss  5.55 | ppl   257.56 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 64.90s | valid loss  5.34 | valid ppl   209.30 | valid bpc    7.709
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  269 batches | lr 0.00030 | ms/batch 243.16 | loss  5.51 | ppl   246.77 
| epoch   8 |   200/  269 batches | lr 0.00030 | ms/batch 228.30 | loss  5.41 | ppl   224.06 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 64.68s | valid loss  5.19 | valid ppl   178.88 | valid bpc    7.483
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 8.0%
| epoch   9 |   100/  269 batches | lr 0.00030 | ms/batch 243.48 | loss  5.36 | ppl   212.05 
| epoch   9 |   200/  269 batches | lr 0.00030 | ms/batch 229.90 | loss  5.31 | ppl   201.75 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 64.83s | valid loss  5.08 | valid ppl   161.04 | valid bpc    7.331
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  269 batches | lr 0.00030 | ms/batch 243.84 | loss  5.28 | ppl   196.20 
| epoch  10 |   200/  269 batches | lr 0.00030 | ms/batch 229.10 | loss  5.18 | ppl   178.29 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 64.77s | valid loss  5.00 | valid ppl   148.61 | valid bpc    7.215
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  269 batches | lr 0.00030 | ms/batch 242.64 | loss  5.15 | ppl   172.08 
| epoch  11 |   200/  269 batches | lr 0.00030 | ms/batch 231.12 | loss  5.10 | ppl   164.51 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 64.74s | valid loss  4.90 | valid ppl   134.13 | valid bpc    7.067
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  269 batches | lr 0.00030 | ms/batch 242.08 | loss  5.05 | ppl   156.42 
| epoch  12 |   200/  269 batches | lr 0.00030 | ms/batch 234.04 | loss  4.99 | ppl   146.99 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 64.71s | valid loss  4.83 | valid ppl   125.78 | valid bpc    6.975
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 12.0%
| epoch  13 |   100/  269 batches | lr 0.00030 | ms/batch 243.39 | loss  4.98 | ppl   144.78 
| epoch  13 |   200/  269 batches | lr 0.00030 | ms/batch 235.79 | loss  4.91 | ppl   135.09 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 64.74s | valid loss  4.77 | valid ppl   118.17 | valid bpc    6.885
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 13.0%
| epoch  14 |   100/  269 batches | lr 0.00030 | ms/batch 242.78 | loss  4.86 | ppl   128.96 
| epoch  14 |   200/  269 batches | lr 0.00030 | ms/batch 237.72 | loss  4.84 | ppl   126.30 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 64.78s | valid loss  4.70 | valid ppl   109.78 | valid bpc    6.779
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  269 batches | lr 0.00030 | ms/batch 246.48 | loss  4.78 | ppl   119.45 
| epoch  15 |   200/  269 batches | lr 0.00030 | ms/batch 237.99 | loss  4.73 | ppl   113.61 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 65.09s | valid loss  4.65 | valid ppl   104.63 | valid bpc    6.709
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 15.0%
| epoch  16 |   100/  269 batches | lr 0.00030 | ms/batch 241.84 | loss  4.71 | ppl   111.22 
| epoch  16 |   200/  269 batches | lr 0.00030 | ms/batch 237.72 | loss  4.63 | ppl   102.90 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 64.71s | valid loss  4.51 | valid ppl    91.13 | valid bpc    6.510
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 16.0%
| epoch  17 |   100/  269 batches | lr 0.00030 | ms/batch 242.01 | loss  4.63 | ppl   102.78 
| epoch  17 |   200/  269 batches | lr 0.00030 | ms/batch 238.19 | loss  4.59 | ppl    98.84 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 64.75s | valid loss  4.54 | valid ppl    93.69 | valid bpc    6.550
-----------------------------------------------------------------------------------------
PROGRESS: 17.0%
| epoch  18 |   100/  269 batches | lr 0.00030 | ms/batch 242.06 | loss  4.58 | ppl    97.03 
| epoch  18 |   200/  269 batches | lr 0.00030 | ms/batch 237.42 | loss  4.50 | ppl    89.91 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 64.73s | valid loss  4.50 | valid ppl    90.05 | valid bpc    6.493
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 18.0%
| epoch  19 |   100/  269 batches | lr 0.00030 | ms/batch 242.39 | loss  4.49 | ppl    89.07 
| epoch  19 |   200/  269 batches | lr 0.00030 | ms/batch 237.72 | loss  4.49 | ppl    88.74 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 64.71s | valid loss  4.39 | valid ppl    80.59 | valid bpc    6.333
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 19.0%
| epoch  20 |   100/  269 batches | lr 0.00030 | ms/batch 243.50 | loss  4.44 | ppl    84.51 
| epoch  20 |   200/  269 batches | lr 0.00030 | ms/batch 237.46 | loss  4.40 | ppl    81.46 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 64.74s | valid loss  4.39 | valid ppl    80.43 | valid bpc    6.330
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 20.0%
| epoch  21 |   100/  269 batches | lr 0.00030 | ms/batch 243.84 | loss  4.38 | ppl    80.05 
| epoch  21 |   200/  269 batches | lr 0.00030 | ms/batch 237.17 | loss  4.31 | ppl    74.43 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 64.77s | valid loss  4.33 | valid ppl    75.57 | valid bpc    6.240
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 21.0%
| epoch  22 |   100/  269 batches | lr 0.00030 | ms/batch 246.51 | loss  4.32 | ppl    74.91 
| epoch  22 |   200/  269 batches | lr 0.00030 | ms/batch 237.89 | loss  4.26 | ppl    70.98 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 65.12s | valid loss  4.31 | valid ppl    74.48 | valid bpc    6.219
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 22.0%
| epoch  23 |   100/  269 batches | lr 0.00030 | ms/batch 243.88 | loss  4.26 | ppl    70.88 
| epoch  23 |   200/  269 batches | lr 0.00030 | ms/batch 237.15 | loss  4.23 | ppl    68.73 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 64.72s | valid loss  4.25 | valid ppl    69.97 | valid bpc    6.129
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 23.0%
| epoch  24 |   100/  269 batches | lr 0.00030 | ms/batch 248.43 | loss  4.21 | ppl    67.25 
| epoch  24 |   200/  269 batches | lr 0.00030 | ms/batch 236.71 | loss  4.17 | ppl    64.64 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 65.08s | valid loss  4.22 | valid ppl    68.03 | valid bpc    6.088
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 24.0%
| epoch  25 |   100/  269 batches | lr 0.00030 | ms/batch 250.00 | loss  4.19 | ppl    65.76 
| epoch  25 |   200/  269 batches | lr 0.00030 | ms/batch 234.84 | loss  4.12 | ppl    61.33 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 65.45s | valid loss  4.22 | valid ppl    68.22 | valid bpc    6.092
-----------------------------------------------------------------------------------------
PROGRESS: 25.0%
| epoch  26 |   100/  269 batches | lr 0.00030 | ms/batch 252.76 | loss  4.12 | ppl    61.52 
| epoch  26 |   200/  269 batches | lr 0.00030 | ms/batch 232.38 | loss  4.08 | ppl    59.05 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 65.14s | valid loss  4.16 | valid ppl    64.29 | valid bpc    6.007
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 26.0%
| epoch  27 |   100/  269 batches | lr 0.00030 | ms/batch 251.44 | loss  4.04 | ppl    56.59 
| epoch  27 |   200/  269 batches | lr 0.00030 | ms/batch 228.40 | loss  4.03 | ppl    56.29 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 64.76s | valid loss  4.15 | valid ppl    63.21 | valid bpc    5.982
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 27.0%
| epoch  28 |   100/  269 batches | lr 0.00030 | ms/batch 251.76 | loss  4.01 | ppl    55.18 
| epoch  28 |   200/  269 batches | lr 0.00030 | ms/batch 231.57 | loss  3.98 | ppl    53.45 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 65.48s | valid loss  4.13 | valid ppl    62.32 | valid bpc    5.962
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  269 batches | lr 0.00030 | ms/batch 252.10 | loss  3.97 | ppl    52.79 
| epoch  29 |   200/  269 batches | lr 0.00030 | ms/batch 232.37 | loss  3.97 | ppl    52.87 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 65.43s | valid loss  4.05 | valid ppl    57.23 | valid bpc    5.839
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  269 batches | lr 0.00030 | ms/batch 250.96 | loss  3.92 | ppl    50.63 
| epoch  30 |   200/  269 batches | lr 0.00030 | ms/batch 230.09 | loss  3.90 | ppl    49.31 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 65.10s | valid loss  4.05 | valid ppl    57.24 | valid bpc    5.839
-----------------------------------------------------------------------------------------
PROGRESS: 30.0%
| epoch  31 |   100/  269 batches | lr 0.00030 | ms/batch 251.26 | loss  3.88 | ppl    48.39 
| epoch  31 |   200/  269 batches | lr 0.00030 | ms/batch 228.07 | loss  3.85 | ppl    46.90 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 64.55s | valid loss  4.05 | valid ppl    57.42 | valid bpc    5.843
-----------------------------------------------------------------------------------------
PROGRESS: 31.0%
| epoch  32 |   100/  269 batches | lr 0.00030 | ms/batch 251.76 | loss  3.84 | ppl    46.36 
| epoch  32 |   200/  269 batches | lr 0.00030 | ms/batch 231.80 | loss  3.80 | ppl    44.83 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 65.08s | valid loss  4.08 | valid ppl    59.10 | valid bpc    5.885
-----------------------------------------------------------------------------------------
PROGRESS: 32.0%
| epoch  33 |   100/  269 batches | lr 0.00015 | ms/batch 252.76 | loss  3.77 | ppl    43.38 
| epoch  33 |   200/  269 batches | lr 0.00015 | ms/batch 228.56 | loss  3.72 | ppl    41.18 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 65.11s | valid loss  3.99 | valid ppl    54.29 | valid bpc    5.763
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 33.0%
| epoch  34 |   100/  269 batches | lr 0.00015 | ms/batch 251.92 | loss  3.73 | ppl    41.71 
| epoch  34 |   200/  269 batches | lr 0.00015 | ms/batch 231.67 | loss  3.65 | ppl    38.42 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 65.40s | valid loss  3.96 | valid ppl    52.41 | valid bpc    5.712
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 34.0%
| epoch  35 |   100/  269 batches | lr 0.00015 | ms/batch 251.66 | loss  3.68 | ppl    39.61 
| epoch  35 |   200/  269 batches | lr 0.00015 | ms/batch 232.14 | loss  3.66 | ppl    39.04 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 65.03s | valid loss  3.90 | valid ppl    49.44 | valid bpc    5.628
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 35.0%
| epoch  36 |   100/  269 batches | lr 0.00015 | ms/batch 251.37 | loss  3.64 | ppl    38.12 
| epoch  36 |   200/  269 batches | lr 0.00015 | ms/batch 232.75 | loss  3.62 | ppl    37.31 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 65.10s | valid loss  3.92 | valid ppl    50.22 | valid bpc    5.650
-----------------------------------------------------------------------------------------
PROGRESS: 36.0%
| epoch  37 |   100/  269 batches | lr 0.00015 | ms/batch 250.20 | loss  3.59 | ppl    36.38 
| epoch  37 |   200/  269 batches | lr 0.00015 | ms/batch 233.15 | loss  3.61 | ppl    36.87 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 65.35s | valid loss  3.90 | valid ppl    49.49 | valid bpc    5.629
-----------------------------------------------------------------------------------------
PROGRESS: 37.0%
| epoch  38 |   100/  269 batches | lr 0.00015 | ms/batch 251.81 | loss  3.61 | ppl    36.93 
| epoch  38 |   200/  269 batches | lr 0.00015 | ms/batch 232.39 | loss  3.58 | ppl    35.94 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 65.09s | valid loss  3.91 | valid ppl    50.11 | valid bpc    5.647
-----------------------------------------------------------------------------------------
PROGRESS: 38.0%
| epoch  39 |   100/  269 batches | lr 0.00007 | ms/batch 252.62 | loss  3.56 | ppl    35.09 
| epoch  39 |   200/  269 batches | lr 0.00007 | ms/batch 232.02 | loss  3.50 | ppl    32.98 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 65.56s | valid loss  3.88 | valid ppl    48.66 | valid bpc    5.605
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 39.0%
| epoch  40 |   100/  269 batches | lr 0.00007 | ms/batch 250.44 | loss  3.51 | ppl    33.61 
| epoch  40 |   200/  269 batches | lr 0.00007 | ms/batch 234.01 | loss  3.50 | ppl    33.23 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 65.36s | valid loss  3.87 | valid ppl    47.86 | valid bpc    5.581
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 40.0%
| epoch  41 |   100/  269 batches | lr 0.00007 | ms/batch 251.88 | loss  3.51 | ppl    33.38 
| epoch  41 |   200/  269 batches | lr 0.00007 | ms/batch 232.79 | loss  3.47 | ppl    32.16 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 65.48s | valid loss  3.87 | valid ppl    47.85 | valid bpc    5.580
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 41.0%
| epoch  42 |   100/  269 batches | lr 0.00007 | ms/batch 252.74 | loss  3.50 | ppl    33.20 
| epoch  42 |   200/  269 batches | lr 0.00007 | ms/batch 232.12 | loss  3.47 | ppl    31.99 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 65.49s | valid loss  3.85 | valid ppl    47.18 | valid bpc    5.560
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 42.0%
| epoch  43 |   100/  269 batches | lr 0.00007 | ms/batch 252.78 | loss  3.47 | ppl    32.00 
| epoch  43 |   200/  269 batches | lr 0.00007 | ms/batch 232.27 | loss  3.45 | ppl    31.53 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 65.55s | valid loss  3.88 | valid ppl    48.36 | valid bpc    5.596
-----------------------------------------------------------------------------------------
PROGRESS: 43.0%
| epoch  44 |   100/  269 batches | lr 0.00007 | ms/batch 251.53 | loss  3.46 | ppl    31.94 
| epoch  44 |   200/  269 batches | lr 0.00007 | ms/batch 231.74 | loss  3.43 | ppl    30.93 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 65.61s | valid loss  3.88 | valid ppl    48.31 | valid bpc    5.594
-----------------------------------------------------------------------------------------
PROGRESS: 44.0%
| epoch  45 |   100/  269 batches | lr 0.00007 | ms/batch 251.83 | loss  3.45 | ppl    31.50 
| epoch  45 |   200/  269 batches | lr 0.00007 | ms/batch 229.21 | loss  3.40 | ppl    29.95 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 65.25s | valid loss  3.83 | valid ppl    46.13 | valid bpc    5.528
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 45.0%
| epoch  46 |   100/  269 batches | lr 0.00007 | ms/batch 253.00 | loss  3.44 | ppl    31.28 
| epoch  46 |   200/  269 batches | lr 0.00007 | ms/batch 232.55 | loss  3.39 | ppl    29.64 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 65.56s | valid loss  3.83 | valid ppl    45.87 | valid bpc    5.520
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 46.0%
| epoch  47 |   100/  269 batches | lr 0.00007 | ms/batch 251.73 | loss  3.43 | ppl    31.01 
| epoch  47 |   200/  269 batches | lr 0.00007 | ms/batch 235.88 | loss  3.38 | ppl    29.40 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 65.32s | valid loss  3.84 | valid ppl    46.45 | valid bpc    5.538
-----------------------------------------------------------------------------------------
PROGRESS: 47.0%
| epoch  48 |   100/  269 batches | lr 0.00007 | ms/batch 249.89 | loss  3.41 | ppl    30.14 
| epoch  48 |   200/  269 batches | lr 0.00007 | ms/batch 237.93 | loss  3.38 | ppl    29.28 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 65.61s | valid loss  3.83 | valid ppl    46.03 | valid bpc    5.525
-----------------------------------------------------------------------------------------
PROGRESS: 48.0%
| epoch  49 |   100/  269 batches | lr 0.00007 | ms/batch 248.19 | loss  3.39 | ppl    29.63 
| epoch  49 |   200/  269 batches | lr 0.00007 | ms/batch 237.90 | loss  3.36 | ppl    28.84 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 65.53s | valid loss  3.81 | valid ppl    45.01 | valid bpc    5.492
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 49.0%
| epoch  50 |   100/  269 batches | lr 0.00007 | ms/batch 246.77 | loss  3.37 | ppl    29.15 
| epoch  50 |   200/  269 batches | lr 0.00007 | ms/batch 238.51 | loss  3.36 | ppl    28.79 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 65.46s | valid loss  3.84 | valid ppl    46.44 | valid bpc    5.537
-----------------------------------------------------------------------------------------
PROGRESS: 50.0%
| epoch  51 |   100/  269 batches | lr 0.00007 | ms/batch 246.80 | loss  3.39 | ppl    29.71 
| epoch  51 |   200/  269 batches | lr 0.00007 | ms/batch 238.32 | loss  3.34 | ppl    28.31 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 65.47s | valid loss  3.84 | valid ppl    46.74 | valid bpc    5.546
-----------------------------------------------------------------------------------------
PROGRESS: 51.0%
| epoch  52 |   100/  269 batches | lr 0.00007 | ms/batch 246.54 | loss  3.36 | ppl    28.67 
| epoch  52 |   200/  269 batches | lr 0.00007 | ms/batch 236.96 | loss  3.33 | ppl    28.05 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 65.40s | valid loss  3.86 | valid ppl    47.43 | valid bpc    5.568
-----------------------------------------------------------------------------------------
PROGRESS: 52.0%
| epoch  53 |   100/  269 batches | lr 0.00004 | ms/batch 245.47 | loss  3.32 | ppl    27.63 
| epoch  53 |   200/  269 batches | lr 0.00004 | ms/batch 237.17 | loss  3.30 | ppl    27.10 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 65.39s | valid loss  3.79 | valid ppl    44.44 | valid bpc    5.474
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 53.0%
| epoch  54 |   100/  269 batches | lr 0.00004 | ms/batch 245.44 | loss  3.32 | ppl    27.68 
| epoch  54 |   200/  269 batches | lr 0.00004 | ms/batch 237.05 | loss  3.27 | ppl    26.33 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 65.39s | valid loss  3.79 | valid ppl    44.07 | valid bpc    5.462
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 54.0%
| epoch  55 |   100/  269 batches | lr 0.00004 | ms/batch 246.80 | loss  3.33 | ppl    27.84 
| epoch  55 |   200/  269 batches | lr 0.00004 | ms/batch 237.60 | loss  3.27 | ppl    26.39 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 65.41s | valid loss  3.85 | valid ppl    46.85 | valid bpc    5.550
-----------------------------------------------------------------------------------------
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  269 batches | lr 0.00004 | ms/batch 247.85 | loss  3.31 | ppl    27.37 
| epoch  56 |   200/  269 batches | lr 0.00004 | ms/batch 237.03 | loss  3.29 | ppl    26.76 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 65.44s | valid loss  3.75 | valid ppl    42.52 | valid bpc    5.410
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  269 batches | lr 0.00004 | ms/batch 245.73 | loss  3.29 | ppl    26.91 
| epoch  57 |   200/  269 batches | lr 0.00004 | ms/batch 237.98 | loss  3.28 | ppl    26.66 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 65.42s | valid loss  3.80 | valid ppl    44.87 | valid bpc    5.488
-----------------------------------------------------------------------------------------
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  269 batches | lr 0.00004 | ms/batch 241.72 | loss  3.29 | ppl    26.73 
| epoch  58 |   200/  269 batches | lr 0.00004 | ms/batch 238.43 | loss  3.24 | ppl    25.66 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 65.14s | valid loss  3.80 | valid ppl    44.81 | valid bpc    5.486
-----------------------------------------------------------------------------------------
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  269 batches | lr 0.00004 | ms/batch 246.10 | loss  3.27 | ppl    26.39 
| epoch  59 |   200/  269 batches | lr 0.00004 | ms/batch 237.52 | loss  3.27 | ppl    26.20 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 65.40s | valid loss  3.81 | valid ppl    45.16 | valid bpc    5.497
-----------------------------------------------------------------------------------------
PROGRESS: 59.0%
| epoch  60 |   100/  269 batches | lr 0.00002 | ms/batch 246.84 | loss  3.27 | ppl    26.39 
| epoch  60 |   200/  269 batches | lr 0.00002 | ms/batch 238.51 | loss  3.23 | ppl    25.16 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 65.44s | valid loss  3.77 | valid ppl    43.56 | valid bpc    5.445
-----------------------------------------------------------------------------------------
PROGRESS: 60.0%
| epoch  61 |   100/  269 batches | lr 0.00002 | ms/batch 241.50 | loss  3.27 | ppl    26.40 
| epoch  61 |   200/  269 batches | lr 0.00002 | ms/batch 239.08 | loss  3.23 | ppl    25.28 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 65.08s | valid loss  3.79 | valid ppl    44.42 | valid bpc    5.473
-----------------------------------------------------------------------------------------
PROGRESS: 61.0%
| epoch  62 |   100/  269 batches | lr 0.00002 | ms/batch 247.01 | loss  3.25 | ppl    25.74 
| epoch  62 |   200/  269 batches | lr 0.00002 | ms/batch 237.23 | loss  3.24 | ppl    25.60 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 65.70s | valid loss  3.79 | valid ppl    44.06 | valid bpc    5.461
-----------------------------------------------------------------------------------------
PROGRESS: 62.0%
| epoch  63 |   100/  269 batches | lr 0.00001 | ms/batch 241.27 | loss  3.27 | ppl    26.39 
| epoch  63 |   200/  269 batches | lr 0.00001 | ms/batch 238.03 | loss  3.23 | ppl    25.37 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 65.42s | valid loss  3.80 | valid ppl    44.90 | valid bpc    5.489
-----------------------------------------------------------------------------------------
PROGRESS: 63.0%
| epoch  64 |   100/  269 batches | lr 0.00001 | ms/batch 241.65 | loss  3.26 | ppl    26.07 
| epoch  64 |   200/  269 batches | lr 0.00001 | ms/batch 237.11 | loss  3.22 | ppl    25.07 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 65.47s | valid loss  3.81 | valid ppl    44.93 | valid bpc    5.490
-----------------------------------------------------------------------------------------
PROGRESS: 64.0%
| epoch  65 |   100/  269 batches | lr 0.00001 | ms/batch 240.29 | loss  3.24 | ppl    25.46 
| epoch  65 |   200/  269 batches | lr 0.00001 | ms/batch 239.06 | loss  3.24 | ppl    25.53 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 65.39s | valid loss  3.83 | valid ppl    46.03 | valid bpc    5.524
-----------------------------------------------------------------------------------------
PROGRESS: 65.0%
| epoch  66 |   100/  269 batches | lr 0.00000 | ms/batch 242.12 | loss  3.26 | ppl    25.93 
| epoch  66 |   200/  269 batches | lr 0.00000 | ms/batch 236.97 | loss  3.22 | ppl    25.00 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 65.47s | valid loss  3.77 | valid ppl    43.38 | valid bpc    5.439
-----------------------------------------------------------------------------------------
PROGRESS: 66.0%
| epoch  67 |   100/  269 batches | lr 0.00000 | ms/batch 240.84 | loss  3.24 | ppl    25.42 
| epoch  67 |   200/  269 batches | lr 0.00000 | ms/batch 237.72 | loss  3.20 | ppl    24.64 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 65.41s | valid loss  3.78 | valid ppl    43.75 | valid bpc    5.451
-----------------------------------------------------------------------------------------
PROGRESS: 67.0%
| epoch  68 |   100/  269 batches | lr 0.00000 | ms/batch 239.00 | loss  3.24 | ppl    25.66 
| epoch  68 |   200/  269 batches | lr 0.00000 | ms/batch 238.89 | loss  3.22 | ppl    24.99 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 65.42s | valid loss  3.80 | valid ppl    44.89 | valid bpc    5.488
-----------------------------------------------------------------------------------------
PROGRESS: 68.0%
| epoch  69 |   100/  269 batches | lr 0.00000 | ms/batch 240.53 | loss  3.24 | ppl    25.60 
| epoch  69 |   200/  269 batches | lr 0.00000 | ms/batch 237.99 | loss  3.21 | ppl    24.75 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 65.35s | valid loss  3.80 | valid ppl    44.52 | valid bpc    5.476
-----------------------------------------------------------------------------------------
PROGRESS: 69.0%
| epoch  70 |   100/  269 batches | lr 0.00000 | ms/batch 240.11 | loss  3.21 | ppl    24.88 
| epoch  70 |   200/  269 batches | lr 0.00000 | ms/batch 237.99 | loss  3.21 | ppl    24.90 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 65.44s | valid loss  3.81 | valid ppl    45.15 | valid bpc    5.497
-----------------------------------------------------------------------------------------
PROGRESS: 70.0%
| epoch  71 |   100/  269 batches | lr 0.00000 | ms/batch 241.75 | loss  3.24 | ppl    25.48 
| epoch  71 |   200/  269 batches | lr 0.00000 | ms/batch 236.90 | loss  3.20 | ppl    24.64 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 65.45s | valid loss  3.81 | valid ppl    45.22 | valid bpc    5.499
-----------------------------------------------------------------------------------------
PROGRESS: 71.0%
| epoch  72 |   100/  269 batches | lr 0.00000 | ms/batch 239.93 | loss  3.21 | ppl    24.80 
| epoch  72 |   200/  269 batches | lr 0.00000 | ms/batch 238.33 | loss  3.23 | ppl    25.25 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 65.47s | valid loss  3.81 | valid ppl    45.08 | valid bpc    5.495
-----------------------------------------------------------------------------------------
PROGRESS: 72.0%
| epoch  73 |   100/  269 batches | lr 0.00000 | ms/batch 241.19 | loss  3.23 | ppl    25.25 
| epoch  73 |   200/  269 batches | lr 0.00000 | ms/batch 236.31 | loss  3.19 | ppl    24.25 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 65.44s | valid loss  3.76 | valid ppl    42.96 | valid bpc    5.425
-----------------------------------------------------------------------------------------
PROGRESS: 73.0%
| epoch  74 |   100/  269 batches | lr 0.00000 | ms/batch 237.08 | loss  3.26 | ppl    25.93 
| epoch  74 |   200/  269 batches | lr 0.00000 | ms/batch 237.87 | loss  3.19 | ppl    24.39 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 65.01s | valid loss  3.78 | valid ppl    44.01 | valid bpc    5.460
-----------------------------------------------------------------------------------------
PROGRESS: 74.0%
| epoch  75 |   100/  269 batches | lr 0.00000 | ms/batch 240.46 | loss  3.23 | ppl    25.17 
| epoch  75 |   200/  269 batches | lr 0.00000 | ms/batch 237.97 | loss  3.21 | ppl    24.79 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 65.40s | valid loss  3.81 | valid ppl    45.32 | valid bpc    5.502
-----------------------------------------------------------------------------------------
PROGRESS: 75.0%
| epoch  76 |   100/  269 batches | lr 0.00000 | ms/batch 237.62 | loss  3.25 | ppl    25.84 
| epoch  76 |   200/  269 batches | lr 0.00000 | ms/batch 236.92 | loss  3.22 | ppl    24.96 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 65.02s | valid loss  3.80 | valid ppl    44.78 | valid bpc    5.485
-----------------------------------------------------------------------------------------
PROGRESS: 76.0%
| epoch  77 |   100/  269 batches | lr 0.00000 | ms/batch 241.46 | loss  3.25 | ppl    25.84 
| epoch  77 |   200/  269 batches | lr 0.00000 | ms/batch 237.23 | loss  3.18 | ppl    24.04 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 65.45s | valid loss  3.81 | valid ppl    45.36 | valid bpc    5.503
-----------------------------------------------------------------------------------------
PROGRESS: 77.0%
| epoch  78 |   100/  269 batches | lr 0.00000 | ms/batch 240.97 | loss  3.23 | ppl    25.39 
| epoch  78 |   200/  269 batches | lr 0.00000 | ms/batch 237.37 | loss  3.21 | ppl    24.83 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 65.47s | valid loss  3.83 | valid ppl    46.11 | valid bpc    5.527
-----------------------------------------------------------------------------------------
PROGRESS: 78.0%
| epoch  79 |   100/  269 batches | lr 0.00000 | ms/batch 242.14 | loss  3.25 | ppl    25.68 
| epoch  79 |   200/  269 batches | lr 0.00000 | ms/batch 237.85 | loss  3.20 | ppl    24.65 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 65.54s | valid loss  3.88 | valid ppl    48.25 | valid bpc    5.593
-----------------------------------------------------------------------------------------
PROGRESS: 79.0%
| epoch  80 |   100/  269 batches | lr 0.00000 | ms/batch 246.76 | loss  3.24 | ppl    25.49 
| epoch  80 |   200/  269 batches | lr 0.00000 | ms/batch 233.19 | loss  3.22 | ppl    24.96 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 65.52s | valid loss  3.74 | valid ppl    42.30 | valid bpc    5.403
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 80.0%
| epoch  81 |   100/  269 batches | lr 0.00000 | ms/batch 245.73 | loss  3.25 | ppl    25.69 
| epoch  81 |   200/  269 batches | lr 0.00000 | ms/batch 232.45 | loss  3.21 | ppl    24.83 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 65.43s | valid loss  3.78 | valid ppl    44.03 | valid bpc    5.461
-----------------------------------------------------------------------------------------
PROGRESS: 81.0%
| epoch  82 |   100/  269 batches | lr 0.00000 | ms/batch 246.13 | loss  3.25 | ppl    25.79 
| epoch  82 |   200/  269 batches | lr 0.00000 | ms/batch 231.76 | loss  3.20 | ppl    24.49 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 65.35s | valid loss  3.81 | valid ppl    45.38 | valid bpc    5.504
-----------------------------------------------------------------------------------------
PROGRESS: 82.0%
| epoch  83 |   100/  269 batches | lr 0.00000 | ms/batch 245.70 | loss  3.25 | ppl    25.87 
| epoch  83 |   200/  269 batches | lr 0.00000 | ms/batch 233.42 | loss  3.19 | ppl    24.20 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 65.42s | valid loss  3.77 | valid ppl    43.51 | valid bpc    5.443
-----------------------------------------------------------------------------------------
PROGRESS: 83.0%
| epoch  84 |   100/  269 batches | lr 0.00000 | ms/batch 247.54 | loss  3.24 | ppl    25.51 
| epoch  84 |   200/  269 batches | lr 0.00000 | ms/batch 231.09 | loss  3.21 | ppl    24.69 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 65.44s | valid loss  3.78 | valid ppl    44.01 | valid bpc    5.460
-----------------------------------------------------------------------------------------
PROGRESS: 84.0%
| epoch  85 |   100/  269 batches | lr 0.00000 | ms/batch 245.88 | loss  3.24 | ppl    25.58 
| epoch  85 |   200/  269 batches | lr 0.00000 | ms/batch 231.34 | loss  3.21 | ppl    24.74 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 65.41s | valid loss  3.80 | valid ppl    44.49 | valid bpc    5.475
-----------------------------------------------------------------------------------------
PROGRESS: 85.0%
| epoch  86 |   100/  269 batches | lr 0.00000 | ms/batch 246.55 | loss  3.25 | ppl    25.90 
| epoch  86 |   200/  269 batches | lr 0.00000 | ms/batch 230.81 | loss  3.20 | ppl    24.43 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 65.45s | valid loss  3.75 | valid ppl    42.71 | valid bpc    5.417
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  269 batches | lr 0.00000 | ms/batch 246.29 | loss  3.24 | ppl    25.61 
| epoch  87 |   200/  269 batches | lr 0.00000 | ms/batch 231.91 | loss  3.21 | ppl    24.89 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 65.42s | valid loss  3.79 | valid ppl    44.23 | valid bpc    5.467
-----------------------------------------------------------------------------------------
PROGRESS: 87.0%
| epoch  88 |   100/  269 batches | lr 0.00000 | ms/batch 246.99 | loss  3.24 | ppl    25.42 
| epoch  88 |   200/  269 batches | lr 0.00000 | ms/batch 232.11 | loss  3.21 | ppl    24.79 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 65.48s | valid loss  3.81 | valid ppl    45.34 | valid bpc    5.503
-----------------------------------------------------------------------------------------
PROGRESS: 88.0%
| epoch  89 |   100/  269 batches | lr 0.00000 | ms/batch 246.55 | loss  3.26 | ppl    26.17 
| epoch  89 |   200/  269 batches | lr 0.00000 | ms/batch 232.56 | loss  3.19 | ppl    24.25 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 65.49s | valid loss  3.78 | valid ppl    43.84 | valid bpc    5.454
-----------------------------------------------------------------------------------------
PROGRESS: 89.0%
| epoch  90 |   100/  269 batches | lr 0.00000 | ms/batch 245.33 | loss  3.24 | ppl    25.41 
| epoch  90 |   200/  269 batches | lr 0.00000 | ms/batch 232.10 | loss  3.19 | ppl    24.38 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 65.43s | valid loss  3.82 | valid ppl    45.80 | valid bpc    5.517
-----------------------------------------------------------------------------------------
PROGRESS: 90.0%
| epoch  91 |   100/  269 batches | lr 0.00000 | ms/batch 246.67 | loss  3.22 | ppl    25.11 
| epoch  91 |   200/  269 batches | lr 0.00000 | ms/batch 232.62 | loss  3.21 | ppl    24.85 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 65.44s | valid loss  3.81 | valid ppl    45.26 | valid bpc    5.500
-----------------------------------------------------------------------------------------
PROGRESS: 91.0%
| epoch  92 |   100/  269 batches | lr 0.00000 | ms/batch 248.40 | loss  3.24 | ppl    25.41 
| epoch  92 |   200/  269 batches | lr 0.00000 | ms/batch 229.68 | loss  3.23 | ppl    25.21 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 65.39s | valid loss  3.81 | valid ppl    45.11 | valid bpc    5.495
-----------------------------------------------------------------------------------------
PROGRESS: 92.0%
| epoch  93 |   100/  269 batches | lr 0.00000 | ms/batch 250.43 | loss  3.23 | ppl    25.26 
| epoch  93 |   200/  269 batches | lr 0.00000 | ms/batch 228.17 | loss  3.20 | ppl    24.56 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 65.45s | valid loss  3.77 | valid ppl    43.58 | valid bpc    5.446
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  269 batches | lr 0.00000 | ms/batch 252.30 | loss  3.25 | ppl    25.84 
| epoch  94 |   200/  269 batches | lr 0.00000 | ms/batch 226.71 | loss  3.20 | ppl    24.42 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 65.47s | valid loss  3.81 | valid ppl    44.93 | valid bpc    5.490
-----------------------------------------------------------------------------------------
PROGRESS: 94.0%
| epoch  95 |   100/  269 batches | lr 0.00000 | ms/batch 252.25 | loss  3.24 | ppl    25.57 
| epoch  95 |   200/  269 batches | lr 0.00000 | ms/batch 226.09 | loss  3.21 | ppl    24.79 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 65.47s | valid loss  3.81 | valid ppl    45.14 | valid bpc    5.496
-----------------------------------------------------------------------------------------
PROGRESS: 95.0%
| epoch  96 |   100/  269 batches | lr 0.00000 | ms/batch 253.13 | loss  3.23 | ppl    25.30 
| epoch  96 |   200/  269 batches | lr 0.00000 | ms/batch 226.58 | loss  3.20 | ppl    24.59 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 65.15s | valid loss  3.82 | valid ppl    45.73 | valid bpc    5.515
-----------------------------------------------------------------------------------------
PROGRESS: 96.0%
| epoch  97 |   100/  269 batches | lr 0.00000 | ms/batch 252.25 | loss  3.21 | ppl    24.88 
| epoch  97 |   200/  269 batches | lr 0.00000 | ms/batch 232.59 | loss  3.22 | ppl    24.99 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 65.48s | valid loss  3.81 | valid ppl    45.24 | valid bpc    5.500
-----------------------------------------------------------------------------------------
PROGRESS: 97.0%
| epoch  98 |   100/  269 batches | lr 0.00000 | ms/batch 252.32 | loss  3.22 | ppl    25.12 
| epoch  98 |   200/  269 batches | lr 0.00000 | ms/batch 232.10 | loss  3.20 | ppl    24.63 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 62.02s | valid loss  3.79 | valid ppl    44.15 | valid bpc    5.465
-----------------------------------------------------------------------------------------
PROGRESS: 98.0%
| epoch  99 |   100/  269 batches | lr 0.00000 | ms/batch 178.26 | loss  3.24 | ppl    25.51 
| epoch  99 |   200/  269 batches | lr 0.00000 | ms/batch 163.78 | loss  3.18 | ppl    24.07 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 46.76s | valid loss  3.76 | valid ppl    43.13 | valid bpc    5.431
-----------------------------------------------------------------------------------------
PROGRESS: 99.0%
| epoch 100 |   100/  269 batches | lr 0.00000 | ms/batch 174.22 | loss  3.22 | ppl    24.96 
| epoch 100 |   200/  269 batches | lr 0.00000 | ms/batch 153.42 | loss  3.22 | ppl    24.92 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 44.45s | valid loss  3.78 | valid ppl    43.82 | valid bpc    5.454
-----------------------------------------------------------------------------------------
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  3.86 | test ppl    47.39 | test bpc    5.566
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.4758, Mean Reca: 0.6675, Mean F1: 0.5513, Mean Subword_Reca: 0.8366
-----------------------------------------------------------------------------------------
=========================================================================================
Loading dataset...
Using subword tokenizer...
Number of tokens:  8000
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer_in_parser', nhid=512, nlayers=8, front_layers=6, rear_layers=2, subword='omarmomen/ptb_filtered_lowcase_bpe_tokenizer_8', n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=1111, nonmono=5, cuda=True, log_interval=100, save='trained_models/subword_structformer_in_parser_1111_62.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 37449060
Model architecture: StructFormer_In_Parser(
  (transformer_front): Transformer_Front(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(8000, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-5): 6 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
  (transformer_rear): Transformer_Rear(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(8000, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-1): 2 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (output_layer): Linear(in_features=512, out_features=8000, bias=True)
  )
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  269 batches | lr 0.00030 | ms/batch 154.20 | loss  7.75 | ppl  2313.90 
| epoch   1 |   200/  269 batches | lr 0.00030 | ms/batch 154.24 | loss  7.35 | ppl  1563.76 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 44.84s | valid loss  7.06 | valid ppl  1166.59 | valid bpc   10.188
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  269 batches | lr 0.00030 | ms/batch 238.76 | loss  7.32 | ppl  1504.29 
| epoch   2 |   200/  269 batches | lr 0.00030 | ms/batch 231.19 | loss  7.15 | ppl  1279.03 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 63.21s | valid loss  6.89 | valid ppl   978.35 | valid bpc    9.934
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  269 batches | lr 0.00030 | ms/batch 245.12 | loss  7.01 | ppl  1110.95 
| epoch   3 |   200/  269 batches | lr 0.00030 | ms/batch 225.02 | loss  6.71 | ppl   821.05 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 63.15s | valid loss  6.20 | valid ppl   494.27 | valid bpc    8.949
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  269 batches | lr 0.00030 | ms/batch 246.81 | loss  6.37 | ppl   582.67 
| epoch   4 |   200/  269 batches | lr 0.00030 | ms/batch 222.44 | loss  6.13 | ppl   458.42 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 63.16s | valid loss  5.80 | valid ppl   328.89 | valid bpc    8.361
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  269 batches | lr 0.00030 | ms/batch 247.08 | loss  5.98 | ppl   394.51 
| epoch   5 |   200/  269 batches | lr 0.00030 | ms/batch 222.57 | loss  5.84 | ppl   344.91 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 63.50s | valid loss  5.53 | valid ppl   251.80 | valid bpc    7.976
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  269 batches | lr 0.00030 | ms/batch 245.83 | loss  5.76 | ppl   316.32 
| epoch   6 |   200/  269 batches | lr 0.00030 | ms/batch 222.53 | loss  5.61 | ppl   273.97 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 64.05s | valid loss  5.41 | valid ppl   223.24 | valid bpc    7.802
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  269 batches | lr 0.00030 | ms/batch 241.71 | loss  5.56 | ppl   259.98 
| epoch   7 |   200/  269 batches | lr 0.00030 | ms/batch 222.12 | loss  5.49 | ppl   242.81 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 63.53s | valid loss  5.25 | valid ppl   191.02 | valid bpc    7.578
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  269 batches | lr 0.00030 | ms/batch 235.80 | loss  5.42 | ppl   225.21 
| epoch   8 |   200/  269 batches | lr 0.00030 | ms/batch 224.02 | loss  5.37 | ppl   214.60 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 63.11s | valid loss  5.17 | valid ppl   176.25 | valid bpc    7.461
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 8.0%
| epoch   9 |   100/  269 batches | lr 0.00030 | ms/batch 236.82 | loss  5.28 | ppl   196.72 
| epoch   9 |   200/  269 batches | lr 0.00030 | ms/batch 223.42 | loss  5.25 | ppl   190.39 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 63.21s | valid loss  5.07 | valid ppl   159.53 | valid bpc    7.318
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  269 batches | lr 0.00030 | ms/batch 236.38 | loss  5.19 | ppl   179.79 
| epoch  10 |   200/  269 batches | lr 0.00030 | ms/batch 223.42 | loss  5.15 | ppl   172.64 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 63.20s | valid loss  4.99 | valid ppl   146.30 | valid bpc    7.193
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  269 batches | lr 0.00030 | ms/batch 237.06 | loss  5.09 | ppl   162.51 
| epoch  11 |   200/  269 batches | lr 0.00030 | ms/batch 226.24 | loss  5.02 | ppl   150.92 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 63.50s | valid loss  4.85 | valid ppl   128.36 | valid bpc    7.004
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  269 batches | lr 0.00030 | ms/batch 237.59 | loss  5.00 | ppl   149.13 
| epoch  12 |   200/  269 batches | lr 0.00030 | ms/batch 229.91 | loss  4.93 | ppl   138.69 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 63.21s | valid loss  4.77 | valid ppl   117.90 | valid bpc    6.881
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 12.0%
| epoch  13 |   100/  269 batches | lr 0.00030 | ms/batch 236.76 | loss  4.90 | ppl   134.16 
| epoch  13 |   200/  269 batches | lr 0.00030 | ms/batch 233.20 | loss  4.88 | ppl   131.33 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 63.23s | valid loss  4.73 | valid ppl   113.08 | valid bpc    6.821
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 13.0%
| epoch  14 |   100/  269 batches | lr 0.00030 | ms/batch 236.92 | loss  4.83 | ppl   125.62 
| epoch  14 |   200/  269 batches | lr 0.00030 | ms/batch 232.23 | loss  4.77 | ppl   118.04 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 63.15s | valid loss  4.61 | valid ppl   100.97 | valid bpc    6.658
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  269 batches | lr 0.00030 | ms/batch 237.88 | loss  4.76 | ppl   117.02 
| epoch  15 |   200/  269 batches | lr 0.00030 | ms/batch 231.45 | loss  4.68 | ppl   107.86 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 63.18s | valid loss  4.59 | valid ppl    98.80 | valid bpc    6.627
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 15.0%
| epoch  16 |   100/  269 batches | lr 0.00030 | ms/batch 240.47 | loss  4.66 | ppl   105.33 
| epoch  16 |   200/  269 batches | lr 0.00030 | ms/batch 232.63 | loss  4.65 | ppl   104.63 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 63.95s | valid loss  4.58 | valid ppl    97.08 | valid bpc    6.601
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 16.0%
| epoch  17 |   100/  269 batches | lr 0.00030 | ms/batch 236.88 | loss  4.60 | ppl    99.58 
| epoch  17 |   200/  269 batches | lr 0.00030 | ms/batch 232.38 | loss  4.54 | ppl    93.96 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 63.27s | valid loss  4.46 | valid ppl    86.80 | valid bpc    6.440
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 17.0%
| epoch  18 |   100/  269 batches | lr 0.00030 | ms/batch 237.08 | loss  4.53 | ppl    93.18 
| epoch  18 |   200/  269 batches | lr 0.00030 | ms/batch 232.75 | loss  4.49 | ppl    89.03 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 63.61s | valid loss  4.46 | valid ppl    86.91 | valid bpc    6.441
-----------------------------------------------------------------------------------------
PROGRESS: 18.0%
| epoch  19 |   100/  269 batches | lr 0.00030 | ms/batch 239.83 | loss  4.43 | ppl    83.74 
| epoch  19 |   200/  269 batches | lr 0.00030 | ms/batch 225.85 | loss  4.41 | ppl    82.57 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 63.73s | valid loss  4.38 | valid ppl    79.67 | valid bpc    6.316
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 19.0%
| epoch  20 |   100/  269 batches | lr 0.00030 | ms/batch 231.43 | loss  4.42 | ppl    83.06 
| epoch  20 |   200/  269 batches | lr 0.00030 | ms/batch 222.36 | loss  4.37 | ppl    78.99 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 62.61s | valid loss  4.36 | valid ppl    78.05 | valid bpc    6.286
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 20.0%
| epoch  21 |   100/  269 batches | lr 0.00030 | ms/batch 237.43 | loss  4.33 | ppl    75.95 
| epoch  21 |   200/  269 batches | lr 0.00030 | ms/batch 223.60 | loss  4.31 | ppl    74.33 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 63.18s | valid loss  4.31 | valid ppl    74.72 | valid bpc    6.223
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 21.0%
| epoch  22 |   100/  269 batches | lr 0.00030 | ms/batch 238.07 | loss  4.28 | ppl    72.32 
| epoch  22 |   200/  269 batches | lr 0.00030 | ms/batch 222.61 | loss  4.24 | ppl    69.59 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 63.16s | valid loss  4.20 | valid ppl    66.95 | valid bpc    6.065
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 22.0%
| epoch  23 |   100/  269 batches | lr 0.00030 | ms/batch 236.88 | loss  4.21 | ppl    67.61 
| epoch  23 |   200/  269 batches | lr 0.00030 | ms/batch 221.98 | loss  4.19 | ppl    66.33 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 63.06s | valid loss  4.26 | valid ppl    70.60 | valid bpc    6.142
-----------------------------------------------------------------------------------------
PROGRESS: 23.0%
| epoch  24 |   100/  269 batches | lr 0.00030 | ms/batch 241.28 | loss  4.17 | ppl    64.79 
| epoch  24 |   200/  269 batches | lr 0.00030 | ms/batch 222.13 | loss  4.13 | ppl    62.15 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 63.51s | valid loss  4.20 | valid ppl    66.68 | valid bpc    6.059
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 24.0%
| epoch  25 |   100/  269 batches | lr 0.00030 | ms/batch 237.50 | loss  4.09 | ppl    60.02 
| epoch  25 |   200/  269 batches | lr 0.00030 | ms/batch 222.72 | loss  4.07 | ppl    58.36 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 63.19s | valid loss  4.19 | valid ppl    66.17 | valid bpc    6.048
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 25.0%
| epoch  26 |   100/  269 batches | lr 0.00030 | ms/batch 238.55 | loss  4.06 | ppl    58.10 
| epoch  26 |   200/  269 batches | lr 0.00030 | ms/batch 222.27 | loss  4.04 | ppl    56.62 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 63.24s | valid loss  4.12 | valid ppl    61.29 | valid bpc    5.938
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 26.0%
| epoch  27 |   100/  269 batches | lr 0.00030 | ms/batch 238.09 | loss  4.01 | ppl    55.22 
| epoch  27 |   200/  269 batches | lr 0.00030 | ms/batch 221.43 | loss  3.98 | ppl    53.47 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 63.20s | valid loss  4.13 | valid ppl    61.90 | valid bpc    5.952
-----------------------------------------------------------------------------------------
PROGRESS: 27.0%
| epoch  28 |   100/  269 batches | lr 0.00030 | ms/batch 246.99 | loss  3.97 | ppl    52.81 
| epoch  28 |   200/  269 batches | lr 0.00030 | ms/batch 213.39 | loss  3.94 | ppl    51.16 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 63.18s | valid loss  4.12 | valid ppl    61.74 | valid bpc    5.948
-----------------------------------------------------------------------------------------
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  269 batches | lr 0.00030 | ms/batch 245.93 | loss  3.92 | ppl    50.38 
| epoch  29 |   200/  269 batches | lr 0.00030 | ms/batch 224.17 | loss  3.91 | ppl    50.09 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 63.22s | valid loss  4.07 | valid ppl    58.44 | valid bpc    5.869
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  269 batches | lr 0.00030 | ms/batch 246.24 | loss  3.87 | ppl    48.15 
| epoch  30 |   200/  269 batches | lr 0.00030 | ms/batch 222.99 | loss  3.85 | ppl    46.80 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 63.20s | valid loss  4.03 | valid ppl    56.40 | valid bpc    5.818
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 30.0%
| epoch  31 |   100/  269 batches | lr 0.00030 | ms/batch 246.54 | loss  3.85 | ppl    46.78 
| epoch  31 |   200/  269 batches | lr 0.00030 | ms/batch 225.74 | loss  3.80 | ppl    44.56 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 63.50s | valid loss  4.03 | valid ppl    56.10 | valid bpc    5.810
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 31.0%
| epoch  32 |   100/  269 batches | lr 0.00030 | ms/batch 246.45 | loss  3.80 | ppl    44.51 
| epoch  32 |   200/  269 batches | lr 0.00030 | ms/batch 221.60 | loss  3.79 | ppl    44.33 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 63.07s | valid loss  4.07 | valid ppl    58.37 | valid bpc    5.867
-----------------------------------------------------------------------------------------
PROGRESS: 32.0%
| epoch  33 |   100/  269 batches | lr 0.00030 | ms/batch 245.74 | loss  3.78 | ppl    43.93 
| epoch  33 |   200/  269 batches | lr 0.00030 | ms/batch 223.54 | loss  3.74 | ppl    41.98 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 63.64s | valid loss  3.98 | valid ppl    53.65 | valid bpc    5.746
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 33.0%
| epoch  34 |   100/  269 batches | lr 0.00030 | ms/batch 246.69 | loss  3.71 | ppl    40.95 
| epoch  34 |   200/  269 batches | lr 0.00030 | ms/batch 223.33 | loss  3.70 | ppl    40.55 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 63.61s | valid loss  4.05 | valid ppl    57.27 | valid bpc    5.840
-----------------------------------------------------------------------------------------
PROGRESS: 34.0%
| epoch  35 |   100/  269 batches | lr 0.00030 | ms/batch 245.82 | loss  3.66 | ppl    38.78 
| epoch  35 |   200/  269 batches | lr 0.00030 | ms/batch 232.24 | loss  3.68 | ppl    39.81 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 63.53s | valid loss  3.96 | valid ppl    52.65 | valid bpc    5.718
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 35.0%
| epoch  36 |   100/  269 batches | lr 0.00030 | ms/batch 245.81 | loss  3.65 | ppl    38.56 
| epoch  36 |   200/  269 batches | lr 0.00030 | ms/batch 232.22 | loss  3.64 | ppl    38.02 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 63.55s | valid loss  3.99 | valid ppl    53.92 | valid bpc    5.753
-----------------------------------------------------------------------------------------
PROGRESS: 36.0%
| epoch  37 |   100/  269 batches | lr 0.00030 | ms/batch 246.56 | loss  3.60 | ppl    36.47 
| epoch  37 |   200/  269 batches | lr 0.00030 | ms/batch 232.69 | loss  3.61 | ppl    37.13 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 64.50s | valid loss  3.97 | valid ppl    53.04 | valid bpc    5.729
-----------------------------------------------------------------------------------------
PROGRESS: 37.0%
| epoch  38 |   100/  269 batches | lr 0.00030 | ms/batch 233.57 | loss  3.57 | ppl    35.49 
| epoch  38 |   200/  269 batches | lr 0.00030 | ms/batch 232.83 | loss  3.58 | ppl    35.82 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 63.24s | valid loss  3.94 | valid ppl    51.27 | valid bpc    5.680
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 38.0%
| epoch  39 |   100/  269 batches | lr 0.00030 | ms/batch 240.12 | loss  3.52 | ppl    33.78 
| epoch  39 |   200/  269 batches | lr 0.00030 | ms/batch 233.08 | loss  3.55 | ppl    34.71 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 63.53s | valid loss  3.93 | valid ppl    50.86 | valid bpc    5.668
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 39.0%
| epoch  40 |   100/  269 batches | lr 0.00030 | ms/batch 241.05 | loss  3.53 | ppl    33.97 
| epoch  40 |   200/  269 batches | lr 0.00030 | ms/batch 231.86 | loss  3.51 | ppl    33.34 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 63.88s | valid loss  3.90 | valid ppl    49.33 | valid bpc    5.624
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 40.0%
| epoch  41 |   100/  269 batches | lr 0.00030 | ms/batch 238.06 | loss  3.51 | ppl    33.39 
| epoch  41 |   200/  269 batches | lr 0.00030 | ms/batch 231.19 | loss  3.48 | ppl    32.51 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 63.53s | valid loss  3.93 | valid ppl    51.01 | valid bpc    5.673
-----------------------------------------------------------------------------------------
PROGRESS: 41.0%
| epoch  42 |   100/  269 batches | lr 0.00030 | ms/batch 235.62 | loss  3.44 | ppl    31.27 
| epoch  42 |   200/  269 batches | lr 0.00030 | ms/batch 231.63 | loss  3.42 | ppl    30.71 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 64.01s | valid loss  3.86 | valid ppl    47.61 | valid bpc    5.573
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 42.0%
| epoch  43 |   100/  269 batches | lr 0.00030 | ms/batch 231.64 | loss  3.42 | ppl    30.52 
| epoch  43 |   200/  269 batches | lr 0.00030 | ms/batch 231.95 | loss  3.44 | ppl    31.24 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 63.49s | valid loss  3.93 | valid ppl    50.87 | valid bpc    5.669
-----------------------------------------------------------------------------------------
PROGRESS: 43.0%
| epoch  44 |   100/  269 batches | lr 0.00030 | ms/batch 233.91 | loss  3.39 | ppl    29.81 
| epoch  44 |   200/  269 batches | lr 0.00030 | ms/batch 232.19 | loss  3.40 | ppl    29.98 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 63.87s | valid loss  3.90 | valid ppl    49.37 | valid bpc    5.625
-----------------------------------------------------------------------------------------
PROGRESS: 44.0%
| epoch  45 |   100/  269 batches | lr 0.00030 | ms/batch 230.96 | loss  3.39 | ppl    29.64 
| epoch  45 |   200/  269 batches | lr 0.00030 | ms/batch 231.87 | loss  3.35 | ppl    28.42 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 63.51s | valid loss  3.93 | valid ppl    50.66 | valid bpc    5.663
-----------------------------------------------------------------------------------------
PROGRESS: 45.0%
| epoch  46 |   100/  269 batches | lr 0.00015 | ms/batch 234.46 | loss  3.30 | ppl    27.12 
| epoch  46 |   200/  269 batches | lr 0.00015 | ms/batch 232.66 | loss  3.26 | ppl    26.02 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 63.88s | valid loss  3.83 | valid ppl    46.09 | valid bpc    5.526
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 46.0%
| epoch  47 |   100/  269 batches | lr 0.00015 | ms/batch 227.81 | loss  3.23 | ppl    25.31 
| epoch  47 |   200/  269 batches | lr 0.00015 | ms/batch 231.49 | loss  3.22 | ppl    25.04 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 63.25s | valid loss  3.83 | valid ppl    45.95 | valid bpc    5.522
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 47.0%
| epoch  48 |   100/  269 batches | lr 0.00015 | ms/batch 235.42 | loss  3.23 | ppl    25.27 
| epoch  48 |   200/  269 batches | lr 0.00015 | ms/batch 231.54 | loss  3.18 | ppl    23.96 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 63.90s | valid loss  3.84 | valid ppl    46.75 | valid bpc    5.547
-----------------------------------------------------------------------------------------
PROGRESS: 48.0%
| epoch  49 |   100/  269 batches | lr 0.00015 | ms/batch 235.19 | loss  3.17 | ppl    23.73 
| epoch  49 |   200/  269 batches | lr 0.00015 | ms/batch 231.91 | loss  3.18 | ppl    24.02 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 63.86s | valid loss  3.79 | valid ppl    44.39 | valid bpc    5.472
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 49.0%
| epoch  50 |   100/  269 batches | lr 0.00015 | ms/batch 234.90 | loss  3.17 | ppl    23.83 
| epoch  50 |   200/  269 batches | lr 0.00015 | ms/batch 232.39 | loss  3.16 | ppl    23.54 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 63.93s | valid loss  3.85 | valid ppl    47.16 | valid bpc    5.560
-----------------------------------------------------------------------------------------
PROGRESS: 50.0%
| epoch  51 |   100/  269 batches | lr 0.00015 | ms/batch 239.71 | loss  3.13 | ppl    22.85 
| epoch  51 |   200/  269 batches | lr 0.00015 | ms/batch 227.73 | loss  3.13 | ppl    22.78 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 63.89s | valid loss  3.84 | valid ppl    46.62 | valid bpc    5.543
-----------------------------------------------------------------------------------------
PROGRESS: 51.0%
| epoch  52 |   100/  269 batches | lr 0.00015 | ms/batch 246.71 | loss  3.09 | ppl    22.07 
| epoch  52 |   200/  269 batches | lr 0.00015 | ms/batch 219.69 | loss  3.12 | ppl    22.73 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 63.91s | valid loss  3.84 | valid ppl    46.50 | valid bpc    5.539
-----------------------------------------------------------------------------------------
PROGRESS: 52.0%
| epoch  53 |   100/  269 batches | lr 0.00007 | ms/batch 248.47 | loss  3.08 | ppl    21.84 
| epoch  53 |   200/  269 batches | lr 0.00007 | ms/batch 214.18 | loss  3.05 | ppl    21.02 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 63.42s | valid loss  3.77 | valid ppl    43.43 | valid bpc    5.441
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 53.0%
| epoch  54 |   100/  269 batches | lr 0.00007 | ms/batch 246.43 | loss  3.06 | ppl    21.24 
| epoch  54 |   200/  269 batches | lr 0.00007 | ms/batch 218.13 | loss  3.03 | ppl    20.68 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 63.57s | valid loss  3.81 | valid ppl    45.19 | valid bpc    5.498
-----------------------------------------------------------------------------------------
PROGRESS: 54.0%
| epoch  55 |   100/  269 batches | lr 0.00007 | ms/batch 247.08 | loss  3.04 | ppl    20.83 
| epoch  55 |   200/  269 batches | lr 0.00007 | ms/batch 215.20 | loss  3.01 | ppl    20.32 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 63.41s | valid loss  3.81 | valid ppl    45.33 | valid bpc    5.502
-----------------------------------------------------------------------------------------
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  269 batches | lr 0.00007 | ms/batch 247.65 | loss  3.04 | ppl    20.89 
| epoch  56 |   200/  269 batches | lr 0.00007 | ms/batch 220.10 | loss  3.03 | ppl    20.66 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 63.94s | valid loss  3.82 | valid ppl    45.40 | valid bpc    5.505
-----------------------------------------------------------------------------------------
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  269 batches | lr 0.00004 | ms/batch 246.30 | loss  3.01 | ppl    20.30 
| epoch  57 |   200/  269 batches | lr 0.00004 | ms/batch 219.74 | loss  2.97 | ppl    19.47 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 63.88s | valid loss  3.78 | valid ppl    43.85 | valid bpc    5.455
-----------------------------------------------------------------------------------------
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  269 batches | lr 0.00004 | ms/batch 245.90 | loss  2.98 | ppl    19.67 
| epoch  58 |   200/  269 batches | lr 0.00004 | ms/batch 221.02 | loss  2.97 | ppl    19.42 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 63.93s | valid loss  3.78 | valid ppl    43.75 | valid bpc    5.451
-----------------------------------------------------------------------------------------
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  269 batches | lr 0.00004 | ms/batch 247.37 | loss  2.99 | ppl    19.96 
| epoch  59 |   200/  269 batches | lr 0.00004 | ms/batch 223.19 | loss  2.96 | ppl    19.29 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 63.92s | valid loss  3.83 | valid ppl    46.20 | valid bpc    5.530
-----------------------------------------------------------------------------------------
PROGRESS: 59.0%
| epoch  60 |   100/  269 batches | lr 0.00002 | ms/batch 246.34 | loss  2.98 | ppl    19.69 
| epoch  60 |   200/  269 batches | lr 0.00002 | ms/batch 226.11 | loss  2.95 | ppl    19.09 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 63.89s | valid loss  3.78 | valid ppl    43.80 | valid bpc    5.453
-----------------------------------------------------------------------------------------
PROGRESS: 60.0%
| epoch  61 |   100/  269 batches | lr 0.00002 | ms/batch 246.99 | loss  2.97 | ppl    19.49 
| epoch  61 |   200/  269 batches | lr 0.00002 | ms/batch 225.21 | loss  2.93 | ppl    18.80 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 63.92s | valid loss  3.77 | valid ppl    43.53 | valid bpc    5.444
-----------------------------------------------------------------------------------------
PROGRESS: 61.0%
| epoch  62 |   100/  269 batches | lr 0.00002 | ms/batch 245.64 | loss  2.94 | ppl    18.99 
| epoch  62 |   200/  269 batches | lr 0.00002 | ms/batch 232.09 | loss  2.92 | ppl    18.54 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 63.88s | valid loss  3.78 | valid ppl    43.67 | valid bpc    5.449
-----------------------------------------------------------------------------------------
PROGRESS: 62.0%
| epoch  63 |   100/  269 batches | lr 0.00001 | ms/batch 246.83 | loss  2.95 | ppl    19.08 
| epoch  63 |   200/  269 batches | lr 0.00001 | ms/batch 231.58 | loss  2.92 | ppl    18.59 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 63.90s | valid loss  3.76 | valid ppl    42.90 | valid bpc    5.423
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 63.0%
| epoch  64 |   100/  269 batches | lr 0.00001 | ms/batch 246.50 | loss  2.98 | ppl    19.71 
| epoch  64 |   200/  269 batches | lr 0.00001 | ms/batch 233.01 | loss  2.91 | ppl    18.42 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 63.88s | valid loss  3.82 | valid ppl    45.73 | valid bpc    5.515
-----------------------------------------------------------------------------------------
PROGRESS: 64.0%
| epoch  65 |   100/  269 batches | lr 0.00001 | ms/batch 246.31 | loss  2.95 | ppl    19.10 
| epoch  65 |   200/  269 batches | lr 0.00001 | ms/batch 231.93 | loss  2.90 | ppl    18.18 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 63.59s | valid loss  3.75 | valid ppl    42.45 | valid bpc    5.408
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 65.0%
| epoch  66 |   100/  269 batches | lr 0.00001 | ms/batch 247.40 | loss  2.93 | ppl    18.79 
| epoch  66 |   200/  269 batches | lr 0.00001 | ms/batch 231.49 | loss  2.95 | ppl    19.09 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 64.08s | valid loss  3.76 | valid ppl    43.05 | valid bpc    5.428
-----------------------------------------------------------------------------------------
PROGRESS: 66.0%
| epoch  67 |   100/  269 batches | lr 0.00001 | ms/batch 241.04 | loss  2.95 | ppl    19.11 
| epoch  67 |   200/  269 batches | lr 0.00001 | ms/batch 232.18 | loss  2.91 | ppl    18.42 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 63.88s | valid loss  3.76 | valid ppl    42.92 | valid bpc    5.424
-----------------------------------------------------------------------------------------
PROGRESS: 67.0%
| epoch  68 |   100/  269 batches | lr 0.00001 | ms/batch 239.89 | loss  2.93 | ppl    18.77 
| epoch  68 |   200/  269 batches | lr 0.00001 | ms/batch 232.13 | loss  2.92 | ppl    18.54 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 63.91s | valid loss  3.81 | valid ppl    45.36 | valid bpc    5.503
-----------------------------------------------------------------------------------------
PROGRESS: 68.0%
| epoch  69 |   100/  269 batches | lr 0.00000 | ms/batch 241.76 | loss  2.93 | ppl    18.75 
| epoch  69 |   200/  269 batches | lr 0.00000 | ms/batch 231.70 | loss  2.92 | ppl    18.52 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 63.90s | valid loss  3.84 | valid ppl    46.72 | valid bpc    5.546
-----------------------------------------------------------------------------------------
PROGRESS: 69.0%
| epoch  70 |   100/  269 batches | lr 0.00000 | ms/batch 237.34 | loss  2.91 | ppl    18.44 
| epoch  70 |   200/  269 batches | lr 0.00000 | ms/batch 232.26 | loss  2.89 | ppl    18.05 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 63.88s | valid loss  3.76 | valid ppl    42.95 | valid bpc    5.425
-----------------------------------------------------------------------------------------
PROGRESS: 70.0%
| epoch  71 |   100/  269 batches | lr 0.00000 | ms/batch 231.52 | loss  2.92 | ppl    18.55 
| epoch  71 |   200/  269 batches | lr 0.00000 | ms/batch 233.44 | loss  2.92 | ppl    18.48 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 63.68s | valid loss  3.76 | valid ppl    43.10 | valid bpc    5.430
-----------------------------------------------------------------------------------------
PROGRESS: 71.0%
| epoch  72 |   100/  269 batches | lr 0.00000 | ms/batch 236.01 | loss  2.93 | ppl    18.76 
| epoch  72 |   200/  269 batches | lr 0.00000 | ms/batch 231.52 | loss  2.91 | ppl    18.30 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 63.90s | valid loss  3.77 | valid ppl    43.43 | valid bpc    5.441
-----------------------------------------------------------------------------------------
PROGRESS: 72.0%
| epoch  73 |   100/  269 batches | lr 0.00000 | ms/batch 235.07 | loss  2.92 | ppl    18.62 
| epoch  73 |   200/  269 batches | lr 0.00000 | ms/batch 232.12 | loss  2.91 | ppl    18.41 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 63.85s | valid loss  3.76 | valid ppl    43.12 | valid bpc    5.430
-----------------------------------------------------------------------------------------
PROGRESS: 73.0%
| epoch  74 |   100/  269 batches | lr 0.00000 | ms/batch 234.10 | loss  2.93 | ppl    18.73 
| epoch  74 |   200/  269 batches | lr 0.00000 | ms/batch 232.03 | loss  2.92 | ppl    18.53 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 63.89s | valid loss  3.77 | valid ppl    43.42 | valid bpc    5.440
-----------------------------------------------------------------------------------------
PROGRESS: 74.0%
| epoch  75 |   100/  269 batches | lr 0.00000 | ms/batch 239.11 | loss  2.93 | ppl    18.65 
| epoch  75 |   200/  269 batches | lr 0.00000 | ms/batch 228.54 | loss  2.90 | ppl    18.14 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 63.89s | valid loss  3.82 | valid ppl    45.71 | valid bpc    5.514
-----------------------------------------------------------------------------------------
PROGRESS: 75.0%
| epoch  76 |   100/  269 batches | lr 0.00000 | ms/batch 240.60 | loss  2.92 | ppl    18.60 
| epoch  76 |   200/  269 batches | lr 0.00000 | ms/batch 226.20 | loss  2.90 | ppl    18.24 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 63.87s | valid loss  3.76 | valid ppl    42.98 | valid bpc    5.426
-----------------------------------------------------------------------------------------
PROGRESS: 76.0%
| epoch  77 |   100/  269 batches | lr 0.00000 | ms/batch 239.71 | loss  2.94 | ppl    18.94 
| epoch  77 |   200/  269 batches | lr 0.00000 | ms/batch 227.70 | loss  2.89 | ppl    18.03 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 63.88s | valid loss  3.85 | valid ppl    46.80 | valid bpc    5.548
-----------------------------------------------------------------------------------------
PROGRESS: 77.0%
| epoch  78 |   100/  269 batches | lr 0.00000 | ms/batch 240.69 | loss  2.91 | ppl    18.44 
| epoch  78 |   200/  269 batches | lr 0.00000 | ms/batch 226.21 | loss  2.89 | ppl    17.95 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 63.91s | valid loss  3.77 | valid ppl    43.24 | valid bpc    5.434
-----------------------------------------------------------------------------------------
PROGRESS: 78.0%
| epoch  79 |   100/  269 batches | lr 0.00000 | ms/batch 239.70 | loss  2.94 | ppl    18.94 
| epoch  79 |   200/  269 batches | lr 0.00000 | ms/batch 227.33 | loss  2.89 | ppl    18.01 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 63.87s | valid loss  3.82 | valid ppl    45.56 | valid bpc    5.510
-----------------------------------------------------------------------------------------
PROGRESS: 79.0%
| epoch  80 |   100/  269 batches | lr 0.00000 | ms/batch 240.01 | loss  2.92 | ppl    18.53 
| epoch  80 |   200/  269 batches | lr 0.00000 | ms/batch 225.92 | loss  2.90 | ppl    18.17 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 63.88s | valid loss  3.80 | valid ppl    44.84 | valid bpc    5.487
-----------------------------------------------------------------------------------------
PROGRESS: 80.0%
| epoch  81 |   100/  269 batches | lr 0.00000 | ms/batch 241.21 | loss  2.94 | ppl    18.95 
| epoch  81 |   200/  269 batches | lr 0.00000 | ms/batch 225.95 | loss  2.89 | ppl    18.01 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 63.85s | valid loss  3.75 | valid ppl    42.54 | valid bpc    5.411
-----------------------------------------------------------------------------------------
PROGRESS: 81.0%
| epoch  82 |   100/  269 batches | lr 0.00000 | ms/batch 241.00 | loss  2.95 | ppl    19.02 
| epoch  82 |   200/  269 batches | lr 0.00000 | ms/batch 226.90 | loss  2.90 | ppl    18.10 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 63.91s | valid loss  3.75 | valid ppl    42.39 | valid bpc    5.406
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 82.0%
| epoch  83 |   100/  269 batches | lr 0.00000 | ms/batch 244.50 | loss  2.93 | ppl    18.68 
| epoch  83 |   200/  269 batches | lr 0.00000 | ms/batch 222.74 | loss  2.89 | ppl    17.95 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 63.87s | valid loss  3.78 | valid ppl    44.00 | valid bpc    5.460
-----------------------------------------------------------------------------------------
PROGRESS: 83.0%
| epoch  84 |   100/  269 batches | lr 0.00000 | ms/batch 246.52 | loss  2.92 | ppl    18.54 
| epoch  84 |   200/  269 batches | lr 0.00000 | ms/batch 226.22 | loss  2.90 | ppl    18.21 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 63.89s | valid loss  3.78 | valid ppl    43.86 | valid bpc    5.455
-----------------------------------------------------------------------------------------
PROGRESS: 84.0%
| epoch  85 |   100/  269 batches | lr 0.00000 | ms/batch 245.45 | loss  2.94 | ppl    18.97 
| epoch  85 |   200/  269 batches | lr 0.00000 | ms/batch 226.12 | loss  2.86 | ppl    17.51 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 63.92s | valid loss  3.76 | valid ppl    43.11 | valid bpc    5.430
-----------------------------------------------------------------------------------------
PROGRESS: 85.0%
| epoch  86 |   100/  269 batches | lr 0.00000 | ms/batch 246.82 | loss  2.92 | ppl    18.53 
| epoch  86 |   200/  269 batches | lr 0.00000 | ms/batch 225.96 | loss  2.89 | ppl    17.94 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 63.85s | valid loss  3.79 | valid ppl    44.41 | valid bpc    5.473
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  269 batches | lr 0.00000 | ms/batch 245.91 | loss  2.93 | ppl    18.76 
| epoch  87 |   200/  269 batches | lr 0.00000 | ms/batch 226.43 | loss  2.90 | ppl    18.16 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 63.85s | valid loss  3.74 | valid ppl    41.91 | valid bpc    5.389
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 87.0%
| epoch  88 |   100/  269 batches | lr 0.00000 | ms/batch 246.00 | loss  2.91 | ppl    18.36 
| epoch  88 |   200/  269 batches | lr 0.00000 | ms/batch 226.59 | loss  2.90 | ppl    18.09 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 63.86s | valid loss  3.74 | valid ppl    42.06 | valid bpc    5.394
-----------------------------------------------------------------------------------------
PROGRESS: 88.0%
| epoch  89 |   100/  269 batches | lr 0.00000 | ms/batch 246.15 | loss  2.92 | ppl    18.63 
| epoch  89 |   200/  269 batches | lr 0.00000 | ms/batch 226.65 | loss  2.90 | ppl    18.18 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 63.85s | valid loss  3.77 | valid ppl    43.54 | valid bpc    5.444
-----------------------------------------------------------------------------------------
PROGRESS: 89.0%
| epoch  90 |   100/  269 batches | lr 0.00000 | ms/batch 246.34 | loss  2.91 | ppl    18.35 
| epoch  90 |   200/  269 batches | lr 0.00000 | ms/batch 226.85 | loss  2.90 | ppl    18.10 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 64.45s | valid loss  3.81 | valid ppl    45.01 | valid bpc    5.492
-----------------------------------------------------------------------------------------
PROGRESS: 90.0%
| epoch  91 |   100/  269 batches | lr 0.00000 | ms/batch 240.27 | loss  2.95 | ppl    19.05 
| epoch  91 |   200/  269 batches | lr 0.00000 | ms/batch 225.67 | loss  2.91 | ppl    18.33 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 63.85s | valid loss  3.82 | valid ppl    45.58 | valid bpc    5.510
-----------------------------------------------------------------------------------------
PROGRESS: 91.0%
| epoch  92 |   100/  269 batches | lr 0.00000 | ms/batch 240.71 | loss  2.94 | ppl    18.94 
| epoch  92 |   200/  269 batches | lr 0.00000 | ms/batch 226.93 | loss  2.91 | ppl    18.40 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 63.89s | valid loss  3.73 | valid ppl    41.78 | valid bpc    5.385
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 92.0%
| epoch  93 |   100/  269 batches | lr 0.00000 | ms/batch 240.91 | loss  2.95 | ppl    19.04 
| epoch  93 |   200/  269 batches | lr 0.00000 | ms/batch 226.26 | loss  2.88 | ppl    17.90 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 63.89s | valid loss  3.80 | valid ppl    44.49 | valid bpc    5.475
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  269 batches | lr 0.00000 | ms/batch 240.45 | loss  2.93 | ppl    18.74 
| epoch  94 |   200/  269 batches | lr 0.00000 | ms/batch 226.83 | loss  2.90 | ppl    18.25 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 63.89s | valid loss  3.79 | valid ppl    44.25 | valid bpc    5.468
-----------------------------------------------------------------------------------------
PROGRESS: 94.0%
| epoch  95 |   100/  269 batches | lr 0.00000 | ms/batch 241.50 | loss  2.93 | ppl    18.74 
| epoch  95 |   200/  269 batches | lr 0.00000 | ms/batch 228.71 | loss  2.88 | ppl    17.81 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 63.89s | valid loss  3.73 | valid ppl    41.85 | valid bpc    5.387
-----------------------------------------------------------------------------------------
PROGRESS: 95.0%
| epoch  96 |   100/  269 batches | lr 0.00000 | ms/batch 241.65 | loss  2.93 | ppl    18.70 
| epoch  96 |   200/  269 batches | lr 0.00000 | ms/batch 230.80 | loss  2.90 | ppl    18.16 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 63.87s | valid loss  3.79 | valid ppl    44.17 | valid bpc    5.465
-----------------------------------------------------------------------------------------
PROGRESS: 96.0%
| epoch  97 |   100/  269 batches | lr 0.00000 | ms/batch 240.09 | loss  2.94 | ppl    18.95 
| epoch  97 |   200/  269 batches | lr 0.00000 | ms/batch 232.85 | loss  2.90 | ppl    18.18 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 63.90s | valid loss  3.77 | valid ppl    43.49 | valid bpc    5.442
-----------------------------------------------------------------------------------------
PROGRESS: 97.0%
| epoch  98 |   100/  269 batches | lr 0.00000 | ms/batch 240.49 | loss  2.93 | ppl    18.82 
| epoch  98 |   200/  269 batches | lr 0.00000 | ms/batch 232.09 | loss  2.89 | ppl    17.91 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 63.89s | valid loss  3.82 | valid ppl    45.56 | valid bpc    5.510
-----------------------------------------------------------------------------------------
PROGRESS: 98.0%
| epoch  99 |   100/  269 batches | lr 0.00000 | ms/batch 240.12 | loss  2.91 | ppl    18.39 
| epoch  99 |   200/  269 batches | lr 0.00000 | ms/batch 233.10 | loss  2.89 | ppl    18.06 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 63.92s | valid loss  3.76 | valid ppl    43.06 | valid bpc    5.428
-----------------------------------------------------------------------------------------
PROGRESS: 99.0%
| epoch 100 |   100/  269 batches | lr 0.00000 | ms/batch 246.84 | loss  2.93 | ppl    18.70 
| epoch 100 |   200/  269 batches | lr 0.00000 | ms/batch 227.12 | loss  2.88 | ppl    17.81 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 63.95s | valid loss  3.78 | valid ppl    43.89 | valid bpc    5.456
-----------------------------------------------------------------------------------------
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  3.84 | test ppl    46.69 | test bpc    5.545
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.4650, Mean Reca: 0.6546, Mean F1: 0.5393, Mean Subword_Reca: 0.8676
-----------------------------------------------------------------------------------------
=========================================================================================
Loading dataset...
Using subword tokenizer...
Number of tokens:  8000
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer_in_parser', nhid=512, nlayers=8, front_layers=6, rear_layers=2, subword='omarmomen/ptb_filtered_lowcase_bpe_tokenizer_8', n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=2222, nonmono=5, cuda=True, log_interval=100, save='trained_models/subword_structformer_in_parser_2222_62.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 37449060
Model architecture: StructFormer_In_Parser(
  (transformer_front): Transformer_Front(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(8000, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-5): 6 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
  (transformer_rear): Transformer_Rear(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(8000, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-1): 2 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (output_layer): Linear(in_features=512, out_features=8000, bias=True)
  )
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  269 batches | lr 0.00030 | ms/batch 168.89 | loss  7.73 | ppl  2265.65 
| epoch   1 |   200/  269 batches | lr 0.00030 | ms/batch 154.77 | loss  7.36 | ppl  1572.48 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 41.43s | valid loss  7.10 | valid ppl  1215.08 | valid bpc   10.247
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  269 batches | lr 0.00030 | ms/batch 173.68 | loss  7.29 | ppl  1466.46 
| epoch   2 |   200/  269 batches | lr 0.00030 | ms/batch 166.31 | loss  7.15 | ppl  1276.99 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 45.08s | valid loss  6.81 | valid ppl   909.34 | valid bpc    9.829
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  269 batches | lr 0.00030 | ms/batch 167.91 | loss  6.89 | ppl   986.15 
| epoch   3 |   200/  269 batches | lr 0.00030 | ms/batch 154.62 | loss  6.57 | ppl   716.50 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 42.40s | valid loss  6.10 | valid ppl   445.52 | valid bpc    8.799
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  269 batches | lr 0.00030 | ms/batch 207.09 | loss  6.25 | ppl   515.49 
| epoch   4 |   200/  269 batches | lr 0.00030 | ms/batch 231.41 | loss  6.05 | ppl   424.64 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 60.67s | valid loss  5.71 | valid ppl   301.76 | valid bpc    8.237
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  269 batches | lr 0.00030 | ms/batch 237.61 | loss  5.91 | ppl   366.94 
| epoch   5 |   200/  269 batches | lr 0.00030 | ms/batch 231.55 | loss  5.76 | ppl   318.74 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 64.09s | valid loss  5.52 | valid ppl   249.86 | valid bpc    7.965
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  269 batches | lr 0.00030 | ms/batch 225.72 | loss  5.71 | ppl   302.98 
| epoch   6 |   200/  269 batches | lr 0.00030 | ms/batch 232.54 | loss  5.59 | ppl   268.26 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 62.95s | valid loss  5.35 | valid ppl   209.72 | valid bpc    7.712
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  269 batches | lr 0.00030 | ms/batch 228.32 | loss  5.54 | ppl   255.50 
| epoch   7 |   200/  269 batches | lr 0.00030 | ms/batch 232.09 | loss  5.43 | ppl   227.11 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 63.15s | valid loss  5.22 | valid ppl   184.34 | valid bpc    7.526
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  269 batches | lr 0.00030 | ms/batch 227.19 | loss  5.40 | ppl   221.69 
| epoch   8 |   200/  269 batches | lr 0.00030 | ms/batch 231.58 | loss  5.29 | ppl   197.45 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 63.12s | valid loss  5.09 | valid ppl   162.36 | valid bpc    7.343
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 8.0%
| epoch   9 |   100/  269 batches | lr 0.00030 | ms/batch 226.69 | loss  5.25 | ppl   190.61 
| epoch   9 |   200/  269 batches | lr 0.00030 | ms/batch 232.58 | loss  5.22 | ppl   184.11 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 63.16s | valid loss  5.02 | valid ppl   150.67 | valid bpc    7.235
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  269 batches | lr 0.00030 | ms/batch 228.10 | loss  5.17 | ppl   176.10 
| epoch  10 |   200/  269 batches | lr 0.00030 | ms/batch 231.61 | loss  5.09 | ppl   161.94 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 63.19s | valid loss  4.91 | valid ppl   135.70 | valid bpc    7.084
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  269 batches | lr 0.00030 | ms/batch 229.67 | loss  5.04 | ppl   154.53 
| epoch  11 |   200/  269 batches | lr 0.00030 | ms/batch 230.48 | loss  5.00 | ppl   148.85 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 63.23s | valid loss  4.83 | valid ppl   124.85 | valid bpc    6.964
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  269 batches | lr 0.00030 | ms/batch 237.87 | loss  4.96 | ppl   142.50 
| epoch  12 |   200/  269 batches | lr 0.00030 | ms/batch 223.04 | loss  4.92 | ppl   137.01 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 63.20s | valid loss  4.80 | valid ppl   120.93 | valid bpc    6.918
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 12.0%
| epoch  13 |   100/  269 batches | lr 0.00030 | ms/batch 236.32 | loss  4.86 | ppl   128.60 
| epoch  13 |   200/  269 batches | lr 0.00030 | ms/batch 224.16 | loss  4.84 | ppl   126.12 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 63.28s | valid loss  4.66 | valid ppl   105.94 | valid bpc    6.727
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 13.0%
| epoch  14 |   100/  269 batches | lr 0.00030 | ms/batch 241.67 | loss  4.77 | ppl   118.12 
| epoch  14 |   200/  269 batches | lr 0.00030 | ms/batch 219.30 | loss  4.73 | ppl   113.47 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 63.19s | valid loss  4.60 | valid ppl    99.45 | valid bpc    6.636
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  269 batches | lr 0.00030 | ms/batch 246.88 | loss  4.72 | ppl   112.12 
| epoch  15 |   200/  269 batches | lr 0.00030 | ms/batch 213.20 | loss  4.64 | ppl   103.28 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 63.19s | valid loss  4.54 | valid ppl    93.32 | valid bpc    6.544
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 15.0%
| epoch  16 |   100/  269 batches | lr 0.00030 | ms/batch 246.26 | loss  4.64 | ppl   103.71 
| epoch  16 |   200/  269 batches | lr 0.00030 | ms/batch 214.15 | loss  4.58 | ppl    97.75 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 63.23s | valid loss  4.48 | valid ppl    87.89 | valid bpc    6.458
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 16.0%
| epoch  17 |   100/  269 batches | lr 0.00030 | ms/batch 246.11 | loss  4.54 | ppl    94.06 
| epoch  17 |   200/  269 batches | lr 0.00030 | ms/batch 213.93 | loss  4.52 | ppl    91.61 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 63.20s | valid loss  4.49 | valid ppl    89.01 | valid bpc    6.476
-----------------------------------------------------------------------------------------
PROGRESS: 17.0%
| epoch  18 |   100/  269 batches | lr 0.00030 | ms/batch 246.85 | loss  4.48 | ppl    88.58 
| epoch  18 |   200/  269 batches | lr 0.00030 | ms/batch 217.34 | loss  4.46 | ppl    86.52 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 63.56s | valid loss  4.39 | valid ppl    80.48 | valid bpc    6.331
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 18.0%
| epoch  19 |   100/  269 batches | lr 0.00030 | ms/batch 246.95 | loss  4.43 | ppl    84.08 
| epoch  19 |   200/  269 batches | lr 0.00030 | ms/batch 213.58 | loss  4.37 | ppl    79.06 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 63.27s | valid loss  4.38 | valid ppl    79.99 | valid bpc    6.322
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 19.0%
| epoch  20 |   100/  269 batches | lr 0.00030 | ms/batch 246.08 | loss  4.38 | ppl    79.45 
| epoch  20 |   200/  269 batches | lr 0.00030 | ms/batch 212.62 | loss  4.32 | ppl    75.30 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 63.11s | valid loss  4.33 | valid ppl    75.79 | valid bpc    6.244
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 20.0%
| epoch  21 |   100/  269 batches | lr 0.00030 | ms/batch 246.08 | loss  4.29 | ppl    73.21 
| epoch  21 |   200/  269 batches | lr 0.00030 | ms/batch 213.68 | loss  4.27 | ppl    71.42 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 63.16s | valid loss  4.25 | valid ppl    69.84 | valid bpc    6.126
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 21.0%
| epoch  22 |   100/  269 batches | lr 0.00030 | ms/batch 246.21 | loss  4.23 | ppl    68.40 
| epoch  22 |   200/  269 batches | lr 0.00030 | ms/batch 222.63 | loss  4.20 | ppl    66.89 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 63.87s | valid loss  4.21 | valid ppl    67.35 | valid bpc    6.074
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 22.0%
| epoch  23 |   100/  269 batches | lr 0.00030 | ms/batch 246.50 | loss  4.19 | ppl    66.10 
| epoch  23 |   200/  269 batches | lr 0.00030 | ms/batch 229.29 | loss  4.15 | ppl    63.48 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 62.90s | valid loss  4.17 | valid ppl    64.81 | valid bpc    6.018
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 23.0%
| epoch  24 |   100/  269 batches | lr 0.00030 | ms/batch 247.31 | loss  4.16 | ppl    63.85 
| epoch  24 |   200/  269 batches | lr 0.00030 | ms/batch 231.71 | loss  4.12 | ppl    61.65 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 63.43s | valid loss  4.23 | valid ppl    68.95 | valid bpc    6.107
-----------------------------------------------------------------------------------------
PROGRESS: 24.0%
| epoch  25 |   100/  269 batches | lr 0.00030 | ms/batch 246.93 | loss  4.08 | ppl    58.99 
| epoch  25 |   200/  269 batches | lr 0.00030 | ms/batch 232.35 | loss  4.05 | ppl    57.66 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 63.58s | valid loss  4.15 | valid ppl    63.28 | valid bpc    5.984
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 25.0%
| epoch  26 |   100/  269 batches | lr 0.00030 | ms/batch 245.86 | loss  4.05 | ppl    57.30 
| epoch  26 |   200/  269 batches | lr 0.00030 | ms/batch 232.25 | loss  4.02 | ppl    55.69 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 63.13s | valid loss  4.15 | valid ppl    63.34 | valid bpc    5.985
-----------------------------------------------------------------------------------------
PROGRESS: 26.0%
| epoch  27 |   100/  269 batches | lr 0.00030 | ms/batch 247.27 | loss  3.99 | ppl    54.12 
| epoch  27 |   200/  269 batches | lr 0.00030 | ms/batch 231.32 | loss  3.99 | ppl    53.92 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 63.10s | valid loss  4.05 | valid ppl    57.63 | valid bpc    5.849
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 27.0%
| epoch  28 |   100/  269 batches | lr 0.00030 | ms/batch 247.78 | loss  3.94 | ppl    51.50 
| epoch  28 |   200/  269 batches | lr 0.00030 | ms/batch 231.45 | loss  3.94 | ppl    51.20 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 63.64s | valid loss  4.09 | valid ppl    59.63 | valid bpc    5.898
-----------------------------------------------------------------------------------------
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  269 batches | lr 0.00030 | ms/batch 246.01 | loss  3.92 | ppl    50.23 
| epoch  29 |   200/  269 batches | lr 0.00030 | ms/batch 232.64 | loss  3.91 | ppl    50.00 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 64.89s | valid loss  4.08 | valid ppl    59.08 | valid bpc    5.885
-----------------------------------------------------------------------------------------
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  269 batches | lr 0.00030 | ms/batch 214.96 | loss  3.87 | ppl    47.84 
| epoch  30 |   200/  269 batches | lr 0.00030 | ms/batch 231.67 | loss  3.85 | ppl    46.87 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 61.80s | valid loss  4.05 | valid ppl    57.23 | valid bpc    5.839
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 30.0%
| epoch  31 |   100/  269 batches | lr 0.00030 | ms/batch 227.37 | loss  3.84 | ppl    46.56 
| epoch  31 |   200/  269 batches | lr 0.00030 | ms/batch 232.18 | loss  3.81 | ppl    45.04 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 63.05s | valid loss  4.05 | valid ppl    57.42 | valid bpc    5.844
-----------------------------------------------------------------------------------------
PROGRESS: 31.0%
| epoch  32 |   100/  269 batches | lr 0.00030 | ms/batch 228.00 | loss  3.81 | ppl    45.16 
| epoch  32 |   200/  269 batches | lr 0.00030 | ms/batch 232.49 | loss  3.76 | ppl    43.11 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 63.18s | valid loss  3.99 | valid ppl    54.29 | valid bpc    5.763
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 32.0%
| epoch  33 |   100/  269 batches | lr 0.00030 | ms/batch 230.43 | loss  3.77 | ppl    43.21 
| epoch  33 |   200/  269 batches | lr 0.00030 | ms/batch 232.94 | loss  3.74 | ppl    42.12 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 63.52s | valid loss  4.03 | valid ppl    56.09 | valid bpc    5.810
-----------------------------------------------------------------------------------------
PROGRESS: 33.0%
| epoch  34 |   100/  269 batches | lr 0.00030 | ms/batch 236.62 | loss  3.74 | ppl    41.91 
| epoch  34 |   200/  269 batches | lr 0.00030 | ms/batch 231.61 | loss  3.72 | ppl    41.31 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 63.91s | valid loss  3.98 | valid ppl    53.29 | valid bpc    5.736
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 34.0%
| epoch  35 |   100/  269 batches | lr 0.00030 | ms/batch 234.54 | loss  3.69 | ppl    39.89 
| epoch  35 |   200/  269 batches | lr 0.00030 | ms/batch 232.03 | loss  3.67 | ppl    39.23 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 63.86s | valid loss  4.00 | valid ppl    54.76 | valid bpc    5.775
-----------------------------------------------------------------------------------------
PROGRESS: 35.0%
| epoch  36 |   100/  269 batches | lr 0.00030 | ms/batch 227.26 | loss  3.65 | ppl    38.47 
| epoch  36 |   200/  269 batches | lr 0.00030 | ms/batch 233.04 | loss  3.65 | ppl    38.49 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 63.20s | valid loss  3.93 | valid ppl    50.96 | valid bpc    5.671
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 36.0%
| epoch  37 |   100/  269 batches | lr 0.00030 | ms/batch 232.39 | loss  3.62 | ppl    37.50 
| epoch  37 |   200/  269 batches | lr 0.00030 | ms/batch 226.78 | loss  3.59 | ppl    36.18 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 63.15s | valid loss  3.94 | valid ppl    51.65 | valid bpc    5.691
-----------------------------------------------------------------------------------------
PROGRESS: 37.0%
| epoch  38 |   100/  269 batches | lr 0.00030 | ms/batch 240.23 | loss  3.57 | ppl    35.50 
| epoch  38 |   200/  269 batches | lr 0.00030 | ms/batch 226.70 | loss  3.58 | ppl    35.72 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 63.91s | valid loss  3.94 | valid ppl    51.27 | valid bpc    5.680
-----------------------------------------------------------------------------------------
PROGRESS: 38.0%
| epoch  39 |   100/  269 batches | lr 0.00030 | ms/batch 241.03 | loss  3.55 | ppl    34.71 
| epoch  39 |   200/  269 batches | lr 0.00030 | ms/batch 226.38 | loss  3.54 | ppl    34.33 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 63.89s | valid loss  3.94 | valid ppl    51.64 | valid bpc    5.690
-----------------------------------------------------------------------------------------
PROGRESS: 39.0%
| epoch  40 |   100/  269 batches | lr 0.00015 | ms/batch 241.52 | loss  3.48 | ppl    32.38 
| epoch  40 |   200/  269 batches | lr 0.00015 | ms/batch 226.07 | loss  3.44 | ppl    31.10 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 63.90s | valid loss  3.86 | valid ppl    47.44 | valid bpc    5.568
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 40.0%
| epoch  41 |   100/  269 batches | lr 0.00015 | ms/batch 244.44 | loss  3.43 | ppl    30.93 
| epoch  41 |   200/  269 batches | lr 0.00015 | ms/batch 219.84 | loss  3.39 | ppl    29.80 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 63.55s | valid loss  3.86 | valid ppl    47.52 | valid bpc    5.570
-----------------------------------------------------------------------------------------
PROGRESS: 41.0%
| epoch  42 |   100/  269 batches | lr 0.00015 | ms/batch 247.43 | loss  3.40 | ppl    29.95 
| epoch  42 |   200/  269 batches | lr 0.00015 | ms/batch 215.77 | loss  3.35 | ppl    28.46 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 63.52s | valid loss  3.89 | valid ppl    48.76 | valid bpc    5.608
-----------------------------------------------------------------------------------------
PROGRESS: 42.0%
| epoch  43 |   100/  269 batches | lr 0.00015 | ms/batch 247.09 | loss  3.38 | ppl    29.43 
| epoch  43 |   200/  269 batches | lr 0.00015 | ms/batch 212.85 | loss  3.32 | ppl    27.73 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 63.16s | valid loss  3.85 | valid ppl    46.81 | valid bpc    5.549
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 43.0%
| epoch  44 |   100/  269 batches | lr 0.00015 | ms/batch 245.79 | loss  3.33 | ppl    27.96 
| epoch  44 |   200/  269 batches | lr 0.00015 | ms/batch 220.03 | loss  3.34 | ppl    28.12 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 63.88s | valid loss  3.84 | valid ppl    46.52 | valid bpc    5.540
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 44.0%
| epoch  45 |   100/  269 batches | lr 0.00015 | ms/batch 247.74 | loss  3.32 | ppl    27.73 
| epoch  45 |   200/  269 batches | lr 0.00015 | ms/batch 219.06 | loss  3.30 | ppl    27.04 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 63.56s | valid loss  3.82 | valid ppl    45.70 | valid bpc    5.514
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 45.0%
| epoch  46 |   100/  269 batches | lr 0.00015 | ms/batch 245.97 | loss  3.29 | ppl    26.77 
| epoch  46 |   200/  269 batches | lr 0.00015 | ms/batch 223.43 | loss  3.32 | ppl    27.69 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 63.53s | valid loss  3.85 | valid ppl    46.97 | valid bpc    5.554
-----------------------------------------------------------------------------------------
PROGRESS: 46.0%
| epoch  47 |   100/  269 batches | lr 0.00015 | ms/batch 247.91 | loss  3.28 | ppl    26.69 
| epoch  47 |   200/  269 batches | lr 0.00015 | ms/batch 225.48 | loss  3.26 | ppl    26.02 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 63.56s | valid loss  3.80 | valid ppl    44.88 | valid bpc    5.488
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 47.0%
| epoch  48 |   100/  269 batches | lr 0.00015 | ms/batch 246.21 | loss  3.27 | ppl    26.37 
| epoch  48 |   200/  269 batches | lr 0.00015 | ms/batch 222.79 | loss  3.26 | ppl    25.99 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 63.51s | valid loss  3.85 | valid ppl    47.11 | valid bpc    5.558
-----------------------------------------------------------------------------------------
PROGRESS: 48.0%
| epoch  49 |   100/  269 batches | lr 0.00015 | ms/batch 245.67 | loss  3.24 | ppl    25.44 
| epoch  49 |   200/  269 batches | lr 0.00015 | ms/batch 226.35 | loss  3.23 | ppl    25.28 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 63.83s | valid loss  3.85 | valid ppl    47.06 | valid bpc    5.556
-----------------------------------------------------------------------------------------
PROGRESS: 49.0%
| epoch  50 |   100/  269 batches | lr 0.00015 | ms/batch 245.91 | loss  3.23 | ppl    25.24 
| epoch  50 |   200/  269 batches | lr 0.00015 | ms/batch 226.01 | loss  3.21 | ppl    24.84 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 63.89s | valid loss  3.83 | valid ppl    46.02 | valid bpc    5.524
-----------------------------------------------------------------------------------------
PROGRESS: 50.0%
| epoch  51 |   100/  269 batches | lr 0.00007 | ms/batch 246.70 | loss  3.19 | ppl    24.22 
| epoch  51 |   200/  269 batches | lr 0.00007 | ms/batch 226.87 | loss  3.16 | ppl    23.63 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 63.95s | valid loss  3.79 | valid ppl    44.41 | valid bpc    5.473
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 51.0%
| epoch  52 |   100/  269 batches | lr 0.00007 | ms/batch 245.80 | loss  3.16 | ppl    23.64 
| epoch  52 |   200/  269 batches | lr 0.00007 | ms/batch 226.38 | loss  3.15 | ppl    23.24 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 64.43s | valid loss  3.81 | valid ppl    45.28 | valid bpc    5.501
-----------------------------------------------------------------------------------------
PROGRESS: 52.0%
| epoch  53 |   100/  269 batches | lr 0.00007 | ms/batch 241.22 | loss  3.17 | ppl    23.74 
| epoch  53 |   200/  269 batches | lr 0.00007 | ms/batch 232.25 | loss  3.11 | ppl    22.32 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 63.96s | valid loss  3.81 | valid ppl    45.17 | valid bpc    5.497
-----------------------------------------------------------------------------------------
PROGRESS: 53.0%
| epoch  54 |   100/  269 batches | lr 0.00007 | ms/batch 236.65 | loss  3.14 | ppl    23.01 
| epoch  54 |   200/  269 batches | lr 0.00007 | ms/batch 232.57 | loss  3.13 | ppl    22.76 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 63.50s | valid loss  3.80 | valid ppl    44.54 | valid bpc    5.477
-----------------------------------------------------------------------------------------
PROGRESS: 54.0%
| epoch  55 |   100/  269 batches | lr 0.00004 | ms/batch 240.44 | loss  3.10 | ppl    22.26 
| epoch  55 |   200/  269 batches | lr 0.00004 | ms/batch 231.55 | loss  3.09 | ppl    21.98 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 63.87s | valid loss  3.79 | valid ppl    44.09 | valid bpc    5.463
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  269 batches | lr 0.00004 | ms/batch 239.57 | loss  3.13 | ppl    22.79 
| epoch  56 |   200/  269 batches | lr 0.00004 | ms/batch 231.77 | loss  3.05 | ppl    21.17 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 63.87s | valid loss  3.76 | valid ppl    42.75 | valid bpc    5.418
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  269 batches | lr 0.00004 | ms/batch 241.97 | loss  3.08 | ppl    21.77 
| epoch  57 |   200/  269 batches | lr 0.00004 | ms/batch 232.05 | loss  3.06 | ppl    21.31 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 63.92s | valid loss  3.83 | valid ppl    46.15 | valid bpc    5.528
-----------------------------------------------------------------------------------------
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  269 batches | lr 0.00004 | ms/batch 236.32 | loss  3.07 | ppl    21.59 
| epoch  58 |   200/  269 batches | lr 0.00004 | ms/batch 232.57 | loss  3.05 | ppl    21.06 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 63.49s | valid loss  3.84 | valid ppl    46.31 | valid bpc    5.533
-----------------------------------------------------------------------------------------
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  269 batches | lr 0.00004 | ms/batch 241.54 | loss  3.08 | ppl    21.80 
| epoch  59 |   200/  269 batches | lr 0.00004 | ms/batch 230.56 | loss  3.04 | ppl    20.88 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 63.86s | valid loss  3.81 | valid ppl    44.94 | valid bpc    5.490
-----------------------------------------------------------------------------------------
PROGRESS: 59.0%
| epoch  60 |   100/  269 batches | lr 0.00002 | ms/batch 240.48 | loss  3.05 | ppl    21.01 
| epoch  60 |   200/  269 batches | lr 0.00002 | ms/batch 231.68 | loss  3.05 | ppl    21.02 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 63.89s | valid loss  3.78 | valid ppl    43.73 | valid bpc    5.451
-----------------------------------------------------------------------------------------
PROGRESS: 60.0%
| epoch  61 |   100/  269 batches | lr 0.00002 | ms/batch 241.25 | loss  3.07 | ppl    21.48 
| epoch  61 |   200/  269 batches | lr 0.00002 | ms/batch 232.50 | loss  3.01 | ppl    20.32 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 63.77s | valid loss  3.75 | valid ppl    42.47 | valid bpc    5.408
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 61.0%
| epoch  62 |   100/  269 batches | lr 0.00002 | ms/batch 244.08 | loss  3.04 | ppl    21.00 
| epoch  62 |   200/  269 batches | lr 0.00002 | ms/batch 229.14 | loss  3.03 | ppl    20.70 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 64.43s | valid loss  3.84 | valid ppl    46.74 | valid bpc    5.546
-----------------------------------------------------------------------------------------
PROGRESS: 62.0%
| epoch  63 |   100/  269 batches | lr 0.00002 | ms/batch 241.80 | loss  3.03 | ppl    20.76 
| epoch  63 |   200/  269 batches | lr 0.00002 | ms/batch 227.03 | loss  3.03 | ppl    20.60 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 64.00s | valid loss  3.76 | valid ppl    42.98 | valid bpc    5.425
-----------------------------------------------------------------------------------------
PROGRESS: 63.0%
| epoch  64 |   100/  269 batches | lr 0.00002 | ms/batch 240.34 | loss  3.05 | ppl    21.05 
| epoch  64 |   200/  269 batches | lr 0.00002 | ms/batch 226.38 | loss  2.99 | ppl    19.85 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 63.86s | valid loss  3.81 | valid ppl    44.96 | valid bpc    5.491
-----------------------------------------------------------------------------------------
PROGRESS: 64.0%
| epoch  65 |   100/  269 batches | lr 0.00001 | ms/batch 240.01 | loss  3.06 | ppl    21.42 
| epoch  65 |   200/  269 batches | lr 0.00001 | ms/batch 227.22 | loss  3.01 | ppl    20.33 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 63.90s | valid loss  3.77 | valid ppl    43.53 | valid bpc    5.444
-----------------------------------------------------------------------------------------
PROGRESS: 65.0%
| epoch  66 |   100/  269 batches | lr 0.00001 | ms/batch 240.91 | loss  3.04 | ppl    20.86 
| epoch  66 |   200/  269 batches | lr 0.00001 | ms/batch 226.55 | loss  3.00 | ppl    20.11 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 63.92s | valid loss  3.75 | valid ppl    42.64 | valid bpc    5.414
-----------------------------------------------------------------------------------------
PROGRESS: 66.0%
| epoch  67 |   100/  269 batches | lr 0.00001 | ms/batch 240.06 | loss  3.03 | ppl    20.63 
| epoch  67 |   200/  269 batches | lr 0.00001 | ms/batch 226.38 | loss  3.00 | ppl    20.08 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 63.91s | valid loss  3.77 | valid ppl    43.23 | valid bpc    5.434
-----------------------------------------------------------------------------------------
PROGRESS: 67.0%
| epoch  68 |   100/  269 batches | lr 0.00000 | ms/batch 241.07 | loss  3.02 | ppl    20.50 
| epoch  68 |   200/  269 batches | lr 0.00000 | ms/batch 227.03 | loss  2.99 | ppl    19.85 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 63.89s | valid loss  3.75 | valid ppl    42.60 | valid bpc    5.413
-----------------------------------------------------------------------------------------
PROGRESS: 68.0%
| epoch  69 |   100/  269 batches | lr 0.00000 | ms/batch 239.87 | loss  3.02 | ppl    20.46 
| epoch  69 |   200/  269 batches | lr 0.00000 | ms/batch 226.06 | loss  3.00 | ppl    20.04 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 63.88s | valid loss  3.76 | valid ppl    43.16 | valid bpc    5.432
-----------------------------------------------------------------------------------------
PROGRESS: 69.0%
| epoch  70 |   100/  269 batches | lr 0.00000 | ms/batch 240.51 | loss  3.04 | ppl    20.83 
| epoch  70 |   200/  269 batches | lr 0.00000 | ms/batch 226.82 | loss  3.00 | ppl    20.06 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 63.93s | valid loss  3.76 | valid ppl    42.85 | valid bpc    5.421
-----------------------------------------------------------------------------------------
PROGRESS: 70.0%
| epoch  71 |   100/  269 batches | lr 0.00000 | ms/batch 240.58 | loss  3.03 | ppl    20.67 
| epoch  71 |   200/  269 batches | lr 0.00000 | ms/batch 232.16 | loss  2.99 | ppl    19.98 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 63.84s | valid loss  3.81 | valid ppl    45.24 | valid bpc    5.500
-----------------------------------------------------------------------------------------
PROGRESS: 71.0%
| epoch  72 |   100/  269 batches | lr 0.00000 | ms/batch 240.23 | loss  3.02 | ppl    20.48 
| epoch  72 |   200/  269 batches | lr 0.00000 | ms/batch 232.31 | loss  2.99 | ppl    19.86 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 63.87s | valid loss  3.73 | valid ppl    41.53 | valid bpc    5.376
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 72.0%
| epoch  73 |   100/  269 batches | lr 0.00000 | ms/batch 240.97 | loss  3.01 | ppl    20.36 
| epoch  73 |   200/  269 batches | lr 0.00000 | ms/batch 231.55 | loss  3.00 | ppl    20.18 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 63.88s | valid loss  3.78 | valid ppl    43.71 | valid bpc    5.450
-----------------------------------------------------------------------------------------
PROGRESS: 73.0%
| epoch  74 |   100/  269 batches | lr 0.00000 | ms/batch 236.55 | loss  3.01 | ppl    20.19 
| epoch  74 |   200/  269 batches | lr 0.00000 | ms/batch 232.38 | loss  2.99 | ppl    19.88 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 63.53s | valid loss  3.79 | valid ppl    44.04 | valid bpc    5.461
-----------------------------------------------------------------------------------------
PROGRESS: 74.0%
| epoch  75 |   100/  269 batches | lr 0.00000 | ms/batch 246.14 | loss  3.02 | ppl    20.53 
| epoch  75 |   200/  269 batches | lr 0.00000 | ms/batch 227.72 | loss  2.97 | ppl    19.52 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 63.92s | valid loss  3.78 | valid ppl    43.87 | valid bpc    5.455
-----------------------------------------------------------------------------------------
PROGRESS: 75.0%
| epoch  76 |   100/  269 batches | lr 0.00000 | ms/batch 245.92 | loss  3.02 | ppl    20.58 
| epoch  76 |   200/  269 batches | lr 0.00000 | ms/batch 227.55 | loss  2.99 | ppl    19.85 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 63.93s | valid loss  3.76 | valid ppl    43.09 | valid bpc    5.429
-----------------------------------------------------------------------------------------
PROGRESS: 76.0%
| epoch  77 |   100/  269 batches | lr 0.00000 | ms/batch 245.48 | loss  3.03 | ppl    20.75 
| epoch  77 |   200/  269 batches | lr 0.00000 | ms/batch 226.02 | loss  2.99 | ppl    19.88 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 64.46s | valid loss  3.78 | valid ppl    43.75 | valid bpc    5.451
-----------------------------------------------------------------------------------------
PROGRESS: 77.0%
| epoch  78 |   100/  269 batches | lr 0.00000 | ms/batch 240.36 | loss  3.03 | ppl    20.62 
| epoch  78 |   200/  269 batches | lr 0.00000 | ms/batch 226.17 | loss  3.01 | ppl    20.24 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 63.88s | valid loss  3.76 | valid ppl    42.91 | valid bpc    5.423
-----------------------------------------------------------------------------------------
PROGRESS: 78.0%
| epoch  79 |   100/  269 batches | lr 0.00000 | ms/batch 236.61 | loss  3.02 | ppl    20.41 
| epoch  79 |   200/  269 batches | lr 0.00000 | ms/batch 225.77 | loss  3.00 | ppl    20.06 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 63.51s | valid loss  3.75 | valid ppl    42.45 | valid bpc    5.408
-----------------------------------------------------------------------------------------
PROGRESS: 79.0%
| epoch  80 |   100/  269 batches | lr 0.00000 | ms/batch 240.52 | loss  3.01 | ppl    20.31 
| epoch  80 |   200/  269 batches | lr 0.00000 | ms/batch 226.04 | loss  2.99 | ppl    19.94 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 63.91s | valid loss  3.83 | valid ppl    46.01 | valid bpc    5.524
-----------------------------------------------------------------------------------------
PROGRESS: 80.0%
| epoch  81 |   100/  269 batches | lr 0.00000 | ms/batch 241.35 | loss  3.00 | ppl    20.15 
| epoch  81 |   200/  269 batches | lr 0.00000 | ms/batch 225.97 | loss  2.98 | ppl    19.67 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 63.93s | valid loss  3.78 | valid ppl    43.69 | valid bpc    5.449
-----------------------------------------------------------------------------------------
PROGRESS: 81.0%
| epoch  82 |   100/  269 batches | lr 0.00000 | ms/batch 239.87 | loss  3.01 | ppl    20.26 
| epoch  82 |   200/  269 batches | lr 0.00000 | ms/batch 226.39 | loss  2.99 | ppl    19.90 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 63.91s | valid loss  3.76 | valid ppl    43.11 | valid bpc    5.430
-----------------------------------------------------------------------------------------
PROGRESS: 82.0%
| epoch  83 |   100/  269 batches | lr 0.00000 | ms/batch 239.96 | loss  3.02 | ppl    20.52 
| epoch  83 |   200/  269 batches | lr 0.00000 | ms/batch 227.45 | loss  3.00 | ppl    19.99 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 63.89s | valid loss  3.76 | valid ppl    43.14 | valid bpc    5.431
-----------------------------------------------------------------------------------------
PROGRESS: 83.0%
| epoch  84 |   100/  269 batches | lr 0.00000 | ms/batch 240.65 | loss  3.04 | ppl    20.86 
| epoch  84 |   200/  269 batches | lr 0.00000 | ms/batch 227.39 | loss  2.99 | ppl    19.84 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 63.94s | valid loss  3.75 | valid ppl    42.57 | valid bpc    5.412
-----------------------------------------------------------------------------------------
PROGRESS: 84.0%
| epoch  85 |   100/  269 batches | lr 0.00000 | ms/batch 240.44 | loss  3.01 | ppl    20.35 
| epoch  85 |   200/  269 batches | lr 0.00000 | ms/batch 227.33 | loss  2.97 | ppl    19.59 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 63.93s | valid loss  3.78 | valid ppl    43.81 | valid bpc    5.453
-----------------------------------------------------------------------------------------
PROGRESS: 85.0%
| epoch  86 |   100/  269 batches | lr 0.00000 | ms/batch 242.40 | loss  3.00 | ppl    20.13 
| epoch  86 |   200/  269 batches | lr 0.00000 | ms/batch 230.28 | loss  2.98 | ppl    19.77 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 63.86s | valid loss  3.78 | valid ppl    43.61 | valid bpc    5.447
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  269 batches | lr 0.00000 | ms/batch 247.17 | loss  3.02 | ppl    20.49 
| epoch  87 |   200/  269 batches | lr 0.00000 | ms/batch 225.80 | loss  2.98 | ppl    19.69 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 63.85s | valid loss  3.88 | valid ppl    48.18 | valid bpc    5.590
-----------------------------------------------------------------------------------------
PROGRESS: 87.0%
| epoch  88 |   100/  269 batches | lr 0.00000 | ms/batch 247.40 | loss  3.01 | ppl    20.25 
| epoch  88 |   200/  269 batches | lr 0.00000 | ms/batch 225.55 | loss  3.00 | ppl    20.06 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 63.57s | valid loss  3.77 | valid ppl    43.45 | valid bpc    5.441
-----------------------------------------------------------------------------------------
PROGRESS: 88.0%
| epoch  89 |   100/  269 batches | lr 0.00000 | ms/batch 246.97 | loss  3.01 | ppl    20.37 
| epoch  89 |   200/  269 batches | lr 0.00000 | ms/batch 225.80 | loss  2.99 | ppl    19.95 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 63.91s | valid loss  3.76 | valid ppl    42.75 | valid bpc    5.418
-----------------------------------------------------------------------------------------
PROGRESS: 89.0%
| epoch  90 |   100/  269 batches | lr 0.00000 | ms/batch 246.33 | loss  3.01 | ppl    20.37 
| epoch  90 |   200/  269 batches | lr 0.00000 | ms/batch 225.76 | loss  2.98 | ppl    19.59 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 63.54s | valid loss  3.70 | valid ppl    40.25 | valid bpc    5.331
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 90.0%
| epoch  91 |   100/  269 batches | lr 0.00000 | ms/batch 246.85 | loss  3.03 | ppl    20.64 
| epoch  91 |   200/  269 batches | lr 0.00000 | ms/batch 225.95 | loss  3.00 | ppl    20.13 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 63.92s | valid loss  3.75 | valid ppl    42.66 | valid bpc    5.415
-----------------------------------------------------------------------------------------
PROGRESS: 91.0%
| epoch  92 |   100/  269 batches | lr 0.00000 | ms/batch 246.63 | loss  3.02 | ppl    20.41 
| epoch  92 |   200/  269 batches | lr 0.00000 | ms/batch 226.16 | loss  2.98 | ppl    19.67 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 63.89s | valid loss  3.76 | valid ppl    43.09 | valid bpc    5.429
-----------------------------------------------------------------------------------------
PROGRESS: 92.0%
| epoch  93 |   100/  269 batches | lr 0.00000 | ms/batch 245.76 | loss  3.02 | ppl    20.40 
| epoch  93 |   200/  269 batches | lr 0.00000 | ms/batch 228.10 | loss  3.00 | ppl    20.02 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 64.03s | valid loss  3.77 | valid ppl    43.49 | valid bpc    5.443
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  269 batches | lr 0.00000 | ms/batch 245.73 | loss  3.00 | ppl    20.00 
| epoch  94 |   200/  269 batches | lr 0.00000 | ms/batch 225.93 | loss  2.98 | ppl    19.71 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 64.48s | valid loss  3.79 | valid ppl    44.22 | valid bpc    5.467
-----------------------------------------------------------------------------------------
PROGRESS: 94.0%
| epoch  95 |   100/  269 batches | lr 0.00000 | ms/batch 240.37 | loss  3.04 | ppl    21.00 
| epoch  95 |   200/  269 batches | lr 0.00000 | ms/batch 231.75 | loss  2.96 | ppl    19.27 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 63.87s | valid loss  3.74 | valid ppl    42.04 | valid bpc    5.394
-----------------------------------------------------------------------------------------
PROGRESS: 95.0%
| epoch  96 |   100/  269 batches | lr 0.00000 | ms/batch 239.78 | loss  3.01 | ppl    20.36 
| epoch  96 |   200/  269 batches | lr 0.00000 | ms/batch 232.45 | loss  2.98 | ppl    19.72 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 63.94s | valid loss  3.79 | valid ppl    44.09 | valid bpc    5.462
-----------------------------------------------------------------------------------------
PROGRESS: 96.0%
| epoch  97 |   100/  269 batches | lr 0.00000 | ms/batch 240.90 | loss  3.03 | ppl    20.77 
| epoch  97 |   200/  269 batches | lr 0.00000 | ms/batch 231.92 | loss  2.97 | ppl    19.49 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 63.87s | valid loss  3.77 | valid ppl    43.45 | valid bpc    5.441
-----------------------------------------------------------------------------------------
PROGRESS: 97.0%
| epoch  98 |   100/  269 batches | lr 0.00000 | ms/batch 240.50 | loss  3.02 | ppl    20.47 
| epoch  98 |   200/  269 batches | lr 0.00000 | ms/batch 232.16 | loss  2.99 | ppl    19.88 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 63.91s | valid loss  3.79 | valid ppl    44.27 | valid bpc    5.468
-----------------------------------------------------------------------------------------
PROGRESS: 98.0%
| epoch  99 |   100/  269 batches | lr 0.00000 | ms/batch 239.92 | loss  3.01 | ppl    20.29 
| epoch  99 |   200/  269 batches | lr 0.00000 | ms/batch 232.62 | loss  2.98 | ppl    19.78 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 63.90s | valid loss  3.77 | valid ppl    43.31 | valid bpc    5.437
-----------------------------------------------------------------------------------------
PROGRESS: 99.0%
| epoch 100 |   100/  269 batches | lr 0.00000 | ms/batch 240.06 | loss  3.02 | ppl    20.50 
| epoch 100 |   200/  269 batches | lr 0.00000 | ms/batch 232.74 | loss  2.99 | ppl    19.89 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 63.92s | valid loss  3.75 | valid ppl    42.36 | valid bpc    5.405
-----------------------------------------------------------------------------------------
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  3.86 | test ppl    47.27 | test bpc    5.563
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.4889, Mean Reca: 0.6863, Mean F1: 0.5666, Mean Subword_Reca: 0.8628
-----------------------------------------------------------------------------------------
=========================================================================================
Loading dataset...
Using subword tokenizer...
Number of tokens:  8000
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer_in_parser', nhid=512, nlayers=8, front_layers=6, rear_layers=2, subword='omarmomen/ptb_filtered_lowcase_bpe_tokenizer_8', n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=3333, nonmono=5, cuda=True, log_interval=100, save='trained_models/subword_structformer_in_parser_3333_62.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 37449060
Model architecture: StructFormer_In_Parser(
  (transformer_front): Transformer_Front(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(8000, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-5): 6 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
  (transformer_rear): Transformer_Rear(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(8000, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-1): 2 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (output_layer): Linear(in_features=512, out_features=8000, bias=True)
  )
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  269 batches | lr 0.00030 | ms/batch 255.90 | loss  7.76 | ppl  2335.44 
| epoch   1 |   200/  269 batches | lr 0.00030 | ms/batch 225.52 | loss  7.37 | ppl  1580.55 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 64.66s | valid loss  7.08 | valid ppl  1186.00 | valid bpc   10.212
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  269 batches | lr 0.00030 | ms/batch 247.23 | loss  7.31 | ppl  1492.04 
| epoch   2 |   200/  269 batches | lr 0.00030 | ms/batch 225.51 | loss  7.16 | ppl  1291.34 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 63.84s | valid loss  6.84 | valid ppl   938.40 | valid bpc    9.874
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  269 batches | lr 0.00030 | ms/batch 246.06 | loss  6.95 | ppl  1047.03 
| epoch   3 |   200/  269 batches | lr 0.00030 | ms/batch 215.70 | loss  6.64 | ppl   767.39 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 57.89s | valid loss  6.13 | valid ppl   460.83 | valid bpc    8.848
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  269 batches | lr 0.00030 | ms/batch 174.39 | loss  6.29 | ppl   540.58 
| epoch   4 |   200/  269 batches | lr 0.00030 | ms/batch 165.77 | loss  6.07 | ppl   433.78 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 43.47s | valid loss  5.71 | valid ppl   301.67 | valid bpc    8.237
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  269 batches | lr 0.00030 | ms/batch 90.37 | loss  5.92 | ppl   373.53 
| epoch   5 |   200/  269 batches | lr 0.00030 | ms/batch 88.93 | loss  5.80 | ppl   329.17 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 24.46s | valid loss  5.54 | valid ppl   254.57 | valid bpc    7.992
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  269 batches | lr 0.00030 | ms/batch 80.07 | loss  5.70 | ppl   298.36 
| epoch   6 |   200/  269 batches | lr 0.00030 | ms/batch 73.94 | loss  5.57 | ppl   261.95 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 26.08s | valid loss  5.36 | valid ppl   213.10 | valid bpc    7.735
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  269 batches | lr 0.00030 | ms/batch 162.15 | loss  5.54 | ppl   255.33 
| epoch   7 |   200/  269 batches | lr 0.00030 | ms/batch 221.15 | loss  5.42 | ppl   226.48 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 54.53s | valid loss  5.21 | valid ppl   183.44 | valid bpc    7.519
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  269 batches | lr 0.00030 | ms/batch 246.34 | loss  5.38 | ppl   217.11 
| epoch   8 |   200/  269 batches | lr 0.00030 | ms/batch 223.06 | loss  5.29 | ppl   199.10 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 63.04s | valid loss  5.06 | valid ppl   157.38 | valid bpc    7.298
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 8.0%
| epoch   9 |   100/  269 batches | lr 0.00030 | ms/batch 246.16 | loss  5.27 | ppl   193.48 
| epoch   9 |   200/  269 batches | lr 0.00030 | ms/batch 222.54 | loss  5.19 | ppl   179.36 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 63.23s | valid loss  4.97 | valid ppl   144.55 | valid bpc    7.175
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  269 batches | lr 0.00030 | ms/batch 245.79 | loss  5.14 | ppl   170.30 
| epoch  10 |   200/  269 batches | lr 0.00030 | ms/batch 223.26 | loss  5.06 | ppl   158.07 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 63.17s | valid loss  4.91 | valid ppl   135.77 | valid bpc    7.085
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  269 batches | lr 0.00030 | ms/batch 246.15 | loss  5.05 | ppl   156.16 
| epoch  11 |   200/  269 batches | lr 0.00030 | ms/batch 222.77 | loss  4.97 | ppl   143.56 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 63.24s | valid loss  4.80 | valid ppl   121.54 | valid bpc    6.925
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  269 batches | lr 0.00030 | ms/batch 246.06 | loss  4.95 | ppl   141.71 
| epoch  12 |   200/  269 batches | lr 0.00030 | ms/batch 222.57 | loss  4.88 | ppl   131.75 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 63.61s | valid loss  4.76 | valid ppl   116.19 | valid bpc    6.860
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 12.0%
| epoch  13 |   100/  269 batches | lr 0.00030 | ms/batch 245.92 | loss  4.85 | ppl   128.03 
| epoch  13 |   200/  269 batches | lr 0.00030 | ms/batch 223.65 | loss  4.81 | ppl   122.67 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 64.12s | valid loss  4.68 | valid ppl   107.86 | valid bpc    6.753
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 13.0%
| epoch  14 |   100/  269 batches | lr 0.00030 | ms/batch 236.54 | loss  4.79 | ppl   119.94 
| epoch  14 |   200/  269 batches | lr 0.00030 | ms/batch 222.95 | loss  4.72 | ppl   112.38 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 63.04s | valid loss  4.62 | valid ppl   101.49 | valid bpc    6.665
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  269 batches | lr 0.00030 | ms/batch 236.85 | loss  4.67 | ppl   106.61 
| epoch  15 |   200/  269 batches | lr 0.00030 | ms/batch 222.18 | loss  4.64 | ppl   103.98 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 63.21s | valid loss  4.59 | valid ppl    98.78 | valid bpc    6.626
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 15.0%
| epoch  16 |   100/  269 batches | lr 0.00030 | ms/batch 236.88 | loss  4.62 | ppl   101.80 
| epoch  16 |   200/  269 batches | lr 0.00030 | ms/batch 223.05 | loss  4.59 | ppl    98.28 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 63.13s | valid loss  4.51 | valid ppl    90.88 | valid bpc    6.506
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 16.0%
| epoch  17 |   100/  269 batches | lr 0.00030 | ms/batch 236.71 | loss  4.56 | ppl    95.38 
| epoch  17 |   200/  269 batches | lr 0.00030 | ms/batch 224.62 | loss  4.52 | ppl    92.00 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 63.14s | valid loss  4.44 | valid ppl    84.69 | valid bpc    6.404
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 17.0%
| epoch  18 |   100/  269 batches | lr 0.00030 | ms/batch 236.66 | loss  4.47 | ppl    87.77 
| epoch  18 |   200/  269 batches | lr 0.00030 | ms/batch 231.96 | loss  4.46 | ppl    86.73 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 63.17s | valid loss  4.38 | valid ppl    79.74 | valid bpc    6.317
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 18.0%
| epoch  19 |   100/  269 batches | lr 0.00030 | ms/batch 237.07 | loss  4.42 | ppl    82.89 
| epoch  19 |   200/  269 batches | lr 0.00030 | ms/batch 232.74 | loss  4.39 | ppl    80.35 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 63.22s | valid loss  4.36 | valid ppl    77.98 | valid bpc    6.285
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 19.0%
| epoch  20 |   100/  269 batches | lr 0.00030 | ms/batch 237.44 | loss  4.38 | ppl    79.60 
| epoch  20 |   200/  269 batches | lr 0.00030 | ms/batch 232.10 | loss  4.32 | ppl    74.84 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 63.22s | valid loss  4.29 | valid ppl    72.90 | valid bpc    6.188
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 20.0%
| epoch  21 |   100/  269 batches | lr 0.00030 | ms/batch 237.25 | loss  4.30 | ppl    73.44 
| epoch  21 |   200/  269 batches | lr 0.00030 | ms/batch 232.84 | loss  4.27 | ppl    71.30 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 63.24s | valid loss  4.30 | valid ppl    73.47 | valid bpc    6.199
-----------------------------------------------------------------------------------------
PROGRESS: 21.0%
| epoch  22 |   100/  269 batches | lr 0.00030 | ms/batch 243.77 | loss  4.26 | ppl    70.65 
| epoch  22 |   200/  269 batches | lr 0.00030 | ms/batch 225.55 | loss  4.21 | ppl    67.34 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 63.17s | valid loss  4.23 | valid ppl    69.03 | valid bpc    6.109
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 22.0%
| epoch  23 |   100/  269 batches | lr 0.00030 | ms/batch 246.65 | loss  4.20 | ppl    67.00 
| epoch  23 |   200/  269 batches | lr 0.00030 | ms/batch 223.37 | loss  4.16 | ppl    64.31 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 63.20s | valid loss  4.19 | valid ppl    65.79 | valid bpc    6.040
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 23.0%
| epoch  24 |   100/  269 batches | lr 0.00030 | ms/batch 245.75 | loss  4.13 | ppl    62.27 
| epoch  24 |   200/  269 batches | lr 0.00030 | ms/batch 226.21 | loss  4.10 | ppl    60.62 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 63.52s | valid loss  4.20 | valid ppl    66.58 | valid bpc    6.057
-----------------------------------------------------------------------------------------
PROGRESS: 24.0%
| epoch  25 |   100/  269 batches | lr 0.00030 | ms/batch 246.38 | loss  4.07 | ppl    58.83 
| epoch  25 |   200/  269 batches | lr 0.00030 | ms/batch 223.09 | loss  4.07 | ppl    58.28 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 63.94s | valid loss  4.14 | valid ppl    62.73 | valid bpc    5.971
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 25.0%
| epoch  26 |   100/  269 batches | lr 0.00030 | ms/batch 242.31 | loss  4.02 | ppl    55.64 
| epoch  26 |   200/  269 batches | lr 0.00030 | ms/batch 223.43 | loss  4.06 | ppl    58.13 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 63.77s | valid loss  4.15 | valid ppl    63.35 | valid bpc    5.985
-----------------------------------------------------------------------------------------
PROGRESS: 26.0%
| epoch  27 |   100/  269 batches | lr 0.00030 | ms/batch 235.91 | loss  4.00 | ppl    54.39 
| epoch  27 |   200/  269 batches | lr 0.00030 | ms/batch 223.52 | loss  3.99 | ppl    53.96 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 63.23s | valid loss  4.11 | valid ppl    60.81 | valid bpc    5.926
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 27.0%
| epoch  28 |   100/  269 batches | lr 0.00030 | ms/batch 236.87 | loss  3.95 | ppl    51.74 
| epoch  28 |   200/  269 batches | lr 0.00030 | ms/batch 226.11 | loss  3.92 | ppl    50.55 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 63.55s | valid loss  4.07 | valid ppl    58.83 | valid bpc    5.879
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  269 batches | lr 0.00030 | ms/batch 236.65 | loss  3.91 | ppl    49.65 
| epoch  29 |   200/  269 batches | lr 0.00030 | ms/batch 223.69 | loss  3.89 | ppl    49.12 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 63.22s | valid loss  4.06 | valid ppl    58.18 | valid bpc    5.862
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  269 batches | lr 0.00030 | ms/batch 238.39 | loss  3.86 | ppl    47.29 
| epoch  30 |   200/  269 batches | lr 0.00030 | ms/batch 224.48 | loss  3.85 | ppl    47.17 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 63.17s | valid loss  4.03 | valid ppl    56.13 | valid bpc    5.811
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 30.0%
| epoch  31 |   100/  269 batches | lr 0.00030 | ms/batch 241.38 | loss  3.84 | ppl    46.60 
| epoch  31 |   200/  269 batches | lr 0.00030 | ms/batch 231.82 | loss  3.79 | ppl    44.18 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 63.52s | valid loss  4.01 | valid ppl    55.04 | valid bpc    5.783
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 31.0%
| epoch  32 |   100/  269 batches | lr 0.00030 | ms/batch 237.82 | loss  3.81 | ppl    45.22 
| epoch  32 |   200/  269 batches | lr 0.00030 | ms/batch 231.82 | loss  3.75 | ppl    42.48 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 63.56s | valid loss  4.01 | valid ppl    54.89 | valid bpc    5.779
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 32.0%
| epoch  33 |   100/  269 batches | lr 0.00030 | ms/batch 241.50 | loss  3.76 | ppl    42.87 
| epoch  33 |   200/  269 batches | lr 0.00030 | ms/batch 231.89 | loss  3.72 | ppl    41.45 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 63.54s | valid loss  3.96 | valid ppl    52.53 | valid bpc    5.715
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 33.0%
| epoch  34 |   100/  269 batches | lr 0.00030 | ms/batch 237.09 | loss  3.69 | ppl    40.01 
| epoch  34 |   200/  269 batches | lr 0.00030 | ms/batch 231.86 | loss  3.70 | ppl    40.35 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 63.53s | valid loss  3.99 | valid ppl    54.10 | valid bpc    5.758
-----------------------------------------------------------------------------------------
PROGRESS: 34.0%
| epoch  35 |   100/  269 batches | lr 0.00030 | ms/batch 237.03 | loss  3.67 | ppl    39.42 
| epoch  35 |   200/  269 batches | lr 0.00030 | ms/batch 232.58 | loss  3.65 | ppl    38.41 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 63.57s | valid loss  3.97 | valid ppl    52.76 | valid bpc    5.721
-----------------------------------------------------------------------------------------
PROGRESS: 35.0%
| epoch  36 |   100/  269 batches | lr 0.00030 | ms/batch 238.05 | loss  3.65 | ppl    38.42 
| epoch  36 |   200/  269 batches | lr 0.00030 | ms/batch 233.08 | loss  3.63 | ppl    37.86 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 63.37s | valid loss  3.99 | valid ppl    53.91 | valid bpc    5.752
-----------------------------------------------------------------------------------------
PROGRESS: 36.0%
| epoch  37 |   100/  269 batches | lr 0.00015 | ms/batch 240.46 | loss  3.57 | ppl    35.67 
| epoch  37 |   200/  269 batches | lr 0.00015 | ms/batch 228.84 | loss  3.51 | ppl    33.31 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 64.08s | valid loss  3.94 | valid ppl    51.63 | valid bpc    5.690
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 37.0%
| epoch  38 |   100/  269 batches | lr 0.00015 | ms/batch 240.24 | loss  3.51 | ppl    33.32 
| epoch  38 |   200/  269 batches | lr 0.00015 | ms/batch 226.70 | loss  3.49 | ppl    32.64 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 63.82s | valid loss  3.89 | valid ppl    48.99 | valid bpc    5.614
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 38.0%
| epoch  39 |   100/  269 batches | lr 0.00015 | ms/batch 240.21 | loss  3.45 | ppl    31.54 
| epoch  39 |   200/  269 batches | lr 0.00015 | ms/batch 226.45 | loss  3.45 | ppl    31.54 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 63.85s | valid loss  3.89 | valid ppl    48.67 | valid bpc    5.605
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 39.0%
| epoch  40 |   100/  269 batches | lr 0.00015 | ms/batch 237.23 | loss  3.46 | ppl    31.89 
| epoch  40 |   200/  269 batches | lr 0.00015 | ms/batch 223.34 | loss  3.46 | ppl    31.69 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 63.23s | valid loss  3.87 | valid ppl    48.13 | valid bpc    5.589
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 40.0%
| epoch  41 |   100/  269 batches | lr 0.00015 | ms/batch 240.17 | loss  3.41 | ppl    30.32 
| epoch  41 |   200/  269 batches | lr 0.00015 | ms/batch 223.87 | loss  3.42 | ppl    30.60 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 63.53s | valid loss  3.87 | valid ppl    47.99 | valid bpc    5.585
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 41.0%
| epoch  42 |   100/  269 batches | lr 0.00015 | ms/batch 236.92 | loss  3.40 | ppl    29.94 
| epoch  42 |   200/  269 batches | lr 0.00015 | ms/batch 226.16 | loss  3.38 | ppl    29.30 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 63.54s | valid loss  3.84 | valid ppl    46.70 | valid bpc    5.545
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 42.0%
| epoch  43 |   100/  269 batches | lr 0.00015 | ms/batch 240.00 | loss  3.38 | ppl    29.49 
| epoch  43 |   200/  269 batches | lr 0.00015 | ms/batch 226.08 | loss  3.38 | ppl    29.28 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 63.88s | valid loss  3.85 | valid ppl    46.88 | valid bpc    5.551
-----------------------------------------------------------------------------------------
PROGRESS: 43.0%
| epoch  44 |   100/  269 batches | lr 0.00015 | ms/batch 240.02 | loss  3.37 | ppl    29.21 
| epoch  44 |   200/  269 batches | lr 0.00015 | ms/batch 223.02 | loss  3.36 | ppl    28.68 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 63.50s | valid loss  3.86 | valid ppl    47.40 | valid bpc    5.567
-----------------------------------------------------------------------------------------
PROGRESS: 44.0%
| epoch  45 |   100/  269 batches | lr 0.00015 | ms/batch 238.19 | loss  3.34 | ppl    28.08 
| epoch  45 |   200/  269 batches | lr 0.00015 | ms/batch 222.91 | loss  3.32 | ppl    27.78 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 63.28s | valid loss  3.83 | valid ppl    46.25 | valid bpc    5.531
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 45.0%
| epoch  46 |   100/  269 batches | lr 0.00015 | ms/batch 239.63 | loss  3.34 | ppl    28.10 
| epoch  46 |   200/  269 batches | lr 0.00015 | ms/batch 222.80 | loss  3.30 | ppl    27.05 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 63.53s | valid loss  3.87 | valid ppl    47.74 | valid bpc    5.577
-----------------------------------------------------------------------------------------
PROGRESS: 46.0%
| epoch  47 |   100/  269 batches | lr 0.00015 | ms/batch 240.96 | loss  3.31 | ppl    27.35 
| epoch  47 |   200/  269 batches | lr 0.00015 | ms/batch 226.03 | loss  3.29 | ppl    26.96 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 63.92s | valid loss  3.84 | valid ppl    46.35 | valid bpc    5.535
-----------------------------------------------------------------------------------------
PROGRESS: 47.0%
| epoch  48 |   100/  269 batches | lr 0.00015 | ms/batch 246.10 | loss  3.29 | ppl    26.80 
| epoch  48 |   200/  269 batches | lr 0.00015 | ms/batch 212.60 | loss  3.28 | ppl    26.67 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 63.22s | valid loss  3.89 | valid ppl    48.76 | valid bpc    5.608
-----------------------------------------------------------------------------------------
PROGRESS: 48.0%
| epoch  49 |   100/  269 batches | lr 0.00007 | ms/batch 247.23 | loss  3.24 | ppl    25.55 
| epoch  49 |   200/  269 batches | lr 0.00007 | ms/batch 222.51 | loss  3.23 | ppl    25.21 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 63.50s | valid loss  3.80 | valid ppl    44.91 | valid bpc    5.489
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 49.0%
| epoch  50 |   100/  269 batches | lr 0.00007 | ms/batch 246.41 | loss  3.23 | ppl    25.15 
| epoch  50 |   200/  269 batches | lr 0.00007 | ms/batch 222.66 | loss  3.20 | ppl    24.60 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 63.16s | valid loss  3.83 | valid ppl    45.91 | valid bpc    5.521
-----------------------------------------------------------------------------------------
PROGRESS: 50.0%
| epoch  51 |   100/  269 batches | lr 0.00007 | ms/batch 247.44 | loss  3.21 | ppl    24.76 
| epoch  51 |   200/  269 batches | lr 0.00007 | ms/batch 226.29 | loss  3.15 | ppl    23.32 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 63.89s | valid loss  3.80 | valid ppl    44.71 | valid bpc    5.482
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 51.0%
| epoch  52 |   100/  269 batches | lr 0.00007 | ms/batch 245.88 | loss  3.19 | ppl    24.24 
| epoch  52 |   200/  269 batches | lr 0.00007 | ms/batch 227.07 | loss  3.15 | ppl    23.40 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 63.86s | valid loss  3.82 | valid ppl    45.58 | valid bpc    5.510
-----------------------------------------------------------------------------------------
PROGRESS: 52.0%
| epoch  53 |   100/  269 batches | lr 0.00007 | ms/batch 245.99 | loss  3.17 | ppl    23.84 
| epoch  53 |   200/  269 batches | lr 0.00007 | ms/batch 226.21 | loss  3.15 | ppl    23.41 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 63.50s | valid loss  3.82 | valid ppl    45.72 | valid bpc    5.515
-----------------------------------------------------------------------------------------
PROGRESS: 53.0%
| epoch  54 |   100/  269 batches | lr 0.00007 | ms/batch 247.26 | loss  3.15 | ppl    23.37 
| epoch  54 |   200/  269 batches | lr 0.00007 | ms/batch 223.20 | loss  3.14 | ppl    23.11 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 63.26s | valid loss  3.71 | valid ppl    40.86 | valid bpc    5.353
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 54.0%
| epoch  55 |   100/  269 batches | lr 0.00007 | ms/batch 245.98 | loss  3.15 | ppl    23.38 
| epoch  55 |   200/  269 batches | lr 0.00007 | ms/batch 228.62 | loss  3.14 | ppl    23.09 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 63.54s | valid loss  3.81 | valid ppl    44.99 | valid bpc    5.492
-----------------------------------------------------------------------------------------
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  269 batches | lr 0.00007 | ms/batch 245.84 | loss  3.13 | ppl    22.85 
| epoch  56 |   200/  269 batches | lr 0.00007 | ms/batch 231.75 | loss  3.13 | ppl    22.92 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 63.91s | valid loss  3.80 | valid ppl    44.87 | valid bpc    5.488
-----------------------------------------------------------------------------------------
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  269 batches | lr 0.00007 | ms/batch 245.85 | loss  3.14 | ppl    23.12 
| epoch  57 |   200/  269 batches | lr 0.00007 | ms/batch 233.02 | loss  3.10 | ppl    22.26 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 64.49s | valid loss  3.85 | valid ppl    46.79 | valid bpc    5.548
-----------------------------------------------------------------------------------------
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  269 batches | lr 0.00004 | ms/batch 240.22 | loss  3.12 | ppl    22.61 
| epoch  58 |   200/  269 batches | lr 0.00004 | ms/batch 232.79 | loss  3.09 | ppl    21.91 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 63.87s | valid loss  3.79 | valid ppl    44.31 | valid bpc    5.470
-----------------------------------------------------------------------------------------
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  269 batches | lr 0.00004 | ms/batch 237.58 | loss  3.10 | ppl    22.18 
| epoch  59 |   200/  269 batches | lr 0.00004 | ms/batch 231.62 | loss  3.08 | ppl    21.80 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 63.16s | valid loss  3.80 | valid ppl    44.63 | valid bpc    5.480
-----------------------------------------------------------------------------------------
PROGRESS: 59.0%
| epoch  60 |   100/  269 batches | lr 0.00004 | ms/batch 240.52 | loss  3.08 | ppl    21.74 
| epoch  60 |   200/  269 batches | lr 0.00004 | ms/batch 232.98 | loss  3.06 | ppl    21.34 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 63.97s | valid loss  3.76 | valid ppl    42.91 | valid bpc    5.423
-----------------------------------------------------------------------------------------
PROGRESS: 60.0%
| epoch  61 |   100/  269 batches | lr 0.00002 | ms/batch 240.81 | loss  3.08 | ppl    21.75 
| epoch  61 |   200/  269 batches | lr 0.00002 | ms/batch 231.52 | loss  3.04 | ppl    20.95 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 64.43s | valid loss  3.82 | valid ppl    45.75 | valid bpc    5.516
-----------------------------------------------------------------------------------------
PROGRESS: 61.0%
| epoch  62 |   100/  269 batches | lr 0.00002 | ms/batch 229.91 | loss  3.08 | ppl    21.82 
| epoch  62 |   200/  269 batches | lr 0.00002 | ms/batch 232.68 | loss  3.07 | ppl    21.52 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 63.42s | valid loss  3.79 | valid ppl    44.09 | valid bpc    5.462
-----------------------------------------------------------------------------------------
PROGRESS: 62.0%
| epoch  63 |   100/  269 batches | lr 0.00002 | ms/batch 231.21 | loss  3.06 | ppl    21.23 
| epoch  63 |   200/  269 batches | lr 0.00002 | ms/batch 232.85 | loss  3.04 | ppl    20.81 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 63.49s | valid loss  3.83 | valid ppl    45.85 | valid bpc    5.519
-----------------------------------------------------------------------------------------
PROGRESS: 63.0%
| epoch  64 |   100/  269 batches | lr 0.00001 | ms/batch 234.70 | loss  3.05 | ppl    21.19 
| epoch  64 |   200/  269 batches | lr 0.00001 | ms/batch 233.16 | loss  3.02 | ppl    20.54 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 63.92s | valid loss  3.75 | valid ppl    42.47 | valid bpc    5.408
-----------------------------------------------------------------------------------------
PROGRESS: 64.0%
| epoch  65 |   100/  269 batches | lr 0.00001 | ms/batch 234.61 | loss  3.06 | ppl    21.36 
| epoch  65 |   200/  269 batches | lr 0.00001 | ms/batch 231.80 | loss  3.04 | ppl    20.84 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 63.85s | valid loss  3.79 | valid ppl    44.12 | valid bpc    5.463
-----------------------------------------------------------------------------------------
PROGRESS: 65.0%
| epoch  66 |   100/  269 batches | lr 0.00001 | ms/batch 234.57 | loss  3.07 | ppl    21.48 
| epoch  66 |   200/  269 batches | lr 0.00001 | ms/batch 232.27 | loss  3.02 | ppl    20.40 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 63.87s | valid loss  3.81 | valid ppl    45.13 | valid bpc    5.496
-----------------------------------------------------------------------------------------
PROGRESS: 66.0%
| epoch  67 |   100/  269 batches | lr 0.00000 | ms/batch 234.57 | loss  3.04 | ppl    20.99 
| epoch  67 |   200/  269 batches | lr 0.00000 | ms/batch 231.76 | loss  3.03 | ppl    20.66 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 63.92s | valid loss  3.76 | valid ppl    43.13 | valid bpc    5.430
-----------------------------------------------------------------------------------------
PROGRESS: 67.0%
| epoch  68 |   100/  269 batches | lr 0.00000 | ms/batch 234.40 | loss  3.06 | ppl    21.24 
| epoch  68 |   200/  269 batches | lr 0.00000 | ms/batch 232.38 | loss  2.99 | ppl    19.93 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 63.86s | valid loss  3.77 | valid ppl    43.45 | valid bpc    5.441
-----------------------------------------------------------------------------------------
PROGRESS: 68.0%
| epoch  69 |   100/  269 batches | lr 0.00000 | ms/batch 241.35 | loss  3.08 | ppl    21.68 
| epoch  69 |   200/  269 batches | lr 0.00000 | ms/batch 227.96 | loss  3.00 | ppl    20.11 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 63.98s | valid loss  3.76 | valid ppl    42.74 | valid bpc    5.417
-----------------------------------------------------------------------------------------
PROGRESS: 69.0%
| epoch  70 |   100/  269 batches | lr 0.00000 | ms/batch 246.38 | loss  3.07 | ppl    21.55 
| epoch  70 |   200/  269 batches | lr 0.00000 | ms/batch 221.31 | loss  3.02 | ppl    20.47 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 63.93s | valid loss  3.77 | valid ppl    43.18 | valid bpc    5.432
-----------------------------------------------------------------------------------------
PROGRESS: 70.0%
| epoch  71 |   100/  269 batches | lr 0.00000 | ms/batch 246.67 | loss  3.06 | ppl    21.41 
| epoch  71 |   200/  269 batches | lr 0.00000 | ms/batch 215.73 | loss  3.01 | ppl    20.33 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 63.39s | valid loss  3.72 | valid ppl    41.17 | valid bpc    5.364
-----------------------------------------------------------------------------------------
PROGRESS: 71.0%
| epoch  72 |   100/  269 batches | lr 0.00000 | ms/batch 245.56 | loss  3.05 | ppl    21.04 
| epoch  72 |   200/  269 batches | lr 0.00000 | ms/batch 220.84 | loss  3.03 | ppl    20.73 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 63.93s | valid loss  3.77 | valid ppl    43.28 | valid bpc    5.436
-----------------------------------------------------------------------------------------
PROGRESS: 72.0%
| epoch  73 |   100/  269 batches | lr 0.00000 | ms/batch 245.83 | loss  3.02 | ppl    20.45 
| epoch  73 |   200/  269 batches | lr 0.00000 | ms/batch 217.10 | loss  3.03 | ppl    20.69 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 63.49s | valid loss  3.74 | valid ppl    42.11 | valid bpc    5.396
-----------------------------------------------------------------------------------------
PROGRESS: 73.0%
| epoch  74 |   100/  269 batches | lr 0.00000 | ms/batch 246.37 | loss  3.05 | ppl    21.05 
| epoch  74 |   200/  269 batches | lr 0.00000 | ms/batch 221.41 | loss  3.01 | ppl    20.28 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 63.93s | valid loss  3.76 | valid ppl    42.89 | valid bpc    5.423
-----------------------------------------------------------------------------------------
PROGRESS: 74.0%
| epoch  75 |   100/  269 batches | lr 0.00000 | ms/batch 246.54 | loss  3.03 | ppl    20.78 
| epoch  75 |   200/  269 batches | lr 0.00000 | ms/batch 220.32 | loss  3.01 | ppl    20.32 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 63.89s | valid loss  3.74 | valid ppl    41.97 | valid bpc    5.391
-----------------------------------------------------------------------------------------
PROGRESS: 75.0%
| epoch  76 |   100/  269 batches | lr 0.00000 | ms/batch 246.66 | loss  3.04 | ppl    20.90 
| epoch  76 |   200/  269 batches | lr 0.00000 | ms/batch 220.34 | loss  3.00 | ppl    20.09 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 63.89s | valid loss  3.75 | valid ppl    42.43 | valid bpc    5.407
-----------------------------------------------------------------------------------------
PROGRESS: 76.0%
| epoch  77 |   100/  269 batches | lr 0.00000 | ms/batch 247.39 | loss  3.04 | ppl    21.00 
| epoch  77 |   200/  269 batches | lr 0.00000 | ms/batch 216.67 | loss  3.04 | ppl    20.92 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 63.53s | valid loss  3.79 | valid ppl    44.23 | valid bpc    5.467
-----------------------------------------------------------------------------------------
PROGRESS: 77.0%
| epoch  78 |   100/  269 batches | lr 0.00000 | ms/batch 246.52 | loss  3.04 | ppl    20.85 
| epoch  78 |   200/  269 batches | lr 0.00000 | ms/batch 227.22 | loss  3.00 | ppl    20.15 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 63.58s | valid loss  3.76 | valid ppl    43.09 | valid bpc    5.429
-----------------------------------------------------------------------------------------
PROGRESS: 78.0%
| epoch  79 |   100/  269 batches | lr 0.00000 | ms/batch 246.69 | loss  3.04 | ppl    20.97 
| epoch  79 |   200/  269 batches | lr 0.00000 | ms/batch 231.86 | loss  3.01 | ppl    20.32 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 63.59s | valid loss  3.77 | valid ppl    43.47 | valid bpc    5.442
-----------------------------------------------------------------------------------------
PROGRESS: 79.0%
| epoch  80 |   100/  269 batches | lr 0.00000 | ms/batch 245.59 | loss  3.04 | ppl    20.87 
| epoch  80 |   200/  269 batches | lr 0.00000 | ms/batch 232.13 | loss  3.01 | ppl    20.37 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 63.90s | valid loss  3.74 | valid ppl    42.06 | valid bpc    5.394
-----------------------------------------------------------------------------------------
PROGRESS: 80.0%
| epoch  81 |   100/  269 batches | lr 0.00000 | ms/batch 245.83 | loss  3.04 | ppl    20.86 
| epoch  81 |   200/  269 batches | lr 0.00000 | ms/batch 232.39 | loss  3.01 | ppl    20.22 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 63.47s | valid loss  3.81 | valid ppl    45.26 | valid bpc    5.500
-----------------------------------------------------------------------------------------
PROGRESS: 81.0%
| epoch  82 |   100/  269 batches | lr 0.00000 | ms/batch 246.13 | loss  3.06 | ppl    21.35 
| epoch  82 |   200/  269 batches | lr 0.00000 | ms/batch 232.86 | loss  2.99 | ppl    19.87 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 63.87s | valid loss  3.78 | valid ppl    44.00 | valid bpc    5.460
-----------------------------------------------------------------------------------------
PROGRESS: 82.0%
| epoch  83 |   100/  269 batches | lr 0.00000 | ms/batch 246.73 | loss  3.05 | ppl    21.06 
| epoch  83 |   200/  269 batches | lr 0.00000 | ms/batch 232.06 | loss  3.02 | ppl    20.56 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 64.48s | valid loss  3.75 | valid ppl    42.65 | valid bpc    5.414
-----------------------------------------------------------------------------------------
PROGRESS: 83.0%
| epoch  84 |   100/  269 batches | lr 0.00000 | ms/batch 240.42 | loss  3.04 | ppl    20.80 
| epoch  84 |   200/  269 batches | lr 0.00000 | ms/batch 231.92 | loss  3.02 | ppl    20.48 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 63.85s | valid loss  3.80 | valid ppl    44.74 | valid bpc    5.483
-----------------------------------------------------------------------------------------
PROGRESS: 84.0%
| epoch  85 |   100/  269 batches | lr 0.00000 | ms/batch 240.46 | loss  3.03 | ppl    20.79 
| epoch  85 |   200/  269 batches | lr 0.00000 | ms/batch 231.81 | loss  3.00 | ppl    20.19 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 63.90s | valid loss  3.77 | valid ppl    43.37 | valid bpc    5.439
-----------------------------------------------------------------------------------------
PROGRESS: 85.0%
| epoch  86 |   100/  269 batches | lr 0.00000 | ms/batch 239.38 | loss  3.04 | ppl    21.00 
| epoch  86 |   200/  269 batches | lr 0.00000 | ms/batch 232.57 | loss  3.02 | ppl    20.51 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 64.37s | valid loss  3.73 | valid ppl    41.66 | valid bpc    5.380
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  269 batches | lr 0.00000 | ms/batch 235.18 | loss  3.04 | ppl    20.85 
| epoch  87 |   200/  269 batches | lr 0.00000 | ms/batch 231.21 | loss  3.00 | ppl    20.17 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 63.86s | valid loss  3.77 | valid ppl    43.31 | valid bpc    5.437
-----------------------------------------------------------------------------------------
PROGRESS: 87.0%
| epoch  88 |   100/  269 batches | lr 0.00000 | ms/batch 234.53 | loss  3.03 | ppl    20.71 
| epoch  88 |   200/  269 batches | lr 0.00000 | ms/batch 232.48 | loss  3.00 | ppl    20.18 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 63.85s | valid loss  3.74 | valid ppl    41.92 | valid bpc    5.390
-----------------------------------------------------------------------------------------
PROGRESS: 88.0%
| epoch  89 |   100/  269 batches | lr 0.00000 | ms/batch 234.45 | loss  3.05 | ppl    21.05 
| epoch  89 |   200/  269 batches | lr 0.00000 | ms/batch 232.57 | loss  3.02 | ppl    20.44 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 63.87s | valid loss  3.74 | valid ppl    42.08 | valid bpc    5.395
-----------------------------------------------------------------------------------------
PROGRESS: 89.0%
| epoch  90 |   100/  269 batches | lr 0.00000 | ms/batch 235.20 | loss  3.04 | ppl    20.99 
| epoch  90 |   200/  269 batches | lr 0.00000 | ms/batch 231.84 | loss  3.00 | ppl    20.13 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 63.88s | valid loss  3.78 | valid ppl    43.77 | valid bpc    5.452
-----------------------------------------------------------------------------------------
PROGRESS: 90.0%
| epoch  91 |   100/  269 batches | lr 0.00000 | ms/batch 235.33 | loss  3.05 | ppl    21.05 
| epoch  91 |   200/  269 batches | lr 0.00000 | ms/batch 230.99 | loss  3.00 | ppl    20.14 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 63.84s | valid loss  3.77 | valid ppl    43.29 | valid bpc    5.436
-----------------------------------------------------------------------------------------
PROGRESS: 91.0%
| epoch  92 |   100/  269 batches | lr 0.00000 | ms/batch 234.25 | loss  3.04 | ppl    20.92 
| epoch  92 |   200/  269 batches | lr 0.00000 | ms/batch 232.91 | loss  3.02 | ppl    20.43 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 63.86s | valid loss  3.72 | valid ppl    41.32 | valid bpc    5.369
-----------------------------------------------------------------------------------------
PROGRESS: 92.0%
| epoch  93 |   100/  269 batches | lr 0.00000 | ms/batch 239.52 | loss  3.05 | ppl    21.14 
| epoch  93 |   200/  269 batches | lr 0.00000 | ms/batch 226.72 | loss  3.01 | ppl    20.20 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 63.86s | valid loss  3.78 | valid ppl    43.70 | valid bpc    5.450
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  269 batches | lr 0.00000 | ms/batch 240.39 | loss  3.04 | ppl    20.96 
| epoch  94 |   200/  269 batches | lr 0.00000 | ms/batch 225.55 | loss  3.00 | ppl    20.14 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 63.86s | valid loss  3.74 | valid ppl    42.30 | valid bpc    5.403
-----------------------------------------------------------------------------------------
PROGRESS: 94.0%
| epoch  95 |   100/  269 batches | lr 0.00000 | ms/batch 241.02 | loss  3.04 | ppl    20.85 
| epoch  95 |   200/  269 batches | lr 0.00000 | ms/batch 226.32 | loss  3.04 | ppl    20.83 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 63.91s | valid loss  3.76 | valid ppl    42.96 | valid bpc    5.425
-----------------------------------------------------------------------------------------
PROGRESS: 95.0%
| epoch  96 |   100/  269 batches | lr 0.00000 | ms/batch 240.88 | loss  3.04 | ppl    20.95 
| epoch  96 |   200/  269 batches | lr 0.00000 | ms/batch 226.58 | loss  3.02 | ppl    20.40 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 63.86s | valid loss  3.78 | valid ppl    43.70 | valid bpc    5.450
-----------------------------------------------------------------------------------------
PROGRESS: 96.0%
| epoch  97 |   100/  269 batches | lr 0.00000 | ms/batch 240.95 | loss  3.05 | ppl    21.01 
| epoch  97 |   200/  269 batches | lr 0.00000 | ms/batch 225.54 | loss  2.99 | ppl    19.95 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 63.83s | valid loss  3.78 | valid ppl    43.91 | valid bpc    5.456
-----------------------------------------------------------------------------------------
PROGRESS: 97.0%
| epoch  98 |   100/  269 batches | lr 0.00000 | ms/batch 241.68 | loss  3.06 | ppl    21.40 
| epoch  98 |   200/  269 batches | lr 0.00000 | ms/batch 226.50 | loss  3.02 | ppl    20.44 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 63.91s | valid loss  3.82 | valid ppl    45.59 | valid bpc    5.511
-----------------------------------------------------------------------------------------
PROGRESS: 98.0%
| epoch  99 |   100/  269 batches | lr 0.00000 | ms/batch 246.47 | loss  3.05 | ppl    21.13 
| epoch  99 |   200/  269 batches | lr 0.00000 | ms/batch 220.78 | loss  3.01 | ppl    20.19 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 63.87s | valid loss  3.81 | valid ppl    44.95 | valid bpc    5.490
-----------------------------------------------------------------------------------------
PROGRESS: 99.0%
| epoch 100 |   100/  269 batches | lr 0.00000 | ms/batch 246.71 | loss  3.03 | ppl    20.72 
| epoch 100 |   200/  269 batches | lr 0.00000 | ms/batch 219.56 | loss  3.03 | ppl    20.62 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 63.78s | valid loss  3.76 | valid ppl    43.03 | valid bpc    5.427
-----------------------------------------------------------------------------------------
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  3.85 | test ppl    46.95 | test bpc    5.553
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.4810, Mean Reca: 0.6759, Mean F1: 0.5576, Mean Subword_Reca: 0.8762
-----------------------------------------------------------------------------------------
=========================================================================================
Loading dataset...
Using subword tokenizer...
Number of tokens:  8000
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer_in_parser', nhid=512, nlayers=8, front_layers=6, rear_layers=2, subword='omarmomen/ptb_filtered_lowcase_bpe_tokenizer_8', n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=4444, nonmono=5, cuda=True, log_interval=100, save='trained_models/subword_structformer_in_parser_4444_62.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 37449060
Model architecture: StructFormer_In_Parser(
  (transformer_front): Transformer_Front(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(8000, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-5): 6 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
  (transformer_rear): Transformer_Rear(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(8000, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-1): 2 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (output_layer): Linear(in_features=512, out_features=8000, bias=True)
  )
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  269 batches | lr 0.00030 | ms/batch 243.93 | loss  7.74 | ppl  2306.93 
| epoch   1 |   200/  269 batches | lr 0.00030 | ms/batch 232.68 | loss  7.39 | ppl  1619.45 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 64.80s | valid loss  7.07 | valid ppl  1176.55 | valid bpc   10.200
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  269 batches | lr 0.00030 | ms/batch 240.79 | loss  7.30 | ppl  1479.55 
| epoch   2 |   200/  269 batches | lr 0.00030 | ms/batch 226.55 | loss  7.15 | ppl  1275.99 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 63.87s | valid loss  6.79 | valid ppl   892.47 | valid bpc    9.802
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  269 batches | lr 0.00030 | ms/batch 240.20 | loss  6.94 | ppl  1030.38 
| epoch   3 |   200/  269 batches | lr 0.00030 | ms/batch 226.47 | loss  6.61 | ppl   743.15 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 63.87s | valid loss  6.14 | valid ppl   462.63 | valid bpc    8.854
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  269 batches | lr 0.00030 | ms/batch 240.56 | loss  6.30 | ppl   544.81 
| epoch   4 |   200/  269 batches | lr 0.00030 | ms/batch 226.70 | loss  6.08 | ppl   438.88 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 63.90s | valid loss  5.75 | valid ppl   314.60 | valid bpc    8.297
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  269 batches | lr 0.00030 | ms/batch 240.06 | loss  5.93 | ppl   377.65 
| epoch   5 |   200/  269 batches | lr 0.00030 | ms/batch 226.95 | loss  5.82 | ppl   336.05 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 63.89s | valid loss  5.54 | valid ppl   255.07 | valid bpc    7.995
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  269 batches | lr 0.00030 | ms/batch 241.03 | loss  5.72 | ppl   306.23 
| epoch   6 |   200/  269 batches | lr 0.00030 | ms/batch 225.74 | loss  5.61 | ppl   272.68 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 63.89s | valid loss  5.40 | valid ppl   220.41 | valid bpc    7.784
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  269 batches | lr 0.00030 | ms/batch 240.73 | loss  5.54 | ppl   255.81 
| epoch   7 |   200/  269 batches | lr 0.00030 | ms/batch 226.45 | loss  5.46 | ppl   236.01 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 63.87s | valid loss  5.25 | valid ppl   190.75 | valid bpc    7.576
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  269 batches | lr 0.00030 | ms/batch 208.32 | loss  5.41 | ppl   224.19 
| epoch   8 |   200/  269 batches | lr 0.00030 | ms/batch 132.36 | loss  5.31 | ppl   202.12 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 41.44s | valid loss  5.16 | valid ppl   173.67 | valid bpc    7.440
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 8.0%
| epoch   9 |   100/  269 batches | lr 0.00030 | ms/batch 101.75 | loss  5.29 | ppl   197.46 
| epoch   9 |   200/  269 batches | lr 0.00030 | ms/batch 94.13 | loss  5.21 | ppl   182.91 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 26.03s | valid loss  5.01 | valid ppl   149.99 | valid bpc    7.229
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  269 batches | lr 0.00030 | ms/batch 74.68 | loss  5.17 | ppl   176.48 
| epoch  10 |   200/  269 batches | lr 0.00030 | ms/batch 73.05 | loss  5.13 | ppl   168.56 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 20.20s | valid loss  4.93 | valid ppl   138.56 | valid bpc    7.114
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  269 batches | lr 0.00030 | ms/batch 74.47 | loss  5.08 | ppl   160.47 
| epoch  11 |   200/  269 batches | lr 0.00030 | ms/batch 125.82 | loss  5.01 | ppl   149.79 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 36.82s | valid loss  4.91 | valid ppl   135.05 | valid bpc    7.077
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  269 batches | lr 0.00030 | ms/batch 245.53 | loss  4.99 | ppl   146.93 
| epoch  12 |   200/  269 batches | lr 0.00030 | ms/batch 222.55 | loss  4.94 | ppl   140.14 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 63.14s | valid loss  4.81 | valid ppl   122.74 | valid bpc    6.939
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 12.0%
| epoch  13 |   100/  269 batches | lr 0.00030 | ms/batch 246.83 | loss  4.90 | ppl   134.34 
| epoch  13 |   200/  269 batches | lr 0.00030 | ms/batch 222.13 | loss  4.84 | ppl   126.20 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 63.16s | valid loss  4.69 | valid ppl   108.73 | valid bpc    6.765
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 13.0%
| epoch  14 |   100/  269 batches | lr 0.00030 | ms/batch 245.75 | loss  4.82 | ppl   123.44 
| epoch  14 |   200/  269 batches | lr 0.00030 | ms/batch 223.39 | loss  4.76 | ppl   116.55 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 63.18s | valid loss  4.67 | valid ppl   106.17 | valid bpc    6.730
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  269 batches | lr 0.00030 | ms/batch 245.65 | loss  4.74 | ppl   114.69 
| epoch  15 |   200/  269 batches | lr 0.00030 | ms/batch 223.62 | loss  4.67 | ppl   107.10 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 63.16s | valid loss  4.62 | valid ppl   101.05 | valid bpc    6.659
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 15.0%
| epoch  16 |   100/  269 batches | lr 0.00030 | ms/batch 246.64 | loss  4.68 | ppl   107.39 
| epoch  16 |   200/  269 batches | lr 0.00030 | ms/batch 223.23 | loss  4.62 | ppl   101.49 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 63.19s | valid loss  4.57 | valid ppl    96.47 | valid bpc    6.592
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 16.0%
| epoch  17 |   100/  269 batches | lr 0.00030 | ms/batch 245.73 | loss  4.62 | ppl   101.35 
| epoch  17 |   200/  269 batches | lr 0.00030 | ms/batch 224.04 | loss  4.54 | ppl    93.77 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 63.42s | valid loss  4.48 | valid ppl    88.14 | valid bpc    6.462
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 17.0%
| epoch  18 |   100/  269 batches | lr 0.00030 | ms/batch 246.02 | loss  4.51 | ppl    90.79 
| epoch  18 |   200/  269 batches | lr 0.00030 | ms/batch 222.47 | loss  4.51 | ppl    91.04 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 64.14s | valid loss  4.42 | valid ppl    82.87 | valid bpc    6.373
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 18.0%
| epoch  19 |   100/  269 batches | lr 0.00030 | ms/batch 239.88 | loss  4.49 | ppl    89.16 
| epoch  19 |   200/  269 batches | lr 0.00030 | ms/batch 223.16 | loss  4.40 | ppl    81.71 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 63.38s | valid loss  4.42 | valid ppl    83.19 | valid bpc    6.378
-----------------------------------------------------------------------------------------
PROGRESS: 19.0%
| epoch  20 |   100/  269 batches | lr 0.00030 | ms/batch 236.36 | loss  4.37 | ppl    79.09 
| epoch  20 |   200/  269 batches | lr 0.00030 | ms/batch 232.09 | loss  4.35 | ppl    77.76 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 63.24s | valid loss  4.30 | valid ppl    73.88 | valid bpc    6.207
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 20.0%
| epoch  21 |   100/  269 batches | lr 0.00030 | ms/batch 237.40 | loss  4.34 | ppl    76.82 
| epoch  21 |   200/  269 batches | lr 0.00030 | ms/batch 231.59 | loss  4.28 | ppl    72.53 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 63.21s | valid loss  4.32 | valid ppl    75.39 | valid bpc    6.236
-----------------------------------------------------------------------------------------
PROGRESS: 21.0%
| epoch  22 |   100/  269 batches | lr 0.00030 | ms/batch 237.02 | loss  4.24 | ppl    69.54 
| epoch  22 |   200/  269 batches | lr 0.00030 | ms/batch 232.29 | loss  4.26 | ppl    71.03 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 63.21s | valid loss  4.26 | valid ppl    70.89 | valid bpc    6.148
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 22.0%
| epoch  23 |   100/  269 batches | lr 0.00030 | ms/batch 236.97 | loss  4.24 | ppl    69.07 
| epoch  23 |   200/  269 batches | lr 0.00030 | ms/batch 231.38 | loss  4.18 | ppl    65.08 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 63.19s | valid loss  4.21 | valid ppl    67.45 | valid bpc    6.076
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 23.0%
| epoch  24 |   100/  269 batches | lr 0.00030 | ms/batch 237.15 | loss  4.14 | ppl    63.04 
| epoch  24 |   200/  269 batches | lr 0.00030 | ms/batch 232.13 | loss  4.15 | ppl    63.56 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 63.17s | valid loss  4.21 | valid ppl    67.45 | valid bpc    6.076
-----------------------------------------------------------------------------------------
PROGRESS: 24.0%
| epoch  25 |   100/  269 batches | lr 0.00030 | ms/batch 237.85 | loss  4.11 | ppl    60.88 
| epoch  25 |   200/  269 batches | lr 0.00030 | ms/batch 231.70 | loss  4.11 | ppl    60.71 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 63.21s | valid loss  4.22 | valid ppl    67.83 | valid bpc    6.084
-----------------------------------------------------------------------------------------
PROGRESS: 25.0%
| epoch  26 |   100/  269 batches | lr 0.00030 | ms/batch 240.26 | loss  4.08 | ppl    59.32 
| epoch  26 |   200/  269 batches | lr 0.00030 | ms/batch 230.25 | loss  4.03 | ppl    56.33 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 63.85s | valid loss  4.15 | valid ppl    63.69 | valid bpc    5.993
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 26.0%
| epoch  27 |   100/  269 batches | lr 0.00030 | ms/batch 243.89 | loss  4.01 | ppl    55.30 
| epoch  27 |   200/  269 batches | lr 0.00030 | ms/batch 226.82 | loss  3.96 | ppl    52.57 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 64.12s | valid loss  4.14 | valid ppl    62.74 | valid bpc    5.971
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 27.0%
| epoch  28 |   100/  269 batches | lr 0.00030 | ms/batch 241.04 | loss  3.98 | ppl    53.51 
| epoch  28 |   200/  269 batches | lr 0.00030 | ms/batch 225.09 | loss  3.94 | ppl    51.51 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 63.71s | valid loss  4.15 | valid ppl    63.61 | valid bpc    5.991
-----------------------------------------------------------------------------------------
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  269 batches | lr 0.00030 | ms/batch 237.60 | loss  3.93 | ppl    50.72 
| epoch  29 |   200/  269 batches | lr 0.00030 | ms/batch 221.84 | loss  3.89 | ppl    48.87 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 63.07s | valid loss  4.08 | valid ppl    59.38 | valid bpc    5.892
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  269 batches | lr 0.00030 | ms/batch 237.74 | loss  3.88 | ppl    48.66 
| epoch  30 |   200/  269 batches | lr 0.00030 | ms/batch 222.27 | loss  3.85 | ppl    47.02 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 63.22s | valid loss  4.08 | valid ppl    59.07 | valid bpc    5.884
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 30.0%
| epoch  31 |   100/  269 batches | lr 0.00030 | ms/batch 237.46 | loss  3.84 | ppl    46.57 
| epoch  31 |   200/  269 batches | lr 0.00030 | ms/batch 222.18 | loss  3.82 | ppl    45.68 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 63.21s | valid loss  4.07 | valid ppl    58.52 | valid bpc    5.871
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 31.0%
| epoch  32 |   100/  269 batches | lr 0.00030 | ms/batch 237.51 | loss  3.79 | ppl    44.45 
| epoch  32 |   200/  269 batches | lr 0.00030 | ms/batch 222.51 | loss  3.78 | ppl    43.76 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 63.20s | valid loss  4.04 | valid ppl    56.86 | valid bpc    5.829
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 32.0%
| epoch  33 |   100/  269 batches | lr 0.00030 | ms/batch 238.14 | loss  3.75 | ppl    42.55 
| epoch  33 |   200/  269 batches | lr 0.00030 | ms/batch 225.23 | loss  3.77 | ppl    43.25 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 63.51s | valid loss  3.94 | valid ppl    51.63 | valid bpc    5.690
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 33.0%
| epoch  34 |   100/  269 batches | lr 0.00030 | ms/batch 237.89 | loss  3.73 | ppl    41.73 
| epoch  34 |   200/  269 batches | lr 0.00030 | ms/batch 222.51 | loss  3.72 | ppl    41.21 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 63.18s | valid loss  4.01 | valid ppl    55.15 | valid bpc    5.785
-----------------------------------------------------------------------------------------
PROGRESS: 34.0%
| epoch  35 |   100/  269 batches | lr 0.00030 | ms/batch 237.97 | loss  3.68 | ppl    39.84 
| epoch  35 |   200/  269 batches | lr 0.00030 | ms/batch 226.12 | loss  3.68 | ppl    39.77 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 63.54s | valid loss  3.99 | valid ppl    54.07 | valid bpc    5.757
-----------------------------------------------------------------------------------------
PROGRESS: 35.0%
| epoch  36 |   100/  269 batches | lr 0.00030 | ms/batch 240.58 | loss  3.67 | ppl    39.06 
| epoch  36 |   200/  269 batches | lr 0.00030 | ms/batch 231.43 | loss  3.64 | ppl    37.91 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 63.57s | valid loss  4.01 | valid ppl    54.99 | valid bpc    5.781
-----------------------------------------------------------------------------------------
PROGRESS: 36.0%
| epoch  37 |   100/  269 batches | lr 0.00015 | ms/batch 236.98 | loss  3.59 | ppl    36.10 
| epoch  37 |   200/  269 batches | lr 0.00015 | ms/batch 232.00 | loss  3.52 | ppl    33.65 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 63.23s | valid loss  3.92 | valid ppl    50.29 | valid bpc    5.652
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 37.0%
| epoch  38 |   100/  269 batches | lr 0.00015 | ms/batch 240.36 | loss  3.49 | ppl    32.83 
| epoch  38 |   200/  269 batches | lr 0.00015 | ms/batch 231.95 | loss  3.50 | ppl    32.95 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 63.57s | valid loss  3.92 | valid ppl    50.62 | valid bpc    5.662
-----------------------------------------------------------------------------------------
PROGRESS: 38.0%
| epoch  39 |   100/  269 batches | lr 0.00015 | ms/batch 243.51 | loss  3.47 | ppl    32.21 
| epoch  39 |   200/  269 batches | lr 0.00015 | ms/batch 225.70 | loss  3.46 | ppl    31.75 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 63.52s | valid loss  3.90 | valid ppl    49.57 | valid bpc    5.631
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 39.0%
| epoch  40 |   100/  269 batches | lr 0.00015 | ms/batch 246.35 | loss  3.45 | ppl    31.63 
| epoch  40 |   200/  269 batches | lr 0.00015 | ms/batch 225.51 | loss  3.44 | ppl    31.09 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 63.55s | valid loss  3.90 | valid ppl    49.64 | valid bpc    5.633
-----------------------------------------------------------------------------------------
PROGRESS: 40.0%
| epoch  41 |   100/  269 batches | lr 0.00015 | ms/batch 246.77 | loss  3.42 | ppl    30.60 
| epoch  41 |   200/  269 batches | lr 0.00015 | ms/batch 223.42 | loss  3.42 | ppl    30.57 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 63.86s | valid loss  3.84 | valid ppl    46.54 | valid bpc    5.541
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 41.0%
| epoch  42 |   100/  269 batches | lr 0.00015 | ms/batch 244.52 | loss  3.40 | ppl    29.94 
| epoch  42 |   200/  269 batches | lr 0.00015 | ms/batch 225.93 | loss  3.39 | ppl    29.77 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 64.28s | valid loss  3.88 | valid ppl    48.53 | valid bpc    5.601
-----------------------------------------------------------------------------------------
PROGRESS: 42.0%
| epoch  43 |   100/  269 batches | lr 0.00015 | ms/batch 240.75 | loss  3.39 | ppl    29.75 
| epoch  43 |   200/  269 batches | lr 0.00015 | ms/batch 222.55 | loss  3.38 | ppl    29.39 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 63.51s | valid loss  3.81 | valid ppl    45.33 | valid bpc    5.502
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 43.0%
| epoch  44 |   100/  269 batches | lr 0.00015 | ms/batch 237.99 | loss  3.37 | ppl    29.12 
| epoch  44 |   200/  269 batches | lr 0.00015 | ms/batch 223.01 | loss  3.33 | ppl    27.98 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 63.21s | valid loss  3.86 | valid ppl    47.64 | valid bpc    5.574
-----------------------------------------------------------------------------------------
PROGRESS: 44.0%
| epoch  45 |   100/  269 batches | lr 0.00015 | ms/batch 237.26 | loss  3.36 | ppl    28.71 
| epoch  45 |   200/  269 batches | lr 0.00015 | ms/batch 222.97 | loss  3.34 | ppl    28.08 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 63.19s | valid loss  3.84 | valid ppl    46.42 | valid bpc    5.537
-----------------------------------------------------------------------------------------
PROGRESS: 45.0%
| epoch  46 |   100/  269 batches | lr 0.00015 | ms/batch 238.04 | loss  3.31 | ppl    27.36 
| epoch  46 |   200/  269 batches | lr 0.00015 | ms/batch 226.17 | loss  3.31 | ppl    27.48 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 63.56s | valid loss  3.85 | valid ppl    47.17 | valid bpc    5.560
-----------------------------------------------------------------------------------------
PROGRESS: 46.0%
| epoch  47 |   100/  269 batches | lr 0.00007 | ms/batch 241.20 | loss  3.27 | ppl    26.20 
| epoch  47 |   200/  269 batches | lr 0.00007 | ms/batch 226.60 | loss  3.24 | ppl    25.63 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 63.87s | valid loss  3.91 | valid ppl    49.74 | valid bpc    5.636
-----------------------------------------------------------------------------------------
PROGRESS: 47.0%
| epoch  48 |   100/  269 batches | lr 0.00007 | ms/batch 240.75 | loss  3.23 | ppl    25.32 
| epoch  48 |   200/  269 batches | lr 0.00007 | ms/batch 225.82 | loss  3.22 | ppl    25.11 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 63.91s | valid loss  3.79 | valid ppl    44.18 | valid bpc    5.465
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 48.0%
| epoch  49 |   100/  269 batches | lr 0.00007 | ms/batch 240.34 | loss  3.26 | ppl    26.07 
| epoch  49 |   200/  269 batches | lr 0.00007 | ms/batch 223.79 | loss  3.22 | ppl    24.92 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 63.48s | valid loss  3.79 | valid ppl    44.42 | valid bpc    5.473
-----------------------------------------------------------------------------------------
PROGRESS: 49.0%
| epoch  50 |   100/  269 batches | lr 0.00007 | ms/batch 238.33 | loss  3.23 | ppl    25.16 
| epoch  50 |   200/  269 batches | lr 0.00007 | ms/batch 231.89 | loss  3.19 | ppl    24.38 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 63.53s | valid loss  3.81 | valid ppl    45.19 | valid bpc    5.498
-----------------------------------------------------------------------------------------
PROGRESS: 50.0%
| epoch  51 |   100/  269 batches | lr 0.00007 | ms/batch 247.29 | loss  3.22 | ppl    25.13 
| epoch  51 |   200/  269 batches | lr 0.00007 | ms/batch 222.07 | loss  3.18 | ppl    24.15 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 63.54s | valid loss  3.81 | valid ppl    45.08 | valid bpc    5.494
-----------------------------------------------------------------------------------------
PROGRESS: 51.0%
| epoch  52 |   100/  269 batches | lr 0.00004 | ms/batch 246.78 | loss  3.21 | ppl    24.67 
| epoch  52 |   200/  269 batches | lr 0.00004 | ms/batch 226.80 | loss  3.15 | ppl    23.41 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 63.57s | valid loss  3.83 | valid ppl    46.02 | valid bpc    5.524
-----------------------------------------------------------------------------------------
PROGRESS: 52.0%
| epoch  53 |   100/  269 batches | lr 0.00004 | ms/batch 247.05 | loss  3.19 | ppl    24.33 
| epoch  53 |   200/  269 batches | lr 0.00004 | ms/batch 226.02 | loss  3.13 | ppl    22.93 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 63.88s | valid loss  3.85 | valid ppl    46.86 | valid bpc    5.550
-----------------------------------------------------------------------------------------
PROGRESS: 53.0%
| epoch  54 |   100/  269 batches | lr 0.00004 | ms/batch 246.92 | loss  3.15 | ppl    23.34 
| epoch  54 |   200/  269 batches | lr 0.00004 | ms/batch 226.72 | loss  3.13 | ppl    22.98 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 63.57s | valid loss  3.77 | valid ppl    43.49 | valid bpc    5.443
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 54.0%
| epoch  55 |   100/  269 batches | lr 0.00004 | ms/batch 246.97 | loss  3.15 | ppl    23.30 
| epoch  55 |   200/  269 batches | lr 0.00004 | ms/batch 222.12 | loss  3.14 | ppl    23.08 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 63.54s | valid loss  3.80 | valid ppl    44.49 | valid bpc    5.475
-----------------------------------------------------------------------------------------
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  269 batches | lr 0.00004 | ms/batch 246.08 | loss  3.16 | ppl    23.55 
| epoch  56 |   200/  269 batches | lr 0.00004 | ms/batch 226.29 | loss  3.13 | ppl    22.80 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 63.91s | valid loss  3.78 | valid ppl    43.85 | valid bpc    5.454
-----------------------------------------------------------------------------------------
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  269 batches | lr 0.00004 | ms/batch 246.90 | loss  3.15 | ppl    23.33 
| epoch  57 |   200/  269 batches | lr 0.00004 | ms/batch 222.82 | loss  3.12 | ppl    22.56 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 63.74s | valid loss  3.76 | valid ppl    43.01 | valid bpc    5.427
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  269 batches | lr 0.00004 | ms/batch 246.51 | loss  3.11 | ppl    22.45 
| epoch  58 |   200/  269 batches | lr 0.00004 | ms/batch 227.52 | loss  3.10 | ppl    22.27 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 63.99s | valid loss  3.79 | valid ppl    44.41 | valid bpc    5.473
-----------------------------------------------------------------------------------------
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  269 batches | lr 0.00004 | ms/batch 241.71 | loss  3.12 | ppl    22.70 
| epoch  59 |   200/  269 batches | lr 0.00004 | ms/batch 232.48 | loss  3.10 | ppl    22.10 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 63.98s | valid loss  3.83 | valid ppl    46.09 | valid bpc    5.527
-----------------------------------------------------------------------------------------
PROGRESS: 59.0%
| epoch  60 |   100/  269 batches | lr 0.00004 | ms/batch 239.89 | loss  3.12 | ppl    22.64 
| epoch  60 |   200/  269 batches | lr 0.00004 | ms/batch 231.98 | loss  3.09 | ppl    22.01 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 63.92s | valid loss  3.82 | valid ppl    45.82 | valid bpc    5.518
-----------------------------------------------------------------------------------------
PROGRESS: 60.0%
| epoch  61 |   100/  269 batches | lr 0.00002 | ms/batch 240.16 | loss  3.10 | ppl    22.18 
| epoch  61 |   200/  269 batches | lr 0.00002 | ms/batch 233.59 | loss  3.10 | ppl    22.17 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 63.92s | valid loss  3.75 | valid ppl    42.50 | valid bpc    5.409
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 61.0%
| epoch  62 |   100/  269 batches | lr 0.00002 | ms/batch 236.55 | loss  3.10 | ppl    22.26 
| epoch  62 |   200/  269 batches | lr 0.00002 | ms/batch 233.39 | loss  3.09 | ppl    21.92 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 63.54s | valid loss  3.77 | valid ppl    43.30 | valid bpc    5.436
-----------------------------------------------------------------------------------------
PROGRESS: 62.0%
| epoch  63 |   100/  269 batches | lr 0.00002 | ms/batch 237.15 | loss  3.09 | ppl    21.90 
| epoch  63 |   200/  269 batches | lr 0.00002 | ms/batch 232.27 | loss  3.08 | ppl    21.83 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 63.53s | valid loss  3.76 | valid ppl    43.09 | valid bpc    5.429
-----------------------------------------------------------------------------------------
PROGRESS: 63.0%
| epoch  64 |   100/  269 batches | lr 0.00002 | ms/batch 238.06 | loss  3.10 | ppl    22.20 
| epoch  64 |   200/  269 batches | lr 0.00002 | ms/batch 231.89 | loss  3.06 | ppl    21.38 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 63.73s | valid loss  3.79 | valid ppl    44.14 | valid bpc    5.464
-----------------------------------------------------------------------------------------
PROGRESS: 64.0%
| epoch  65 |   100/  269 batches | lr 0.00001 | ms/batch 238.99 | loss  3.07 | ppl    21.47 
| epoch  65 |   200/  269 batches | lr 0.00001 | ms/batch 233.30 | loss  3.07 | ppl    21.49 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 64.38s | valid loss  3.83 | valid ppl    45.99 | valid bpc    5.523
-----------------------------------------------------------------------------------------
PROGRESS: 65.0%
| epoch  66 |   100/  269 batches | lr 0.00001 | ms/batch 230.25 | loss  3.07 | ppl    21.50 
| epoch  66 |   200/  269 batches | lr 0.00001 | ms/batch 233.02 | loss  3.08 | ppl    21.75 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 63.50s | valid loss  3.82 | valid ppl    45.53 | valid bpc    5.509
-----------------------------------------------------------------------------------------
PROGRESS: 66.0%
| epoch  67 |   100/  269 batches | lr 0.00001 | ms/batch 235.03 | loss  3.09 | ppl    22.01 
| epoch  67 |   200/  269 batches | lr 0.00001 | ms/batch 232.38 | loss  3.04 | ppl    20.91 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 63.88s | valid loss  3.78 | valid ppl    43.81 | valid bpc    5.453
-----------------------------------------------------------------------------------------
PROGRESS: 67.0%
| epoch  68 |   100/  269 batches | lr 0.00000 | ms/batch 234.37 | loss  3.06 | ppl    21.35 
| epoch  68 |   200/  269 batches | lr 0.00000 | ms/batch 232.64 | loss  3.05 | ppl    21.16 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 63.90s | valid loss  3.82 | valid ppl    45.57 | valid bpc    5.510
-----------------------------------------------------------------------------------------
PROGRESS: 68.0%
| epoch  69 |   100/  269 batches | lr 0.00000 | ms/batch 235.94 | loss  3.07 | ppl    21.56 
| epoch  69 |   200/  269 batches | lr 0.00000 | ms/batch 231.11 | loss  3.04 | ppl    20.87 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 63.88s | valid loss  3.79 | valid ppl    44.22 | valid bpc    5.467
-----------------------------------------------------------------------------------------
PROGRESS: 69.0%
| epoch  70 |   100/  269 batches | lr 0.00000 | ms/batch 235.57 | loss  3.08 | ppl    21.84 
| epoch  70 |   200/  269 batches | lr 0.00000 | ms/batch 227.82 | loss  3.04 | ppl    20.98 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 63.56s | valid loss  3.79 | valid ppl    44.18 | valid bpc    5.465
-----------------------------------------------------------------------------------------
PROGRESS: 70.0%
| epoch  71 |   100/  269 batches | lr 0.00000 | ms/batch 240.33 | loss  3.08 | ppl    21.68 
| epoch  71 |   200/  269 batches | lr 0.00000 | ms/batch 226.64 | loss  3.03 | ppl    20.68 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 63.90s | valid loss  3.79 | valid ppl    44.04 | valid bpc    5.461
-----------------------------------------------------------------------------------------
PROGRESS: 71.0%
| epoch  72 |   100/  269 batches | lr 0.00000 | ms/batch 240.19 | loss  3.08 | ppl    21.66 
| epoch  72 |   200/  269 batches | lr 0.00000 | ms/batch 225.77 | loss  3.02 | ppl    20.44 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 63.92s | valid loss  3.81 | valid ppl    45.19 | valid bpc    5.498
-----------------------------------------------------------------------------------------
PROGRESS: 72.0%
| epoch  73 |   100/  269 batches | lr 0.00000 | ms/batch 242.01 | loss  3.08 | ppl    21.73 
| epoch  73 |   200/  269 batches | lr 0.00000 | ms/batch 225.95 | loss  3.03 | ppl    20.75 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 63.92s | valid loss  3.83 | valid ppl    45.92 | valid bpc    5.521
-----------------------------------------------------------------------------------------
PROGRESS: 73.0%
| epoch  74 |   100/  269 batches | lr 0.00000 | ms/batch 246.78 | loss  3.07 | ppl    21.49 
| epoch  74 |   200/  269 batches | lr 0.00000 | ms/batch 220.60 | loss  3.05 | ppl    21.11 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 63.96s | valid loss  3.84 | valid ppl    46.60 | valid bpc    5.542
-----------------------------------------------------------------------------------------
PROGRESS: 74.0%
| epoch  75 |   100/  269 batches | lr 0.00000 | ms/batch 247.09 | loss  3.08 | ppl    21.80 
| epoch  75 |   200/  269 batches | lr 0.00000 | ms/batch 220.02 | loss  3.04 | ppl    20.89 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 63.90s | valid loss  3.75 | valid ppl    42.49 | valid bpc    5.409
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 75.0%
| epoch  76 |   100/  269 batches | lr 0.00000 | ms/batch 247.84 | loss  3.08 | ppl    21.86 
| epoch  76 |   200/  269 batches | lr 0.00000 | ms/batch 215.88 | loss  3.05 | ppl    21.11 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 63.55s | valid loss  3.75 | valid ppl    42.48 | valid bpc    5.409
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 76.0%
| epoch  77 |   100/  269 batches | lr 0.00000 | ms/batch 247.50 | loss  3.09 | ppl    22.07 
| epoch  77 |   200/  269 batches | lr 0.00000 | ms/batch 219.45 | loss  3.06 | ppl    21.36 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 63.89s | valid loss  3.80 | valid ppl    44.62 | valid bpc    5.480
-----------------------------------------------------------------------------------------
PROGRESS: 77.0%
| epoch  78 |   100/  269 batches | lr 0.00000 | ms/batch 246.38 | loss  3.09 | ppl    21.90 
| epoch  78 |   200/  269 batches | lr 0.00000 | ms/batch 217.84 | loss  3.03 | ppl    20.73 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 63.55s | valid loss  3.77 | valid ppl    43.49 | valid bpc    5.443
-----------------------------------------------------------------------------------------
PROGRESS: 78.0%
| epoch  79 |   100/  269 batches | lr 0.00000 | ms/batch 245.80 | loss  3.09 | ppl    21.88 
| epoch  79 |   200/  269 batches | lr 0.00000 | ms/batch 221.78 | loss  3.05 | ppl    21.02 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 63.89s | valid loss  3.81 | valid ppl    44.94 | valid bpc    5.490
-----------------------------------------------------------------------------------------
PROGRESS: 79.0%
| epoch  80 |   100/  269 batches | lr 0.00000 | ms/batch 245.79 | loss  3.06 | ppl    21.40 
| epoch  80 |   200/  269 batches | lr 0.00000 | ms/batch 220.59 | loss  3.07 | ppl    21.44 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 63.93s | valid loss  3.80 | valid ppl    44.59 | valid bpc    5.479
-----------------------------------------------------------------------------------------
PROGRESS: 80.0%
| epoch  81 |   100/  269 batches | lr 0.00000 | ms/batch 245.69 | loss  3.05 | ppl    21.21 
| epoch  81 |   200/  269 batches | lr 0.00000 | ms/batch 221.58 | loss  3.05 | ppl    21.06 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 63.90s | valid loss  3.75 | valid ppl    42.57 | valid bpc    5.412
-----------------------------------------------------------------------------------------
PROGRESS: 81.0%
| epoch  82 |   100/  269 batches | lr 0.00000 | ms/batch 246.49 | loss  3.08 | ppl    21.82 
| epoch  82 |   200/  269 batches | lr 0.00000 | ms/batch 230.81 | loss  3.03 | ppl    20.67 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 63.35s | valid loss  3.77 | valid ppl    43.51 | valid bpc    5.443
-----------------------------------------------------------------------------------------
PROGRESS: 82.0%
| epoch  83 |   100/  269 batches | lr 0.00000 | ms/batch 246.27 | loss  3.08 | ppl    21.75 
| epoch  83 |   200/  269 batches | lr 0.00000 | ms/batch 232.93 | loss  3.05 | ppl    21.07 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 63.88s | valid loss  3.77 | valid ppl    43.29 | valid bpc    5.436
-----------------------------------------------------------------------------------------
PROGRESS: 83.0%
| epoch  84 |   100/  269 batches | lr 0.00000 | ms/batch 246.03 | loss  3.07 | ppl    21.50 
| epoch  84 |   200/  269 batches | lr 0.00000 | ms/batch 232.68 | loss  3.03 | ppl    20.67 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 63.89s | valid loss  3.78 | valid ppl    43.71 | valid bpc    5.450
-----------------------------------------------------------------------------------------
PROGRESS: 84.0%
| epoch  85 |   100/  269 batches | lr 0.00000 | ms/batch 246.37 | loss  3.07 | ppl    21.48 
| epoch  85 |   200/  269 batches | lr 0.00000 | ms/batch 232.03 | loss  3.05 | ppl    21.03 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 63.94s | valid loss  3.75 | valid ppl    42.57 | valid bpc    5.412
-----------------------------------------------------------------------------------------
PROGRESS: 85.0%
| epoch  86 |   100/  269 batches | lr 0.00000 | ms/batch 245.79 | loss  3.07 | ppl    21.57 
| epoch  86 |   200/  269 batches | lr 0.00000 | ms/batch 233.21 | loss  3.02 | ppl    20.52 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 63.91s | valid loss  3.81 | valid ppl    45.25 | valid bpc    5.500
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  269 batches | lr 0.00000 | ms/batch 246.68 | loss  3.06 | ppl    21.41 
| epoch  87 |   200/  269 batches | lr 0.00000 | ms/batch 231.74 | loss  3.05 | ppl    21.08 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 63.96s | valid loss  3.79 | valid ppl    44.28 | valid bpc    5.469
-----------------------------------------------------------------------------------------
PROGRESS: 87.0%
| epoch  88 |   100/  269 batches | lr 0.00000 | ms/batch 245.74 | loss  3.06 | ppl    21.43 
| epoch  88 |   200/  269 batches | lr 0.00000 | ms/batch 232.61 | loss  3.06 | ppl    21.23 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 64.35s | valid loss  3.82 | valid ppl    45.79 | valid bpc    5.517
-----------------------------------------------------------------------------------------
PROGRESS: 88.0%
| epoch  89 |   100/  269 batches | lr 0.00000 | ms/batch 242.62 | loss  3.08 | ppl    21.69 
| epoch  89 |   200/  269 batches | lr 0.00000 | ms/batch 232.19 | loss  3.05 | ppl    21.01 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 64.43s | valid loss  3.76 | valid ppl    42.83 | valid bpc    5.421
-----------------------------------------------------------------------------------------
PROGRESS: 89.0%
| epoch  90 |   100/  269 batches | lr 0.00000 | ms/batch 236.59 | loss  3.05 | ppl    21.16 
| epoch  90 |   200/  269 batches | lr 0.00000 | ms/batch 232.89 | loss  3.03 | ppl    20.73 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 64.12s | valid loss  3.82 | valid ppl    45.70 | valid bpc    5.514
-----------------------------------------------------------------------------------------
PROGRESS: 90.0%
| epoch  91 |   100/  269 batches | lr 0.00000 | ms/batch 230.47 | loss  3.06 | ppl    21.31 
| epoch  91 |   200/  269 batches | lr 0.00000 | ms/batch 232.29 | loss  3.06 | ppl    21.23 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 63.57s | valid loss  3.79 | valid ppl    44.10 | valid bpc    5.463
-----------------------------------------------------------------------------------------
PROGRESS: 91.0%
| epoch  92 |   100/  269 batches | lr 0.00000 | ms/batch 235.61 | loss  3.07 | ppl    21.51 
| epoch  92 |   200/  269 batches | lr 0.00000 | ms/batch 231.50 | loss  3.03 | ppl    20.60 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 63.92s | valid loss  3.79 | valid ppl    44.08 | valid bpc    5.462
-----------------------------------------------------------------------------------------
PROGRESS: 92.0%
| epoch  93 |   100/  269 batches | lr 0.00000 | ms/batch 233.75 | loss  3.08 | ppl    21.67 
| epoch  93 |   200/  269 batches | lr 0.00000 | ms/batch 232.57 | loss  3.01 | ppl    20.26 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 63.90s | valid loss  3.78 | valid ppl    43.61 | valid bpc    5.447
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  269 batches | lr 0.00000 | ms/batch 234.98 | loss  3.07 | ppl    21.45 
| epoch  94 |   200/  269 batches | lr 0.00000 | ms/batch 230.99 | loss  3.02 | ppl    20.43 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 63.90s | valid loss  3.75 | valid ppl    42.44 | valid bpc    5.407
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 94.0%
| epoch  95 |   100/  269 batches | lr 0.00000 | ms/batch 234.47 | loss  3.09 | ppl    22.04 
| epoch  95 |   200/  269 batches | lr 0.00000 | ms/batch 232.63 | loss  3.03 | ppl    20.70 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 63.90s | valid loss  3.77 | valid ppl    43.38 | valid bpc    5.439
-----------------------------------------------------------------------------------------
PROGRESS: 95.0%
| epoch  96 |   100/  269 batches | lr 0.00000 | ms/batch 235.83 | loss  3.08 | ppl    21.77 
| epoch  96 |   200/  269 batches | lr 0.00000 | ms/batch 231.24 | loss  3.03 | ppl    20.70 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 63.93s | valid loss  3.80 | valid ppl    44.51 | valid bpc    5.476
-----------------------------------------------------------------------------------------
PROGRESS: 96.0%
| epoch  97 |   100/  269 batches | lr 0.00000 | ms/batch 233.98 | loss  3.06 | ppl    21.31 
| epoch  97 |   200/  269 batches | lr 0.00000 | ms/batch 231.64 | loss  3.04 | ppl    20.81 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 63.84s | valid loss  3.81 | valid ppl    45.29 | valid bpc    5.501
-----------------------------------------------------------------------------------------
PROGRESS: 97.0%
| epoch  98 |   100/  269 batches | lr 0.00000 | ms/batch 237.80 | loss  3.07 | ppl    21.52 
| epoch  98 |   200/  269 batches | lr 0.00000 | ms/batch 229.46 | loss  3.06 | ppl    21.24 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 63.90s | valid loss  3.76 | valid ppl    42.99 | valid bpc    5.426
-----------------------------------------------------------------------------------------
PROGRESS: 98.0%
| epoch  99 |   100/  269 batches | lr 0.00000 | ms/batch 240.53 | loss  3.06 | ppl    21.40 
| epoch  99 |   200/  269 batches | lr 0.00000 | ms/batch 226.24 | loss  3.04 | ppl    20.88 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 63.94s | valid loss  3.76 | valid ppl    43.07 | valid bpc    5.429
-----------------------------------------------------------------------------------------
PROGRESS: 99.0%
| epoch 100 |   100/  269 batches | lr 0.00000 | ms/batch 240.55 | loss  3.06 | ppl    21.30 
| epoch 100 |   200/  269 batches | lr 0.00000 | ms/batch 226.91 | loss  3.06 | ppl    21.24 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 63.90s | valid loss  3.78 | valid ppl    43.83 | valid bpc    5.454
-----------------------------------------------------------------------------------------
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  3.92 | test ppl    50.22 | test bpc    5.650
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.4632, Mean Reca: 0.6510, Mean F1: 0.5370, Mean Subword_Reca: 0.8484
-----------------------------------------------------------------------------------------
=========================================================================================
Loading dataset...
Using subword tokenizer...
Number of tokens:  8000
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer_in_parser', nhid=512, nlayers=8, front_layers=6, rear_layers=2, subword='omarmomen/ptb_filtered_lowcase_bpe_tokenizer_8', n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=5555, nonmono=5, cuda=True, log_interval=100, save='trained_models/subword_structformer_in_parser_5555_62.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 37449060
Model architecture: StructFormer_In_Parser(
  (transformer_front): Transformer_Front(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(8000, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-5): 6 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
  (transformer_rear): Transformer_Rear(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(8000, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-1): 2 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (output_layer): Linear(in_features=512, out_features=8000, bias=True)
  )
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  269 batches | lr 0.00030 | ms/batch 249.78 | loss  7.76 | ppl  2337.99 
| epoch   1 |   200/  269 batches | lr 0.00030 | ms/batch 231.97 | loss  7.37 | ppl  1582.35 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 64.74s | valid loss  7.12 | valid ppl  1233.46 | valid bpc   10.269
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  269 batches | lr 0.00030 | ms/batch 240.75 | loss  7.32 | ppl  1508.37 
| epoch   2 |   200/  269 batches | lr 0.00030 | ms/batch 232.49 | loss  7.19 | ppl  1319.94 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 63.90s | valid loss  6.89 | valid ppl   978.97 | valid bpc    9.935
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  269 batches | lr 0.00030 | ms/batch 239.84 | loss  7.11 | ppl  1227.23 
| epoch   3 |   200/  269 batches | lr 0.00030 | ms/batch 233.02 | loss  6.86 | ppl   953.16 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 63.90s | valid loss  6.41 | valid ppl   607.15 | valid bpc    9.246
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  269 batches | lr 0.00030 | ms/batch 241.74 | loss  6.49 | ppl   658.20 
| epoch   4 |   200/  269 batches | lr 0.00030 | ms/batch 231.46 | loss  6.25 | ppl   517.70 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 64.11s | valid loss  5.86 | valid ppl   350.44 | valid bpc    8.453
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  269 batches | lr 0.00030 | ms/batch 240.24 | loss  6.00 | ppl   402.43 
| epoch   5 |   200/  269 batches | lr 0.00030 | ms/batch 232.54 | loss  5.87 | ppl   352.48 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 64.38s | valid loss  5.56 | valid ppl   258.63 | valid bpc    8.015
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  269 batches | lr 0.00030 | ms/batch 240.55 | loss  5.74 | ppl   311.40 
| epoch   6 |   200/  269 batches | lr 0.00030 | ms/batch 232.19 | loss  5.65 | ppl   284.55 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 64.46s | valid loss  5.41 | valid ppl   224.18 | valid bpc    7.809
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  269 batches | lr 0.00030 | ms/batch 240.38 | loss  5.55 | ppl   257.95 
| epoch   7 |   200/  269 batches | lr 0.00030 | ms/batch 233.12 | loss  5.48 | ppl   240.83 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 64.50s | valid loss  5.27 | valid ppl   193.52 | valid bpc    7.596
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  269 batches | lr 0.00030 | ms/batch 240.14 | loss  5.43 | ppl   228.24 
| epoch   8 |   200/  269 batches | lr 0.00030 | ms/batch 233.29 | loss  5.34 | ppl   209.30 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 64.49s | valid loss  5.12 | valid ppl   168.06 | valid bpc    7.393
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 8.0%
| epoch   9 |   100/  269 batches | lr 0.00030 | ms/batch 240.52 | loss  5.31 | ppl   203.03 
| epoch   9 |   200/  269 batches | lr 0.00030 | ms/batch 233.03 | loss  5.24 | ppl   187.76 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 64.44s | valid loss  5.05 | valid ppl   156.37 | valid bpc    7.289
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  269 batches | lr 0.00030 | ms/batch 239.00 | loss  5.19 | ppl   179.77 
| epoch  10 |   200/  269 batches | lr 0.00030 | ms/batch 231.63 | loss  5.11 | ppl   165.56 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 64.31s | valid loss  4.94 | valid ppl   139.08 | valid bpc    7.120
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  269 batches | lr 0.00030 | ms/batch 235.86 | loss  5.06 | ppl   158.23 
| epoch  11 |   200/  269 batches | lr 0.00030 | ms/batch 232.79 | loss  5.03 | ppl   152.30 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 64.05s | valid loss  4.83 | valid ppl   124.80 | valid bpc    6.964
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  269 batches | lr 0.00030 | ms/batch 166.25 | loss  4.98 | ppl   146.07 
| epoch  12 |   200/  269 batches | lr 0.00030 | ms/batch 165.59 | loss  4.94 | ppl   139.38 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 45.49s | valid loss  4.76 | valid ppl   116.87 | valid bpc    6.869
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 12.0%
| epoch  13 |   100/  269 batches | lr 0.00030 | ms/batch 167.97 | loss  4.93 | ppl   138.32 
| epoch  13 |   200/  269 batches | lr 0.00030 | ms/batch 94.99 | loss  4.83 | ppl   125.65 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 32.80s | valid loss  4.67 | valid ppl   106.36 | valid bpc    6.733
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 13.0%
| epoch  14 |   100/  269 batches | lr 0.00030 | ms/batch 91.02 | loss  4.81 | ppl   123.29 
| epoch  14 |   200/  269 batches | lr 0.00030 | ms/batch 88.54 | loss  4.76 | ppl   116.45 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 23.39s | valid loss  4.61 | valid ppl   100.43 | valid bpc    6.650
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  269 batches | lr 0.00030 | ms/batch 109.40 | loss  4.74 | ppl   114.14 
| epoch  15 |   200/  269 batches | lr 0.00030 | ms/batch 155.48 | loss  4.70 | ppl   109.48 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 38.89s | valid loss  4.58 | valid ppl    97.43 | valid bpc    6.606
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 15.0%
| epoch  16 |   100/  269 batches | lr 0.00030 | ms/batch 236.39 | loss  4.64 | ppl   104.06 
| epoch  16 |   200/  269 batches | lr 0.00030 | ms/batch 233.04 | loss  4.61 | ppl   100.79 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 63.15s | valid loss  4.49 | valid ppl    88.93 | valid bpc    6.475
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 16.0%
| epoch  17 |   100/  269 batches | lr 0.00030 | ms/batch 237.16 | loss  4.59 | ppl    98.45 
| epoch  17 |   200/  269 batches | lr 0.00030 | ms/batch 232.67 | loss  4.54 | ppl    93.95 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 64.10s | valid loss  4.49 | valid ppl    88.83 | valid bpc    6.473
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 17.0%
| epoch  18 |   100/  269 batches | lr 0.00030 | ms/batch 230.76 | loss  4.52 | ppl    92.05 
| epoch  18 |   200/  269 batches | lr 0.00030 | ms/batch 233.23 | loss  4.46 | ppl    86.11 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 63.58s | valid loss  4.44 | valid ppl    84.78 | valid bpc    6.406
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 18.0%
| epoch  19 |   100/  269 batches | lr 0.00030 | ms/batch 228.15 | loss  4.44 | ppl    84.58 
| epoch  19 |   200/  269 batches | lr 0.00030 | ms/batch 232.38 | loss  4.42 | ppl    83.48 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 63.21s | valid loss  4.38 | valid ppl    79.97 | valid bpc    6.321
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 19.0%
| epoch  20 |   100/  269 batches | lr 0.00030 | ms/batch 227.91 | loss  4.37 | ppl    79.40 
| epoch  20 |   200/  269 batches | lr 0.00030 | ms/batch 232.70 | loss  4.35 | ppl    77.78 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 63.24s | valid loss  4.31 | valid ppl    74.27 | valid bpc    6.215
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 20.0%
| epoch  21 |   100/  269 batches | lr 0.00030 | ms/batch 229.85 | loss  4.29 | ppl    73.15 
| epoch  21 |   200/  269 batches | lr 0.00030 | ms/batch 231.20 | loss  4.31 | ppl    74.22 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 63.18s | valid loss  4.30 | valid ppl    73.82 | valid bpc    6.206
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 21.0%
| epoch  22 |   100/  269 batches | lr 0.00030 | ms/batch 236.78 | loss  4.28 | ppl    71.96 
| epoch  22 |   200/  269 batches | lr 0.00030 | ms/batch 224.21 | loss  4.23 | ppl    68.60 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 63.30s | valid loss  4.27 | valid ppl    71.70 | valid bpc    6.164
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 22.0%
| epoch  23 |   100/  269 batches | lr 0.00030 | ms/batch 237.89 | loss  4.21 | ppl    67.46 
| epoch  23 |   200/  269 batches | lr 0.00030 | ms/batch 222.03 | loss  4.16 | ppl    64.23 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 63.21s | valid loss  4.24 | valid ppl    69.57 | valid bpc    6.120
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 23.0%
| epoch  24 |   100/  269 batches | lr 0.00030 | ms/batch 237.23 | loss  4.16 | ppl    63.89 
| epoch  24 |   200/  269 batches | lr 0.00030 | ms/batch 222.43 | loss  4.12 | ppl    61.62 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 63.19s | valid loss  4.20 | valid ppl    66.79 | valid bpc    6.062
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 24.0%
| epoch  25 |   100/  269 batches | lr 0.00030 | ms/batch 236.87 | loss  4.09 | ppl    59.61 
| epoch  25 |   200/  269 batches | lr 0.00030 | ms/batch 223.19 | loss  4.07 | ppl    58.64 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 63.22s | valid loss  4.21 | valid ppl    67.17 | valid bpc    6.070
-----------------------------------------------------------------------------------------
PROGRESS: 25.0%
| epoch  26 |   100/  269 batches | lr 0.00030 | ms/batch 238.00 | loss  4.07 | ppl    58.77 
| epoch  26 |   200/  269 batches | lr 0.00030 | ms/batch 222.89 | loss  4.02 | ppl    55.45 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 63.33s | valid loss  4.12 | valid ppl    61.74 | valid bpc    5.948
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 26.0%
| epoch  27 |   100/  269 batches | lr 0.00030 | ms/batch 246.43 | loss  4.00 | ppl    54.48 
| epoch  27 |   200/  269 batches | lr 0.00030 | ms/batch 213.65 | loss  3.97 | ppl    53.22 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 63.19s | valid loss  4.10 | valid ppl    60.34 | valid bpc    5.915
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 27.0%
| epoch  28 |   100/  269 batches | lr 0.00030 | ms/batch 246.30 | loss  3.96 | ppl    52.23 
| epoch  28 |   200/  269 batches | lr 0.00030 | ms/batch 213.94 | loss  3.92 | ppl    50.47 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 63.29s | valid loss  4.13 | valid ppl    61.99 | valid bpc    5.954
-----------------------------------------------------------------------------------------
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  269 batches | lr 0.00030 | ms/batch 245.20 | loss  3.90 | ppl    49.65 
| epoch  29 |   200/  269 batches | lr 0.00030 | ms/batch 213.03 | loss  3.91 | ppl    49.68 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 63.14s | valid loss  4.08 | valid ppl    59.11 | valid bpc    5.885
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  269 batches | lr 0.00030 | ms/batch 245.95 | loss  3.86 | ppl    47.69 
| epoch  30 |   200/  269 batches | lr 0.00030 | ms/batch 213.88 | loss  3.86 | ppl    47.45 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 63.22s | valid loss  4.05 | valid ppl    57.12 | valid bpc    5.836
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 30.0%
| epoch  31 |   100/  269 batches | lr 0.00030 | ms/batch 246.28 | loss  3.84 | ppl    46.43 
| epoch  31 |   200/  269 batches | lr 0.00030 | ms/batch 218.81 | loss  3.80 | ppl    44.91 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 63.21s | valid loss  4.03 | valid ppl    55.99 | valid bpc    5.807
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 31.0%
| epoch  32 |   100/  269 batches | lr 0.00030 | ms/batch 246.89 | loss  3.81 | ppl    45.17 
| epoch  32 |   200/  269 batches | lr 0.00030 | ms/batch 223.58 | loss  3.76 | ppl    43.00 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 63.23s | valid loss  4.06 | valid ppl    57.80 | valid bpc    5.853
-----------------------------------------------------------------------------------------
PROGRESS: 32.0%
| epoch  33 |   100/  269 batches | lr 0.00030 | ms/batch 247.01 | loss  3.75 | ppl    42.36 
| epoch  33 |   200/  269 batches | lr 0.00030 | ms/batch 223.09 | loss  3.74 | ppl    41.98 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 63.28s | valid loss  4.01 | valid ppl    55.06 | valid bpc    5.783
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 33.0%
| epoch  34 |   100/  269 batches | lr 0.00030 | ms/batch 246.92 | loss  3.74 | ppl    42.16 
| epoch  34 |   200/  269 batches | lr 0.00030 | ms/batch 228.11 | loss  3.70 | ppl    40.47 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 63.59s | valid loss  3.96 | valid ppl    52.56 | valid bpc    5.716
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 34.0%
| epoch  35 |   100/  269 batches | lr 0.00030 | ms/batch 246.48 | loss  3.67 | ppl    39.09 
| epoch  35 |   200/  269 batches | lr 0.00030 | ms/batch 232.31 | loss  3.66 | ppl    38.92 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 63.55s | valid loss  3.94 | valid ppl    51.23 | valid bpc    5.679
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 35.0%
| epoch  36 |   100/  269 batches | lr 0.00030 | ms/batch 246.75 | loss  3.62 | ppl    37.46 
| epoch  36 |   200/  269 batches | lr 0.00030 | ms/batch 231.96 | loss  3.64 | ppl    38.13 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 63.23s | valid loss  3.97 | valid ppl    52.90 | valid bpc    5.725
-----------------------------------------------------------------------------------------
PROGRESS: 36.0%
| epoch  37 |   100/  269 batches | lr 0.00030 | ms/batch 246.07 | loss  3.60 | ppl    36.43 
| epoch  37 |   200/  269 batches | lr 0.00030 | ms/batch 233.41 | loss  3.60 | ppl    36.60 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 63.23s | valid loss  3.94 | valid ppl    51.39 | valid bpc    5.683
-----------------------------------------------------------------------------------------
PROGRESS: 37.0%
| epoch  38 |   100/  269 batches | lr 0.00030 | ms/batch 247.07 | loss  3.57 | ppl    35.45 
| epoch  38 |   200/  269 batches | lr 0.00030 | ms/batch 231.58 | loss  3.57 | ppl    35.64 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 64.13s | valid loss  3.96 | valid ppl    52.23 | valid bpc    5.707
-----------------------------------------------------------------------------------------
PROGRESS: 38.0%
| epoch  39 |   100/  269 batches | lr 0.00015 | ms/batch 240.72 | loss  3.52 | ppl    33.69 
| epoch  39 |   200/  269 batches | lr 0.00015 | ms/batch 231.38 | loss  3.45 | ppl    31.64 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 63.61s | valid loss  3.92 | valid ppl    50.45 | valid bpc    5.657
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 39.0%
| epoch  40 |   100/  269 batches | lr 0.00015 | ms/batch 241.37 | loss  3.45 | ppl    31.60 
| epoch  40 |   200/  269 batches | lr 0.00015 | ms/batch 232.24 | loss  3.41 | ppl    30.35 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 64.41s | valid loss  3.86 | valid ppl    47.23 | valid bpc    5.562
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 40.0%
| epoch  41 |   100/  269 batches | lr 0.00015 | ms/batch 233.69 | loss  3.41 | ppl    30.34 
| epoch  41 |   200/  269 batches | lr 0.00015 | ms/batch 231.52 | loss  3.38 | ppl    29.38 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 63.84s | valid loss  3.86 | valid ppl    47.63 | valid bpc    5.574
-----------------------------------------------------------------------------------------
PROGRESS: 41.0%
| epoch  42 |   100/  269 batches | lr 0.00015 | ms/batch 212.81 | loss  3.40 | ppl    29.93 
| epoch  42 |   200/  269 batches | lr 0.00015 | ms/batch 231.90 | loss  3.36 | ppl    28.72 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 61.61s | valid loss  3.86 | valid ppl    47.25 | valid bpc    5.562
-----------------------------------------------------------------------------------------
PROGRESS: 42.0%
| epoch  43 |   100/  269 batches | lr 0.00015 | ms/batch 226.86 | loss  3.36 | ppl    28.74 
| epoch  43 |   200/  269 batches | lr 0.00015 | ms/batch 231.53 | loss  3.34 | ppl    28.22 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 63.09s | valid loss  3.82 | valid ppl    45.64 | valid bpc    5.512
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 43.0%
| epoch  44 |   100/  269 batches | lr 0.00015 | ms/batch 230.87 | loss  3.33 | ppl    27.96 
| epoch  44 |   200/  269 batches | lr 0.00015 | ms/batch 232.16 | loss  3.32 | ppl    27.63 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 63.51s | valid loss  3.85 | valid ppl    47.07 | valid bpc    5.557
-----------------------------------------------------------------------------------------
PROGRESS: 44.0%
| epoch  45 |   100/  269 batches | lr 0.00015 | ms/batch 233.54 | loss  3.31 | ppl    27.44 
| epoch  45 |   200/  269 batches | lr 0.00015 | ms/batch 232.29 | loss  3.30 | ppl    27.14 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 63.72s | valid loss  3.83 | valid ppl    45.86 | valid bpc    5.519
-----------------------------------------------------------------------------------------
PROGRESS: 45.0%
| epoch  46 |   100/  269 batches | lr 0.00015 | ms/batch 231.16 | loss  3.30 | ppl    27.06 
| epoch  46 |   200/  269 batches | lr 0.00015 | ms/batch 232.88 | loss  3.26 | ppl    26.18 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 63.60s | valid loss  3.77 | valid ppl    43.27 | valid bpc    5.435
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 46.0%
| epoch  47 |   100/  269 batches | lr 0.00015 | ms/batch 231.96 | loss  3.29 | ppl    26.89 
| epoch  47 |   200/  269 batches | lr 0.00015 | ms/batch 231.63 | loss  3.26 | ppl    25.93 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 63.56s | valid loss  3.85 | valid ppl    46.77 | valid bpc    5.548
-----------------------------------------------------------------------------------------
PROGRESS: 47.0%
| epoch  48 |   100/  269 batches | lr 0.00015 | ms/batch 240.43 | loss  3.26 | ppl    26.16 
| epoch  48 |   200/  269 batches | lr 0.00015 | ms/batch 226.84 | loss  3.23 | ppl    25.29 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 63.88s | valid loss  3.84 | valid ppl    46.42 | valid bpc    5.537
-----------------------------------------------------------------------------------------
PROGRESS: 48.0%
| epoch  49 |   100/  269 batches | lr 0.00015 | ms/batch 236.49 | loss  3.23 | ppl    25.39 
| epoch  49 |   200/  269 batches | lr 0.00015 | ms/batch 227.36 | loss  3.23 | ppl    25.31 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 63.57s | valid loss  3.84 | valid ppl    46.68 | valid bpc    5.545
-----------------------------------------------------------------------------------------
PROGRESS: 49.0%
| epoch  50 |   100/  269 batches | lr 0.00007 | ms/batch 244.43 | loss  3.19 | ppl    24.40 
| epoch  50 |   200/  269 batches | lr 0.00007 | ms/batch 221.27 | loss  3.17 | ppl    23.85 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 63.71s | valid loss  3.79 | valid ppl    44.23 | valid bpc    5.467
-----------------------------------------------------------------------------------------
PROGRESS: 50.0%
| epoch  51 |   100/  269 batches | lr 0.00007 | ms/batch 246.86 | loss  3.20 | ppl    24.55 
| epoch  51 |   200/  269 batches | lr 0.00007 | ms/batch 220.63 | loss  3.15 | ppl    23.25 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 63.90s | valid loss  3.82 | valid ppl    45.58 | valid bpc    5.510
-----------------------------------------------------------------------------------------
PROGRESS: 51.0%
| epoch  52 |   100/  269 batches | lr 0.00007 | ms/batch 246.43 | loss  3.18 | ppl    23.95 
| epoch  52 |   200/  269 batches | lr 0.00007 | ms/batch 221.38 | loss  3.12 | ppl    22.72 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 63.92s | valid loss  3.82 | valid ppl    45.55 | valid bpc    5.510
-----------------------------------------------------------------------------------------
PROGRESS: 52.0%
| epoch  53 |   100/  269 batches | lr 0.00004 | ms/batch 247.25 | loss  3.12 | ppl    22.64 
| epoch  53 |   200/  269 batches | lr 0.00004 | ms/batch 214.09 | loss  3.10 | ppl    22.12 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 63.28s | valid loss  3.82 | valid ppl    45.43 | valid bpc    5.506
-----------------------------------------------------------------------------------------
PROGRESS: 53.0%
| epoch  54 |   100/  269 batches | lr 0.00004 | ms/batch 246.34 | loss  3.10 | ppl    22.19 
| epoch  54 |   200/  269 batches | lr 0.00004 | ms/batch 219.99 | loss  3.08 | ppl    21.82 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 63.91s | valid loss  3.77 | valid ppl    43.44 | valid bpc    5.441
-----------------------------------------------------------------------------------------
PROGRESS: 54.0%
| epoch  55 |   100/  269 batches | lr 0.00004 | ms/batch 246.71 | loss  3.12 | ppl    22.70 
| epoch  55 |   200/  269 batches | lr 0.00004 | ms/batch 221.42 | loss  3.08 | ppl    21.66 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 63.89s | valid loss  3.78 | valid ppl    43.65 | valid bpc    5.448
-----------------------------------------------------------------------------------------
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  269 batches | lr 0.00002 | ms/batch 245.26 | loss  3.10 | ppl    22.10 
| epoch  56 |   200/  269 batches | lr 0.00002 | ms/batch 227.06 | loss  3.08 | ppl    21.76 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 63.57s | valid loss  3.80 | valid ppl    44.48 | valid bpc    5.475
-----------------------------------------------------------------------------------------
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  269 batches | lr 0.00002 | ms/batch 246.64 | loss  3.08 | ppl    21.84 
| epoch  57 |   200/  269 batches | lr 0.00002 | ms/batch 226.18 | loss  3.05 | ppl    21.03 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 63.54s | valid loss  3.80 | valid ppl    44.57 | valid bpc    5.478
-----------------------------------------------------------------------------------------
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  269 batches | lr 0.00002 | ms/batch 247.36 | loss  3.11 | ppl    22.36 
| epoch  58 |   200/  269 batches | lr 0.00002 | ms/batch 225.58 | loss  3.03 | ppl    20.77 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 63.88s | valid loss  3.81 | valid ppl    44.95 | valid bpc    5.490
-----------------------------------------------------------------------------------------
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  269 batches | lr 0.00001 | ms/batch 246.21 | loss  3.09 | ppl    21.93 
| epoch  59 |   200/  269 batches | lr 0.00001 | ms/batch 226.24 | loss  3.05 | ppl    21.05 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 63.90s | valid loss  3.75 | valid ppl    42.49 | valid bpc    5.409
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 59.0%
| epoch  60 |   100/  269 batches | lr 0.00001 | ms/batch 246.88 | loss  3.08 | ppl    21.68 
| epoch  60 |   200/  269 batches | lr 0.00001 | ms/batch 224.11 | loss  3.02 | ppl    20.45 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 63.20s | valid loss  3.72 | valid ppl    41.37 | valid bpc    5.371
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 60.0%
| epoch  61 |   100/  269 batches | lr 0.00001 | ms/batch 247.31 | loss  3.05 | ppl    21.22 
| epoch  61 |   200/  269 batches | lr 0.00001 | ms/batch 231.44 | loss  3.03 | ppl    20.72 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 64.42s | valid loss  3.75 | valid ppl    42.54 | valid bpc    5.411
-----------------------------------------------------------------------------------------
PROGRESS: 61.0%
| epoch  62 |   100/  269 batches | lr 0.00001 | ms/batch 240.63 | loss  3.05 | ppl    21.09 
| epoch  62 |   200/  269 batches | lr 0.00001 | ms/batch 232.44 | loss  3.05 | ppl    21.04 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 63.70s | valid loss  3.80 | valid ppl    44.84 | valid bpc    5.487
-----------------------------------------------------------------------------------------
PROGRESS: 62.0%
| epoch  63 |   100/  269 batches | lr 0.00001 | ms/batch 241.59 | loss  3.09 | ppl    22.03 
| epoch  63 |   200/  269 batches | lr 0.00001 | ms/batch 231.42 | loss  3.02 | ppl    20.45 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 63.86s | valid loss  3.84 | valid ppl    46.71 | valid bpc    5.546
-----------------------------------------------------------------------------------------
PROGRESS: 63.0%
| epoch  64 |   100/  269 batches | lr 0.00000 | ms/batch 238.00 | loss  3.06 | ppl    21.26 
| epoch  64 |   200/  269 batches | lr 0.00000 | ms/batch 231.88 | loss  3.03 | ppl    20.68 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 63.54s | valid loss  3.75 | valid ppl    42.67 | valid bpc    5.415
-----------------------------------------------------------------------------------------
PROGRESS: 64.0%
| epoch  65 |   100/  269 batches | lr 0.00000 | ms/batch 240.90 | loss  3.07 | ppl    21.55 
| epoch  65 |   200/  269 batches | lr 0.00000 | ms/batch 231.83 | loss  3.03 | ppl    20.69 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 63.95s | valid loss  3.80 | valid ppl    44.80 | valid bpc    5.486
-----------------------------------------------------------------------------------------
PROGRESS: 65.0%
| epoch  66 |   100/  269 batches | lr 0.00000 | ms/batch 241.94 | loss  3.08 | ppl    21.84 
| epoch  66 |   200/  269 batches | lr 0.00000 | ms/batch 231.85 | loss  3.03 | ppl    20.70 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 63.96s | valid loss  3.77 | valid ppl    43.26 | valid bpc    5.435
-----------------------------------------------------------------------------------------
PROGRESS: 66.0%
| epoch  67 |   100/  269 batches | lr 0.00000 | ms/batch 241.78 | loss  3.06 | ppl    21.43 
| epoch  67 |   200/  269 batches | lr 0.00000 | ms/batch 232.01 | loss  3.02 | ppl    20.44 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 63.93s | valid loss  3.76 | valid ppl    42.79 | valid bpc    5.419
-----------------------------------------------------------------------------------------
PROGRESS: 67.0%
| epoch  68 |   100/  269 batches | lr 0.00000 | ms/batch 241.41 | loss  3.07 | ppl    21.49 
| epoch  68 |   200/  269 batches | lr 0.00000 | ms/batch 232.32 | loss  3.03 | ppl    20.61 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 64.13s | valid loss  3.80 | valid ppl    44.74 | valid bpc    5.484
-----------------------------------------------------------------------------------------
PROGRESS: 68.0%
| epoch  69 |   100/  269 batches | lr 0.00000 | ms/batch 234.96 | loss  3.06 | ppl    21.31 
| epoch  69 |   200/  269 batches | lr 0.00000 | ms/batch 232.98 | loss  3.02 | ppl    20.39 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 63.99s | valid loss  3.75 | valid ppl    42.68 | valid bpc    5.415
-----------------------------------------------------------------------------------------
PROGRESS: 69.0%
| epoch  70 |   100/  269 batches | lr 0.00000 | ms/batch 238.11 | loss  3.06 | ppl    21.43 
| epoch  70 |   200/  269 batches | lr 0.00000 | ms/batch 225.80 | loss  3.02 | ppl    20.55 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 63.54s | valid loss  3.78 | valid ppl    43.98 | valid bpc    5.459
-----------------------------------------------------------------------------------------
PROGRESS: 70.0%
| epoch  71 |   100/  269 batches | lr 0.00000 | ms/batch 240.57 | loss  3.05 | ppl    21.18 
| epoch  71 |   200/  269 batches | lr 0.00000 | ms/batch 225.69 | loss  3.02 | ppl    20.48 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 63.89s | valid loss  3.78 | valid ppl    43.79 | valid bpc    5.452
-----------------------------------------------------------------------------------------
PROGRESS: 71.0%
| epoch  72 |   100/  269 batches | lr 0.00000 | ms/batch 240.29 | loss  3.04 | ppl    20.84 
| epoch  72 |   200/  269 batches | lr 0.00000 | ms/batch 225.69 | loss  3.03 | ppl    20.66 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 63.89s | valid loss  3.76 | valid ppl    42.96 | valid bpc    5.425
-----------------------------------------------------------------------------------------
PROGRESS: 72.0%
| epoch  73 |   100/  269 batches | lr 0.00000 | ms/batch 241.45 | loss  3.07 | ppl    21.46 
| epoch  73 |   200/  269 batches | lr 0.00000 | ms/batch 226.30 | loss  3.03 | ppl    20.69 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 63.93s | valid loss  3.77 | valid ppl    43.55 | valid bpc    5.445
-----------------------------------------------------------------------------------------
PROGRESS: 73.0%
| epoch  74 |   100/  269 batches | lr 0.00000 | ms/batch 240.17 | loss  3.05 | ppl    21.18 
| epoch  74 |   200/  269 batches | lr 0.00000 | ms/batch 222.29 | loss  3.05 | ppl    21.04 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 63.56s | valid loss  3.76 | valid ppl    43.00 | valid bpc    5.426
-----------------------------------------------------------------------------------------
PROGRESS: 74.0%
| epoch  75 |   100/  269 batches | lr 0.00000 | ms/batch 241.85 | loss  3.05 | ppl    21.05 
| epoch  75 |   200/  269 batches | lr 0.00000 | ms/batch 225.66 | loss  3.01 | ppl    20.25 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 63.88s | valid loss  3.75 | valid ppl    42.60 | valid bpc    5.413
-----------------------------------------------------------------------------------------
PROGRESS: 75.0%
| epoch  76 |   100/  269 batches | lr 0.00000 | ms/batch 240.41 | loss  3.04 | ppl    20.81 
| epoch  76 |   200/  269 batches | lr 0.00000 | ms/batch 227.07 | loss  3.02 | ppl    20.43 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 63.93s | valid loss  3.74 | valid ppl    42.02 | valid bpc    5.393
-----------------------------------------------------------------------------------------
PROGRESS: 76.0%
| epoch  77 |   100/  269 batches | lr 0.00000 | ms/batch 240.38 | loss  3.06 | ppl    21.29 
| epoch  77 |   200/  269 batches | lr 0.00000 | ms/batch 226.07 | loss  3.00 | ppl    20.17 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 63.94s | valid loss  3.77 | valid ppl    43.42 | valid bpc    5.440
-----------------------------------------------------------------------------------------
PROGRESS: 77.0%
| epoch  78 |   100/  269 batches | lr 0.00000 | ms/batch 241.38 | loss  3.04 | ppl    20.80 
| epoch  78 |   200/  269 batches | lr 0.00000 | ms/batch 232.22 | loss  3.01 | ppl    20.26 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 63.56s | valid loss  3.78 | valid ppl    43.82 | valid bpc    5.454
-----------------------------------------------------------------------------------------
PROGRESS: 78.0%
| epoch  79 |   100/  269 batches | lr 0.00000 | ms/batch 240.99 | loss  3.06 | ppl    21.24 
| epoch  79 |   200/  269 batches | lr 0.00000 | ms/batch 231.81 | loss  3.02 | ppl    20.50 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 63.91s | valid loss  3.74 | valid ppl    42.11 | valid bpc    5.396
-----------------------------------------------------------------------------------------
PROGRESS: 79.0%
| epoch  80 |   100/  269 batches | lr 0.00000 | ms/batch 241.35 | loss  3.06 | ppl    21.28 
| epoch  80 |   200/  269 batches | lr 0.00000 | ms/batch 231.37 | loss  3.04 | ppl    20.82 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 63.88s | valid loss  3.78 | valid ppl    43.70 | valid bpc    5.450
-----------------------------------------------------------------------------------------
PROGRESS: 80.0%
| epoch  81 |   100/  269 batches | lr 0.00000 | ms/batch 244.18 | loss  3.06 | ppl    21.33 
| epoch  81 |   200/  269 batches | lr 0.00000 | ms/batch 229.34 | loss  3.01 | ppl    20.30 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 63.94s | valid loss  3.81 | valid ppl    45.09 | valid bpc    5.495
-----------------------------------------------------------------------------------------
PROGRESS: 81.0%
| epoch  82 |   100/  269 batches | lr 0.00000 | ms/batch 246.34 | loss  3.04 | ppl    20.83 
| epoch  82 |   200/  269 batches | lr 0.00000 | ms/batch 225.84 | loss  3.02 | ppl    20.43 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 63.93s | valid loss  3.83 | valid ppl    46.15 | valid bpc    5.528
-----------------------------------------------------------------------------------------
PROGRESS: 82.0%
| epoch  83 |   100/  269 batches | lr 0.00000 | ms/batch 246.32 | loss  3.05 | ppl    21.17 
| epoch  83 |   200/  269 batches | lr 0.00000 | ms/batch 226.53 | loss  3.01 | ppl    20.26 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 64.23s | valid loss  3.77 | valid ppl    43.52 | valid bpc    5.444
-----------------------------------------------------------------------------------------
PROGRESS: 83.0%
| epoch  84 |   100/  269 batches | lr 0.00000 | ms/batch 243.27 | loss  3.05 | ppl    21.13 
| epoch  84 |   200/  269 batches | lr 0.00000 | ms/batch 227.19 | loss  3.00 | ppl    20.14 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 64.22s | valid loss  3.79 | valid ppl    44.36 | valid bpc    5.471
-----------------------------------------------------------------------------------------
PROGRESS: 84.0%
| epoch  85 |   100/  269 batches | lr 0.00000 | ms/batch 241.66 | loss  3.05 | ppl    21.07 
| epoch  85 |   200/  269 batches | lr 0.00000 | ms/batch 226.27 | loss  3.01 | ppl    20.31 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 63.91s | valid loss  3.79 | valid ppl    44.18 | valid bpc    5.465
-----------------------------------------------------------------------------------------
PROGRESS: 85.0%
| epoch  86 |   100/  269 batches | lr 0.00000 | ms/batch 241.96 | loss  3.06 | ppl    21.34 
| epoch  86 |   200/  269 batches | lr 0.00000 | ms/batch 226.22 | loss  3.04 | ppl    20.82 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 63.90s | valid loss  3.79 | valid ppl    44.08 | valid bpc    5.462
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  269 batches | lr 0.00000 | ms/batch 240.42 | loss  3.04 | ppl    20.96 
| epoch  87 |   200/  269 batches | lr 0.00000 | ms/batch 226.82 | loss  3.04 | ppl    20.99 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 63.89s | valid loss  3.83 | valid ppl    46.05 | valid bpc    5.525
-----------------------------------------------------------------------------------------
PROGRESS: 87.0%
| epoch  88 |   100/  269 batches | lr 0.00000 | ms/batch 241.27 | loss  3.06 | ppl    21.24 
| epoch  88 |   200/  269 batches | lr 0.00000 | ms/batch 225.62 | loss  3.02 | ppl    20.41 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 63.88s | valid loss  3.77 | valid ppl    43.45 | valid bpc    5.441
-----------------------------------------------------------------------------------------
PROGRESS: 88.0%
| epoch  89 |   100/  269 batches | lr 0.00000 | ms/batch 240.00 | loss  3.06 | ppl    21.27 
| epoch  89 |   200/  269 batches | lr 0.00000 | ms/batch 227.25 | loss  3.02 | ppl    20.42 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 63.97s | valid loss  3.76 | valid ppl    43.03 | valid bpc    5.427
-----------------------------------------------------------------------------------------
PROGRESS: 89.0%
| epoch  90 |   100/  269 batches | lr 0.00000 | ms/batch 237.04 | loss  3.06 | ppl    21.30 
| epoch  90 |   200/  269 batches | lr 0.00000 | ms/batch 222.34 | loss  3.01 | ppl    20.29 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 63.19s | valid loss  3.76 | valid ppl    43.01 | valid bpc    5.427
-----------------------------------------------------------------------------------------
PROGRESS: 90.0%
| epoch  91 |   100/  269 batches | lr 0.00000 | ms/batch 240.38 | loss  3.05 | ppl    21.20 
| epoch  91 |   200/  269 batches | lr 0.00000 | ms/batch 227.67 | loss  3.03 | ppl    20.71 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 63.92s | valid loss  3.78 | valid ppl    43.94 | valid bpc    5.457
-----------------------------------------------------------------------------------------
PROGRESS: 91.0%
| epoch  92 |   100/  269 batches | lr 0.00000 | ms/batch 240.24 | loss  3.04 | ppl    20.97 
| epoch  92 |   200/  269 batches | lr 0.00000 | ms/batch 231.97 | loss  3.04 | ppl    20.87 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 63.88s | valid loss  3.82 | valid ppl    45.48 | valid bpc    5.507
-----------------------------------------------------------------------------------------
PROGRESS: 92.0%
| epoch  93 |   100/  269 batches | lr 0.00000 | ms/batch 245.91 | loss  3.05 | ppl    21.02 
| epoch  93 |   200/  269 batches | lr 0.00000 | ms/batch 226.72 | loss  3.03 | ppl    20.62 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 63.90s | valid loss  3.74 | valid ppl    42.11 | valid bpc    5.396
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  269 batches | lr 0.00000 | ms/batch 246.50 | loss  3.04 | ppl    20.99 
| epoch  94 |   200/  269 batches | lr 0.00000 | ms/batch 227.01 | loss  3.04 | ppl    20.81 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 63.92s | valid loss  3.76 | valid ppl    42.81 | valid bpc    5.420
-----------------------------------------------------------------------------------------
PROGRESS: 94.0%
| epoch  95 |   100/  269 batches | lr 0.00000 | ms/batch 247.04 | loss  3.05 | ppl    21.14 
| epoch  95 |   200/  269 batches | lr 0.00000 | ms/batch 226.11 | loss  3.02 | ppl    20.53 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 63.90s | valid loss  3.78 | valid ppl    43.67 | valid bpc    5.448
-----------------------------------------------------------------------------------------
PROGRESS: 95.0%
| epoch  96 |   100/  269 batches | lr 0.00000 | ms/batch 247.78 | loss  3.05 | ppl    21.19 
| epoch  96 |   200/  269 batches | lr 0.00000 | ms/batch 226.03 | loss  3.02 | ppl    20.39 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 63.87s | valid loss  3.76 | valid ppl    42.97 | valid bpc    5.425
-----------------------------------------------------------------------------------------
PROGRESS: 96.0%
| epoch  97 |   100/  269 batches | lr 0.00000 | ms/batch 246.29 | loss  3.06 | ppl    21.28 
| epoch  97 |   200/  269 batches | lr 0.00000 | ms/batch 226.09 | loss  3.03 | ppl    20.62 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 63.90s | valid loss  3.75 | valid ppl    42.48 | valid bpc    5.409
-----------------------------------------------------------------------------------------
PROGRESS: 97.0%
| epoch  98 |   100/  269 batches | lr 0.00000 | ms/batch 246.18 | loss  3.04 | ppl    20.82 
| epoch  98 |   200/  269 batches | lr 0.00000 | ms/batch 225.98 | loss  3.01 | ppl    20.32 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 63.91s | valid loss  3.80 | valid ppl    44.54 | valid bpc    5.477
-----------------------------------------------------------------------------------------
PROGRESS: 98.0%
| epoch  99 |   100/  269 batches | lr 0.00000 | ms/batch 246.39 | loss  3.05 | ppl    21.18 
| epoch  99 |   200/  269 batches | lr 0.00000 | ms/batch 225.73 | loss  3.00 | ppl    20.11 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 64.01s | valid loss  3.78 | valid ppl    43.61 | valid bpc    5.447
-----------------------------------------------------------------------------------------
PROGRESS: 99.0%
| epoch 100 |   100/  269 batches | lr 0.00000 | ms/batch 245.69 | loss  3.03 | ppl    20.75 
| epoch 100 |   200/  269 batches | lr 0.00000 | ms/batch 222.48 | loss  3.03 | ppl    20.79 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 64.00s | valid loss  3.76 | valid ppl    42.85 | valid bpc    5.421
-----------------------------------------------------------------------------------------
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  3.88 | test ppl    48.45 | test bpc    5.599
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.4730, Mean Reca: 0.6639, Mean F1: 0.5481, Mean Subword_Reca: 0.8373
-----------------------------------------------------------------------------------------
=========================================================================================
Loading dataset...
Using subword tokenizer...
Number of tokens:  8000
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer_in_parser', nhid=512, nlayers=8, front_layers=7, rear_layers=1, subword='omarmomen/ptb_filtered_lowcase_bpe_tokenizer_8', n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=1111, nonmono=5, cuda=True, log_interval=100, save='trained_models/subword_structformer_in_parser_1111_71.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 37449044
Model architecture: StructFormer_In_Parser(
  (transformer_front): Transformer_Front(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(8000, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-6): 7 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
  (transformer_rear): Transformer_Rear(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(8000, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0): TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (output_layer): Linear(in_features=512, out_features=8000, bias=True)
  )
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  269 batches | lr 0.00030 | ms/batch 250.73 | loss  7.80 | ppl  2450.80 
| epoch   1 |   200/  269 batches | lr 0.00030 | ms/batch 225.57 | loss  7.39 | ppl  1620.87 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 64.76s | valid loss  7.10 | valid ppl  1206.56 | valid bpc   10.237
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  269 batches | lr 0.00030 | ms/batch 240.54 | loss  7.32 | ppl  1506.69 
| epoch   2 |   200/  269 batches | lr 0.00030 | ms/batch 224.80 | loss  7.17 | ppl  1303.31 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 63.79s | valid loss  6.93 | valid ppl  1021.39 | valid bpc    9.996
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  269 batches | lr 0.00030 | ms/batch 245.17 | loss  7.05 | ppl  1157.46 
| epoch   3 |   200/  269 batches | lr 0.00030 | ms/batch 221.36 | loss  6.77 | ppl   874.36 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 63.86s | valid loss  6.24 | valid ppl   513.27 | valid bpc    9.004
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  269 batches | lr 0.00030 | ms/batch 247.50 | loss  6.40 | ppl   602.80 
| epoch   4 |   200/  269 batches | lr 0.00030 | ms/batch 219.20 | loss  6.11 | ppl   451.40 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 63.82s | valid loss  5.78 | valid ppl   322.74 | valid bpc    8.334
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  269 batches | lr 0.00030 | ms/batch 246.65 | loss  5.94 | ppl   380.05 
| epoch   5 |   200/  269 batches | lr 0.00030 | ms/batch 219.81 | loss  5.80 | ppl   331.81 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 63.83s | valid loss  5.49 | valid ppl   241.15 | valid bpc    7.914
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  269 batches | lr 0.00030 | ms/batch 245.71 | loss  5.69 | ppl   296.63 
| epoch   6 |   200/  269 batches | lr 0.00030 | ms/batch 219.73 | loss  5.57 | ppl   263.20 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 63.79s | valid loss  5.34 | valid ppl   208.86 | valid bpc    7.706
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  269 batches | lr 0.00030 | ms/batch 246.04 | loss  5.53 | ppl   251.17 
| epoch   7 |   200/  269 batches | lr 0.00030 | ms/batch 220.94 | loss  5.45 | ppl   232.91 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 63.82s | valid loss  5.18 | valid ppl   178.25 | valid bpc    7.478
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  269 batches | lr 0.00030 | ms/batch 245.77 | loss  5.38 | ppl   217.58 
| epoch   8 |   200/  269 batches | lr 0.00030 | ms/batch 224.16 | loss  5.28 | ppl   197.04 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 63.90s | valid loss  5.09 | valid ppl   162.84 | valid bpc    7.347
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 8.0%
| epoch   9 |   100/  269 batches | lr 0.00030 | ms/batch 246.04 | loss  5.27 | ppl   193.75 
| epoch   9 |   200/  269 batches | lr 0.00030 | ms/batch 227.05 | loss  5.18 | ppl   177.73 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 63.86s | valid loss  4.98 | valid ppl   145.47 | valid bpc    7.185
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  269 batches | lr 0.00030 | ms/batch 246.06 | loss  5.17 | ppl   175.13 
| epoch  10 |   200/  269 batches | lr 0.00030 | ms/batch 225.58 | loss  5.08 | ppl   160.18 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 63.84s | valid loss  4.93 | valid ppl   138.50 | valid bpc    7.114
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  269 batches | lr 0.00030 | ms/batch 245.12 | loss  5.06 | ppl   157.59 
| epoch  11 |   200/  269 batches | lr 0.00030 | ms/batch 226.34 | loss  4.99 | ppl   147.57 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 63.80s | valid loss  4.80 | valid ppl   121.54 | valid bpc    6.925
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  269 batches | lr 0.00030 | ms/batch 245.58 | loss  4.97 | ppl   143.78 
| epoch  12 |   200/  269 batches | lr 0.00030 | ms/batch 226.49 | loss  4.90 | ppl   133.66 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 63.80s | valid loss  4.80 | valid ppl   121.27 | valid bpc    6.922
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 12.0%
| epoch  13 |   100/  269 batches | lr 0.00030 | ms/batch 245.40 | loss  4.87 | ppl   129.80 
| epoch  13 |   200/  269 batches | lr 0.00030 | ms/batch 226.67 | loss  4.78 | ppl   119.53 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 63.81s | valid loss  4.68 | valid ppl   108.31 | valid bpc    6.759
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 13.0%
| epoch  14 |   100/  269 batches | lr 0.00030 | ms/batch 246.28 | loss  4.77 | ppl   118.03 
| epoch  14 |   200/  269 batches | lr 0.00030 | ms/batch 225.94 | loss  4.73 | ppl   113.77 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 63.81s | valid loss  4.61 | valid ppl   100.96 | valid bpc    6.658
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  269 batches | lr 0.00030 | ms/batch 246.33 | loss  4.71 | ppl   111.04 
| epoch  15 |   200/  269 batches | lr 0.00030 | ms/batch 230.48 | loss  4.67 | ppl   107.21 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 62.11s | valid loss  4.50 | valid ppl    90.32 | valid bpc    6.497
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 15.0%
| epoch  16 |   100/  269 batches | lr 0.00030 | ms/batch 174.14 | loss  4.65 | ppl   104.32 
| epoch  16 |   200/  269 batches | lr 0.00030 | ms/batch 166.22 | loss  4.57 | ppl    96.94 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 45.68s | valid loss  4.49 | valid ppl    89.06 | valid bpc    6.477
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 16.0%
| epoch  17 |   100/  269 batches | lr 0.00030 | ms/batch 172.04 | loss  4.55 | ppl    95.01 
| epoch  17 |   200/  269 batches | lr 0.00030 | ms/batch 155.08 | loss  4.54 | ppl    93.60 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 39.92s | valid loss  4.47 | valid ppl    87.12 | valid bpc    6.445
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 17.0%
| epoch  18 |   100/  269 batches | lr 0.00030 | ms/batch 89.92 | loss  4.50 | ppl    90.23 
| epoch  18 |   200/  269 batches | lr 0.00030 | ms/batch 89.13 | loss  4.47 | ppl    87.68 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 24.42s | valid loss  4.44 | valid ppl    84.76 | valid bpc    6.405
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 18.0%
| epoch  19 |   100/  269 batches | lr 0.00030 | ms/batch 74.82 | loss  4.44 | ppl    84.67 
| epoch  19 |   200/  269 batches | lr 0.00030 | ms/batch 73.08 | loss  4.38 | ppl    80.17 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 20.17s | valid loss  4.40 | valid ppl    81.76 | valid bpc    6.353
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 19.0%
| epoch  20 |   100/  269 batches | lr 0.00030 | ms/batch 74.43 | loss  4.40 | ppl    81.32 
| epoch  20 |   200/  269 batches | lr 0.00030 | ms/batch 72.86 | loss  4.33 | ppl    76.09 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 20.14s | valid loss  4.27 | valid ppl    71.53 | valid bpc    6.161
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 20.0%
| epoch  21 |   100/  269 batches | lr 0.00030 | ms/batch 74.58 | loss  4.32 | ppl    75.29 
| epoch  21 |   200/  269 batches | lr 0.00030 | ms/batch 73.20 | loss  4.28 | ppl    72.38 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 20.15s | valid loss  4.30 | valid ppl    73.69 | valid bpc    6.203
-----------------------------------------------------------------------------------------
PROGRESS: 21.0%
| epoch  22 |   100/  269 batches | lr 0.00030 | ms/batch 74.34 | loss  4.26 | ppl    70.68 
| epoch  22 |   200/  269 batches | lr 0.00030 | ms/batch 73.06 | loss  4.23 | ppl    68.42 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 20.15s | valid loss  4.26 | valid ppl    70.85 | valid bpc    6.147
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 22.0%
| epoch  23 |   100/  269 batches | lr 0.00030 | ms/batch 74.43 | loss  4.18 | ppl    65.38 
| epoch  23 |   200/  269 batches | lr 0.00030 | ms/batch 72.86 | loss  4.18 | ppl    65.53 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 20.15s | valid loss  4.24 | valid ppl    69.08 | valid bpc    6.110
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 23.0%
| epoch  24 |   100/  269 batches | lr 0.00030 | ms/batch 74.42 | loss  4.15 | ppl    63.47 
| epoch  24 |   200/  269 batches | lr 0.00030 | ms/batch 72.94 | loss  4.13 | ppl    62.06 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 20.15s | valid loss  4.21 | valid ppl    67.48 | valid bpc    6.076
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 24.0%
| epoch  25 |   100/  269 batches | lr 0.00030 | ms/batch 74.20 | loss  4.09 | ppl    59.83 
| epoch  25 |   200/  269 batches | lr 0.00030 | ms/batch 73.23 | loss  4.09 | ppl    59.84 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 20.13s | valid loss  4.19 | valid ppl    66.22 | valid bpc    6.049
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 25.0%
| epoch  26 |   100/  269 batches | lr 0.00030 | ms/batch 74.59 | loss  4.02 | ppl    55.58 
| epoch  26 |   200/  269 batches | lr 0.00030 | ms/batch 73.10 | loss  4.03 | ppl    56.31 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 20.15s | valid loss  4.17 | valid ppl    64.66 | valid bpc    6.015
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 26.0%
| epoch  27 |   100/  269 batches | lr 0.00030 | ms/batch 74.17 | loss  3.97 | ppl    53.07 
| epoch  27 |   200/  269 batches | lr 0.00030 | ms/batch 73.20 | loss  3.97 | ppl    52.99 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 20.15s | valid loss  4.13 | valid ppl    62.13 | valid bpc    5.957
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 27.0%
| epoch  28 |   100/  269 batches | lr 0.00030 | ms/batch 74.39 | loss  3.97 | ppl    53.16 
| epoch  28 |   200/  269 batches | lr 0.00030 | ms/batch 73.09 | loss  3.94 | ppl    51.52 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 20.16s | valid loss  4.13 | valid ppl    62.01 | valid bpc    5.954
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  269 batches | lr 0.00030 | ms/batch 74.84 | loss  3.93 | ppl    50.70 
| epoch  29 |   200/  269 batches | lr 0.00030 | ms/batch 73.13 | loss  3.87 | ppl    48.00 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 20.16s | valid loss  4.08 | valid ppl    58.89 | valid bpc    5.880
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  269 batches | lr 0.00030 | ms/batch 74.54 | loss  3.85 | ppl    47.21 
| epoch  30 |   200/  269 batches | lr 0.00030 | ms/batch 73.00 | loss  3.85 | ppl    46.99 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 20.14s | valid loss  4.07 | valid ppl    58.35 | valid bpc    5.867
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 30.0%
| epoch  31 |   100/  269 batches | lr 0.00030 | ms/batch 74.49 | loss  3.82 | ppl    45.77 
| epoch  31 |   200/  269 batches | lr 0.00030 | ms/batch 73.37 | loss  3.82 | ppl    45.79 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 20.16s | valid loss  4.08 | valid ppl    58.97 | valid bpc    5.882
-----------------------------------------------------------------------------------------
PROGRESS: 31.0%
| epoch  32 |   100/  269 batches | lr 0.00030 | ms/batch 74.79 | loss  3.81 | ppl    45.24 
| epoch  32 |   200/  269 batches | lr 0.00030 | ms/batch 73.02 | loss  3.78 | ppl    43.64 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 20.16s | valid loss  4.06 | valid ppl    57.90 | valid bpc    5.856
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 32.0%
| epoch  33 |   100/  269 batches | lr 0.00030 | ms/batch 74.50 | loss  3.75 | ppl    42.70 
| epoch  33 |   200/  269 batches | lr 0.00030 | ms/batch 73.19 | loss  3.73 | ppl    41.61 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 20.14s | valid loss  3.99 | valid ppl    53.98 | valid bpc    5.754
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 33.0%
| epoch  34 |   100/  269 batches | lr 0.00030 | ms/batch 74.75 | loss  3.73 | ppl    41.66 
| epoch  34 |   200/  269 batches | lr 0.00030 | ms/batch 72.88 | loss  3.73 | ppl    41.75 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 20.13s | valid loss  3.98 | valid ppl    53.73 | valid bpc    5.748
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 34.0%
| epoch  35 |   100/  269 batches | lr 0.00030 | ms/batch 74.71 | loss  3.68 | ppl    39.70 
| epoch  35 |   200/  269 batches | lr 0.00030 | ms/batch 72.79 | loss  3.67 | ppl    39.23 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 20.13s | valid loss  3.99 | valid ppl    54.28 | valid bpc    5.762
-----------------------------------------------------------------------------------------
PROGRESS: 35.0%
| epoch  36 |   100/  269 batches | lr 0.00030 | ms/batch 74.23 | loss  3.65 | ppl    38.57 
| epoch  36 |   200/  269 batches | lr 0.00030 | ms/batch 73.06 | loss  3.63 | ppl    37.55 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 20.13s | valid loss  3.98 | valid ppl    53.46 | valid bpc    5.740
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 36.0%
| epoch  37 |   100/  269 batches | lr 0.00030 | ms/batch 74.61 | loss  3.61 | ppl    36.88 
| epoch  37 |   200/  269 batches | lr 0.00030 | ms/batch 73.11 | loss  3.61 | ppl    36.88 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 20.14s | valid loss  3.96 | valid ppl    52.58 | valid bpc    5.716
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 37.0%
| epoch  38 |   100/  269 batches | lr 0.00030 | ms/batch 74.36 | loss  3.57 | ppl    35.45 
| epoch  38 |   200/  269 batches | lr 0.00030 | ms/batch 73.16 | loss  3.59 | ppl    36.28 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 20.14s | valid loss  3.95 | valid ppl    52.16 | valid bpc    5.705
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 38.0%
| epoch  39 |   100/  269 batches | lr 0.00030 | ms/batch 74.57 | loss  3.54 | ppl    34.43 
| epoch  39 |   200/  269 batches | lr 0.00030 | ms/batch 73.15 | loss  3.54 | ppl    34.60 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 20.15s | valid loss  3.96 | valid ppl    52.20 | valid bpc    5.706
-----------------------------------------------------------------------------------------
PROGRESS: 39.0%
| epoch  40 |   100/  269 batches | lr 0.00030 | ms/batch 74.19 | loss  3.54 | ppl    34.36 
| epoch  40 |   200/  269 batches | lr 0.00030 | ms/batch 73.18 | loss  3.52 | ppl    33.77 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 20.14s | valid loss  3.91 | valid ppl    50.04 | valid bpc    5.645
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 40.0%
| epoch  41 |   100/  269 batches | lr 0.00030 | ms/batch 74.43 | loss  3.48 | ppl    32.34 
| epoch  41 |   200/  269 batches | lr 0.00030 | ms/batch 73.32 | loss  3.50 | ppl    32.96 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 20.15s | valid loss  3.96 | valid ppl    52.41 | valid bpc    5.712
-----------------------------------------------------------------------------------------
PROGRESS: 41.0%
| epoch  42 |   100/  269 batches | lr 0.00030 | ms/batch 74.51 | loss  3.45 | ppl    31.50 
| epoch  42 |   200/  269 batches | lr 0.00030 | ms/batch 72.90 | loss  3.44 | ppl    31.15 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 20.16s | valid loss  3.93 | valid ppl    50.95 | valid bpc    5.671
-----------------------------------------------------------------------------------------
PROGRESS: 42.0%
| epoch  43 |   100/  269 batches | lr 0.00030 | ms/batch 74.72 | loss  3.40 | ppl    30.11 
| epoch  43 |   200/  269 batches | lr 0.00030 | ms/batch 73.00 | loss  3.45 | ppl    31.41 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 20.17s | valid loss  3.91 | valid ppl    49.99 | valid bpc    5.644
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 43.0%
| epoch  44 |   100/  269 batches | lr 0.00030 | ms/batch 74.47 | loss  3.40 | ppl    29.86 
| epoch  44 |   200/  269 batches | lr 0.00030 | ms/batch 73.00 | loss  3.40 | ppl    30.06 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 20.16s | valid loss  3.94 | valid ppl    51.57 | valid bpc    5.688
-----------------------------------------------------------------------------------------
PROGRESS: 44.0%
| epoch  45 |   100/  269 batches | lr 0.00030 | ms/batch 74.79 | loss  3.38 | ppl    29.35 
| epoch  45 |   200/  269 batches | lr 0.00030 | ms/batch 72.82 | loss  3.36 | ppl    28.78 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 20.15s | valid loss  3.90 | valid ppl    49.24 | valid bpc    5.622
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 45.0%
| epoch  46 |   100/  269 batches | lr 0.00030 | ms/batch 74.35 | loss  3.35 | ppl    28.63 
| epoch  46 |   200/  269 batches | lr 0.00030 | ms/batch 73.19 | loss  3.34 | ppl    28.10 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 20.15s | valid loss  3.91 | valid ppl    50.10 | valid bpc    5.647
-----------------------------------------------------------------------------------------
PROGRESS: 46.0%
| epoch  47 |   100/  269 batches | lr 0.00030 | ms/batch 74.41 | loss  3.33 | ppl    27.98 
| epoch  47 |   200/  269 batches | lr 0.00030 | ms/batch 72.94 | loss  3.29 | ppl    26.85 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 20.15s | valid loss  3.87 | valid ppl    47.91 | valid bpc    5.582
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 47.0%
| epoch  48 |   100/  269 batches | lr 0.00030 | ms/batch 74.66 | loss  3.29 | ppl    26.81 
| epoch  48 |   200/  269 batches | lr 0.00030 | ms/batch 73.07 | loss  3.30 | ppl    27.06 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 20.16s | valid loss  3.91 | valid ppl    50.02 | valid bpc    5.645
-----------------------------------------------------------------------------------------
PROGRESS: 48.0%
| epoch  49 |   100/  269 batches | lr 0.00030 | ms/batch 74.42 | loss  3.29 | ppl    26.83 
| epoch  49 |   200/  269 batches | lr 0.00030 | ms/batch 73.10 | loss  3.26 | ppl    26.01 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 20.17s | valid loss  3.84 | valid ppl    46.55 | valid bpc    5.541
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 49.0%
| epoch  50 |   100/  269 batches | lr 0.00030 | ms/batch 74.49 | loss  3.26 | ppl    25.93 
| epoch  50 |   200/  269 batches | lr 0.00030 | ms/batch 73.01 | loss  3.23 | ppl    25.19 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 20.14s | valid loss  3.91 | valid ppl    49.84 | valid bpc    5.639
-----------------------------------------------------------------------------------------
PROGRESS: 50.0%
| epoch  51 |   100/  269 batches | lr 0.00030 | ms/batch 74.32 | loss  3.24 | ppl    25.54 
| epoch  51 |   200/  269 batches | lr 0.00030 | ms/batch 73.01 | loss  3.20 | ppl    24.61 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 20.14s | valid loss  3.86 | valid ppl    47.53 | valid bpc    5.571
-----------------------------------------------------------------------------------------
PROGRESS: 51.0%
| epoch  52 |   100/  269 batches | lr 0.00030 | ms/batch 74.39 | loss  3.19 | ppl    24.34 
| epoch  52 |   200/  269 batches | lr 0.00030 | ms/batch 73.09 | loss  3.19 | ppl    24.38 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 20.14s | valid loss  3.94 | valid ppl    51.17 | valid bpc    5.677
-----------------------------------------------------------------------------------------
PROGRESS: 52.0%
| epoch  53 |   100/  269 batches | lr 0.00015 | ms/batch 74.35 | loss  3.14 | ppl    23.01 
| epoch  53 |   200/  269 batches | lr 0.00015 | ms/batch 73.07 | loss  3.08 | ppl    21.78 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 20.15s | valid loss  3.85 | valid ppl    46.91 | valid bpc    5.552
-----------------------------------------------------------------------------------------
PROGRESS: 53.0%
| epoch  54 |   100/  269 batches | lr 0.00015 | ms/batch 74.82 | loss  3.08 | ppl    21.80 
| epoch  54 |   200/  269 batches | lr 0.00015 | ms/batch 72.91 | loss  3.05 | ppl    21.03 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 20.17s | valid loss  3.86 | valid ppl    47.27 | valid bpc    5.563
-----------------------------------------------------------------------------------------
PROGRESS: 54.0%
| epoch  55 |   100/  269 batches | lr 0.00015 | ms/batch 74.68 | loss  3.03 | ppl    20.75 
| epoch  55 |   200/  269 batches | lr 0.00015 | ms/batch 73.18 | loss  3.02 | ppl    20.43 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 20.18s | valid loss  3.83 | valid ppl    45.91 | valid bpc    5.521
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  269 batches | lr 0.00015 | ms/batch 74.49 | loss  3.03 | ppl    20.76 
| epoch  56 |   200/  269 batches | lr 0.00015 | ms/batch 73.32 | loss  3.02 | ppl    20.40 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 20.16s | valid loss  3.82 | valid ppl    45.74 | valid bpc    5.515
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  269 batches | lr 0.00015 | ms/batch 74.41 | loss  3.00 | ppl    20.01 
| epoch  57 |   200/  269 batches | lr 0.00015 | ms/batch 73.16 | loss  2.99 | ppl    19.89 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 20.15s | valid loss  3.88 | valid ppl    48.55 | valid bpc    5.601
-----------------------------------------------------------------------------------------
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  269 batches | lr 0.00015 | ms/batch 74.34 | loss  2.98 | ppl    19.69 
| epoch  58 |   200/  269 batches | lr 0.00015 | ms/batch 73.11 | loss  2.94 | ppl    18.97 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 20.15s | valid loss  3.81 | valid ppl    45.10 | valid bpc    5.495
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  269 batches | lr 0.00015 | ms/batch 74.44 | loss  2.96 | ppl    19.29 
| epoch  59 |   200/  269 batches | lr 0.00015 | ms/batch 73.11 | loss  2.94 | ppl    18.98 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 20.15s | valid loss  3.85 | valid ppl    46.79 | valid bpc    5.548
-----------------------------------------------------------------------------------------
PROGRESS: 59.0%
| epoch  60 |   100/  269 batches | lr 0.00015 | ms/batch 74.31 | loss  2.95 | ppl    19.06 
| epoch  60 |   200/  269 batches | lr 0.00015 | ms/batch 73.15 | loss  2.90 | ppl    18.23 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 20.16s | valid loss  3.86 | valid ppl    47.67 | valid bpc    5.575
-----------------------------------------------------------------------------------------
PROGRESS: 60.0%
| epoch  61 |   100/  269 batches | lr 0.00015 | ms/batch 74.55 | loss  2.92 | ppl    18.52 
| epoch  61 |   200/  269 batches | lr 0.00015 | ms/batch 73.35 | loss  2.92 | ppl    18.58 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 20.18s | valid loss  3.86 | valid ppl    47.67 | valid bpc    5.575
-----------------------------------------------------------------------------------------
PROGRESS: 61.0%
| epoch  62 |   100/  269 batches | lr 0.00007 | ms/batch 74.64 | loss  2.88 | ppl    17.74 
| epoch  62 |   200/  269 batches | lr 0.00007 | ms/batch 73.19 | loss  2.87 | ppl    17.72 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 20.18s | valid loss  3.80 | valid ppl    44.84 | valid bpc    5.487
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 62.0%
| epoch  63 |   100/  269 batches | lr 0.00007 | ms/batch 74.42 | loss  2.87 | ppl    17.63 
| epoch  63 |   200/  269 batches | lr 0.00007 | ms/batch 73.16 | loss  2.82 | ppl    16.82 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 20.16s | valid loss  3.79 | valid ppl    44.21 | valid bpc    5.466
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 63.0%
| epoch  64 |   100/  269 batches | lr 0.00007 | ms/batch 74.24 | loss  2.84 | ppl    17.20 
| epoch  64 |   200/  269 batches | lr 0.00007 | ms/batch 73.11 | loss  2.84 | ppl    17.08 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 20.15s | valid loss  3.82 | valid ppl    45.69 | valid bpc    5.514
-----------------------------------------------------------------------------------------
PROGRESS: 64.0%
| epoch  65 |   100/  269 batches | lr 0.00007 | ms/batch 74.42 | loss  2.82 | ppl    16.81 
| epoch  65 |   200/  269 batches | lr 0.00007 | ms/batch 73.24 | loss  2.82 | ppl    16.78 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 20.16s | valid loss  3.82 | valid ppl    45.67 | valid bpc    5.513
-----------------------------------------------------------------------------------------
PROGRESS: 65.0%
| epoch  66 |   100/  269 batches | lr 0.00007 | ms/batch 74.37 | loss  2.82 | ppl    16.83 
| epoch  66 |   200/  269 batches | lr 0.00007 | ms/batch 73.34 | loss  2.82 | ppl    16.74 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 20.17s | valid loss  3.81 | valid ppl    45.28 | valid bpc    5.501
-----------------------------------------------------------------------------------------
PROGRESS: 66.0%
| epoch  67 |   100/  269 batches | lr 0.00004 | ms/batch 74.70 | loss  2.78 | ppl    16.10 
| epoch  67 |   200/  269 batches | lr 0.00004 | ms/batch 73.20 | loss  2.77 | ppl    15.96 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 20.17s | valid loss  3.82 | valid ppl    45.38 | valid bpc    5.504
-----------------------------------------------------------------------------------------
PROGRESS: 67.0%
| epoch  68 |   100/  269 batches | lr 0.00004 | ms/batch 74.44 | loss  2.78 | ppl    16.17 
| epoch  68 |   200/  269 batches | lr 0.00004 | ms/batch 72.94 | loss  2.74 | ppl    15.55 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 20.17s | valid loss  3.76 | valid ppl    43.11 | valid bpc    5.430
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 68.0%
| epoch  69 |   100/  269 batches | lr 0.00004 | ms/batch 74.48 | loss  2.80 | ppl    16.42 
| epoch  69 |   200/  269 batches | lr 0.00004 | ms/batch 73.35 | loss  2.73 | ppl    15.38 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 20.16s | valid loss  3.77 | valid ppl    43.46 | valid bpc    5.442
-----------------------------------------------------------------------------------------
PROGRESS: 69.0%
| epoch  70 |   100/  269 batches | lr 0.00004 | ms/batch 74.28 | loss  2.76 | ppl    15.76 
| epoch  70 |   200/  269 batches | lr 0.00004 | ms/batch 73.38 | loss  2.74 | ppl    15.41 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 20.15s | valid loss  3.79 | valid ppl    44.31 | valid bpc    5.469
-----------------------------------------------------------------------------------------
PROGRESS: 70.0%
| epoch  71 |   100/  269 batches | lr 0.00004 | ms/batch 74.69 | loss  2.76 | ppl    15.77 
| epoch  71 |   200/  269 batches | lr 0.00004 | ms/batch 72.91 | loss  2.73 | ppl    15.29 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 20.15s | valid loss  3.81 | valid ppl    45.20 | valid bpc    5.498
-----------------------------------------------------------------------------------------
PROGRESS: 71.0%
| epoch  72 |   100/  269 batches | lr 0.00002 | ms/batch 74.24 | loss  2.75 | ppl    15.64 
| epoch  72 |   200/  269 batches | lr 0.00002 | ms/batch 73.44 | loss  2.72 | ppl    15.11 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 20.16s | valid loss  3.77 | valid ppl    43.44 | valid bpc    5.441
-----------------------------------------------------------------------------------------
PROGRESS: 72.0%
| epoch  73 |   100/  269 batches | lr 0.00002 | ms/batch 74.67 | loss  2.75 | ppl    15.67 
| epoch  73 |   200/  269 batches | lr 0.00002 | ms/batch 73.04 | loss  2.71 | ppl    15.05 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 20.15s | valid loss  3.82 | valid ppl    45.81 | valid bpc    5.518
-----------------------------------------------------------------------------------------
PROGRESS: 73.0%
| epoch  74 |   100/  269 batches | lr 0.00002 | ms/batch 74.46 | loss  2.73 | ppl    15.35 
| epoch  74 |   200/  269 batches | lr 0.00002 | ms/batch 73.00 | loss  2.72 | ppl    15.17 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 20.16s | valid loss  3.78 | valid ppl    43.69 | valid bpc    5.449
-----------------------------------------------------------------------------------------
PROGRESS: 74.0%
| epoch  75 |   100/  269 batches | lr 0.00001 | ms/batch 74.38 | loss  2.72 | ppl    15.15 
| epoch  75 |   200/  269 batches | lr 0.00001 | ms/batch 73.43 | loss  2.72 | ppl    15.11 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 20.17s | valid loss  3.85 | valid ppl    46.89 | valid bpc    5.551
-----------------------------------------------------------------------------------------
PROGRESS: 75.0%
| epoch  76 |   100/  269 batches | lr 0.00001 | ms/batch 74.48 | loss  2.74 | ppl    15.49 
| epoch  76 |   200/  269 batches | lr 0.00001 | ms/batch 72.87 | loss  2.70 | ppl    14.90 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 20.16s | valid loss  3.76 | valid ppl    42.90 | valid bpc    5.423
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 76.0%
| epoch  77 |   100/  269 batches | lr 0.00001 | ms/batch 74.28 | loss  2.71 | ppl    15.06 
| epoch  77 |   200/  269 batches | lr 0.00001 | ms/batch 73.51 | loss  2.70 | ppl    14.90 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 20.16s | valid loss  3.79 | valid ppl    44.19 | valid bpc    5.466
-----------------------------------------------------------------------------------------
PROGRESS: 77.0%
| epoch  78 |   100/  269 batches | lr 0.00001 | ms/batch 74.31 | loss  2.70 | ppl    14.84 
| epoch  78 |   200/  269 batches | lr 0.00001 | ms/batch 73.18 | loss  2.70 | ppl    14.88 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 20.15s | valid loss  3.78 | valid ppl    43.68 | valid bpc    5.449
-----------------------------------------------------------------------------------------
PROGRESS: 78.0%
| epoch  79 |   100/  269 batches | lr 0.00001 | ms/batch 74.38 | loss  2.73 | ppl    15.29 
| epoch  79 |   200/  269 batches | lr 0.00001 | ms/batch 72.85 | loss  2.68 | ppl    14.63 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 20.15s | valid loss  3.79 | valid ppl    44.16 | valid bpc    5.465
-----------------------------------------------------------------------------------------
PROGRESS: 79.0%
| epoch  80 |   100/  269 batches | lr 0.00000 | ms/batch 74.29 | loss  2.70 | ppl    14.81 
| epoch  80 |   200/  269 batches | lr 0.00000 | ms/batch 73.16 | loss  2.69 | ppl    14.74 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 20.17s | valid loss  3.76 | valid ppl    42.93 | valid bpc    5.424
-----------------------------------------------------------------------------------------
PROGRESS: 80.0%
| epoch  81 |   100/  269 batches | lr 0.00000 | ms/batch 74.55 | loss  2.73 | ppl    15.27 
| epoch  81 |   200/  269 batches | lr 0.00000 | ms/batch 73.22 | loss  2.69 | ppl    14.69 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 20.16s | valid loss  3.78 | valid ppl    43.99 | valid bpc    5.459
-----------------------------------------------------------------------------------------
PROGRESS: 81.0%
| epoch  82 |   100/  269 batches | lr 0.00000 | ms/batch 74.30 | loss  2.71 | ppl    14.98 
| epoch  82 |   200/  269 batches | lr 0.00000 | ms/batch 73.05 | loss  2.70 | ppl    14.95 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 20.16s | valid loss  3.76 | valid ppl    42.87 | valid bpc    5.422
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 82.0%
| epoch  83 |   100/  269 batches | lr 0.00000 | ms/batch 74.42 | loss  2.72 | ppl    15.16 
| epoch  83 |   200/  269 batches | lr 0.00000 | ms/batch 72.91 | loss  2.68 | ppl    14.59 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 20.16s | valid loss  3.73 | valid ppl    41.63 | valid bpc    5.380
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 83.0%
| epoch  84 |   100/  269 batches | lr 0.00000 | ms/batch 74.68 | loss  2.72 | ppl    15.21 
| epoch  84 |   200/  269 batches | lr 0.00000 | ms/batch 73.00 | loss  2.70 | ppl    14.88 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 20.15s | valid loss  3.76 | valid ppl    42.74 | valid bpc    5.418
-----------------------------------------------------------------------------------------
PROGRESS: 84.0%
| epoch  85 |   100/  269 batches | lr 0.00000 | ms/batch 74.33 | loss  2.71 | ppl    15.03 
| epoch  85 |   200/  269 batches | lr 0.00000 | ms/batch 72.74 | loss  2.68 | ppl    14.52 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 20.14s | valid loss  3.78 | valid ppl    43.94 | valid bpc    5.457
-----------------------------------------------------------------------------------------
PROGRESS: 85.0%
| epoch  86 |   100/  269 batches | lr 0.00000 | ms/batch 74.42 | loss  2.70 | ppl    14.84 
| epoch  86 |   200/  269 batches | lr 0.00000 | ms/batch 73.39 | loss  2.68 | ppl    14.61 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 20.16s | valid loss  3.79 | valid ppl    44.21 | valid bpc    5.466
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  269 batches | lr 0.00000 | ms/batch 74.65 | loss  2.72 | ppl    15.17 
| epoch  87 |   200/  269 batches | lr 0.00000 | ms/batch 72.92 | loss  2.68 | ppl    14.54 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 20.15s | valid loss  3.82 | valid ppl    45.67 | valid bpc    5.513
-----------------------------------------------------------------------------------------
PROGRESS: 87.0%
| epoch  88 |   100/  269 batches | lr 0.00000 | ms/batch 74.39 | loss  2.71 | ppl    15.02 
| epoch  88 |   200/  269 batches | lr 0.00000 | ms/batch 72.83 | loss  2.68 | ppl    14.61 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 20.15s | valid loss  3.78 | valid ppl    43.83 | valid bpc    5.454
-----------------------------------------------------------------------------------------
PROGRESS: 88.0%
| epoch  89 |   100/  269 batches | lr 0.00000 | ms/batch 74.76 | loss  2.72 | ppl    15.17 
| epoch  89 |   200/  269 batches | lr 0.00000 | ms/batch 73.06 | loss  2.68 | ppl    14.63 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 20.16s | valid loss  3.82 | valid ppl    45.61 | valid bpc    5.511
-----------------------------------------------------------------------------------------
PROGRESS: 89.0%
| epoch  90 |   100/  269 batches | lr 0.00000 | ms/batch 74.48 | loss  2.68 | ppl    14.62 
| epoch  90 |   200/  269 batches | lr 0.00000 | ms/batch 72.98 | loss  2.66 | ppl    14.28 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 20.15s | valid loss  3.78 | valid ppl    43.87 | valid bpc    5.455
-----------------------------------------------------------------------------------------
PROGRESS: 90.0%
| epoch  91 |   100/  269 batches | lr 0.00000 | ms/batch 74.76 | loss  2.71 | ppl    15.05 
| epoch  91 |   200/  269 batches | lr 0.00000 | ms/batch 73.03 | loss  2.68 | ppl    14.56 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 20.16s | valid loss  3.78 | valid ppl    43.66 | valid bpc    5.448
-----------------------------------------------------------------------------------------
PROGRESS: 91.0%
| epoch  92 |   100/  269 batches | lr 0.00000 | ms/batch 74.46 | loss  2.71 | ppl    14.97 
| epoch  92 |   200/  269 batches | lr 0.00000 | ms/batch 73.24 | loss  2.68 | ppl    14.65 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 20.15s | valid loss  3.79 | valid ppl    44.45 | valid bpc    5.474
-----------------------------------------------------------------------------------------
PROGRESS: 92.0%
| epoch  93 |   100/  269 batches | lr 0.00000 | ms/batch 74.44 | loss  2.71 | ppl    15.01 
| epoch  93 |   200/  269 batches | lr 0.00000 | ms/batch 72.92 | loss  2.67 | ppl    14.44 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 20.16s | valid loss  3.81 | valid ppl    44.95 | valid bpc    5.490
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  269 batches | lr 0.00000 | ms/batch 74.29 | loss  2.70 | ppl    14.95 
| epoch  94 |   200/  269 batches | lr 0.00000 | ms/batch 73.12 | loss  2.68 | ppl    14.60 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 20.16s | valid loss  3.81 | valid ppl    45.03 | valid bpc    5.493
-----------------------------------------------------------------------------------------
PROGRESS: 94.0%
| epoch  95 |   100/  269 batches | lr 0.00000 | ms/batch 74.33 | loss  2.71 | ppl    15.01 
| epoch  95 |   200/  269 batches | lr 0.00000 | ms/batch 73.49 | loss  2.67 | ppl    14.45 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 20.16s | valid loss  3.80 | valid ppl    44.67 | valid bpc    5.481
-----------------------------------------------------------------------------------------
PROGRESS: 95.0%
| epoch  96 |   100/  269 batches | lr 0.00000 | ms/batch 74.72 | loss  2.72 | ppl    15.12 
| epoch  96 |   200/  269 batches | lr 0.00000 | ms/batch 73.13 | loss  2.68 | ppl    14.57 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 20.17s | valid loss  3.85 | valid ppl    46.78 | valid bpc    5.548
-----------------------------------------------------------------------------------------
PROGRESS: 96.0%
| epoch  97 |   100/  269 batches | lr 0.00000 | ms/batch 74.58 | loss  2.71 | ppl    15.06 
| epoch  97 |   200/  269 batches | lr 0.00000 | ms/batch 72.93 | loss  2.68 | ppl    14.53 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 20.16s | valid loss  3.81 | valid ppl    45.07 | valid bpc    5.494
-----------------------------------------------------------------------------------------
PROGRESS: 97.0%
| epoch  98 |   100/  269 batches | lr 0.00000 | ms/batch 74.59 | loss  2.69 | ppl    14.71 
| epoch  98 |   200/  269 batches | lr 0.00000 | ms/batch 72.90 | loss  2.69 | ppl    14.70 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 20.16s | valid loss  3.80 | valid ppl    44.51 | valid bpc    5.476
-----------------------------------------------------------------------------------------
PROGRESS: 98.0%
| epoch  99 |   100/  269 batches | lr 0.00000 | ms/batch 74.38 | loss  2.71 | ppl    14.96 
| epoch  99 |   200/  269 batches | lr 0.00000 | ms/batch 73.19 | loss  2.67 | ppl    14.44 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 20.17s | valid loss  3.81 | valid ppl    44.95 | valid bpc    5.490
-----------------------------------------------------------------------------------------
PROGRESS: 99.0%
| epoch 100 |   100/  269 batches | lr 0.00000 | ms/batch 74.44 | loss  2.69 | ppl    14.70 
| epoch 100 |   200/  269 batches | lr 0.00000 | ms/batch 73.15 | loss  2.66 | ppl    14.25 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 20.17s | valid loss  3.82 | valid ppl    45.72 | valid bpc    5.515
-----------------------------------------------------------------------------------------
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  3.87 | test ppl    47.96 | test bpc    5.584
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.4418, Mean Reca: 0.6218, Mean F1: 0.5124, Mean Subword_Reca: 0.8759
-----------------------------------------------------------------------------------------
=========================================================================================
Loading dataset...
Using subword tokenizer...
Number of tokens:  8000
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer_in_parser', nhid=512, nlayers=8, front_layers=7, rear_layers=1, subword='omarmomen/ptb_filtered_lowcase_bpe_tokenizer_8', n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=2222, nonmono=5, cuda=True, log_interval=100, save='trained_models/subword_structformer_in_parser_2222_71.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 37449044
Model architecture: StructFormer_In_Parser(
  (transformer_front): Transformer_Front(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(8000, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-6): 7 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
  (transformer_rear): Transformer_Rear(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(8000, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0): TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (output_layer): Linear(in_features=512, out_features=8000, bias=True)
  )
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  269 batches | lr 0.00030 | ms/batch 77.35 | loss  7.77 | ppl  2376.69 
| epoch   1 |   200/  269 batches | lr 0.00030 | ms/batch 71.81 | loss  7.40 | ppl  1638.03 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 20.23s | valid loss  7.09 | valid ppl  1195.40 | valid bpc   10.223
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  269 batches | lr 0.00030 | ms/batch 73.54 | loss  7.30 | ppl  1483.04 
| epoch   2 |   200/  269 batches | lr 0.00030 | ms/batch 72.28 | loss  7.15 | ppl  1276.56 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 19.93s | valid loss  6.71 | valid ppl   822.82 | valid bpc    9.684
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  269 batches | lr 0.00030 | ms/batch 74.17 | loss  6.84 | ppl   931.13 
| epoch   3 |   200/  269 batches | lr 0.00030 | ms/batch 72.57 | loss  6.51 | ppl   674.84 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 20.02s | valid loss  6.07 | valid ppl   431.68 | valid bpc    8.754
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  269 batches | lr 0.00030 | ms/batch 73.87 | loss  6.22 | ppl   501.49 
| epoch   4 |   200/  269 batches | lr 0.00030 | ms/batch 72.87 | loss  6.05 | ppl   422.01 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 20.06s | valid loss  5.73 | valid ppl   308.07 | valid bpc    8.267
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  269 batches | lr 0.00030 | ms/batch 74.16 | loss  5.87 | ppl   355.87 
| epoch   5 |   200/  269 batches | lr 0.00030 | ms/batch 72.96 | loss  5.76 | ppl   316.89 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 20.09s | valid loss  5.47 | valid ppl   236.44 | valid bpc    7.885
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  269 batches | lr 0.00030 | ms/batch 74.03 | loss  5.67 | ppl   288.76 
| epoch   6 |   200/  269 batches | lr 0.00030 | ms/batch 73.41 | loss  5.56 | ppl   260.55 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 20.12s | valid loss  5.34 | valid ppl   209.12 | valid bpc    7.708
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  269 batches | lr 0.00030 | ms/batch 74.41 | loss  5.51 | ppl   248.19 
| epoch   7 |   200/  269 batches | lr 0.00030 | ms/batch 73.31 | loss  5.44 | ppl   231.31 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 20.14s | valid loss  5.17 | valid ppl   175.48 | valid bpc    7.455
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  269 batches | lr 0.00030 | ms/batch 74.50 | loss  5.39 | ppl   218.85 
| epoch   8 |   200/  269 batches | lr 0.00030 | ms/batch 72.79 | loss  5.30 | ppl   200.38 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 20.13s | valid loss  5.05 | valid ppl   155.94 | valid bpc    7.285
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 8.0%
| epoch   9 |   100/  269 batches | lr 0.00030 | ms/batch 74.37 | loss  5.26 | ppl   192.16 
| epoch   9 |   200/  269 batches | lr 0.00030 | ms/batch 72.90 | loss  5.16 | ppl   174.72 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 20.14s | valid loss  4.99 | valid ppl   146.83 | valid bpc    7.198
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  269 batches | lr 0.00030 | ms/batch 74.60 | loss  5.13 | ppl   169.72 
| epoch  10 |   200/  269 batches | lr 0.00030 | ms/batch 72.91 | loss  5.08 | ppl   160.20 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 20.13s | valid loss  4.90 | valid ppl   133.63 | valid bpc    7.062
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  269 batches | lr 0.00030 | ms/batch 74.23 | loss  5.06 | ppl   157.43 
| epoch  11 |   200/  269 batches | lr 0.00030 | ms/batch 73.33 | loss  4.99 | ppl   146.33 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 20.15s | valid loss  4.84 | valid ppl   125.85 | valid bpc    6.976
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  269 batches | lr 0.00030 | ms/batch 74.46 | loss  4.96 | ppl   142.46 
| epoch  12 |   200/  269 batches | lr 0.00030 | ms/batch 72.96 | loss  4.89 | ppl   133.08 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 20.16s | valid loss  4.75 | valid ppl   115.31 | valid bpc    6.849
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 12.0%
| epoch  13 |   100/  269 batches | lr 0.00030 | ms/batch 74.36 | loss  4.86 | ppl   128.82 
| epoch  13 |   200/  269 batches | lr 0.00030 | ms/batch 72.91 | loss  4.80 | ppl   121.77 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 20.15s | valid loss  4.66 | valid ppl   105.89 | valid bpc    6.726
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 13.0%
| epoch  14 |   100/  269 batches | lr 0.00030 | ms/batch 74.66 | loss  4.79 | ppl   120.19 
| epoch  14 |   200/  269 batches | lr 0.00030 | ms/batch 73.07 | loss  4.74 | ppl   114.87 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 20.15s | valid loss  4.59 | valid ppl    98.14 | valid bpc    6.617
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  269 batches | lr 0.00030 | ms/batch 74.31 | loss  4.70 | ppl   109.46 
| epoch  15 |   200/  269 batches | lr 0.00030 | ms/batch 73.13 | loss  4.65 | ppl   104.35 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 20.12s | valid loss  4.54 | valid ppl    93.37 | valid bpc    6.545
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 15.0%
| epoch  16 |   100/  269 batches | lr 0.00030 | ms/batch 74.41 | loss  4.62 | ppl   101.82 
| epoch  16 |   200/  269 batches | lr 0.00030 | ms/batch 73.05 | loss  4.57 | ppl    96.71 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 20.14s | valid loss  4.52 | valid ppl    91.84 | valid bpc    6.521
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 16.0%
| epoch  17 |   100/  269 batches | lr 0.00030 | ms/batch 74.11 | loss  4.54 | ppl    93.68 
| epoch  17 |   200/  269 batches | lr 0.00030 | ms/batch 73.47 | loss  4.52 | ppl    91.82 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 20.14s | valid loss  4.51 | valid ppl    90.62 | valid bpc    6.502
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 17.0%
| epoch  18 |   100/  269 batches | lr 0.00030 | ms/batch 74.27 | loss  4.48 | ppl    87.88 
| epoch  18 |   200/  269 batches | lr 0.00030 | ms/batch 72.91 | loss  4.45 | ppl    86.04 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 20.15s | valid loss  4.40 | valid ppl    81.23 | valid bpc    6.344
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 18.0%
| epoch  19 |   100/  269 batches | lr 0.00030 | ms/batch 74.49 | loss  4.46 | ppl    86.22 
| epoch  19 |   200/  269 batches | lr 0.00030 | ms/batch 73.07 | loss  4.38 | ppl    79.99 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 20.15s | valid loss  4.39 | valid ppl    80.33 | valid bpc    6.328
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 19.0%
| epoch  20 |   100/  269 batches | lr 0.00030 | ms/batch 74.50 | loss  4.39 | ppl    80.57 
| epoch  20 |   200/  269 batches | lr 0.00030 | ms/batch 73.14 | loss  4.34 | ppl    76.96 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 20.15s | valid loss  4.30 | valid ppl    73.58 | valid bpc    6.201
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 20.0%
| epoch  21 |   100/  269 batches | lr 0.00030 | ms/batch 74.46 | loss  4.30 | ppl    73.82 
| epoch  21 |   200/  269 batches | lr 0.00030 | ms/batch 72.94 | loss  4.26 | ppl    70.93 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 20.14s | valid loss  4.26 | valid ppl    71.10 | valid bpc    6.152
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 21.0%
| epoch  22 |   100/  269 batches | lr 0.00030 | ms/batch 74.25 | loss  4.24 | ppl    69.47 
| epoch  22 |   200/  269 batches | lr 0.00030 | ms/batch 73.09 | loss  4.23 | ppl    68.49 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 20.13s | valid loss  4.27 | valid ppl    71.34 | valid bpc    6.157
-----------------------------------------------------------------------------------------
PROGRESS: 22.0%
| epoch  23 |   100/  269 batches | lr 0.00030 | ms/batch 74.78 | loss  4.21 | ppl    67.34 
| epoch  23 |   200/  269 batches | lr 0.00030 | ms/batch 72.90 | loss  4.16 | ppl    63.84 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 20.16s | valid loss  4.22 | valid ppl    67.85 | valid bpc    6.084
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 23.0%
| epoch  24 |   100/  269 batches | lr 0.00030 | ms/batch 74.21 | loss  4.16 | ppl    63.89 
| epoch  24 |   200/  269 batches | lr 0.00030 | ms/batch 73.47 | loss  4.11 | ppl    61.19 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 20.14s | valid loss  4.19 | valid ppl    66.20 | valid bpc    6.049
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 24.0%
| epoch  25 |   100/  269 batches | lr 0.00030 | ms/batch 74.60 | loss  4.10 | ppl    60.31 
| epoch  25 |   200/  269 batches | lr 0.00030 | ms/batch 72.96 | loss  4.09 | ppl    59.64 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 20.14s | valid loss  4.21 | valid ppl    67.27 | valid bpc    6.072
-----------------------------------------------------------------------------------------
PROGRESS: 25.0%
| epoch  26 |   100/  269 batches | lr 0.00030 | ms/batch 74.49 | loss  4.04 | ppl    57.02 
| epoch  26 |   200/  269 batches | lr 0.00030 | ms/batch 73.10 | loss  4.02 | ppl    55.64 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 20.16s | valid loss  4.16 | valid ppl    64.07 | valid bpc    6.002
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 26.0%
| epoch  27 |   100/  269 batches | lr 0.00030 | ms/batch 74.77 | loss  3.99 | ppl    54.16 
| epoch  27 |   200/  269 batches | lr 0.00030 | ms/batch 73.01 | loss  3.97 | ppl    53.21 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 20.16s | valid loss  4.13 | valid ppl    61.90 | valid bpc    5.952
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 27.0%
| epoch  28 |   100/  269 batches | lr 0.00030 | ms/batch 74.52 | loss  3.98 | ppl    53.54 
| epoch  28 |   200/  269 batches | lr 0.00030 | ms/batch 72.93 | loss  3.94 | ppl    51.68 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 20.14s | valid loss  4.06 | valid ppl    58.19 | valid bpc    5.863
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  269 batches | lr 0.00030 | ms/batch 74.36 | loss  3.90 | ppl    49.23 
| epoch  29 |   200/  269 batches | lr 0.00030 | ms/batch 73.21 | loss  3.90 | ppl    49.40 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 20.13s | valid loss  4.06 | valid ppl    57.73 | valid bpc    5.851
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  269 batches | lr 0.00030 | ms/batch 74.62 | loss  3.88 | ppl    48.46 
| epoch  30 |   200/  269 batches | lr 0.00030 | ms/batch 73.15 | loss  3.86 | ppl    47.47 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 20.15s | valid loss  4.07 | valid ppl    58.57 | valid bpc    5.872
-----------------------------------------------------------------------------------------
PROGRESS: 30.0%
| epoch  31 |   100/  269 batches | lr 0.00030 | ms/batch 74.37 | loss  3.84 | ppl    46.47 
| epoch  31 |   200/  269 batches | lr 0.00030 | ms/batch 73.16 | loss  3.82 | ppl    45.80 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 20.16s | valid loss  4.04 | valid ppl    56.95 | valid bpc    5.832
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 31.0%
| epoch  32 |   100/  269 batches | lr 0.00030 | ms/batch 74.65 | loss  3.81 | ppl    45.24 
| epoch  32 |   200/  269 batches | lr 0.00030 | ms/batch 73.14 | loss  3.78 | ppl    43.64 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 20.15s | valid loss  3.99 | valid ppl    53.96 | valid bpc    5.754
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 32.0%
| epoch  33 |   100/  269 batches | lr 0.00030 | ms/batch 74.64 | loss  3.76 | ppl    42.95 
| epoch  33 |   200/  269 batches | lr 0.00030 | ms/batch 73.10 | loss  3.75 | ppl    42.37 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 20.15s | valid loss  3.97 | valid ppl    52.84 | valid bpc    5.724
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 33.0%
| epoch  34 |   100/  269 batches | lr 0.00030 | ms/batch 74.54 | loss  3.73 | ppl    41.59 
| epoch  34 |   200/  269 batches | lr 0.00030 | ms/batch 73.19 | loss  3.71 | ppl    40.78 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 20.14s | valid loss  3.96 | valid ppl    52.48 | valid bpc    5.714
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 34.0%
| epoch  35 |   100/  269 batches | lr 0.00030 | ms/batch 74.43 | loss  3.70 | ppl    40.43 
| epoch  35 |   200/  269 batches | lr 0.00030 | ms/batch 73.15 | loss  3.67 | ppl    39.13 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 20.15s | valid loss  3.98 | valid ppl    53.74 | valid bpc    5.748
-----------------------------------------------------------------------------------------
PROGRESS: 35.0%
| epoch  36 |   100/  269 batches | lr 0.00030 | ms/batch 74.50 | loss  3.66 | ppl    38.69 
| epoch  36 |   200/  269 batches | lr 0.00030 | ms/batch 72.99 | loss  3.66 | ppl    38.98 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 20.14s | valid loss  3.91 | valid ppl    50.12 | valid bpc    5.647
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 36.0%
| epoch  37 |   100/  269 batches | lr 0.00030 | ms/batch 74.27 | loss  3.62 | ppl    37.18 
| epoch  37 |   200/  269 batches | lr 0.00030 | ms/batch 72.95 | loss  3.60 | ppl    36.55 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 20.14s | valid loss  3.97 | valid ppl    52.85 | valid bpc    5.724
-----------------------------------------------------------------------------------------
PROGRESS: 37.0%
| epoch  38 |   100/  269 batches | lr 0.00030 | ms/batch 74.33 | loss  3.57 | ppl    35.40 
| epoch  38 |   200/  269 batches | lr 0.00030 | ms/batch 73.29 | loss  3.58 | ppl    35.91 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 20.14s | valid loss  3.96 | valid ppl    52.32 | valid bpc    5.709
-----------------------------------------------------------------------------------------
PROGRESS: 38.0%
| epoch  39 |   100/  269 batches | lr 0.00030 | ms/batch 74.55 | loss  3.56 | ppl    35.33 
| epoch  39 |   200/  269 batches | lr 0.00030 | ms/batch 72.76 | loss  3.53 | ppl    33.99 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 20.15s | valid loss  3.95 | valid ppl    51.91 | valid bpc    5.698
-----------------------------------------------------------------------------------------
PROGRESS: 39.0%
| epoch  40 |   100/  269 batches | lr 0.00015 | ms/batch 74.46 | loss  3.46 | ppl    31.78 
| epoch  40 |   200/  269 batches | lr 0.00015 | ms/batch 72.84 | loss  3.45 | ppl    31.36 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 20.15s | valid loss  3.87 | valid ppl    48.05 | valid bpc    5.586
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 40.0%
| epoch  41 |   100/  269 batches | lr 0.00015 | ms/batch 74.83 | loss  3.41 | ppl    30.36 
| epoch  41 |   200/  269 batches | lr 0.00015 | ms/batch 72.95 | loss  3.43 | ppl    31.00 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 20.16s | valid loss  3.88 | valid ppl    48.31 | valid bpc    5.594
-----------------------------------------------------------------------------------------
PROGRESS: 41.0%
| epoch  42 |   100/  269 batches | lr 0.00015 | ms/batch 74.32 | loss  3.37 | ppl    29.13 
| epoch  42 |   200/  269 batches | lr 0.00015 | ms/batch 72.89 | loss  3.39 | ppl    29.77 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 20.13s | valid loss  3.87 | valid ppl    47.74 | valid bpc    5.577
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 42.0%
| epoch  43 |   100/  269 batches | lr 0.00015 | ms/batch 74.44 | loss  3.36 | ppl    28.66 
| epoch  43 |   200/  269 batches | lr 0.00015 | ms/batch 73.08 | loss  3.34 | ppl    28.26 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 20.13s | valid loss  3.88 | valid ppl    48.23 | valid bpc    5.592
-----------------------------------------------------------------------------------------
PROGRESS: 43.0%
| epoch  44 |   100/  269 batches | lr 0.00015 | ms/batch 74.23 | loss  3.33 | ppl    27.92 
| epoch  44 |   200/  269 batches | lr 0.00015 | ms/batch 73.23 | loss  3.32 | ppl    27.59 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 20.16s | valid loss  3.82 | valid ppl    45.66 | valid bpc    5.513
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 44.0%
| epoch  45 |   100/  269 batches | lr 0.00015 | ms/batch 74.38 | loss  3.33 | ppl    27.86 
| epoch  45 |   200/  269 batches | lr 0.00015 | ms/batch 73.16 | loss  3.30 | ppl    27.06 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 20.16s | valid loss  3.84 | valid ppl    46.33 | valid bpc    5.534
-----------------------------------------------------------------------------------------
PROGRESS: 45.0%
| epoch  46 |   100/  269 batches | lr 0.00015 | ms/batch 74.69 | loss  3.31 | ppl    27.34 
| epoch  46 |   200/  269 batches | lr 0.00015 | ms/batch 73.16 | loss  3.28 | ppl    26.65 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 20.17s | valid loss  3.84 | valid ppl    46.59 | valid bpc    5.542
-----------------------------------------------------------------------------------------
PROGRESS: 46.0%
| epoch  47 |   100/  269 batches | lr 0.00015 | ms/batch 74.63 | loss  3.27 | ppl    26.30 
| epoch  47 |   200/  269 batches | lr 0.00015 | ms/batch 73.13 | loss  3.27 | ppl    26.26 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 20.16s | valid loss  3.82 | valid ppl    45.50 | valid bpc    5.508
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 47.0%
| epoch  48 |   100/  269 batches | lr 0.00015 | ms/batch 74.65 | loss  3.26 | ppl    26.18 
| epoch  48 |   200/  269 batches | lr 0.00015 | ms/batch 73.27 | loss  3.26 | ppl    26.15 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 20.15s | valid loss  3.85 | valid ppl    46.93 | valid bpc    5.552
-----------------------------------------------------------------------------------------
PROGRESS: 48.0%
| epoch  49 |   100/  269 batches | lr 0.00015 | ms/batch 74.78 | loss  3.23 | ppl    25.41 
| epoch  49 |   200/  269 batches | lr 0.00015 | ms/batch 72.97 | loss  3.24 | ppl    25.56 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 20.17s | valid loss  3.78 | valid ppl    43.73 | valid bpc    5.451
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 49.0%
| epoch  50 |   100/  269 batches | lr 0.00015 | ms/batch 74.30 | loss  3.22 | ppl    25.14 
| epoch  50 |   200/  269 batches | lr 0.00015 | ms/batch 73.18 | loss  3.18 | ppl    24.05 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 20.14s | valid loss  3.84 | valid ppl    46.33 | valid bpc    5.534
-----------------------------------------------------------------------------------------
PROGRESS: 50.0%
| epoch  51 |   100/  269 batches | lr 0.00015 | ms/batch 74.48 | loss  3.22 | ppl    24.94 
| epoch  51 |   200/  269 batches | lr 0.00015 | ms/batch 73.32 | loss  3.18 | ppl    23.97 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 20.14s | valid loss  3.79 | valid ppl    44.38 | valid bpc    5.472
-----------------------------------------------------------------------------------------
PROGRESS: 51.0%
| epoch  52 |   100/  269 batches | lr 0.00015 | ms/batch 74.60 | loss  3.17 | ppl    23.89 
| epoch  52 |   200/  269 batches | lr 0.00015 | ms/batch 72.99 | loss  3.16 | ppl    23.54 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 20.14s | valid loss  3.84 | valid ppl    46.58 | valid bpc    5.542
-----------------------------------------------------------------------------------------
PROGRESS: 52.0%
| epoch  53 |   100/  269 batches | lr 0.00007 | ms/batch 74.29 | loss  3.16 | ppl    23.62 
| epoch  53 |   200/  269 batches | lr 0.00007 | ms/batch 72.82 | loss  3.10 | ppl    22.21 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 20.14s | valid loss  3.84 | valid ppl    46.31 | valid bpc    5.533
-----------------------------------------------------------------------------------------
PROGRESS: 53.0%
| epoch  54 |   100/  269 batches | lr 0.00007 | ms/batch 74.39 | loss  3.12 | ppl    22.62 
| epoch  54 |   200/  269 batches | lr 0.00007 | ms/batch 73.37 | loss  3.09 | ppl    21.99 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 20.17s | valid loss  3.84 | valid ppl    46.46 | valid bpc    5.538
-----------------------------------------------------------------------------------------
PROGRESS: 54.0%
| epoch  55 |   100/  269 batches | lr 0.00007 | ms/batch 74.50 | loss  3.10 | ppl    22.14 
| epoch  55 |   200/  269 batches | lr 0.00007 | ms/batch 73.19 | loss  3.09 | ppl    21.89 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 20.17s | valid loss  3.82 | valid ppl    45.74 | valid bpc    5.515
-----------------------------------------------------------------------------------------
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  269 batches | lr 0.00004 | ms/batch 74.61 | loss  3.10 | ppl    22.29 
| epoch  56 |   200/  269 batches | lr 0.00004 | ms/batch 73.23 | loss  3.03 | ppl    20.79 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 20.17s | valid loss  3.74 | valid ppl    42.14 | valid bpc    5.397
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  269 batches | lr 0.00004 | ms/batch 74.33 | loss  3.06 | ppl    21.31 
| epoch  57 |   200/  269 batches | lr 0.00004 | ms/batch 73.11 | loss  3.04 | ppl    20.89 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 20.15s | valid loss  3.76 | valid ppl    42.87 | valid bpc    5.422
-----------------------------------------------------------------------------------------
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  269 batches | lr 0.00004 | ms/batch 74.37 | loss  3.04 | ppl    21.00 
| epoch  58 |   200/  269 batches | lr 0.00004 | ms/batch 73.39 | loss  3.03 | ppl    20.65 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 20.15s | valid loss  3.79 | valid ppl    44.36 | valid bpc    5.471
-----------------------------------------------------------------------------------------
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  269 batches | lr 0.00004 | ms/batch 74.60 | loss  3.06 | ppl    21.42 
| epoch  59 |   200/  269 batches | lr 0.00004 | ms/batch 72.97 | loss  3.02 | ppl    20.51 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 20.15s | valid loss  3.75 | valid ppl    42.32 | valid bpc    5.403
-----------------------------------------------------------------------------------------
PROGRESS: 59.0%
| epoch  60 |   100/  269 batches | lr 0.00002 | ms/batch 74.27 | loss  3.03 | ppl    20.76 
| epoch  60 |   200/  269 batches | lr 0.00002 | ms/batch 73.02 | loss  3.03 | ppl    20.74 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 20.16s | valid loss  3.78 | valid ppl    43.90 | valid bpc    5.456
-----------------------------------------------------------------------------------------
PROGRESS: 60.0%
| epoch  61 |   100/  269 batches | lr 0.00002 | ms/batch 74.86 | loss  3.03 | ppl    20.72 
| epoch  61 |   200/  269 batches | lr 0.00002 | ms/batch 72.95 | loss  3.00 | ppl    20.05 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 20.16s | valid loss  3.81 | valid ppl    45.30 | valid bpc    5.502
-----------------------------------------------------------------------------------------
PROGRESS: 61.0%
| epoch  62 |   100/  269 batches | lr 0.00002 | ms/batch 74.72 | loss  3.03 | ppl    20.73 
| epoch  62 |   200/  269 batches | lr 0.00002 | ms/batch 73.23 | loss  2.99 | ppl    19.97 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 20.16s | valid loss  3.81 | valid ppl    44.95 | valid bpc    5.490
-----------------------------------------------------------------------------------------
PROGRESS: 62.0%
| epoch  63 |   100/  269 batches | lr 0.00001 | ms/batch 74.25 | loss  3.01 | ppl    20.31 
| epoch  63 |   200/  269 batches | lr 0.00001 | ms/batch 72.99 | loss  2.99 | ppl    19.91 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 20.14s | valid loss  3.78 | valid ppl    43.77 | valid bpc    5.452
-----------------------------------------------------------------------------------------
PROGRESS: 63.0%
| epoch  64 |   100/  269 batches | lr 0.00001 | ms/batch 74.13 | loss  3.00 | ppl    20.04 
| epoch  64 |   200/  269 batches | lr 0.00001 | ms/batch 73.47 | loss  2.98 | ppl    19.67 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 20.14s | valid loss  3.81 | valid ppl    44.95 | valid bpc    5.490
-----------------------------------------------------------------------------------------
PROGRESS: 64.0%
| epoch  65 |   100/  269 batches | lr 0.00001 | ms/batch 74.23 | loss  3.02 | ppl    20.44 
| epoch  65 |   200/  269 batches | lr 0.00001 | ms/batch 73.13 | loss  3.00 | ppl    20.15 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 20.16s | valid loss  3.76 | valid ppl    42.76 | valid bpc    5.418
-----------------------------------------------------------------------------------------
PROGRESS: 65.0%
| epoch  66 |   100/  269 batches | lr 0.00000 | ms/batch 74.55 | loss  3.01 | ppl    20.36 
| epoch  66 |   200/  269 batches | lr 0.00000 | ms/batch 73.15 | loss  2.99 | ppl    19.90 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 20.16s | valid loss  3.75 | valid ppl    42.55 | valid bpc    5.411
-----------------------------------------------------------------------------------------
PROGRESS: 66.0%
| epoch  67 |   100/  269 batches | lr 0.00000 | ms/batch 74.56 | loss  3.00 | ppl    20.12 
| epoch  67 |   200/  269 batches | lr 0.00000 | ms/batch 73.04 | loss  2.96 | ppl    19.27 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 20.16s | valid loss  3.76 | valid ppl    42.77 | valid bpc    5.418
-----------------------------------------------------------------------------------------
PROGRESS: 67.0%
| epoch  68 |   100/  269 batches | lr 0.00000 | ms/batch 74.52 | loss  3.01 | ppl    20.35 
| epoch  68 |   200/  269 batches | lr 0.00000 | ms/batch 73.14 | loss  2.97 | ppl    19.45 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 20.16s | valid loss  3.69 | valid ppl    39.97 | valid bpc    5.321
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 68.0%
| epoch  69 |   100/  269 batches | lr 0.00000 | ms/batch 74.34 | loss  2.99 | ppl    19.96 
| epoch  69 |   200/  269 batches | lr 0.00000 | ms/batch 73.03 | loss  2.99 | ppl    19.81 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 20.14s | valid loss  3.74 | valid ppl    42.19 | valid bpc    5.399
-----------------------------------------------------------------------------------------
PROGRESS: 69.0%
| epoch  70 |   100/  269 batches | lr 0.00000 | ms/batch 74.28 | loss  2.99 | ppl    19.84 
| epoch  70 |   200/  269 batches | lr 0.00000 | ms/batch 73.40 | loss  2.99 | ppl    19.91 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 20.15s | valid loss  3.77 | valid ppl    43.27 | valid bpc    5.435
-----------------------------------------------------------------------------------------
PROGRESS: 70.0%
| epoch  71 |   100/  269 batches | lr 0.00000 | ms/batch 74.34 | loss  3.00 | ppl    20.10 
| epoch  71 |   200/  269 batches | lr 0.00000 | ms/batch 73.21 | loss  2.96 | ppl    19.31 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 20.15s | valid loss  3.73 | valid ppl    41.79 | valid bpc    5.385
-----------------------------------------------------------------------------------------
PROGRESS: 71.0%
| epoch  72 |   100/  269 batches | lr 0.00000 | ms/batch 74.29 | loss  2.99 | ppl    19.94 
| epoch  72 |   200/  269 batches | lr 0.00000 | ms/batch 73.34 | loss  2.98 | ppl    19.70 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 20.15s | valid loss  3.76 | valid ppl    42.78 | valid bpc    5.419
-----------------------------------------------------------------------------------------
PROGRESS: 72.0%
| epoch  73 |   100/  269 batches | lr 0.00000 | ms/batch 74.64 | loss  3.00 | ppl    20.16 
| epoch  73 |   200/  269 batches | lr 0.00000 | ms/batch 73.09 | loss  2.98 | ppl    19.64 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 20.16s | valid loss  3.78 | valid ppl    43.70 | valid bpc    5.450
-----------------------------------------------------------------------------------------
PROGRESS: 73.0%
| epoch  74 |   100/  269 batches | lr 0.00000 | ms/batch 74.57 | loss  2.99 | ppl    19.95 
| epoch  74 |   200/  269 batches | lr 0.00000 | ms/batch 73.08 | loss  2.97 | ppl    19.49 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 20.15s | valid loss  3.78 | valid ppl    43.85 | valid bpc    5.455
-----------------------------------------------------------------------------------------
PROGRESS: 74.0%
| epoch  75 |   100/  269 batches | lr 0.00000 | ms/batch 74.43 | loss  2.99 | ppl    19.84 
| epoch  75 |   200/  269 batches | lr 0.00000 | ms/batch 73.30 | loss  2.99 | ppl    19.88 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 20.17s | valid loss  3.74 | valid ppl    42.25 | valid bpc    5.401
-----------------------------------------------------------------------------------------
PROGRESS: 75.0%
| epoch  76 |   100/  269 batches | lr 0.00000 | ms/batch 74.58 | loss  2.99 | ppl    19.86 
| epoch  76 |   200/  269 batches | lr 0.00000 | ms/batch 72.74 | loss  2.98 | ppl    19.67 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 20.15s | valid loss  3.76 | valid ppl    43.06 | valid bpc    5.428
-----------------------------------------------------------------------------------------
PROGRESS: 76.0%
| epoch  77 |   100/  269 batches | lr 0.00000 | ms/batch 74.54 | loss  3.01 | ppl    20.26 
| epoch  77 |   200/  269 batches | lr 0.00000 | ms/batch 73.22 | loss  2.96 | ppl    19.27 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 20.16s | valid loss  3.80 | valid ppl    44.53 | valid bpc    5.477
-----------------------------------------------------------------------------------------
PROGRESS: 77.0%
| epoch  78 |   100/  269 batches | lr 0.00000 | ms/batch 74.34 | loss  2.99 | ppl    19.82 
| epoch  78 |   200/  269 batches | lr 0.00000 | ms/batch 73.17 | loss  2.97 | ppl    19.46 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 20.15s | valid loss  3.82 | valid ppl    45.67 | valid bpc    5.513
-----------------------------------------------------------------------------------------
PROGRESS: 78.0%
| epoch  79 |   100/  269 batches | lr 0.00000 | ms/batch 74.19 | loss  2.98 | ppl    19.61 
| epoch  79 |   200/  269 batches | lr 0.00000 | ms/batch 73.25 | loss  2.96 | ppl    19.22 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 20.15s | valid loss  3.79 | valid ppl    44.34 | valid bpc    5.470
-----------------------------------------------------------------------------------------
PROGRESS: 79.0%
| epoch  80 |   100/  269 batches | lr 0.00000 | ms/batch 74.63 | loss  2.99 | ppl    19.92 
| epoch  80 |   200/  269 batches | lr 0.00000 | ms/batch 73.12 | loss  2.98 | ppl    19.60 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 20.16s | valid loss  3.79 | valid ppl    44.06 | valid bpc    5.461
-----------------------------------------------------------------------------------------
PROGRESS: 80.0%
| epoch  81 |   100/  269 batches | lr 0.00000 | ms/batch 74.78 | loss  3.00 | ppl    20.01 
| epoch  81 |   200/  269 batches | lr 0.00000 | ms/batch 72.92 | loss  2.95 | ppl    19.14 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 20.17s | valid loss  3.81 | valid ppl    45.36 | valid bpc    5.503
-----------------------------------------------------------------------------------------
PROGRESS: 81.0%
| epoch  82 |   100/  269 batches | lr 0.00000 | ms/batch 74.68 | loss  2.98 | ppl    19.75 
| epoch  82 |   200/  269 batches | lr 0.00000 | ms/batch 72.87 | loss  2.98 | ppl    19.64 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 20.16s | valid loss  3.82 | valid ppl    45.41 | valid bpc    5.505
-----------------------------------------------------------------------------------------
PROGRESS: 82.0%
| epoch  83 |   100/  269 batches | lr 0.00000 | ms/batch 74.67 | loss  2.98 | ppl    19.73 
| epoch  83 |   200/  269 batches | lr 0.00000 | ms/batch 73.16 | loss  2.96 | ppl    19.31 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 20.17s | valid loss  3.77 | valid ppl    43.34 | valid bpc    5.438
-----------------------------------------------------------------------------------------
PROGRESS: 83.0%
| epoch  84 |   100/  269 batches | lr 0.00000 | ms/batch 74.50 | loss  2.99 | ppl    19.98 
| epoch  84 |   200/  269 batches | lr 0.00000 | ms/batch 73.38 | loss  2.97 | ppl    19.42 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 20.16s | valid loss  3.79 | valid ppl    44.04 | valid bpc    5.461
-----------------------------------------------------------------------------------------
PROGRESS: 84.0%
| epoch  85 |   100/  269 batches | lr 0.00000 | ms/batch 74.55 | loss  2.99 | ppl    19.95 
| epoch  85 |   200/  269 batches | lr 0.00000 | ms/batch 73.13 | loss  2.97 | ppl    19.40 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 20.15s | valid loss  3.80 | valid ppl    44.73 | valid bpc    5.483
-----------------------------------------------------------------------------------------
PROGRESS: 85.0%
| epoch  86 |   100/  269 batches | lr 0.00000 | ms/batch 74.17 | loss  2.98 | ppl    19.72 
| epoch  86 |   200/  269 batches | lr 0.00000 | ms/batch 73.31 | loss  2.98 | ppl    19.75 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 20.14s | valid loss  3.79 | valid ppl    44.10 | valid bpc    5.463
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  269 batches | lr 0.00000 | ms/batch 74.51 | loss  2.99 | ppl    19.94 
| epoch  87 |   200/  269 batches | lr 0.00000 | ms/batch 73.08 | loss  2.97 | ppl    19.44 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 20.14s | valid loss  3.78 | valid ppl    43.85 | valid bpc    5.455
-----------------------------------------------------------------------------------------
PROGRESS: 87.0%
| epoch  88 |   100/  269 batches | lr 0.00000 | ms/batch 74.48 | loss  3.00 | ppl    20.17 
| epoch  88 |   200/  269 batches | lr 0.00000 | ms/batch 73.11 | loss  2.97 | ppl    19.45 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 20.15s | valid loss  3.78 | valid ppl    43.96 | valid bpc    5.458
-----------------------------------------------------------------------------------------
PROGRESS: 88.0%
| epoch  89 |   100/  269 batches | lr 0.00000 | ms/batch 74.51 | loss  3.01 | ppl    20.31 
| epoch  89 |   200/  269 batches | lr 0.00000 | ms/batch 72.98 | loss  2.96 | ppl    19.20 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 20.14s | valid loss  3.78 | valid ppl    43.72 | valid bpc    5.450
-----------------------------------------------------------------------------------------
PROGRESS: 89.0%
| epoch  90 |   100/  269 batches | lr 0.00000 | ms/batch 74.43 | loss  2.99 | ppl    19.93 
| epoch  90 |   200/  269 batches | lr 0.00000 | ms/batch 73.25 | loss  2.97 | ppl    19.57 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 20.15s | valid loss  3.79 | valid ppl    44.08 | valid bpc    5.462
-----------------------------------------------------------------------------------------
PROGRESS: 90.0%
| epoch  91 |   100/  269 batches | lr 0.00000 | ms/batch 74.28 | loss  2.99 | ppl    19.87 
| epoch  91 |   200/  269 batches | lr 0.00000 | ms/batch 73.43 | loss  2.97 | ppl    19.51 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 20.15s | valid loss  3.77 | valid ppl    43.21 | valid bpc    5.433
-----------------------------------------------------------------------------------------
PROGRESS: 91.0%
| epoch  92 |   100/  269 batches | lr 0.00000 | ms/batch 74.39 | loss  3.00 | ppl    20.09 
| epoch  92 |   200/  269 batches | lr 0.00000 | ms/batch 73.24 | loss  2.97 | ppl    19.50 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 20.16s | valid loss  3.80 | valid ppl    44.84 | valid bpc    5.487
-----------------------------------------------------------------------------------------
PROGRESS: 92.0%
| epoch  93 |   100/  269 batches | lr 0.00000 | ms/batch 74.53 | loss  3.01 | ppl    20.25 
| epoch  93 |   200/  269 batches | lr 0.00000 | ms/batch 73.39 | loss  2.96 | ppl    19.32 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 20.16s | valid loss  3.78 | valid ppl    43.83 | valid bpc    5.454
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  269 batches | lr 0.00000 | ms/batch 74.47 | loss  2.97 | ppl    19.57 
| epoch  94 |   200/  269 batches | lr 0.00000 | ms/batch 72.94 | loss  2.97 | ppl    19.50 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 20.15s | valid loss  3.80 | valid ppl    44.53 | valid bpc    5.477
-----------------------------------------------------------------------------------------
PROGRESS: 94.0%
| epoch  95 |   100/  269 batches | lr 0.00000 | ms/batch 74.26 | loss  2.99 | ppl    19.94 
| epoch  95 |   200/  269 batches | lr 0.00000 | ms/batch 73.28 | loss  2.95 | ppl    19.19 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 20.14s | valid loss  3.77 | valid ppl    43.36 | valid bpc    5.438
-----------------------------------------------------------------------------------------
PROGRESS: 95.0%
| epoch  96 |   100/  269 batches | lr 0.00000 | ms/batch 74.46 | loss  3.01 | ppl    20.25 
| epoch  96 |   200/  269 batches | lr 0.00000 | ms/batch 73.00 | loss  2.96 | ppl    19.32 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 20.14s | valid loss  3.75 | valid ppl    42.35 | valid bpc    5.404
-----------------------------------------------------------------------------------------
PROGRESS: 96.0%
| epoch  97 |   100/  269 batches | lr 0.00000 | ms/batch 74.30 | loss  2.97 | ppl    19.47 
| epoch  97 |   200/  269 batches | lr 0.00000 | ms/batch 72.87 | loss  2.97 | ppl    19.46 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 20.14s | valid loss  3.78 | valid ppl    43.81 | valid bpc    5.453
-----------------------------------------------------------------------------------------
PROGRESS: 97.0%
| epoch  98 |   100/  269 batches | lr 0.00000 | ms/batch 74.59 | loss  2.97 | ppl    19.54 
| epoch  98 |   200/  269 batches | lr 0.00000 | ms/batch 73.07 | loss  2.98 | ppl    19.76 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 20.13s | valid loss  3.80 | valid ppl    44.66 | valid bpc    5.481
-----------------------------------------------------------------------------------------
PROGRESS: 98.0%
| epoch  99 |   100/  269 batches | lr 0.00000 | ms/batch 74.69 | loss  2.99 | ppl    19.88 
| epoch  99 |   200/  269 batches | lr 0.00000 | ms/batch 72.79 | loss  2.96 | ppl    19.23 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 20.14s | valid loss  3.80 | valid ppl    44.50 | valid bpc    5.476
-----------------------------------------------------------------------------------------
PROGRESS: 99.0%
| epoch 100 |   100/  269 batches | lr 0.00000 | ms/batch 74.34 | loss  2.99 | ppl    19.90 
| epoch 100 |   200/  269 batches | lr 0.00000 | ms/batch 73.23 | loss  2.99 | ppl    19.81 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 20.14s | valid loss  3.71 | valid ppl    40.90 | valid bpc    5.354
-----------------------------------------------------------------------------------------
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  3.83 | test ppl    46.03 | test bpc    5.525
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.4275, Mean Reca: 0.6028, Mean F1: 0.4962, Mean Subword_Reca: 0.8234
-----------------------------------------------------------------------------------------
=========================================================================================
Loading dataset...
Using subword tokenizer...
Number of tokens:  8000
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer_in_parser', nhid=512, nlayers=8, front_layers=7, rear_layers=1, subword='omarmomen/ptb_filtered_lowcase_bpe_tokenizer_8', n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=3333, nonmono=5, cuda=True, log_interval=100, save='trained_models/subword_structformer_in_parser_3333_71.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 37449044
Model architecture: StructFormer_In_Parser(
  (transformer_front): Transformer_Front(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(8000, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-6): 7 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
  (transformer_rear): Transformer_Rear(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(8000, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0): TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (output_layer): Linear(in_features=512, out_features=8000, bias=True)
  )
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  269 batches | lr 0.00030 | ms/batch 76.62 | loss  7.78 | ppl  2390.52 
| epoch   1 |   200/  269 batches | lr 0.00030 | ms/batch 71.85 | loss  7.39 | ppl  1623.31 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 20.16s | valid loss  7.09 | valid ppl  1195.87 | valid bpc   10.224
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  269 batches | lr 0.00030 | ms/batch 73.48 | loss  7.28 | ppl  1452.24 
| epoch   2 |   200/  269 batches | lr 0.00030 | ms/batch 72.39 | loss  7.12 | ppl  1240.76 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 19.92s | valid loss  6.83 | valid ppl   921.72 | valid bpc    9.848
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  269 batches | lr 0.00030 | ms/batch 73.63 | loss  6.99 | ppl  1087.54 
| epoch   3 |   200/  269 batches | lr 0.00030 | ms/batch 72.86 | loss  6.76 | ppl   858.68 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 19.99s | valid loss  6.31 | valid ppl   550.96 | valid bpc    9.106
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  269 batches | lr 0.00030 | ms/batch 73.89 | loss  6.43 | ppl   620.50 
| epoch   4 |   200/  269 batches | lr 0.00030 | ms/batch 72.78 | loss  6.19 | ppl   490.19 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 20.04s | valid loss  5.88 | valid ppl   356.53 | valid bpc    8.478
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  269 batches | lr 0.00030 | ms/batch 74.07 | loss  6.01 | ppl   407.78 
| epoch   5 |   200/  269 batches | lr 0.00030 | ms/batch 72.91 | loss  5.86 | ppl   349.49 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 20.07s | valid loss  5.57 | valid ppl   261.74 | valid bpc    8.032
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  269 batches | lr 0.00030 | ms/batch 74.52 | loss  5.78 | ppl   323.06 
| epoch   6 |   200/  269 batches | lr 0.00030 | ms/batch 72.89 | loss  5.65 | ppl   284.14 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 20.11s | valid loss  5.42 | valid ppl   226.92 | valid bpc    7.826
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  269 batches | lr 0.00030 | ms/batch 74.31 | loss  5.57 | ppl   262.16 
| epoch   7 |   200/  269 batches | lr 0.00030 | ms/batch 72.69 | loss  5.49 | ppl   241.35 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 20.11s | valid loss  5.28 | valid ppl   196.63 | valid bpc    7.619
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  269 batches | lr 0.00030 | ms/batch 74.18 | loss  5.42 | ppl   225.23 
| epoch   8 |   200/  269 batches | lr 0.00030 | ms/batch 72.93 | loss  5.36 | ppl   213.36 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 20.11s | valid loss  5.13 | valid ppl   169.47 | valid bpc    7.405
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 8.0%
| epoch   9 |   100/  269 batches | lr 0.00030 | ms/batch 74.14 | loss  5.29 | ppl   198.18 
| epoch   9 |   200/  269 batches | lr 0.00030 | ms/batch 73.06 | loss  5.24 | ppl   189.21 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 20.10s | valid loss  5.04 | valid ppl   154.14 | valid bpc    7.268
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  269 batches | lr 0.00030 | ms/batch 74.21 | loss  5.20 | ppl   180.94 
| epoch  10 |   200/  269 batches | lr 0.00030 | ms/batch 72.92 | loss  5.12 | ppl   167.85 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 20.13s | valid loss  5.00 | valid ppl   148.36 | valid bpc    7.213
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  269 batches | lr 0.00030 | ms/batch 74.34 | loss  5.08 | ppl   161.54 
| epoch  11 |   200/  269 batches | lr 0.00030 | ms/batch 72.90 | loss  5.03 | ppl   152.60 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 20.14s | valid loss  4.83 | valid ppl   124.98 | valid bpc    6.966
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  269 batches | lr 0.00030 | ms/batch 74.37 | loss  4.98 | ppl   145.23 
| epoch  12 |   200/  269 batches | lr 0.00030 | ms/batch 72.87 | loss  4.95 | ppl   141.20 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 20.13s | valid loss  4.83 | valid ppl   124.84 | valid bpc    6.964
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 12.0%
| epoch  13 |   100/  269 batches | lr 0.00030 | ms/batch 74.69 | loss  4.89 | ppl   132.90 
| epoch  13 |   200/  269 batches | lr 0.00030 | ms/batch 72.91 | loss  4.85 | ppl   127.97 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 20.12s | valid loss  4.71 | valid ppl   111.36 | valid bpc    6.799
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 13.0%
| epoch  14 |   100/  269 batches | lr 0.00030 | ms/batch 74.33 | loss  4.80 | ppl   121.85 
| epoch  14 |   200/  269 batches | lr 0.00030 | ms/batch 73.08 | loss  4.77 | ppl   118.45 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 20.12s | valid loss  4.72 | valid ppl   111.79 | valid bpc    6.805
-----------------------------------------------------------------------------------------
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  269 batches | lr 0.00030 | ms/batch 74.62 | loss  4.73 | ppl   113.20 
| epoch  15 |   200/  269 batches | lr 0.00030 | ms/batch 72.90 | loss  4.71 | ppl   110.96 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 20.15s | valid loss  4.62 | valid ppl   101.51 | valid bpc    6.665
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 15.0%
| epoch  16 |   100/  269 batches | lr 0.00030 | ms/batch 74.73 | loss  4.69 | ppl   108.48 
| epoch  16 |   200/  269 batches | lr 0.00030 | ms/batch 72.92 | loss  4.60 | ppl    99.76 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 20.15s | valid loss  4.52 | valid ppl    91.85 | valid bpc    6.521
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 16.0%
| epoch  17 |   100/  269 batches | lr 0.00030 | ms/batch 74.42 | loss  4.57 | ppl    96.98 
| epoch  17 |   200/  269 batches | lr 0.00030 | ms/batch 72.80 | loss  4.55 | ppl    94.81 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 20.14s | valid loss  4.45 | valid ppl    85.59 | valid bpc    6.419
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 17.0%
| epoch  18 |   100/  269 batches | lr 0.00030 | ms/batch 74.57 | loss  4.54 | ppl    93.77 
| epoch  18 |   200/  269 batches | lr 0.00030 | ms/batch 73.18 | loss  4.47 | ppl    87.29 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 20.15s | valid loss  4.42 | valid ppl    83.24 | valid bpc    6.379
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 18.0%
| epoch  19 |   100/  269 batches | lr 0.00030 | ms/batch 74.52 | loss  4.46 | ppl    86.09 
| epoch  19 |   200/  269 batches | lr 0.00030 | ms/batch 73.12 | loss  4.43 | ppl    84.32 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 20.14s | valid loss  4.35 | valid ppl    77.48 | valid bpc    6.276
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 19.0%
| epoch  20 |   100/  269 batches | lr 0.00030 | ms/batch 74.20 | loss  4.40 | ppl    81.13 
| epoch  20 |   200/  269 batches | lr 0.00030 | ms/batch 73.06 | loss  4.36 | ppl    78.27 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 20.11s | valid loss  4.39 | valid ppl    80.64 | valid bpc    6.333
-----------------------------------------------------------------------------------------
PROGRESS: 20.0%
| epoch  21 |   100/  269 batches | lr 0.00030 | ms/batch 74.48 | loss  4.31 | ppl    74.29 
| epoch  21 |   200/  269 batches | lr 0.00030 | ms/batch 73.05 | loss  4.31 | ppl    74.18 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 20.12s | valid loss  4.28 | valid ppl    72.08 | valid bpc    6.172
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 21.0%
| epoch  22 |   100/  269 batches | lr 0.00030 | ms/batch 74.44 | loss  4.28 | ppl    72.34 
| epoch  22 |   200/  269 batches | lr 0.00030 | ms/batch 72.87 | loss  4.24 | ppl    69.26 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 20.11s | valid loss  4.28 | valid ppl    72.04 | valid bpc    6.171
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 22.0%
| epoch  23 |   100/  269 batches | lr 0.00030 | ms/batch 74.30 | loss  4.23 | ppl    69.03 
| epoch  23 |   200/  269 batches | lr 0.00030 | ms/batch 72.90 | loss  4.16 | ppl    64.24 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 20.13s | valid loss  4.25 | valid ppl    70.43 | valid bpc    6.138
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 23.0%
| epoch  24 |   100/  269 batches | lr 0.00030 | ms/batch 74.33 | loss  4.17 | ppl    64.57 
| epoch  24 |   200/  269 batches | lr 0.00030 | ms/batch 73.08 | loss  4.14 | ppl    62.58 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 20.13s | valid loss  4.20 | valid ppl    66.56 | valid bpc    6.057
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 24.0%
| epoch  25 |   100/  269 batches | lr 0.00030 | ms/batch 74.70 | loss  4.13 | ppl    61.89 
| epoch  25 |   200/  269 batches | lr 0.00030 | ms/batch 72.91 | loss  4.08 | ppl    59.35 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 20.13s | valid loss  4.17 | valid ppl    65.01 | valid bpc    6.023
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 25.0%
| epoch  26 |   100/  269 batches | lr 0.00030 | ms/batch 74.21 | loss  4.07 | ppl    58.68 
| epoch  26 |   200/  269 batches | lr 0.00030 | ms/batch 73.14 | loss  4.04 | ppl    56.82 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 20.13s | valid loss  4.15 | valid ppl    63.64 | valid bpc    5.992
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 26.0%
| epoch  27 |   100/  269 batches | lr 0.00030 | ms/batch 74.16 | loss  4.02 | ppl    55.50 
| epoch  27 |   200/  269 batches | lr 0.00030 | ms/batch 73.25 | loss  4.00 | ppl    54.63 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 20.12s | valid loss  4.12 | valid ppl    61.66 | valid bpc    5.946
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 27.0%
| epoch  28 |   100/  269 batches | lr 0.00030 | ms/batch 74.34 | loss  3.98 | ppl    53.78 
| epoch  28 |   200/  269 batches | lr 0.00030 | ms/batch 73.00 | loss  3.96 | ppl    52.48 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 20.13s | valid loss  4.10 | valid ppl    60.24 | valid bpc    5.913
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  269 batches | lr 0.00030 | ms/batch 74.42 | loss  3.96 | ppl    52.61 
| epoch  29 |   200/  269 batches | lr 0.00030 | ms/batch 72.91 | loss  3.90 | ppl    49.43 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 20.13s | valid loss  4.02 | valid ppl    55.47 | valid bpc    5.794
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  269 batches | lr 0.00030 | ms/batch 74.22 | loss  3.90 | ppl    49.59 
| epoch  30 |   200/  269 batches | lr 0.00030 | ms/batch 73.03 | loss  3.84 | ppl    46.59 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 20.13s | valid loss  4.05 | valid ppl    57.65 | valid bpc    5.849
-----------------------------------------------------------------------------------------
PROGRESS: 30.0%
| epoch  31 |   100/  269 batches | lr 0.00030 | ms/batch 74.34 | loss  3.86 | ppl    47.27 
| epoch  31 |   200/  269 batches | lr 0.00030 | ms/batch 73.19 | loss  3.83 | ppl    46.16 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 20.13s | valid loss  4.03 | valid ppl    56.48 | valid bpc    5.820
-----------------------------------------------------------------------------------------
PROGRESS: 31.0%
| epoch  32 |   100/  269 batches | lr 0.00030 | ms/batch 74.67 | loss  3.83 | ppl    46.18 
| epoch  32 |   200/  269 batches | lr 0.00030 | ms/batch 72.85 | loss  3.79 | ppl    44.15 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 20.13s | valid loss  4.02 | valid ppl    55.59 | valid bpc    5.797
-----------------------------------------------------------------------------------------
PROGRESS: 32.0%
| epoch  33 |   100/  269 batches | lr 0.00015 | ms/batch 74.30 | loss  3.73 | ppl    41.50 
| epoch  33 |   200/  269 batches | lr 0.00015 | ms/batch 73.16 | loss  3.68 | ppl    39.79 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 20.13s | valid loss  3.95 | valid ppl    51.71 | valid bpc    5.692
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 33.0%
| epoch  34 |   100/  269 batches | lr 0.00015 | ms/batch 74.63 | loss  3.65 | ppl    38.63 
| epoch  34 |   200/  269 batches | lr 0.00015 | ms/batch 73.02 | loss  3.63 | ppl    37.89 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 20.13s | valid loss  3.99 | valid ppl    54.15 | valid bpc    5.759
-----------------------------------------------------------------------------------------
PROGRESS: 34.0%
| epoch  35 |   100/  269 batches | lr 0.00015 | ms/batch 74.63 | loss  3.63 | ppl    37.63 
| epoch  35 |   200/  269 batches | lr 0.00015 | ms/batch 73.27 | loss  3.62 | ppl    37.46 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 20.14s | valid loss  3.93 | valid ppl    50.88 | valid bpc    5.669
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 35.0%
| epoch  36 |   100/  269 batches | lr 0.00015 | ms/batch 74.78 | loss  3.63 | ppl    37.69 
| epoch  36 |   200/  269 batches | lr 0.00015 | ms/batch 72.85 | loss  3.57 | ppl    35.55 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 20.13s | valid loss  3.90 | valid ppl    49.62 | valid bpc    5.633
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 36.0%
| epoch  37 |   100/  269 batches | lr 0.00015 | ms/batch 74.49 | loss  3.57 | ppl    35.64 
| epoch  37 |   200/  269 batches | lr 0.00015 | ms/batch 73.22 | loss  3.59 | ppl    36.13 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 20.13s | valid loss  3.93 | valid ppl    50.95 | valid bpc    5.671
-----------------------------------------------------------------------------------------
PROGRESS: 37.0%
| epoch  38 |   100/  269 batches | lr 0.00015 | ms/batch 74.40 | loss  3.54 | ppl    34.59 
| epoch  38 |   200/  269 batches | lr 0.00015 | ms/batch 72.89 | loss  3.53 | ppl    34.07 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 20.12s | valid loss  3.90 | valid ppl    49.29 | valid bpc    5.623
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 38.0%
| epoch  39 |   100/  269 batches | lr 0.00015 | ms/batch 74.51 | loss  3.52 | ppl    33.84 
| epoch  39 |   200/  269 batches | lr 0.00015 | ms/batch 72.69 | loss  3.52 | ppl    33.89 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 20.14s | valid loss  3.88 | valid ppl    48.44 | valid bpc    5.598
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 39.0%
| epoch  40 |   100/  269 batches | lr 0.00015 | ms/batch 74.31 | loss  3.50 | ppl    33.00 
| epoch  40 |   200/  269 batches | lr 0.00015 | ms/batch 73.16 | loss  3.48 | ppl    32.47 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 20.12s | valid loss  3.92 | valid ppl    50.30 | valid bpc    5.653
-----------------------------------------------------------------------------------------
PROGRESS: 40.0%
| epoch  41 |   100/  269 batches | lr 0.00015 | ms/batch 74.40 | loss  3.49 | ppl    32.76 
| epoch  41 |   200/  269 batches | lr 0.00015 | ms/batch 72.92 | loss  3.48 | ppl    32.36 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 20.13s | valid loss  3.91 | valid ppl    50.13 | valid bpc    5.648
-----------------------------------------------------------------------------------------
PROGRESS: 41.0%
| epoch  42 |   100/  269 batches | lr 0.00015 | ms/batch 74.29 | loss  3.46 | ppl    31.70 
| epoch  42 |   200/  269 batches | lr 0.00015 | ms/batch 73.02 | loss  3.45 | ppl    31.45 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 20.12s | valid loss  3.87 | valid ppl    47.83 | valid bpc    5.580
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 42.0%
| epoch  43 |   100/  269 batches | lr 0.00015 | ms/batch 74.73 | loss  3.43 | ppl    30.78 
| epoch  43 |   200/  269 batches | lr 0.00015 | ms/batch 72.97 | loss  3.43 | ppl    31.01 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 20.13s | valid loss  3.87 | valid ppl    47.77 | valid bpc    5.578
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 43.0%
| epoch  44 |   100/  269 batches | lr 0.00015 | ms/batch 74.19 | loss  3.44 | ppl    31.27 
| epoch  44 |   200/  269 batches | lr 0.00015 | ms/batch 73.24 | loss  3.42 | ppl    30.67 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 20.12s | valid loss  3.82 | valid ppl    45.48 | valid bpc    5.507
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 44.0%
| epoch  45 |   100/  269 batches | lr 0.00015 | ms/batch 74.56 | loss  3.39 | ppl    29.70 
| epoch  45 |   200/  269 batches | lr 0.00015 | ms/batch 72.96 | loss  3.40 | ppl    29.88 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 20.13s | valid loss  3.82 | valid ppl    45.50 | valid bpc    5.508
-----------------------------------------------------------------------------------------
PROGRESS: 45.0%
| epoch  46 |   100/  269 batches | lr 0.00015 | ms/batch 74.35 | loss  3.38 | ppl    29.35 
| epoch  46 |   200/  269 batches | lr 0.00015 | ms/batch 73.40 | loss  3.36 | ppl    28.80 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 20.13s | valid loss  3.86 | valid ppl    47.70 | valid bpc    5.576
-----------------------------------------------------------------------------------------
PROGRESS: 46.0%
| epoch  47 |   100/  269 batches | lr 0.00015 | ms/batch 74.25 | loss  3.38 | ppl    29.24 
| epoch  47 |   200/  269 batches | lr 0.00015 | ms/batch 73.28 | loss  3.34 | ppl    28.26 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 20.13s | valid loss  3.88 | valid ppl    48.58 | valid bpc    5.602
-----------------------------------------------------------------------------------------
PROGRESS: 47.0%
| epoch  48 |   100/  269 batches | lr 0.00007 | ms/batch 74.53 | loss  3.34 | ppl    28.19 
| epoch  48 |   200/  269 batches | lr 0.00007 | ms/batch 73.24 | loss  3.29 | ppl    26.75 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 20.14s | valid loss  3.90 | valid ppl    49.34 | valid bpc    5.625
-----------------------------------------------------------------------------------------
PROGRESS: 48.0%
| epoch  49 |   100/  269 batches | lr 0.00007 | ms/batch 74.71 | loss  3.28 | ppl    26.58 
| epoch  49 |   200/  269 batches | lr 0.00007 | ms/batch 72.87 | loss  3.27 | ppl    26.30 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 20.14s | valid loss  3.83 | valid ppl    46.16 | valid bpc    5.529
-----------------------------------------------------------------------------------------
PROGRESS: 49.0%
| epoch  50 |   100/  269 batches | lr 0.00007 | ms/batch 74.40 | loss  3.27 | ppl    26.42 
| epoch  50 |   200/  269 batches | lr 0.00007 | ms/batch 72.82 | loss  3.26 | ppl    26.05 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 20.14s | valid loss  3.81 | valid ppl    45.01 | valid bpc    5.492
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 50.0%
| epoch  51 |   100/  269 batches | lr 0.00007 | ms/batch 74.86 | loss  3.27 | ppl    26.26 
| epoch  51 |   200/  269 batches | lr 0.00007 | ms/batch 72.80 | loss  3.22 | ppl    25.12 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 20.14s | valid loss  3.84 | valid ppl    46.41 | valid bpc    5.536
-----------------------------------------------------------------------------------------
PROGRESS: 51.0%
| epoch  52 |   100/  269 batches | lr 0.00007 | ms/batch 74.51 | loss  3.26 | ppl    25.99 
| epoch  52 |   200/  269 batches | lr 0.00007 | ms/batch 73.14 | loss  3.20 | ppl    24.42 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 20.15s | valid loss  3.82 | valid ppl    45.73 | valid bpc    5.515
-----------------------------------------------------------------------------------------
PROGRESS: 52.0%
| epoch  53 |   100/  269 batches | lr 0.00007 | ms/batch 74.29 | loss  3.24 | ppl    25.62 
| epoch  53 |   200/  269 batches | lr 0.00007 | ms/batch 73.27 | loss  3.23 | ppl    25.20 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 20.15s | valid loss  3.81 | valid ppl    45.25 | valid bpc    5.500
-----------------------------------------------------------------------------------------
PROGRESS: 53.0%
| epoch  54 |   100/  269 batches | lr 0.00004 | ms/batch 74.47 | loss  3.22 | ppl    24.93 
| epoch  54 |   200/  269 batches | lr 0.00004 | ms/batch 73.21 | loss  3.18 | ppl    24.14 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 20.15s | valid loss  3.77 | valid ppl    43.46 | valid bpc    5.441
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 54.0%
| epoch  55 |   100/  269 batches | lr 0.00004 | ms/batch 74.26 | loss  3.20 | ppl    24.43 
| epoch  55 |   200/  269 batches | lr 0.00004 | ms/batch 72.99 | loss  3.17 | ppl    23.88 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 20.14s | valid loss  3.83 | valid ppl    45.85 | valid bpc    5.519
-----------------------------------------------------------------------------------------
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  269 batches | lr 0.00004 | ms/batch 74.47 | loss  3.19 | ppl    24.26 
| epoch  56 |   200/  269 batches | lr 0.00004 | ms/batch 73.06 | loss  3.16 | ppl    23.67 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 20.15s | valid loss  3.82 | valid ppl    45.60 | valid bpc    5.511
-----------------------------------------------------------------------------------------
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  269 batches | lr 0.00004 | ms/batch 74.48 | loss  3.20 | ppl    24.59 
| epoch  57 |   200/  269 batches | lr 0.00004 | ms/batch 73.00 | loss  3.15 | ppl    23.29 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 20.15s | valid loss  3.80 | valid ppl    44.72 | valid bpc    5.483
-----------------------------------------------------------------------------------------
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  269 batches | lr 0.00002 | ms/batch 74.08 | loss  3.17 | ppl    23.79 
| epoch  58 |   200/  269 batches | lr 0.00002 | ms/batch 73.50 | loss  3.13 | ppl    22.95 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 20.13s | valid loss  3.84 | valid ppl    46.30 | valid bpc    5.533
-----------------------------------------------------------------------------------------
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  269 batches | lr 0.00002 | ms/batch 74.56 | loss  3.17 | ppl    23.80 
| epoch  59 |   200/  269 batches | lr 0.00002 | ms/batch 73.01 | loss  3.15 | ppl    23.34 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 20.13s | valid loss  3.80 | valid ppl    44.75 | valid bpc    5.484
-----------------------------------------------------------------------------------------
PROGRESS: 59.0%
| epoch  60 |   100/  269 batches | lr 0.00002 | ms/batch 74.64 | loss  3.15 | ppl    23.43 
| epoch  60 |   200/  269 batches | lr 0.00002 | ms/batch 72.73 | loss  3.12 | ppl    22.63 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 20.14s | valid loss  3.81 | valid ppl    45.05 | valid bpc    5.494
-----------------------------------------------------------------------------------------
PROGRESS: 60.0%
| epoch  61 |   100/  269 batches | lr 0.00001 | ms/batch 74.24 | loss  3.17 | ppl    23.76 
| epoch  61 |   200/  269 batches | lr 0.00001 | ms/batch 73.38 | loss  3.12 | ppl    22.58 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 20.15s | valid loss  3.77 | valid ppl    43.20 | valid bpc    5.433
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 61.0%
| epoch  62 |   100/  269 batches | lr 0.00001 | ms/batch 74.53 | loss  3.15 | ppl    23.33 
| epoch  62 |   200/  269 batches | lr 0.00001 | ms/batch 72.96 | loss  3.11 | ppl    22.51 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 20.15s | valid loss  3.81 | valid ppl    44.97 | valid bpc    5.491
-----------------------------------------------------------------------------------------
PROGRESS: 62.0%
| epoch  63 |   100/  269 batches | lr 0.00001 | ms/batch 74.29 | loss  3.16 | ppl    23.46 
| epoch  63 |   200/  269 batches | lr 0.00001 | ms/batch 73.21 | loss  3.11 | ppl    22.51 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 20.15s | valid loss  3.79 | valid ppl    44.26 | valid bpc    5.468
-----------------------------------------------------------------------------------------
PROGRESS: 63.0%
| epoch  64 |   100/  269 batches | lr 0.00001 | ms/batch 74.75 | loss  3.14 | ppl    23.13 
| epoch  64 |   200/  269 batches | lr 0.00001 | ms/batch 72.93 | loss  3.07 | ppl    21.65 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 20.14s | valid loss  3.81 | valid ppl    44.99 | valid bpc    5.492
-----------------------------------------------------------------------------------------
PROGRESS: 64.0%
| epoch  65 |   100/  269 batches | lr 0.00000 | ms/batch 74.24 | loss  3.14 | ppl    23.21 
| epoch  65 |   200/  269 batches | lr 0.00000 | ms/batch 73.32 | loss  3.11 | ppl    22.37 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 20.14s | valid loss  3.86 | valid ppl    47.47 | valid bpc    5.569
-----------------------------------------------------------------------------------------
PROGRESS: 65.0%
| epoch  66 |   100/  269 batches | lr 0.00000 | ms/batch 74.32 | loss  3.14 | ppl    23.10 
| epoch  66 |   200/  269 batches | lr 0.00000 | ms/batch 72.89 | loss  3.10 | ppl    22.22 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 20.13s | valid loss  3.80 | valid ppl    44.55 | valid bpc    5.477
-----------------------------------------------------------------------------------------
PROGRESS: 66.0%
| epoch  67 |   100/  269 batches | lr 0.00000 | ms/batch 74.56 | loss  3.13 | ppl    22.83 
| epoch  67 |   200/  269 batches | lr 0.00000 | ms/batch 73.14 | loss  3.12 | ppl    22.72 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 20.15s | valid loss  3.81 | valid ppl    45.07 | valid bpc    5.494
-----------------------------------------------------------------------------------------
PROGRESS: 67.0%
| epoch  68 |   100/  269 batches | lr 0.00000 | ms/batch 74.47 | loss  3.14 | ppl    23.07 
| epoch  68 |   200/  269 batches | lr 0.00000 | ms/batch 72.92 | loss  3.11 | ppl    22.43 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 20.15s | valid loss  3.82 | valid ppl    45.43 | valid bpc    5.506
-----------------------------------------------------------------------------------------
PROGRESS: 68.0%
| epoch  69 |   100/  269 batches | lr 0.00000 | ms/batch 74.30 | loss  3.16 | ppl    23.54 
| epoch  69 |   200/  269 batches | lr 0.00000 | ms/batch 73.31 | loss  3.09 | ppl    22.04 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 20.15s | valid loss  3.77 | valid ppl    43.21 | valid bpc    5.433
-----------------------------------------------------------------------------------------
PROGRESS: 69.0%
| epoch  70 |   100/  269 batches | lr 0.00000 | ms/batch 74.33 | loss  3.14 | ppl    23.10 
| epoch  70 |   200/  269 batches | lr 0.00000 | ms/batch 72.98 | loss  3.11 | ppl    22.38 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 20.14s | valid loss  3.79 | valid ppl    44.24 | valid bpc    5.467
-----------------------------------------------------------------------------------------
PROGRESS: 70.0%
| epoch  71 |   100/  269 batches | lr 0.00000 | ms/batch 74.75 | loss  3.11 | ppl    22.53 
| epoch  71 |   200/  269 batches | lr 0.00000 | ms/batch 73.24 | loss  3.13 | ppl    22.78 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 20.16s | valid loss  3.81 | valid ppl    45.38 | valid bpc    5.504
-----------------------------------------------------------------------------------------
PROGRESS: 71.0%
| epoch  72 |   100/  269 batches | lr 0.00000 | ms/batch 74.47 | loss  3.15 | ppl    23.28 
| epoch  72 |   200/  269 batches | lr 0.00000 | ms/batch 73.17 | loss  3.10 | ppl    22.15 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 20.15s | valid loss  3.76 | valid ppl    43.04 | valid bpc    5.428
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 72.0%
| epoch  73 |   100/  269 batches | lr 0.00000 | ms/batch 74.51 | loss  3.13 | ppl    22.79 
| epoch  73 |   200/  269 batches | lr 0.00000 | ms/batch 73.23 | loss  3.10 | ppl    22.21 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 20.16s | valid loss  3.77 | valid ppl    43.43 | valid bpc    5.441
-----------------------------------------------------------------------------------------
PROGRESS: 73.0%
| epoch  74 |   100/  269 batches | lr 0.00000 | ms/batch 74.58 | loss  3.12 | ppl    22.64 
| epoch  74 |   200/  269 batches | lr 0.00000 | ms/batch 73.11 | loss  3.08 | ppl    21.86 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 20.14s | valid loss  3.84 | valid ppl    46.55 | valid bpc    5.541
-----------------------------------------------------------------------------------------
PROGRESS: 74.0%
| epoch  75 |   100/  269 batches | lr 0.00000 | ms/batch 74.53 | loss  3.12 | ppl    22.72 
| epoch  75 |   200/  269 batches | lr 0.00000 | ms/batch 72.96 | loss  3.10 | ppl    22.25 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 20.13s | valid loss  3.78 | valid ppl    43.72 | valid bpc    5.450
-----------------------------------------------------------------------------------------
PROGRESS: 75.0%
| epoch  76 |   100/  269 batches | lr 0.00000 | ms/batch 74.48 | loss  3.12 | ppl    22.70 
| epoch  76 |   200/  269 batches | lr 0.00000 | ms/batch 73.19 | loss  3.10 | ppl    22.13 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 20.14s | valid loss  3.80 | valid ppl    44.51 | valid bpc    5.476
-----------------------------------------------------------------------------------------
PROGRESS: 76.0%
| epoch  77 |   100/  269 batches | lr 0.00000 | ms/batch 74.31 | loss  3.13 | ppl    22.86 
| epoch  77 |   200/  269 batches | lr 0.00000 | ms/batch 72.96 | loss  3.09 | ppl    22.06 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 20.15s | valid loss  3.73 | valid ppl    41.73 | valid bpc    5.383
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 77.0%
| epoch  78 |   100/  269 batches | lr 0.00000 | ms/batch 74.16 | loss  3.11 | ppl    22.43 
| epoch  78 |   200/  269 batches | lr 0.00000 | ms/batch 73.04 | loss  3.10 | ppl    22.28 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 20.13s | valid loss  3.75 | valid ppl    42.42 | valid bpc    5.407
-----------------------------------------------------------------------------------------
PROGRESS: 78.0%
| epoch  79 |   100/  269 batches | lr 0.00000 | ms/batch 74.51 | loss  3.13 | ppl    22.83 
| epoch  79 |   200/  269 batches | lr 0.00000 | ms/batch 73.12 | loss  3.10 | ppl    22.11 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 20.14s | valid loss  3.76 | valid ppl    43.03 | valid bpc    5.427
-----------------------------------------------------------------------------------------
PROGRESS: 79.0%
| epoch  80 |   100/  269 batches | lr 0.00000 | ms/batch 74.69 | loss  3.11 | ppl    22.47 
| epoch  80 |   200/  269 batches | lr 0.00000 | ms/batch 73.09 | loss  3.10 | ppl    22.11 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 20.15s | valid loss  3.81 | valid ppl    45.10 | valid bpc    5.495
-----------------------------------------------------------------------------------------
PROGRESS: 80.0%
| epoch  81 |   100/  269 batches | lr 0.00000 | ms/batch 74.33 | loss  3.13 | ppl    22.86 
| epoch  81 |   200/  269 batches | lr 0.00000 | ms/batch 73.19 | loss  3.10 | ppl    22.18 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 20.14s | valid loss  3.79 | valid ppl    44.39 | valid bpc    5.472
-----------------------------------------------------------------------------------------
PROGRESS: 81.0%
| epoch  82 |   100/  269 batches | lr 0.00000 | ms/batch 74.55 | loss  3.14 | ppl    23.07 
| epoch  82 |   200/  269 batches | lr 0.00000 | ms/batch 73.23 | loss  3.08 | ppl    21.75 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 20.15s | valid loss  3.82 | valid ppl    45.58 | valid bpc    5.510
-----------------------------------------------------------------------------------------
PROGRESS: 82.0%
| epoch  83 |   100/  269 batches | lr 0.00000 | ms/batch 74.43 | loss  3.15 | ppl    23.29 
| epoch  83 |   200/  269 batches | lr 0.00000 | ms/batch 73.01 | loss  3.12 | ppl    22.65 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 20.13s | valid loss  3.84 | valid ppl    46.47 | valid bpc    5.538
-----------------------------------------------------------------------------------------
PROGRESS: 83.0%
| epoch  84 |   100/  269 batches | lr 0.00000 | ms/batch 74.32 | loss  3.14 | ppl    23.10 
| epoch  84 |   200/  269 batches | lr 0.00000 | ms/batch 73.06 | loss  3.11 | ppl    22.35 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 20.15s | valid loss  3.78 | valid ppl    43.69 | valid bpc    5.449
-----------------------------------------------------------------------------------------
PROGRESS: 84.0%
| epoch  85 |   100/  269 batches | lr 0.00000 | ms/batch 74.34 | loss  3.12 | ppl    22.74 
| epoch  85 |   200/  269 batches | lr 0.00000 | ms/batch 73.29 | loss  3.09 | ppl    22.00 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 20.14s | valid loss  3.82 | valid ppl    45.58 | valid bpc    5.510
-----------------------------------------------------------------------------------------
PROGRESS: 85.0%
| epoch  86 |   100/  269 batches | lr 0.00000 | ms/batch 74.76 | loss  3.14 | ppl    23.00 
| epoch  86 |   200/  269 batches | lr 0.00000 | ms/batch 72.95 | loss  3.09 | ppl    21.99 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 20.14s | valid loss  3.79 | valid ppl    44.33 | valid bpc    5.470
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  269 batches | lr 0.00000 | ms/batch 74.61 | loss  3.14 | ppl    23.19 
| epoch  87 |   200/  269 batches | lr 0.00000 | ms/batch 72.96 | loss  3.10 | ppl    22.12 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 20.14s | valid loss  3.83 | valid ppl    46.25 | valid bpc    5.531
-----------------------------------------------------------------------------------------
PROGRESS: 87.0%
| epoch  88 |   100/  269 batches | lr 0.00000 | ms/batch 74.33 | loss  3.13 | ppl    22.87 
| epoch  88 |   200/  269 batches | lr 0.00000 | ms/batch 73.01 | loss  3.10 | ppl    22.30 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 20.13s | valid loss  3.79 | valid ppl    44.42 | valid bpc    5.473
-----------------------------------------------------------------------------------------
PROGRESS: 88.0%
| epoch  89 |   100/  269 batches | lr 0.00000 | ms/batch 74.11 | loss  3.12 | ppl    22.65 
| epoch  89 |   200/  269 batches | lr 0.00000 | ms/batch 73.30 | loss  3.11 | ppl    22.36 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 20.13s | valid loss  3.86 | valid ppl    47.53 | valid bpc    5.571
-----------------------------------------------------------------------------------------
PROGRESS: 89.0%
| epoch  90 |   100/  269 batches | lr 0.00000 | ms/batch 74.57 | loss  3.12 | ppl    22.69 
| epoch  90 |   200/  269 batches | lr 0.00000 | ms/batch 73.08 | loss  3.10 | ppl    22.16 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 20.14s | valid loss  3.78 | valid ppl    43.80 | valid bpc    5.453
-----------------------------------------------------------------------------------------
PROGRESS: 90.0%
| epoch  91 |   100/  269 batches | lr 0.00000 | ms/batch 74.15 | loss  3.15 | ppl    23.40 
| epoch  91 |   200/  269 batches | lr 0.00000 | ms/batch 73.35 | loss  3.07 | ppl    21.44 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 20.14s | valid loss  3.82 | valid ppl    45.43 | valid bpc    5.506
-----------------------------------------------------------------------------------------
PROGRESS: 91.0%
| epoch  92 |   100/  269 batches | lr 0.00000 | ms/batch 74.67 | loss  3.13 | ppl    22.96 
| epoch  92 |   200/  269 batches | lr 0.00000 | ms/batch 73.12 | loss  3.10 | ppl    22.16 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 20.16s | valid loss  3.79 | valid ppl    44.27 | valid bpc    5.468
-----------------------------------------------------------------------------------------
PROGRESS: 92.0%
| epoch  93 |   100/  269 batches | lr 0.00000 | ms/batch 74.74 | loss  3.14 | ppl    23.03 
| epoch  93 |   200/  269 batches | lr 0.00000 | ms/batch 72.94 | loss  3.10 | ppl    22.28 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 20.15s | valid loss  3.81 | valid ppl    45.09 | valid bpc    5.495
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  269 batches | lr 0.00000 | ms/batch 74.22 | loss  3.13 | ppl    22.92 
| epoch  94 |   200/  269 batches | lr 0.00000 | ms/batch 73.16 | loss  3.08 | ppl    21.82 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 20.14s | valid loss  3.75 | valid ppl    42.50 | valid bpc    5.409
-----------------------------------------------------------------------------------------
PROGRESS: 94.0%
| epoch  95 |   100/  269 batches | lr 0.00000 | ms/batch 74.09 | loss  3.14 | ppl    23.11 
| epoch  95 |   200/  269 batches | lr 0.00000 | ms/batch 73.16 | loss  3.09 | ppl    21.88 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 20.13s | valid loss  3.80 | valid ppl    44.65 | valid bpc    5.481
-----------------------------------------------------------------------------------------
PROGRESS: 95.0%
| epoch  96 |   100/  269 batches | lr 0.00000 | ms/batch 74.25 | loss  3.16 | ppl    23.59 
| epoch  96 |   200/  269 batches | lr 0.00000 | ms/batch 72.99 | loss  3.08 | ppl    21.73 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 20.13s | valid loss  3.85 | valid ppl    47.07 | valid bpc    5.557
-----------------------------------------------------------------------------------------
PROGRESS: 96.0%
| epoch  97 |   100/  269 batches | lr 0.00000 | ms/batch 74.55 | loss  3.14 | ppl    22.99 
| epoch  97 |   200/  269 batches | lr 0.00000 | ms/batch 73.04 | loss  3.09 | ppl    22.07 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 20.14s | valid loss  3.82 | valid ppl    45.68 | valid bpc    5.513
-----------------------------------------------------------------------------------------
PROGRESS: 97.0%
| epoch  98 |   100/  269 batches | lr 0.00000 | ms/batch 74.09 | loss  3.13 | ppl    22.91 
| epoch  98 |   200/  269 batches | lr 0.00000 | ms/batch 73.30 | loss  3.10 | ppl    22.11 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 20.13s | valid loss  3.81 | valid ppl    45.06 | valid bpc    5.494
-----------------------------------------------------------------------------------------
PROGRESS: 98.0%
| epoch  99 |   100/  269 batches | lr 0.00000 | ms/batch 74.59 | loss  3.14 | ppl    23.04 
| epoch  99 |   200/  269 batches | lr 0.00000 | ms/batch 72.92 | loss  3.10 | ppl    22.22 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 20.13s | valid loss  3.80 | valid ppl    44.80 | valid bpc    5.486
-----------------------------------------------------------------------------------------
PROGRESS: 99.0%
| epoch 100 |   100/  269 batches | lr 0.00000 | ms/batch 74.51 | loss  3.13 | ppl    22.79 
| epoch 100 |   200/  269 batches | lr 0.00000 | ms/batch 72.83 | loss  3.10 | ppl    22.16 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 20.13s | valid loss  3.79 | valid ppl    44.25 | valid bpc    5.467
-----------------------------------------------------------------------------------------
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  3.94 | test ppl    51.26 | test bpc    5.680
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.4017, Mean Reca: 0.5651, Mean F1: 0.4657, Mean Subword_Reca: 0.8792
-----------------------------------------------------------------------------------------
=========================================================================================
Loading dataset...
Using subword tokenizer...
Number of tokens:  8000
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer_in_parser', nhid=512, nlayers=8, front_layers=7, rear_layers=1, subword='omarmomen/ptb_filtered_lowcase_bpe_tokenizer_8', n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=4444, nonmono=5, cuda=True, log_interval=100, save='trained_models/subword_structformer_in_parser_4444_71.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 37449044
Model architecture: StructFormer_In_Parser(
  (transformer_front): Transformer_Front(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(8000, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-6): 7 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
  (transformer_rear): Transformer_Rear(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(8000, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0): TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (output_layer): Linear(in_features=512, out_features=8000, bias=True)
  )
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  269 batches | lr 0.00030 | ms/batch 76.70 | loss  7.81 | ppl  2461.93 
| epoch   1 |   200/  269 batches | lr 0.00030 | ms/batch 71.63 | loss  7.39 | ppl  1624.82 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 20.17s | valid loss  7.09 | valid ppl  1203.88 | valid bpc   10.233
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  269 batches | lr 0.00030 | ms/batch 73.42 | loss  7.27 | ppl  1438.71 
| epoch   2 |   200/  269 batches | lr 0.00030 | ms/batch 72.30 | loss  7.10 | ppl  1214.07 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 19.91s | valid loss  6.77 | valid ppl   870.74 | valid bpc    9.766
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  269 batches | lr 0.00030 | ms/batch 73.50 | loss  6.97 | ppl  1069.29 
| epoch   3 |   200/  269 batches | lr 0.00030 | ms/batch 72.74 | loss  6.76 | ppl   862.89 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 20.02s | valid loss  6.39 | valid ppl   598.64 | valid bpc    9.226
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  269 batches | lr 0.00030 | ms/batch 74.52 | loss  6.54 | ppl   691.19 
| epoch   4 |   200/  269 batches | lr 0.00030 | ms/batch 72.66 | loss  6.30 | ppl   545.37 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 20.10s | valid loss  5.95 | valid ppl   385.25 | valid bpc    8.590
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  269 batches | lr 0.00030 | ms/batch 74.06 | loss  6.10 | ppl   443.89 
| epoch   5 |   200/  269 batches | lr 0.00030 | ms/batch 72.92 | loss  5.96 | ppl   387.22 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 20.11s | valid loss  5.67 | valid ppl   290.36 | valid bpc    8.182
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  269 batches | lr 0.00030 | ms/batch 74.42 | loss  5.85 | ppl   348.92 
| epoch   6 |   200/  269 batches | lr 0.00030 | ms/batch 72.95 | loss  5.73 | ppl   308.59 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 20.13s | valid loss  5.48 | valid ppl   238.88 | valid bpc    7.900
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  269 batches | lr 0.00030 | ms/batch 74.43 | loss  5.67 | ppl   289.08 
| epoch   7 |   200/  269 batches | lr 0.00030 | ms/batch 72.78 | loss  5.56 | ppl   259.16 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 20.14s | valid loss  5.36 | valid ppl   213.50 | valid bpc    7.738
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  269 batches | lr 0.00030 | ms/batch 74.67 | loss  5.53 | ppl   251.12 
| epoch   8 |   200/  269 batches | lr 0.00030 | ms/batch 73.00 | loss  5.43 | ppl   228.02 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 20.14s | valid loss  5.28 | valid ppl   195.83 | valid bpc    7.613
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 8.0%
| epoch   9 |   100/  269 batches | lr 0.00030 | ms/batch 74.74 | loss  5.40 | ppl   221.07 
| epoch   9 |   200/  269 batches | lr 0.00030 | ms/batch 72.82 | loss  5.31 | ppl   202.35 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 20.15s | valid loss  5.09 | valid ppl   161.83 | valid bpc    7.338
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  269 batches | lr 0.00030 | ms/batch 74.56 | loss  5.28 | ppl   196.23 
| epoch  10 |   200/  269 batches | lr 0.00030 | ms/batch 72.93 | loss  5.21 | ppl   182.33 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 20.16s | valid loss  5.02 | valid ppl   151.17 | valid bpc    7.240
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  269 batches | lr 0.00030 | ms/batch 74.76 | loss  5.19 | ppl   178.95 
| epoch  11 |   200/  269 batches | lr 0.00030 | ms/batch 72.94 | loss  5.09 | ppl   162.07 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 20.17s | valid loss  4.94 | valid ppl   140.39 | valid bpc    7.133
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  269 batches | lr 0.00030 | ms/batch 74.60 | loss  5.09 | ppl   163.13 
| epoch  12 |   200/  269 batches | lr 0.00030 | ms/batch 73.32 | loss  5.03 | ppl   152.43 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 20.15s | valid loss  4.85 | valid ppl   128.29 | valid bpc    7.003
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 12.0%
| epoch  13 |   100/  269 batches | lr 0.00030 | ms/batch 74.63 | loss  4.99 | ppl   146.91 
| epoch  13 |   200/  269 batches | lr 0.00030 | ms/batch 72.72 | loss  4.94 | ppl   139.87 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 20.13s | valid loss  4.81 | valid ppl   122.52 | valid bpc    6.937
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 13.0%
| epoch  14 |   100/  269 batches | lr 0.00030 | ms/batch 74.42 | loss  4.92 | ppl   137.15 
| epoch  14 |   200/  269 batches | lr 0.00030 | ms/batch 73.21 | loss  4.85 | ppl   127.66 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 20.16s | valid loss  4.70 | valid ppl   109.94 | valid bpc    6.781
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  269 batches | lr 0.00030 | ms/batch 74.65 | loss  4.84 | ppl   126.94 
| epoch  15 |   200/  269 batches | lr 0.00030 | ms/batch 72.95 | loss  4.78 | ppl   118.74 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 20.15s | valid loss  4.67 | valid ppl   107.19 | valid bpc    6.744
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 15.0%
| epoch  16 |   100/  269 batches | lr 0.00030 | ms/batch 74.38 | loss  4.76 | ppl   117.09 
| epoch  16 |   200/  269 batches | lr 0.00030 | ms/batch 73.32 | loss  4.70 | ppl   110.36 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 20.15s | valid loss  4.66 | valid ppl   105.31 | valid bpc    6.718
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 16.0%
| epoch  17 |   100/  269 batches | lr 0.00030 | ms/batch 74.25 | loss  4.70 | ppl   109.97 
| epoch  17 |   200/  269 batches | lr 0.00030 | ms/batch 73.31 | loss  4.67 | ppl   106.25 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 20.14s | valid loss  4.53 | valid ppl    92.69 | valid bpc    6.534
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 17.0%
| epoch  18 |   100/  269 batches | lr 0.00030 | ms/batch 74.32 | loss  4.62 | ppl   100.99 
| epoch  18 |   200/  269 batches | lr 0.00030 | ms/batch 73.14 | loss  4.59 | ppl    98.59 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 20.15s | valid loss  4.51 | valid ppl    90.95 | valid bpc    6.507
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 18.0%
| epoch  19 |   100/  269 batches | lr 0.00030 | ms/batch 74.13 | loss  4.56 | ppl    95.85 
| epoch  19 |   200/  269 batches | lr 0.00030 | ms/batch 73.39 | loss  4.52 | ppl    92.06 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 20.15s | valid loss  4.43 | valid ppl    84.20 | valid bpc    6.396
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 19.0%
| epoch  20 |   100/  269 batches | lr 0.00030 | ms/batch 74.47 | loss  4.50 | ppl    89.75 
| epoch  20 |   200/  269 batches | lr 0.00030 | ms/batch 73.32 | loss  4.45 | ppl    85.96 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 20.18s | valid loss  4.37 | valid ppl    78.67 | valid bpc    6.298
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 20.0%
| epoch  21 |   100/  269 batches | lr 0.00030 | ms/batch 74.51 | loss  4.44 | ppl    84.73 
| epoch  21 |   200/  269 batches | lr 0.00030 | ms/batch 73.21 | loss  4.38 | ppl    80.14 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 20.16s | valid loss  4.39 | valid ppl    80.83 | valid bpc    6.337
-----------------------------------------------------------------------------------------
PROGRESS: 21.0%
| epoch  22 |   100/  269 batches | lr 0.00030 | ms/batch 74.79 | loss  4.41 | ppl    81.91 
| epoch  22 |   200/  269 batches | lr 0.00030 | ms/batch 72.92 | loss  4.34 | ppl    76.50 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 20.16s | valid loss  4.36 | valid ppl    78.48 | valid bpc    6.294
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 22.0%
| epoch  23 |   100/  269 batches | lr 0.00030 | ms/batch 74.15 | loss  4.32 | ppl    75.11 
| epoch  23 |   200/  269 batches | lr 0.00030 | ms/batch 73.39 | loss  4.30 | ppl    73.88 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 20.16s | valid loss  4.32 | valid ppl    75.42 | valid bpc    6.237
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 23.0%
| epoch  24 |   100/  269 batches | lr 0.00030 | ms/batch 74.48 | loss  4.28 | ppl    72.08 
| epoch  24 |   200/  269 batches | lr 0.00030 | ms/batch 72.87 | loss  4.24 | ppl    69.18 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 20.14s | valid loss  4.28 | valid ppl    72.16 | valid bpc    6.173
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 24.0%
| epoch  25 |   100/  269 batches | lr 0.00030 | ms/batch 74.60 | loss  4.21 | ppl    67.67 
| epoch  25 |   200/  269 batches | lr 0.00030 | ms/batch 72.92 | loss  4.20 | ppl    66.68 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 20.15s | valid loss  4.18 | valid ppl    65.69 | valid bpc    6.038
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 25.0%
| epoch  26 |   100/  269 batches | lr 0.00030 | ms/batch 74.51 | loss  4.17 | ppl    64.71 
| epoch  26 |   200/  269 batches | lr 0.00030 | ms/batch 72.85 | loss  4.14 | ppl    63.07 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 20.15s | valid loss  4.17 | valid ppl    64.61 | valid bpc    6.014
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 26.0%
| epoch  27 |   100/  269 batches | lr 0.00030 | ms/batch 74.44 | loss  4.12 | ppl    61.61 
| epoch  27 |   200/  269 batches | lr 0.00030 | ms/batch 73.12 | loss  4.10 | ppl    60.57 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 20.15s | valid loss  4.18 | valid ppl    65.49 | valid bpc    6.033
-----------------------------------------------------------------------------------------
PROGRESS: 27.0%
| epoch  28 |   100/  269 batches | lr 0.00030 | ms/batch 74.58 | loss  4.10 | ppl    60.36 
| epoch  28 |   200/  269 batches | lr 0.00030 | ms/batch 73.14 | loss  4.05 | ppl    57.61 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 20.19s | valid loss  4.14 | valid ppl    62.93 | valid bpc    5.976
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  269 batches | lr 0.00030 | ms/batch 74.85 | loss  4.03 | ppl    56.20 
| epoch  29 |   200/  269 batches | lr 0.00030 | ms/batch 72.90 | loss  4.01 | ppl    55.00 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 20.16s | valid loss  4.09 | valid ppl    59.60 | valid bpc    5.897
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  269 batches | lr 0.00030 | ms/batch 74.66 | loss  4.00 | ppl    54.81 
| epoch  30 |   200/  269 batches | lr 0.00030 | ms/batch 73.04 | loss  3.97 | ppl    52.92 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 20.16s | valid loss  4.14 | valid ppl    63.05 | valid bpc    5.978
-----------------------------------------------------------------------------------------
PROGRESS: 30.0%
| epoch  31 |   100/  269 batches | lr 0.00030 | ms/batch 74.84 | loss  3.96 | ppl    52.54 
| epoch  31 |   200/  269 batches | lr 0.00030 | ms/batch 72.92 | loss  3.95 | ppl    51.90 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 20.14s | valid loss  4.04 | valid ppl    56.92 | valid bpc    5.831
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 31.0%
| epoch  32 |   100/  269 batches | lr 0.00030 | ms/batch 74.68 | loss  3.92 | ppl    50.34 
| epoch  32 |   200/  269 batches | lr 0.00030 | ms/batch 72.92 | loss  3.92 | ppl    50.45 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 20.14s | valid loss  4.08 | valid ppl    59.39 | valid bpc    5.892
-----------------------------------------------------------------------------------------
PROGRESS: 32.0%
| epoch  33 |   100/  269 batches | lr 0.00030 | ms/batch 74.24 | loss  3.88 | ppl    48.38 
| epoch  33 |   200/  269 batches | lr 0.00030 | ms/batch 73.00 | loss  3.87 | ppl    47.84 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 20.13s | valid loss  4.09 | valid ppl    59.48 | valid bpc    5.894
-----------------------------------------------------------------------------------------
PROGRESS: 33.0%
| epoch  34 |   100/  269 batches | lr 0.00030 | ms/batch 74.58 | loss  3.87 | ppl    47.93 
| epoch  34 |   200/  269 batches | lr 0.00030 | ms/batch 73.04 | loss  3.83 | ppl    45.89 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 20.13s | valid loss  4.05 | valid ppl    57.26 | valid bpc    5.839
-----------------------------------------------------------------------------------------
PROGRESS: 34.0%
| epoch  35 |   100/  269 batches | lr 0.00015 | ms/batch 74.24 | loss  3.78 | ppl    43.74 
| epoch  35 |   200/  269 batches | lr 0.00015 | ms/batch 73.09 | loss  3.72 | ppl    41.15 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 20.14s | valid loss  3.98 | valid ppl    53.40 | valid bpc    5.739
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 35.0%
| epoch  36 |   100/  269 batches | lr 0.00015 | ms/batch 74.66 | loss  3.71 | ppl    40.96 
| epoch  36 |   200/  269 batches | lr 0.00015 | ms/batch 72.63 | loss  3.68 | ppl    39.54 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 20.12s | valid loss  3.98 | valid ppl    53.53 | valid bpc    5.742
-----------------------------------------------------------------------------------------
PROGRESS: 36.0%
| epoch  37 |   100/  269 batches | lr 0.00015 | ms/batch 74.50 | loss  3.67 | ppl    39.10 
| epoch  37 |   200/  269 batches | lr 0.00015 | ms/batch 73.06 | loss  3.66 | ppl    38.70 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 20.13s | valid loss  4.02 | valid ppl    55.57 | valid bpc    5.796
-----------------------------------------------------------------------------------------
PROGRESS: 37.0%
| epoch  38 |   100/  269 batches | lr 0.00015 | ms/batch 74.42 | loss  3.67 | ppl    39.35 
| epoch  38 |   200/  269 batches | lr 0.00015 | ms/batch 72.90 | loss  3.62 | ppl    37.33 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 20.14s | valid loss  3.96 | valid ppl    52.36 | valid bpc    5.710
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 38.0%
| epoch  39 |   100/  269 batches | lr 0.00015 | ms/batch 74.35 | loss  3.60 | ppl    36.50 
| epoch  39 |   200/  269 batches | lr 0.00015 | ms/batch 73.40 | loss  3.61 | ppl    36.99 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 20.16s | valid loss  3.95 | valid ppl    52.03 | valid bpc    5.701
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 39.0%
| epoch  40 |   100/  269 batches | lr 0.00015 | ms/batch 74.88 | loss  3.60 | ppl    36.74 
| epoch  40 |   200/  269 batches | lr 0.00015 | ms/batch 72.90 | loss  3.59 | ppl    36.20 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 20.16s | valid loss  3.95 | valid ppl    51.92 | valid bpc    5.698
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 40.0%
| epoch  41 |   100/  269 batches | lr 0.00015 | ms/batch 74.47 | loss  3.59 | ppl    36.16 
| epoch  41 |   200/  269 batches | lr 0.00015 | ms/batch 73.27 | loss  3.57 | ppl    35.41 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 20.15s | valid loss  3.94 | valid ppl    51.57 | valid bpc    5.688
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 41.0%
| epoch  42 |   100/  269 batches | lr 0.00015 | ms/batch 74.31 | loss  3.57 | ppl    35.43 
| epoch  42 |   200/  269 batches | lr 0.00015 | ms/batch 73.24 | loss  3.52 | ppl    33.91 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 20.15s | valid loss  3.93 | valid ppl    50.88 | valid bpc    5.669
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 42.0%
| epoch  43 |   100/  269 batches | lr 0.00015 | ms/batch 74.38 | loss  3.53 | ppl    34.04 
| epoch  43 |   200/  269 batches | lr 0.00015 | ms/batch 73.35 | loss  3.52 | ppl    33.72 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 20.17s | valid loss  3.91 | valid ppl    49.84 | valid bpc    5.639
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 43.0%
| epoch  44 |   100/  269 batches | lr 0.00015 | ms/batch 74.53 | loss  3.53 | ppl    34.05 
| epoch  44 |   200/  269 batches | lr 0.00015 | ms/batch 73.27 | loss  3.50 | ppl    33.10 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 20.16s | valid loss  3.86 | valid ppl    47.65 | valid bpc    5.574
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 44.0%
| epoch  45 |   100/  269 batches | lr 0.00015 | ms/batch 74.43 | loss  3.50 | ppl    32.99 
| epoch  45 |   200/  269 batches | lr 0.00015 | ms/batch 72.80 | loss  3.45 | ppl    31.41 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 20.13s | valid loss  3.94 | valid ppl    51.60 | valid bpc    5.689
-----------------------------------------------------------------------------------------
PROGRESS: 45.0%
| epoch  46 |   100/  269 batches | lr 0.00015 | ms/batch 74.25 | loss  3.47 | ppl    32.25 
| epoch  46 |   200/  269 batches | lr 0.00015 | ms/batch 73.06 | loss  3.47 | ppl    32.29 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 20.12s | valid loss  3.92 | valid ppl    50.29 | valid bpc    5.652
-----------------------------------------------------------------------------------------
PROGRESS: 46.0%
| epoch  47 |   100/  269 batches | lr 0.00015 | ms/batch 74.53 | loss  3.45 | ppl    31.51 
| epoch  47 |   200/  269 batches | lr 0.00015 | ms/batch 73.03 | loss  3.44 | ppl    31.13 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 20.15s | valid loss  3.93 | valid ppl    50.96 | valid bpc    5.671
-----------------------------------------------------------------------------------------
PROGRESS: 47.0%
| epoch  48 |   100/  269 batches | lr 0.00007 | ms/batch 74.54 | loss  3.41 | ppl    30.19 
| epoch  48 |   200/  269 batches | lr 0.00007 | ms/batch 73.20 | loss  3.38 | ppl    29.50 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 20.16s | valid loss  3.89 | valid ppl    48.93 | valid bpc    5.613
-----------------------------------------------------------------------------------------
PROGRESS: 48.0%
| epoch  49 |   100/  269 batches | lr 0.00007 | ms/batch 74.40 | loss  3.39 | ppl    29.62 
| epoch  49 |   200/  269 batches | lr 0.00007 | ms/batch 72.89 | loss  3.35 | ppl    28.49 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 20.14s | valid loss  3.85 | valid ppl    47.19 | valid bpc    5.560
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 49.0%
| epoch  50 |   100/  269 batches | lr 0.00007 | ms/batch 74.47 | loss  3.39 | ppl    29.66 
| epoch  50 |   200/  269 batches | lr 0.00007 | ms/batch 73.02 | loss  3.34 | ppl    28.09 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 20.13s | valid loss  3.88 | valid ppl    48.50 | valid bpc    5.600
-----------------------------------------------------------------------------------------
PROGRESS: 50.0%
| epoch  51 |   100/  269 batches | lr 0.00007 | ms/batch 74.13 | loss  3.35 | ppl    28.64 
| epoch  51 |   200/  269 batches | lr 0.00007 | ms/batch 73.25 | loss  3.34 | ppl    28.26 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 20.13s | valid loss  3.85 | valid ppl    46.93 | valid bpc    5.552
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 51.0%
| epoch  52 |   100/  269 batches | lr 0.00007 | ms/batch 74.26 | loss  3.35 | ppl    28.63 
| epoch  52 |   200/  269 batches | lr 0.00007 | ms/batch 73.27 | loss  3.30 | ppl    27.03 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 20.14s | valid loss  3.85 | valid ppl    46.82 | valid bpc    5.549
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 52.0%
| epoch  53 |   100/  269 batches | lr 0.00007 | ms/batch 74.24 | loss  3.32 | ppl    27.79 
| epoch  53 |   200/  269 batches | lr 0.00007 | ms/batch 72.91 | loss  3.30 | ppl    27.15 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 20.14s | valid loss  3.89 | valid ppl    49.09 | valid bpc    5.617
-----------------------------------------------------------------------------------------
PROGRESS: 53.0%
| epoch  54 |   100/  269 batches | lr 0.00007 | ms/batch 74.41 | loss  3.31 | ppl    27.39 
| epoch  54 |   200/  269 batches | lr 0.00007 | ms/batch 72.95 | loss  3.31 | ppl    27.44 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 20.15s | valid loss  3.83 | valid ppl    46.23 | valid bpc    5.531
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 54.0%
| epoch  55 |   100/  269 batches | lr 0.00007 | ms/batch 74.28 | loss  3.29 | ppl    26.82 
| epoch  55 |   200/  269 batches | lr 0.00007 | ms/batch 73.29 | loss  3.29 | ppl    26.80 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 20.16s | valid loss  3.85 | valid ppl    46.97 | valid bpc    5.554
-----------------------------------------------------------------------------------------
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  269 batches | lr 0.00007 | ms/batch 74.29 | loss  3.29 | ppl    26.85 
| epoch  56 |   200/  269 batches | lr 0.00007 | ms/batch 73.17 | loss  3.25 | ppl    25.82 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 20.14s | valid loss  3.82 | valid ppl    45.83 | valid bpc    5.518
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  269 batches | lr 0.00007 | ms/batch 74.39 | loss  3.29 | ppl    26.77 
| epoch  57 |   200/  269 batches | lr 0.00007 | ms/batch 73.24 | loss  3.28 | ppl    26.46 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 20.13s | valid loss  3.83 | valid ppl    45.88 | valid bpc    5.520
-----------------------------------------------------------------------------------------
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  269 batches | lr 0.00007 | ms/batch 74.67 | loss  3.28 | ppl    26.50 
| epoch  58 |   200/  269 batches | lr 0.00007 | ms/batch 72.96 | loss  3.26 | ppl    26.04 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 20.14s | valid loss  3.88 | valid ppl    48.47 | valid bpc    5.599
-----------------------------------------------------------------------------------------
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  269 batches | lr 0.00007 | ms/batch 74.53 | loss  3.26 | ppl    26.16 
| epoch  59 |   200/  269 batches | lr 0.00007 | ms/batch 73.23 | loss  3.23 | ppl    25.27 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 20.14s | valid loss  3.78 | valid ppl    43.67 | valid bpc    5.449
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 59.0%
| epoch  60 |   100/  269 batches | lr 0.00007 | ms/batch 74.57 | loss  3.29 | ppl    26.74 
| epoch  60 |   200/  269 batches | lr 0.00007 | ms/batch 72.95 | loss  3.24 | ppl    25.44 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 20.14s | valid loss  3.89 | valid ppl    48.69 | valid bpc    5.606
-----------------------------------------------------------------------------------------
PROGRESS: 60.0%
| epoch  61 |   100/  269 batches | lr 0.00007 | ms/batch 74.47 | loss  3.23 | ppl    25.21 
| epoch  61 |   200/  269 batches | lr 0.00007 | ms/batch 72.74 | loss  3.22 | ppl    25.02 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 20.13s | valid loss  3.86 | valid ppl    47.57 | valid bpc    5.572
-----------------------------------------------------------------------------------------
PROGRESS: 61.0%
| epoch  62 |   100/  269 batches | lr 0.00007 | ms/batch 74.17 | loss  3.24 | ppl    25.44 
| epoch  62 |   200/  269 batches | lr 0.00007 | ms/batch 72.89 | loss  3.22 | ppl    25.02 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 20.12s | valid loss  3.83 | valid ppl    46.27 | valid bpc    5.532
-----------------------------------------------------------------------------------------
PROGRESS: 62.0%
| epoch  63 |   100/  269 batches | lr 0.00004 | ms/batch 74.26 | loss  3.22 | ppl    24.93 
| epoch  63 |   200/  269 batches | lr 0.00004 | ms/batch 73.24 | loss  3.19 | ppl    24.25 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 20.14s | valid loss  3.82 | valid ppl    45.60 | valid bpc    5.511
-----------------------------------------------------------------------------------------
PROGRESS: 63.0%
| epoch  64 |   100/  269 batches | lr 0.00004 | ms/batch 74.57 | loss  3.19 | ppl    24.32 
| epoch  64 |   200/  269 batches | lr 0.00004 | ms/batch 73.23 | loss  3.18 | ppl    24.14 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 20.15s | valid loss  3.80 | valid ppl    44.91 | valid bpc    5.489
-----------------------------------------------------------------------------------------
PROGRESS: 64.0%
| epoch  65 |   100/  269 batches | lr 0.00004 | ms/batch 74.37 | loss  3.19 | ppl    24.38 
| epoch  65 |   200/  269 batches | lr 0.00004 | ms/batch 72.85 | loss  3.15 | ppl    23.40 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 20.15s | valid loss  3.87 | valid ppl    47.98 | valid bpc    5.584
-----------------------------------------------------------------------------------------
PROGRESS: 65.0%
| epoch  66 |   100/  269 batches | lr 0.00002 | ms/batch 74.48 | loss  3.16 | ppl    23.54 
| epoch  66 |   200/  269 batches | lr 0.00002 | ms/batch 73.13 | loss  3.19 | ppl    24.18 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 20.14s | valid loss  3.80 | valid ppl    44.62 | valid bpc    5.480
-----------------------------------------------------------------------------------------
PROGRESS: 66.0%
| epoch  67 |   100/  269 batches | lr 0.00002 | ms/batch 74.51 | loss  3.15 | ppl    23.45 
| epoch  67 |   200/  269 batches | lr 0.00002 | ms/batch 73.16 | loss  3.16 | ppl    23.49 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 20.14s | valid loss  3.83 | valid ppl    45.94 | valid bpc    5.522
-----------------------------------------------------------------------------------------
PROGRESS: 67.0%
| epoch  68 |   100/  269 batches | lr 0.00002 | ms/batch 74.24 | loss  3.17 | ppl    23.85 
| epoch  68 |   200/  269 batches | lr 0.00002 | ms/batch 73.31 | loss  3.13 | ppl    22.91 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 20.14s | valid loss  3.82 | valid ppl    45.69 | valid bpc    5.514
-----------------------------------------------------------------------------------------
PROGRESS: 68.0%
| epoch  69 |   100/  269 batches | lr 0.00001 | ms/batch 74.37 | loss  3.16 | ppl    23.63 
| epoch  69 |   200/  269 batches | lr 0.00001 | ms/batch 73.26 | loss  3.12 | ppl    22.64 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 20.14s | valid loss  3.81 | valid ppl    45.14 | valid bpc    5.496
-----------------------------------------------------------------------------------------
PROGRESS: 69.0%
| epoch  70 |   100/  269 batches | lr 0.00001 | ms/batch 74.38 | loss  3.16 | ppl    23.47 
| epoch  70 |   200/  269 batches | lr 0.00001 | ms/batch 72.82 | loss  3.12 | ppl    22.65 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 20.14s | valid loss  3.86 | valid ppl    47.34 | valid bpc    5.565
-----------------------------------------------------------------------------------------
PROGRESS: 70.0%
| epoch  71 |   100/  269 batches | lr 0.00001 | ms/batch 74.35 | loss  3.16 | ppl    23.57 
| epoch  71 |   200/  269 batches | lr 0.00001 | ms/batch 73.34 | loss  3.13 | ppl    22.79 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 20.14s | valid loss  3.79 | valid ppl    44.08 | valid bpc    5.462
-----------------------------------------------------------------------------------------
PROGRESS: 71.0%
| epoch  72 |   100/  269 batches | lr 0.00000 | ms/batch 74.69 | loss  3.15 | ppl    23.36 
| epoch  72 |   200/  269 batches | lr 0.00000 | ms/batch 73.04 | loss  3.11 | ppl    22.38 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 20.15s | valid loss  3.80 | valid ppl    44.83 | valid bpc    5.486
-----------------------------------------------------------------------------------------
PROGRESS: 72.0%
| epoch  73 |   100/  269 batches | lr 0.00000 | ms/batch 74.56 | loss  3.16 | ppl    23.60 
| epoch  73 |   200/  269 batches | lr 0.00000 | ms/batch 73.14 | loss  3.13 | ppl    22.93 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 20.13s | valid loss  3.83 | valid ppl    46.21 | valid bpc    5.530
-----------------------------------------------------------------------------------------
PROGRESS: 73.0%
| epoch  74 |   100/  269 batches | lr 0.00000 | ms/batch 74.59 | loss  3.16 | ppl    23.56 
| epoch  74 |   200/  269 batches | lr 0.00000 | ms/batch 72.86 | loss  3.10 | ppl    22.22 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 20.13s | valid loss  3.82 | valid ppl    45.42 | valid bpc    5.505
-----------------------------------------------------------------------------------------
PROGRESS: 74.0%
| epoch  75 |   100/  269 batches | lr 0.00000 | ms/batch 74.58 | loss  3.13 | ppl    22.90 
| epoch  75 |   200/  269 batches | lr 0.00000 | ms/batch 72.93 | loss  3.12 | ppl    22.75 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 20.13s | valid loss  3.75 | valid ppl    42.64 | valid bpc    5.414
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 75.0%
| epoch  76 |   100/  269 batches | lr 0.00000 | ms/batch 74.23 | loss  3.14 | ppl    23.21 
| epoch  76 |   200/  269 batches | lr 0.00000 | ms/batch 72.78 | loss  3.11 | ppl    22.32 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 20.13s | valid loss  3.86 | valid ppl    47.31 | valid bpc    5.564
-----------------------------------------------------------------------------------------
PROGRESS: 76.0%
| epoch  77 |   100/  269 batches | lr 0.00000 | ms/batch 74.87 | loss  3.15 | ppl    23.34 
| epoch  77 |   200/  269 batches | lr 0.00000 | ms/batch 72.67 | loss  3.10 | ppl    22.16 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 20.14s | valid loss  3.81 | valid ppl    45.33 | valid bpc    5.502
-----------------------------------------------------------------------------------------
PROGRESS: 77.0%
| epoch  78 |   100/  269 batches | lr 0.00000 | ms/batch 74.25 | loss  3.14 | ppl    23.09 
| epoch  78 |   200/  269 batches | lr 0.00000 | ms/batch 72.95 | loss  3.12 | ppl    22.54 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 20.14s | valid loss  3.81 | valid ppl    45.03 | valid bpc    5.493
-----------------------------------------------------------------------------------------
PROGRESS: 78.0%
| epoch  79 |   100/  269 batches | lr 0.00000 | ms/batch 74.12 | loss  3.15 | ppl    23.37 
| epoch  79 |   200/  269 batches | lr 0.00000 | ms/batch 72.91 | loss  3.12 | ppl    22.56 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 20.13s | valid loss  3.86 | valid ppl    47.27 | valid bpc    5.563
-----------------------------------------------------------------------------------------
PROGRESS: 79.0%
| epoch  80 |   100/  269 batches | lr 0.00000 | ms/batch 74.60 | loss  3.15 | ppl    23.33 
| epoch  80 |   200/  269 batches | lr 0.00000 | ms/batch 72.88 | loss  3.11 | ppl    22.33 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 20.14s | valid loss  3.81 | valid ppl    45.29 | valid bpc    5.501
-----------------------------------------------------------------------------------------
PROGRESS: 80.0%
| epoch  81 |   100/  269 batches | lr 0.00000 | ms/batch 74.59 | loss  3.13 | ppl    22.95 
| epoch  81 |   200/  269 batches | lr 0.00000 | ms/batch 73.15 | loss  3.11 | ppl    22.37 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 20.15s | valid loss  3.76 | valid ppl    42.83 | valid bpc    5.421
-----------------------------------------------------------------------------------------
PROGRESS: 81.0%
| epoch  82 |   100/  269 batches | lr 0.00000 | ms/batch 74.27 | loss  3.14 | ppl    23.13 
| epoch  82 |   200/  269 batches | lr 0.00000 | ms/batch 73.25 | loss  3.12 | ppl    22.65 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 20.14s | valid loss  3.81 | valid ppl    45.23 | valid bpc    5.499
-----------------------------------------------------------------------------------------
PROGRESS: 82.0%
| epoch  83 |   100/  269 batches | lr 0.00000 | ms/batch 74.45 | loss  3.14 | ppl    23.15 
| epoch  83 |   200/  269 batches | lr 0.00000 | ms/batch 73.41 | loss  3.11 | ppl    22.49 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 20.18s | valid loss  3.81 | valid ppl    45.05 | valid bpc    5.494
-----------------------------------------------------------------------------------------
PROGRESS: 83.0%
| epoch  84 |   100/  269 batches | lr 0.00000 | ms/batch 74.55 | loss  3.13 | ppl    22.96 
| epoch  84 |   200/  269 batches | lr 0.00000 | ms/batch 72.97 | loss  3.12 | ppl    22.72 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 20.16s | valid loss  3.79 | valid ppl    44.47 | valid bpc    5.475
-----------------------------------------------------------------------------------------
PROGRESS: 84.0%
| epoch  85 |   100/  269 batches | lr 0.00000 | ms/batch 74.57 | loss  3.13 | ppl    22.80 
| epoch  85 |   200/  269 batches | lr 0.00000 | ms/batch 73.14 | loss  3.12 | ppl    22.55 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 20.16s | valid loss  3.78 | valid ppl    43.73 | valid bpc    5.451
-----------------------------------------------------------------------------------------
PROGRESS: 85.0%
| epoch  86 |   100/  269 batches | lr 0.00000 | ms/batch 74.54 | loss  3.15 | ppl    23.42 
| epoch  86 |   200/  269 batches | lr 0.00000 | ms/batch 72.90 | loss  3.11 | ppl    22.43 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 20.17s | valid loss  3.82 | valid ppl    45.58 | valid bpc    5.510
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  269 batches | lr 0.00000 | ms/batch 74.57 | loss  3.15 | ppl    23.36 
| epoch  87 |   200/  269 batches | lr 0.00000 | ms/batch 73.46 | loss  3.11 | ppl    22.51 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 20.18s | valid loss  3.84 | valid ppl    46.37 | valid bpc    5.535
-----------------------------------------------------------------------------------------
PROGRESS: 87.0%
| epoch  88 |   100/  269 batches | lr 0.00000 | ms/batch 74.26 | loss  3.14 | ppl    23.05 
| epoch  88 |   200/  269 batches | lr 0.00000 | ms/batch 73.36 | loss  3.10 | ppl    22.17 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 20.18s | valid loss  3.85 | valid ppl    47.18 | valid bpc    5.560
-----------------------------------------------------------------------------------------
PROGRESS: 88.0%
| epoch  89 |   100/  269 batches | lr 0.00000 | ms/batch 74.43 | loss  3.15 | ppl    23.32 
| epoch  89 |   200/  269 batches | lr 0.00000 | ms/batch 73.19 | loss  3.11 | ppl    22.51 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 20.15s | valid loss  3.76 | valid ppl    43.02 | valid bpc    5.427
-----------------------------------------------------------------------------------------
PROGRESS: 89.0%
| epoch  90 |   100/  269 batches | lr 0.00000 | ms/batch 74.52 | loss  3.14 | ppl    23.19 
| epoch  90 |   200/  269 batches | lr 0.00000 | ms/batch 73.05 | loss  3.10 | ppl    22.25 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 20.15s | valid loss  3.84 | valid ppl    46.32 | valid bpc    5.534
-----------------------------------------------------------------------------------------
PROGRESS: 90.0%
| epoch  91 |   100/  269 batches | lr 0.00000 | ms/batch 74.55 | loss  3.13 | ppl    22.91 
| epoch  91 |   200/  269 batches | lr 0.00000 | ms/batch 73.34 | loss  3.12 | ppl    22.66 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 20.17s | valid loss  3.85 | valid ppl    47.18 | valid bpc    5.560
-----------------------------------------------------------------------------------------
PROGRESS: 91.0%
| epoch  92 |   100/  269 batches | lr 0.00000 | ms/batch 74.84 | loss  3.16 | ppl    23.54 
| epoch  92 |   200/  269 batches | lr 0.00000 | ms/batch 72.94 | loss  3.09 | ppl    21.97 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 20.16s | valid loss  3.82 | valid ppl    45.77 | valid bpc    5.516
-----------------------------------------------------------------------------------------
PROGRESS: 92.0%
| epoch  93 |   100/  269 batches | lr 0.00000 | ms/batch 74.38 | loss  3.16 | ppl    23.64 
| epoch  93 |   200/  269 batches | lr 0.00000 | ms/batch 73.22 | loss  3.10 | ppl    22.14 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 20.15s | valid loss  3.83 | valid ppl    45.97 | valid bpc    5.523
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  269 batches | lr 0.00000 | ms/batch 74.39 | loss  3.13 | ppl    22.92 
| epoch  94 |   200/  269 batches | lr 0.00000 | ms/batch 73.22 | loss  3.10 | ppl    22.12 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 20.15s | valid loss  3.80 | valid ppl    44.71 | valid bpc    5.482
-----------------------------------------------------------------------------------------
PROGRESS: 94.0%
| epoch  95 |   100/  269 batches | lr 0.00000 | ms/batch 74.40 | loss  3.16 | ppl    23.46 
| epoch  95 |   200/  269 batches | lr 0.00000 | ms/batch 73.35 | loss  3.11 | ppl    22.38 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 20.15s | valid loss  3.82 | valid ppl    45.44 | valid bpc    5.506
-----------------------------------------------------------------------------------------
PROGRESS: 95.0%
| epoch  96 |   100/  269 batches | lr 0.00000 | ms/batch 74.57 | loss  3.15 | ppl    23.34 
| epoch  96 |   200/  269 batches | lr 0.00000 | ms/batch 73.06 | loss  3.11 | ppl    22.32 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 20.16s | valid loss  3.86 | valid ppl    47.62 | valid bpc    5.573
-----------------------------------------------------------------------------------------
PROGRESS: 96.0%
| epoch  97 |   100/  269 batches | lr 0.00000 | ms/batch 74.60 | loss  3.14 | ppl    23.09 
| epoch  97 |   200/  269 batches | lr 0.00000 | ms/batch 73.13 | loss  3.10 | ppl    22.21 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 20.15s | valid loss  3.79 | valid ppl    44.15 | valid bpc    5.464
-----------------------------------------------------------------------------------------
PROGRESS: 97.0%
| epoch  98 |   100/  269 batches | lr 0.00000 | ms/batch 74.38 | loss  3.13 | ppl    22.95 
| epoch  98 |   200/  269 batches | lr 0.00000 | ms/batch 73.23 | loss  3.09 | ppl    22.04 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 20.14s | valid loss  3.83 | valid ppl    46.09 | valid bpc    5.526
-----------------------------------------------------------------------------------------
PROGRESS: 98.0%
| epoch  99 |   100/  269 batches | lr 0.00000 | ms/batch 74.29 | loss  3.13 | ppl    22.77 
| epoch  99 |   200/  269 batches | lr 0.00000 | ms/batch 73.23 | loss  3.11 | ppl    22.46 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 20.15s | valid loss  3.80 | valid ppl    44.49 | valid bpc    5.476
-----------------------------------------------------------------------------------------
PROGRESS: 99.0%
| epoch 100 |   100/  269 batches | lr 0.00000 | ms/batch 74.79 | loss  3.17 | ppl    23.75 
| epoch 100 |   200/  269 batches | lr 0.00000 | ms/batch 73.03 | loss  3.10 | ppl    22.27 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 20.16s | valid loss  3.84 | valid ppl    46.69 | valid bpc    5.545
-----------------------------------------------------------------------------------------
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  3.93 | test ppl    50.73 | test bpc    5.665
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.3288, Mean Reca: 0.4622, Mean F1: 0.3809, Mean Subword_Reca: 0.6710
-----------------------------------------------------------------------------------------
=========================================================================================
Loading dataset...
Using subword tokenizer...
Number of tokens:  8000
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer_in_parser', nhid=512, nlayers=8, front_layers=7, rear_layers=1, subword='omarmomen/ptb_filtered_lowcase_bpe_tokenizer_8', n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=5555, nonmono=5, cuda=True, log_interval=100, save='trained_models/subword_structformer_in_parser_5555_71.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 37449044
Model architecture: StructFormer_In_Parser(
  (transformer_front): Transformer_Front(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(8000, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-6): 7 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
  (transformer_rear): Transformer_Rear(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(8000, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0): TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (output_layer): Linear(in_features=512, out_features=8000, bias=True)
  )
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  269 batches | lr 0.00030 | ms/batch 76.68 | loss  7.76 | ppl  2354.36 
| epoch   1 |   200/  269 batches | lr 0.00030 | ms/batch 71.76 | loss  7.38 | ppl  1604.40 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 20.17s | valid loss  7.07 | valid ppl  1177.94 | valid bpc   10.202
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  269 batches | lr 0.00030 | ms/batch 73.29 | loss  7.30 | ppl  1486.62 
| epoch   2 |   200/  269 batches | lr 0.00030 | ms/batch 72.31 | loss  7.16 | ppl  1285.68 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 19.91s | valid loss  6.79 | valid ppl   892.13 | valid bpc    9.801
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  269 batches | lr 0.00030 | ms/batch 73.75 | loss  6.91 | ppl  1000.84 
| epoch   3 |   200/  269 batches | lr 0.00030 | ms/batch 72.43 | loss  6.55 | ppl   701.79 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 20.00s | valid loss  6.08 | valid ppl   436.34 | valid bpc    8.769
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  269 batches | lr 0.00030 | ms/batch 73.89 | loss  6.22 | ppl   504.56 
| epoch   4 |   200/  269 batches | lr 0.00030 | ms/batch 73.05 | loss  6.02 | ppl   413.37 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 20.06s | valid loss  5.70 | valid ppl   297.57 | valid bpc    8.217
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  269 batches | lr 0.00030 | ms/batch 74.31 | loss  5.88 | ppl   359.36 
| epoch   5 |   200/  269 batches | lr 0.00030 | ms/batch 72.98 | loss  5.78 | ppl   323.13 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 20.08s | valid loss  5.45 | valid ppl   232.27 | valid bpc    7.860
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  269 batches | lr 0.00030 | ms/batch 74.13 | loss  5.65 | ppl   285.36 
| epoch   6 |   200/  269 batches | lr 0.00030 | ms/batch 72.91 | loss  5.56 | ppl   259.76 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 20.11s | valid loss  5.30 | valid ppl   201.04 | valid bpc    7.651
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  269 batches | lr 0.00030 | ms/batch 74.53 | loss  5.49 | ppl   241.69 
| epoch   7 |   200/  269 batches | lr 0.00030 | ms/batch 72.94 | loss  5.41 | ppl   224.67 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 20.13s | valid loss  5.17 | valid ppl   175.32 | valid bpc    7.454
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  269 batches | lr 0.00030 | ms/batch 74.57 | loss  5.36 | ppl   212.15 
| epoch   8 |   200/  269 batches | lr 0.00030 | ms/batch 72.93 | loss  5.28 | ppl   195.94 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 20.13s | valid loss  5.05 | valid ppl   155.36 | valid bpc    7.279
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 8.0%
| epoch   9 |   100/  269 batches | lr 0.00030 | ms/batch 74.76 | loss  5.21 | ppl   183.72 
| epoch   9 |   200/  269 batches | lr 0.00030 | ms/batch 72.92 | loss  5.18 | ppl   178.01 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 20.15s | valid loss  4.98 | valid ppl   144.97 | valid bpc    7.180
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  269 batches | lr 0.00030 | ms/batch 74.50 | loss  5.14 | ppl   171.13 
| epoch  10 |   200/  269 batches | lr 0.00030 | ms/batch 73.08 | loss  5.05 | ppl   155.51 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 20.14s | valid loss  4.84 | valid ppl   126.54 | valid bpc    6.983
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  269 batches | lr 0.00030 | ms/batch 74.49 | loss  5.01 | ppl   150.24 
| epoch  11 |   200/  269 batches | lr 0.00030 | ms/batch 73.27 | loss  4.96 | ppl   142.16 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 20.14s | valid loss  4.80 | valid ppl   121.11 | valid bpc    6.920
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  269 batches | lr 0.00030 | ms/batch 74.39 | loss  4.94 | ppl   140.35 
| epoch  12 |   200/  269 batches | lr 0.00030 | ms/batch 73.07 | loss  4.87 | ppl   130.06 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 20.13s | valid loss  4.74 | valid ppl   114.81 | valid bpc    6.843
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 12.0%
| epoch  13 |   100/  269 batches | lr 0.00030 | ms/batch 74.86 | loss  4.86 | ppl   129.03 
| epoch  13 |   200/  269 batches | lr 0.00030 | ms/batch 72.69 | loss  4.77 | ppl   117.36 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 20.14s | valid loss  4.63 | valid ppl   102.63 | valid bpc    6.681
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 13.0%
| epoch  14 |   100/  269 batches | lr 0.00030 | ms/batch 74.49 | loss  4.75 | ppl   115.74 
| epoch  14 |   200/  269 batches | lr 0.00030 | ms/batch 73.18 | loss  4.70 | ppl   109.98 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 20.14s | valid loss  4.60 | valid ppl    99.14 | valid bpc    6.631
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  269 batches | lr 0.00030 | ms/batch 74.62 | loss  4.68 | ppl   108.25 
| epoch  15 |   200/  269 batches | lr 0.00030 | ms/batch 73.02 | loss  4.63 | ppl   102.48 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 20.15s | valid loss  4.55 | valid ppl    94.65 | valid bpc    6.565
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 15.0%
| epoch  16 |   100/  269 batches | lr 0.00030 | ms/batch 74.41 | loss  4.63 | ppl   102.36 
| epoch  16 |   200/  269 batches | lr 0.00030 | ms/batch 72.93 | loss  4.54 | ppl    93.59 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 20.14s | valid loss  4.46 | valid ppl    86.25 | valid bpc    6.431
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 16.0%
| epoch  17 |   100/  269 batches | lr 0.00030 | ms/batch 74.64 | loss  4.57 | ppl    96.31 
| epoch  17 |   200/  269 batches | lr 0.00030 | ms/batch 72.92 | loss  4.47 | ppl    87.57 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 20.14s | valid loss  4.41 | valid ppl    81.93 | valid bpc    6.356
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 17.0%
| epoch  18 |   100/  269 batches | lr 0.00030 | ms/batch 74.34 | loss  4.46 | ppl    86.49 
| epoch  18 |   200/  269 batches | lr 0.00030 | ms/batch 73.28 | loss  4.42 | ppl    83.37 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 20.14s | valid loss  4.44 | valid ppl    84.87 | valid bpc    6.407
-----------------------------------------------------------------------------------------
PROGRESS: 18.0%
| epoch  19 |   100/  269 batches | lr 0.00030 | ms/batch 74.56 | loss  4.39 | ppl    80.79 
| epoch  19 |   200/  269 batches | lr 0.00030 | ms/batch 73.33 | loss  4.37 | ppl    79.34 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 20.17s | valid loss  4.28 | valid ppl    72.20 | valid bpc    6.174
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 19.0%
| epoch  20 |   100/  269 batches | lr 0.00030 | ms/batch 74.69 | loss  4.33 | ppl    76.23 
| epoch  20 |   200/  269 batches | lr 0.00030 | ms/batch 73.04 | loss  4.29 | ppl    73.25 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 20.15s | valid loss  4.28 | valid ppl    72.11 | valid bpc    6.172
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 20.0%
| epoch  21 |   100/  269 batches | lr 0.00030 | ms/batch 74.59 | loss  4.29 | ppl    73.16 
| epoch  21 |   200/  269 batches | lr 0.00030 | ms/batch 73.10 | loss  4.23 | ppl    68.61 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 20.16s | valid loss  4.26 | valid ppl    70.62 | valid bpc    6.142
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 21.0%
| epoch  22 |   100/  269 batches | lr 0.00030 | ms/batch 74.22 | loss  4.21 | ppl    67.48 
| epoch  22 |   200/  269 batches | lr 0.00030 | ms/batch 73.45 | loss  4.20 | ppl    66.37 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 20.14s | valid loss  4.26 | valid ppl    71.09 | valid bpc    6.152
-----------------------------------------------------------------------------------------
PROGRESS: 22.0%
| epoch  23 |   100/  269 batches | lr 0.00030 | ms/batch 74.44 | loss  4.15 | ppl    63.38 
| epoch  23 |   200/  269 batches | lr 0.00030 | ms/batch 73.28 | loss  4.14 | ppl    62.76 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 20.15s | valid loss  4.22 | valid ppl    67.87 | valid bpc    6.085
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 23.0%
| epoch  24 |   100/  269 batches | lr 0.00030 | ms/batch 74.54 | loss  4.11 | ppl    61.02 
| epoch  24 |   200/  269 batches | lr 0.00030 | ms/batch 73.09 | loss  4.08 | ppl    58.88 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 20.15s | valid loss  4.20 | valid ppl    66.35 | valid bpc    6.052
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 24.0%
| epoch  25 |   100/  269 batches | lr 0.00030 | ms/batch 74.39 | loss  4.06 | ppl    58.12 
| epoch  25 |   200/  269 batches | lr 0.00030 | ms/batch 73.07 | loss  4.04 | ppl    56.94 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 20.15s | valid loss  4.17 | valid ppl    64.92 | valid bpc    6.020
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 25.0%
| epoch  26 |   100/  269 batches | lr 0.00030 | ms/batch 74.39 | loss  4.01 | ppl    55.19 
| epoch  26 |   200/  269 batches | lr 0.00030 | ms/batch 73.36 | loss  3.98 | ppl    53.27 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 20.16s | valid loss  4.07 | valid ppl    58.39 | valid bpc    5.868
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 26.0%
| epoch  27 |   100/  269 batches | lr 0.00030 | ms/batch 74.22 | loss  3.95 | ppl    52.04 
| epoch  27 |   200/  269 batches | lr 0.00030 | ms/batch 73.13 | loss  3.95 | ppl    51.86 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 20.13s | valid loss  4.14 | valid ppl    63.04 | valid bpc    5.978
-----------------------------------------------------------------------------------------
PROGRESS: 27.0%
| epoch  28 |   100/  269 batches | lr 0.00030 | ms/batch 74.68 | loss  3.95 | ppl    51.82 
| epoch  28 |   200/  269 batches | lr 0.00030 | ms/batch 73.01 | loss  3.90 | ppl    49.32 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 20.15s | valid loss  4.07 | valid ppl    58.42 | valid bpc    5.868
-----------------------------------------------------------------------------------------
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  269 batches | lr 0.00030 | ms/batch 74.53 | loss  3.87 | ppl    48.10 
| epoch  29 |   200/  269 batches | lr 0.00030 | ms/batch 73.29 | loss  3.86 | ppl    47.46 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 20.16s | valid loss  4.09 | valid ppl    59.57 | valid bpc    5.896
-----------------------------------------------------------------------------------------
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  269 batches | lr 0.00015 | ms/batch 74.40 | loss  3.79 | ppl    44.34 
| epoch  30 |   200/  269 batches | lr 0.00015 | ms/batch 73.11 | loss  3.75 | ppl    42.33 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 20.16s | valid loss  4.05 | valid ppl    57.31 | valid bpc    5.841
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 30.0%
| epoch  31 |   100/  269 batches | lr 0.00015 | ms/batch 74.44 | loss  3.73 | ppl    41.52 
| epoch  31 |   200/  269 batches | lr 0.00015 | ms/batch 73.39 | loss  3.71 | ppl    40.80 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 20.17s | valid loss  4.02 | valid ppl    55.92 | valid bpc    5.805
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 31.0%
| epoch  32 |   100/  269 batches | lr 0.00015 | ms/batch 74.87 | loss  3.69 | ppl    40.14 
| epoch  32 |   200/  269 batches | lr 0.00015 | ms/batch 72.85 | loss  3.67 | ppl    39.29 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 20.15s | valid loss  3.98 | valid ppl    53.69 | valid bpc    5.747
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 32.0%
| epoch  33 |   100/  269 batches | lr 0.00015 | ms/batch 74.28 | loss  3.65 | ppl    38.59 
| epoch  33 |   200/  269 batches | lr 0.00015 | ms/batch 73.05 | loss  3.65 | ppl    38.55 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 20.13s | valid loss  3.96 | valid ppl    52.21 | valid bpc    5.706
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 33.0%
| epoch  34 |   100/  269 batches | lr 0.00015 | ms/batch 74.29 | loss  3.63 | ppl    37.71 
| epoch  34 |   200/  269 batches | lr 0.00015 | ms/batch 73.26 | loss  3.61 | ppl    37.04 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 20.15s | valid loss  3.90 | valid ppl    49.42 | valid bpc    5.627
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 34.0%
| epoch  35 |   100/  269 batches | lr 0.00015 | ms/batch 74.36 | loss  3.62 | ppl    37.22 
| epoch  35 |   200/  269 batches | lr 0.00015 | ms/batch 73.82 | loss  3.58 | ppl    35.74 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 20.19s | valid loss  3.91 | valid ppl    49.82 | valid bpc    5.639
-----------------------------------------------------------------------------------------
PROGRESS: 35.0%
| epoch  36 |   100/  269 batches | lr 0.00015 | ms/batch 74.92 | loss  3.59 | ppl    36.23 
| epoch  36 |   200/  269 batches | lr 0.00015 | ms/batch 73.00 | loss  3.54 | ppl    34.63 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 20.15s | valid loss  3.93 | valid ppl    51.10 | valid bpc    5.675
-----------------------------------------------------------------------------------------
PROGRESS: 36.0%
| epoch  37 |   100/  269 batches | lr 0.00015 | ms/batch 74.52 | loss  3.56 | ppl    35.07 
| epoch  37 |   200/  269 batches | lr 0.00015 | ms/batch 73.42 | loss  3.54 | ppl    34.60 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 20.15s | valid loss  3.93 | valid ppl    50.86 | valid bpc    5.669
-----------------------------------------------------------------------------------------
PROGRESS: 37.0%
| epoch  38 |   100/  269 batches | lr 0.00007 | ms/batch 74.27 | loss  3.52 | ppl    33.63 
| epoch  38 |   200/  269 batches | lr 0.00007 | ms/batch 73.09 | loss  3.47 | ppl    32.26 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 20.12s | valid loss  3.90 | valid ppl    49.61 | valid bpc    5.633
-----------------------------------------------------------------------------------------
PROGRESS: 38.0%
| epoch  39 |   100/  269 batches | lr 0.00007 | ms/batch 74.40 | loss  3.49 | ppl    32.80 
| epoch  39 |   200/  269 batches | lr 0.00007 | ms/batch 72.80 | loss  3.48 | ppl    32.44 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 20.13s | valid loss  3.88 | valid ppl    48.45 | valid bpc    5.598
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 39.0%
| epoch  40 |   100/  269 batches | lr 0.00007 | ms/batch 74.35 | loss  3.45 | ppl    31.59 
| epoch  40 |   200/  269 batches | lr 0.00007 | ms/batch 73.10 | loss  3.46 | ppl    31.69 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 20.16s | valid loss  3.89 | valid ppl    48.73 | valid bpc    5.607
-----------------------------------------------------------------------------------------
PROGRESS: 40.0%
| epoch  41 |   100/  269 batches | lr 0.00007 | ms/batch 74.66 | loss  3.48 | ppl    32.33 
| epoch  41 |   200/  269 batches | lr 0.00007 | ms/batch 73.91 | loss  3.43 | ppl    30.91 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 20.23s | valid loss  3.86 | valid ppl    47.65 | valid bpc    5.574
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 41.0%
| epoch  42 |   100/  269 batches | lr 0.00007 | ms/batch 74.92 | loss  3.43 | ppl    30.90 
| epoch  42 |   200/  269 batches | lr 0.00007 | ms/batch 72.96 | loss  3.41 | ppl    30.21 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 20.17s | valid loss  3.88 | valid ppl    48.38 | valid bpc    5.596
-----------------------------------------------------------------------------------------
PROGRESS: 42.0%
| epoch  43 |   100/  269 batches | lr 0.00007 | ms/batch 74.75 | loss  3.44 | ppl    31.05 
| epoch  43 |   200/  269 batches | lr 0.00007 | ms/batch 73.27 | loss  3.40 | ppl    29.83 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 20.18s | valid loss  3.84 | valid ppl    46.49 | valid bpc    5.539
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 43.0%
| epoch  44 |   100/  269 batches | lr 0.00007 | ms/batch 74.98 | loss  3.41 | ppl    30.17 
| epoch  44 |   200/  269 batches | lr 0.00007 | ms/batch 72.69 | loss  3.39 | ppl    29.70 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 20.15s | valid loss  3.87 | valid ppl    48.01 | valid bpc    5.585
-----------------------------------------------------------------------------------------
PROGRESS: 44.0%
| epoch  45 |   100/  269 batches | lr 0.00007 | ms/batch 74.26 | loss  3.38 | ppl    29.32 
| epoch  45 |   200/  269 batches | lr 0.00007 | ms/batch 73.41 | loss  3.38 | ppl    29.36 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 20.14s | valid loss  3.89 | valid ppl    49.02 | valid bpc    5.615
-----------------------------------------------------------------------------------------
PROGRESS: 45.0%
| epoch  46 |   100/  269 batches | lr 0.00007 | ms/batch 74.90 | loss  3.37 | ppl    29.09 
| epoch  46 |   200/  269 batches | lr 0.00007 | ms/batch 73.14 | loss  3.36 | ppl    28.85 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 20.23s | valid loss  3.81 | valid ppl    45.32 | valid bpc    5.502
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 46.0%
| epoch  47 |   100/  269 batches | lr 0.00007 | ms/batch 74.32 | loss  3.38 | ppl    29.50 
| epoch  47 |   200/  269 batches | lr 0.00007 | ms/batch 73.29 | loss  3.34 | ppl    28.16 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 20.19s | valid loss  3.89 | valid ppl    49.09 | valid bpc    5.617
-----------------------------------------------------------------------------------------
PROGRESS: 47.0%
| epoch  48 |   100/  269 batches | lr 0.00007 | ms/batch 75.59 | loss  3.34 | ppl    28.17 
| epoch  48 |   200/  269 batches | lr 0.00007 | ms/batch 73.76 | loss  3.32 | ppl    27.61 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 20.34s | valid loss  3.87 | valid ppl    47.87 | valid bpc    5.581
-----------------------------------------------------------------------------------------
PROGRESS: 48.0%
| epoch  49 |   100/  269 batches | lr 0.00007 | ms/batch 74.73 | loss  3.36 | ppl    28.91 
| epoch  49 |   200/  269 batches | lr 0.00007 | ms/batch 72.96 | loss  3.31 | ppl    27.40 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 20.16s | valid loss  3.82 | valid ppl    45.80 | valid bpc    5.517
-----------------------------------------------------------------------------------------
PROGRESS: 49.0%
| epoch  50 |   100/  269 batches | lr 0.00004 | ms/batch 74.27 | loss  3.32 | ppl    27.64 
| epoch  50 |   200/  269 batches | lr 0.00004 | ms/batch 73.01 | loss  3.29 | ppl    26.97 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 20.16s | valid loss  3.83 | valid ppl    46.22 | valid bpc    5.530
-----------------------------------------------------------------------------------------
PROGRESS: 50.0%
| epoch  51 |   100/  269 batches | lr 0.00004 | ms/batch 74.48 | loss  3.32 | ppl    27.67 
| epoch  51 |   200/  269 batches | lr 0.00004 | ms/batch 72.79 | loss  3.28 | ppl    26.61 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 20.14s | valid loss  3.90 | valid ppl    49.45 | valid bpc    5.628
-----------------------------------------------------------------------------------------
PROGRESS: 51.0%
| epoch  52 |   100/  269 batches | lr 0.00004 | ms/batch 74.43 | loss  3.32 | ppl    27.68 
| epoch  52 |   200/  269 batches | lr 0.00004 | ms/batch 72.97 | loss  3.26 | ppl    26.17 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 20.17s | valid loss  3.84 | valid ppl    46.74 | valid bpc    5.547
-----------------------------------------------------------------------------------------
PROGRESS: 52.0%
| epoch  53 |   100/  269 batches | lr 0.00002 | ms/batch 74.94 | loss  3.28 | ppl    26.50 
| epoch  53 |   200/  269 batches | lr 0.00002 | ms/batch 73.07 | loss  3.24 | ppl    25.42 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 20.16s | valid loss  3.78 | valid ppl    43.63 | valid bpc    5.447
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 53.0%
| epoch  54 |   100/  269 batches | lr 0.00002 | ms/batch 74.27 | loss  3.30 | ppl    27.19 
| epoch  54 |   200/  269 batches | lr 0.00002 | ms/batch 73.14 | loss  3.23 | ppl    25.40 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 20.15s | valid loss  3.89 | valid ppl    48.78 | valid bpc    5.608
-----------------------------------------------------------------------------------------
PROGRESS: 54.0%
| epoch  55 |   100/  269 batches | lr 0.00002 | ms/batch 74.47 | loss  3.28 | ppl    26.54 
| epoch  55 |   200/  269 batches | lr 0.00002 | ms/batch 72.98 | loss  3.24 | ppl    25.61 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 20.13s | valid loss  3.87 | valid ppl    48.12 | valid bpc    5.589
-----------------------------------------------------------------------------------------
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  269 batches | lr 0.00002 | ms/batch 74.44 | loss  3.28 | ppl    26.47 
| epoch  56 |   200/  269 batches | lr 0.00002 | ms/batch 73.13 | loss  3.25 | ppl    25.91 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 20.13s | valid loss  3.76 | valid ppl    43.15 | valid bpc    5.431
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  269 batches | lr 0.00002 | ms/batch 74.65 | loss  3.25 | ppl    25.83 
| epoch  57 |   200/  269 batches | lr 0.00002 | ms/batch 72.94 | loss  3.24 | ppl    25.56 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 20.12s | valid loss  3.86 | valid ppl    47.67 | valid bpc    5.575
-----------------------------------------------------------------------------------------
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  269 batches | lr 0.00002 | ms/batch 74.91 | loss  3.25 | ppl    25.71 
| epoch  58 |   200/  269 batches | lr 0.00002 | ms/batch 72.72 | loss  3.22 | ppl    25.14 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 20.13s | valid loss  3.83 | valid ppl    45.94 | valid bpc    5.522
-----------------------------------------------------------------------------------------
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  269 batches | lr 0.00002 | ms/batch 74.26 | loss  3.25 | ppl    25.91 
| epoch  59 |   200/  269 batches | lr 0.00002 | ms/batch 73.19 | loss  3.22 | ppl    25.06 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 20.12s | valid loss  3.80 | valid ppl    44.50 | valid bpc    5.476
-----------------------------------------------------------------------------------------
PROGRESS: 59.0%
| epoch  60 |   100/  269 batches | lr 0.00001 | ms/batch 74.73 | loss  3.25 | ppl    25.85 
| epoch  60 |   200/  269 batches | lr 0.00001 | ms/batch 72.86 | loss  3.20 | ppl    24.54 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 20.13s | valid loss  3.81 | valid ppl    45.01 | valid bpc    5.492
-----------------------------------------------------------------------------------------
PROGRESS: 60.0%
| epoch  61 |   100/  269 batches | lr 0.00001 | ms/batch 74.33 | loss  3.25 | ppl    25.89 
| epoch  61 |   200/  269 batches | lr 0.00001 | ms/batch 72.93 | loss  3.22 | ppl    24.96 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 20.14s | valid loss  3.83 | valid ppl    46.07 | valid bpc    5.526
-----------------------------------------------------------------------------------------
PROGRESS: 61.0%
| epoch  62 |   100/  269 batches | lr 0.00001 | ms/batch 74.62 | loss  3.25 | ppl    25.77 
| epoch  62 |   200/  269 batches | lr 0.00001 | ms/batch 73.35 | loss  3.22 | ppl    25.14 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 20.16s | valid loss  3.81 | valid ppl    45.14 | valid bpc    5.496
-----------------------------------------------------------------------------------------
PROGRESS: 62.0%
| epoch  63 |   100/  269 batches | lr 0.00000 | ms/batch 74.43 | loss  3.24 | ppl    25.63 
| epoch  63 |   200/  269 batches | lr 0.00000 | ms/batch 73.24 | loss  3.20 | ppl    24.61 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 20.15s | valid loss  3.84 | valid ppl    46.62 | valid bpc    5.543
-----------------------------------------------------------------------------------------
PROGRESS: 63.0%
| epoch  64 |   100/  269 batches | lr 0.00000 | ms/batch 74.65 | loss  3.24 | ppl    25.42 
| epoch  64 |   200/  269 batches | lr 0.00000 | ms/batch 72.97 | loss  3.21 | ppl    24.83 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 20.15s | valid loss  3.89 | valid ppl    49.10 | valid bpc    5.618
-----------------------------------------------------------------------------------------
PROGRESS: 64.0%
| epoch  65 |   100/  269 batches | lr 0.00000 | ms/batch 74.33 | loss  3.24 | ppl    25.55 
| epoch  65 |   200/  269 batches | lr 0.00000 | ms/batch 73.00 | loss  3.19 | ppl    24.36 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 20.14s | valid loss  3.82 | valid ppl    45.67 | valid bpc    5.513
-----------------------------------------------------------------------------------------
PROGRESS: 65.0%
| epoch  66 |   100/  269 batches | lr 0.00000 | ms/batch 74.54 | loss  3.23 | ppl    25.35 
| epoch  66 |   200/  269 batches | lr 0.00000 | ms/batch 72.93 | loss  3.20 | ppl    24.46 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 20.14s | valid loss  3.85 | valid ppl    46.96 | valid bpc    5.553
-----------------------------------------------------------------------------------------
PROGRESS: 66.0%
| epoch  67 |   100/  269 batches | lr 0.00000 | ms/batch 74.73 | loss  3.25 | ppl    25.81 
| epoch  67 |   200/  269 batches | lr 0.00000 | ms/batch 72.92 | loss  3.19 | ppl    24.23 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 20.14s | valid loss  3.85 | valid ppl    46.89 | valid bpc    5.551
-----------------------------------------------------------------------------------------
PROGRESS: 67.0%
| epoch  68 |   100/  269 batches | lr 0.00000 | ms/batch 74.53 | loss  3.22 | ppl    25.05 
| epoch  68 |   200/  269 batches | lr 0.00000 | ms/batch 72.97 | loss  3.22 | ppl    24.94 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 20.13s | valid loss  3.85 | valid ppl    46.88 | valid bpc    5.551
-----------------------------------------------------------------------------------------
PROGRESS: 68.0%
| epoch  69 |   100/  269 batches | lr 0.00000 | ms/batch 74.31 | loss  3.24 | ppl    25.56 
| epoch  69 |   200/  269 batches | lr 0.00000 | ms/batch 73.01 | loss  3.21 | ppl    24.66 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 20.13s | valid loss  3.81 | valid ppl    45.07 | valid bpc    5.494
-----------------------------------------------------------------------------------------
PROGRESS: 69.0%
| epoch  70 |   100/  269 batches | lr 0.00000 | ms/batch 74.74 | loss  3.24 | ppl    25.48 
| epoch  70 |   200/  269 batches | lr 0.00000 | ms/batch 73.06 | loss  3.20 | ppl    24.56 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 20.15s | valid loss  3.86 | valid ppl    47.37 | valid bpc    5.566
-----------------------------------------------------------------------------------------
PROGRESS: 70.0%
| epoch  71 |   100/  269 batches | lr 0.00000 | ms/batch 74.20 | loss  3.23 | ppl    25.30 
| epoch  71 |   200/  269 batches | lr 0.00000 | ms/batch 73.01 | loss  3.21 | ppl    24.75 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 20.15s | valid loss  3.77 | valid ppl    43.17 | valid bpc    5.432
-----------------------------------------------------------------------------------------
PROGRESS: 71.0%
| epoch  72 |   100/  269 batches | lr 0.00000 | ms/batch 74.30 | loss  3.23 | ppl    25.17 
| epoch  72 |   200/  269 batches | lr 0.00000 | ms/batch 73.40 | loss  3.21 | ppl    24.85 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 20.14s | valid loss  3.87 | valid ppl    48.02 | valid bpc    5.586
-----------------------------------------------------------------------------------------
PROGRESS: 72.0%
| epoch  73 |   100/  269 batches | lr 0.00000 | ms/batch 74.32 | loss  3.23 | ppl    25.27 
| epoch  73 |   200/  269 batches | lr 0.00000 | ms/batch 72.98 | loss  3.19 | ppl    24.21 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 20.14s | valid loss  3.81 | valid ppl    45.05 | valid bpc    5.494
-----------------------------------------------------------------------------------------
PROGRESS: 73.0%
| epoch  74 |   100/  269 batches | lr 0.00000 | ms/batch 74.65 | loss  3.25 | ppl    25.87 
| epoch  74 |   200/  269 batches | lr 0.00000 | ms/batch 72.99 | loss  3.20 | ppl    24.44 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 20.15s | valid loss  3.79 | valid ppl    44.14 | valid bpc    5.464
-----------------------------------------------------------------------------------------
PROGRESS: 74.0%
| epoch  75 |   100/  269 batches | lr 0.00000 | ms/batch 74.10 | loss  3.23 | ppl    25.23 
| epoch  75 |   200/  269 batches | lr 0.00000 | ms/batch 73.06 | loss  3.20 | ppl    24.53 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 20.13s | valid loss  3.78 | valid ppl    44.04 | valid bpc    5.461
-----------------------------------------------------------------------------------------
PROGRESS: 75.0%
| epoch  76 |   100/  269 batches | lr 0.00000 | ms/batch 74.57 | loss  3.24 | ppl    25.43 
| epoch  76 |   200/  269 batches | lr 0.00000 | ms/batch 72.84 | loss  3.20 | ppl    24.58 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 20.14s | valid loss  3.82 | valid ppl    45.67 | valid bpc    5.513
-----------------------------------------------------------------------------------------
PROGRESS: 76.0%
| epoch  77 |   100/  269 batches | lr 0.00000 | ms/batch 74.79 | loss  3.23 | ppl    25.37 
| epoch  77 |   200/  269 batches | lr 0.00000 | ms/batch 72.88 | loss  3.19 | ppl    24.31 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 20.15s | valid loss  3.88 | valid ppl    48.62 | valid bpc    5.603
-----------------------------------------------------------------------------------------
PROGRESS: 77.0%
| epoch  78 |   100/  269 batches | lr 0.00000 | ms/batch 74.52 | loss  3.23 | ppl    25.32 
| epoch  78 |   200/  269 batches | lr 0.00000 | ms/batch 72.89 | loss  3.20 | ppl    24.62 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 20.14s | valid loss  3.77 | valid ppl    43.44 | valid bpc    5.441
-----------------------------------------------------------------------------------------
PROGRESS: 78.0%
| epoch  79 |   100/  269 batches | lr 0.00000 | ms/batch 74.67 | loss  3.24 | ppl    25.41 
| epoch  79 |   200/  269 batches | lr 0.00000 | ms/batch 72.96 | loss  3.22 | ppl    24.93 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 20.14s | valid loss  3.82 | valid ppl    45.70 | valid bpc    5.514
-----------------------------------------------------------------------------------------
PROGRESS: 79.0%
| epoch  80 |   100/  269 batches | lr 0.00000 | ms/batch 74.08 | loss  3.25 | ppl    25.73 
| epoch  80 |   200/  269 batches | lr 0.00000 | ms/batch 73.34 | loss  3.20 | ppl    24.59 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 20.13s | valid loss  3.85 | valid ppl    47.01 | valid bpc    5.555
-----------------------------------------------------------------------------------------
PROGRESS: 80.0%
| epoch  81 |   100/  269 batches | lr 0.00000 | ms/batch 74.59 | loss  3.23 | ppl    25.22 
| epoch  81 |   200/  269 batches | lr 0.00000 | ms/batch 72.87 | loss  3.20 | ppl    24.44 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 20.12s | valid loss  3.86 | valid ppl    47.35 | valid bpc    5.565
-----------------------------------------------------------------------------------------
PROGRESS: 81.0%
| epoch  82 |   100/  269 batches | lr 0.00000 | ms/batch 74.44 | loss  3.24 | ppl    25.48 
| epoch  82 |   200/  269 batches | lr 0.00000 | ms/batch 72.98 | loss  3.21 | ppl    24.69 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 20.13s | valid loss  3.80 | valid ppl    44.63 | valid bpc    5.480
-----------------------------------------------------------------------------------------
PROGRESS: 82.0%
| epoch  83 |   100/  269 batches | lr 0.00000 | ms/batch 74.47 | loss  3.24 | ppl    25.44 
| epoch  83 |   200/  269 batches | lr 0.00000 | ms/batch 72.83 | loss  3.22 | ppl    25.00 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 20.13s | valid loss  3.83 | valid ppl    46.19 | valid bpc    5.530
-----------------------------------------------------------------------------------------
PROGRESS: 83.0%
| epoch  84 |   100/  269 batches | lr 0.00000 | ms/batch 74.69 | loss  3.23 | ppl    25.30 
| epoch  84 |   200/  269 batches | lr 0.00000 | ms/batch 72.86 | loss  3.18 | ppl    24.04 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 20.12s | valid loss  3.76 | valid ppl    42.90 | valid bpc    5.423
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 84.0%
| epoch  85 |   100/  269 batches | lr 0.00000 | ms/batch 74.11 | loss  3.23 | ppl    25.33 
| epoch  85 |   200/  269 batches | lr 0.00000 | ms/batch 73.19 | loss  3.19 | ppl    24.39 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 20.12s | valid loss  3.82 | valid ppl    45.40 | valid bpc    5.504
-----------------------------------------------------------------------------------------
PROGRESS: 85.0%
| epoch  86 |   100/  269 batches | lr 0.00000 | ms/batch 74.18 | loss  3.23 | ppl    25.36 
| epoch  86 |   200/  269 batches | lr 0.00000 | ms/batch 72.75 | loss  3.19 | ppl    24.35 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 20.12s | valid loss  3.80 | valid ppl    44.89 | valid bpc    5.488
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  269 batches | lr 0.00000 | ms/batch 74.44 | loss  3.22 | ppl    25.02 
| epoch  87 |   200/  269 batches | lr 0.00000 | ms/batch 73.43 | loss  3.20 | ppl    24.48 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 20.15s | valid loss  3.80 | valid ppl    44.81 | valid bpc    5.486
-----------------------------------------------------------------------------------------
PROGRESS: 87.0%
| epoch  88 |   100/  269 batches | lr 0.00000 | ms/batch 74.37 | loss  3.21 | ppl    24.71 
| epoch  88 |   200/  269 batches | lr 0.00000 | ms/batch 73.23 | loss  3.21 | ppl    24.89 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 20.13s | valid loss  3.85 | valid ppl    47.14 | valid bpc    5.559
-----------------------------------------------------------------------------------------
PROGRESS: 88.0%
| epoch  89 |   100/  269 batches | lr 0.00000 | ms/batch 74.66 | loss  3.24 | ppl    25.53 
| epoch  89 |   200/  269 batches | lr 0.00000 | ms/batch 72.78 | loss  3.19 | ppl    24.28 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 20.13s | valid loss  3.79 | valid ppl    44.14 | valid bpc    5.464
-----------------------------------------------------------------------------------------
PROGRESS: 89.0%
| epoch  90 |   100/  269 batches | lr 0.00000 | ms/batch 74.70 | loss  3.23 | ppl    25.37 
| epoch  90 |   200/  269 batches | lr 0.00000 | ms/batch 72.80 | loss  3.19 | ppl    24.27 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 20.13s | valid loss  3.80 | valid ppl    44.84 | valid bpc    5.487
-----------------------------------------------------------------------------------------
PROGRESS: 90.0%
| epoch  91 |   100/  269 batches | lr 0.00000 | ms/batch 74.28 | loss  3.22 | ppl    25.07 
| epoch  91 |   200/  269 batches | lr 0.00000 | ms/batch 73.10 | loss  3.18 | ppl    24.13 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 20.13s | valid loss  3.80 | valid ppl    44.62 | valid bpc    5.480
-----------------------------------------------------------------------------------------
PROGRESS: 91.0%
| epoch  92 |   100/  269 batches | lr 0.00000 | ms/batch 74.24 | loss  3.24 | ppl    25.56 
| epoch  92 |   200/  269 batches | lr 0.00000 | ms/batch 73.40 | loss  3.21 | ppl    24.75 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 20.13s | valid loss  3.81 | valid ppl    45.26 | valid bpc    5.500
-----------------------------------------------------------------------------------------
PROGRESS: 92.0%
| epoch  93 |   100/  269 batches | lr 0.00000 | ms/batch 74.68 | loss  3.22 | ppl    25.13 
| epoch  93 |   200/  269 batches | lr 0.00000 | ms/batch 72.94 | loss  3.19 | ppl    24.37 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 20.14s | valid loss  3.84 | valid ppl    46.43 | valid bpc    5.537
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  269 batches | lr 0.00000 | ms/batch 74.55 | loss  3.23 | ppl    25.20 
| epoch  94 |   200/  269 batches | lr 0.00000 | ms/batch 73.34 | loss  3.22 | ppl    25.08 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 20.15s | valid loss  3.77 | valid ppl    43.59 | valid bpc    5.446
-----------------------------------------------------------------------------------------
PROGRESS: 94.0%
| epoch  95 |   100/  269 batches | lr 0.00000 | ms/batch 74.35 | loss  3.23 | ppl    25.38 
| epoch  95 |   200/  269 batches | lr 0.00000 | ms/batch 73.08 | loss  3.19 | ppl    24.27 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 20.16s | valid loss  3.76 | valid ppl    42.85 | valid bpc    5.421
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 95.0%
| epoch  96 |   100/  269 batches | lr 0.00000 | ms/batch 74.80 | loss  3.24 | ppl    25.55 
| epoch  96 |   200/  269 batches | lr 0.00000 | ms/batch 72.80 | loss  3.20 | ppl    24.50 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 20.14s | valid loss  3.79 | valid ppl    44.18 | valid bpc    5.465
-----------------------------------------------------------------------------------------
PROGRESS: 96.0%
| epoch  97 |   100/  269 batches | lr 0.00000 | ms/batch 74.49 | loss  3.23 | ppl    25.25 
| epoch  97 |   200/  269 batches | lr 0.00000 | ms/batch 73.26 | loss  3.19 | ppl    24.30 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 20.14s | valid loss  3.87 | valid ppl    48.02 | valid bpc    5.586
-----------------------------------------------------------------------------------------
PROGRESS: 97.0%
| epoch  98 |   100/  269 batches | lr 0.00000 | ms/batch 74.18 | loss  3.21 | ppl    24.79 
| epoch  98 |   200/  269 batches | lr 0.00000 | ms/batch 73.42 | loss  3.19 | ppl    24.38 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 20.14s | valid loss  3.86 | valid ppl    47.65 | valid bpc    5.574
-----------------------------------------------------------------------------------------
PROGRESS: 98.0%
| epoch  99 |   100/  269 batches | lr 0.00000 | ms/batch 74.29 | loss  3.25 | ppl    25.70 
| epoch  99 |   200/  269 batches | lr 0.00000 | ms/batch 73.34 | loss  3.18 | ppl    23.97 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 20.14s | valid loss  3.87 | valid ppl    47.73 | valid bpc    5.577
-----------------------------------------------------------------------------------------
PROGRESS: 99.0%
| epoch 100 |   100/  269 batches | lr 0.00000 | ms/batch 74.52 | loss  3.23 | ppl    25.35 
| epoch 100 |   200/  269 batches | lr 0.00000 | ms/batch 73.23 | loss  3.21 | ppl    24.67 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 20.14s | valid loss  3.79 | valid ppl    44.16 | valid bpc    5.465
-----------------------------------------------------------------------------------------
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  3.90 | test ppl    49.55 | test bpc    5.631
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.4593, Mean Reca: 0.6448, Mean F1: 0.5323, Mean Subword_Reca: 0.8526
-----------------------------------------------------------------------------------------
=========================================================================================
