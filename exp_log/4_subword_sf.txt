Loading dataset...
Using subword tokenizer...
Number of tokens:  8000
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer', nhid=512, nlayers=8, front_layers=2, rear_layers=6, subword='omarmomen/ptb_filtered_lowcase_bpe_tokenizer_8', n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=1111, nonmono=5, cuda=True, log_interval=100, save='trained_models/subword_1111.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 37448132
Model architecture: StructFormer(
  (drop): Dropout(p=0.1, inplace=False)
  (emb): Embedding(8000, 512)
  (pos_emb): Embedding(500, 512)
  (layers): ModuleList(
    (0-7): 8 x TransformerLayer(
      (self_attn): MultiheadAttention(
        (drop): Dropout(p=0, inplace=False)
        (q_proj): Linear(in_features=512, out_features=512, bias=True)
        (k_proj): Linear(in_features=512, out_features=512, bias=True)
        (v_proj): Linear(in_features=512, out_features=512, bias=True)
        (out_proj): Linear(in_features=512, out_features=512, bias=True)
      )
      (feedforward): Sequential(
        (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (1): Linear(in_features=512, out_features=2048, bias=True)
        (2): LeakyReLU(negative_slope=0.01)
        (3): Dropout(p=0.1, inplace=False)
        (4): Linear(in_features=2048, out_features=512, bias=True)
      )
      (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      (dropout1): Dropout(p=0.1, inplace=False)
      (dropout2): Dropout(p=0.1, inplace=False)
    )
  )
  (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  (output_layer): Linear(in_features=512, out_features=8000, bias=True)
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  269 batches | lr 0.00030 | ms/batch 80.76 | loss  7.75 | ppl  2322.34 
| epoch   1 |   200/  269 batches | lr 0.00030 | ms/batch 73.99 | loss  7.37 | ppl  1582.55 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 20.97s | valid loss  7.09 | valid ppl  1197.02 | valid bpc   10.225
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  269 batches | lr 0.00030 | ms/batch 75.80 | loss  7.27 | ppl  1432.05 
| epoch   2 |   200/  269 batches | lr 0.00030 | ms/batch 74.90 | loss  7.13 | ppl  1253.05 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 20.61s | valid loss  6.90 | valid ppl   994.66 | valid bpc    9.958
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  269 batches | lr 0.00030 | ms/batch 76.37 | loss  7.11 | ppl  1221.50 
| epoch   3 |   200/  269 batches | lr 0.00030 | ms/batch 75.18 | loss  6.98 | ppl  1080.21 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 20.70s | valid loss  6.80 | valid ppl   901.88 | valid bpc    9.817
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  269 batches | lr 0.00030 | ms/batch 76.14 | loss  6.98 | ppl  1070.35 
| epoch   4 |   200/  269 batches | lr 0.00030 | ms/batch 75.13 | loss  6.87 | ppl   962.40 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 20.70s | valid loss  6.71 | valid ppl   823.19 | valid bpc    9.685
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  269 batches | lr 0.00030 | ms/batch 76.86 | loss  6.92 | ppl  1011.79 
| epoch   5 |   200/  269 batches | lr 0.00030 | ms/batch 74.55 | loss  6.79 | ppl   890.29 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 20.74s | valid loss  6.65 | valid ppl   774.78 | valid bpc    9.598
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  269 batches | lr 0.00030 | ms/batch 76.80 | loss  6.79 | ppl   890.55 
| epoch   6 |   200/  269 batches | lr 0.00030 | ms/batch 75.68 | loss  6.75 | ppl   853.83 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 20.84s | valid loss  6.36 | valid ppl   576.69 | valid bpc    9.172
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  269 batches | lr 0.00030 | ms/batch 77.29 | loss  6.44 | ppl   624.88 
| epoch   7 |   200/  269 batches | lr 0.00030 | ms/batch 75.80 | loss  6.16 | ppl   473.34 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 20.89s | valid loss  5.85 | valid ppl   347.02 | valid bpc    8.439
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  269 batches | lr 0.00030 | ms/batch 77.35 | loss  5.95 | ppl   382.65 
| epoch   8 |   200/  269 batches | lr 0.00030 | ms/batch 75.66 | loss  5.80 | ppl   328.93 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 20.90s | valid loss  5.43 | valid ppl   227.72 | valid bpc    7.831
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 8.0%
| epoch   9 |   100/  269 batches | lr 0.00030 | ms/batch 77.17 | loss  5.61 | ppl   272.36 
| epoch   9 |   200/  269 batches | lr 0.00030 | ms/batch 75.79 | loss  5.49 | ppl   241.69 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 20.91s | valid loss  5.20 | valid ppl   181.96 | valid bpc    7.507
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  269 batches | lr 0.00030 | ms/batch 77.05 | loss  5.35 | ppl   211.00 
| epoch  10 |   200/  269 batches | lr 0.00030 | ms/batch 75.93 | loss  5.26 | ppl   192.63 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 20.93s | valid loss  5.06 | valid ppl   157.99 | valid bpc    7.304
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  269 batches | lr 0.00030 | ms/batch 77.25 | loss  5.18 | ppl   177.13 
| epoch  11 |   200/  269 batches | lr 0.00030 | ms/batch 76.15 | loss  5.09 | ppl   161.93 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 20.95s | valid loss  4.88 | valid ppl   132.22 | valid bpc    7.047
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  269 batches | lr 0.00030 | ms/batch 77.15 | loss  5.01 | ppl   149.44 
| epoch  12 |   200/  269 batches | lr 0.00030 | ms/batch 76.01 | loss  4.93 | ppl   138.60 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 20.95s | valid loss  4.74 | valid ppl   114.12 | valid bpc    6.834
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 12.0%
| epoch  13 |   100/  269 batches | lr 0.00030 | ms/batch 77.50 | loss  4.89 | ppl   132.34 
| epoch  13 |   200/  269 batches | lr 0.00030 | ms/batch 76.01 | loss  4.81 | ppl   123.34 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 20.97s | valid loss  4.70 | valid ppl   109.61 | valid bpc    6.776
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 13.0%
| epoch  14 |   100/  269 batches | lr 0.00030 | ms/batch 77.63 | loss  4.76 | ppl   116.24 
| epoch  14 |   200/  269 batches | lr 0.00030 | ms/batch 76.06 | loss  4.71 | ppl   111.42 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 20.98s | valid loss  4.54 | valid ppl    93.41 | valid bpc    6.546
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  269 batches | lr 0.00030 | ms/batch 77.30 | loss  4.66 | ppl   105.87 
| epoch  15 |   200/  269 batches | lr 0.00030 | ms/batch 76.44 | loss  4.60 | ppl    99.89 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 20.98s | valid loss  4.50 | valid ppl    89.89 | valid bpc    6.490
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 15.0%
| epoch  16 |   100/  269 batches | lr 0.00030 | ms/batch 77.36 | loss  4.55 | ppl    94.97 
| epoch  16 |   200/  269 batches | lr 0.00030 | ms/batch 76.43 | loss  4.50 | ppl    89.86 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 20.99s | valid loss  4.52 | valid ppl    91.53 | valid bpc    6.516
-----------------------------------------------------------------------------------------
PROGRESS: 16.0%
| epoch  17 |   100/  269 batches | lr 0.00030 | ms/batch 77.65 | loss  4.49 | ppl    88.91 
| epoch  17 |   200/  269 batches | lr 0.00030 | ms/batch 76.07 | loss  4.44 | ppl    84.77 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 21.00s | valid loss  4.43 | valid ppl    84.15 | valid bpc    6.395
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 17.0%
| epoch  18 |   100/  269 batches | lr 0.00030 | ms/batch 77.39 | loss  4.41 | ppl    82.21 
| epoch  18 |   200/  269 batches | lr 0.00030 | ms/batch 76.42 | loss  4.35 | ppl    77.32 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 20.99s | valid loss  4.35 | valid ppl    77.25 | valid bpc    6.271
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 18.0%
| epoch  19 |   100/  269 batches | lr 0.00030 | ms/batch 77.24 | loss  4.32 | ppl    75.10 
| epoch  19 |   200/  269 batches | lr 0.00030 | ms/batch 76.22 | loss  4.28 | ppl    72.21 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 20.99s | valid loss  4.36 | valid ppl    77.95 | valid bpc    6.285
-----------------------------------------------------------------------------------------
PROGRESS: 19.0%
| epoch  20 |   100/  269 batches | lr 0.00030 | ms/batch 77.42 | loss  4.26 | ppl    70.79 
| epoch  20 |   200/  269 batches | lr 0.00030 | ms/batch 76.65 | loss  4.22 | ppl    68.07 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 21.04s | valid loss  4.26 | valid ppl    70.77 | valid bpc    6.145
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 20.0%
| epoch  21 |   100/  269 batches | lr 0.00030 | ms/batch 77.68 | loss  4.17 | ppl    64.72 
| epoch  21 |   200/  269 batches | lr 0.00030 | ms/batch 76.29 | loss  4.15 | ppl    63.38 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 21.04s | valid loss  4.28 | valid ppl    72.24 | valid bpc    6.175
-----------------------------------------------------------------------------------------
PROGRESS: 21.0%
| epoch  22 |   100/  269 batches | lr 0.00030 | ms/batch 77.97 | loss  4.13 | ppl    62.14 
| epoch  22 |   200/  269 batches | lr 0.00030 | ms/batch 76.14 | loss  4.09 | ppl    59.79 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 21.03s | valid loss  4.20 | valid ppl    66.39 | valid bpc    6.053
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 22.0%
| epoch  23 |   100/  269 batches | lr 0.00030 | ms/batch 77.91 | loss  4.06 | ppl    58.00 
| epoch  23 |   200/  269 batches | lr 0.00030 | ms/batch 76.18 | loss  4.05 | ppl    57.36 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 21.03s | valid loss  4.21 | valid ppl    67.07 | valid bpc    6.068
-----------------------------------------------------------------------------------------
PROGRESS: 23.0%
| epoch  24 |   100/  269 batches | lr 0.00030 | ms/batch 77.98 | loss  4.02 | ppl    55.94 
| epoch  24 |   200/  269 batches | lr 0.00030 | ms/batch 75.91 | loss  4.00 | ppl    54.49 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 20.99s | valid loss  4.13 | valid ppl    62.18 | valid bpc    5.958
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 24.0%
| epoch  25 |   100/  269 batches | lr 0.00030 | ms/batch 77.68 | loss  3.99 | ppl    53.84 
| epoch  25 |   200/  269 batches | lr 0.00030 | ms/batch 76.42 | loss  3.94 | ppl    51.37 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 21.05s | valid loss  4.16 | valid ppl    64.28 | valid bpc    6.006
-----------------------------------------------------------------------------------------
PROGRESS: 25.0%
| epoch  26 |   100/  269 batches | lr 0.00030 | ms/batch 77.91 | loss  3.94 | ppl    51.44 
| epoch  26 |   200/  269 batches | lr 0.00030 | ms/batch 75.89 | loss  3.89 | ppl    49.12 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 21.00s | valid loss  4.10 | valid ppl    60.33 | valid bpc    5.915
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 26.0%
| epoch  27 |   100/  269 batches | lr 0.00030 | ms/batch 78.00 | loss  3.88 | ppl    48.45 
| epoch  27 |   200/  269 batches | lr 0.00030 | ms/batch 76.14 | loss  3.83 | ppl    46.17 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 21.06s | valid loss  4.10 | valid ppl    60.50 | valid bpc    5.919
-----------------------------------------------------------------------------------------
PROGRESS: 27.0%
| epoch  28 |   100/  269 batches | lr 0.00030 | ms/batch 77.44 | loss  3.83 | ppl    46.23 
| epoch  28 |   200/  269 batches | lr 0.00030 | ms/batch 75.76 | loss  3.78 | ppl    43.93 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 21.00s | valid loss  4.06 | valid ppl    57.78 | valid bpc    5.853
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  269 batches | lr 0.00030 | ms/batch 77.72 | loss  3.79 | ppl    44.44 
| epoch  29 |   200/  269 batches | lr 0.00030 | ms/batch 76.29 | loss  3.76 | ppl    43.04 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 21.06s | valid loss  4.01 | valid ppl    55.35 | valid bpc    5.791
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  269 batches | lr 0.00030 | ms/batch 78.05 | loss  3.75 | ppl    42.57 
| epoch  30 |   200/  269 batches | lr 0.00030 | ms/batch 76.43 | loss  3.73 | ppl    41.67 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 21.07s | valid loss  4.03 | valid ppl    56.01 | valid bpc    5.808
-----------------------------------------------------------------------------------------
PROGRESS: 30.0%
| epoch  31 |   100/  269 batches | lr 0.00030 | ms/batch 77.30 | loss  3.69 | ppl    40.10 
| epoch  31 |   200/  269 batches | lr 0.00030 | ms/batch 76.28 | loss  3.70 | ppl    40.58 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 21.00s | valid loss  4.02 | valid ppl    55.56 | valid bpc    5.796
-----------------------------------------------------------------------------------------
PROGRESS: 31.0%
| epoch  32 |   100/  269 batches | lr 0.00030 | ms/batch 77.70 | loss  3.69 | ppl    39.94 
| epoch  32 |   200/  269 batches | lr 0.00030 | ms/batch 76.11 | loss  3.67 | ppl    39.44 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 21.01s | valid loss  3.99 | valid ppl    54.11 | valid bpc    5.758
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 32.0%
| epoch  33 |   100/  269 batches | lr 0.00030 | ms/batch 77.86 | loss  3.65 | ppl    38.32 
| epoch  33 |   200/  269 batches | lr 0.00030 | ms/batch 76.04 | loss  3.63 | ppl    37.56 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 21.06s | valid loss  4.00 | valid ppl    54.72 | valid bpc    5.774
-----------------------------------------------------------------------------------------
PROGRESS: 33.0%
| epoch  34 |   100/  269 batches | lr 0.00030 | ms/batch 77.60 | loss  3.61 | ppl    36.89 
| epoch  34 |   200/  269 batches | lr 0.00030 | ms/batch 76.06 | loss  3.59 | ppl    36.33 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 21.01s | valid loss  3.96 | valid ppl    52.52 | valid bpc    5.715
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 34.0%
| epoch  35 |   100/  269 batches | lr 0.00030 | ms/batch 77.89 | loss  3.57 | ppl    35.59 
| epoch  35 |   200/  269 batches | lr 0.00030 | ms/batch 76.36 | loss  3.56 | ppl    35.31 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 21.05s | valid loss  3.91 | valid ppl    49.98 | valid bpc    5.643
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 35.0%
| epoch  36 |   100/  269 batches | lr 0.00030 | ms/batch 77.28 | loss  3.53 | ppl    33.98 
| epoch  36 |   200/  269 batches | lr 0.00030 | ms/batch 76.47 | loss  3.51 | ppl    33.37 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 21.03s | valid loss  3.98 | valid ppl    53.26 | valid bpc    5.735
-----------------------------------------------------------------------------------------
PROGRESS: 36.0%
| epoch  37 |   100/  269 batches | lr 0.00030 | ms/batch 77.14 | loss  3.49 | ppl    32.93 
| epoch  37 |   200/  269 batches | lr 0.00030 | ms/batch 76.49 | loss  3.49 | ppl    32.78 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 20.99s | valid loss  3.92 | valid ppl    50.15 | valid bpc    5.648
-----------------------------------------------------------------------------------------
PROGRESS: 37.0%
| epoch  38 |   100/  269 batches | lr 0.00030 | ms/batch 78.04 | loss  3.47 | ppl    32.10 
| epoch  38 |   200/  269 batches | lr 0.00030 | ms/batch 75.95 | loss  3.45 | ppl    31.41 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 21.02s | valid loss  3.92 | valid ppl    50.57 | valid bpc    5.660
-----------------------------------------------------------------------------------------
PROGRESS: 38.0%
| epoch  39 |   100/  269 batches | lr 0.00015 | ms/batch 78.13 | loss  3.40 | ppl    29.88 
| epoch  39 |   200/  269 batches | lr 0.00015 | ms/batch 76.04 | loss  3.32 | ppl    27.68 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 21.02s | valid loss  3.85 | valid ppl    47.16 | valid bpc    5.559
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 39.0%
| epoch  40 |   100/  269 batches | lr 0.00015 | ms/batch 78.00 | loss  3.33 | ppl    27.94 
| epoch  40 |   200/  269 batches | lr 0.00015 | ms/batch 75.99 | loss  3.30 | ppl    27.13 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 21.06s | valid loss  3.79 | valid ppl    44.35 | valid bpc    5.471
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 40.0%
| epoch  41 |   100/  269 batches | lr 0.00015 | ms/batch 77.57 | loss  3.29 | ppl    26.83 
| epoch  41 |   200/  269 batches | lr 0.00015 | ms/batch 76.73 | loss  3.25 | ppl    25.90 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 21.06s | valid loss  3.91 | valid ppl    49.94 | valid bpc    5.642
-----------------------------------------------------------------------------------------
PROGRESS: 41.0%
| epoch  42 |   100/  269 batches | lr 0.00015 | ms/batch 78.09 | loss  3.27 | ppl    26.31 
| epoch  42 |   200/  269 batches | lr 0.00015 | ms/batch 76.72 | loss  3.24 | ppl    25.55 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 21.06s | valid loss  3.88 | valid ppl    48.63 | valid bpc    5.604
-----------------------------------------------------------------------------------------
PROGRESS: 42.0%
| epoch  43 |   100/  269 batches | lr 0.00015 | ms/batch 77.60 | loss  3.22 | ppl    25.02 
| epoch  43 |   200/  269 batches | lr 0.00015 | ms/batch 76.07 | loss  3.25 | ppl    25.68 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 21.02s | valid loss  3.83 | valid ppl    46.06 | valid bpc    5.526
-----------------------------------------------------------------------------------------
PROGRESS: 43.0%
| epoch  44 |   100/  269 batches | lr 0.00007 | ms/batch 77.42 | loss  3.19 | ppl    24.20 
| epoch  44 |   200/  269 batches | lr 0.00007 | ms/batch 76.62 | loss  3.17 | ppl    23.76 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 21.02s | valid loss  3.79 | valid ppl    44.48 | valid bpc    5.475
-----------------------------------------------------------------------------------------
PROGRESS: 44.0%
| epoch  45 |   100/  269 batches | lr 0.00007 | ms/batch 78.39 | loss  3.17 | ppl    23.79 
| epoch  45 |   200/  269 batches | lr 0.00007 | ms/batch 75.86 | loss  3.14 | ppl    23.03 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 21.02s | valid loss  3.77 | valid ppl    43.23 | valid bpc    5.434
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 45.0%
| epoch  46 |   100/  269 batches | lr 0.00007 | ms/batch 78.23 | loss  3.15 | ppl    23.40 
| epoch  46 |   200/  269 batches | lr 0.00007 | ms/batch 76.27 | loss  3.10 | ppl    22.21 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 21.06s | valid loss  3.82 | valid ppl    45.59 | valid bpc    5.511
-----------------------------------------------------------------------------------------
PROGRESS: 46.0%
| epoch  47 |   100/  269 batches | lr 0.00007 | ms/batch 77.87 | loss  3.11 | ppl    22.41 
| epoch  47 |   200/  269 batches | lr 0.00007 | ms/batch 76.26 | loss  3.08 | ppl    21.74 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 21.01s | valid loss  3.76 | valid ppl    42.76 | valid bpc    5.418
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 47.0%
| epoch  48 |   100/  269 batches | lr 0.00007 | ms/batch 77.67 | loss  3.10 | ppl    22.30 
| epoch  48 |   200/  269 batches | lr 0.00007 | ms/batch 75.89 | loss  3.07 | ppl    21.51 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 21.06s | valid loss  3.76 | valid ppl    42.84 | valid bpc    5.421
-----------------------------------------------------------------------------------------
PROGRESS: 48.0%
| epoch  49 |   100/  269 batches | lr 0.00007 | ms/batch 77.42 | loss  3.08 | ppl    21.82 
| epoch  49 |   200/  269 batches | lr 0.00007 | ms/batch 76.40 | loss  3.06 | ppl    21.41 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 21.03s | valid loss  3.77 | valid ppl    43.44 | valid bpc    5.441
-----------------------------------------------------------------------------------------
PROGRESS: 49.0%
| epoch  50 |   100/  269 batches | lr 0.00007 | ms/batch 77.44 | loss  3.09 | ppl    21.98 
| epoch  50 |   200/  269 batches | lr 0.00007 | ms/batch 76.27 | loss  3.04 | ppl    20.89 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 21.00s | valid loss  3.82 | valid ppl    45.58 | valid bpc    5.510
-----------------------------------------------------------------------------------------
PROGRESS: 50.0%
| epoch  51 |   100/  269 batches | lr 0.00004 | ms/batch 77.33 | loss  3.05 | ppl    21.14 
| epoch  51 |   200/  269 batches | lr 0.00004 | ms/batch 76.17 | loss  3.03 | ppl    20.75 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 21.03s | valid loss  3.73 | valid ppl    41.58 | valid bpc    5.378
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 51.0%
| epoch  52 |   100/  269 batches | lr 0.00004 | ms/batch 77.81 | loss  3.02 | ppl    20.57 
| epoch  52 |   200/  269 batches | lr 0.00004 | ms/batch 76.68 | loss  3.02 | ppl    20.41 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 21.08s | valid loss  3.80 | valid ppl    44.59 | valid bpc    5.479
-----------------------------------------------------------------------------------------
PROGRESS: 52.0%
| epoch  53 |   100/  269 batches | lr 0.00004 | ms/batch 77.79 | loss  3.04 | ppl    20.86 
| epoch  53 |   200/  269 batches | lr 0.00004 | ms/batch 76.43 | loss  2.99 | ppl    19.92 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 21.02s | valid loss  3.76 | valid ppl    42.85 | valid bpc    5.421
-----------------------------------------------------------------------------------------
PROGRESS: 53.0%
| epoch  54 |   100/  269 batches | lr 0.00004 | ms/batch 77.37 | loss  3.01 | ppl    20.37 
| epoch  54 |   200/  269 batches | lr 0.00004 | ms/batch 76.29 | loss  2.98 | ppl    19.76 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 21.03s | valid loss  3.77 | valid ppl    43.52 | valid bpc    5.443
-----------------------------------------------------------------------------------------
PROGRESS: 54.0%
| epoch  55 |   100/  269 batches | lr 0.00002 | ms/batch 77.58 | loss  2.99 | ppl    19.89 
| epoch  55 |   200/  269 batches | lr 0.00002 | ms/batch 76.31 | loss  2.99 | ppl    19.91 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 21.03s | valid loss  3.81 | valid ppl    45.25 | valid bpc    5.500
-----------------------------------------------------------------------------------------
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  269 batches | lr 0.00002 | ms/batch 77.54 | loss  3.00 | ppl    20.03 
| epoch  56 |   200/  269 batches | lr 0.00002 | ms/batch 76.23 | loss  2.97 | ppl    19.48 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 21.03s | valid loss  3.82 | valid ppl    45.44 | valid bpc    5.506
-----------------------------------------------------------------------------------------
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  269 batches | lr 0.00002 | ms/batch 78.07 | loss  3.00 | ppl    20.04 
| epoch  57 |   200/  269 batches | lr 0.00002 | ms/batch 76.57 | loss  2.96 | ppl    19.26 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 21.07s | valid loss  3.76 | valid ppl    42.98 | valid bpc    5.426
-----------------------------------------------------------------------------------------
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  269 batches | lr 0.00001 | ms/batch 77.64 | loss  2.99 | ppl    19.84 
| epoch  58 |   200/  269 batches | lr 0.00001 | ms/batch 76.49 | loss  2.96 | ppl    19.27 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 21.03s | valid loss  3.75 | valid ppl    42.34 | valid bpc    5.404
-----------------------------------------------------------------------------------------
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  269 batches | lr 0.00001 | ms/batch 77.68 | loss  2.95 | ppl    19.20 
| epoch  59 |   200/  269 batches | lr 0.00001 | ms/batch 76.32 | loss  2.95 | ppl    19.06 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 21.03s | valid loss  3.78 | valid ppl    43.63 | valid bpc    5.447
-----------------------------------------------------------------------------------------
PROGRESS: 59.0%
| epoch  60 |   100/  269 batches | lr 0.00001 | ms/batch 77.77 | loss  2.97 | ppl    19.54 
| epoch  60 |   200/  269 batches | lr 0.00001 | ms/batch 76.18 | loss  2.94 | ppl    18.88 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 21.03s | valid loss  3.75 | valid ppl    42.53 | valid bpc    5.410
-----------------------------------------------------------------------------------------
PROGRESS: 60.0%
| epoch  61 |   100/  269 batches | lr 0.00000 | ms/batch 77.76 | loss  2.95 | ppl    19.07 
| epoch  61 |   200/  269 batches | lr 0.00000 | ms/batch 76.61 | loss  2.94 | ppl    18.93 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 21.07s | valid loss  3.72 | valid ppl    41.38 | valid bpc    5.371
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 61.0%
| epoch  62 |   100/  269 batches | lr 0.00000 | ms/batch 77.89 | loss  2.98 | ppl    19.60 
| epoch  62 |   200/  269 batches | lr 0.00000 | ms/batch 76.41 | loss  2.94 | ppl    18.97 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 21.06s | valid loss  3.77 | valid ppl    43.35 | valid bpc    5.438
-----------------------------------------------------------------------------------------
PROGRESS: 62.0%
| epoch  63 |   100/  269 batches | lr 0.00000 | ms/batch 77.66 | loss  2.97 | ppl    19.55 
| epoch  63 |   200/  269 batches | lr 0.00000 | ms/batch 75.86 | loss  2.93 | ppl    18.63 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 21.01s | valid loss  3.73 | valid ppl    41.57 | valid bpc    5.377
-----------------------------------------------------------------------------------------
PROGRESS: 63.0%
| epoch  64 |   100/  269 batches | lr 0.00000 | ms/batch 77.82 | loss  2.98 | ppl    19.67 
| epoch  64 |   200/  269 batches | lr 0.00000 | ms/batch 76.44 | loss  2.94 | ppl    18.94 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 21.07s | valid loss  3.73 | valid ppl    41.89 | valid bpc    5.388
-----------------------------------------------------------------------------------------
PROGRESS: 64.0%
| epoch  65 |   100/  269 batches | lr 0.00000 | ms/batch 77.63 | loss  2.96 | ppl    19.21 
| epoch  65 |   200/  269 batches | lr 0.00000 | ms/batch 76.51 | loss  2.95 | ppl    19.14 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 21.08s | valid loss  3.70 | valid ppl    40.58 | valid bpc    5.343
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 65.0%
| epoch  66 |   100/  269 batches | lr 0.00000 | ms/batch 77.99 | loss  2.97 | ppl    19.45 
| epoch  66 |   200/  269 batches | lr 0.00000 | ms/batch 76.26 | loss  2.92 | ppl    18.54 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 21.07s | valid loss  3.73 | valid ppl    41.80 | valid bpc    5.385
-----------------------------------------------------------------------------------------
PROGRESS: 66.0%
| epoch  67 |   100/  269 batches | lr 0.00000 | ms/batch 77.54 | loss  2.97 | ppl    19.43 
| epoch  67 |   200/  269 batches | lr 0.00000 | ms/batch 76.32 | loss  2.94 | ppl    18.86 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 21.03s | valid loss  3.69 | valid ppl    40.17 | valid bpc    5.328
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 67.0%
| epoch  68 |   100/  269 batches | lr 0.00000 | ms/batch 77.70 | loss  2.95 | ppl    19.04 
| epoch  68 |   200/  269 batches | lr 0.00000 | ms/batch 76.72 | loss  2.94 | ppl    18.90 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 21.07s | valid loss  3.77 | valid ppl    43.55 | valid bpc    5.445
-----------------------------------------------------------------------------------------
PROGRESS: 68.0%
| epoch  69 |   100/  269 batches | lr 0.00000 | ms/batch 77.74 | loss  2.94 | ppl    18.89 
| epoch  69 |   200/  269 batches | lr 0.00000 | ms/batch 76.57 | loss  2.95 | ppl    19.02 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 21.07s | valid loss  3.79 | valid ppl    44.07 | valid bpc    5.462
-----------------------------------------------------------------------------------------
PROGRESS: 69.0%
| epoch  70 |   100/  269 batches | lr 0.00000 | ms/batch 77.66 | loss  2.97 | ppl    19.42 
| epoch  70 |   200/  269 batches | lr 0.00000 | ms/batch 76.62 | loss  2.93 | ppl    18.81 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 21.02s | valid loss  3.78 | valid ppl    43.65 | valid bpc    5.448
-----------------------------------------------------------------------------------------
PROGRESS: 70.0%
| epoch  71 |   100/  269 batches | lr 0.00000 | ms/batch 77.31 | loss  2.97 | ppl    19.43 
| epoch  71 |   200/  269 batches | lr 0.00000 | ms/batch 76.63 | loss  2.95 | ppl    19.19 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 21.03s | valid loss  3.78 | valid ppl    44.00 | valid bpc    5.459
-----------------------------------------------------------------------------------------
PROGRESS: 71.0%
| epoch  72 |   100/  269 batches | lr 0.00000 | ms/batch 78.00 | loss  2.99 | ppl    19.92 
| epoch  72 |   200/  269 batches | lr 0.00000 | ms/batch 75.98 | loss  2.92 | ppl    18.58 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 21.02s | valid loss  3.77 | valid ppl    43.59 | valid bpc    5.446
-----------------------------------------------------------------------------------------
PROGRESS: 72.0%
| epoch  73 |   100/  269 batches | lr 0.00000 | ms/batch 77.61 | loss  2.97 | ppl    19.46 
| epoch  73 |   200/  269 batches | lr 0.00000 | ms/batch 76.49 | loss  2.95 | ppl    19.02 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 21.03s | valid loss  3.73 | valid ppl    41.63 | valid bpc    5.380
-----------------------------------------------------------------------------------------
PROGRESS: 73.0%
| epoch  74 |   100/  269 batches | lr 0.00000 | ms/batch 77.79 | loss  2.97 | ppl    19.40 
| epoch  74 |   200/  269 batches | lr 0.00000 | ms/batch 76.08 | loss  2.93 | ppl    18.64 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 21.03s | valid loss  3.79 | valid ppl    44.09 | valid bpc    5.462
-----------------------------------------------------------------------------------------
PROGRESS: 74.0%
| epoch  75 |   100/  269 batches | lr 0.00000 | ms/batch 77.31 | loss  2.96 | ppl    19.26 
| epoch  75 |   200/  269 batches | lr 0.00000 | ms/batch 76.52 | loss  2.94 | ppl    18.93 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 21.03s | valid loss  3.74 | valid ppl    41.90 | valid bpc    5.389
-----------------------------------------------------------------------------------------
PROGRESS: 75.0%
| epoch  76 |   100/  269 batches | lr 0.00000 | ms/batch 77.83 | loss  2.94 | ppl    18.85 
| epoch  76 |   200/  269 batches | lr 0.00000 | ms/batch 76.05 | loss  2.96 | ppl    19.30 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 21.03s | valid loss  3.77 | valid ppl    43.35 | valid bpc    5.438
-----------------------------------------------------------------------------------------
PROGRESS: 76.0%
| epoch  77 |   100/  269 batches | lr 0.00000 | ms/batch 77.43 | loss  2.94 | ppl    18.93 
| epoch  77 |   200/  269 batches | lr 0.00000 | ms/batch 76.35 | loss  2.93 | ppl    18.70 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 21.03s | valid loss  3.74 | valid ppl    42.28 | valid bpc    5.402
-----------------------------------------------------------------------------------------
PROGRESS: 77.0%
| epoch  78 |   100/  269 batches | lr 0.00000 | ms/batch 77.71 | loss  2.95 | ppl    19.12 
| epoch  78 |   200/  269 batches | lr 0.00000 | ms/batch 76.86 | loss  2.93 | ppl    18.68 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 21.09s | valid loss  3.77 | valid ppl    43.49 | valid bpc    5.443
-----------------------------------------------------------------------------------------
PROGRESS: 78.0%
| epoch  79 |   100/  269 batches | lr 0.00000 | ms/batch 77.41 | loss  2.97 | ppl    19.45 
| epoch  79 |   200/  269 batches | lr 0.00000 | ms/batch 76.63 | loss  2.91 | ppl    18.34 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 21.03s | valid loss  3.73 | valid ppl    41.83 | valid bpc    5.387
-----------------------------------------------------------------------------------------
PROGRESS: 79.0%
| epoch  80 |   100/  269 batches | lr 0.00000 | ms/batch 77.83 | loss  2.98 | ppl    19.65 
| epoch  80 |   200/  269 batches | lr 0.00000 | ms/batch 75.91 | loss  2.92 | ppl    18.61 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 21.03s | valid loss  3.76 | valid ppl    42.79 | valid bpc    5.419
-----------------------------------------------------------------------------------------
PROGRESS: 80.0%
| epoch  81 |   100/  269 batches | lr 0.00000 | ms/batch 77.71 | loss  2.98 | ppl    19.61 
| epoch  81 |   200/  269 batches | lr 0.00000 | ms/batch 76.05 | loss  2.95 | ppl    19.08 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 21.03s | valid loss  3.77 | valid ppl    43.23 | valid bpc    5.434
-----------------------------------------------------------------------------------------
PROGRESS: 81.0%
| epoch  82 |   100/  269 batches | lr 0.00000 | ms/batch 78.13 | loss  2.95 | ppl    19.11 
| epoch  82 |   200/  269 batches | lr 0.00000 | ms/batch 75.96 | loss  2.92 | ppl    18.55 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 21.03s | valid loss  3.76 | valid ppl    42.97 | valid bpc    5.425
-----------------------------------------------------------------------------------------
PROGRESS: 82.0%
| epoch  83 |   100/  269 batches | lr 0.00000 | ms/batch 77.99 | loss  2.97 | ppl    19.40 
| epoch  83 |   200/  269 batches | lr 0.00000 | ms/batch 75.88 | loss  2.92 | ppl    18.59 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 21.04s | valid loss  3.80 | valid ppl    44.58 | valid bpc    5.478
-----------------------------------------------------------------------------------------
PROGRESS: 83.0%
| epoch  84 |   100/  269 batches | lr 0.00000 | ms/batch 77.70 | loss  2.95 | ppl    19.07 
| epoch  84 |   200/  269 batches | lr 0.00000 | ms/batch 76.39 | loss  2.91 | ppl    18.39 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 21.03s | valid loss  3.81 | valid ppl    45.27 | valid bpc    5.501
-----------------------------------------------------------------------------------------
PROGRESS: 84.0%
| epoch  85 |   100/  269 batches | lr 0.00000 | ms/batch 77.87 | loss  2.96 | ppl    19.38 
| epoch  85 |   200/  269 batches | lr 0.00000 | ms/batch 76.38 | loss  2.91 | ppl    18.32 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 21.04s | valid loss  3.75 | valid ppl    42.55 | valid bpc    5.411
-----------------------------------------------------------------------------------------
PROGRESS: 85.0%
| epoch  86 |   100/  269 batches | lr 0.00000 | ms/batch 77.90 | loss  2.95 | ppl    19.16 
| epoch  86 |   200/  269 batches | lr 0.00000 | ms/batch 76.28 | loss  2.94 | ppl    18.85 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 21.03s | valid loss  3.77 | valid ppl    43.43 | valid bpc    5.441
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  269 batches | lr 0.00000 | ms/batch 77.79 | loss  2.97 | ppl    19.42 
| epoch  87 |   200/  269 batches | lr 0.00000 | ms/batch 76.27 | loss  2.92 | ppl    18.61 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 21.03s | valid loss  3.76 | valid ppl    42.79 | valid bpc    5.419
-----------------------------------------------------------------------------------------
PROGRESS: 87.0%
| epoch  88 |   100/  269 batches | lr 0.00000 | ms/batch 78.14 | loss  2.97 | ppl    19.48 
| epoch  88 |   200/  269 batches | lr 0.00000 | ms/batch 76.25 | loss  2.91 | ppl    18.31 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 21.04s | valid loss  3.76 | valid ppl    42.90 | valid bpc    5.423
-----------------------------------------------------------------------------------------
PROGRESS: 88.0%
| epoch  89 |   100/  269 batches | lr 0.00000 | ms/batch 77.09 | loss  2.96 | ppl    19.34 
| epoch  89 |   200/  269 batches | lr 0.00000 | ms/batch 76.41 | loss  2.95 | ppl    19.16 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 21.02s | valid loss  3.78 | valid ppl    43.90 | valid bpc    5.456
-----------------------------------------------------------------------------------------
PROGRESS: 89.0%
| epoch  90 |   100/  269 batches | lr 0.00000 | ms/batch 77.48 | loss  2.97 | ppl    19.52 
| epoch  90 |   200/  269 batches | lr 0.00000 | ms/batch 75.84 | loss  2.94 | ppl    18.84 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 21.03s | valid loss  3.77 | valid ppl    43.31 | valid bpc    5.437
-----------------------------------------------------------------------------------------
PROGRESS: 90.0%
| epoch  91 |   100/  269 batches | lr 0.00000 | ms/batch 77.40 | loss  2.94 | ppl    18.98 
| epoch  91 |   200/  269 batches | lr 0.00000 | ms/batch 76.59 | loss  2.93 | ppl    18.78 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 21.10s | valid loss  3.75 | valid ppl    42.40 | valid bpc    5.406
-----------------------------------------------------------------------------------------
PROGRESS: 91.0%
| epoch  92 |   100/  269 batches | lr 0.00000 | ms/batch 77.69 | loss  2.98 | ppl    19.78 
| epoch  92 |   200/  269 batches | lr 0.00000 | ms/batch 76.54 | loss  2.92 | ppl    18.56 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 21.04s | valid loss  3.75 | valid ppl    42.55 | valid bpc    5.411
-----------------------------------------------------------------------------------------
PROGRESS: 92.0%
| epoch  93 |   100/  269 batches | lr 0.00000 | ms/batch 77.45 | loss  2.94 | ppl    18.91 
| epoch  93 |   200/  269 batches | lr 0.00000 | ms/batch 76.24 | loss  2.94 | ppl    18.95 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 21.02s | valid loss  3.77 | valid ppl    43.20 | valid bpc    5.433
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  269 batches | lr 0.00000 | ms/batch 77.72 | loss  2.95 | ppl    19.03 
| epoch  94 |   200/  269 batches | lr 0.00000 | ms/batch 76.36 | loss  2.93 | ppl    18.81 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 21.03s | valid loss  3.79 | valid ppl    44.16 | valid bpc    5.465
-----------------------------------------------------------------------------------------
PROGRESS: 94.0%
| epoch  95 |   100/  269 batches | lr 0.00000 | ms/batch 77.47 | loss  2.94 | ppl    18.87 
| epoch  95 |   200/  269 batches | lr 0.00000 | ms/batch 76.51 | loss  2.91 | ppl    18.44 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 21.03s | valid loss  3.78 | valid ppl    43.73 | valid bpc    5.451
-----------------------------------------------------------------------------------------
PROGRESS: 95.0%
| epoch  96 |   100/  269 batches | lr 0.00000 | ms/batch 77.82 | loss  2.97 | ppl    19.43 
| epoch  96 |   200/  269 batches | lr 0.00000 | ms/batch 76.13 | loss  2.92 | ppl    18.49 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 21.04s | valid loss  3.76 | valid ppl    42.91 | valid bpc    5.423
-----------------------------------------------------------------------------------------
PROGRESS: 96.0%
| epoch  97 |   100/  269 batches | lr 0.00000 | ms/batch 77.27 | loss  2.96 | ppl    19.37 
| epoch  97 |   200/  269 batches | lr 0.00000 | ms/batch 76.59 | loss  2.95 | ppl    19.07 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 21.04s | valid loss  3.73 | valid ppl    41.70 | valid bpc    5.382
-----------------------------------------------------------------------------------------
PROGRESS: 97.0%
| epoch  98 |   100/  269 batches | lr 0.00000 | ms/batch 77.79 | loss  2.95 | ppl    19.06 
| epoch  98 |   200/  269 batches | lr 0.00000 | ms/batch 76.02 | loss  2.93 | ppl    18.66 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 21.01s | valid loss  3.78 | valid ppl    43.72 | valid bpc    5.450
-----------------------------------------------------------------------------------------
PROGRESS: 98.0%
| epoch  99 |   100/  269 batches | lr 0.00000 | ms/batch 77.29 | loss  2.97 | ppl    19.55 
| epoch  99 |   200/  269 batches | lr 0.00000 | ms/batch 76.45 | loss  2.93 | ppl    18.74 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 21.02s | valid loss  3.81 | valid ppl    45.11 | valid bpc    5.495
-----------------------------------------------------------------------------------------
PROGRESS: 99.0%
| epoch 100 |   100/  269 batches | lr 0.00000 | ms/batch 78.07 | loss  2.96 | ppl    19.24 
| epoch 100 |   200/  269 batches | lr 0.00000 | ms/batch 76.29 | loss  2.93 | ppl    18.66 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 21.06s | valid loss  3.83 | valid ppl    46.00 | valid bpc    5.523
-----------------------------------------------------------------------------------------
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  3.84 | test ppl    46.49 | test bpc    5.539
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.4441, Mean Reca: 0.6232, Mean F1: 0.5148, Mean Subword_Reca: 0.8253
-----------------------------------------------------------------------------------------
=========================================================================================
Loading dataset...
Using subword tokenizer...
Number of tokens:  8000
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer', nhid=512, nlayers=8, front_layers=2, rear_layers=6, subword='omarmomen/ptb_filtered_lowcase_bpe_tokenizer_8', n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=2222, nonmono=5, cuda=True, log_interval=100, save='trained_models/subword_2222.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 37448132
Model architecture: StructFormer(
  (drop): Dropout(p=0.1, inplace=False)
  (emb): Embedding(8000, 512)
  (pos_emb): Embedding(500, 512)
  (layers): ModuleList(
    (0-7): 8 x TransformerLayer(
      (self_attn): MultiheadAttention(
        (drop): Dropout(p=0, inplace=False)
        (q_proj): Linear(in_features=512, out_features=512, bias=True)
        (k_proj): Linear(in_features=512, out_features=512, bias=True)
        (v_proj): Linear(in_features=512, out_features=512, bias=True)
        (out_proj): Linear(in_features=512, out_features=512, bias=True)
      )
      (feedforward): Sequential(
        (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (1): Linear(in_features=512, out_features=2048, bias=True)
        (2): LeakyReLU(negative_slope=0.01)
        (3): Dropout(p=0.1, inplace=False)
        (4): Linear(in_features=2048, out_features=512, bias=True)
      )
      (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      (dropout1): Dropout(p=0.1, inplace=False)
      (dropout2): Dropout(p=0.1, inplace=False)
    )
  )
  (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  (output_layer): Linear(in_features=512, out_features=8000, bias=True)
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  269 batches | lr 0.00030 | ms/batch 81.57 | loss  7.72 | ppl  2261.13 
| epoch   1 |   200/  269 batches | lr 0.00030 | ms/batch 74.81 | loss  7.24 | ppl  1392.82 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 21.28s | valid loss  6.83 | valid ppl   927.17 | valid bpc    9.857
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  269 batches | lr 0.00030 | ms/batch 77.00 | loss  7.00 | ppl  1100.15 
| epoch   2 |   200/  269 batches | lr 0.00030 | ms/batch 75.50 | loss  6.68 | ppl   795.53 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 20.85s | valid loss  6.26 | valid ppl   521.82 | valid bpc    9.027
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  269 batches | lr 0.00030 | ms/batch 77.28 | loss  6.40 | ppl   598.89 
| epoch   3 |   200/  269 batches | lr 0.00030 | ms/batch 75.90 | loss  6.15 | ppl   470.08 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 20.92s | valid loss  5.76 | valid ppl   316.62 | valid bpc    8.307
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  269 batches | lr 0.00030 | ms/batch 77.58 | loss  5.93 | ppl   374.34 
| epoch   4 |   200/  269 batches | lr 0.00030 | ms/batch 76.07 | loss  5.77 | ppl   321.93 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 21.00s | valid loss  5.48 | valid ppl   240.23 | valid bpc    7.908
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  269 batches | lr 0.00030 | ms/batch 77.57 | loss  5.65 | ppl   284.85 
| epoch   5 |   200/  269 batches | lr 0.00030 | ms/batch 75.82 | loss  5.49 | ppl   243.33 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 21.00s | valid loss  5.29 | valid ppl   198.22 | valid bpc    7.631
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  269 batches | lr 0.00030 | ms/batch 77.58 | loss  5.40 | ppl   221.68 
| epoch   6 |   200/  269 batches | lr 0.00030 | ms/batch 76.29 | loss  5.33 | ppl   206.18 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 21.03s | valid loss  5.16 | valid ppl   174.71 | valid bpc    7.449
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  269 batches | lr 0.00030 | ms/batch 77.85 | loss  5.26 | ppl   191.90 
| epoch   7 |   200/  269 batches | lr 0.00030 | ms/batch 76.13 | loss  5.17 | ppl   176.41 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 21.04s | valid loss  4.97 | valid ppl   144.31 | valid bpc    7.173
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  269 batches | lr 0.00030 | ms/batch 77.55 | loss  5.13 | ppl   168.88 
| epoch   8 |   200/  269 batches | lr 0.00030 | ms/batch 76.45 | loss  5.01 | ppl   150.03 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 21.04s | valid loss  4.87 | valid ppl   129.95 | valid bpc    7.022
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 8.0%
| epoch   9 |   100/  269 batches | lr 0.00030 | ms/batch 78.03 | loss  4.97 | ppl   144.57 
| epoch   9 |   200/  269 batches | lr 0.00030 | ms/batch 76.20 | loss  4.89 | ppl   133.18 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 21.04s | valid loss  4.76 | valid ppl   116.51 | valid bpc    6.864
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  269 batches | lr 0.00030 | ms/batch 77.43 | loss  4.84 | ppl   126.41 
| epoch  10 |   200/  269 batches | lr 0.00030 | ms/batch 76.47 | loss  4.74 | ppl   114.96 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 21.04s | valid loss  4.69 | valid ppl   108.76 | valid bpc    6.765
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  269 batches | lr 0.00030 | ms/batch 78.34 | loss  4.74 | ppl   114.31 
| epoch  11 |   200/  269 batches | lr 0.00030 | ms/batch 76.00 | loss  4.63 | ppl   102.70 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 21.05s | valid loss  4.52 | valid ppl    92.28 | valid bpc    6.528
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  269 batches | lr 0.00030 | ms/batch 77.91 | loss  4.62 | ppl   101.50 
| epoch  12 |   200/  269 batches | lr 0.00030 | ms/batch 76.08 | loss  4.56 | ppl    95.64 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 21.05s | valid loss  4.49 | valid ppl    89.23 | valid bpc    6.480
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 12.0%
| epoch  13 |   100/  269 batches | lr 0.00030 | ms/batch 77.39 | loss  4.48 | ppl    87.84 
| epoch  13 |   200/  269 batches | lr 0.00030 | ms/batch 76.86 | loss  4.50 | ppl    89.87 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 21.04s | valid loss  4.42 | valid ppl    82.81 | valid bpc    6.372
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 13.0%
| epoch  14 |   100/  269 batches | lr 0.00030 | ms/batch 77.41 | loss  4.42 | ppl    83.42 
| epoch  14 |   200/  269 batches | lr 0.00030 | ms/batch 76.31 | loss  4.39 | ppl    80.34 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 21.05s | valid loss  4.38 | valid ppl    80.15 | valid bpc    6.325
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  269 batches | lr 0.00030 | ms/batch 77.83 | loss  4.34 | ppl    77.00 
| epoch  15 |   200/  269 batches | lr 0.00030 | ms/batch 76.51 | loss  4.30 | ppl    73.81 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 21.05s | valid loss  4.24 | valid ppl    69.17 | valid bpc    6.112
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 15.0%
| epoch  16 |   100/  269 batches | lr 0.00030 | ms/batch 77.46 | loss  4.27 | ppl    71.36 
| epoch  16 |   200/  269 batches | lr 0.00030 | ms/batch 76.55 | loss  4.24 | ppl    69.54 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 21.04s | valid loss  4.29 | valid ppl    72.68 | valid bpc    6.183
-----------------------------------------------------------------------------------------
PROGRESS: 16.0%
| epoch  17 |   100/  269 batches | lr 0.00030 | ms/batch 77.84 | loss  4.25 | ppl    70.21 
| epoch  17 |   200/  269 batches | lr 0.00030 | ms/batch 76.21 | loss  4.18 | ppl    65.57 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 21.05s | valid loss  4.27 | valid ppl    71.83 | valid bpc    6.167
-----------------------------------------------------------------------------------------
PROGRESS: 17.0%
| epoch  18 |   100/  269 batches | lr 0.00030 | ms/batch 77.93 | loss  4.14 | ppl    62.87 
| epoch  18 |   200/  269 batches | lr 0.00030 | ms/batch 76.06 | loss  4.13 | ppl    61.93 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 21.02s | valid loss  4.17 | valid ppl    64.92 | valid bpc    6.021
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 18.0%
| epoch  19 |   100/  269 batches | lr 0.00030 | ms/batch 77.45 | loss  4.08 | ppl    59.31 
| epoch  19 |   200/  269 batches | lr 0.00030 | ms/batch 76.18 | loss  4.06 | ppl    58.07 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 21.05s | valid loss  4.14 | valid ppl    62.98 | valid bpc    5.977
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 19.0%
| epoch  20 |   100/  269 batches | lr 0.00030 | ms/batch 77.90 | loss  4.04 | ppl    56.92 
| epoch  20 |   200/  269 batches | lr 0.00030 | ms/batch 76.33 | loss  3.98 | ppl    53.40 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 21.04s | valid loss  4.16 | valid ppl    64.18 | valid bpc    6.004
-----------------------------------------------------------------------------------------
PROGRESS: 20.0%
| epoch  21 |   100/  269 batches | lr 0.00030 | ms/batch 77.85 | loss  3.98 | ppl    53.70 
| epoch  21 |   200/  269 batches | lr 0.00030 | ms/batch 76.41 | loss  3.96 | ppl    52.67 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 21.05s | valid loss  4.03 | valid ppl    56.46 | valid bpc    5.819
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 21.0%
| epoch  22 |   100/  269 batches | lr 0.00030 | ms/batch 77.58 | loss  3.93 | ppl    50.72 
| epoch  22 |   200/  269 batches | lr 0.00030 | ms/batch 76.81 | loss  3.91 | ppl    49.86 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 21.04s | valid loss  4.07 | valid ppl    58.78 | valid bpc    5.877
-----------------------------------------------------------------------------------------
PROGRESS: 22.0%
| epoch  23 |   100/  269 batches | lr 0.00030 | ms/batch 78.07 | loss  3.88 | ppl    48.46 
| epoch  23 |   200/  269 batches | lr 0.00030 | ms/batch 76.16 | loss  3.86 | ppl    47.67 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 21.05s | valid loss  4.02 | valid ppl    55.94 | valid bpc    5.806
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 23.0%
| epoch  24 |   100/  269 batches | lr 0.00030 | ms/batch 77.79 | loss  3.83 | ppl    46.15 
| epoch  24 |   200/  269 batches | lr 0.00030 | ms/batch 76.54 | loss  3.83 | ppl    46.16 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 21.04s | valid loss  4.02 | valid ppl    55.73 | valid bpc    5.800
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 24.0%
| epoch  25 |   100/  269 batches | lr 0.00030 | ms/batch 78.08 | loss  3.79 | ppl    44.47 
| epoch  25 |   200/  269 batches | lr 0.00030 | ms/batch 76.19 | loss  3.78 | ppl    43.96 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 21.04s | valid loss  3.99 | valid ppl    54.32 | valid bpc    5.763
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 25.0%
| epoch  26 |   100/  269 batches | lr 0.00030 | ms/batch 77.98 | loss  3.75 | ppl    42.42 
| epoch  26 |   200/  269 batches | lr 0.00030 | ms/batch 76.15 | loss  3.75 | ppl    42.50 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 21.05s | valid loss  3.99 | valid ppl    54.32 | valid bpc    5.763
-----------------------------------------------------------------------------------------
PROGRESS: 26.0%
| epoch  27 |   100/  269 batches | lr 0.00030 | ms/batch 77.51 | loss  3.74 | ppl    41.97 
| epoch  27 |   200/  269 batches | lr 0.00030 | ms/batch 76.17 | loss  3.70 | ppl    40.61 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 21.04s | valid loss  3.96 | valid ppl    52.40 | valid bpc    5.712
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 27.0%
| epoch  28 |   100/  269 batches | lr 0.00030 | ms/batch 77.43 | loss  3.68 | ppl    39.62 
| epoch  28 |   200/  269 batches | lr 0.00030 | ms/batch 76.59 | loss  3.69 | ppl    40.09 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 21.04s | valid loss  3.94 | valid ppl    51.49 | valid bpc    5.686
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  269 batches | lr 0.00030 | ms/batch 77.92 | loss  3.66 | ppl    38.75 
| epoch  29 |   200/  269 batches | lr 0.00030 | ms/batch 76.38 | loss  3.59 | ppl    36.35 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 21.03s | valid loss  3.92 | valid ppl    50.21 | valid bpc    5.650
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  269 batches | lr 0.00030 | ms/batch 77.41 | loss  3.59 | ppl    36.38 
| epoch  30 |   200/  269 batches | lr 0.00030 | ms/batch 76.61 | loss  3.61 | ppl    36.86 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 21.04s | valid loss  3.98 | valid ppl    53.29 | valid bpc    5.736
-----------------------------------------------------------------------------------------
PROGRESS: 30.0%
| epoch  31 |   100/  269 batches | lr 0.00030 | ms/batch 77.99 | loss  3.58 | ppl    35.74 
| epoch  31 |   200/  269 batches | lr 0.00030 | ms/batch 76.07 | loss  3.58 | ppl    35.88 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 21.04s | valid loss  3.95 | valid ppl    51.77 | valid bpc    5.694
-----------------------------------------------------------------------------------------
PROGRESS: 31.0%
| epoch  32 |   100/  269 batches | lr 0.00030 | ms/batch 77.27 | loss  3.53 | ppl    34.07 
| epoch  32 |   200/  269 batches | lr 0.00030 | ms/batch 76.45 | loss  3.55 | ppl    34.68 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 21.04s | valid loss  3.87 | valid ppl    48.02 | valid bpc    5.586
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 32.0%
| epoch  33 |   100/  269 batches | lr 0.00030 | ms/batch 77.66 | loss  3.52 | ppl    33.88 
| epoch  33 |   200/  269 batches | lr 0.00030 | ms/batch 76.59 | loss  3.52 | ppl    33.72 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 21.04s | valid loss  3.94 | valid ppl    51.57 | valid bpc    5.688
-----------------------------------------------------------------------------------------
PROGRESS: 33.0%
| epoch  34 |   100/  269 batches | lr 0.00030 | ms/batch 77.74 | loss  3.49 | ppl    32.72 
| epoch  34 |   200/  269 batches | lr 0.00030 | ms/batch 76.05 | loss  3.49 | ppl    32.87 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 21.01s | valid loss  3.88 | valid ppl    48.37 | valid bpc    5.596
-----------------------------------------------------------------------------------------
PROGRESS: 34.0%
| epoch  35 |   100/  269 batches | lr 0.00030 | ms/batch 77.99 | loss  3.46 | ppl    31.75 
| epoch  35 |   200/  269 batches | lr 0.00030 | ms/batch 76.07 | loss  3.43 | ppl    31.00 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 21.05s | valid loss  3.85 | valid ppl    46.88 | valid bpc    5.551
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 35.0%
| epoch  36 |   100/  269 batches | lr 0.00030 | ms/batch 77.69 | loss  3.45 | ppl    31.46 
| epoch  36 |   200/  269 batches | lr 0.00030 | ms/batch 76.18 | loss  3.40 | ppl    29.98 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 21.05s | valid loss  3.91 | valid ppl    50.02 | valid bpc    5.645
-----------------------------------------------------------------------------------------
PROGRESS: 36.0%
| epoch  37 |   100/  269 batches | lr 0.00030 | ms/batch 77.58 | loss  3.37 | ppl    29.02 
| epoch  37 |   200/  269 batches | lr 0.00030 | ms/batch 76.57 | loss  3.40 | ppl    29.88 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 21.05s | valid loss  3.86 | valid ppl    47.66 | valid bpc    5.575
-----------------------------------------------------------------------------------------
PROGRESS: 37.0%
| epoch  38 |   100/  269 batches | lr 0.00030 | ms/batch 77.37 | loss  3.39 | ppl    29.54 
| epoch  38 |   200/  269 batches | lr 0.00030 | ms/batch 76.50 | loss  3.36 | ppl    28.83 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 21.07s | valid loss  3.85 | valid ppl    46.99 | valid bpc    5.554
-----------------------------------------------------------------------------------------
PROGRESS: 38.0%
| epoch  39 |   100/  269 batches | lr 0.00015 | ms/batch 77.29 | loss  3.29 | ppl    26.84 
| epoch  39 |   200/  269 batches | lr 0.00015 | ms/batch 76.38 | loss  3.26 | ppl    25.94 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 21.03s | valid loss  3.75 | valid ppl    42.68 | valid bpc    5.416
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 39.0%
| epoch  40 |   100/  269 batches | lr 0.00015 | ms/batch 78.08 | loss  3.22 | ppl    25.09 
| epoch  40 |   200/  269 batches | lr 0.00015 | ms/batch 76.35 | loss  3.20 | ppl    24.42 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 21.06s | valid loss  3.81 | valid ppl    45.20 | valid bpc    5.498
-----------------------------------------------------------------------------------------
PROGRESS: 40.0%
| epoch  41 |   100/  269 batches | lr 0.00015 | ms/batch 77.79 | loss  3.20 | ppl    24.50 
| epoch  41 |   200/  269 batches | lr 0.00015 | ms/batch 76.30 | loss  3.16 | ppl    23.61 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 21.06s | valid loss  3.84 | valid ppl    46.35 | valid bpc    5.534
-----------------------------------------------------------------------------------------
PROGRESS: 41.0%
| epoch  42 |   100/  269 batches | lr 0.00015 | ms/batch 77.82 | loss  3.18 | ppl    24.00 
| epoch  42 |   200/  269 batches | lr 0.00015 | ms/batch 76.37 | loss  3.15 | ppl    23.24 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 21.07s | valid loss  3.79 | valid ppl    44.23 | valid bpc    5.467
-----------------------------------------------------------------------------------------
PROGRESS: 42.0%
| epoch  43 |   100/  269 batches | lr 0.00007 | ms/batch 77.76 | loss  3.12 | ppl    22.64 
| epoch  43 |   200/  269 batches | lr 0.00007 | ms/batch 76.78 | loss  3.06 | ppl    21.30 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 21.08s | valid loss  3.77 | valid ppl    43.22 | valid bpc    5.434
-----------------------------------------------------------------------------------------
PROGRESS: 43.0%
| epoch  44 |   100/  269 batches | lr 0.00007 | ms/batch 77.68 | loss  3.07 | ppl    21.56 
| epoch  44 |   200/  269 batches | lr 0.00007 | ms/batch 76.58 | loss  3.05 | ppl    21.14 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 21.07s | valid loss  3.76 | valid ppl    42.96 | valid bpc    5.425
-----------------------------------------------------------------------------------------
PROGRESS: 44.0%
| epoch  45 |   100/  269 batches | lr 0.00007 | ms/batch 78.07 | loss  3.06 | ppl    21.31 
| epoch  45 |   200/  269 batches | lr 0.00007 | ms/batch 76.54 | loss  3.03 | ppl    20.73 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 21.11s | valid loss  3.74 | valid ppl    42.16 | valid bpc    5.398
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 45.0%
| epoch  46 |   100/  269 batches | lr 0.00007 | ms/batch 78.32 | loss  3.06 | ppl    21.27 
| epoch  46 |   200/  269 batches | lr 0.00007 | ms/batch 76.55 | loss  3.03 | ppl    20.76 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 21.10s | valid loss  3.75 | valid ppl    42.53 | valid bpc    5.410
-----------------------------------------------------------------------------------------
PROGRESS: 46.0%
| epoch  47 |   100/  269 batches | lr 0.00007 | ms/batch 77.73 | loss  3.02 | ppl    20.56 
| epoch  47 |   200/  269 batches | lr 0.00007 | ms/batch 76.45 | loss  3.01 | ppl    20.29 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 21.08s | valid loss  3.76 | valid ppl    42.93 | valid bpc    5.424
-----------------------------------------------------------------------------------------
PROGRESS: 47.0%
| epoch  48 |   100/  269 batches | lr 0.00007 | ms/batch 77.86 | loss  3.01 | ppl    20.27 
| epoch  48 |   200/  269 batches | lr 0.00007 | ms/batch 76.51 | loss  2.99 | ppl    19.95 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 21.08s | valid loss  3.75 | valid ppl    42.44 | valid bpc    5.407
-----------------------------------------------------------------------------------------
PROGRESS: 48.0%
| epoch  49 |   100/  269 batches | lr 0.00004 | ms/batch 77.69 | loss  2.99 | ppl    19.91 
| epoch  49 |   200/  269 batches | lr 0.00004 | ms/batch 76.62 | loss  2.95 | ppl    19.11 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 21.06s | valid loss  3.76 | valid ppl    42.97 | valid bpc    5.425
-----------------------------------------------------------------------------------------
PROGRESS: 49.0%
| epoch  50 |   100/  269 batches | lr 0.00004 | ms/batch 78.27 | loss  2.98 | ppl    19.64 
| epoch  50 |   200/  269 batches | lr 0.00004 | ms/batch 76.11 | loss  2.95 | ppl    19.05 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 21.12s | valid loss  3.72 | valid ppl    41.41 | valid bpc    5.372
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 50.0%
| epoch  51 |   100/  269 batches | lr 0.00004 | ms/batch 77.51 | loss  2.96 | ppl    19.25 
| epoch  51 |   200/  269 batches | lr 0.00004 | ms/batch 76.43 | loss  2.94 | ppl    18.91 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 21.05s | valid loss  3.70 | valid ppl    40.64 | valid bpc    5.345
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 51.0%
| epoch  52 |   100/  269 batches | lr 0.00004 | ms/batch 77.40 | loss  2.95 | ppl    19.12 
| epoch  52 |   200/  269 batches | lr 0.00004 | ms/batch 76.55 | loss  2.92 | ppl    18.60 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 21.05s | valid loss  3.73 | valid ppl    41.62 | valid bpc    5.379
-----------------------------------------------------------------------------------------
PROGRESS: 52.0%
| epoch  53 |   100/  269 batches | lr 0.00004 | ms/batch 78.08 | loss  2.94 | ppl    18.86 
| epoch  53 |   200/  269 batches | lr 0.00004 | ms/batch 76.20 | loss  2.91 | ppl    18.36 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 21.07s | valid loss  3.70 | valid ppl    40.40 | valid bpc    5.336
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 53.0%
| epoch  54 |   100/  269 batches | lr 0.00004 | ms/batch 77.76 | loss  2.96 | ppl    19.23 
| epoch  54 |   200/  269 batches | lr 0.00004 | ms/batch 76.20 | loss  2.92 | ppl    18.59 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 21.05s | valid loss  3.71 | valid ppl    41.02 | valid bpc    5.358
-----------------------------------------------------------------------------------------
PROGRESS: 54.0%
| epoch  55 |   100/  269 batches | lr 0.00004 | ms/batch 78.04 | loss  2.94 | ppl    18.85 
| epoch  55 |   200/  269 batches | lr 0.00004 | ms/batch 76.28 | loss  2.91 | ppl    18.34 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 21.06s | valid loss  3.72 | valid ppl    41.34 | valid bpc    5.369
-----------------------------------------------------------------------------------------
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  269 batches | lr 0.00004 | ms/batch 77.63 | loss  2.93 | ppl    18.72 
| epoch  56 |   200/  269 batches | lr 0.00004 | ms/batch 76.61 | loss  2.89 | ppl    17.98 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 21.07s | valid loss  3.70 | valid ppl    40.31 | valid bpc    5.333
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  269 batches | lr 0.00004 | ms/batch 77.66 | loss  2.89 | ppl    17.91 
| epoch  57 |   200/  269 batches | lr 0.00004 | ms/batch 76.51 | loss  2.92 | ppl    18.47 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 21.06s | valid loss  3.76 | valid ppl    42.78 | valid bpc    5.419
-----------------------------------------------------------------------------------------
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  269 batches | lr 0.00004 | ms/batch 78.31 | loss  2.90 | ppl    18.24 
| epoch  58 |   200/  269 batches | lr 0.00004 | ms/batch 76.34 | loss  2.85 | ppl    17.30 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 21.06s | valid loss  3.71 | valid ppl    40.74 | valid bpc    5.349
-----------------------------------------------------------------------------------------
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  269 batches | lr 0.00004 | ms/batch 77.62 | loss  2.91 | ppl    18.44 
| epoch  59 |   200/  269 batches | lr 0.00004 | ms/batch 76.26 | loss  2.87 | ppl    17.68 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 21.05s | valid loss  3.72 | valid ppl    41.44 | valid bpc    5.373
-----------------------------------------------------------------------------------------
PROGRESS: 59.0%
| epoch  60 |   100/  269 batches | lr 0.00002 | ms/batch 78.33 | loss  2.90 | ppl    18.11 
| epoch  60 |   200/  269 batches | lr 0.00002 | ms/batch 76.01 | loss  2.86 | ppl    17.47 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 21.06s | valid loss  3.78 | valid ppl    43.72 | valid bpc    5.450
-----------------------------------------------------------------------------------------
PROGRESS: 60.0%
| epoch  61 |   100/  269 batches | lr 0.00002 | ms/batch 77.77 | loss  2.87 | ppl    17.70 
| epoch  61 |   200/  269 batches | lr 0.00002 | ms/batch 76.35 | loss  2.85 | ppl    17.36 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 21.07s | valid loss  3.74 | valid ppl    41.95 | valid bpc    5.391
-----------------------------------------------------------------------------------------
PROGRESS: 61.0%
| epoch  62 |   100/  269 batches | lr 0.00002 | ms/batch 77.89 | loss  2.88 | ppl    17.78 
| epoch  62 |   200/  269 batches | lr 0.00002 | ms/batch 76.48 | loss  2.85 | ppl    17.21 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 21.07s | valid loss  3.78 | valid ppl    43.87 | valid bpc    5.455
-----------------------------------------------------------------------------------------
PROGRESS: 62.0%
| epoch  63 |   100/  269 batches | lr 0.00001 | ms/batch 77.84 | loss  2.87 | ppl    17.72 
| epoch  63 |   200/  269 batches | lr 0.00001 | ms/batch 76.20 | loss  2.85 | ppl    17.20 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 21.07s | valid loss  3.73 | valid ppl    41.86 | valid bpc    5.388
-----------------------------------------------------------------------------------------
PROGRESS: 63.0%
| epoch  64 |   100/  269 batches | lr 0.00001 | ms/batch 77.69 | loss  2.85 | ppl    17.30 
| epoch  64 |   200/  269 batches | lr 0.00001 | ms/batch 76.55 | loss  2.84 | ppl    17.07 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 21.05s | valid loss  3.75 | valid ppl    42.32 | valid bpc    5.403
-----------------------------------------------------------------------------------------
PROGRESS: 64.0%
| epoch  65 |   100/  269 batches | lr 0.00001 | ms/batch 77.41 | loss  2.85 | ppl    17.30 
| epoch  65 |   200/  269 batches | lr 0.00001 | ms/batch 76.64 | loss  2.85 | ppl    17.30 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 21.03s | valid loss  3.74 | valid ppl    42.02 | valid bpc    5.393
-----------------------------------------------------------------------------------------
PROGRESS: 65.0%
| epoch  66 |   100/  269 batches | lr 0.00000 | ms/batch 77.82 | loss  2.86 | ppl    17.50 
| epoch  66 |   200/  269 batches | lr 0.00000 | ms/batch 76.52 | loss  2.82 | ppl    16.74 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 21.13s | valid loss  3.77 | valid ppl    43.26 | valid bpc    5.435
-----------------------------------------------------------------------------------------
PROGRESS: 66.0%
| epoch  67 |   100/  269 batches | lr 0.00000 | ms/batch 77.71 | loss  2.86 | ppl    17.41 
| epoch  67 |   200/  269 batches | lr 0.00000 | ms/batch 76.23 | loss  2.84 | ppl    17.04 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 21.06s | valid loss  3.75 | valid ppl    42.40 | valid bpc    5.406
-----------------------------------------------------------------------------------------
PROGRESS: 67.0%
| epoch  68 |   100/  269 batches | lr 0.00000 | ms/batch 77.84 | loss  2.88 | ppl    17.82 
| epoch  68 |   200/  269 batches | lr 0.00000 | ms/batch 76.43 | loss  2.82 | ppl    16.76 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 21.06s | valid loss  3.72 | valid ppl    41.09 | valid bpc    5.361
-----------------------------------------------------------------------------------------
PROGRESS: 68.0%
| epoch  69 |   100/  269 batches | lr 0.00000 | ms/batch 77.86 | loss  2.85 | ppl    17.33 
| epoch  69 |   200/  269 batches | lr 0.00000 | ms/batch 76.23 | loss  2.84 | ppl    17.10 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 21.03s | valid loss  3.74 | valid ppl    41.99 | valid bpc    5.392
-----------------------------------------------------------------------------------------
PROGRESS: 69.0%
| epoch  70 |   100/  269 batches | lr 0.00000 | ms/batch 77.77 | loss  2.87 | ppl    17.56 
| epoch  70 |   200/  269 batches | lr 0.00000 | ms/batch 76.54 | loss  2.83 | ppl    16.92 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 21.13s | valid loss  3.69 | valid ppl    40.07 | valid bpc    5.324
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 70.0%
| epoch  71 |   100/  269 batches | lr 0.00000 | ms/batch 77.60 | loss  2.86 | ppl    17.52 
| epoch  71 |   200/  269 batches | lr 0.00000 | ms/batch 76.20 | loss  2.82 | ppl    16.80 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 21.05s | valid loss  3.72 | valid ppl    41.38 | valid bpc    5.371
-----------------------------------------------------------------------------------------
PROGRESS: 71.0%
| epoch  72 |   100/  269 batches | lr 0.00000 | ms/batch 77.79 | loss  2.84 | ppl    17.19 
| epoch  72 |   200/  269 batches | lr 0.00000 | ms/batch 76.27 | loss  2.83 | ppl    16.98 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 21.06s | valid loss  3.73 | valid ppl    41.81 | valid bpc    5.386
-----------------------------------------------------------------------------------------
PROGRESS: 72.0%
| epoch  73 |   100/  269 batches | lr 0.00000 | ms/batch 77.15 | loss  2.85 | ppl    17.29 
| epoch  73 |   200/  269 batches | lr 0.00000 | ms/batch 76.87 | loss  2.82 | ppl    16.70 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 21.07s | valid loss  3.71 | valid ppl    41.03 | valid bpc    5.358
-----------------------------------------------------------------------------------------
PROGRESS: 73.0%
| epoch  74 |   100/  269 batches | lr 0.00000 | ms/batch 77.56 | loss  2.87 | ppl    17.57 
| epoch  74 |   200/  269 batches | lr 0.00000 | ms/batch 76.64 | loss  2.84 | ppl    17.09 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 21.06s | valid loss  3.75 | valid ppl    42.36 | valid bpc    5.405
-----------------------------------------------------------------------------------------
PROGRESS: 74.0%
| epoch  75 |   100/  269 batches | lr 0.00000 | ms/batch 77.46 | loss  2.83 | ppl    16.93 
| epoch  75 |   200/  269 batches | lr 0.00000 | ms/batch 76.50 | loss  2.81 | ppl    16.67 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 21.02s | valid loss  3.72 | valid ppl    41.28 | valid bpc    5.367
-----------------------------------------------------------------------------------------
PROGRESS: 75.0%
| epoch  76 |   100/  269 batches | lr 0.00000 | ms/batch 77.90 | loss  2.85 | ppl    17.26 
| epoch  76 |   200/  269 batches | lr 0.00000 | ms/batch 76.50 | loss  2.80 | ppl    16.46 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 21.07s | valid loss  3.71 | valid ppl    40.68 | valid bpc    5.346
-----------------------------------------------------------------------------------------
PROGRESS: 76.0%
| epoch  77 |   100/  269 batches | lr 0.00000 | ms/batch 77.60 | loss  2.84 | ppl    17.20 
| epoch  77 |   200/  269 batches | lr 0.00000 | ms/batch 76.48 | loss  2.82 | ppl    16.81 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 21.06s | valid loss  3.70 | valid ppl    40.56 | valid bpc    5.342
-----------------------------------------------------------------------------------------
PROGRESS: 77.0%
| epoch  78 |   100/  269 batches | lr 0.00000 | ms/batch 78.42 | loss  2.85 | ppl    17.26 
| epoch  78 |   200/  269 batches | lr 0.00000 | ms/batch 76.08 | loss  2.82 | ppl    16.74 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 21.07s | valid loss  3.69 | valid ppl    40.17 | valid bpc    5.328
-----------------------------------------------------------------------------------------
PROGRESS: 78.0%
| epoch  79 |   100/  269 batches | lr 0.00000 | ms/batch 77.91 | loss  2.85 | ppl    17.30 
| epoch  79 |   200/  269 batches | lr 0.00000 | ms/batch 75.90 | loss  2.82 | ppl    16.74 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 21.06s | valid loss  3.72 | valid ppl    41.43 | valid bpc    5.373
-----------------------------------------------------------------------------------------
PROGRESS: 79.0%
| epoch  80 |   100/  269 batches | lr 0.00000 | ms/batch 77.52 | loss  2.84 | ppl    17.11 
| epoch  80 |   200/  269 batches | lr 0.00000 | ms/batch 76.40 | loss  2.81 | ppl    16.67 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 21.03s | valid loss  3.74 | valid ppl    42.18 | valid bpc    5.399
-----------------------------------------------------------------------------------------
PROGRESS: 80.0%
| epoch  81 |   100/  269 batches | lr 0.00000 | ms/batch 77.60 | loss  2.86 | ppl    17.52 
| epoch  81 |   200/  269 batches | lr 0.00000 | ms/batch 76.95 | loss  2.82 | ppl    16.84 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 21.06s | valid loss  3.67 | valid ppl    39.38 | valid bpc    5.300
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 81.0%
| epoch  82 |   100/  269 batches | lr 0.00000 | ms/batch 78.53 | loss  2.86 | ppl    17.49 
| epoch  82 |   200/  269 batches | lr 0.00000 | ms/batch 76.08 | loss  2.80 | ppl    16.37 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 21.07s | valid loss  3.71 | valid ppl    41.03 | valid bpc    5.359
-----------------------------------------------------------------------------------------
PROGRESS: 82.0%
| epoch  83 |   100/  269 batches | lr 0.00000 | ms/batch 77.58 | loss  2.84 | ppl    17.20 
| epoch  83 |   200/  269 batches | lr 0.00000 | ms/batch 76.69 | loss  2.83 | ppl    17.02 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 21.06s | valid loss  3.69 | valid ppl    40.17 | valid bpc    5.328
-----------------------------------------------------------------------------------------
PROGRESS: 83.0%
| epoch  84 |   100/  269 batches | lr 0.00000 | ms/batch 78.03 | loss  2.88 | ppl    17.88 
| epoch  84 |   200/  269 batches | lr 0.00000 | ms/batch 76.14 | loss  2.81 | ppl    16.68 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 21.07s | valid loss  3.75 | valid ppl    42.66 | valid bpc    5.415
-----------------------------------------------------------------------------------------
PROGRESS: 84.0%
| epoch  85 |   100/  269 batches | lr 0.00000 | ms/batch 77.99 | loss  2.85 | ppl    17.23 
| epoch  85 |   200/  269 batches | lr 0.00000 | ms/batch 76.13 | loss  2.83 | ppl    16.90 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 21.06s | valid loss  3.73 | valid ppl    41.48 | valid bpc    5.374
-----------------------------------------------------------------------------------------
PROGRESS: 85.0%
| epoch  86 |   100/  269 batches | lr 0.00000 | ms/batch 77.86 | loss  2.85 | ppl    17.25 
| epoch  86 |   200/  269 batches | lr 0.00000 | ms/batch 76.12 | loss  2.82 | ppl    16.70 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 21.04s | valid loss  3.72 | valid ppl    41.20 | valid bpc    5.364
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  269 batches | lr 0.00000 | ms/batch 77.67 | loss  2.85 | ppl    17.25 
| epoch  87 |   200/  269 batches | lr 0.00000 | ms/batch 76.27 | loss  2.80 | ppl    16.36 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 21.03s | valid loss  3.70 | valid ppl    40.61 | valid bpc    5.344
-----------------------------------------------------------------------------------------
PROGRESS: 87.0%
| epoch  88 |   100/  269 batches | lr 0.00000 | ms/batch 77.54 | loss  2.87 | ppl    17.56 
| epoch  88 |   200/  269 batches | lr 0.00000 | ms/batch 76.46 | loss  2.81 | ppl    16.64 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 21.03s | valid loss  3.73 | valid ppl    41.56 | valid bpc    5.377
-----------------------------------------------------------------------------------------
PROGRESS: 88.0%
| epoch  89 |   100/  269 batches | lr 0.00000 | ms/batch 78.08 | loss  2.85 | ppl    17.34 
| epoch  89 |   200/  269 batches | lr 0.00000 | ms/batch 76.43 | loss  2.81 | ppl    16.66 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 21.07s | valid loss  3.70 | valid ppl    40.57 | valid bpc    5.342
-----------------------------------------------------------------------------------------
PROGRESS: 89.0%
| epoch  90 |   100/  269 batches | lr 0.00000 | ms/batch 78.08 | loss  2.85 | ppl    17.28 
| epoch  90 |   200/  269 batches | lr 0.00000 | ms/batch 75.98 | loss  2.81 | ppl    16.62 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 21.03s | valid loss  3.72 | valid ppl    41.19 | valid bpc    5.364
-----------------------------------------------------------------------------------------
PROGRESS: 90.0%
| epoch  91 |   100/  269 batches | lr 0.00000 | ms/batch 77.96 | loss  2.85 | ppl    17.34 
| epoch  91 |   200/  269 batches | lr 0.00000 | ms/batch 76.64 | loss  2.83 | ppl    16.95 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 21.07s | valid loss  3.71 | valid ppl    40.75 | valid bpc    5.349
-----------------------------------------------------------------------------------------
PROGRESS: 91.0%
| epoch  92 |   100/  269 batches | lr 0.00000 | ms/batch 78.21 | loss  2.86 | ppl    17.41 
| epoch  92 |   200/  269 batches | lr 0.00000 | ms/batch 76.76 | loss  2.79 | ppl    16.22 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 21.13s | valid loss  3.73 | valid ppl    41.59 | valid bpc    5.378
-----------------------------------------------------------------------------------------
PROGRESS: 92.0%
| epoch  93 |   100/  269 batches | lr 0.00000 | ms/batch 77.82 | loss  2.84 | ppl    17.13 
| epoch  93 |   200/  269 batches | lr 0.00000 | ms/batch 76.21 | loss  2.81 | ppl    16.69 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 21.06s | valid loss  3.71 | valid ppl    40.86 | valid bpc    5.352
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  269 batches | lr 0.00000 | ms/batch 77.83 | loss  2.85 | ppl    17.32 
| epoch  94 |   200/  269 batches | lr 0.00000 | ms/batch 76.18 | loss  2.82 | ppl    16.72 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 21.08s | valid loss  3.80 | valid ppl    44.58 | valid bpc    5.478
-----------------------------------------------------------------------------------------
PROGRESS: 94.0%
| epoch  95 |   100/  269 batches | lr 0.00000 | ms/batch 78.10 | loss  2.85 | ppl    17.36 
| epoch  95 |   200/  269 batches | lr 0.00000 | ms/batch 76.21 | loss  2.82 | ppl    16.74 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 21.08s | valid loss  3.73 | valid ppl    41.61 | valid bpc    5.379
-----------------------------------------------------------------------------------------
PROGRESS: 95.0%
| epoch  96 |   100/  269 batches | lr 0.00000 | ms/batch 78.54 | loss  2.85 | ppl    17.36 
| epoch  96 |   200/  269 batches | lr 0.00000 | ms/batch 76.49 | loss  2.84 | ppl    17.04 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 21.13s | valid loss  3.71 | valid ppl    40.96 | valid bpc    5.356
-----------------------------------------------------------------------------------------
PROGRESS: 96.0%
| epoch  97 |   100/  269 batches | lr 0.00000 | ms/batch 77.70 | loss  2.85 | ppl    17.25 
| epoch  97 |   200/  269 batches | lr 0.00000 | ms/batch 76.37 | loss  2.81 | ppl    16.55 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 21.05s | valid loss  3.74 | valid ppl    42.00 | valid bpc    5.392
-----------------------------------------------------------------------------------------
PROGRESS: 97.0%
| epoch  98 |   100/  269 batches | lr 0.00000 | ms/batch 77.52 | loss  2.86 | ppl    17.39 
| epoch  98 |   200/  269 batches | lr 0.00000 | ms/batch 76.27 | loss  2.81 | ppl    16.69 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 21.03s | valid loss  3.73 | valid ppl    41.75 | valid bpc    5.384
-----------------------------------------------------------------------------------------
PROGRESS: 98.0%
| epoch  99 |   100/  269 batches | lr 0.00000 | ms/batch 77.65 | loss  2.86 | ppl    17.46 
| epoch  99 |   200/  269 batches | lr 0.00000 | ms/batch 76.88 | loss  2.83 | ppl    16.89 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 21.07s | valid loss  3.74 | valid ppl    41.92 | valid bpc    5.390
-----------------------------------------------------------------------------------------
PROGRESS: 99.0%
| epoch 100 |   100/  269 batches | lr 0.00000 | ms/batch 77.90 | loss  2.87 | ppl    17.60 
| epoch 100 |   200/  269 batches | lr 0.00000 | ms/batch 76.38 | loss  2.81 | ppl    16.62 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 21.07s | valid loss  3.74 | valid ppl    41.97 | valid bpc    5.391
-----------------------------------------------------------------------------------------
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  3.86 | test ppl    47.55 | test bpc    5.571
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.4535, Mean Reca: 0.6396, Mean F1: 0.5264, Mean Subword_Reca: 0.9014
-----------------------------------------------------------------------------------------
=========================================================================================
Loading dataset...
Using subword tokenizer...
Number of tokens:  8000
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer', nhid=512, nlayers=8, front_layers=2, rear_layers=6, subword='omarmomen/ptb_filtered_lowcase_bpe_tokenizer_8', n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=3333, nonmono=5, cuda=True, log_interval=100, save='trained_models/subword_3333.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 37448132
Model architecture: StructFormer(
  (drop): Dropout(p=0.1, inplace=False)
  (emb): Embedding(8000, 512)
  (pos_emb): Embedding(500, 512)
  (layers): ModuleList(
    (0-7): 8 x TransformerLayer(
      (self_attn): MultiheadAttention(
        (drop): Dropout(p=0, inplace=False)
        (q_proj): Linear(in_features=512, out_features=512, bias=True)
        (k_proj): Linear(in_features=512, out_features=512, bias=True)
        (v_proj): Linear(in_features=512, out_features=512, bias=True)
        (out_proj): Linear(in_features=512, out_features=512, bias=True)
      )
      (feedforward): Sequential(
        (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (1): Linear(in_features=512, out_features=2048, bias=True)
        (2): LeakyReLU(negative_slope=0.01)
        (3): Dropout(p=0.1, inplace=False)
        (4): Linear(in_features=2048, out_features=512, bias=True)
      )
      (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      (dropout1): Dropout(p=0.1, inplace=False)
      (dropout2): Dropout(p=0.1, inplace=False)
    )
  )
  (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  (output_layer): Linear(in_features=512, out_features=8000, bias=True)
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  269 batches | lr 0.00030 | ms/batch 80.88 | loss  7.72 | ppl  2256.96 
| epoch   1 |   200/  269 batches | lr 0.00030 | ms/batch 75.98 | loss  7.37 | ppl  1587.66 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 21.24s | valid loss  7.06 | valid ppl  1169.04 | valid bpc   10.191
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  269 batches | lr 0.00030 | ms/batch 76.80 | loss  7.16 | ppl  1287.55 
| epoch   2 |   200/  269 batches | lr 0.00030 | ms/batch 75.80 | loss  6.97 | ppl  1061.82 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 20.86s | valid loss  6.66 | valid ppl   776.72 | valid bpc    9.601
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  269 batches | lr 0.00030 | ms/batch 77.64 | loss  6.83 | ppl   925.55 
| epoch   3 |   200/  269 batches | lr 0.00030 | ms/batch 75.38 | loss  6.63 | ppl   756.92 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 20.93s | valid loss  6.27 | valid ppl   528.74 | valid bpc    9.046
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  269 batches | lr 0.00030 | ms/batch 77.55 | loss  6.44 | ppl   629.41 
| epoch   4 |   200/  269 batches | lr 0.00030 | ms/batch 76.23 | loss  6.17 | ppl   477.52 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 20.99s | valid loss  5.81 | valid ppl   334.63 | valid bpc    8.386
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  269 batches | lr 0.00030 | ms/batch 77.51 | loss  5.99 | ppl   398.54 
| epoch   5 |   200/  269 batches | lr 0.00030 | ms/batch 76.38 | loss  5.83 | ppl   339.59 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 21.03s | valid loss  5.56 | valid ppl   259.47 | valid bpc    8.019
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  269 batches | lr 0.00030 | ms/batch 77.58 | loss  5.69 | ppl   294.76 
| epoch   6 |   200/  269 batches | lr 0.00030 | ms/batch 76.32 | loss  5.59 | ppl   268.30 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 21.03s | valid loss  5.36 | valid ppl   213.64 | valid bpc    7.739
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  269 batches | lr 0.00030 | ms/batch 77.57 | loss  5.50 | ppl   245.65 
| epoch   7 |   200/  269 batches | lr 0.00030 | ms/batch 76.44 | loss  5.40 | ppl   221.92 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 21.05s | valid loss  5.18 | valid ppl   177.22 | valid bpc    7.469
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  269 batches | lr 0.00030 | ms/batch 77.74 | loss  5.30 | ppl   200.59 
| epoch   8 |   200/  269 batches | lr 0.00030 | ms/batch 76.60 | loss  5.25 | ppl   190.55 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 21.05s | valid loss  5.04 | valid ppl   154.49 | valid bpc    7.271
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 8.0%
| epoch   9 |   100/  269 batches | lr 0.00030 | ms/batch 77.61 | loss  5.18 | ppl   176.89 
| epoch   9 |   200/  269 batches | lr 0.00030 | ms/batch 76.32 | loss  5.08 | ppl   160.87 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 21.06s | valid loss  4.90 | valid ppl   134.47 | valid bpc    7.071
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  269 batches | lr 0.00030 | ms/batch 77.57 | loss  5.05 | ppl   156.14 
| epoch  10 |   200/  269 batches | lr 0.00030 | ms/batch 76.42 | loss  4.96 | ppl   142.55 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 21.06s | valid loss  4.79 | valid ppl   120.67 | valid bpc    6.915
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  269 batches | lr 0.00030 | ms/batch 77.47 | loss  4.90 | ppl   133.65 
| epoch  11 |   200/  269 batches | lr 0.00030 | ms/batch 76.21 | loss  4.85 | ppl   128.33 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 21.07s | valid loss  4.70 | valid ppl   109.81 | valid bpc    6.779
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  269 batches | lr 0.00030 | ms/batch 77.91 | loss  4.81 | ppl   122.58 
| epoch  12 |   200/  269 batches | lr 0.00030 | ms/batch 76.29 | loss  4.73 | ppl   113.04 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 21.09s | valid loss  4.61 | valid ppl   100.94 | valid bpc    6.657
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 12.0%
| epoch  13 |   100/  269 batches | lr 0.00030 | ms/batch 77.97 | loss  4.70 | ppl   110.20 
| epoch  13 |   200/  269 batches | lr 0.00030 | ms/batch 76.45 | loss  4.64 | ppl   103.23 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 21.06s | valid loss  4.56 | valid ppl    95.25 | valid bpc    6.574
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 13.0%
| epoch  14 |   100/  269 batches | lr 0.00030 | ms/batch 78.37 | loss  4.62 | ppl   101.72 
| epoch  14 |   200/  269 batches | lr 0.00030 | ms/batch 76.02 | loss  4.54 | ppl    93.37 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 21.09s | valid loss  4.48 | valid ppl    87.84 | valid bpc    6.457
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  269 batches | lr 0.00030 | ms/batch 78.17 | loss  4.52 | ppl    92.05 
| epoch  15 |   200/  269 batches | lr 0.00030 | ms/batch 76.32 | loss  4.47 | ppl    87.07 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 21.09s | valid loss  4.39 | valid ppl    80.39 | valid bpc    6.329
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 15.0%
| epoch  16 |   100/  269 batches | lr 0.00030 | ms/batch 78.01 | loss  4.44 | ppl    84.73 
| epoch  16 |   200/  269 batches | lr 0.00030 | ms/batch 76.48 | loss  4.39 | ppl    80.67 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 21.07s | valid loss  4.37 | valid ppl    79.18 | valid bpc    6.307
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 16.0%
| epoch  17 |   100/  269 batches | lr 0.00030 | ms/batch 77.98 | loss  4.35 | ppl    77.62 
| epoch  17 |   200/  269 batches | lr 0.00030 | ms/batch 76.39 | loss  4.32 | ppl    74.98 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 21.06s | valid loss  4.34 | valid ppl    76.60 | valid bpc    6.259
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 17.0%
| epoch  18 |   100/  269 batches | lr 0.00030 | ms/batch 77.82 | loss  4.30 | ppl    73.35 
| epoch  18 |   200/  269 batches | lr 0.00030 | ms/batch 76.41 | loss  4.23 | ppl    69.03 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 21.07s | valid loss  4.28 | valid ppl    72.46 | valid bpc    6.179
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 18.0%
| epoch  19 |   100/  269 batches | lr 0.00030 | ms/batch 78.06 | loss  4.23 | ppl    68.51 
| epoch  19 |   200/  269 batches | lr 0.00030 | ms/batch 76.13 | loss  4.19 | ppl    66.13 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 21.07s | valid loss  4.22 | valid ppl    67.91 | valid bpc    6.086
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 19.0%
| epoch  20 |   100/  269 batches | lr 0.00030 | ms/batch 77.90 | loss  4.17 | ppl    64.40 
| epoch  20 |   200/  269 batches | lr 0.00030 | ms/batch 76.15 | loss  4.12 | ppl    61.66 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 21.07s | valid loss  4.24 | valid ppl    69.60 | valid bpc    6.121
-----------------------------------------------------------------------------------------
PROGRESS: 20.0%
| epoch  21 |   100/  269 batches | lr 0.00030 | ms/batch 78.05 | loss  4.11 | ppl    61.14 
| epoch  21 |   200/  269 batches | lr 0.00030 | ms/batch 76.36 | loss  4.07 | ppl    58.40 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 21.06s | valid loss  4.15 | valid ppl    63.60 | valid bpc    5.991
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 21.0%
| epoch  22 |   100/  269 batches | lr 0.00030 | ms/batch 78.01 | loss  4.03 | ppl    56.35 
| epoch  22 |   200/  269 batches | lr 0.00030 | ms/batch 76.45 | loss  4.01 | ppl    54.93 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 21.06s | valid loss  4.11 | valid ppl    61.04 | valid bpc    5.932
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 22.0%
| epoch  23 |   100/  269 batches | lr 0.00030 | ms/batch 77.70 | loss  4.00 | ppl    54.42 
| epoch  23 |   200/  269 batches | lr 0.00030 | ms/batch 76.56 | loss  3.97 | ppl    53.22 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 21.06s | valid loss  4.08 | valid ppl    58.86 | valid bpc    5.879
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 23.0%
| epoch  24 |   100/  269 batches | lr 0.00030 | ms/batch 78.05 | loss  3.95 | ppl    51.94 
| epoch  24 |   200/  269 batches | lr 0.00030 | ms/batch 75.99 | loss  3.91 | ppl    49.90 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 21.06s | valid loss  4.12 | valid ppl    61.55 | valid bpc    5.944
-----------------------------------------------------------------------------------------
PROGRESS: 24.0%
| epoch  25 |   100/  269 batches | lr 0.00030 | ms/batch 77.28 | loss  3.91 | ppl    49.80 
| epoch  25 |   200/  269 batches | lr 0.00030 | ms/batch 76.36 | loss  3.89 | ppl    48.68 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 21.04s | valid loss  4.07 | valid ppl    58.77 | valid bpc    5.877
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 25.0%
| epoch  26 |   100/  269 batches | lr 0.00030 | ms/batch 77.82 | loss  3.88 | ppl    48.58 
| epoch  26 |   200/  269 batches | lr 0.00030 | ms/batch 76.45 | loss  3.85 | ppl    46.81 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 21.07s | valid loss  4.07 | valid ppl    58.49 | valid bpc    5.870
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 26.0%
| epoch  27 |   100/  269 batches | lr 0.00030 | ms/batch 77.39 | loss  3.81 | ppl    45.00 
| epoch  27 |   200/  269 batches | lr 0.00030 | ms/batch 76.75 | loss  3.81 | ppl    45.04 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 21.06s | valid loss  4.04 | valid ppl    56.94 | valid bpc    5.831
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 27.0%
| epoch  28 |   100/  269 batches | lr 0.00030 | ms/batch 77.22 | loss  3.78 | ppl    43.88 
| epoch  28 |   200/  269 batches | lr 0.00030 | ms/batch 76.56 | loss  3.75 | ppl    42.69 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 21.05s | valid loss  4.01 | valid ppl    55.31 | valid bpc    5.789
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  269 batches | lr 0.00030 | ms/batch 77.60 | loss  3.74 | ppl    42.02 
| epoch  29 |   200/  269 batches | lr 0.00030 | ms/batch 76.19 | loss  3.70 | ppl    40.43 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 21.05s | valid loss  3.98 | valid ppl    53.40 | valid bpc    5.739
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  269 batches | lr 0.00030 | ms/batch 77.87 | loss  3.72 | ppl    41.46 
| epoch  30 |   200/  269 batches | lr 0.00030 | ms/batch 76.29 | loss  3.69 | ppl    39.92 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 21.05s | valid loss  3.98 | valid ppl    53.72 | valid bpc    5.747
-----------------------------------------------------------------------------------------
PROGRESS: 30.0%
| epoch  31 |   100/  269 batches | lr 0.00030 | ms/batch 78.05 | loss  3.65 | ppl    38.30 
| epoch  31 |   200/  269 batches | lr 0.00030 | ms/batch 76.14 | loss  3.66 | ppl    38.79 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 21.06s | valid loss  4.00 | valid ppl    54.51 | valid bpc    5.769
-----------------------------------------------------------------------------------------
PROGRESS: 31.0%
| epoch  32 |   100/  269 batches | lr 0.00030 | ms/batch 77.70 | loss  3.63 | ppl    37.76 
| epoch  32 |   200/  269 batches | lr 0.00030 | ms/batch 76.12 | loss  3.61 | ppl    36.81 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 21.03s | valid loss  3.91 | valid ppl    49.71 | valid bpc    5.635
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 32.0%
| epoch  33 |   100/  269 batches | lr 0.00030 | ms/batch 77.90 | loss  3.60 | ppl    36.63 
| epoch  33 |   200/  269 batches | lr 0.00030 | ms/batch 76.13 | loss  3.57 | ppl    35.57 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 21.06s | valid loss  3.95 | valid ppl    51.88 | valid bpc    5.697
-----------------------------------------------------------------------------------------
PROGRESS: 33.0%
| epoch  34 |   100/  269 batches | lr 0.00030 | ms/batch 77.56 | loss  3.57 | ppl    35.44 
| epoch  34 |   200/  269 batches | lr 0.00030 | ms/batch 76.40 | loss  3.56 | ppl    35.07 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 21.03s | valid loss  3.90 | valid ppl    49.56 | valid bpc    5.631
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 34.0%
| epoch  35 |   100/  269 batches | lr 0.00030 | ms/batch 77.91 | loss  3.52 | ppl    33.92 
| epoch  35 |   200/  269 batches | lr 0.00030 | ms/batch 76.38 | loss  3.51 | ppl    33.49 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 21.07s | valid loss  3.91 | valid ppl    49.84 | valid bpc    5.639
-----------------------------------------------------------------------------------------
PROGRESS: 35.0%
| epoch  36 |   100/  269 batches | lr 0.00030 | ms/batch 77.60 | loss  3.49 | ppl    32.81 
| epoch  36 |   200/  269 batches | lr 0.00030 | ms/batch 76.08 | loss  3.50 | ppl    33.16 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 21.06s | valid loss  3.94 | valid ppl    51.45 | valid bpc    5.685
-----------------------------------------------------------------------------------------
PROGRESS: 36.0%
| epoch  37 |   100/  269 batches | lr 0.00030 | ms/batch 77.46 | loss  3.47 | ppl    32.26 
| epoch  37 |   200/  269 batches | lr 0.00030 | ms/batch 76.60 | loss  3.46 | ppl    31.93 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 21.04s | valid loss  3.89 | valid ppl    49.11 | valid bpc    5.618
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 37.0%
| epoch  38 |   100/  269 batches | lr 0.00030 | ms/batch 77.81 | loss  3.44 | ppl    31.30 
| epoch  38 |   200/  269 batches | lr 0.00030 | ms/batch 76.32 | loss  3.41 | ppl    30.23 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 21.06s | valid loss  3.90 | valid ppl    49.27 | valid bpc    5.623
-----------------------------------------------------------------------------------------
PROGRESS: 38.0%
| epoch  39 |   100/  269 batches | lr 0.00030 | ms/batch 77.44 | loss  3.41 | ppl    30.15 
| epoch  39 |   200/  269 batches | lr 0.00030 | ms/batch 76.64 | loss  3.43 | ppl    30.81 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 21.06s | valid loss  3.91 | valid ppl    49.82 | valid bpc    5.639
-----------------------------------------------------------------------------------------
PROGRESS: 39.0%
| epoch  40 |   100/  269 batches | lr 0.00030 | ms/batch 78.02 | loss  3.38 | ppl    29.41 
| epoch  40 |   200/  269 batches | lr 0.00030 | ms/batch 76.43 | loss  3.39 | ppl    29.81 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 21.13s | valid loss  3.88 | valid ppl    48.28 | valid bpc    5.593
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 40.0%
| epoch  41 |   100/  269 batches | lr 0.00030 | ms/batch 77.50 | loss  3.36 | ppl    28.87 
| epoch  41 |   200/  269 batches | lr 0.00030 | ms/batch 76.20 | loss  3.36 | ppl    28.68 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 21.06s | valid loss  3.91 | valid ppl    49.69 | valid bpc    5.635
-----------------------------------------------------------------------------------------
PROGRESS: 41.0%
| epoch  42 |   100/  269 batches | lr 0.00030 | ms/batch 77.49 | loss  3.33 | ppl    27.90 
| epoch  42 |   200/  269 batches | lr 0.00030 | ms/batch 76.49 | loss  3.32 | ppl    27.60 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 21.06s | valid loss  3.91 | valid ppl    49.90 | valid bpc    5.641
-----------------------------------------------------------------------------------------
PROGRESS: 42.0%
| epoch  43 |   100/  269 batches | lr 0.00030 | ms/batch 77.88 | loss  3.31 | ppl    27.43 
| epoch  43 |   200/  269 batches | lr 0.00030 | ms/batch 76.27 | loss  3.30 | ppl    27.24 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 21.07s | valid loss  3.84 | valid ppl    46.70 | valid bpc    5.545
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 43.0%
| epoch  44 |   100/  269 batches | lr 0.00030 | ms/batch 77.55 | loss  3.26 | ppl    26.02 
| epoch  44 |   200/  269 batches | lr 0.00030 | ms/batch 76.41 | loss  3.29 | ppl    26.79 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 21.06s | valid loss  3.86 | valid ppl    47.65 | valid bpc    5.574
-----------------------------------------------------------------------------------------
PROGRESS: 44.0%
| epoch  45 |   100/  269 batches | lr 0.00030 | ms/batch 77.79 | loss  3.25 | ppl    25.86 
| epoch  45 |   200/  269 batches | lr 0.00030 | ms/batch 76.32 | loss  3.24 | ppl    25.64 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 21.07s | valid loss  3.83 | valid ppl    46.25 | valid bpc    5.531
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 45.0%
| epoch  46 |   100/  269 batches | lr 0.00030 | ms/batch 78.28 | loss  3.25 | ppl    25.67 
| epoch  46 |   200/  269 batches | lr 0.00030 | ms/batch 76.14 | loss  3.21 | ppl    24.76 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 21.07s | valid loss  3.86 | valid ppl    47.49 | valid bpc    5.569
-----------------------------------------------------------------------------------------
PROGRESS: 46.0%
| epoch  47 |   100/  269 batches | lr 0.00030 | ms/batch 77.79 | loss  3.21 | ppl    24.67 
| epoch  47 |   200/  269 batches | lr 0.00030 | ms/batch 76.62 | loss  3.21 | ppl    24.72 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 21.07s | valid loss  3.84 | valid ppl    46.67 | valid bpc    5.544
-----------------------------------------------------------------------------------------
PROGRESS: 47.0%
| epoch  48 |   100/  269 batches | lr 0.00030 | ms/batch 78.04 | loss  3.19 | ppl    24.21 
| epoch  48 |   200/  269 batches | lr 0.00030 | ms/batch 76.06 | loss  3.18 | ppl    24.04 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 21.03s | valid loss  3.86 | valid ppl    47.40 | valid bpc    5.567
-----------------------------------------------------------------------------------------
PROGRESS: 48.0%
| epoch  49 |   100/  269 batches | lr 0.00015 | ms/batch 77.49 | loss  3.11 | ppl    22.50 
| epoch  49 |   200/  269 batches | lr 0.00015 | ms/batch 76.55 | loss  3.08 | ppl    21.70 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 21.04s | valid loss  3.86 | valid ppl    47.34 | valid bpc    5.565
-----------------------------------------------------------------------------------------
PROGRESS: 49.0%
| epoch  50 |   100/  269 batches | lr 0.00015 | ms/batch 77.83 | loss  3.06 | ppl    21.31 
| epoch  50 |   200/  269 batches | lr 0.00015 | ms/batch 76.63 | loss  3.01 | ppl    20.28 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 21.08s | valid loss  3.77 | valid ppl    43.28 | valid bpc    5.436
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 50.0%
| epoch  51 |   100/  269 batches | lr 0.00015 | ms/batch 77.84 | loss  3.03 | ppl    20.67 
| epoch  51 |   200/  269 batches | lr 0.00015 | ms/batch 76.56 | loss  3.00 | ppl    20.11 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 21.06s | valid loss  3.77 | valid ppl    43.59 | valid bpc    5.446
-----------------------------------------------------------------------------------------
PROGRESS: 51.0%
| epoch  52 |   100/  269 batches | lr 0.00015 | ms/batch 78.27 | loss  3.01 | ppl    20.23 
| epoch  52 |   200/  269 batches | lr 0.00015 | ms/batch 76.27 | loss  2.98 | ppl    19.70 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 21.07s | valid loss  3.78 | valid ppl    43.86 | valid bpc    5.455
-----------------------------------------------------------------------------------------
PROGRESS: 52.0%
| epoch  53 |   100/  269 batches | lr 0.00015 | ms/batch 77.46 | loss  2.95 | ppl    19.18 
| epoch  53 |   200/  269 batches | lr 0.00015 | ms/batch 76.76 | loss  2.96 | ppl    19.25 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 21.08s | valid loss  3.80 | valid ppl    44.86 | valid bpc    5.487
-----------------------------------------------------------------------------------------
PROGRESS: 53.0%
| epoch  54 |   100/  269 batches | lr 0.00007 | ms/batch 77.84 | loss  2.93 | ppl    18.66 
| epoch  54 |   200/  269 batches | lr 0.00007 | ms/batch 76.20 | loss  2.90 | ppl    18.23 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 21.07s | valid loss  3.72 | valid ppl    41.40 | valid bpc    5.372
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 54.0%
| epoch  55 |   100/  269 batches | lr 0.00007 | ms/batch 78.16 | loss  2.88 | ppl    17.85 
| epoch  55 |   200/  269 batches | lr 0.00007 | ms/batch 76.25 | loss  2.87 | ppl    17.71 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 21.07s | valid loss  3.72 | valid ppl    41.22 | valid bpc    5.365
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  269 batches | lr 0.00007 | ms/batch 77.38 | loss  2.88 | ppl    17.75 
| epoch  56 |   200/  269 batches | lr 0.00007 | ms/batch 76.50 | loss  2.84 | ppl    17.14 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 21.06s | valid loss  3.82 | valid ppl    45.79 | valid bpc    5.517
-----------------------------------------------------------------------------------------
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  269 batches | lr 0.00007 | ms/batch 78.24 | loss  2.87 | ppl    17.72 
| epoch  57 |   200/  269 batches | lr 0.00007 | ms/batch 76.04 | loss  2.83 | ppl    16.93 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 21.03s | valid loss  3.76 | valid ppl    42.93 | valid bpc    5.424
-----------------------------------------------------------------------------------------
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  269 batches | lr 0.00007 | ms/batch 77.94 | loss  2.84 | ppl    17.18 
| epoch  58 |   200/  269 batches | lr 0.00007 | ms/batch 76.51 | loss  2.82 | ppl    16.74 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 21.07s | valid loss  3.78 | valid ppl    43.65 | valid bpc    5.448
-----------------------------------------------------------------------------------------
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  269 batches | lr 0.00004 | ms/batch 77.86 | loss  2.82 | ppl    16.82 
| epoch  59 |   200/  269 batches | lr 0.00004 | ms/batch 75.93 | loss  2.79 | ppl    16.33 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 21.04s | valid loss  3.75 | valid ppl    42.66 | valid bpc    5.415
-----------------------------------------------------------------------------------------
PROGRESS: 59.0%
| epoch  60 |   100/  269 batches | lr 0.00004 | ms/batch 77.88 | loss  2.80 | ppl    16.44 
| epoch  60 |   200/  269 batches | lr 0.00004 | ms/batch 76.44 | loss  2.79 | ppl    16.31 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 21.04s | valid loss  3.77 | valid ppl    43.26 | valid bpc    5.435
-----------------------------------------------------------------------------------------
PROGRESS: 60.0%
| epoch  61 |   100/  269 batches | lr 0.00004 | ms/batch 77.62 | loss  2.81 | ppl    16.56 
| epoch  61 |   200/  269 batches | lr 0.00004 | ms/batch 76.57 | loss  2.77 | ppl    15.89 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 21.08s | valid loss  3.78 | valid ppl    43.66 | valid bpc    5.448
-----------------------------------------------------------------------------------------
PROGRESS: 61.0%
| epoch  62 |   100/  269 batches | lr 0.00002 | ms/batch 78.52 | loss  2.77 | ppl    15.93 
| epoch  62 |   200/  269 batches | lr 0.00002 | ms/batch 76.27 | loss  2.75 | ppl    15.70 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 21.14s | valid loss  3.76 | valid ppl    42.91 | valid bpc    5.423
-----------------------------------------------------------------------------------------
PROGRESS: 62.0%
| epoch  63 |   100/  269 batches | lr 0.00002 | ms/batch 77.48 | loss  2.75 | ppl    15.68 
| epoch  63 |   200/  269 batches | lr 0.00002 | ms/batch 76.82 | loss  2.74 | ppl    15.45 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 21.04s | valid loss  3.73 | valid ppl    41.78 | valid bpc    5.385
-----------------------------------------------------------------------------------------
PROGRESS: 63.0%
| epoch  64 |   100/  269 batches | lr 0.00002 | ms/batch 78.14 | loss  2.75 | ppl    15.71 
| epoch  64 |   200/  269 batches | lr 0.00002 | ms/batch 76.60 | loss  2.76 | ppl    15.82 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 21.08s | valid loss  3.73 | valid ppl    41.84 | valid bpc    5.387
-----------------------------------------------------------------------------------------
PROGRESS: 64.0%
| epoch  65 |   100/  269 batches | lr 0.00001 | ms/batch 77.62 | loss  2.78 | ppl    16.10 
| epoch  65 |   200/  269 batches | lr 0.00001 | ms/batch 76.54 | loss  2.74 | ppl    15.42 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 21.08s | valid loss  3.74 | valid ppl    42.30 | valid bpc    5.403
-----------------------------------------------------------------------------------------
PROGRESS: 65.0%
| epoch  66 |   100/  269 batches | lr 0.00001 | ms/batch 77.73 | loss  2.76 | ppl    15.84 
| epoch  66 |   200/  269 batches | lr 0.00001 | ms/batch 76.13 | loss  2.75 | ppl    15.61 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 21.06s | valid loss  3.77 | valid ppl    43.44 | valid bpc    5.441
-----------------------------------------------------------------------------------------
PROGRESS: 66.0%
| epoch  67 |   100/  269 batches | lr 0.00001 | ms/batch 77.94 | loss  2.78 | ppl    16.15 
| epoch  67 |   200/  269 batches | lr 0.00001 | ms/batch 76.48 | loss  2.71 | ppl    15.04 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 21.06s | valid loss  3.77 | valid ppl    43.47 | valid bpc    5.442
-----------------------------------------------------------------------------------------
PROGRESS: 67.0%
| epoch  68 |   100/  269 batches | lr 0.00000 | ms/batch 77.71 | loss  2.75 | ppl    15.60 
| epoch  68 |   200/  269 batches | lr 0.00000 | ms/batch 76.19 | loss  2.74 | ppl    15.46 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 21.07s | valid loss  3.74 | valid ppl    42.21 | valid bpc    5.400
-----------------------------------------------------------------------------------------
PROGRESS: 68.0%
| epoch  69 |   100/  269 batches | lr 0.00000 | ms/batch 77.64 | loss  2.76 | ppl    15.80 
| epoch  69 |   200/  269 batches | lr 0.00000 | ms/batch 76.40 | loss  2.73 | ppl    15.27 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 21.08s | valid loss  3.74 | valid ppl    42.31 | valid bpc    5.403
-----------------------------------------------------------------------------------------
PROGRESS: 69.0%
| epoch  70 |   100/  269 batches | lr 0.00000 | ms/batch 78.04 | loss  2.76 | ppl    15.75 
| epoch  70 |   200/  269 batches | lr 0.00000 | ms/batch 76.46 | loss  2.71 | ppl    14.97 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 21.09s | valid loss  3.76 | valid ppl    42.80 | valid bpc    5.420
-----------------------------------------------------------------------------------------
PROGRESS: 70.0%
| epoch  71 |   100/  269 batches | lr 0.00000 | ms/batch 77.99 | loss  2.77 | ppl    15.98 
| epoch  71 |   200/  269 batches | lr 0.00000 | ms/batch 76.25 | loss  2.71 | ppl    14.97 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 21.06s | valid loss  3.73 | valid ppl    41.86 | valid bpc    5.387
-----------------------------------------------------------------------------------------
PROGRESS: 71.0%
| epoch  72 |   100/  269 batches | lr 0.00000 | ms/batch 77.77 | loss  2.75 | ppl    15.56 
| epoch  72 |   200/  269 batches | lr 0.00000 | ms/batch 76.29 | loss  2.72 | ppl    15.13 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 21.03s | valid loss  3.71 | valid ppl    40.94 | valid bpc    5.356
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 72.0%
| epoch  73 |   100/  269 batches | lr 0.00000 | ms/batch 78.37 | loss  2.75 | ppl    15.65 
| epoch  73 |   200/  269 batches | lr 0.00000 | ms/batch 75.79 | loss  2.73 | ppl    15.38 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 21.07s | valid loss  3.72 | valid ppl    41.38 | valid bpc    5.371
-----------------------------------------------------------------------------------------
PROGRESS: 73.0%
| epoch  74 |   100/  269 batches | lr 0.00000 | ms/batch 77.90 | loss  2.74 | ppl    15.55 
| epoch  74 |   200/  269 batches | lr 0.00000 | ms/batch 76.47 | loss  2.71 | ppl    15.01 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 21.07s | valid loss  3.71 | valid ppl    41.03 | valid bpc    5.359
-----------------------------------------------------------------------------------------
PROGRESS: 74.0%
| epoch  75 |   100/  269 batches | lr 0.00000 | ms/batch 77.61 | loss  2.73 | ppl    15.38 
| epoch  75 |   200/  269 batches | lr 0.00000 | ms/batch 76.36 | loss  2.75 | ppl    15.61 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 21.05s | valid loss  3.75 | valid ppl    42.35 | valid bpc    5.404
-----------------------------------------------------------------------------------------
PROGRESS: 75.0%
| epoch  76 |   100/  269 batches | lr 0.00000 | ms/batch 77.99 | loss  2.74 | ppl    15.53 
| epoch  76 |   200/  269 batches | lr 0.00000 | ms/batch 76.43 | loss  2.74 | ppl    15.46 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 21.07s | valid loss  3.76 | valid ppl    43.14 | valid bpc    5.431
-----------------------------------------------------------------------------------------
PROGRESS: 76.0%
| epoch  77 |   100/  269 batches | lr 0.00000 | ms/batch 77.89 | loss  2.75 | ppl    15.72 
| epoch  77 |   200/  269 batches | lr 0.00000 | ms/batch 76.86 | loss  2.74 | ppl    15.46 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 21.15s | valid loss  3.72 | valid ppl    41.36 | valid bpc    5.370
-----------------------------------------------------------------------------------------
PROGRESS: 77.0%
| epoch  78 |   100/  269 batches | lr 0.00000 | ms/batch 77.65 | loss  2.74 | ppl    15.49 
| epoch  78 |   200/  269 batches | lr 0.00000 | ms/batch 76.44 | loss  2.72 | ppl    15.19 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 21.08s | valid loss  3.75 | valid ppl    42.73 | valid bpc    5.417
-----------------------------------------------------------------------------------------
PROGRESS: 78.0%
| epoch  79 |   100/  269 batches | lr 0.00000 | ms/batch 78.32 | loss  2.72 | ppl    15.15 
| epoch  79 |   200/  269 batches | lr 0.00000 | ms/batch 76.16 | loss  2.74 | ppl    15.49 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 21.08s | valid loss  3.72 | valid ppl    41.06 | valid bpc    5.360
-----------------------------------------------------------------------------------------
PROGRESS: 79.0%
| epoch  80 |   100/  269 batches | lr 0.00000 | ms/batch 78.46 | loss  2.74 | ppl    15.54 
| epoch  80 |   200/  269 batches | lr 0.00000 | ms/batch 76.63 | loss  2.72 | ppl    15.11 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 21.14s | valid loss  3.75 | valid ppl    42.39 | valid bpc    5.406
-----------------------------------------------------------------------------------------
PROGRESS: 80.0%
| epoch  81 |   100/  269 batches | lr 0.00000 | ms/batch 77.70 | loss  2.76 | ppl    15.73 
| epoch  81 |   200/  269 batches | lr 0.00000 | ms/batch 76.21 | loss  2.70 | ppl    14.83 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 21.07s | valid loss  3.72 | valid ppl    41.32 | valid bpc    5.369
-----------------------------------------------------------------------------------------
PROGRESS: 81.0%
| epoch  82 |   100/  269 batches | lr 0.00000 | ms/batch 78.18 | loss  2.73 | ppl    15.35 
| epoch  82 |   200/  269 batches | lr 0.00000 | ms/batch 76.39 | loss  2.71 | ppl    15.02 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 21.05s | valid loss  3.78 | valid ppl    43.64 | valid bpc    5.447
-----------------------------------------------------------------------------------------
PROGRESS: 82.0%
| epoch  83 |   100/  269 batches | lr 0.00000 | ms/batch 77.68 | loss  2.75 | ppl    15.61 
| epoch  83 |   200/  269 batches | lr 0.00000 | ms/batch 76.59 | loss  2.69 | ppl    14.80 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 21.06s | valid loss  3.69 | valid ppl    40.12 | valid bpc    5.326
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 83.0%
| epoch  84 |   100/  269 batches | lr 0.00000 | ms/batch 77.94 | loss  2.76 | ppl    15.79 
| epoch  84 |   200/  269 batches | lr 0.00000 | ms/batch 75.87 | loss  2.71 | ppl    15.00 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 21.06s | valid loss  3.70 | valid ppl    40.57 | valid bpc    5.342
-----------------------------------------------------------------------------------------
PROGRESS: 84.0%
| epoch  85 |   100/  269 batches | lr 0.00000 | ms/batch 78.02 | loss  2.73 | ppl    15.30 
| epoch  85 |   200/  269 batches | lr 0.00000 | ms/batch 76.43 | loss  2.70 | ppl    14.91 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 21.07s | valid loss  3.71 | valid ppl    40.71 | valid bpc    5.347
-----------------------------------------------------------------------------------------
PROGRESS: 85.0%
| epoch  86 |   100/  269 batches | lr 0.00000 | ms/batch 78.19 | loss  2.72 | ppl    15.11 
| epoch  86 |   200/  269 batches | lr 0.00000 | ms/batch 76.10 | loss  2.69 | ppl    14.70 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 21.03s | valid loss  3.72 | valid ppl    41.27 | valid bpc    5.367
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  269 batches | lr 0.00000 | ms/batch 77.68 | loss  2.73 | ppl    15.33 
| epoch  87 |   200/  269 batches | lr 0.00000 | ms/batch 76.39 | loss  2.73 | ppl    15.32 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 21.07s | valid loss  3.72 | valid ppl    41.45 | valid bpc    5.373
-----------------------------------------------------------------------------------------
PROGRESS: 87.0%
| epoch  88 |   100/  269 batches | lr 0.00000 | ms/batch 78.15 | loss  2.73 | ppl    15.36 
| epoch  88 |   200/  269 batches | lr 0.00000 | ms/batch 75.89 | loss  2.71 | ppl    15.03 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 21.09s | valid loss  3.75 | valid ppl    42.36 | valid bpc    5.405
-----------------------------------------------------------------------------------------
PROGRESS: 88.0%
| epoch  89 |   100/  269 batches | lr 0.00000 | ms/batch 77.47 | loss  2.76 | ppl    15.75 
| epoch  89 |   200/  269 batches | lr 0.00000 | ms/batch 76.59 | loss  2.73 | ppl    15.34 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 21.04s | valid loss  3.77 | valid ppl    43.25 | valid bpc    5.435
-----------------------------------------------------------------------------------------
PROGRESS: 89.0%
| epoch  90 |   100/  269 batches | lr 0.00000 | ms/batch 77.74 | loss  2.73 | ppl    15.33 
| epoch  90 |   200/  269 batches | lr 0.00000 | ms/batch 76.41 | loss  2.74 | ppl    15.42 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 21.08s | valid loss  3.76 | valid ppl    43.05 | valid bpc    5.428
-----------------------------------------------------------------------------------------
PROGRESS: 90.0%
| epoch  91 |   100/  269 batches | lr 0.00000 | ms/batch 77.69 | loss  2.72 | ppl    15.22 
| epoch  91 |   200/  269 batches | lr 0.00000 | ms/batch 76.52 | loss  2.71 | ppl    15.06 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 21.07s | valid loss  3.71 | valid ppl    40.93 | valid bpc    5.355
-----------------------------------------------------------------------------------------
PROGRESS: 91.0%
| epoch  92 |   100/  269 batches | lr 0.00000 | ms/batch 77.76 | loss  2.73 | ppl    15.36 
| epoch  92 |   200/  269 batches | lr 0.00000 | ms/batch 76.34 | loss  2.73 | ppl    15.31 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 21.07s | valid loss  3.73 | valid ppl    41.47 | valid bpc    5.374
-----------------------------------------------------------------------------------------
PROGRESS: 92.0%
| epoch  93 |   100/  269 batches | lr 0.00000 | ms/batch 77.85 | loss  2.73 | ppl    15.36 
| epoch  93 |   200/  269 batches | lr 0.00000 | ms/batch 76.45 | loss  2.71 | ppl    15.10 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 21.07s | valid loss  3.74 | valid ppl    42.18 | valid bpc    5.398
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  269 batches | lr 0.00000 | ms/batch 77.63 | loss  2.74 | ppl    15.52 
| epoch  94 |   200/  269 batches | lr 0.00000 | ms/batch 76.48 | loss  2.71 | ppl    15.07 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 21.06s | valid loss  3.72 | valid ppl    41.45 | valid bpc    5.373
-----------------------------------------------------------------------------------------
PROGRESS: 94.0%
| epoch  95 |   100/  269 batches | lr 0.00000 | ms/batch 78.00 | loss  2.75 | ppl    15.63 
| epoch  95 |   200/  269 batches | lr 0.00000 | ms/batch 76.57 | loss  2.71 | ppl    15.05 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 21.08s | valid loss  3.77 | valid ppl    43.23 | valid bpc    5.434
-----------------------------------------------------------------------------------------
PROGRESS: 95.0%
| epoch  96 |   100/  269 batches | lr 0.00000 | ms/batch 77.47 | loss  2.71 | ppl    15.02 
| epoch  96 |   200/  269 batches | lr 0.00000 | ms/batch 76.25 | loss  2.72 | ppl    15.14 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 21.04s | valid loss  3.77 | valid ppl    43.60 | valid bpc    5.446
-----------------------------------------------------------------------------------------
PROGRESS: 96.0%
| epoch  97 |   100/  269 batches | lr 0.00000 | ms/batch 77.43 | loss  2.75 | ppl    15.57 
| epoch  97 |   200/  269 batches | lr 0.00000 | ms/batch 76.48 | loss  2.71 | ppl    14.98 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 21.04s | valid loss  3.77 | valid ppl    43.60 | valid bpc    5.446
-----------------------------------------------------------------------------------------
PROGRESS: 97.0%
| epoch  98 |   100/  269 batches | lr 0.00000 | ms/batch 77.62 | loss  2.74 | ppl    15.49 
| epoch  98 |   200/  269 batches | lr 0.00000 | ms/batch 76.68 | loss  2.71 | ppl    15.01 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 21.08s | valid loss  3.73 | valid ppl    41.54 | valid bpc    5.376
-----------------------------------------------------------------------------------------
PROGRESS: 98.0%
| epoch  99 |   100/  269 batches | lr 0.00000 | ms/batch 77.67 | loss  2.74 | ppl    15.56 
| epoch  99 |   200/  269 batches | lr 0.00000 | ms/batch 76.74 | loss  2.71 | ppl    15.05 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 21.08s | valid loss  3.70 | valid ppl    40.53 | valid bpc    5.341
-----------------------------------------------------------------------------------------
PROGRESS: 99.0%
| epoch 100 |   100/  269 batches | lr 0.00000 | ms/batch 77.84 | loss  2.75 | ppl    15.69 
| epoch 100 |   200/  269 batches | lr 0.00000 | ms/batch 76.16 | loss  2.70 | ppl    14.82 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 21.07s | valid loss  3.75 | valid ppl    42.64 | valid bpc    5.414
-----------------------------------------------------------------------------------------
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  3.86 | test ppl    47.51 | test bpc    5.570
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.4556, Mean Reca: 0.6429, Mean F1: 0.5289, Mean Subword_Reca: 0.9503
-----------------------------------------------------------------------------------------
=========================================================================================
Loading dataset...
Using subword tokenizer...
Number of tokens:  8000
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer', nhid=512, nlayers=8, front_layers=2, rear_layers=6, subword='omarmomen/ptb_filtered_lowcase_bpe_tokenizer_8', n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=4444, nonmono=5, cuda=True, log_interval=100, save='trained_models/subword_4444.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 37448132
Model architecture: StructFormer(
  (drop): Dropout(p=0.1, inplace=False)
  (emb): Embedding(8000, 512)
  (pos_emb): Embedding(500, 512)
  (layers): ModuleList(
    (0-7): 8 x TransformerLayer(
      (self_attn): MultiheadAttention(
        (drop): Dropout(p=0, inplace=False)
        (q_proj): Linear(in_features=512, out_features=512, bias=True)
        (k_proj): Linear(in_features=512, out_features=512, bias=True)
        (v_proj): Linear(in_features=512, out_features=512, bias=True)
        (out_proj): Linear(in_features=512, out_features=512, bias=True)
      )
      (feedforward): Sequential(
        (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (1): Linear(in_features=512, out_features=2048, bias=True)
        (2): LeakyReLU(negative_slope=0.01)
        (3): Dropout(p=0.1, inplace=False)
        (4): Linear(in_features=2048, out_features=512, bias=True)
      )
      (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      (dropout1): Dropout(p=0.1, inplace=False)
      (dropout2): Dropout(p=0.1, inplace=False)
    )
  )
  (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  (output_layer): Linear(in_features=512, out_features=8000, bias=True)
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  269 batches | lr 0.00030 | ms/batch 80.56 | loss  7.74 | ppl  2306.33 
| epoch   1 |   200/  269 batches | lr 0.00030 | ms/batch 75.63 | loss  7.35 | ppl  1561.44 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 21.21s | valid loss  7.03 | valid ppl  1133.00 | valid bpc   10.146
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  269 batches | lr 0.00030 | ms/batch 77.26 | loss  7.27 | ppl  1443.09 
| epoch   2 |   200/  269 batches | lr 0.00030 | ms/batch 75.54 | loss  7.14 | ppl  1261.85 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 20.83s | valid loss  6.89 | valid ppl   985.89 | valid bpc    9.945
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  269 batches | lr 0.00030 | ms/batch 76.89 | loss  7.11 | ppl  1220.10 
| epoch   3 |   200/  269 batches | lr 0.00030 | ms/batch 76.22 | loss  6.94 | ppl  1037.87 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 20.92s | valid loss  6.45 | valid ppl   633.77 | valid bpc    9.308
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  269 batches | lr 0.00030 | ms/batch 77.49 | loss  6.57 | ppl   711.60 
| epoch   4 |   200/  269 batches | lr 0.00030 | ms/batch 75.75 | loss  6.31 | ppl   547.94 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 20.99s | valid loss  5.93 | valid ppl   377.54 | valid bpc    8.561
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  269 batches | lr 0.00030 | ms/batch 77.71 | loss  6.06 | ppl   428.90 
| epoch   5 |   200/  269 batches | lr 0.00030 | ms/batch 75.90 | loss  5.84 | ppl   343.35 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 21.02s | valid loss  5.51 | valid ppl   247.14 | valid bpc    7.949
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  269 batches | lr 0.00030 | ms/batch 78.08 | loss  5.68 | ppl   291.76 
| epoch   6 |   200/  269 batches | lr 0.00030 | ms/batch 75.42 | loss  5.53 | ppl   251.88 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 21.01s | valid loss  5.27 | valid ppl   195.35 | valid bpc    7.610
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  269 batches | lr 0.00030 | ms/batch 77.63 | loss  5.46 | ppl   235.14 
| epoch   7 |   200/  269 batches | lr 0.00030 | ms/batch 76.66 | loss  5.35 | ppl   210.13 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 21.02s | valid loss  5.07 | valid ppl   159.39 | valid bpc    7.316
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  269 batches | lr 0.00030 | ms/batch 77.35 | loss  5.25 | ppl   191.38 
| epoch   8 |   200/  269 batches | lr 0.00030 | ms/batch 76.36 | loss  5.18 | ppl   177.17 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 21.02s | valid loss  4.96 | valid ppl   142.80 | valid bpc    7.158
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 8.0%
| epoch   9 |   100/  269 batches | lr 0.00030 | ms/batch 77.84 | loss  5.11 | ppl   166.06 
| epoch   9 |   200/  269 batches | lr 0.00030 | ms/batch 76.17 | loss  5.02 | ppl   151.35 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 21.05s | valid loss  4.84 | valid ppl   127.02 | valid bpc    6.989
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  269 batches | lr 0.00030 | ms/batch 77.81 | loss  4.96 | ppl   142.41 
| epoch  10 |   200/  269 batches | lr 0.00030 | ms/batch 75.88 | loss  4.88 | ppl   131.96 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 21.04s | valid loss  4.80 | valid ppl   121.30 | valid bpc    6.922
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  269 batches | lr 0.00030 | ms/batch 77.76 | loss  4.82 | ppl   124.47 
| epoch  11 |   200/  269 batches | lr 0.00030 | ms/batch 76.36 | loss  4.76 | ppl   116.60 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 21.04s | valid loss  4.66 | valid ppl   105.34 | valid bpc    6.719
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  269 batches | lr 0.00030 | ms/batch 77.65 | loss  4.71 | ppl   111.29 
| epoch  12 |   200/  269 batches | lr 0.00030 | ms/batch 76.27 | loss  4.67 | ppl   107.22 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 21.05s | valid loss  4.52 | valid ppl    91.93 | valid bpc    6.522
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 12.0%
| epoch  13 |   100/  269 batches | lr 0.00030 | ms/batch 78.04 | loss  4.63 | ppl   102.26 
| epoch  13 |   200/  269 batches | lr 0.00030 | ms/batch 76.42 | loss  4.58 | ppl    97.91 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 21.04s | valid loss  4.51 | valid ppl    90.88 | valid bpc    6.506
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 13.0%
| epoch  14 |   100/  269 batches | lr 0.00030 | ms/batch 77.94 | loss  4.53 | ppl    92.70 
| epoch  14 |   200/  269 batches | lr 0.00030 | ms/batch 76.04 | loss  4.45 | ppl    85.78 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 21.04s | valid loss  4.45 | valid ppl    85.46 | valid bpc    6.417
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  269 batches | lr 0.00030 | ms/batch 78.12 | loss  4.44 | ppl    84.67 
| epoch  15 |   200/  269 batches | lr 0.00030 | ms/batch 76.20 | loss  4.41 | ppl    81.94 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 21.04s | valid loss  4.36 | valid ppl    78.33 | valid bpc    6.291
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 15.0%
| epoch  16 |   100/  269 batches | lr 0.00030 | ms/batch 77.84 | loss  4.37 | ppl    78.71 
| epoch  16 |   200/  269 batches | lr 0.00030 | ms/batch 76.22 | loss  4.33 | ppl    75.80 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 21.04s | valid loss  4.34 | valid ppl    76.65 | valid bpc    6.260
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 16.0%
| epoch  17 |   100/  269 batches | lr 0.00030 | ms/batch 77.40 | loss  4.27 | ppl    71.38 
| epoch  17 |   200/  269 batches | lr 0.00030 | ms/batch 76.60 | loss  4.27 | ppl    71.67 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 21.04s | valid loss  4.30 | valid ppl    74.02 | valid bpc    6.210
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 17.0%
| epoch  18 |   100/  269 batches | lr 0.00030 | ms/batch 77.94 | loss  4.22 | ppl    67.80 
| epoch  18 |   200/  269 batches | lr 0.00030 | ms/batch 75.96 | loss  4.17 | ppl    64.85 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 21.04s | valid loss  4.30 | valid ppl    73.49 | valid bpc    6.199
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 18.0%
| epoch  19 |   100/  269 batches | lr 0.00030 | ms/batch 77.73 | loss  4.14 | ppl    62.86 
| epoch  19 |   200/  269 batches | lr 0.00030 | ms/batch 76.37 | loss  4.12 | ppl    61.81 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 21.04s | valid loss  4.22 | valid ppl    68.34 | valid bpc    6.095
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 19.0%
| epoch  20 |   100/  269 batches | lr 0.00030 | ms/batch 77.63 | loss  4.10 | ppl    60.16 
| epoch  20 |   200/  269 batches | lr 0.00030 | ms/batch 76.10 | loss  4.09 | ppl    59.82 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 21.04s | valid loss  4.12 | valid ppl    61.32 | valid bpc    5.938
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 20.0%
| epoch  21 |   100/  269 batches | lr 0.00030 | ms/batch 77.36 | loss  4.02 | ppl    55.47 
| epoch  21 |   200/  269 batches | lr 0.00030 | ms/batch 76.29 | loss  4.00 | ppl    54.65 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 21.04s | valid loss  4.15 | valid ppl    63.39 | valid bpc    5.986
-----------------------------------------------------------------------------------------
PROGRESS: 21.0%
| epoch  22 |   100/  269 batches | lr 0.00030 | ms/batch 77.83 | loss  3.99 | ppl    54.31 
| epoch  22 |   200/  269 batches | lr 0.00030 | ms/batch 76.43 | loss  3.97 | ppl    53.03 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 21.04s | valid loss  4.08 | valid ppl    59.29 | valid bpc    5.890
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 22.0%
| epoch  23 |   100/  269 batches | lr 0.00030 | ms/batch 77.51 | loss  3.92 | ppl    50.25 
| epoch  23 |   200/  269 batches | lr 0.00030 | ms/batch 76.30 | loss  3.94 | ppl    51.24 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 21.05s | valid loss  4.12 | valid ppl    61.32 | valid bpc    5.938
-----------------------------------------------------------------------------------------
PROGRESS: 23.0%
| epoch  24 |   100/  269 batches | lr 0.00030 | ms/batch 77.51 | loss  3.88 | ppl    48.47 
| epoch  24 |   200/  269 batches | lr 0.00030 | ms/batch 76.17 | loss  3.87 | ppl    48.10 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 21.01s | valid loss  4.07 | valid ppl    58.70 | valid bpc    5.875
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 24.0%
| epoch  25 |   100/  269 batches | lr 0.00030 | ms/batch 77.87 | loss  3.85 | ppl    46.97 
| epoch  25 |   200/  269 batches | lr 0.00030 | ms/batch 75.81 | loss  3.82 | ppl    45.69 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 21.05s | valid loss  4.02 | valid ppl    55.78 | valid bpc    5.802
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 25.0%
| epoch  26 |   100/  269 batches | lr 0.00030 | ms/batch 77.49 | loss  3.81 | ppl    44.96 
| epoch  26 |   200/  269 batches | lr 0.00030 | ms/batch 76.55 | loss  3.78 | ppl    43.99 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 21.04s | valid loss  4.10 | valid ppl    60.16 | valid bpc    5.911
-----------------------------------------------------------------------------------------
PROGRESS: 26.0%
| epoch  27 |   100/  269 batches | lr 0.00030 | ms/batch 77.67 | loss  3.74 | ppl    42.25 
| epoch  27 |   200/  269 batches | lr 0.00030 | ms/batch 76.68 | loss  3.75 | ppl    42.52 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 21.05s | valid loss  4.01 | valid ppl    54.94 | valid bpc    5.780
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 27.0%
| epoch  28 |   100/  269 batches | lr 0.00030 | ms/batch 77.70 | loss  3.72 | ppl    41.16 
| epoch  28 |   200/  269 batches | lr 0.00030 | ms/batch 76.28 | loss  3.71 | ppl    40.82 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 21.05s | valid loss  4.00 | valid ppl    54.50 | valid bpc    5.768
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  269 batches | lr 0.00030 | ms/batch 77.57 | loss  3.70 | ppl    40.58 
| epoch  29 |   200/  269 batches | lr 0.00030 | ms/batch 76.67 | loss  3.69 | ppl    39.89 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 21.04s | valid loss  3.99 | valid ppl    54.28 | valid bpc    5.762
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  269 batches | lr 0.00030 | ms/batch 77.95 | loss  3.67 | ppl    39.25 
| epoch  30 |   200/  269 batches | lr 0.00030 | ms/batch 76.36 | loss  3.62 | ppl    37.48 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 21.03s | valid loss  3.94 | valid ppl    51.46 | valid bpc    5.685
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 30.0%
| epoch  31 |   100/  269 batches | lr 0.00030 | ms/batch 77.97 | loss  3.62 | ppl    37.41 
| epoch  31 |   200/  269 batches | lr 0.00030 | ms/batch 76.12 | loss  3.60 | ppl    36.73 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 21.04s | valid loss  3.99 | valid ppl    53.87 | valid bpc    5.751
-----------------------------------------------------------------------------------------
PROGRESS: 31.0%
| epoch  32 |   100/  269 batches | lr 0.00030 | ms/batch 77.66 | loss  3.58 | ppl    35.88 
| epoch  32 |   200/  269 batches | lr 0.00030 | ms/batch 76.35 | loss  3.56 | ppl    35.15 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 21.05s | valid loss  3.99 | valid ppl    54.29 | valid bpc    5.763
-----------------------------------------------------------------------------------------
PROGRESS: 32.0%
| epoch  33 |   100/  269 batches | lr 0.00030 | ms/batch 77.87 | loss  3.54 | ppl    34.63 
| epoch  33 |   200/  269 batches | lr 0.00030 | ms/batch 76.14 | loss  3.53 | ppl    34.26 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 21.05s | valid loss  3.96 | valid ppl    52.35 | valid bpc    5.710
-----------------------------------------------------------------------------------------
PROGRESS: 33.0%
| epoch  34 |   100/  269 batches | lr 0.00015 | ms/batch 77.71 | loss  3.46 | ppl    31.82 
| epoch  34 |   200/  269 batches | lr 0.00015 | ms/batch 76.26 | loss  3.40 | ppl    30.01 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 21.04s | valid loss  3.84 | valid ppl    46.48 | valid bpc    5.538
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 34.0%
| epoch  35 |   100/  269 batches | lr 0.00015 | ms/batch 78.20 | loss  3.38 | ppl    29.40 
| epoch  35 |   200/  269 batches | lr 0.00015 | ms/batch 75.90 | loss  3.36 | ppl    28.83 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 21.05s | valid loss  3.87 | valid ppl    47.92 | valid bpc    5.582
-----------------------------------------------------------------------------------------
PROGRESS: 35.0%
| epoch  36 |   100/  269 batches | lr 0.00015 | ms/batch 77.85 | loss  3.35 | ppl    28.56 
| epoch  36 |   200/  269 batches | lr 0.00015 | ms/batch 76.53 | loss  3.33 | ppl    27.82 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 21.02s | valid loss  3.82 | valid ppl    45.57 | valid bpc    5.510
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 36.0%
| epoch  37 |   100/  269 batches | lr 0.00015 | ms/batch 77.46 | loss  3.30 | ppl    27.05 
| epoch  37 |   200/  269 batches | lr 0.00015 | ms/batch 76.80 | loss  3.32 | ppl    27.75 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 21.05s | valid loss  3.81 | valid ppl    45.20 | valid bpc    5.498
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 37.0%
| epoch  38 |   100/  269 batches | lr 0.00015 | ms/batch 77.78 | loss  3.29 | ppl    26.82 
| epoch  38 |   200/  269 batches | lr 0.00015 | ms/batch 76.76 | loss  3.28 | ppl    26.53 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 21.07s | valid loss  3.93 | valid ppl    51.01 | valid bpc    5.673
-----------------------------------------------------------------------------------------
PROGRESS: 38.0%
| epoch  39 |   100/  269 batches | lr 0.00015 | ms/batch 78.58 | loss  3.27 | ppl    26.21 
| epoch  39 |   200/  269 batches | lr 0.00015 | ms/batch 76.00 | loss  3.26 | ppl    26.05 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 21.06s | valid loss  3.89 | valid ppl    48.68 | valid bpc    5.605
-----------------------------------------------------------------------------------------
PROGRESS: 39.0%
| epoch  40 |   100/  269 batches | lr 0.00015 | ms/batch 77.72 | loss  3.24 | ppl    25.54 
| epoch  40 |   200/  269 batches | lr 0.00015 | ms/batch 76.39 | loss  3.21 | ppl    24.81 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 21.05s | valid loss  3.79 | valid ppl    44.13 | valid bpc    5.464
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 40.0%
| epoch  41 |   100/  269 batches | lr 0.00015 | ms/batch 77.76 | loss  3.25 | ppl    25.66 
| epoch  41 |   200/  269 batches | lr 0.00015 | ms/batch 76.37 | loss  3.22 | ppl    24.94 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 21.05s | valid loss  3.82 | valid ppl    45.75 | valid bpc    5.516
-----------------------------------------------------------------------------------------
PROGRESS: 41.0%
| epoch  42 |   100/  269 batches | lr 0.00015 | ms/batch 77.61 | loss  3.21 | ppl    24.79 
| epoch  42 |   200/  269 batches | lr 0.00015 | ms/batch 76.45 | loss  3.19 | ppl    24.37 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 21.04s | valid loss  3.84 | valid ppl    46.51 | valid bpc    5.540
-----------------------------------------------------------------------------------------
PROGRESS: 42.0%
| epoch  43 |   100/  269 batches | lr 0.00015 | ms/batch 77.87 | loss  3.18 | ppl    24.00 
| epoch  43 |   200/  269 batches | lr 0.00015 | ms/batch 76.42 | loss  3.18 | ppl    23.97 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 21.06s | valid loss  3.85 | valid ppl    46.92 | valid bpc    5.552
-----------------------------------------------------------------------------------------
PROGRESS: 43.0%
| epoch  44 |   100/  269 batches | lr 0.00007 | ms/batch 78.05 | loss  3.15 | ppl    23.28 
| epoch  44 |   200/  269 batches | lr 0.00007 | ms/batch 76.70 | loss  3.12 | ppl    22.67 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 21.11s | valid loss  3.77 | valid ppl    43.45 | valid bpc    5.441
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 44.0%
| epoch  45 |   100/  269 batches | lr 0.00007 | ms/batch 77.57 | loss  3.10 | ppl    22.21 
| epoch  45 |   200/  269 batches | lr 0.00007 | ms/batch 76.23 | loss  3.07 | ppl    21.63 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 21.05s | valid loss  3.84 | valid ppl    46.59 | valid bpc    5.542
-----------------------------------------------------------------------------------------
PROGRESS: 45.0%
| epoch  46 |   100/  269 batches | lr 0.00007 | ms/batch 77.56 | loss  3.08 | ppl    21.70 
| epoch  46 |   200/  269 batches | lr 0.00007 | ms/batch 76.20 | loss  3.06 | ppl    21.28 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 21.05s | valid loss  3.80 | valid ppl    44.84 | valid bpc    5.487
-----------------------------------------------------------------------------------------
PROGRESS: 46.0%
| epoch  47 |   100/  269 batches | lr 0.00007 | ms/batch 77.47 | loss  3.07 | ppl    21.52 
| epoch  47 |   200/  269 batches | lr 0.00007 | ms/batch 76.16 | loss  3.05 | ppl    21.09 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 21.05s | valid loss  3.79 | valid ppl    44.07 | valid bpc    5.462
-----------------------------------------------------------------------------------------
PROGRESS: 47.0%
| epoch  48 |   100/  269 batches | lr 0.00004 | ms/batch 77.78 | loss  3.05 | ppl    21.13 
| epoch  48 |   200/  269 batches | lr 0.00004 | ms/batch 76.23 | loss  3.03 | ppl    20.70 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 21.05s | valid loss  3.76 | valid ppl    42.90 | valid bpc    5.423
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 48.0%
| epoch  49 |   100/  269 batches | lr 0.00004 | ms/batch 77.44 | loss  3.04 | ppl    20.86 
| epoch  49 |   200/  269 batches | lr 0.00004 | ms/batch 76.30 | loss  3.01 | ppl    20.31 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 21.05s | valid loss  3.77 | valid ppl    43.39 | valid bpc    5.439
-----------------------------------------------------------------------------------------
PROGRESS: 49.0%
| epoch  50 |   100/  269 batches | lr 0.00004 | ms/batch 78.21 | loss  3.02 | ppl    20.46 
| epoch  50 |   200/  269 batches | lr 0.00004 | ms/batch 76.27 | loss  2.99 | ppl    19.83 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 21.05s | valid loss  3.76 | valid ppl    42.86 | valid bpc    5.422
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 50.0%
| epoch  51 |   100/  269 batches | lr 0.00004 | ms/batch 77.38 | loss  3.00 | ppl    20.01 
| epoch  51 |   200/  269 batches | lr 0.00004 | ms/batch 76.96 | loss  3.00 | ppl    20.10 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 21.04s | valid loss  3.73 | valid ppl    41.72 | valid bpc    5.383
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 51.0%
| epoch  52 |   100/  269 batches | lr 0.00004 | ms/batch 77.47 | loss  3.00 | ppl    20.04 
| epoch  52 |   200/  269 batches | lr 0.00004 | ms/batch 76.51 | loss  2.97 | ppl    19.58 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 21.05s | valid loss  3.77 | valid ppl    43.35 | valid bpc    5.438
-----------------------------------------------------------------------------------------
PROGRESS: 52.0%
| epoch  53 |   100/  269 batches | lr 0.00004 | ms/batch 77.32 | loss  3.00 | ppl    19.99 
| epoch  53 |   200/  269 batches | lr 0.00004 | ms/batch 76.40 | loss  2.96 | ppl    19.35 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 21.04s | valid loss  3.76 | valid ppl    42.96 | valid bpc    5.425
-----------------------------------------------------------------------------------------
PROGRESS: 53.0%
| epoch  54 |   100/  269 batches | lr 0.00004 | ms/batch 77.67 | loss  2.99 | ppl    19.84 
| epoch  54 |   200/  269 batches | lr 0.00004 | ms/batch 75.88 | loss  2.95 | ppl    19.06 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 21.03s | valid loss  3.75 | valid ppl    42.59 | valid bpc    5.412
-----------------------------------------------------------------------------------------
PROGRESS: 54.0%
| epoch  55 |   100/  269 batches | lr 0.00002 | ms/batch 77.90 | loss  2.97 | ppl    19.46 
| epoch  55 |   200/  269 batches | lr 0.00002 | ms/batch 75.98 | loss  2.92 | ppl    18.61 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 21.06s | valid loss  3.78 | valid ppl    43.83 | valid bpc    5.454
-----------------------------------------------------------------------------------------
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  269 batches | lr 0.00002 | ms/batch 77.35 | loss  2.97 | ppl    19.47 
| epoch  56 |   200/  269 batches | lr 0.00002 | ms/batch 76.46 | loss  2.95 | ppl    19.07 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 21.02s | valid loss  3.81 | valid ppl    45.00 | valid bpc    5.492
-----------------------------------------------------------------------------------------
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  269 batches | lr 0.00002 | ms/batch 78.21 | loss  2.96 | ppl    19.22 
| epoch  57 |   200/  269 batches | lr 0.00002 | ms/batch 75.96 | loss  2.95 | ppl    19.13 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 21.06s | valid loss  3.79 | valid ppl    44.13 | valid bpc    5.464
-----------------------------------------------------------------------------------------
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  269 batches | lr 0.00001 | ms/batch 78.03 | loss  2.97 | ppl    19.47 
| epoch  58 |   200/  269 batches | lr 0.00001 | ms/batch 75.88 | loss  2.92 | ppl    18.57 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 21.06s | valid loss  3.76 | valid ppl    42.96 | valid bpc    5.425
-----------------------------------------------------------------------------------------
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  269 batches | lr 0.00001 | ms/batch 77.89 | loss  2.94 | ppl    18.83 
| epoch  59 |   200/  269 batches | lr 0.00001 | ms/batch 76.36 | loss  2.93 | ppl    18.75 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 21.06s | valid loss  3.77 | valid ppl    43.39 | valid bpc    5.439
-----------------------------------------------------------------------------------------
PROGRESS: 59.0%
| epoch  60 |   100/  269 batches | lr 0.00001 | ms/batch 77.80 | loss  2.96 | ppl    19.26 
| epoch  60 |   200/  269 batches | lr 0.00001 | ms/batch 76.38 | loss  2.90 | ppl    18.22 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 21.13s | valid loss  3.76 | valid ppl    43.08 | valid bpc    5.429
-----------------------------------------------------------------------------------------
PROGRESS: 60.0%
| epoch  61 |   100/  269 batches | lr 0.00000 | ms/batch 77.62 | loss  2.97 | ppl    19.40 
| epoch  61 |   200/  269 batches | lr 0.00000 | ms/batch 76.75 | loss  2.92 | ppl    18.56 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 21.05s | valid loss  3.79 | valid ppl    44.47 | valid bpc    5.475
-----------------------------------------------------------------------------------------
PROGRESS: 61.0%
| epoch  62 |   100/  269 batches | lr 0.00000 | ms/batch 77.89 | loss  2.93 | ppl    18.78 
| epoch  62 |   200/  269 batches | lr 0.00000 | ms/batch 76.44 | loss  2.90 | ppl    18.19 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 21.05s | valid loss  3.78 | valid ppl    44.00 | valid bpc    5.459
-----------------------------------------------------------------------------------------
PROGRESS: 62.0%
| epoch  63 |   100/  269 batches | lr 0.00000 | ms/batch 77.88 | loss  2.93 | ppl    18.71 
| epoch  63 |   200/  269 batches | lr 0.00000 | ms/batch 76.28 | loss  2.90 | ppl    18.25 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 21.06s | valid loss  3.80 | valid ppl    44.57 | valid bpc    5.478
-----------------------------------------------------------------------------------------
PROGRESS: 63.0%
| epoch  64 |   100/  269 batches | lr 0.00000 | ms/batch 77.25 | loss  2.92 | ppl    18.59 
| epoch  64 |   200/  269 batches | lr 0.00000 | ms/batch 76.67 | loss  2.93 | ppl    18.78 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 21.05s | valid loss  3.80 | valid ppl    44.52 | valid bpc    5.476
-----------------------------------------------------------------------------------------
PROGRESS: 64.0%
| epoch  65 |   100/  269 batches | lr 0.00000 | ms/batch 77.99 | loss  2.94 | ppl    18.99 
| epoch  65 |   200/  269 batches | lr 0.00000 | ms/batch 76.55 | loss  2.90 | ppl    18.26 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 21.11s | valid loss  3.75 | valid ppl    42.50 | valid bpc    5.409
-----------------------------------------------------------------------------------------
PROGRESS: 65.0%
| epoch  66 |   100/  269 batches | lr 0.00000 | ms/batch 77.96 | loss  2.94 | ppl    18.85 
| epoch  66 |   200/  269 batches | lr 0.00000 | ms/batch 75.68 | loss  2.90 | ppl    18.17 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 21.02s | valid loss  3.69 | valid ppl    40.01 | valid bpc    5.322
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 66.0%
| epoch  67 |   100/  269 batches | lr 0.00000 | ms/batch 77.84 | loss  2.93 | ppl    18.80 
| epoch  67 |   200/  269 batches | lr 0.00000 | ms/batch 76.11 | loss  2.90 | ppl    18.24 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 21.04s | valid loss  3.79 | valid ppl    44.44 | valid bpc    5.474
-----------------------------------------------------------------------------------------
PROGRESS: 67.0%
| epoch  68 |   100/  269 batches | lr 0.00000 | ms/batch 78.01 | loss  2.95 | ppl    19.07 
| epoch  68 |   200/  269 batches | lr 0.00000 | ms/batch 76.09 | loss  2.89 | ppl    18.08 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 21.05s | valid loss  3.77 | valid ppl    43.37 | valid bpc    5.439
-----------------------------------------------------------------------------------------
PROGRESS: 68.0%
| epoch  69 |   100/  269 batches | lr 0.00000 | ms/batch 77.78 | loss  2.93 | ppl    18.67 
| epoch  69 |   200/  269 batches | lr 0.00000 | ms/batch 76.54 | loss  2.90 | ppl    18.19 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 21.11s | valid loss  3.78 | valid ppl    43.92 | valid bpc    5.457
-----------------------------------------------------------------------------------------
PROGRESS: 69.0%
| epoch  70 |   100/  269 batches | lr 0.00000 | ms/batch 77.58 | loss  2.95 | ppl    19.07 
| epoch  70 |   200/  269 batches | lr 0.00000 | ms/batch 76.53 | loss  2.91 | ppl    18.36 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 21.04s | valid loss  3.72 | valid ppl    41.16 | valid bpc    5.363
-----------------------------------------------------------------------------------------
PROGRESS: 70.0%
| epoch  71 |   100/  269 batches | lr 0.00000 | ms/batch 77.52 | loss  2.93 | ppl    18.78 
| epoch  71 |   200/  269 batches | lr 0.00000 | ms/batch 76.37 | loss  2.90 | ppl    18.18 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 21.01s | valid loss  3.79 | valid ppl    44.22 | valid bpc    5.467
-----------------------------------------------------------------------------------------
PROGRESS: 71.0%
| epoch  72 |   100/  269 batches | lr 0.00000 | ms/batch 77.43 | loss  2.92 | ppl    18.57 
| epoch  72 |   200/  269 batches | lr 0.00000 | ms/batch 76.52 | loss  2.89 | ppl    18.06 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 21.05s | valid loss  3.81 | valid ppl    45.12 | valid bpc    5.496
-----------------------------------------------------------------------------------------
PROGRESS: 72.0%
| epoch  73 |   100/  269 batches | lr 0.00000 | ms/batch 77.68 | loss  2.94 | ppl    18.91 
| epoch  73 |   200/  269 batches | lr 0.00000 | ms/batch 76.50 | loss  2.90 | ppl    18.25 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 21.06s | valid loss  3.78 | valid ppl    43.83 | valid bpc    5.454
-----------------------------------------------------------------------------------------
PROGRESS: 73.0%
| epoch  74 |   100/  269 batches | lr 0.00000 | ms/batch 78.01 | loss  2.94 | ppl    18.99 
| epoch  74 |   200/  269 batches | lr 0.00000 | ms/batch 76.92 | loss  2.90 | ppl    18.14 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 21.12s | valid loss  3.74 | valid ppl    42.13 | valid bpc    5.397
-----------------------------------------------------------------------------------------
PROGRESS: 74.0%
| epoch  75 |   100/  269 batches | lr 0.00000 | ms/batch 78.10 | loss  2.93 | ppl    18.76 
| epoch  75 |   200/  269 batches | lr 0.00000 | ms/batch 76.21 | loss  2.89 | ppl    18.03 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 21.04s | valid loss  3.75 | valid ppl    42.65 | valid bpc    5.415
-----------------------------------------------------------------------------------------
PROGRESS: 75.0%
| epoch  76 |   100/  269 batches | lr 0.00000 | ms/batch 77.45 | loss  2.95 | ppl    19.03 
| epoch  76 |   200/  269 batches | lr 0.00000 | ms/batch 76.61 | loss  2.90 | ppl    18.11 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 21.05s | valid loss  3.70 | valid ppl    40.48 | valid bpc    5.339
-----------------------------------------------------------------------------------------
PROGRESS: 76.0%
| epoch  77 |   100/  269 batches | lr 0.00000 | ms/batch 77.89 | loss  2.93 | ppl    18.76 
| epoch  77 |   200/  269 batches | lr 0.00000 | ms/batch 76.45 | loss  2.90 | ppl    18.13 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 21.05s | valid loss  3.72 | valid ppl    41.45 | valid bpc    5.373
-----------------------------------------------------------------------------------------
PROGRESS: 77.0%
| epoch  78 |   100/  269 batches | lr 0.00000 | ms/batch 77.23 | loss  2.93 | ppl    18.75 
| epoch  78 |   200/  269 batches | lr 0.00000 | ms/batch 76.46 | loss  2.89 | ppl    18.02 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 21.02s | valid loss  3.76 | valid ppl    42.90 | valid bpc    5.423
-----------------------------------------------------------------------------------------
PROGRESS: 78.0%
| epoch  79 |   100/  269 batches | lr 0.00000 | ms/batch 77.26 | loss  2.92 | ppl    18.61 
| epoch  79 |   200/  269 batches | lr 0.00000 | ms/batch 76.42 | loss  2.91 | ppl    18.36 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 21.03s | valid loss  3.75 | valid ppl    42.32 | valid bpc    5.403
-----------------------------------------------------------------------------------------
PROGRESS: 79.0%
| epoch  80 |   100/  269 batches | lr 0.00000 | ms/batch 77.50 | loss  2.94 | ppl    18.93 
| epoch  80 |   200/  269 batches | lr 0.00000 | ms/batch 76.68 | loss  2.92 | ppl    18.48 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 21.05s | valid loss  3.76 | valid ppl    43.04 | valid bpc    5.428
-----------------------------------------------------------------------------------------
PROGRESS: 80.0%
| epoch  81 |   100/  269 batches | lr 0.00000 | ms/batch 77.95 | loss  2.94 | ppl    18.86 
| epoch  81 |   200/  269 batches | lr 0.00000 | ms/batch 76.10 | loss  2.90 | ppl    18.18 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 21.06s | valid loss  3.79 | valid ppl    44.38 | valid bpc    5.472
-----------------------------------------------------------------------------------------
PROGRESS: 81.0%
| epoch  82 |   100/  269 batches | lr 0.00000 | ms/batch 78.07 | loss  2.93 | ppl    18.81 
| epoch  82 |   200/  269 batches | lr 0.00000 | ms/batch 76.42 | loss  2.89 | ppl    18.08 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 21.05s | valid loss  3.76 | valid ppl    42.91 | valid bpc    5.423
-----------------------------------------------------------------------------------------
PROGRESS: 82.0%
| epoch  83 |   100/  269 batches | lr 0.00000 | ms/batch 77.88 | loss  2.92 | ppl    18.60 
| epoch  83 |   200/  269 batches | lr 0.00000 | ms/batch 76.23 | loss  2.90 | ppl    18.22 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 21.05s | valid loss  3.74 | valid ppl    41.97 | valid bpc    5.391
-----------------------------------------------------------------------------------------
PROGRESS: 83.0%
| epoch  84 |   100/  269 batches | lr 0.00000 | ms/batch 77.76 | loss  2.94 | ppl    18.90 
| epoch  84 |   200/  269 batches | lr 0.00000 | ms/batch 76.57 | loss  2.91 | ppl    18.42 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 21.06s | valid loss  3.76 | valid ppl    43.12 | valid bpc    5.430
-----------------------------------------------------------------------------------------
PROGRESS: 84.0%
| epoch  85 |   100/  269 batches | lr 0.00000 | ms/batch 77.96 | loss  2.93 | ppl    18.66 
| epoch  85 |   200/  269 batches | lr 0.00000 | ms/batch 76.30 | loss  2.90 | ppl    18.17 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 21.05s | valid loss  3.73 | valid ppl    41.75 | valid bpc    5.384
-----------------------------------------------------------------------------------------
PROGRESS: 85.0%
| epoch  86 |   100/  269 batches | lr 0.00000 | ms/batch 77.55 | loss  2.93 | ppl    18.67 
| epoch  86 |   200/  269 batches | lr 0.00000 | ms/batch 76.46 | loss  2.89 | ppl    18.07 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 21.03s | valid loss  3.78 | valid ppl    44.02 | valid bpc    5.460
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  269 batches | lr 0.00000 | ms/batch 77.67 | loss  2.93 | ppl    18.70 
| epoch  87 |   200/  269 batches | lr 0.00000 | ms/batch 76.33 | loss  2.90 | ppl    18.26 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 21.03s | valid loss  3.74 | valid ppl    42.09 | valid bpc    5.395
-----------------------------------------------------------------------------------------
PROGRESS: 87.0%
| epoch  88 |   100/  269 batches | lr 0.00000 | ms/batch 77.72 | loss  2.93 | ppl    18.78 
| epoch  88 |   200/  269 batches | lr 0.00000 | ms/batch 75.69 | loss  2.91 | ppl    18.44 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 21.02s | valid loss  3.77 | valid ppl    43.38 | valid bpc    5.439
-----------------------------------------------------------------------------------------
PROGRESS: 88.0%
| epoch  89 |   100/  269 batches | lr 0.00000 | ms/batch 77.92 | loss  2.93 | ppl    18.76 
| epoch  89 |   200/  269 batches | lr 0.00000 | ms/batch 76.60 | loss  2.89 | ppl    17.95 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 21.06s | valid loss  3.76 | valid ppl    43.16 | valid bpc    5.432
-----------------------------------------------------------------------------------------
PROGRESS: 89.0%
| epoch  90 |   100/  269 batches | lr 0.00000 | ms/batch 77.79 | loss  2.93 | ppl    18.70 
| epoch  90 |   200/  269 batches | lr 0.00000 | ms/batch 76.61 | loss  2.90 | ppl    18.13 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 21.05s | valid loss  3.78 | valid ppl    43.75 | valid bpc    5.451
-----------------------------------------------------------------------------------------
PROGRESS: 90.0%
| epoch  91 |   100/  269 batches | lr 0.00000 | ms/batch 77.62 | loss  2.91 | ppl    18.40 
| epoch  91 |   200/  269 batches | lr 0.00000 | ms/batch 76.61 | loss  2.91 | ppl    18.29 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 21.06s | valid loss  3.77 | valid ppl    43.24 | valid bpc    5.434
-----------------------------------------------------------------------------------------
PROGRESS: 91.0%
| epoch  92 |   100/  269 batches | lr 0.00000 | ms/batch 78.17 | loss  2.92 | ppl    18.59 
| epoch  92 |   200/  269 batches | lr 0.00000 | ms/batch 76.01 | loss  2.89 | ppl    17.96 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 21.06s | valid loss  3.78 | valid ppl    43.97 | valid bpc    5.458
-----------------------------------------------------------------------------------------
PROGRESS: 92.0%
| epoch  93 |   100/  269 batches | lr 0.00000 | ms/batch 77.84 | loss  2.91 | ppl    18.36 
| epoch  93 |   200/  269 batches | lr 0.00000 | ms/batch 76.54 | loss  2.92 | ppl    18.56 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 21.06s | valid loss  3.75 | valid ppl    42.34 | valid bpc    5.404
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  269 batches | lr 0.00000 | ms/batch 77.97 | loss  2.94 | ppl    18.98 
| epoch  94 |   200/  269 batches | lr 0.00000 | ms/batch 76.24 | loss  2.91 | ppl    18.30 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 21.06s | valid loss  3.77 | valid ppl    43.19 | valid bpc    5.432
-----------------------------------------------------------------------------------------
PROGRESS: 94.0%
| epoch  95 |   100/  269 batches | lr 0.00000 | ms/batch 77.61 | loss  2.91 | ppl    18.42 
| epoch  95 |   200/  269 batches | lr 0.00000 | ms/batch 76.37 | loss  2.91 | ppl    18.40 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 21.02s | valid loss  3.83 | valid ppl    45.89 | valid bpc    5.520
-----------------------------------------------------------------------------------------
PROGRESS: 95.0%
| epoch  96 |   100/  269 batches | lr 0.00000 | ms/batch 78.29 | loss  2.93 | ppl    18.73 
| epoch  96 |   200/  269 batches | lr 0.00000 | ms/batch 76.22 | loss  2.90 | ppl    18.12 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 21.06s | valid loss  3.76 | valid ppl    43.09 | valid bpc    5.429
-----------------------------------------------------------------------------------------
PROGRESS: 96.0%
| epoch  97 |   100/  269 batches | lr 0.00000 | ms/batch 77.64 | loss  2.91 | ppl    18.45 
| epoch  97 |   200/  269 batches | lr 0.00000 | ms/batch 76.66 | loss  2.90 | ppl    18.18 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 21.06s | valid loss  3.78 | valid ppl    43.97 | valid bpc    5.458
-----------------------------------------------------------------------------------------
PROGRESS: 97.0%
| epoch  98 |   100/  269 batches | lr 0.00000 | ms/batch 78.08 | loss  2.92 | ppl    18.59 
| epoch  98 |   200/  269 batches | lr 0.00000 | ms/batch 76.12 | loss  2.91 | ppl    18.39 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 21.06s | valid loss  3.74 | valid ppl    41.92 | valid bpc    5.389
-----------------------------------------------------------------------------------------
PROGRESS: 98.0%
| epoch  99 |   100/  269 batches | lr 0.00000 | ms/batch 77.82 | loss  2.94 | ppl    18.89 
| epoch  99 |   200/  269 batches | lr 0.00000 | ms/batch 75.93 | loss  2.90 | ppl    18.25 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 21.03s | valid loss  3.74 | valid ppl    42.26 | valid bpc    5.401
-----------------------------------------------------------------------------------------
PROGRESS: 99.0%
| epoch 100 |   100/  269 batches | lr 0.00000 | ms/batch 78.05 | loss  2.94 | ppl    18.89 
| epoch 100 |   200/  269 batches | lr 0.00000 | ms/batch 76.40 | loss  2.91 | ppl    18.35 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 21.07s | valid loss  3.79 | valid ppl    44.38 | valid bpc    5.472
-----------------------------------------------------------------------------------------
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  3.81 | test ppl    45.19 | test bpc    5.498
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.4355, Mean Reca: 0.6112, Mean F1: 0.5047, Mean Subword_Reca: 0.8068
-----------------------------------------------------------------------------------------
=========================================================================================
Loading dataset...
Using subword tokenizer...
Number of tokens:  8000
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer', nhid=512, nlayers=8, front_layers=2, rear_layers=6, subword='omarmomen/ptb_filtered_lowcase_bpe_tokenizer_8', n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=5555, nonmono=5, cuda=True, log_interval=100, save='trained_models/subword_5555.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 37448132
Model architecture: StructFormer(
  (drop): Dropout(p=0.1, inplace=False)
  (emb): Embedding(8000, 512)
  (pos_emb): Embedding(500, 512)
  (layers): ModuleList(
    (0-7): 8 x TransformerLayer(
      (self_attn): MultiheadAttention(
        (drop): Dropout(p=0, inplace=False)
        (q_proj): Linear(in_features=512, out_features=512, bias=True)
        (k_proj): Linear(in_features=512, out_features=512, bias=True)
        (v_proj): Linear(in_features=512, out_features=512, bias=True)
        (out_proj): Linear(in_features=512, out_features=512, bias=True)
      )
      (feedforward): Sequential(
        (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (1): Linear(in_features=512, out_features=2048, bias=True)
        (2): LeakyReLU(negative_slope=0.01)
        (3): Dropout(p=0.1, inplace=False)
        (4): Linear(in_features=2048, out_features=512, bias=True)
      )
      (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      (dropout1): Dropout(p=0.1, inplace=False)
      (dropout2): Dropout(p=0.1, inplace=False)
    )
  )
  (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  (output_layer): Linear(in_features=512, out_features=8000, bias=True)
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  269 batches | lr 0.00030 | ms/batch 81.29 | loss  7.74 | ppl  2306.57 
| epoch   1 |   200/  269 batches | lr 0.00030 | ms/batch 75.61 | loss  7.18 | ppl  1312.13 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 21.28s | valid loss  6.68 | valid ppl   796.15 | valid bpc    9.637
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  269 batches | lr 0.00030 | ms/batch 77.27 | loss  6.79 | ppl   888.01 
| epoch   2 |   200/  269 batches | lr 0.00030 | ms/batch 75.69 | loss  6.48 | ppl   650.09 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 20.87s | valid loss  6.08 | valid ppl   437.84 | valid bpc    8.774
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  269 batches | lr 0.00030 | ms/batch 77.30 | loss  6.24 | ppl   511.06 
| epoch   3 |   200/  269 batches | lr 0.00030 | ms/batch 76.29 | loss  6.02 | ppl   411.10 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 20.96s | valid loss  5.66 | valid ppl   286.31 | valid bpc    8.161
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  269 batches | lr 0.00030 | ms/batch 77.83 | loss  5.83 | ppl   340.97 
| epoch   4 |   200/  269 batches | lr 0.00030 | ms/batch 76.03 | loss  5.72 | ppl   305.79 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 21.01s | valid loss  5.43 | valid ppl   228.89 | valid bpc    7.839
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  269 batches | lr 0.00030 | ms/batch 77.40 | loss  5.57 | ppl   262.94 
| epoch   5 |   200/  269 batches | lr 0.00030 | ms/batch 76.38 | loss  5.49 | ppl   241.38 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 21.02s | valid loss  5.24 | valid ppl   189.07 | valid bpc    7.563
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  269 batches | lr 0.00030 | ms/batch 77.83 | loss  5.38 | ppl   217.54 
| epoch   6 |   200/  269 batches | lr 0.00030 | ms/batch 76.04 | loss  5.27 | ppl   195.14 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 21.04s | valid loss  5.11 | valid ppl   165.90 | valid bpc    7.374
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  269 batches | lr 0.00030 | ms/batch 77.39 | loss  5.20 | ppl   181.49 
| epoch   7 |   200/  269 batches | lr 0.00030 | ms/batch 76.85 | loss  5.14 | ppl   171.54 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 21.05s | valid loss  4.90 | valid ppl   134.31 | valid bpc    7.069
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  269 batches | lr 0.00030 | ms/batch 77.50 | loss  5.03 | ppl   153.56 
| epoch   8 |   200/  269 batches | lr 0.00030 | ms/batch 76.71 | loss  5.00 | ppl   147.86 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 21.05s | valid loss  4.84 | valid ppl   126.02 | valid bpc    6.977
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 8.0%
| epoch   9 |   100/  269 batches | lr 0.00030 | ms/batch 77.57 | loss  4.90 | ppl   134.61 
| epoch   9 |   200/  269 batches | lr 0.00030 | ms/batch 76.41 | loss  4.85 | ppl   128.11 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 21.05s | valid loss  4.72 | valid ppl   112.40 | valid bpc    6.813
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  269 batches | lr 0.00030 | ms/batch 77.85 | loss  4.79 | ppl   120.18 
| epoch  10 |   200/  269 batches | lr 0.00030 | ms/batch 76.27 | loss  4.72 | ppl   111.83 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 21.05s | valid loss  4.57 | valid ppl    96.98 | valid bpc    6.600
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  269 batches | lr 0.00030 | ms/batch 77.63 | loss  4.66 | ppl   105.59 
| epoch  11 |   200/  269 batches | lr 0.00030 | ms/batch 75.99 | loss  4.60 | ppl    99.50 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 21.06s | valid loss  4.51 | valid ppl    90.62 | valid bpc    6.502
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  269 batches | lr 0.00030 | ms/batch 77.98 | loss  4.56 | ppl    95.35 
| epoch  12 |   200/  269 batches | lr 0.00030 | ms/batch 76.35 | loss  4.49 | ppl    89.54 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 21.06s | valid loss  4.47 | valid ppl    86.95 | valid bpc    6.442
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 12.0%
| epoch  13 |   100/  269 batches | lr 0.00030 | ms/batch 77.83 | loss  4.47 | ppl    87.45 
| epoch  13 |   200/  269 batches | lr 0.00030 | ms/batch 76.63 | loss  4.40 | ppl    81.56 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 21.06s | valid loss  4.36 | valid ppl    78.23 | valid bpc    6.290
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 13.0%
| epoch  14 |   100/  269 batches | lr 0.00030 | ms/batch 77.44 | loss  4.35 | ppl    77.45 
| epoch  14 |   200/  269 batches | lr 0.00030 | ms/batch 76.63 | loss  4.34 | ppl    77.01 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 21.05s | valid loss  4.36 | valid ppl    78.10 | valid bpc    6.287
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  269 batches | lr 0.00030 | ms/batch 77.60 | loss  4.32 | ppl    75.35 
| epoch  15 |   200/  269 batches | lr 0.00030 | ms/batch 76.34 | loss  4.27 | ppl    71.55 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 21.04s | valid loss  4.32 | valid ppl    74.86 | valid bpc    6.226
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 15.0%
| epoch  16 |   100/  269 batches | lr 0.00030 | ms/batch 77.67 | loss  4.22 | ppl    68.23 
| epoch  16 |   200/  269 batches | lr 0.00030 | ms/batch 76.31 | loss  4.18 | ppl    65.33 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 21.05s | valid loss  4.26 | valid ppl    70.57 | valid bpc    6.141
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 16.0%
| epoch  17 |   100/  269 batches | lr 0.00030 | ms/batch 77.87 | loss  4.17 | ppl    64.99 
| epoch  17 |   200/  269 batches | lr 0.00030 | ms/batch 76.09 | loss  4.13 | ppl    62.46 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 21.05s | valid loss  4.16 | valid ppl    64.13 | valid bpc    6.003
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 17.0%
| epoch  18 |   100/  269 batches | lr 0.00030 | ms/batch 77.74 | loss  4.12 | ppl    61.32 
| epoch  18 |   200/  269 batches | lr 0.00030 | ms/batch 76.73 | loss  4.08 | ppl    59.15 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 21.06s | valid loss  4.18 | valid ppl    65.57 | valid bpc    6.035
-----------------------------------------------------------------------------------------
PROGRESS: 18.0%
| epoch  19 |   100/  269 batches | lr 0.00030 | ms/batch 78.20 | loss  4.03 | ppl    56.16 
| epoch  19 |   200/  269 batches | lr 0.00030 | ms/batch 76.35 | loss  4.03 | ppl    56.44 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 21.05s | valid loss  4.13 | valid ppl    62.08 | valid bpc    5.956
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 19.0%
| epoch  20 |   100/  269 batches | lr 0.00030 | ms/batch 77.93 | loss  4.00 | ppl    54.82 
| epoch  20 |   200/  269 batches | lr 0.00030 | ms/batch 76.38 | loss  3.96 | ppl    52.56 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 21.06s | valid loss  4.12 | valid ppl    61.59 | valid bpc    5.945
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 20.0%
| epoch  21 |   100/  269 batches | lr 0.00030 | ms/batch 77.80 | loss  3.91 | ppl    50.11 
| epoch  21 |   200/  269 batches | lr 0.00030 | ms/batch 76.50 | loss  3.91 | ppl    49.94 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 21.06s | valid loss  4.08 | valid ppl    59.37 | valid bpc    5.892
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 21.0%
| epoch  22 |   100/  269 batches | lr 0.00030 | ms/batch 77.81 | loss  3.86 | ppl    47.61 
| epoch  22 |   200/  269 batches | lr 0.00030 | ms/batch 75.99 | loss  3.87 | ppl    48.17 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 21.05s | valid loss  4.08 | valid ppl    59.15 | valid bpc    5.886
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 22.0%
| epoch  23 |   100/  269 batches | lr 0.00030 | ms/batch 77.28 | loss  3.84 | ppl    46.49 
| epoch  23 |   200/  269 batches | lr 0.00030 | ms/batch 76.59 | loss  3.82 | ppl    45.76 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 21.06s | valid loss  4.03 | valid ppl    56.23 | valid bpc    5.813
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 23.0%
| epoch  24 |   100/  269 batches | lr 0.00030 | ms/batch 77.77 | loss  3.79 | ppl    44.19 
| epoch  24 |   200/  269 batches | lr 0.00030 | ms/batch 76.38 | loss  3.78 | ppl    43.88 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 21.05s | valid loss  4.04 | valid ppl    57.06 | valid bpc    5.834
-----------------------------------------------------------------------------------------
PROGRESS: 24.0%
| epoch  25 |   100/  269 batches | lr 0.00030 | ms/batch 77.78 | loss  3.78 | ppl    43.73 
| epoch  25 |   200/  269 batches | lr 0.00030 | ms/batch 76.70 | loss  3.74 | ppl    42.24 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 21.07s | valid loss  4.01 | valid ppl    55.36 | valid bpc    5.791
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 25.0%
| epoch  26 |   100/  269 batches | lr 0.00030 | ms/batch 77.50 | loss  3.72 | ppl    41.28 
| epoch  26 |   200/  269 batches | lr 0.00030 | ms/batch 76.59 | loss  3.70 | ppl    40.37 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 21.07s | valid loss  3.99 | valid ppl    53.93 | valid bpc    5.753
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 26.0%
| epoch  27 |   100/  269 batches | lr 0.00030 | ms/batch 77.97 | loss  3.68 | ppl    39.65 
| epoch  27 |   200/  269 batches | lr 0.00030 | ms/batch 76.11 | loss  3.66 | ppl    38.79 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 21.05s | valid loss  3.94 | valid ppl    51.37 | valid bpc    5.683
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 27.0%
| epoch  28 |   100/  269 batches | lr 0.00030 | ms/batch 77.72 | loss  3.63 | ppl    37.73 
| epoch  28 |   200/  269 batches | lr 0.00030 | ms/batch 76.32 | loss  3.64 | ppl    38.02 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 21.05s | valid loss  3.93 | valid ppl    51.14 | valid bpc    5.676
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  269 batches | lr 0.00030 | ms/batch 77.86 | loss  3.60 | ppl    36.60 
| epoch  29 |   200/  269 batches | lr 0.00030 | ms/batch 76.84 | loss  3.59 | ppl    36.15 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 21.08s | valid loss  3.90 | valid ppl    49.60 | valid bpc    5.632
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  269 batches | lr 0.00030 | ms/batch 77.73 | loss  3.57 | ppl    35.67 
| epoch  30 |   200/  269 batches | lr 0.00030 | ms/batch 76.53 | loss  3.56 | ppl    35.10 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 21.07s | valid loss  3.90 | valid ppl    49.43 | valid bpc    5.627
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 30.0%
| epoch  31 |   100/  269 batches | lr 0.00030 | ms/batch 77.72 | loss  3.52 | ppl    33.82 
| epoch  31 |   200/  269 batches | lr 0.00030 | ms/batch 76.00 | loss  3.53 | ppl    34.20 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 21.06s | valid loss  3.92 | valid ppl    50.32 | valid bpc    5.653
-----------------------------------------------------------------------------------------
PROGRESS: 31.0%
| epoch  32 |   100/  269 batches | lr 0.00030 | ms/batch 77.76 | loss  3.50 | ppl    33.05 
| epoch  32 |   200/  269 batches | lr 0.00030 | ms/batch 76.04 | loss  3.49 | ppl    32.86 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 21.06s | valid loss  3.89 | valid ppl    48.93 | valid bpc    5.613
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 32.0%
| epoch  33 |   100/  269 batches | lr 0.00030 | ms/batch 77.43 | loss  3.47 | ppl    32.00 
| epoch  33 |   200/  269 batches | lr 0.00030 | ms/batch 76.66 | loss  3.47 | ppl    32.15 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 21.05s | valid loss  3.90 | valid ppl    49.37 | valid bpc    5.626
-----------------------------------------------------------------------------------------
PROGRESS: 33.0%
| epoch  34 |   100/  269 batches | lr 0.00030 | ms/batch 77.78 | loss  3.45 | ppl    31.66 
| epoch  34 |   200/  269 batches | lr 0.00030 | ms/batch 76.62 | loss  3.43 | ppl    30.99 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 21.06s | valid loss  3.90 | valid ppl    49.18 | valid bpc    5.620
-----------------------------------------------------------------------------------------
PROGRESS: 34.0%
| epoch  35 |   100/  269 batches | lr 0.00030 | ms/batch 77.63 | loss  3.43 | ppl    30.89 
| epoch  35 |   200/  269 batches | lr 0.00030 | ms/batch 76.51 | loss  3.41 | ppl    30.35 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 21.07s | valid loss  3.90 | valid ppl    49.29 | valid bpc    5.623
-----------------------------------------------------------------------------------------
PROGRESS: 35.0%
| epoch  36 |   100/  269 batches | lr 0.00015 | ms/batch 77.62 | loss  3.33 | ppl    27.91 
| epoch  36 |   200/  269 batches | lr 0.00015 | ms/batch 76.77 | loss  3.31 | ppl    27.32 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 21.06s | valid loss  3.79 | valid ppl    44.40 | valid bpc    5.473
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 36.0%
| epoch  37 |   100/  269 batches | lr 0.00015 | ms/batch 78.21 | loss  3.26 | ppl    25.92 
| epoch  37 |   200/  269 batches | lr 0.00015 | ms/batch 75.99 | loss  3.24 | ppl    25.46 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 21.06s | valid loss  3.80 | valid ppl    44.91 | valid bpc    5.489
-----------------------------------------------------------------------------------------
PROGRESS: 37.0%
| epoch  38 |   100/  269 batches | lr 0.00015 | ms/batch 77.68 | loss  3.23 | ppl    25.38 
| epoch  38 |   200/  269 batches | lr 0.00015 | ms/batch 76.92 | loss  3.20 | ppl    24.53 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 21.08s | valid loss  3.79 | valid ppl    44.41 | valid bpc    5.473
-----------------------------------------------------------------------------------------
PROGRESS: 38.0%
| epoch  39 |   100/  269 batches | lr 0.00015 | ms/batch 77.87 | loss  3.20 | ppl    24.63 
| epoch  39 |   200/  269 batches | lr 0.00015 | ms/batch 76.33 | loss  3.18 | ppl    23.95 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 21.05s | valid loss  3.78 | valid ppl    43.73 | valid bpc    5.450
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 39.0%
| epoch  40 |   100/  269 batches | lr 0.00015 | ms/batch 78.59 | loss  3.18 | ppl    23.97 
| epoch  40 |   200/  269 batches | lr 0.00015 | ms/batch 76.23 | loss  3.16 | ppl    23.55 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 21.07s | valid loss  3.79 | valid ppl    44.17 | valid bpc    5.465
-----------------------------------------------------------------------------------------
PROGRESS: 40.0%
| epoch  41 |   100/  269 batches | lr 0.00015 | ms/batch 77.69 | loss  3.15 | ppl    23.26 
| epoch  41 |   200/  269 batches | lr 0.00015 | ms/batch 76.20 | loss  3.14 | ppl    23.00 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 21.06s | valid loss  3.75 | valid ppl    42.70 | valid bpc    5.416
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 41.0%
| epoch  42 |   100/  269 batches | lr 0.00015 | ms/batch 77.87 | loss  3.12 | ppl    22.65 
| epoch  42 |   200/  269 batches | lr 0.00015 | ms/batch 76.20 | loss  3.11 | ppl    22.43 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 21.07s | valid loss  3.81 | valid ppl    45.35 | valid bpc    5.503
-----------------------------------------------------------------------------------------
PROGRESS: 42.0%
| epoch  43 |   100/  269 batches | lr 0.00015 | ms/batch 78.01 | loss  3.13 | ppl    22.91 
| epoch  43 |   200/  269 batches | lr 0.00015 | ms/batch 76.56 | loss  3.10 | ppl    22.13 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 21.08s | valid loss  3.76 | valid ppl    42.99 | valid bpc    5.426
-----------------------------------------------------------------------------------------
PROGRESS: 43.0%
| epoch  44 |   100/  269 batches | lr 0.00015 | ms/batch 77.76 | loss  3.08 | ppl    21.77 
| epoch  44 |   200/  269 batches | lr 0.00015 | ms/batch 76.11 | loss  3.06 | ppl    21.35 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 21.04s | valid loss  3.79 | valid ppl    44.08 | valid bpc    5.462
-----------------------------------------------------------------------------------------
PROGRESS: 44.0%
| epoch  45 |   100/  269 batches | lr 0.00007 | ms/batch 77.76 | loss  3.07 | ppl    21.54 
| epoch  45 |   200/  269 batches | lr 0.00007 | ms/batch 76.34 | loss  3.03 | ppl    20.67 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 21.04s | valid loss  3.75 | valid ppl    42.65 | valid bpc    5.415
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 45.0%
| epoch  46 |   100/  269 batches | lr 0.00007 | ms/batch 77.79 | loss  3.00 | ppl    20.18 
| epoch  46 |   200/  269 batches | lr 0.00007 | ms/batch 76.62 | loss  3.00 | ppl    20.08 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 21.07s | valid loss  3.76 | valid ppl    43.16 | valid bpc    5.432
-----------------------------------------------------------------------------------------
PROGRESS: 46.0%
| epoch  47 |   100/  269 batches | lr 0.00007 | ms/batch 77.55 | loss  3.00 | ppl    19.99 
| epoch  47 |   200/  269 batches | lr 0.00007 | ms/batch 76.33 | loss  2.98 | ppl    19.68 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 21.04s | valid loss  3.67 | valid ppl    39.27 | valid bpc    5.295
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 47.0%
| epoch  48 |   100/  269 batches | lr 0.00007 | ms/batch 77.68 | loss  2.97 | ppl    19.43 
| epoch  48 |   200/  269 batches | lr 0.00007 | ms/batch 76.39 | loss  2.98 | ppl    19.77 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 21.06s | valid loss  3.77 | valid ppl    43.48 | valid bpc    5.442
-----------------------------------------------------------------------------------------
PROGRESS: 48.0%
| epoch  49 |   100/  269 batches | lr 0.00007 | ms/batch 77.93 | loss  2.96 | ppl    19.24 
| epoch  49 |   200/  269 batches | lr 0.00007 | ms/batch 76.46 | loss  2.96 | ppl    19.28 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 21.07s | valid loss  3.71 | valid ppl    40.86 | valid bpc    5.353
-----------------------------------------------------------------------------------------
PROGRESS: 49.0%
| epoch  50 |   100/  269 batches | lr 0.00007 | ms/batch 77.51 | loss  2.95 | ppl    19.08 
| epoch  50 |   200/  269 batches | lr 0.00007 | ms/batch 76.17 | loss  2.92 | ppl    18.50 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 21.04s | valid loss  3.75 | valid ppl    42.47 | valid bpc    5.408
-----------------------------------------------------------------------------------------
PROGRESS: 50.0%
| epoch  51 |   100/  269 batches | lr 0.00004 | ms/batch 77.30 | loss  2.92 | ppl    18.57 
| epoch  51 |   200/  269 batches | lr 0.00004 | ms/batch 76.35 | loss  2.90 | ppl    18.19 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 21.07s | valid loss  3.69 | valid ppl    39.98 | valid bpc    5.321
-----------------------------------------------------------------------------------------
PROGRESS: 51.0%
| epoch  52 |   100/  269 batches | lr 0.00004 | ms/batch 78.15 | loss  2.92 | ppl    18.61 
| epoch  52 |   200/  269 batches | lr 0.00004 | ms/batch 76.38 | loss  2.88 | ppl    17.88 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 21.07s | valid loss  3.70 | valid ppl    40.64 | valid bpc    5.345
-----------------------------------------------------------------------------------------
PROGRESS: 52.0%
| epoch  53 |   100/  269 batches | lr 0.00004 | ms/batch 78.01 | loss  2.90 | ppl    18.15 
| epoch  53 |   200/  269 batches | lr 0.00004 | ms/batch 76.18 | loss  2.88 | ppl    17.85 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 21.04s | valid loss  3.73 | valid ppl    41.53 | valid bpc    5.376
-----------------------------------------------------------------------------------------
PROGRESS: 53.0%
| epoch  54 |   100/  269 batches | lr 0.00002 | ms/batch 78.09 | loss  2.88 | ppl    17.83 
| epoch  54 |   200/  269 batches | lr 0.00002 | ms/batch 76.29 | loss  2.85 | ppl    17.37 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 21.08s | valid loss  3.74 | valid ppl    42.30 | valid bpc    5.403
-----------------------------------------------------------------------------------------
PROGRESS: 54.0%
| epoch  55 |   100/  269 batches | lr 0.00002 | ms/batch 77.91 | loss  2.88 | ppl    17.73 
| epoch  55 |   200/  269 batches | lr 0.00002 | ms/batch 76.14 | loss  2.85 | ppl    17.37 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 21.03s | valid loss  3.75 | valid ppl    42.37 | valid bpc    5.405
-----------------------------------------------------------------------------------------
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  269 batches | lr 0.00002 | ms/batch 77.82 | loss  2.87 | ppl    17.67 
| epoch  56 |   200/  269 batches | lr 0.00002 | ms/batch 76.41 | loss  2.85 | ppl    17.26 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 21.07s | valid loss  3.75 | valid ppl    42.38 | valid bpc    5.405
-----------------------------------------------------------------------------------------
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  269 batches | lr 0.00001 | ms/batch 77.53 | loss  2.87 | ppl    17.61 
| epoch  57 |   200/  269 batches | lr 0.00001 | ms/batch 76.47 | loss  2.85 | ppl    17.25 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 21.06s | valid loss  3.72 | valid ppl    41.12 | valid bpc    5.362
-----------------------------------------------------------------------------------------
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  269 batches | lr 0.00001 | ms/batch 77.49 | loss  2.85 | ppl    17.35 
| epoch  58 |   200/  269 batches | lr 0.00001 | ms/batch 77.06 | loss  2.87 | ppl    17.61 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 21.07s | valid loss  3.76 | valid ppl    42.96 | valid bpc    5.425
-----------------------------------------------------------------------------------------
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  269 batches | lr 0.00001 | ms/batch 77.48 | loss  2.87 | ppl    17.68 
| epoch  59 |   200/  269 batches | lr 0.00001 | ms/batch 76.25 | loss  2.83 | ppl    17.01 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 21.03s | valid loss  3.71 | valid ppl    40.89 | valid bpc    5.354
-----------------------------------------------------------------------------------------
PROGRESS: 59.0%
| epoch  60 |   100/  269 batches | lr 0.00000 | ms/batch 77.39 | loss  2.86 | ppl    17.43 
| epoch  60 |   200/  269 batches | lr 0.00000 | ms/batch 76.10 | loss  2.82 | ppl    16.85 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 21.03s | valid loss  3.71 | valid ppl    40.70 | valid bpc    5.347
-----------------------------------------------------------------------------------------
PROGRESS: 60.0%
| epoch  61 |   100/  269 batches | lr 0.00000 | ms/batch 77.66 | loss  2.86 | ppl    17.40 
| epoch  61 |   200/  269 batches | lr 0.00000 | ms/batch 76.59 | loss  2.83 | ppl    16.96 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 21.07s | valid loss  3.75 | valid ppl    42.33 | valid bpc    5.404
-----------------------------------------------------------------------------------------
PROGRESS: 61.0%
| epoch  62 |   100/  269 batches | lr 0.00000 | ms/batch 77.80 | loss  2.84 | ppl    17.06 
| epoch  62 |   200/  269 batches | lr 0.00000 | ms/batch 76.14 | loss  2.85 | ppl    17.23 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 21.06s | valid loss  3.72 | valid ppl    41.23 | valid bpc    5.366
-----------------------------------------------------------------------------------------
PROGRESS: 62.0%
| epoch  63 |   100/  269 batches | lr 0.00000 | ms/batch 78.04 | loss  2.86 | ppl    17.48 
| epoch  63 |   200/  269 batches | lr 0.00000 | ms/batch 76.53 | loss  2.83 | ppl    16.95 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 21.07s | valid loss  3.77 | valid ppl    43.17 | valid bpc    5.432
-----------------------------------------------------------------------------------------
PROGRESS: 63.0%
| epoch  64 |   100/  269 batches | lr 0.00000 | ms/batch 78.08 | loss  2.85 | ppl    17.35 
| epoch  64 |   200/  269 batches | lr 0.00000 | ms/batch 76.46 | loss  2.81 | ppl    16.67 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 21.13s | valid loss  3.70 | valid ppl    40.54 | valid bpc    5.341
-----------------------------------------------------------------------------------------
PROGRESS: 64.0%
| epoch  65 |   100/  269 batches | lr 0.00000 | ms/batch 77.67 | loss  2.85 | ppl    17.33 
| epoch  65 |   200/  269 batches | lr 0.00000 | ms/batch 76.42 | loss  2.81 | ppl    16.67 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 21.06s | valid loss  3.77 | valid ppl    43.44 | valid bpc    5.441
-----------------------------------------------------------------------------------------
PROGRESS: 65.0%
| epoch  66 |   100/  269 batches | lr 0.00000 | ms/batch 78.01 | loss  2.86 | ppl    17.46 
| epoch  66 |   200/  269 batches | lr 0.00000 | ms/batch 76.16 | loss  2.85 | ppl    17.24 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 21.06s | valid loss  3.76 | valid ppl    42.84 | valid bpc    5.421
-----------------------------------------------------------------------------------------
PROGRESS: 66.0%
| epoch  67 |   100/  269 batches | lr 0.00000 | ms/batch 77.53 | loss  2.85 | ppl    17.32 
| epoch  67 |   200/  269 batches | lr 0.00000 | ms/batch 76.43 | loss  2.84 | ppl    17.12 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 21.05s | valid loss  3.71 | valid ppl    40.76 | valid bpc    5.349
-----------------------------------------------------------------------------------------
PROGRESS: 67.0%
| epoch  68 |   100/  269 batches | lr 0.00000 | ms/batch 77.69 | loss  2.85 | ppl    17.29 
| epoch  68 |   200/  269 batches | lr 0.00000 | ms/batch 76.14 | loss  2.84 | ppl    17.08 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 21.06s | valid loss  3.69 | valid ppl    39.98 | valid bpc    5.321
-----------------------------------------------------------------------------------------
PROGRESS: 68.0%
| epoch  69 |   100/  269 batches | lr 0.00000 | ms/batch 77.56 | loss  2.82 | ppl    16.82 
| epoch  69 |   200/  269 batches | lr 0.00000 | ms/batch 76.23 | loss  2.82 | ppl    16.84 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 21.02s | valid loss  3.74 | valid ppl    42.29 | valid bpc    5.402
-----------------------------------------------------------------------------------------
PROGRESS: 69.0%
| epoch  70 |   100/  269 batches | lr 0.00000 | ms/batch 77.50 | loss  2.85 | ppl    17.36 
| epoch  70 |   200/  269 batches | lr 0.00000 | ms/batch 76.36 | loss  2.84 | ppl    17.19 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 21.03s | valid loss  3.73 | valid ppl    41.71 | valid bpc    5.382
-----------------------------------------------------------------------------------------
PROGRESS: 70.0%
| epoch  71 |   100/  269 batches | lr 0.00000 | ms/batch 77.57 | loss  2.87 | ppl    17.61 
| epoch  71 |   200/  269 batches | lr 0.00000 | ms/batch 76.68 | loss  2.83 | ppl    16.95 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 21.07s | valid loss  3.71 | valid ppl    40.69 | valid bpc    5.347
-----------------------------------------------------------------------------------------
PROGRESS: 71.0%
| epoch  72 |   100/  269 batches | lr 0.00000 | ms/batch 77.76 | loss  2.88 | ppl    17.73 
| epoch  72 |   200/  269 batches | lr 0.00000 | ms/batch 76.74 | loss  2.81 | ppl    16.66 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 21.06s | valid loss  3.75 | valid ppl    42.46 | valid bpc    5.408
-----------------------------------------------------------------------------------------
PROGRESS: 72.0%
| epoch  73 |   100/  269 batches | lr 0.00000 | ms/batch 77.95 | loss  2.85 | ppl    17.36 
| epoch  73 |   200/  269 batches | lr 0.00000 | ms/batch 76.36 | loss  2.81 | ppl    16.56 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 21.08s | valid loss  3.71 | valid ppl    40.71 | valid bpc    5.347
-----------------------------------------------------------------------------------------
PROGRESS: 73.0%
| epoch  74 |   100/  269 batches | lr 0.00000 | ms/batch 78.13 | loss  2.87 | ppl    17.55 
| epoch  74 |   200/  269 batches | lr 0.00000 | ms/batch 76.75 | loss  2.82 | ppl    16.80 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 21.11s | valid loss  3.69 | valid ppl    40.12 | valid bpc    5.326
-----------------------------------------------------------------------------------------
PROGRESS: 74.0%
| epoch  75 |   100/  269 batches | lr 0.00000 | ms/batch 78.07 | loss  2.87 | ppl    17.58 
| epoch  75 |   200/  269 batches | lr 0.00000 | ms/batch 76.08 | loss  2.81 | ppl    16.57 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 21.08s | valid loss  3.72 | valid ppl    41.12 | valid bpc    5.362
-----------------------------------------------------------------------------------------
PROGRESS: 75.0%
| epoch  76 |   100/  269 batches | lr 0.00000 | ms/batch 78.26 | loss  2.86 | ppl    17.38 
| epoch  76 |   200/  269 batches | lr 0.00000 | ms/batch 76.50 | loss  2.81 | ppl    16.62 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 21.09s | valid loss  3.77 | valid ppl    43.23 | valid bpc    5.434
-----------------------------------------------------------------------------------------
PROGRESS: 76.0%
| epoch  77 |   100/  269 batches | lr 0.00000 | ms/batch 77.58 | loss  2.85 | ppl    17.33 
| epoch  77 |   200/  269 batches | lr 0.00000 | ms/batch 76.72 | loss  2.81 | ppl    16.57 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 21.08s | valid loss  3.70 | valid ppl    40.64 | valid bpc    5.345
-----------------------------------------------------------------------------------------
PROGRESS: 77.0%
| epoch  78 |   100/  269 batches | lr 0.00000 | ms/batch 78.34 | loss  2.83 | ppl    16.89 
| epoch  78 |   200/  269 batches | lr 0.00000 | ms/batch 76.19 | loss  2.83 | ppl    16.92 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 21.13s | valid loss  3.73 | valid ppl    41.85 | valid bpc    5.387
-----------------------------------------------------------------------------------------
PROGRESS: 78.0%
| epoch  79 |   100/  269 batches | lr 0.00000 | ms/batch 78.04 | loss  2.85 | ppl    17.33 
| epoch  79 |   200/  269 batches | lr 0.00000 | ms/batch 76.43 | loss  2.82 | ppl    16.83 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 21.08s | valid loss  3.70 | valid ppl    40.56 | valid bpc    5.342
-----------------------------------------------------------------------------------------
PROGRESS: 79.0%
| epoch  80 |   100/  269 batches | lr 0.00000 | ms/batch 77.70 | loss  2.84 | ppl    17.19 
| epoch  80 |   200/  269 batches | lr 0.00000 | ms/batch 76.72 | loss  2.80 | ppl    16.46 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 21.08s | valid loss  3.74 | valid ppl    41.90 | valid bpc    5.389
-----------------------------------------------------------------------------------------
PROGRESS: 80.0%
| epoch  81 |   100/  269 batches | lr 0.00000 | ms/batch 78.01 | loss  2.86 | ppl    17.44 
| epoch  81 |   200/  269 batches | lr 0.00000 | ms/batch 76.44 | loss  2.84 | ppl    17.18 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 21.14s | valid loss  3.77 | valid ppl    43.43 | valid bpc    5.441
-----------------------------------------------------------------------------------------
PROGRESS: 81.0%
| epoch  82 |   100/  269 batches | lr 0.00000 | ms/batch 77.32 | loss  2.87 | ppl    17.64 
| epoch  82 |   200/  269 batches | lr 0.00000 | ms/batch 76.88 | loss  2.81 | ppl    16.62 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 21.04s | valid loss  3.74 | valid ppl    41.94 | valid bpc    5.390
-----------------------------------------------------------------------------------------
PROGRESS: 82.0%
| epoch  83 |   100/  269 batches | lr 0.00000 | ms/batch 77.82 | loss  2.85 | ppl    17.34 
| epoch  83 |   200/  269 batches | lr 0.00000 | ms/batch 76.41 | loss  2.82 | ppl    16.69 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 21.07s | valid loss  3.72 | valid ppl    41.36 | valid bpc    5.370
-----------------------------------------------------------------------------------------
PROGRESS: 83.0%
| epoch  84 |   100/  269 batches | lr 0.00000 | ms/batch 77.98 | loss  2.84 | ppl    17.08 
| epoch  84 |   200/  269 batches | lr 0.00000 | ms/batch 76.29 | loss  2.82 | ppl    16.72 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 21.07s | valid loss  3.72 | valid ppl    41.26 | valid bpc    5.367
-----------------------------------------------------------------------------------------
PROGRESS: 84.0%
| epoch  85 |   100/  269 batches | lr 0.00000 | ms/batch 77.98 | loss  2.84 | ppl    17.08 
| epoch  85 |   200/  269 batches | lr 0.00000 | ms/batch 76.53 | loss  2.81 | ppl    16.56 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 21.08s | valid loss  3.76 | valid ppl    42.91 | valid bpc    5.423
-----------------------------------------------------------------------------------------
PROGRESS: 85.0%
| epoch  86 |   100/  269 batches | lr 0.00000 | ms/batch 77.69 | loss  2.85 | ppl    17.27 
| epoch  86 |   200/  269 batches | lr 0.00000 | ms/batch 76.67 | loss  2.81 | ppl    16.61 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 21.08s | valid loss  3.74 | valid ppl    42.00 | valid bpc    5.392
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  269 batches | lr 0.00000 | ms/batch 78.37 | loss  2.83 | ppl    17.00 
| epoch  87 |   200/  269 batches | lr 0.00000 | ms/batch 76.18 | loss  2.82 | ppl    16.74 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 21.07s | valid loss  3.71 | valid ppl    40.88 | valid bpc    5.353
-----------------------------------------------------------------------------------------
PROGRESS: 87.0%
| epoch  88 |   100/  269 batches | lr 0.00000 | ms/batch 77.65 | loss  2.86 | ppl    17.42 
| epoch  88 |   200/  269 batches | lr 0.00000 | ms/batch 76.76 | loss  2.83 | ppl    16.88 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 21.08s | valid loss  3.77 | valid ppl    43.54 | valid bpc    5.444
-----------------------------------------------------------------------------------------
PROGRESS: 88.0%
| epoch  89 |   100/  269 batches | lr 0.00000 | ms/batch 77.69 | loss  2.83 | ppl    17.00 
| epoch  89 |   200/  269 batches | lr 0.00000 | ms/batch 76.39 | loss  2.83 | ppl    16.98 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 21.09s | valid loss  3.71 | valid ppl    40.79 | valid bpc    5.350
-----------------------------------------------------------------------------------------
PROGRESS: 89.0%
| epoch  90 |   100/  269 batches | lr 0.00000 | ms/batch 78.29 | loss  2.85 | ppl    17.33 
| epoch  90 |   200/  269 batches | lr 0.00000 | ms/batch 75.91 | loss  2.81 | ppl    16.61 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 21.09s | valid loss  3.74 | valid ppl    41.97 | valid bpc    5.391
-----------------------------------------------------------------------------------------
PROGRESS: 90.0%
| epoch  91 |   100/  269 batches | lr 0.00000 | ms/batch 77.58 | loss  2.85 | ppl    17.30 
| epoch  91 |   200/  269 batches | lr 0.00000 | ms/batch 76.53 | loss  2.82 | ppl    16.71 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 21.04s | valid loss  3.70 | valid ppl    40.42 | valid bpc    5.337
-----------------------------------------------------------------------------------------
PROGRESS: 91.0%
| epoch  92 |   100/  269 batches | lr 0.00000 | ms/batch 78.02 | loss  2.84 | ppl    17.11 
| epoch  92 |   200/  269 batches | lr 0.00000 | ms/batch 75.85 | loss  2.81 | ppl    16.63 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 21.04s | valid loss  3.77 | valid ppl    43.45 | valid bpc    5.441
-----------------------------------------------------------------------------------------
PROGRESS: 92.0%
| epoch  93 |   100/  269 batches | lr 0.00000 | ms/batch 77.73 | loss  2.84 | ppl    17.14 
| epoch  93 |   200/  269 batches | lr 0.00000 | ms/batch 76.54 | loss  2.82 | ppl    16.85 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 21.05s | valid loss  3.72 | valid ppl    41.33 | valid bpc    5.369
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  269 batches | lr 0.00000 | ms/batch 77.90 | loss  2.86 | ppl    17.43 
| epoch  94 |   200/  269 batches | lr 0.00000 | ms/batch 76.42 | loss  2.82 | ppl    16.73 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 21.09s | valid loss  3.75 | valid ppl    42.67 | valid bpc    5.415
-----------------------------------------------------------------------------------------
PROGRESS: 94.0%
| epoch  95 |   100/  269 batches | lr 0.00000 | ms/batch 77.63 | loss  2.85 | ppl    17.34 
| epoch  95 |   200/  269 batches | lr 0.00000 | ms/batch 76.37 | loss  2.83 | ppl    17.00 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 21.09s | valid loss  3.73 | valid ppl    41.88 | valid bpc    5.388
-----------------------------------------------------------------------------------------
PROGRESS: 95.0%
| epoch  96 |   100/  269 batches | lr 0.00000 | ms/batch 77.46 | loss  2.85 | ppl    17.31 
| epoch  96 |   200/  269 batches | lr 0.00000 | ms/batch 76.43 | loss  2.82 | ppl    16.79 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 21.09s | valid loss  3.73 | valid ppl    41.78 | valid bpc    5.385
-----------------------------------------------------------------------------------------
PROGRESS: 96.0%
| epoch  97 |   100/  269 batches | lr 0.00000 | ms/batch 77.84 | loss  2.86 | ppl    17.49 
| epoch  97 |   200/  269 batches | lr 0.00000 | ms/batch 76.19 | loss  2.79 | ppl    16.34 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 21.07s | valid loss  3.71 | valid ppl    40.70 | valid bpc    5.347
-----------------------------------------------------------------------------------------
PROGRESS: 97.0%
| epoch  98 |   100/  269 batches | lr 0.00000 | ms/batch 77.91 | loss  2.85 | ppl    17.21 
| epoch  98 |   200/  269 batches | lr 0.00000 | ms/batch 76.43 | loss  2.82 | ppl    16.85 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 21.07s | valid loss  3.73 | valid ppl    41.77 | valid bpc    5.385
-----------------------------------------------------------------------------------------
PROGRESS: 98.0%
| epoch  99 |   100/  269 batches | lr 0.00000 | ms/batch 77.71 | loss  2.83 | ppl    16.96 
| epoch  99 |   200/  269 batches | lr 0.00000 | ms/batch 76.33 | loss  2.83 | ppl    16.97 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 21.05s | valid loss  3.71 | valid ppl    40.80 | valid bpc    5.350
-----------------------------------------------------------------------------------------
PROGRESS: 99.0%
| epoch 100 |   100/  269 batches | lr 0.00000 | ms/batch 78.09 | loss  2.86 | ppl    17.43 
| epoch 100 |   200/  269 batches | lr 0.00000 | ms/batch 76.20 | loss  2.81 | ppl    16.66 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 21.08s | valid loss  3.77 | valid ppl    43.19 | valid bpc    5.433
-----------------------------------------------------------------------------------------
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  3.79 | test ppl    44.21 | test bpc    5.466
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.4704, Mean Reca: 0.6633, Mean F1: 0.5459, Mean Subword_Reca: 0.9060
-----------------------------------------------------------------------------------------
=========================================================================================
