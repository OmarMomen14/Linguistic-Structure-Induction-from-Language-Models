Loading dataset...
Using subword tokenizer...
Number of tokens:  8000
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer_in_parser', nhid=512, nlayers=8, front_layers=1, rear_layers=7, subword='omarmomen/ptb_filtered_lowcase_bpe_tokenizer_8', n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=1111, nonmono=5, cuda=True, log_interval=100, save='trained_models/subword_structformer_in_parser_1111_17.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 37449140
Model architecture: StructFormer_In_Parser(
  (transformer_front): Transformer_Front(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(8000, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0): TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
  (transformer_rear): Transformer_Rear(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(8000, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-6): 7 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (output_layer): Linear(in_features=512, out_features=8000, bias=True)
  )
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  269 batches | lr 0.00030 | ms/batch 78.59 | loss  7.74 | ppl  2308.04 
| epoch   1 |   200/  269 batches | lr 0.00030 | ms/batch 74.20 | loss  7.35 | ppl  1561.11 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 20.74s | valid loss  7.02 | valid ppl  1115.02 | valid bpc   10.123
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  269 batches | lr 0.00030 | ms/batch 75.53 | loss  7.17 | ppl  1305.54 
| epoch   2 |   200/  269 batches | lr 0.00030 | ms/batch 74.61 | loss  6.89 | ppl   985.65 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 20.56s | valid loss  6.30 | valid ppl   546.99 | valid bpc    9.095
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  269 batches | lr 0.00030 | ms/batch 75.99 | loss  6.43 | ppl   622.04 
| epoch   3 |   200/  269 batches | lr 0.00030 | ms/batch 74.70 | loss  6.14 | ppl   465.62 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 20.59s | valid loss  5.74 | valid ppl   310.43 | valid bpc    8.278
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  269 batches | lr 0.00030 | ms/batch 76.83 | loss  5.93 | ppl   374.37 
| epoch   4 |   200/  269 batches | lr 0.00030 | ms/batch 74.77 | loss  5.75 | ppl   315.07 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 20.65s | valid loss  5.46 | valid ppl   234.46 | valid bpc    7.873
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  269 batches | lr 0.00030 | ms/batch 76.81 | loss  5.64 | ppl   280.12 
| epoch   5 |   200/  269 batches | lr 0.00030 | ms/batch 75.60 | loss  5.53 | ppl   251.98 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 20.79s | valid loss  5.28 | valid ppl   196.06 | valid bpc    7.615
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  269 batches | lr 0.00030 | ms/batch 76.97 | loss  5.44 | ppl   230.95 
| epoch   6 |   200/  269 batches | lr 0.00030 | ms/batch 75.66 | loss  5.29 | ppl   198.42 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 20.86s | valid loss  5.09 | valid ppl   162.09 | valid bpc    7.341
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  269 batches | lr 0.00030 | ms/batch 77.01 | loss  5.23 | ppl   186.59 
| epoch   7 |   200/  269 batches | lr 0.00030 | ms/batch 75.81 | loss  5.17 | ppl   175.41 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 20.84s | valid loss  4.99 | valid ppl   147.22 | valid bpc    7.202
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  269 batches | lr 0.00030 | ms/batch 113.87 | loss  5.07 | ppl   159.29 
| epoch   8 |   200/  269 batches | lr 0.00030 | ms/batch 160.29 | loss  5.02 | ppl   151.68 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 39.23s | valid loss  4.87 | valid ppl   130.29 | valid bpc    7.026
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 8.0%
| epoch   9 |   100/  269 batches | lr 0.00030 | ms/batch 153.57 | loss  4.94 | ppl   140.11 
| epoch   9 |   200/  269 batches | lr 0.00030 | ms/batch 159.43 | loss  4.90 | ppl   133.65 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 43.25s | valid loss  4.76 | valid ppl   117.12 | valid bpc    6.872
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  269 batches | lr 0.00030 | ms/batch 154.68 | loss  4.86 | ppl   129.07 
| epoch  10 |   200/  269 batches | lr 0.00030 | ms/batch 160.48 | loss  4.75 | ppl   115.57 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 48.88s | valid loss  4.64 | valid ppl   103.95 | valid bpc    6.700
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  269 batches | lr 0.00030 | ms/batch 245.19 | loss  4.72 | ppl   112.11 
| epoch  11 |   200/  269 batches | lr 0.00030 | ms/batch 230.18 | loss  4.65 | ppl   104.41 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 65.47s | valid loss  4.56 | valid ppl    95.81 | valid bpc    6.582
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  269 batches | lr 0.00030 | ms/batch 246.91 | loss  4.60 | ppl    99.97 
| epoch  12 |   200/  269 batches | lr 0.00030 | ms/batch 230.23 | loss  4.54 | ppl    94.11 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 65.61s | valid loss  4.46 | valid ppl    86.47 | valid bpc    6.434
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 12.0%
| epoch  13 |   100/  269 batches | lr 0.00030 | ms/batch 245.53 | loss  4.51 | ppl    90.82 
| epoch  13 |   200/  269 batches | lr 0.00030 | ms/batch 232.53 | loss  4.42 | ppl    83.24 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 65.76s | valid loss  4.38 | valid ppl    79.96 | valid bpc    6.321
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 13.0%
| epoch  14 |   100/  269 batches | lr 0.00030 | ms/batch 246.34 | loss  4.40 | ppl    81.30 
| epoch  14 |   200/  269 batches | lr 0.00030 | ms/batch 231.61 | loss  4.37 | ppl    78.95 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 65.67s | valid loss  4.33 | valid ppl    76.28 | valid bpc    6.253
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  269 batches | lr 0.00030 | ms/batch 246.11 | loss  4.31 | ppl    74.51 
| epoch  15 |   200/  269 batches | lr 0.00030 | ms/batch 231.04 | loss  4.26 | ppl    70.84 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 65.63s | valid loss  4.28 | valid ppl    72.03 | valid bpc    6.171
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 15.0%
| epoch  16 |   100/  269 batches | lr 0.00030 | ms/batch 245.50 | loss  4.23 | ppl    68.48 
| epoch  16 |   200/  269 batches | lr 0.00030 | ms/batch 232.06 | loss  4.20 | ppl    66.59 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 65.66s | valid loss  4.27 | valid ppl    71.43 | valid bpc    6.158
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 16.0%
| epoch  17 |   100/  269 batches | lr 0.00030 | ms/batch 245.91 | loss  4.16 | ppl    63.96 
| epoch  17 |   200/  269 batches | lr 0.00030 | ms/batch 231.69 | loss  4.10 | ppl    60.15 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 65.76s | valid loss  4.15 | valid ppl    63.62 | valid bpc    5.991
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 17.0%
| epoch  18 |   100/  269 batches | lr 0.00030 | ms/batch 244.66 | loss  4.07 | ppl    58.30 
| epoch  18 |   200/  269 batches | lr 0.00030 | ms/batch 232.97 | loss  4.05 | ppl    57.63 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 65.81s | valid loss  4.17 | valid ppl    65.04 | valid bpc    6.023
-----------------------------------------------------------------------------------------
PROGRESS: 18.0%
| epoch  19 |   100/  269 batches | lr 0.00030 | ms/batch 244.92 | loss  4.04 | ppl    57.10 
| epoch  19 |   200/  269 batches | lr 0.00030 | ms/batch 231.52 | loss  3.96 | ppl    52.70 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 65.59s | valid loss  4.12 | valid ppl    61.86 | valid bpc    5.951
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 19.0%
| epoch  20 |   100/  269 batches | lr 0.00030 | ms/batch 246.15 | loss  3.94 | ppl    51.25 
| epoch  20 |   200/  269 batches | lr 0.00030 | ms/batch 230.32 | loss  3.94 | ppl    51.28 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 65.78s | valid loss  4.05 | valid ppl    57.15 | valid bpc    5.837
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 20.0%
| epoch  21 |   100/  269 batches | lr 0.00030 | ms/batch 245.47 | loss  3.91 | ppl    49.84 
| epoch  21 |   200/  269 batches | lr 0.00030 | ms/batch 232.44 | loss  3.87 | ppl    47.86 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 65.69s | valid loss  4.03 | valid ppl    56.37 | valid bpc    5.817
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 21.0%
| epoch  22 |   100/  269 batches | lr 0.00030 | ms/batch 247.18 | loss  3.85 | ppl    46.84 
| epoch  22 |   200/  269 batches | lr 0.00030 | ms/batch 231.94 | loss  3.80 | ppl    44.70 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 65.81s | valid loss  4.02 | valid ppl    55.54 | valid bpc    5.795
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 22.0%
| epoch  23 |   100/  269 batches | lr 0.00030 | ms/batch 246.88 | loss  3.78 | ppl    44.00 
| epoch  23 |   200/  269 batches | lr 0.00030 | ms/batch 232.82 | loss  3.78 | ppl    43.83 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 65.86s | valid loss  4.00 | valid ppl    54.60 | valid bpc    5.771
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 23.0%
| epoch  24 |   100/  269 batches | lr 0.00030 | ms/batch 248.30 | loss  3.76 | ppl    43.08 
| epoch  24 |   200/  269 batches | lr 0.00030 | ms/batch 231.31 | loss  3.72 | ppl    41.36 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 65.83s | valid loss  4.04 | valid ppl    56.87 | valid bpc    5.830
-----------------------------------------------------------------------------------------
PROGRESS: 24.0%
| epoch  25 |   100/  269 batches | lr 0.00030 | ms/batch 246.55 | loss  3.71 | ppl    40.82 
| epoch  25 |   200/  269 batches | lr 0.00030 | ms/batch 232.85 | loss  3.68 | ppl    39.62 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 65.80s | valid loss  4.00 | valid ppl    54.42 | valid bpc    5.766
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 25.0%
| epoch  26 |   100/  269 batches | lr 0.00030 | ms/batch 246.97 | loss  3.66 | ppl    38.98 
| epoch  26 |   200/  269 batches | lr 0.00030 | ms/batch 233.04 | loss  3.64 | ppl    38.09 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 65.92s | valid loss  3.96 | valid ppl    52.60 | valid bpc    5.717
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 26.0%
| epoch  27 |   100/  269 batches | lr 0.00030 | ms/batch 247.37 | loss  3.61 | ppl    36.80 
| epoch  27 |   200/  269 batches | lr 0.00030 | ms/batch 233.62 | loss  3.63 | ppl    37.71 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 66.06s | valid loss  3.99 | valid ppl    54.25 | valid bpc    5.762
-----------------------------------------------------------------------------------------
PROGRESS: 27.0%
| epoch  28 |   100/  269 batches | lr 0.00030 | ms/batch 246.95 | loss  3.54 | ppl    34.40 
| epoch  28 |   200/  269 batches | lr 0.00030 | ms/batch 234.68 | loss  3.58 | ppl    35.75 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 66.01s | valid loss  3.94 | valid ppl    51.41 | valid bpc    5.684
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  269 batches | lr 0.00030 | ms/batch 248.76 | loss  3.52 | ppl    33.85 
| epoch  29 |   200/  269 batches | lr 0.00030 | ms/batch 235.81 | loss  3.54 | ppl    34.61 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 66.30s | valid loss  3.94 | valid ppl    51.43 | valid bpc    5.685
-----------------------------------------------------------------------------------------
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  269 batches | lr 0.00030 | ms/batch 242.10 | loss  3.52 | ppl    33.63 
| epoch  30 |   200/  269 batches | lr 0.00030 | ms/batch 237.08 | loss  3.48 | ppl    32.42 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 65.82s | valid loss  3.91 | valid ppl    49.83 | valid bpc    5.639
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 30.0%
| epoch  31 |   100/  269 batches | lr 0.00030 | ms/batch 238.28 | loss  3.45 | ppl    31.39 
| epoch  31 |   200/  269 batches | lr 0.00030 | ms/batch 241.31 | loss  3.46 | ppl    31.71 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 65.85s | valid loss  3.93 | valid ppl    50.71 | valid bpc    5.664
-----------------------------------------------------------------------------------------
PROGRESS: 31.0%
| epoch  32 |   100/  269 batches | lr 0.00030 | ms/batch 242.50 | loss  3.43 | ppl    30.82 
| epoch  32 |   200/  269 batches | lr 0.00030 | ms/batch 240.83 | loss  3.40 | ppl    30.09 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 66.38s | valid loss  3.89 | valid ppl    48.74 | valid bpc    5.607
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 32.0%
| epoch  33 |   100/  269 batches | lr 0.00030 | ms/batch 239.96 | loss  3.41 | ppl    30.13 
| epoch  33 |   200/  269 batches | lr 0.00030 | ms/batch 241.67 | loss  3.38 | ppl    29.23 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 66.11s | valid loss  3.87 | valid ppl    47.72 | valid bpc    5.577
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 33.0%
| epoch  34 |   100/  269 batches | lr 0.00030 | ms/batch 246.71 | loss  3.36 | ppl    28.83 
| epoch  34 |   200/  269 batches | lr 0.00030 | ms/batch 242.99 | loss  3.35 | ppl    28.58 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 66.42s | valid loss  3.87 | valid ppl    48.05 | valid bpc    5.587
-----------------------------------------------------------------------------------------
PROGRESS: 34.0%
| epoch  35 |   100/  269 batches | lr 0.00030 | ms/batch 246.09 | loss  3.32 | ppl    27.53 
| epoch  35 |   200/  269 batches | lr 0.00030 | ms/batch 242.85 | loss  3.32 | ppl    27.58 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 66.08s | valid loss  3.89 | valid ppl    48.75 | valid bpc    5.607
-----------------------------------------------------------------------------------------
PROGRESS: 35.0%
| epoch  36 |   100/  269 batches | lr 0.00030 | ms/batch 245.95 | loss  3.32 | ppl    27.54 
| epoch  36 |   200/  269 batches | lr 0.00030 | ms/batch 242.12 | loss  3.28 | ppl    26.54 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 66.28s | valid loss  3.93 | valid ppl    50.69 | valid bpc    5.664
-----------------------------------------------------------------------------------------
PROGRESS: 36.0%
| epoch  37 |   100/  269 batches | lr 0.00015 | ms/batch 247.93 | loss  3.23 | ppl    25.21 
| epoch  37 |   200/  269 batches | lr 0.00015 | ms/batch 241.95 | loss  3.18 | ppl    24.14 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 66.36s | valid loss  3.79 | valid ppl    44.40 | valid bpc    5.472
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 37.0%
| epoch  38 |   100/  269 batches | lr 0.00015 | ms/batch 247.21 | loss  3.16 | ppl    23.49 
| epoch  38 |   200/  269 batches | lr 0.00015 | ms/batch 242.20 | loss  3.15 | ppl    23.26 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 65.99s | valid loss  3.80 | valid ppl    44.59 | valid bpc    5.479
-----------------------------------------------------------------------------------------
PROGRESS: 38.0%
| epoch  39 |   100/  269 batches | lr 0.00015 | ms/batch 247.40 | loss  3.11 | ppl    22.52 
| epoch  39 |   200/  269 batches | lr 0.00015 | ms/batch 241.64 | loss  3.10 | ppl    22.16 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 66.41s | valid loss  3.79 | valid ppl    44.38 | valid bpc    5.472
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 39.0%
| epoch  40 |   100/  269 batches | lr 0.00015 | ms/batch 247.88 | loss  3.10 | ppl    22.09 
| epoch  40 |   200/  269 batches | lr 0.00015 | ms/batch 242.97 | loss  3.08 | ppl    21.86 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 66.02s | valid loss  3.79 | valid ppl    44.10 | valid bpc    5.463
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 40.0%
| epoch  41 |   100/  269 batches | lr 0.00015 | ms/batch 247.15 | loss  3.06 | ppl    21.40 
| epoch  41 |   200/  269 batches | lr 0.00015 | ms/batch 243.32 | loss  3.05 | ppl    21.07 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 66.05s | valid loss  3.80 | valid ppl    44.62 | valid bpc    5.480
-----------------------------------------------------------------------------------------
PROGRESS: 41.0%
| epoch  42 |   100/  269 batches | lr 0.00015 | ms/batch 250.46 | loss  3.04 | ppl    20.99 
| epoch  42 |   200/  269 batches | lr 0.00015 | ms/batch 241.76 | loss  3.05 | ppl    21.02 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 66.71s | valid loss  3.78 | valid ppl    43.72 | valid bpc    5.450
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 42.0%
| epoch  43 |   100/  269 batches | lr 0.00015 | ms/batch 247.83 | loss  3.03 | ppl    20.64 
| epoch  43 |   200/  269 batches | lr 0.00015 | ms/batch 243.29 | loss  3.02 | ppl    20.57 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 66.06s | valid loss  3.81 | valid ppl    44.93 | valid bpc    5.490
-----------------------------------------------------------------------------------------
PROGRESS: 43.0%
| epoch  44 |   100/  269 batches | lr 0.00015 | ms/batch 248.48 | loss  3.00 | ppl    20.08 
| epoch  44 |   200/  269 batches | lr 0.00015 | ms/batch 242.32 | loss  3.00 | ppl    20.03 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 66.03s | valid loss  3.80 | valid ppl    44.82 | valid bpc    5.486
-----------------------------------------------------------------------------------------
PROGRESS: 44.0%
| epoch  45 |   100/  269 batches | lr 0.00015 | ms/batch 251.13 | loss  2.99 | ppl    19.91 
| epoch  45 |   200/  269 batches | lr 0.00015 | ms/batch 242.74 | loss  3.00 | ppl    20.04 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 66.74s | valid loss  3.74 | valid ppl    42.19 | valid bpc    5.399
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 45.0%
| epoch  46 |   100/  269 batches | lr 0.00015 | ms/batch 241.38 | loss  2.98 | ppl    19.68 
| epoch  46 |   200/  269 batches | lr 0.00015 | ms/batch 243.16 | loss  2.95 | ppl    19.09 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 65.99s | valid loss  3.78 | valid ppl    43.85 | valid bpc    5.454
-----------------------------------------------------------------------------------------
PROGRESS: 46.0%
| epoch  47 |   100/  269 batches | lr 0.00015 | ms/batch 251.89 | loss  2.93 | ppl    18.78 
| epoch  47 |   200/  269 batches | lr 0.00015 | ms/batch 243.16 | loss  2.94 | ppl    18.87 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 66.85s | valid loss  3.76 | valid ppl    43.15 | valid bpc    5.431
-----------------------------------------------------------------------------------------
PROGRESS: 47.0%
| epoch  48 |   100/  269 batches | lr 0.00015 | ms/batch 248.63 | loss  2.94 | ppl    18.94 
| epoch  48 |   200/  269 batches | lr 0.00015 | ms/batch 241.71 | loss  2.93 | ppl    18.70 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 66.08s | valid loss  3.81 | valid ppl    45.10 | valid bpc    5.495
-----------------------------------------------------------------------------------------
PROGRESS: 48.0%
| epoch  49 |   100/  269 batches | lr 0.00007 | ms/batch 249.87 | loss  2.88 | ppl    17.88 
| epoch  49 |   200/  269 batches | lr 0.00007 | ms/batch 243.82 | loss  2.87 | ppl    17.64 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 66.40s | valid loss  3.73 | valid ppl    41.82 | valid bpc    5.386
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 49.0%
| epoch  50 |   100/  269 batches | lr 0.00007 | ms/batch 250.68 | loss  2.87 | ppl    17.60 
| epoch  50 |   200/  269 batches | lr 0.00007 | ms/batch 243.59 | loss  2.85 | ppl    17.27 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 65.99s | valid loss  3.77 | valid ppl    43.46 | valid bpc    5.441
-----------------------------------------------------------------------------------------
PROGRESS: 50.0%
| epoch  51 |   100/  269 batches | lr 0.00007 | ms/batch 252.76 | loss  2.85 | ppl    17.25 
| epoch  51 |   200/  269 batches | lr 0.00007 | ms/batch 242.76 | loss  2.82 | ppl    16.75 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 66.03s | valid loss  3.75 | valid ppl    42.42 | valid bpc    5.407
-----------------------------------------------------------------------------------------
PROGRESS: 51.0%
| epoch  52 |   100/  269 batches | lr 0.00007 | ms/batch 257.05 | loss  2.80 | ppl    16.51 
| epoch  52 |   200/  269 batches | lr 0.00007 | ms/batch 242.95 | loss  2.82 | ppl    16.85 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 66.48s | valid loss  3.74 | valid ppl    42.21 | valid bpc    5.399
-----------------------------------------------------------------------------------------
PROGRESS: 52.0%
| epoch  53 |   100/  269 batches | lr 0.00004 | ms/batch 256.96 | loss  2.82 | ppl    16.75 
| epoch  53 |   200/  269 batches | lr 0.00004 | ms/batch 243.11 | loss  2.77 | ppl    15.93 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 66.87s | valid loss  3.79 | valid ppl    44.40 | valid bpc    5.472
-----------------------------------------------------------------------------------------
PROGRESS: 53.0%
| epoch  54 |   100/  269 batches | lr 0.00004 | ms/batch 256.51 | loss  2.81 | ppl    16.58 
| epoch  54 |   200/  269 batches | lr 0.00004 | ms/batch 243.67 | loss  2.78 | ppl    16.05 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 66.09s | valid loss  3.72 | valid ppl    41.12 | valid bpc    5.362
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 54.0%
| epoch  55 |   100/  269 batches | lr 0.00004 | ms/batch 257.56 | loss  2.78 | ppl    16.16 
| epoch  55 |   200/  269 batches | lr 0.00004 | ms/batch 242.83 | loss  2.77 | ppl    15.90 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 66.77s | valid loss  3.75 | valid ppl    42.39 | valid bpc    5.406
-----------------------------------------------------------------------------------------
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  269 batches | lr 0.00004 | ms/batch 256.82 | loss  2.79 | ppl    16.29 
| epoch  56 |   200/  269 batches | lr 0.00004 | ms/batch 242.03 | loss  2.77 | ppl    16.00 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 66.45s | valid loss  3.81 | valid ppl    44.95 | valid bpc    5.490
-----------------------------------------------------------------------------------------
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  269 batches | lr 0.00004 | ms/batch 256.12 | loss  2.76 | ppl    15.85 
| epoch  57 |   200/  269 batches | lr 0.00004 | ms/batch 242.43 | loss  2.75 | ppl    15.68 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 66.74s | valid loss  3.75 | valid ppl    42.53 | valid bpc    5.410
-----------------------------------------------------------------------------------------
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  269 batches | lr 0.00002 | ms/batch 256.06 | loss  2.76 | ppl    15.73 
| epoch  58 |   200/  269 batches | lr 0.00002 | ms/batch 242.56 | loss  2.73 | ppl    15.35 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 66.46s | valid loss  3.77 | valid ppl    43.25 | valid bpc    5.435
-----------------------------------------------------------------------------------------
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  269 batches | lr 0.00002 | ms/batch 255.91 | loss  2.75 | ppl    15.72 
| epoch  59 |   200/  269 batches | lr 0.00002 | ms/batch 240.14 | loss  2.72 | ppl    15.23 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 66.43s | valid loss  3.77 | valid ppl    43.58 | valid bpc    5.446
-----------------------------------------------------------------------------------------
PROGRESS: 59.0%
| epoch  60 |   100/  269 batches | lr 0.00002 | ms/batch 257.23 | loss  2.76 | ppl    15.79 
| epoch  60 |   200/  269 batches | lr 0.00002 | ms/batch 239.44 | loss  2.71 | ppl    15.08 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 66.81s | valid loss  3.78 | valid ppl    43.95 | valid bpc    5.458
-----------------------------------------------------------------------------------------
PROGRESS: 60.0%
| epoch  61 |   100/  269 batches | lr 0.00001 | ms/batch 258.22 | loss  2.72 | ppl    15.22 
| epoch  61 |   200/  269 batches | lr 0.00001 | ms/batch 236.20 | loss  2.72 | ppl    15.17 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 66.45s | valid loss  3.74 | valid ppl    42.19 | valid bpc    5.399
-----------------------------------------------------------------------------------------
PROGRESS: 61.0%
| epoch  62 |   100/  269 batches | lr 0.00001 | ms/batch 256.52 | loss  2.72 | ppl    15.22 
| epoch  62 |   200/  269 batches | lr 0.00001 | ms/batch 234.53 | loss  2.71 | ppl    14.96 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 66.51s | valid loss  3.79 | valid ppl    44.38 | valid bpc    5.472
-----------------------------------------------------------------------------------------
PROGRESS: 62.0%
| epoch  63 |   100/  269 batches | lr 0.00001 | ms/batch 256.57 | loss  2.73 | ppl    15.36 
| epoch  63 |   200/  269 batches | lr 0.00001 | ms/batch 236.75 | loss  2.70 | ppl    14.90 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 66.78s | valid loss  3.79 | valid ppl    44.42 | valid bpc    5.473
-----------------------------------------------------------------------------------------
PROGRESS: 63.0%
| epoch  64 |   100/  269 batches | lr 0.00000 | ms/batch 256.22 | loss  2.73 | ppl    15.31 
| epoch  64 |   200/  269 batches | lr 0.00000 | ms/batch 237.35 | loss  2.71 | ppl    14.98 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 66.80s | valid loss  3.72 | valid ppl    41.42 | valid bpc    5.372
-----------------------------------------------------------------------------------------
PROGRESS: 64.0%
| epoch  65 |   100/  269 batches | lr 0.00000 | ms/batch 255.72 | loss  2.73 | ppl    15.37 
| epoch  65 |   200/  269 batches | lr 0.00000 | ms/batch 235.05 | loss  2.67 | ppl    14.47 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 66.48s | valid loss  3.72 | valid ppl    41.18 | valid bpc    5.364
-----------------------------------------------------------------------------------------
PROGRESS: 65.0%
| epoch  66 |   100/  269 batches | lr 0.00000 | ms/batch 256.69 | loss  2.73 | ppl    15.30 
| epoch  66 |   200/  269 batches | lr 0.00000 | ms/batch 231.88 | loss  2.70 | ppl    14.82 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 66.54s | valid loss  3.78 | valid ppl    43.72 | valid bpc    5.450
-----------------------------------------------------------------------------------------
PROGRESS: 66.0%
| epoch  67 |   100/  269 batches | lr 0.00000 | ms/batch 256.31 | loss  2.73 | ppl    15.31 
| epoch  67 |   200/  269 batches | lr 0.00000 | ms/batch 230.07 | loss  2.70 | ppl    14.87 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 66.40s | valid loss  3.73 | valid ppl    41.68 | valid bpc    5.381
-----------------------------------------------------------------------------------------
PROGRESS: 67.0%
| epoch  68 |   100/  269 batches | lr 0.00000 | ms/batch 257.88 | loss  2.72 | ppl    15.22 
| epoch  68 |   200/  269 batches | lr 0.00000 | ms/batch 230.82 | loss  2.70 | ppl    14.83 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 66.81s | valid loss  3.71 | valid ppl    40.80 | valid bpc    5.350
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 68.0%
| epoch  69 |   100/  269 batches | lr 0.00000 | ms/batch 258.03 | loss  2.73 | ppl    15.27 
| epoch  69 |   200/  269 batches | lr 0.00000 | ms/batch 230.64 | loss  2.69 | ppl    14.80 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 66.84s | valid loss  3.72 | valid ppl    41.23 | valid bpc    5.366
-----------------------------------------------------------------------------------------
PROGRESS: 69.0%
| epoch  70 |   100/  269 batches | lr 0.00000 | ms/batch 257.69 | loss  2.73 | ppl    15.32 
| epoch  70 |   200/  269 batches | lr 0.00000 | ms/batch 231.91 | loss  2.67 | ppl    14.47 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 66.83s | valid loss  3.75 | valid ppl    42.41 | valid bpc    5.406
-----------------------------------------------------------------------------------------
PROGRESS: 70.0%
| epoch  71 |   100/  269 batches | lr 0.00000 | ms/batch 257.37 | loss  2.71 | ppl    14.97 
| epoch  71 |   200/  269 batches | lr 0.00000 | ms/batch 231.51 | loss  2.68 | ppl    14.60 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 66.83s | valid loss  3.75 | valid ppl    42.41 | valid bpc    5.406
-----------------------------------------------------------------------------------------
PROGRESS: 71.0%
| epoch  72 |   100/  269 batches | lr 0.00000 | ms/batch 257.08 | loss  2.72 | ppl    15.12 
| epoch  72 |   200/  269 batches | lr 0.00000 | ms/batch 232.34 | loss  2.68 | ppl    14.64 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 66.88s | valid loss  3.76 | valid ppl    42.91 | valid bpc    5.423
-----------------------------------------------------------------------------------------
PROGRESS: 72.0%
| epoch  73 |   100/  269 batches | lr 0.00000 | ms/batch 256.83 | loss  2.72 | ppl    15.19 
| epoch  73 |   200/  269 batches | lr 0.00000 | ms/batch 231.92 | loss  2.67 | ppl    14.37 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 66.83s | valid loss  3.75 | valid ppl    42.70 | valid bpc    5.416
-----------------------------------------------------------------------------------------
PROGRESS: 73.0%
| epoch  74 |   100/  269 batches | lr 0.00000 | ms/batch 257.31 | loss  2.72 | ppl    15.20 
| epoch  74 |   200/  269 batches | lr 0.00000 | ms/batch 226.12 | loss  2.71 | ppl    15.00 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 66.39s | valid loss  3.74 | valid ppl    41.90 | valid bpc    5.389
-----------------------------------------------------------------------------------------
PROGRESS: 74.0%
| epoch  75 |   100/  269 batches | lr 0.00000 | ms/batch 257.64 | loss  2.73 | ppl    15.28 
| epoch  75 |   200/  269 batches | lr 0.00000 | ms/batch 231.85 | loss  2.69 | ppl    14.69 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 66.91s | valid loss  3.77 | valid ppl    43.17 | valid bpc    5.432
-----------------------------------------------------------------------------------------
PROGRESS: 75.0%
| epoch  76 |   100/  269 batches | lr 0.00000 | ms/batch 256.80 | loss  2.73 | ppl    15.26 
| epoch  76 |   200/  269 batches | lr 0.00000 | ms/batch 227.63 | loss  2.70 | ppl    14.93 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 66.43s | valid loss  3.71 | valid ppl    40.72 | valid bpc    5.348
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 76.0%
| epoch  77 |   100/  269 batches | lr 0.00000 | ms/batch 258.57 | loss  2.73 | ppl    15.36 
| epoch  77 |   200/  269 batches | lr 0.00000 | ms/batch 230.53 | loss  2.70 | ppl    14.86 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 66.85s | valid loss  3.73 | valid ppl    41.60 | valid bpc    5.378
-----------------------------------------------------------------------------------------
PROGRESS: 77.0%
| epoch  78 |   100/  269 batches | lr 0.00000 | ms/batch 257.01 | loss  2.70 | ppl    14.84 
| epoch  78 |   200/  269 batches | lr 0.00000 | ms/batch 228.72 | loss  2.69 | ppl    14.73 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 66.55s | valid loss  3.71 | valid ppl    41.03 | valid bpc    5.358
-----------------------------------------------------------------------------------------
PROGRESS: 78.0%
| epoch  79 |   100/  269 batches | lr 0.00000 | ms/batch 257.89 | loss  2.72 | ppl    15.21 
| epoch  79 |   200/  269 batches | lr 0.00000 | ms/batch 224.57 | loss  2.68 | ppl    14.55 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 66.31s | valid loss  3.78 | valid ppl    43.64 | valid bpc    5.447
-----------------------------------------------------------------------------------------
PROGRESS: 79.0%
| epoch  80 |   100/  269 batches | lr 0.00000 | ms/batch 258.09 | loss  2.71 | ppl    15.08 
| epoch  80 |   200/  269 batches | lr 0.00000 | ms/batch 229.68 | loss  2.70 | ppl    14.83 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 66.79s | valid loss  3.68 | valid ppl    39.81 | valid bpc    5.315
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 80.0%
| epoch  81 |   100/  269 batches | lr 0.00000 | ms/batch 256.36 | loss  2.71 | ppl    15.07 
| epoch  81 |   200/  269 batches | lr 0.00000 | ms/batch 231.01 | loss  2.68 | ppl    14.64 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 66.81s | valid loss  3.72 | valid ppl    41.11 | valid bpc    5.362
-----------------------------------------------------------------------------------------
PROGRESS: 81.0%
| epoch  82 |   100/  269 batches | lr 0.00000 | ms/batch 257.42 | loss  2.71 | ppl    15.09 
| epoch  82 |   200/  269 batches | lr 0.00000 | ms/batch 232.79 | loss  2.69 | ppl    14.72 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 66.86s | valid loss  3.78 | valid ppl    43.74 | valid bpc    5.451
-----------------------------------------------------------------------------------------
PROGRESS: 82.0%
| epoch  83 |   100/  269 batches | lr 0.00000 | ms/batch 251.17 | loss  2.73 | ppl    15.39 
| epoch  83 |   200/  269 batches | lr 0.00000 | ms/batch 236.16 | loss  2.68 | ppl    14.60 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 66.81s | valid loss  3.73 | valid ppl    41.50 | valid bpc    5.375
-----------------------------------------------------------------------------------------
PROGRESS: 83.0%
| epoch  84 |   100/  269 batches | lr 0.00000 | ms/batch 247.77 | loss  2.74 | ppl    15.44 
| epoch  84 |   200/  269 batches | lr 0.00000 | ms/batch 236.01 | loss  2.68 | ppl    14.65 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 66.46s | valid loss  3.69 | valid ppl    40.19 | valid bpc    5.329
-----------------------------------------------------------------------------------------
PROGRESS: 84.0%
| epoch  85 |   100/  269 batches | lr 0.00000 | ms/batch 250.91 | loss  2.72 | ppl    15.25 
| epoch  85 |   200/  269 batches | lr 0.00000 | ms/batch 237.33 | loss  2.67 | ppl    14.37 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 66.83s | valid loss  3.73 | valid ppl    41.80 | valid bpc    5.385
-----------------------------------------------------------------------------------------
PROGRESS: 85.0%
| epoch  86 |   100/  269 batches | lr 0.00000 | ms/batch 250.06 | loss  2.70 | ppl    14.90 
| epoch  86 |   200/  269 batches | lr 0.00000 | ms/batch 238.66 | loss  2.68 | ppl    14.54 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 66.85s | valid loss  3.72 | valid ppl    41.34 | valid bpc    5.370
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  269 batches | lr 0.00000 | ms/batch 249.02 | loss  2.73 | ppl    15.37 
| epoch  87 |   200/  269 batches | lr 0.00000 | ms/batch 240.04 | loss  2.66 | ppl    14.36 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 66.87s | valid loss  3.70 | valid ppl    40.42 | valid bpc    5.337
-----------------------------------------------------------------------------------------
PROGRESS: 87.0%
| epoch  88 |   100/  269 batches | lr 0.00000 | ms/batch 245.99 | loss  2.70 | ppl    14.91 
| epoch  88 |   200/  269 batches | lr 0.00000 | ms/batch 242.90 | loss  2.69 | ppl    14.71 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 66.89s | valid loss  3.72 | valid ppl    41.39 | valid bpc    5.371
-----------------------------------------------------------------------------------------
PROGRESS: 88.0%
| epoch  89 |   100/  269 batches | lr 0.00000 | ms/batch 244.28 | loss  2.74 | ppl    15.45 
| epoch  89 |   200/  269 batches | lr 0.00000 | ms/batch 243.46 | loss  2.71 | ppl    14.98 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 66.81s | valid loss  3.74 | valid ppl    42.06 | valid bpc    5.394
-----------------------------------------------------------------------------------------
PROGRESS: 89.0%
| epoch  90 |   100/  269 batches | lr 0.00000 | ms/batch 246.21 | loss  2.73 | ppl    15.36 
| epoch  90 |   200/  269 batches | lr 0.00000 | ms/batch 242.68 | loss  2.67 | ppl    14.44 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 66.87s | valid loss  3.72 | valid ppl    41.32 | valid bpc    5.369
-----------------------------------------------------------------------------------------
PROGRESS: 90.0%
| epoch  91 |   100/  269 batches | lr 0.00000 | ms/batch 245.14 | loss  2.71 | ppl    15.05 
| epoch  91 |   200/  269 batches | lr 0.00000 | ms/batch 243.00 | loss  2.69 | ppl    14.75 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 66.82s | valid loss  3.75 | valid ppl    42.54 | valid bpc    5.411
-----------------------------------------------------------------------------------------
PROGRESS: 91.0%
| epoch  92 |   100/  269 batches | lr 0.00000 | ms/batch 245.55 | loss  2.73 | ppl    15.34 
| epoch  92 |   200/  269 batches | lr 0.00000 | ms/batch 243.91 | loss  2.70 | ppl    14.89 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 66.82s | valid loss  3.70 | valid ppl    40.53 | valid bpc    5.341
-----------------------------------------------------------------------------------------
PROGRESS: 92.0%
| epoch  93 |   100/  269 batches | lr 0.00000 | ms/batch 246.95 | loss  2.71 | ppl    15.01 
| epoch  93 |   200/  269 batches | lr 0.00000 | ms/batch 241.68 | loss  2.69 | ppl    14.76 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 66.78s | valid loss  3.73 | valid ppl    41.64 | valid bpc    5.380
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  269 batches | lr 0.00000 | ms/batch 244.91 | loss  2.71 | ppl    15.03 
| epoch  94 |   200/  269 batches | lr 0.00000 | ms/batch 242.68 | loss  2.68 | ppl    14.64 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 66.88s | valid loss  3.74 | valid ppl    42.10 | valid bpc    5.396
-----------------------------------------------------------------------------------------
PROGRESS: 94.0%
| epoch  95 |   100/  269 batches | lr 0.00000 | ms/batch 247.53 | loss  2.73 | ppl    15.40 
| epoch  95 |   200/  269 batches | lr 0.00000 | ms/batch 240.93 | loss  2.66 | ppl    14.30 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 66.85s | valid loss  3.80 | valid ppl    44.77 | valid bpc    5.484
-----------------------------------------------------------------------------------------
PROGRESS: 95.0%
| epoch  96 |   100/  269 batches | lr 0.00000 | ms/batch 244.09 | loss  2.71 | ppl    14.98 
| epoch  96 |   200/  269 batches | lr 0.00000 | ms/batch 243.24 | loss  2.68 | ppl    14.63 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 66.79s | valid loss  3.74 | valid ppl    42.23 | valid bpc    5.400
-----------------------------------------------------------------------------------------
PROGRESS: 96.0%
| epoch  97 |   100/  269 batches | lr 0.00000 | ms/batch 245.86 | loss  2.73 | ppl    15.40 
| epoch  97 |   200/  269 batches | lr 0.00000 | ms/batch 243.37 | loss  2.67 | ppl    14.44 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 66.87s | valid loss  3.73 | valid ppl    41.61 | valid bpc    5.379
-----------------------------------------------------------------------------------------
PROGRESS: 97.0%
| epoch  98 |   100/  269 batches | lr 0.00000 | ms/batch 246.37 | loss  2.70 | ppl    14.93 
| epoch  98 |   200/  269 batches | lr 0.00000 | ms/batch 242.37 | loss  2.69 | ppl    14.69 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 66.83s | valid loss  3.82 | valid ppl    45.66 | valid bpc    5.513
-----------------------------------------------------------------------------------------
PROGRESS: 98.0%
| epoch  99 |   100/  269 batches | lr 0.00000 | ms/batch 246.34 | loss  2.73 | ppl    15.28 
| epoch  99 |   200/  269 batches | lr 0.00000 | ms/batch 242.01 | loss  2.68 | ppl    14.56 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 66.65s | valid loss  3.66 | valid ppl    39.00 | valid bpc    5.285
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 99.0%
| epoch 100 |   100/  269 batches | lr 0.00000 | ms/batch 252.58 | loss  2.72 | ppl    15.24 
| epoch 100 |   200/  269 batches | lr 0.00000 | ms/batch 242.01 | loss  2.66 | ppl    14.32 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 66.87s | valid loss  3.74 | valid ppl    42.22 | valid bpc    5.400
-----------------------------------------------------------------------------------------
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  3.81 | test ppl    45.15 | test bpc    5.496
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.3953, Mean Reca: 0.5572, Mean F1: 0.4586, Mean Subword_Reca: 0.8348
-----------------------------------------------------------------------------------------
=========================================================================================
Loading dataset...
Using subword tokenizer...
Number of tokens:  8000
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer_in_parser', nhid=512, nlayers=8, front_layers=1, rear_layers=7, subword='omarmomen/ptb_filtered_lowcase_bpe_tokenizer_8', n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=2222, nonmono=5, cuda=True, log_interval=100, save='trained_models/subword_structformer_in_parser_2222_17.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 37449140
Model architecture: StructFormer_In_Parser(
  (transformer_front): Transformer_Front(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(8000, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0): TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
  (transformer_rear): Transformer_Rear(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(8000, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-6): 7 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (output_layer): Linear(in_features=512, out_features=8000, bias=True)
  )
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  269 batches | lr 0.00030 | ms/batch 266.50 | loss  7.76 | ppl  2339.28 
| epoch   1 |   200/  269 batches | lr 0.00030 | ms/batch 236.00 | loss  7.34 | ppl  1540.95 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 67.58s | valid loss  7.01 | valid ppl  1107.09 | valid bpc   10.113
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  269 batches | lr 0.00030 | ms/batch 256.35 | loss  7.17 | ppl  1296.17 
| epoch   2 |   200/  269 batches | lr 0.00030 | ms/batch 236.23 | loss  6.76 | ppl   859.50 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 66.80s | valid loss  6.12 | valid ppl   456.40 | valid bpc    8.834
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  269 batches | lr 0.00030 | ms/batch 258.13 | loss  6.29 | ppl   537.46 
| epoch   3 |   200/  269 batches | lr 0.00030 | ms/batch 236.04 | loss  6.03 | ppl   413.98 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 66.87s | valid loss  5.66 | valid ppl   286.86 | valid bpc    8.164
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  269 batches | lr 0.00030 | ms/batch 257.00 | loss  5.85 | ppl   347.90 
| epoch   4 |   200/  269 batches | lr 0.00030 | ms/batch 231.23 | loss  5.71 | ppl   300.46 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 61.99s | valid loss  5.42 | valid ppl   226.31 | valid bpc    7.822
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  269 batches | lr 0.00030 | ms/batch 180.49 | loss  5.58 | ppl   266.03 
| epoch   5 |   200/  269 batches | lr 0.00030 | ms/batch 167.68 | loss  5.50 | ppl   245.90 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 47.50s | valid loss  5.22 | valid ppl   185.06 | valid bpc    7.532
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  269 batches | lr 0.00030 | ms/batch 165.36 | loss  5.39 | ppl   218.75 
| epoch   6 |   200/  269 batches | lr 0.00030 | ms/batch 91.72 | loss  5.28 | ppl   196.42 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 32.42s | valid loss  5.06 | valid ppl   158.29 | valid bpc    7.306
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  269 batches | lr 0.00030 | ms/batch 93.64 | loss  5.24 | ppl   187.83 
| epoch   7 |   200/  269 batches | lr 0.00030 | ms/batch 139.52 | loss  5.13 | ppl   169.68 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 35.25s | valid loss  4.94 | valid ppl   139.60 | valid bpc    7.125
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  269 batches | lr 0.00030 | ms/batch 168.94 | loss  5.08 | ppl   160.18 
| epoch   8 |   200/  269 batches | lr 0.00030 | ms/batch 178.68 | loss  5.00 | ppl   148.11 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 52.60s | valid loss  4.79 | valid ppl   120.05 | valid bpc    6.907
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 8.0%
| epoch   9 |   100/  269 batches | lr 0.00030 | ms/batch 256.45 | loss  4.94 | ppl   140.06 
| epoch   9 |   200/  269 batches | lr 0.00030 | ms/batch 225.22 | loss  4.88 | ppl   131.83 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 66.09s | valid loss  4.71 | valid ppl   111.15 | valid bpc    6.796
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  269 batches | lr 0.00030 | ms/batch 257.88 | loss  4.83 | ppl   125.08 
| epoch  10 |   200/  269 batches | lr 0.00030 | ms/batch 223.40 | loss  4.77 | ppl   117.40 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 66.08s | valid loss  4.60 | valid ppl    99.75 | valid bpc    6.640
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  269 batches | lr 0.00030 | ms/batch 258.21 | loss  4.72 | ppl   112.06 
| epoch  11 |   200/  269 batches | lr 0.00030 | ms/batch 222.49 | loss  4.64 | ppl   103.06 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 66.06s | valid loss  4.55 | valid ppl    94.57 | valid bpc    6.563
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  269 batches | lr 0.00030 | ms/batch 257.65 | loss  4.62 | ppl   101.07 
| epoch  12 |   200/  269 batches | lr 0.00030 | ms/batch 222.42 | loss  4.51 | ppl    91.38 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 66.13s | valid loss  4.48 | valid ppl    88.18 | valid bpc    6.462
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 12.0%
| epoch  13 |   100/  269 batches | lr 0.00030 | ms/batch 257.83 | loss  4.51 | ppl    90.79 
| epoch  13 |   200/  269 batches | lr 0.00030 | ms/batch 224.14 | loss  4.45 | ppl    85.24 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 66.07s | valid loss  4.42 | valid ppl    82.83 | valid bpc    6.372
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 13.0%
| epoch  14 |   100/  269 batches | lr 0.00030 | ms/batch 258.10 | loss  4.42 | ppl    83.25 
| epoch  14 |   200/  269 batches | lr 0.00030 | ms/batch 216.19 | loss  4.34 | ppl    77.05 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 65.41s | valid loss  4.33 | valid ppl    75.75 | valid bpc    6.243
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  269 batches | lr 0.00030 | ms/batch 256.04 | loss  4.33 | ppl    75.91 
| epoch  15 |   200/  269 batches | lr 0.00030 | ms/batch 224.69 | loss  4.29 | ppl    73.04 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 66.05s | valid loss  4.31 | valid ppl    74.25 | valid bpc    6.214
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 15.0%
| epoch  16 |   100/  269 batches | lr 0.00030 | ms/batch 253.41 | loss  4.25 | ppl    69.97 
| epoch  16 |   200/  269 batches | lr 0.00030 | ms/batch 228.46 | loss  4.22 | ppl    68.18 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 66.08s | valid loss  4.29 | valid ppl    72.97 | valid bpc    6.189
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 16.0%
| epoch  17 |   100/  269 batches | lr 0.00030 | ms/batch 249.41 | loss  4.17 | ppl    64.66 
| epoch  17 |   200/  269 batches | lr 0.00030 | ms/batch 231.19 | loss  4.14 | ppl    62.56 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 66.07s | valid loss  4.21 | valid ppl    67.49 | valid bpc    6.077
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 17.0%
| epoch  18 |   100/  269 batches | lr 0.00030 | ms/batch 244.69 | loss  4.09 | ppl    59.51 
| epoch  18 |   200/  269 batches | lr 0.00030 | ms/batch 237.70 | loss  4.10 | ppl    60.07 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 66.13s | valid loss  4.22 | valid ppl    68.03 | valid bpc    6.088
-----------------------------------------------------------------------------------------
PROGRESS: 18.0%
| epoch  19 |   100/  269 batches | lr 0.00030 | ms/batch 243.42 | loss  4.05 | ppl    57.51 
| epoch  19 |   200/  269 batches | lr 0.00030 | ms/batch 233.94 | loss  4.01 | ppl    55.05 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 65.72s | valid loss  4.21 | valid ppl    67.64 | valid bpc    6.080
-----------------------------------------------------------------------------------------
PROGRESS: 19.0%
| epoch  20 |   100/  269 batches | lr 0.00030 | ms/batch 249.93 | loss  3.99 | ppl    54.21 
| epoch  20 |   200/  269 batches | lr 0.00030 | ms/batch 235.34 | loss  3.96 | ppl    52.40 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 66.46s | valid loss  4.16 | valid ppl    64.28 | valid bpc    6.006
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 20.0%
| epoch  21 |   100/  269 batches | lr 0.00030 | ms/batch 240.94 | loss  3.92 | ppl    50.46 
| epoch  21 |   200/  269 batches | lr 0.00030 | ms/batch 233.15 | loss  3.90 | ppl    49.42 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 65.35s | valid loss  4.09 | valid ppl    59.84 | valid bpc    5.903
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 21.0%
| epoch  22 |   100/  269 batches | lr 0.00030 | ms/batch 244.02 | loss  3.86 | ppl    47.59 
| epoch  22 |   200/  269 batches | lr 0.00030 | ms/batch 239.21 | loss  3.86 | ppl    47.67 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 66.13s | valid loss  4.07 | valid ppl    58.79 | valid bpc    5.878
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 22.0%
| epoch  23 |   100/  269 batches | lr 0.00030 | ms/batch 239.00 | loss  3.84 | ppl    46.50 
| epoch  23 |   200/  269 batches | lr 0.00030 | ms/batch 241.99 | loss  3.79 | ppl    44.46 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 66.05s | valid loss  4.06 | valid ppl    57.81 | valid bpc    5.853
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 23.0%
| epoch  24 |   100/  269 batches | lr 0.00030 | ms/batch 237.73 | loss  3.79 | ppl    44.07 
| epoch  24 |   200/  269 batches | lr 0.00030 | ms/batch 243.70 | loss  3.76 | ppl    43.14 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 66.20s | valid loss  4.04 | valid ppl    56.72 | valid bpc    5.826
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 24.0%
| epoch  25 |   100/  269 batches | lr 0.00030 | ms/batch 238.20 | loss  3.73 | ppl    41.56 
| epoch  25 |   200/  269 batches | lr 0.00030 | ms/batch 242.99 | loss  3.74 | ppl    41.95 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 66.10s | valid loss  4.02 | valid ppl    55.81 | valid bpc    5.802
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 25.0%
| epoch  26 |   100/  269 batches | lr 0.00030 | ms/batch 238.34 | loss  3.69 | ppl    40.24 
| epoch  26 |   200/  269 batches | lr 0.00030 | ms/batch 242.56 | loss  3.68 | ppl    39.50 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 66.02s | valid loss  4.01 | valid ppl    55.25 | valid bpc    5.788
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 26.0%
| epoch  27 |   100/  269 batches | lr 0.00030 | ms/batch 237.18 | loss  3.66 | ppl    38.80 
| epoch  27 |   200/  269 batches | lr 0.00030 | ms/batch 242.15 | loss  3.63 | ppl    37.64 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 65.99s | valid loss  4.01 | valid ppl    55.33 | valid bpc    5.790
-----------------------------------------------------------------------------------------
PROGRESS: 27.0%
| epoch  28 |   100/  269 batches | lr 0.00030 | ms/batch 236.90 | loss  3.61 | ppl    36.84 
| epoch  28 |   200/  269 batches | lr 0.00030 | ms/batch 242.23 | loss  3.62 | ppl    37.29 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 65.91s | valid loss  3.94 | valid ppl    51.17 | valid bpc    5.677
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  269 batches | lr 0.00030 | ms/batch 241.65 | loss  3.55 | ppl    34.81 
| epoch  29 |   200/  269 batches | lr 0.00030 | ms/batch 243.44 | loss  3.55 | ppl    34.71 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 66.49s | valid loss  3.98 | valid ppl    53.26 | valid bpc    5.735
-----------------------------------------------------------------------------------------
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  269 batches | lr 0.00030 | ms/batch 238.85 | loss  3.52 | ppl    33.91 
| epoch  30 |   200/  269 batches | lr 0.00030 | ms/batch 243.97 | loss  3.53 | ppl    33.96 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 66.18s | valid loss  3.97 | valid ppl    52.92 | valid bpc    5.726
-----------------------------------------------------------------------------------------
PROGRESS: 30.0%
| epoch  31 |   100/  269 batches | lr 0.00030 | ms/batch 241.75 | loss  3.49 | ppl    32.76 
| epoch  31 |   200/  269 batches | lr 0.00030 | ms/batch 242.83 | loss  3.51 | ppl    33.38 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 66.37s | valid loss  3.99 | valid ppl    54.00 | valid bpc    5.755
-----------------------------------------------------------------------------------------
PROGRESS: 31.0%
| epoch  32 |   100/  269 batches | lr 0.00015 | ms/batch 238.33 | loss  3.41 | ppl    30.39 
| epoch  32 |   200/  269 batches | lr 0.00015 | ms/batch 243.07 | loss  3.37 | ppl    29.09 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 66.11s | valid loss  3.89 | valid ppl    49.06 | valid bpc    5.617
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 32.0%
| epoch  33 |   100/  269 batches | lr 0.00015 | ms/batch 235.95 | loss  3.34 | ppl    28.33 
| epoch  33 |   200/  269 batches | lr 0.00015 | ms/batch 243.18 | loss  3.33 | ppl    27.85 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 66.00s | valid loss  3.87 | valid ppl    47.93 | valid bpc    5.583
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 33.0%
| epoch  34 |   100/  269 batches | lr 0.00015 | ms/batch 236.91 | loss  3.31 | ppl    27.47 
| epoch  34 |   200/  269 batches | lr 0.00015 | ms/batch 242.72 | loss  3.31 | ppl    27.32 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 65.93s | valid loss  3.89 | valid ppl    49.01 | valid bpc    5.615
-----------------------------------------------------------------------------------------
PROGRESS: 34.0%
| epoch  35 |   100/  269 batches | lr 0.00015 | ms/batch 238.34 | loss  3.30 | ppl    27.21 
| epoch  35 |   200/  269 batches | lr 0.00015 | ms/batch 241.87 | loss  3.28 | ppl    26.51 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 65.99s | valid loss  3.89 | valid ppl    48.99 | valid bpc    5.615
-----------------------------------------------------------------------------------------
PROGRESS: 35.0%
| epoch  36 |   100/  269 batches | lr 0.00015 | ms/batch 239.39 | loss  3.27 | ppl    26.39 
| epoch  36 |   200/  269 batches | lr 0.00015 | ms/batch 241.63 | loss  3.24 | ppl    25.59 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 66.01s | valid loss  3.92 | valid ppl    50.23 | valid bpc    5.651
-----------------------------------------------------------------------------------------
PROGRESS: 36.0%
| epoch  37 |   100/  269 batches | lr 0.00007 | ms/batch 243.09 | loss  3.21 | ppl    24.90 
| epoch  37 |   200/  269 batches | lr 0.00007 | ms/batch 242.69 | loss  3.19 | ppl    24.29 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 66.49s | valid loss  3.88 | valid ppl    48.26 | valid bpc    5.593
-----------------------------------------------------------------------------------------
PROGRESS: 37.0%
| epoch  38 |   100/  269 batches | lr 0.00007 | ms/batch 240.80 | loss  3.16 | ppl    23.55 
| epoch  38 |   200/  269 batches | lr 0.00007 | ms/batch 241.98 | loss  3.15 | ppl    23.24 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 66.31s | valid loss  3.85 | valid ppl    47.00 | valid bpc    5.555
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 38.0%
| epoch  39 |   100/  269 batches | lr 0.00007 | ms/batch 239.49 | loss  3.18 | ppl    23.98 
| epoch  39 |   200/  269 batches | lr 0.00007 | ms/batch 241.96 | loss  3.14 | ppl    23.02 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 66.07s | valid loss  3.87 | valid ppl    47.76 | valid bpc    5.578
-----------------------------------------------------------------------------------------
PROGRESS: 39.0%
| epoch  40 |   100/  269 batches | lr 0.00007 | ms/batch 237.87 | loss  3.15 | ppl    23.37 
| epoch  40 |   200/  269 batches | lr 0.00007 | ms/batch 243.15 | loss  3.15 | ppl    23.33 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 66.15s | valid loss  3.88 | valid ppl    48.30 | valid bpc    5.594
-----------------------------------------------------------------------------------------
PROGRESS: 40.0%
| epoch  41 |   100/  269 batches | lr 0.00007 | ms/batch 238.73 | loss  3.12 | ppl    22.56 
| epoch  41 |   200/  269 batches | lr 0.00007 | ms/batch 243.00 | loss  3.11 | ppl    22.33 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 66.17s | valid loss  3.85 | valid ppl    47.21 | valid bpc    5.561
-----------------------------------------------------------------------------------------
PROGRESS: 41.0%
| epoch  42 |   100/  269 batches | lr 0.00004 | ms/batch 245.24 | loss  3.10 | ppl    22.29 
| epoch  42 |   200/  269 batches | lr 0.00004 | ms/batch 243.41 | loss  3.08 | ppl    21.70 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 66.89s | valid loss  3.86 | valid ppl    47.49 | valid bpc    5.570
-----------------------------------------------------------------------------------------
PROGRESS: 42.0%
| epoch  43 |   100/  269 batches | lr 0.00004 | ms/batch 245.01 | loss  3.11 | ppl    22.41 
| epoch  43 |   200/  269 batches | lr 0.00004 | ms/batch 243.34 | loss  3.06 | ppl    21.34 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 66.88s | valid loss  3.85 | valid ppl    46.90 | valid bpc    5.551
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 43.0%
| epoch  44 |   100/  269 batches | lr 0.00004 | ms/batch 237.77 | loss  3.09 | ppl    21.98 
| epoch  44 |   200/  269 batches | lr 0.00004 | ms/batch 243.35 | loss  3.07 | ppl    21.54 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 66.07s | valid loss  3.82 | valid ppl    45.55 | valid bpc    5.509
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 44.0%
| epoch  45 |   100/  269 batches | lr 0.00004 | ms/batch 242.32 | loss  3.08 | ppl    21.66 
| epoch  45 |   200/  269 batches | lr 0.00004 | ms/batch 242.30 | loss  3.05 | ppl    21.04 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 66.47s | valid loss  3.81 | valid ppl    44.95 | valid bpc    5.490
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 45.0%
| epoch  46 |   100/  269 batches | lr 0.00004 | ms/batch 234.26 | loss  3.07 | ppl    21.53 
| epoch  46 |   200/  269 batches | lr 0.00004 | ms/batch 244.03 | loss  3.05 | ppl    21.14 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 65.78s | valid loss  3.90 | valid ppl    49.40 | valid bpc    5.626
-----------------------------------------------------------------------------------------
PROGRESS: 46.0%
| epoch  47 |   100/  269 batches | lr 0.00004 | ms/batch 241.85 | loss  3.06 | ppl    21.31 
| epoch  47 |   200/  269 batches | lr 0.00004 | ms/batch 242.97 | loss  3.05 | ppl    21.17 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 66.11s | valid loss  3.82 | valid ppl    45.69 | valid bpc    5.514
-----------------------------------------------------------------------------------------
PROGRESS: 47.0%
| epoch  48 |   100/  269 batches | lr 0.00004 | ms/batch 244.33 | loss  3.04 | ppl    20.99 
| epoch  48 |   200/  269 batches | lr 0.00004 | ms/batch 243.41 | loss  3.02 | ppl    20.40 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 66.35s | valid loss  3.82 | valid ppl    45.82 | valid bpc    5.518
-----------------------------------------------------------------------------------------
PROGRESS: 48.0%
| epoch  49 |   100/  269 batches | lr 0.00002 | ms/batch 246.89 | loss  3.04 | ppl    20.86 
| epoch  49 |   200/  269 batches | lr 0.00002 | ms/batch 242.63 | loss  3.00 | ppl    19.99 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 66.36s | valid loss  3.82 | valid ppl    45.57 | valid bpc    5.510
-----------------------------------------------------------------------------------------
PROGRESS: 49.0%
| epoch  50 |   100/  269 batches | lr 0.00002 | ms/batch 246.06 | loss  3.04 | ppl    20.82 
| epoch  50 |   200/  269 batches | lr 0.00002 | ms/batch 242.44 | loss  3.00 | ppl    19.99 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 66.03s | valid loss  3.84 | valid ppl    46.48 | valid bpc    5.538
-----------------------------------------------------------------------------------------
PROGRESS: 50.0%
| epoch  51 |   100/  269 batches | lr 0.00002 | ms/batch 251.12 | loss  3.02 | ppl    20.46 
| epoch  51 |   200/  269 batches | lr 0.00002 | ms/batch 243.26 | loss  3.03 | ppl    20.67 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 66.72s | valid loss  3.87 | valid ppl    48.02 | valid bpc    5.586
-----------------------------------------------------------------------------------------
PROGRESS: 51.0%
| epoch  52 |   100/  269 batches | lr 0.00001 | ms/batch 247.54 | loss  3.03 | ppl    20.79 
| epoch  52 |   200/  269 batches | lr 0.00001 | ms/batch 242.04 | loss  2.98 | ppl    19.64 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 66.16s | valid loss  3.86 | valid ppl    47.63 | valid bpc    5.574
-----------------------------------------------------------------------------------------
PROGRESS: 52.0%
| epoch  53 |   100/  269 batches | lr 0.00001 | ms/batch 251.54 | loss  3.02 | ppl    20.52 
| epoch  53 |   200/  269 batches | lr 0.00001 | ms/batch 243.30 | loss  2.99 | ppl    19.84 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 66.83s | valid loss  3.86 | valid ppl    47.69 | valid bpc    5.576
-----------------------------------------------------------------------------------------
PROGRESS: 53.0%
| epoch  54 |   100/  269 batches | lr 0.00001 | ms/batch 250.79 | loss  3.03 | ppl    20.60 
| epoch  54 |   200/  269 batches | lr 0.00001 | ms/batch 242.91 | loss  2.98 | ppl    19.78 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 66.83s | valid loss  3.85 | valid ppl    46.81 | valid bpc    5.549
-----------------------------------------------------------------------------------------
PROGRESS: 54.0%
| epoch  55 |   100/  269 batches | lr 0.00000 | ms/batch 250.95 | loss  3.02 | ppl    20.42 
| epoch  55 |   200/  269 batches | lr 0.00000 | ms/batch 243.23 | loss  2.97 | ppl    19.46 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 66.81s | valid loss  3.80 | valid ppl    44.89 | valid bpc    5.488
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  269 batches | lr 0.00000 | ms/batch 246.19 | loss  3.02 | ppl    20.49 
| epoch  56 |   200/  269 batches | lr 0.00000 | ms/batch 242.23 | loss  2.97 | ppl    19.49 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 66.36s | valid loss  3.82 | valid ppl    45.63 | valid bpc    5.512
-----------------------------------------------------------------------------------------
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  269 batches | lr 0.00000 | ms/batch 252.73 | loss  3.02 | ppl    20.40 
| epoch  57 |   200/  269 batches | lr 0.00000 | ms/batch 242.55 | loss  2.99 | ppl    19.97 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 66.49s | valid loss  3.91 | valid ppl    49.84 | valid bpc    5.639
-----------------------------------------------------------------------------------------
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  269 batches | lr 0.00000 | ms/batch 251.58 | loss  2.99 | ppl    19.88 
| epoch  58 |   200/  269 batches | lr 0.00000 | ms/batch 242.77 | loss  2.99 | ppl    19.90 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 66.63s | valid loss  3.84 | valid ppl    46.58 | valid bpc    5.542
-----------------------------------------------------------------------------------------
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  269 batches | lr 0.00000 | ms/batch 250.28 | loss  2.99 | ppl    19.93 
| epoch  59 |   200/  269 batches | lr 0.00000 | ms/batch 242.21 | loss  3.00 | ppl    20.08 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 66.57s | valid loss  3.84 | valid ppl    46.53 | valid bpc    5.540
-----------------------------------------------------------------------------------------
PROGRESS: 59.0%
| epoch  60 |   100/  269 batches | lr 0.00000 | ms/batch 245.17 | loss  2.98 | ppl    19.74 
| epoch  60 |   200/  269 batches | lr 0.00000 | ms/batch 242.63 | loss  2.98 | ppl    19.78 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 66.17s | valid loss  3.89 | valid ppl    48.70 | valid bpc    5.606
-----------------------------------------------------------------------------------------
PROGRESS: 60.0%
| epoch  61 |   100/  269 batches | lr 0.00000 | ms/batch 250.15 | loss  3.01 | ppl    20.23 
| epoch  61 |   200/  269 batches | lr 0.00000 | ms/batch 243.18 | loss  2.98 | ppl    19.77 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 66.85s | valid loss  3.82 | valid ppl    45.79 | valid bpc    5.517
-----------------------------------------------------------------------------------------
PROGRESS: 61.0%
| epoch  62 |   100/  269 batches | lr 0.00000 | ms/batch 245.43 | loss  2.99 | ppl    19.91 
| epoch  62 |   200/  269 batches | lr 0.00000 | ms/batch 240.87 | loss  2.98 | ppl    19.70 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 65.95s | valid loss  3.85 | valid ppl    47.01 | valid bpc    5.555
-----------------------------------------------------------------------------------------
PROGRESS: 62.0%
| epoch  63 |   100/  269 batches | lr 0.00000 | ms/batch 246.91 | loss  3.01 | ppl    20.33 
| epoch  63 |   200/  269 batches | lr 0.00000 | ms/batch 238.95 | loss  2.97 | ppl    19.46 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 65.97s | valid loss  3.83 | valid ppl    46.24 | valid bpc    5.531
-----------------------------------------------------------------------------------------
PROGRESS: 63.0%
| epoch  64 |   100/  269 batches | lr 0.00000 | ms/batch 250.43 | loss  3.00 | ppl    20.08 
| epoch  64 |   200/  269 batches | lr 0.00000 | ms/batch 238.29 | loss  2.95 | ppl    19.08 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 66.89s | valid loss  3.86 | valid ppl    47.56 | valid bpc    5.572
-----------------------------------------------------------------------------------------
PROGRESS: 64.0%
| epoch  65 |   100/  269 batches | lr 0.00000 | ms/batch 251.16 | loss  3.01 | ppl    20.38 
| epoch  65 |   200/  269 batches | lr 0.00000 | ms/batch 236.44 | loss  2.98 | ppl    19.77 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 66.81s | valid loss  3.76 | valid ppl    42.96 | valid bpc    5.425
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 65.0%
| epoch  66 |   100/  269 batches | lr 0.00000 | ms/batch 257.15 | loss  3.00 | ppl    20.03 
| epoch  66 |   200/  269 batches | lr 0.00000 | ms/batch 238.22 | loss  2.97 | ppl    19.45 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 66.89s | valid loss  3.89 | valid ppl    49.11 | valid bpc    5.618
-----------------------------------------------------------------------------------------
PROGRESS: 66.0%
| epoch  67 |   100/  269 batches | lr 0.00000 | ms/batch 257.02 | loss  2.99 | ppl    19.94 
| epoch  67 |   200/  269 batches | lr 0.00000 | ms/batch 237.90 | loss  2.97 | ppl    19.43 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 66.81s | valid loss  3.85 | valid ppl    46.89 | valid bpc    5.551
-----------------------------------------------------------------------------------------
PROGRESS: 67.0%
| epoch  68 |   100/  269 batches | lr 0.00000 | ms/batch 255.82 | loss  3.00 | ppl    19.99 
| epoch  68 |   200/  269 batches | lr 0.00000 | ms/batch 237.59 | loss  2.96 | ppl    19.24 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 66.82s | valid loss  3.83 | valid ppl    45.99 | valid bpc    5.523
-----------------------------------------------------------------------------------------
PROGRESS: 68.0%
| epoch  69 |   100/  269 batches | lr 0.00000 | ms/batch 256.66 | loss  3.01 | ppl    20.38 
| epoch  69 |   200/  269 batches | lr 0.00000 | ms/batch 235.95 | loss  2.98 | ppl    19.75 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 66.78s | valid loss  3.86 | valid ppl    47.54 | valid bpc    5.571
-----------------------------------------------------------------------------------------
PROGRESS: 69.0%
| epoch  70 |   100/  269 batches | lr 0.00000 | ms/batch 255.81 | loss  3.01 | ppl    20.34 
| epoch  70 |   200/  269 batches | lr 0.00000 | ms/batch 238.32 | loss  2.97 | ppl    19.41 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 66.48s | valid loss  3.84 | valid ppl    46.40 | valid bpc    5.536
-----------------------------------------------------------------------------------------
PROGRESS: 70.0%
| epoch  71 |   100/  269 batches | lr 0.00000 | ms/batch 256.93 | loss  3.01 | ppl    20.20 
| epoch  71 |   200/  269 batches | lr 0.00000 | ms/batch 236.55 | loss  2.98 | ppl    19.64 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 66.76s | valid loss  3.82 | valid ppl    45.76 | valid bpc    5.516
-----------------------------------------------------------------------------------------
PROGRESS: 71.0%
| epoch  72 |   100/  269 batches | lr 0.00000 | ms/batch 257.05 | loss  3.01 | ppl    20.29 
| epoch  72 |   200/  269 batches | lr 0.00000 | ms/batch 236.15 | loss  2.97 | ppl    19.46 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 66.86s | valid loss  3.83 | valid ppl    45.97 | valid bpc    5.523
-----------------------------------------------------------------------------------------
PROGRESS: 72.0%
| epoch  73 |   100/  269 batches | lr 0.00000 | ms/batch 257.87 | loss  3.00 | ppl    20.03 
| epoch  73 |   200/  269 batches | lr 0.00000 | ms/batch 237.00 | loss  2.99 | ppl    19.97 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 66.86s | valid loss  3.82 | valid ppl    45.43 | valid bpc    5.506
-----------------------------------------------------------------------------------------
PROGRESS: 73.0%
| epoch  74 |   100/  269 batches | lr 0.00000 | ms/batch 256.60 | loss  3.00 | ppl    20.07 
| epoch  74 |   200/  269 batches | lr 0.00000 | ms/batch 234.07 | loss  2.97 | ppl    19.50 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 66.16s | valid loss  3.85 | valid ppl    47.02 | valid bpc    5.555
-----------------------------------------------------------------------------------------
PROGRESS: 74.0%
| epoch  75 |   100/  269 batches | lr 0.00000 | ms/batch 257.81 | loss  2.99 | ppl    19.98 
| epoch  75 |   200/  269 batches | lr 0.00000 | ms/batch 234.61 | loss  2.97 | ppl    19.51 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 66.51s | valid loss  3.84 | valid ppl    46.46 | valid bpc    5.538
-----------------------------------------------------------------------------------------
PROGRESS: 75.0%
| epoch  76 |   100/  269 batches | lr 0.00000 | ms/batch 257.46 | loss  3.00 | ppl    20.01 
| epoch  76 |   200/  269 batches | lr 0.00000 | ms/batch 236.84 | loss  2.98 | ppl    19.64 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 66.89s | valid loss  3.85 | valid ppl    47.17 | valid bpc    5.560
-----------------------------------------------------------------------------------------
PROGRESS: 76.0%
| epoch  77 |   100/  269 batches | lr 0.00000 | ms/batch 257.23 | loss  3.01 | ppl    20.33 
| epoch  77 |   200/  269 batches | lr 0.00000 | ms/batch 237.47 | loss  2.96 | ppl    19.30 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 66.90s | valid loss  3.84 | valid ppl    46.61 | valid bpc    5.543
-----------------------------------------------------------------------------------------
PROGRESS: 77.0%
| epoch  78 |   100/  269 batches | lr 0.00000 | ms/batch 257.90 | loss  3.00 | ppl    20.03 
| epoch  78 |   200/  269 batches | lr 0.00000 | ms/batch 236.50 | loss  2.97 | ppl    19.51 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 66.89s | valid loss  3.88 | valid ppl    48.25 | valid bpc    5.593
-----------------------------------------------------------------------------------------
PROGRESS: 78.0%
| epoch  79 |   100/  269 batches | lr 0.00000 | ms/batch 257.71 | loss  3.00 | ppl    20.03 
| epoch  79 |   200/  269 batches | lr 0.00000 | ms/batch 237.17 | loss  2.97 | ppl    19.53 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 66.82s | valid loss  3.85 | valid ppl    46.80 | valid bpc    5.548
-----------------------------------------------------------------------------------------
PROGRESS: 79.0%
| epoch  80 |   100/  269 batches | lr 0.00000 | ms/batch 253.40 | loss  3.01 | ppl    20.28 
| epoch  80 |   200/  269 batches | lr 0.00000 | ms/batch 241.35 | loss  2.97 | ppl    19.50 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 66.89s | valid loss  3.81 | valid ppl    44.96 | valid bpc    5.490
-----------------------------------------------------------------------------------------
PROGRESS: 80.0%
| epoch  81 |   100/  269 batches | lr 0.00000 | ms/batch 251.30 | loss  2.99 | ppl    19.83 
| epoch  81 |   200/  269 batches | lr 0.00000 | ms/batch 242.64 | loss  2.98 | ppl    19.74 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 66.86s | valid loss  3.81 | valid ppl    45.11 | valid bpc    5.495
-----------------------------------------------------------------------------------------
PROGRESS: 81.0%
| epoch  82 |   100/  269 batches | lr 0.00000 | ms/batch 251.75 | loss  3.01 | ppl    20.31 
| epoch  82 |   200/  269 batches | lr 0.00000 | ms/batch 243.13 | loss  2.98 | ppl    19.67 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 66.79s | valid loss  3.80 | valid ppl    44.86 | valid bpc    5.487
-----------------------------------------------------------------------------------------
PROGRESS: 82.0%
| epoch  83 |   100/  269 batches | lr 0.00000 | ms/batch 251.83 | loss  3.01 | ppl    20.24 
| epoch  83 |   200/  269 batches | lr 0.00000 | ms/batch 241.92 | loss  2.96 | ppl    19.22 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 66.83s | valid loss  3.83 | valid ppl    45.91 | valid bpc    5.521
-----------------------------------------------------------------------------------------
PROGRESS: 83.0%
| epoch  84 |   100/  269 batches | lr 0.00000 | ms/batch 252.18 | loss  3.00 | ppl    20.09 
| epoch  84 |   200/  269 batches | lr 0.00000 | ms/batch 242.28 | loss  2.99 | ppl    19.82 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 66.90s | valid loss  3.84 | valid ppl    46.65 | valid bpc    5.544
-----------------------------------------------------------------------------------------
PROGRESS: 84.0%
| epoch  85 |   100/  269 batches | lr 0.00000 | ms/batch 250.91 | loss  2.98 | ppl    19.75 
| epoch  85 |   200/  269 batches | lr 0.00000 | ms/batch 242.97 | loss  2.96 | ppl    19.37 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 66.88s | valid loss  3.87 | valid ppl    47.76 | valid bpc    5.578
-----------------------------------------------------------------------------------------
PROGRESS: 85.0%
| epoch  86 |   100/  269 batches | lr 0.00000 | ms/batch 252.02 | loss  3.00 | ppl    20.05 
| epoch  86 |   200/  269 batches | lr 0.00000 | ms/batch 238.72 | loss  2.98 | ppl    19.64 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 66.86s | valid loss  3.88 | valid ppl    48.29 | valid bpc    5.594
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  269 batches | lr 0.00000 | ms/batch 252.11 | loss  2.99 | ppl    19.83 
| epoch  87 |   200/  269 batches | lr 0.00000 | ms/batch 235.82 | loss  2.96 | ppl    19.37 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 66.82s | valid loss  3.82 | valid ppl    45.53 | valid bpc    5.509
-----------------------------------------------------------------------------------------
PROGRESS: 87.0%
| epoch  88 |   100/  269 batches | lr 0.00000 | ms/batch 251.93 | loss  3.01 | ppl    20.31 
| epoch  88 |   200/  269 batches | lr 0.00000 | ms/batch 237.15 | loss  2.97 | ppl    19.50 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 66.84s | valid loss  3.88 | valid ppl    48.44 | valid bpc    5.598
-----------------------------------------------------------------------------------------
PROGRESS: 88.0%
| epoch  89 |   100/  269 batches | lr 0.00000 | ms/batch 251.68 | loss  3.02 | ppl    20.44 
| epoch  89 |   200/  269 batches | lr 0.00000 | ms/batch 236.93 | loss  2.96 | ppl    19.38 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 66.81s | valid loss  3.78 | valid ppl    43.96 | valid bpc    5.458
-----------------------------------------------------------------------------------------
PROGRESS: 89.0%
| epoch  90 |   100/  269 batches | lr 0.00000 | ms/batch 251.74 | loss  3.01 | ppl    20.25 
| epoch  90 |   200/  269 batches | lr 0.00000 | ms/batch 237.88 | loss  2.98 | ppl    19.64 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 66.80s | valid loss  3.82 | valid ppl    45.82 | valid bpc    5.518
-----------------------------------------------------------------------------------------
PROGRESS: 90.0%
| epoch  91 |   100/  269 batches | lr 0.00000 | ms/batch 251.94 | loss  3.00 | ppl    20.00 
| epoch  91 |   200/  269 batches | lr 0.00000 | ms/batch 237.63 | loss  2.98 | ppl    19.65 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 66.85s | valid loss  3.88 | valid ppl    48.29 | valid bpc    5.594
-----------------------------------------------------------------------------------------
PROGRESS: 91.0%
| epoch  92 |   100/  269 batches | lr 0.00000 | ms/batch 251.83 | loss  3.00 | ppl    20.04 
| epoch  92 |   200/  269 batches | lr 0.00000 | ms/batch 237.38 | loss  2.99 | ppl    19.80 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 66.87s | valid loss  3.81 | valid ppl    44.96 | valid bpc    5.491
-----------------------------------------------------------------------------------------
PROGRESS: 92.0%
| epoch  93 |   100/  269 batches | lr 0.00000 | ms/batch 251.62 | loss  3.01 | ppl    20.32 
| epoch  93 |   200/  269 batches | lr 0.00000 | ms/batch 236.17 | loss  2.96 | ppl    19.26 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 66.89s | valid loss  3.85 | valid ppl    47.10 | valid bpc    5.558
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  269 batches | lr 0.00000 | ms/batch 250.63 | loss  2.99 | ppl    19.85 
| epoch  94 |   200/  269 batches | lr 0.00000 | ms/batch 237.26 | loss  2.96 | ppl    19.39 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 66.83s | valid loss  3.82 | valid ppl    45.41 | valid bpc    5.505
-----------------------------------------------------------------------------------------
PROGRESS: 94.0%
| epoch  95 |   100/  269 batches | lr 0.00000 | ms/batch 251.72 | loss  3.01 | ppl    20.19 
| epoch  95 |   200/  269 batches | lr 0.00000 | ms/batch 236.50 | loss  2.95 | ppl    19.04 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 66.87s | valid loss  3.80 | valid ppl    44.81 | valid bpc    5.486
-----------------------------------------------------------------------------------------
PROGRESS: 95.0%
| epoch  96 |   100/  269 batches | lr 0.00000 | ms/batch 252.66 | loss  3.01 | ppl    20.33 
| epoch  96 |   200/  269 batches | lr 0.00000 | ms/batch 236.76 | loss  2.96 | ppl    19.24 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 66.51s | valid loss  3.82 | valid ppl    45.49 | valid bpc    5.508
-----------------------------------------------------------------------------------------
PROGRESS: 96.0%
| epoch  97 |   100/  269 batches | lr 0.00000 | ms/batch 249.43 | loss  2.99 | ppl    19.80 
| epoch  97 |   200/  269 batches | lr 0.00000 | ms/batch 238.08 | loss  2.96 | ppl    19.32 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 66.37s | valid loss  3.81 | valid ppl    45.10 | valid bpc    5.495
-----------------------------------------------------------------------------------------
PROGRESS: 97.0%
| epoch  98 |   100/  269 batches | lr 0.00000 | ms/batch 255.24 | loss  2.98 | ppl    19.73 
| epoch  98 |   200/  269 batches | lr 0.00000 | ms/batch 237.64 | loss  2.98 | ppl    19.77 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 66.70s | valid loss  3.80 | valid ppl    44.54 | valid bpc    5.477
-----------------------------------------------------------------------------------------
PROGRESS: 98.0%
| epoch  99 |   100/  269 batches | lr 0.00000 | ms/batch 257.47 | loss  2.98 | ppl    19.72 
| epoch  99 |   200/  269 batches | lr 0.00000 | ms/batch 236.19 | loss  2.98 | ppl    19.65 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 66.83s | valid loss  3.84 | valid ppl    46.52 | valid bpc    5.540
-----------------------------------------------------------------------------------------
PROGRESS: 99.0%
| epoch 100 |   100/  269 batches | lr 0.00000 | ms/batch 258.44 | loss  2.99 | ppl    19.98 
| epoch 100 |   200/  269 batches | lr 0.00000 | ms/batch 237.07 | loss  2.99 | ppl    19.91 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 66.95s | valid loss  3.85 | valid ppl    46.91 | valid bpc    5.552
-----------------------------------------------------------------------------------------
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  3.91 | test ppl    50.09 | test bpc    5.646
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.1984, Mean Reca: 0.2780, Mean F1: 0.2291, Mean Subword_Reca: 0.5164
-----------------------------------------------------------------------------------------
=========================================================================================
Loading dataset...
Using subword tokenizer...
Number of tokens:  8000
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer_in_parser', nhid=512, nlayers=8, front_layers=1, rear_layers=7, subword='omarmomen/ptb_filtered_lowcase_bpe_tokenizer_8', n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=3333, nonmono=5, cuda=True, log_interval=100, save='trained_models/subword_structformer_in_parser_3333_17.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 37449140
Model architecture: StructFormer_In_Parser(
  (transformer_front): Transformer_Front(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(8000, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0): TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
  (transformer_rear): Transformer_Rear(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(8000, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-6): 7 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (output_layer): Linear(in_features=512, out_features=8000, bias=True)
  )
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  269 batches | lr 0.00030 | ms/batch 260.12 | loss  7.70 | ppl  2204.75 
| epoch   1 |   200/  269 batches | lr 0.00030 | ms/batch 236.78 | loss  7.34 | ppl  1544.42 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 67.65s | valid loss  7.05 | valid ppl  1152.48 | valid bpc   10.171
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  269 batches | lr 0.00030 | ms/batch 251.38 | loss  7.18 | ppl  1317.90 
| epoch   2 |   200/  269 batches | lr 0.00030 | ms/batch 234.76 | loss  6.86 | ppl   950.38 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 66.50s | valid loss  6.25 | valid ppl   515.95 | valid bpc    9.011
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  269 batches | lr 0.00030 | ms/batch 246.67 | loss  6.36 | ppl   579.73 
| epoch   3 |   200/  269 batches | lr 0.00030 | ms/batch 242.95 | loss  6.10 | ppl   447.87 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 66.89s | valid loss  5.67 | valid ppl   291.22 | valid bpc    8.186
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  269 batches | lr 0.00030 | ms/batch 176.59 | loss  5.87 | ppl   355.80 
| epoch   4 |   200/  269 batches | lr 0.00030 | ms/batch 102.64 | loss  5.74 | ppl   310.16 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 35.47s | valid loss  5.43 | valid ppl   228.36 | valid bpc    7.835
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  269 batches | lr 0.00030 | ms/batch 105.57 | loss  5.61 | ppl   274.42 
| epoch   5 |   200/  269 batches | lr 0.00030 | ms/batch 90.54 | loss  5.50 | ppl   245.12 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 25.26s | valid loss  5.19 | valid ppl   179.39 | valid bpc    7.487
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  269 batches | lr 0.00030 | ms/batch 77.84 | loss  5.43 | ppl   228.93 
| epoch   6 |   200/  269 batches | lr 0.00030 | ms/batch 75.98 | loss  5.29 | ppl   197.52 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 21.01s | valid loss  5.10 | valid ppl   163.56 | valid bpc    7.354
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  269 batches | lr 0.00030 | ms/batch 107.62 | loss  5.25 | ppl   190.58 
| epoch   7 |   200/  269 batches | lr 0.00030 | ms/batch 221.45 | loss  5.14 | ppl   171.05 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 50.80s | valid loss  4.98 | valid ppl   145.46 | valid bpc    7.184
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  269 batches | lr 0.00030 | ms/batch 249.88 | loss  5.09 | ppl   161.83 
| epoch   8 |   200/  269 batches | lr 0.00030 | ms/batch 232.86 | loss  5.01 | ppl   149.29 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 66.19s | valid loss  4.81 | valid ppl   122.30 | valid bpc    6.934
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 8.0%
| epoch   9 |   100/  269 batches | lr 0.00030 | ms/batch 248.30 | loss  4.95 | ppl   141.59 
| epoch   9 |   200/  269 batches | lr 0.00030 | ms/batch 234.31 | loss  4.87 | ppl   129.74 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 66.23s | valid loss  4.74 | valid ppl   114.59 | valid bpc    6.840
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  269 batches | lr 0.00030 | ms/batch 243.05 | loss  4.83 | ppl   124.80 
| epoch  10 |   200/  269 batches | lr 0.00030 | ms/batch 237.38 | loss  4.73 | ppl   113.59 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 66.06s | valid loss  4.66 | valid ppl   105.84 | valid bpc    6.726
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  269 batches | lr 0.00030 | ms/batch 239.94 | loss  4.70 | ppl   109.83 
| epoch  11 |   200/  269 batches | lr 0.00030 | ms/batch 242.56 | loss  4.62 | ppl   101.18 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 66.19s | valid loss  4.55 | valid ppl    94.60 | valid bpc    6.564
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  269 batches | lr 0.00030 | ms/batch 239.18 | loss  4.58 | ppl    97.14 
| epoch  12 |   200/  269 batches | lr 0.00030 | ms/batch 242.90 | loss  4.54 | ppl    93.75 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 66.24s | valid loss  4.48 | valid ppl    88.60 | valid bpc    6.469
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 12.0%
| epoch  13 |   100/  269 batches | lr 0.00030 | ms/batch 238.06 | loss  4.49 | ppl    89.47 
| epoch  13 |   200/  269 batches | lr 0.00030 | ms/batch 244.14 | loss  4.45 | ppl    85.38 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 66.20s | valid loss  4.39 | valid ppl    80.44 | valid bpc    6.330
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 13.0%
| epoch  14 |   100/  269 batches | lr 0.00030 | ms/batch 237.26 | loss  4.36 | ppl    78.29 
| epoch  14 |   200/  269 batches | lr 0.00030 | ms/batch 242.76 | loss  4.37 | ppl    79.38 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 66.23s | valid loss  4.31 | valid ppl    74.63 | valid bpc    6.222
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  269 batches | lr 0.00030 | ms/batch 238.61 | loss  4.29 | ppl    73.01 
| epoch  15 |   200/  269 batches | lr 0.00030 | ms/batch 243.11 | loss  4.26 | ppl    71.11 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 66.18s | valid loss  4.31 | valid ppl    74.42 | valid bpc    6.218
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 15.0%
| epoch  16 |   100/  269 batches | lr 0.00030 | ms/batch 238.08 | loss  4.21 | ppl    67.54 
| epoch  16 |   200/  269 batches | lr 0.00030 | ms/batch 242.76 | loss  4.21 | ppl    67.07 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 66.23s | valid loss  4.23 | valid ppl    68.95 | valid bpc    6.107
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 16.0%
| epoch  17 |   100/  269 batches | lr 0.00030 | ms/batch 238.94 | loss  4.16 | ppl    63.84 
| epoch  17 |   200/  269 batches | lr 0.00030 | ms/batch 242.69 | loss  4.12 | ppl    61.46 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 66.17s | valid loss  4.21 | valid ppl    67.30 | valid bpc    6.073
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 17.0%
| epoch  18 |   100/  269 batches | lr 0.00030 | ms/batch 237.80 | loss  4.08 | ppl    59.13 
| epoch  18 |   200/  269 batches | lr 0.00030 | ms/batch 244.00 | loss  4.04 | ppl    56.85 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 66.22s | valid loss  4.14 | valid ppl    62.62 | valid bpc    5.969
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 18.0%
| epoch  19 |   100/  269 batches | lr 0.00030 | ms/batch 238.37 | loss  4.01 | ppl    55.15 
| epoch  19 |   200/  269 batches | lr 0.00030 | ms/batch 242.35 | loss  3.99 | ppl    54.17 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 66.13s | valid loss  4.15 | valid ppl    63.62 | valid bpc    5.991
-----------------------------------------------------------------------------------------
PROGRESS: 19.0%
| epoch  20 |   100/  269 batches | lr 0.00030 | ms/batch 237.79 | loss  3.95 | ppl    51.83 
| epoch  20 |   200/  269 batches | lr 0.00030 | ms/batch 244.61 | loss  3.94 | ppl    51.56 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 66.19s | valid loss  4.10 | valid ppl    60.43 | valid bpc    5.917
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 20.0%
| epoch  21 |   100/  269 batches | lr 0.00030 | ms/batch 238.80 | loss  3.88 | ppl    48.30 
| epoch  21 |   200/  269 batches | lr 0.00030 | ms/batch 242.81 | loss  3.87 | ppl    48.12 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 66.19s | valid loss  4.07 | valid ppl    58.33 | valid bpc    5.866
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 21.0%
| epoch  22 |   100/  269 batches | lr 0.00030 | ms/batch 237.93 | loss  3.84 | ppl    46.41 
| epoch  22 |   200/  269 batches | lr 0.00030 | ms/batch 244.68 | loss  3.82 | ppl    45.54 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 66.17s | valid loss  4.05 | valid ppl    57.11 | valid bpc    5.836
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 22.0%
| epoch  23 |   100/  269 batches | lr 0.00030 | ms/batch 239.80 | loss  3.80 | ppl    44.48 
| epoch  23 |   200/  269 batches | lr 0.00030 | ms/batch 242.81 | loss  3.76 | ppl    43.05 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 66.21s | valid loss  4.01 | valid ppl    55.03 | valid bpc    5.782
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 23.0%
| epoch  24 |   100/  269 batches | lr 0.00030 | ms/batch 238.92 | loss  3.73 | ppl    41.70 
| epoch  24 |   200/  269 batches | lr 0.00030 | ms/batch 245.15 | loss  3.72 | ppl    41.20 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 66.22s | valid loss  4.01 | valid ppl    55.13 | valid bpc    5.785
-----------------------------------------------------------------------------------------
PROGRESS: 24.0%
| epoch  25 |   100/  269 batches | lr 0.00030 | ms/batch 236.97 | loss  3.66 | ppl    38.96 
| epoch  25 |   200/  269 batches | lr 0.00030 | ms/batch 244.05 | loss  3.67 | ppl    39.37 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 66.19s | valid loss  3.93 | valid ppl    51.02 | valid bpc    5.673
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 25.0%
| epoch  26 |   100/  269 batches | lr 0.00030 | ms/batch 235.31 | loss  3.64 | ppl    38.13 
| epoch  26 |   200/  269 batches | lr 0.00030 | ms/batch 244.46 | loss  3.63 | ppl    37.66 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 65.98s | valid loss  3.99 | valid ppl    54.26 | valid bpc    5.762
-----------------------------------------------------------------------------------------
PROGRESS: 26.0%
| epoch  27 |   100/  269 batches | lr 0.00030 | ms/batch 238.51 | loss  3.60 | ppl    36.50 
| epoch  27 |   200/  269 batches | lr 0.00030 | ms/batch 242.70 | loss  3.59 | ppl    36.17 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 66.08s | valid loss  3.94 | valid ppl    51.28 | valid bpc    5.680
-----------------------------------------------------------------------------------------
PROGRESS: 27.0%
| epoch  28 |   100/  269 batches | lr 0.00030 | ms/batch 238.90 | loss  3.55 | ppl    34.88 
| epoch  28 |   200/  269 batches | lr 0.00030 | ms/batch 242.30 | loss  3.53 | ppl    34.26 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 66.10s | valid loss  3.91 | valid ppl    49.98 | valid bpc    5.643
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  269 batches | lr 0.00030 | ms/batch 241.88 | loss  3.50 | ppl    33.20 
| epoch  29 |   200/  269 batches | lr 0.00030 | ms/batch 243.50 | loss  3.52 | ppl    33.88 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 66.46s | valid loss  3.95 | valid ppl    51.88 | valid bpc    5.697
-----------------------------------------------------------------------------------------
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  269 batches | lr 0.00030 | ms/batch 229.10 | loss  3.47 | ppl    32.00 
| epoch  30 |   200/  269 batches | lr 0.00030 | ms/batch 242.48 | loss  3.45 | ppl    31.45 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 65.14s | valid loss  3.93 | valid ppl    50.83 | valid bpc    5.668
-----------------------------------------------------------------------------------------
PROGRESS: 30.0%
| epoch  31 |   100/  269 batches | lr 0.00030 | ms/batch 236.88 | loss  3.43 | ppl    30.94 
| epoch  31 |   200/  269 batches | lr 0.00030 | ms/batch 242.94 | loss  3.44 | ppl    31.25 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 65.97s | valid loss  3.95 | valid ppl    51.75 | valid bpc    5.694
-----------------------------------------------------------------------------------------
PROGRESS: 31.0%
| epoch  32 |   100/  269 batches | lr 0.00015 | ms/batch 238.21 | loss  3.37 | ppl    29.15 
| epoch  32 |   200/  269 batches | lr 0.00015 | ms/batch 242.40 | loss  3.30 | ppl    27.07 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 66.16s | valid loss  3.90 | valid ppl    49.55 | valid bpc    5.631
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 32.0%
| epoch  33 |   100/  269 batches | lr 0.00015 | ms/batch 242.82 | loss  3.30 | ppl    27.05 
| epoch  33 |   200/  269 batches | lr 0.00015 | ms/batch 244.17 | loss  3.26 | ppl    26.01 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 66.22s | valid loss  3.86 | valid ppl    47.67 | valid bpc    5.575
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 33.0%
| epoch  34 |   100/  269 batches | lr 0.00015 | ms/batch 248.66 | loss  3.26 | ppl    26.14 
| epoch  34 |   200/  269 batches | lr 0.00015 | ms/batch 241.63 | loss  3.24 | ppl    25.51 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 66.15s | valid loss  3.80 | valid ppl    44.55 | valid bpc    5.478
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 34.0%
| epoch  35 |   100/  269 batches | lr 0.00015 | ms/batch 248.20 | loss  3.22 | ppl    24.96 
| epoch  35 |   200/  269 batches | lr 0.00015 | ms/batch 241.88 | loss  3.20 | ppl    24.41 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 66.11s | valid loss  3.89 | valid ppl    48.97 | valid bpc    5.614
-----------------------------------------------------------------------------------------
PROGRESS: 35.0%
| epoch  36 |   100/  269 batches | lr 0.00015 | ms/batch 248.17 | loss  3.19 | ppl    24.24 
| epoch  36 |   200/  269 batches | lr 0.00015 | ms/batch 243.58 | loss  3.19 | ppl    24.27 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 66.59s | valid loss  3.79 | valid ppl    44.33 | valid bpc    5.470
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 36.0%
| epoch  37 |   100/  269 batches | lr 0.00015 | ms/batch 251.06 | loss  3.18 | ppl    24.06 
| epoch  37 |   200/  269 batches | lr 0.00015 | ms/batch 243.56 | loss  3.17 | ppl    23.70 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 66.53s | valid loss  3.80 | valid ppl    44.52 | valid bpc    5.476
-----------------------------------------------------------------------------------------
PROGRESS: 37.0%
| epoch  38 |   100/  269 batches | lr 0.00015 | ms/batch 250.36 | loss  3.13 | ppl    22.95 
| epoch  38 |   200/  269 batches | lr 0.00015 | ms/batch 244.28 | loss  3.15 | ppl    23.25 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 66.63s | valid loss  3.85 | valid ppl    47.05 | valid bpc    5.556
-----------------------------------------------------------------------------------------
PROGRESS: 38.0%
| epoch  39 |   100/  269 batches | lr 0.00015 | ms/batch 250.06 | loss  3.11 | ppl    22.39 
| epoch  39 |   200/  269 batches | lr 0.00015 | ms/batch 242.27 | loss  3.11 | ppl    22.33 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 66.64s | valid loss  3.82 | valid ppl    45.78 | valid bpc    5.517
-----------------------------------------------------------------------------------------
PROGRESS: 39.0%
| epoch  40 |   100/  269 batches | lr 0.00007 | ms/batch 250.67 | loss  3.06 | ppl    21.34 
| epoch  40 |   200/  269 batches | lr 0.00007 | ms/batch 243.05 | loss  3.05 | ppl    21.07 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 66.66s | valid loss  3.81 | valid ppl    45.08 | valid bpc    5.494
-----------------------------------------------------------------------------------------
PROGRESS: 40.0%
| epoch  41 |   100/  269 batches | lr 0.00007 | ms/batch 255.27 | loss  3.02 | ppl    20.57 
| epoch  41 |   200/  269 batches | lr 0.00007 | ms/batch 242.70 | loss  3.05 | ppl    21.17 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 66.28s | valid loss  3.83 | valid ppl    45.97 | valid bpc    5.523
-----------------------------------------------------------------------------------------
PROGRESS: 41.0%
| epoch  42 |   100/  269 batches | lr 0.00007 | ms/batch 257.45 | loss  3.02 | ppl    20.45 
| epoch  42 |   200/  269 batches | lr 0.00007 | ms/batch 242.67 | loss  3.01 | ppl    20.30 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 66.58s | valid loss  3.76 | valid ppl    42.99 | valid bpc    5.426
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 42.0%
| epoch  43 |   100/  269 batches | lr 0.00007 | ms/batch 257.62 | loss  3.00 | ppl    20.08 
| epoch  43 |   200/  269 batches | lr 0.00007 | ms/batch 242.55 | loss  2.97 | ppl    19.52 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 66.24s | valid loss  3.83 | valid ppl    46.28 | valid bpc    5.532
-----------------------------------------------------------------------------------------
PROGRESS: 43.0%
| epoch  44 |   100/  269 batches | lr 0.00007 | ms/batch 258.11 | loss  3.00 | ppl    19.99 
| epoch  44 |   200/  269 batches | lr 0.00007 | ms/batch 242.74 | loss  2.98 | ppl    19.70 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 66.16s | valid loss  3.81 | valid ppl    45.22 | valid bpc    5.499
-----------------------------------------------------------------------------------------
PROGRESS: 44.0%
| epoch  45 |   100/  269 batches | lr 0.00007 | ms/batch 257.42 | loss  2.98 | ppl    19.78 
| epoch  45 |   200/  269 batches | lr 0.00007 | ms/batch 243.51 | loss  2.96 | ppl    19.33 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 66.97s | valid loss  3.80 | valid ppl    44.51 | valid bpc    5.476
-----------------------------------------------------------------------------------------
PROGRESS: 45.0%
| epoch  46 |   100/  269 batches | lr 0.00004 | ms/batch 257.99 | loss  2.96 | ppl    19.39 
| epoch  46 |   200/  269 batches | lr 0.00004 | ms/batch 240.81 | loss  2.93 | ppl    18.67 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 66.92s | valid loss  3.76 | valid ppl    43.06 | valid bpc    5.428
-----------------------------------------------------------------------------------------
PROGRESS: 46.0%
| epoch  47 |   100/  269 batches | lr 0.00004 | ms/batch 257.85 | loss  2.97 | ppl    19.58 
| epoch  47 |   200/  269 batches | lr 0.00004 | ms/batch 237.24 | loss  2.91 | ppl    18.33 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 66.96s | valid loss  3.79 | valid ppl    44.23 | valid bpc    5.467
-----------------------------------------------------------------------------------------
PROGRESS: 47.0%
| epoch  48 |   100/  269 batches | lr 0.00004 | ms/batch 257.00 | loss  2.96 | ppl    19.21 
| epoch  48 |   200/  269 batches | lr 0.00004 | ms/batch 232.92 | loss  2.90 | ppl    18.14 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 66.15s | valid loss  3.80 | valid ppl    44.83 | valid bpc    5.486
-----------------------------------------------------------------------------------------
PROGRESS: 48.0%
| epoch  49 |   100/  269 batches | lr 0.00002 | ms/batch 257.56 | loss  2.91 | ppl    18.42 
| epoch  49 |   200/  269 batches | lr 0.00002 | ms/batch 237.95 | loss  2.89 | ppl    18.06 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 66.93s | valid loss  3.78 | valid ppl    43.89 | valid bpc    5.456
-----------------------------------------------------------------------------------------
PROGRESS: 49.0%
| epoch  50 |   100/  269 batches | lr 0.00002 | ms/batch 259.36 | loss  2.92 | ppl    18.61 
| epoch  50 |   200/  269 batches | lr 0.00002 | ms/batch 236.27 | loss  2.88 | ppl    17.84 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 66.98s | valid loss  3.83 | valid ppl    46.00 | valid bpc    5.524
-----------------------------------------------------------------------------------------
PROGRESS: 50.0%
| epoch  51 |   100/  269 batches | lr 0.00002 | ms/batch 257.69 | loss  2.92 | ppl    18.47 
| epoch  51 |   200/  269 batches | lr 0.00002 | ms/batch 236.08 | loss  2.89 | ppl    18.03 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 66.55s | valid loss  3.78 | valid ppl    43.78 | valid bpc    5.452
-----------------------------------------------------------------------------------------
PROGRESS: 51.0%
| epoch  52 |   100/  269 batches | lr 0.00001 | ms/batch 257.58 | loss  2.92 | ppl    18.52 
| epoch  52 |   200/  269 batches | lr 0.00001 | ms/batch 237.98 | loss  2.88 | ppl    17.83 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 66.57s | valid loss  3.78 | valid ppl    43.60 | valid bpc    5.446
-----------------------------------------------------------------------------------------
PROGRESS: 52.0%
| epoch  53 |   100/  269 batches | lr 0.00001 | ms/batch 256.00 | loss  2.90 | ppl    18.16 
| epoch  53 |   200/  269 batches | lr 0.00001 | ms/batch 238.89 | loss  2.87 | ppl    17.55 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 66.86s | valid loss  3.81 | valid ppl    45.14 | valid bpc    5.496
-----------------------------------------------------------------------------------------
PROGRESS: 53.0%
| epoch  54 |   100/  269 batches | lr 0.00001 | ms/batch 256.60 | loss  2.89 | ppl    18.01 
| epoch  54 |   200/  269 batches | lr 0.00001 | ms/batch 237.45 | loss  2.88 | ppl    17.79 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 66.87s | valid loss  3.75 | valid ppl    42.46 | valid bpc    5.408
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 54.0%
| epoch  55 |   100/  269 batches | lr 0.00001 | ms/batch 257.65 | loss  2.90 | ppl    18.22 
| epoch  55 |   200/  269 batches | lr 0.00001 | ms/batch 234.11 | loss  2.88 | ppl    17.76 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 66.51s | valid loss  3.80 | valid ppl    44.68 | valid bpc    5.482
-----------------------------------------------------------------------------------------
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  269 batches | lr 0.00001 | ms/batch 258.34 | loss  2.89 | ppl    17.91 
| epoch  56 |   200/  269 batches | lr 0.00001 | ms/batch 233.43 | loss  2.87 | ppl    17.65 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 66.52s | valid loss  3.80 | valid ppl    44.62 | valid bpc    5.480
-----------------------------------------------------------------------------------------
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  269 batches | lr 0.00001 | ms/batch 256.99 | loss  2.89 | ppl    18.02 
| epoch  57 |   200/  269 batches | lr 0.00001 | ms/batch 237.23 | loss  2.89 | ppl    17.94 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 66.96s | valid loss  3.75 | valid ppl    42.31 | valid bpc    5.403
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  269 batches | lr 0.00001 | ms/batch 257.12 | loss  2.91 | ppl    18.41 
| epoch  58 |   200/  269 batches | lr 0.00001 | ms/batch 237.89 | loss  2.86 | ppl    17.49 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 66.93s | valid loss  3.77 | valid ppl    43.44 | valid bpc    5.441
-----------------------------------------------------------------------------------------
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  269 batches | lr 0.00001 | ms/batch 258.17 | loss  2.90 | ppl    18.26 
| epoch  59 |   200/  269 batches | lr 0.00001 | ms/batch 238.64 | loss  2.87 | ppl    17.60 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 66.97s | valid loss  3.79 | valid ppl    44.35 | valid bpc    5.471
-----------------------------------------------------------------------------------------
PROGRESS: 59.0%
| epoch  60 |   100/  269 batches | lr 0.00001 | ms/batch 257.48 | loss  2.89 | ppl    18.06 
| epoch  60 |   200/  269 batches | lr 0.00001 | ms/batch 237.55 | loss  2.84 | ppl    17.09 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 66.57s | valid loss  3.79 | valid ppl    44.43 | valid bpc    5.474
-----------------------------------------------------------------------------------------
PROGRESS: 60.0%
| epoch  61 |   100/  269 batches | lr 0.00000 | ms/batch 256.77 | loss  2.88 | ppl    17.77 
| epoch  61 |   200/  269 batches | lr 0.00000 | ms/batch 237.98 | loss  2.87 | ppl    17.67 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 66.92s | valid loss  3.79 | valid ppl    44.21 | valid bpc    5.466
-----------------------------------------------------------------------------------------
PROGRESS: 61.0%
| epoch  62 |   100/  269 batches | lr 0.00000 | ms/batch 257.07 | loss  2.90 | ppl    18.10 
| epoch  62 |   200/  269 batches | lr 0.00000 | ms/batch 237.54 | loss  2.86 | ppl    17.40 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 66.91s | valid loss  3.76 | valid ppl    43.01 | valid bpc    5.427
-----------------------------------------------------------------------------------------
PROGRESS: 62.0%
| epoch  63 |   100/  269 batches | lr 0.00000 | ms/batch 254.78 | loss  2.87 | ppl    17.67 
| epoch  63 |   200/  269 batches | lr 0.00000 | ms/batch 240.55 | loss  2.85 | ppl    17.32 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 66.92s | valid loss  3.83 | valid ppl    46.27 | valid bpc    5.532
-----------------------------------------------------------------------------------------
PROGRESS: 63.0%
| epoch  64 |   100/  269 batches | lr 0.00000 | ms/batch 251.54 | loss  2.87 | ppl    17.65 
| epoch  64 |   200/  269 batches | lr 0.00000 | ms/batch 242.03 | loss  2.84 | ppl    17.16 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 66.96s | valid loss  3.79 | valid ppl    44.10 | valid bpc    5.463
-----------------------------------------------------------------------------------------
PROGRESS: 64.0%
| epoch  65 |   100/  269 batches | lr 0.00000 | ms/batch 251.95 | loss  2.89 | ppl    18.01 
| epoch  65 |   200/  269 batches | lr 0.00000 | ms/batch 241.52 | loss  2.87 | ppl    17.55 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 66.94s | valid loss  3.85 | valid ppl    46.76 | valid bpc    5.547
-----------------------------------------------------------------------------------------
PROGRESS: 65.0%
| epoch  66 |   100/  269 batches | lr 0.00000 | ms/batch 247.56 | loss  2.87 | ppl    17.67 
| epoch  66 |   200/  269 batches | lr 0.00000 | ms/batch 239.97 | loss  2.84 | ppl    17.19 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 66.57s | valid loss  3.78 | valid ppl    43.93 | valid bpc    5.457
-----------------------------------------------------------------------------------------
PROGRESS: 66.0%
| epoch  67 |   100/  269 batches | lr 0.00000 | ms/batch 251.44 | loss  2.86 | ppl    17.49 
| epoch  67 |   200/  269 batches | lr 0.00000 | ms/batch 237.60 | loss  2.85 | ppl    17.36 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 66.94s | valid loss  3.82 | valid ppl    45.38 | valid bpc    5.504
-----------------------------------------------------------------------------------------
PROGRESS: 67.0%
| epoch  68 |   100/  269 batches | lr 0.00000 | ms/batch 250.84 | loss  2.86 | ppl    17.47 
| epoch  68 |   200/  269 batches | lr 0.00000 | ms/batch 238.13 | loss  2.86 | ppl    17.40 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 66.88s | valid loss  3.77 | valid ppl    43.55 | valid bpc    5.445
-----------------------------------------------------------------------------------------
PROGRESS: 68.0%
| epoch  69 |   100/  269 batches | lr 0.00000 | ms/batch 251.50 | loss  2.88 | ppl    17.84 
| epoch  69 |   200/  269 batches | lr 0.00000 | ms/batch 236.92 | loss  2.85 | ppl    17.29 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 66.92s | valid loss  3.81 | valid ppl    45.24 | valid bpc    5.499
-----------------------------------------------------------------------------------------
PROGRESS: 69.0%
| epoch  70 |   100/  269 batches | lr 0.00000 | ms/batch 250.97 | loss  2.87 | ppl    17.72 
| epoch  70 |   200/  269 batches | lr 0.00000 | ms/batch 237.57 | loss  2.85 | ppl    17.33 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 66.91s | valid loss  3.77 | valid ppl    43.42 | valid bpc    5.440
-----------------------------------------------------------------------------------------
PROGRESS: 70.0%
| epoch  71 |   100/  269 batches | lr 0.00000 | ms/batch 250.88 | loss  2.87 | ppl    17.68 
| epoch  71 |   200/  269 batches | lr 0.00000 | ms/batch 238.07 | loss  2.83 | ppl    17.01 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 66.94s | valid loss  3.76 | valid ppl    42.79 | valid bpc    5.419
-----------------------------------------------------------------------------------------
PROGRESS: 71.0%
| epoch  72 |   100/  269 batches | lr 0.00000 | ms/batch 251.95 | loss  2.86 | ppl    17.51 
| epoch  72 |   200/  269 batches | lr 0.00000 | ms/batch 237.60 | loss  2.85 | ppl    17.32 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 66.92s | valid loss  3.79 | valid ppl    44.19 | valid bpc    5.466
-----------------------------------------------------------------------------------------
PROGRESS: 72.0%
| epoch  73 |   100/  269 batches | lr 0.00000 | ms/batch 252.53 | loss  2.86 | ppl    17.55 
| epoch  73 |   200/  269 batches | lr 0.00000 | ms/batch 236.51 | loss  2.84 | ppl    17.09 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 66.89s | valid loss  3.74 | valid ppl    42.09 | valid bpc    5.395
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 73.0%
| epoch  74 |   100/  269 batches | lr 0.00000 | ms/batch 252.99 | loss  2.87 | ppl    17.65 
| epoch  74 |   200/  269 batches | lr 0.00000 | ms/batch 236.32 | loss  2.85 | ppl    17.35 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 66.90s | valid loss  3.77 | valid ppl    43.40 | valid bpc    5.440
-----------------------------------------------------------------------------------------
PROGRESS: 74.0%
| epoch  75 |   100/  269 batches | lr 0.00000 | ms/batch 251.69 | loss  2.87 | ppl    17.71 
| epoch  75 |   200/  269 batches | lr 0.00000 | ms/batch 237.43 | loss  2.83 | ppl    16.97 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 66.92s | valid loss  3.71 | valid ppl    40.95 | valid bpc    5.356
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 75.0%
| epoch  76 |   100/  269 batches | lr 0.00000 | ms/batch 253.03 | loss  2.87 | ppl    17.62 
| epoch  76 |   200/  269 batches | lr 0.00000 | ms/batch 236.09 | loss  2.85 | ppl    17.28 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 66.91s | valid loss  3.78 | valid ppl    43.78 | valid bpc    5.452
-----------------------------------------------------------------------------------------
PROGRESS: 76.0%
| epoch  77 |   100/  269 batches | lr 0.00000 | ms/batch 251.77 | loss  2.88 | ppl    17.83 
| epoch  77 |   200/  269 batches | lr 0.00000 | ms/batch 237.51 | loss  2.85 | ppl    17.36 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 66.87s | valid loss  3.74 | valid ppl    42.09 | valid bpc    5.395
-----------------------------------------------------------------------------------------
PROGRESS: 77.0%
| epoch  78 |   100/  269 batches | lr 0.00000 | ms/batch 250.66 | loss  2.88 | ppl    17.78 
| epoch  78 |   200/  269 batches | lr 0.00000 | ms/batch 236.94 | loss  2.84 | ppl    17.15 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 66.85s | valid loss  3.80 | valid ppl    44.70 | valid bpc    5.482
-----------------------------------------------------------------------------------------
PROGRESS: 78.0%
| epoch  79 |   100/  269 batches | lr 0.00000 | ms/batch 250.19 | loss  2.87 | ppl    17.65 
| epoch  79 |   200/  269 batches | lr 0.00000 | ms/batch 237.52 | loss  2.84 | ppl    17.15 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 66.47s | valid loss  3.82 | valid ppl    45.48 | valid bpc    5.507
-----------------------------------------------------------------------------------------
PROGRESS: 79.0%
| epoch  80 |   100/  269 batches | lr 0.00000 | ms/batch 256.68 | loss  2.86 | ppl    17.42 
| epoch  80 |   200/  269 batches | lr 0.00000 | ms/batch 237.00 | loss  2.84 | ppl    17.14 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 66.74s | valid loss  3.78 | valid ppl    43.66 | valid bpc    5.448
-----------------------------------------------------------------------------------------
PROGRESS: 80.0%
| epoch  81 |   100/  269 batches | lr 0.00000 | ms/batch 256.60 | loss  2.87 | ppl    17.65 
| epoch  81 |   200/  269 batches | lr 0.00000 | ms/batch 237.77 | loss  2.84 | ppl    17.11 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 66.91s | valid loss  3.85 | valid ppl    46.89 | valid bpc    5.551
-----------------------------------------------------------------------------------------
PROGRESS: 81.0%
| epoch  82 |   100/  269 batches | lr 0.00000 | ms/batch 256.84 | loss  2.88 | ppl    17.89 
| epoch  82 |   200/  269 batches | lr 0.00000 | ms/batch 239.38 | loss  2.82 | ppl    16.84 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 66.95s | valid loss  3.85 | valid ppl    46.94 | valid bpc    5.553
-----------------------------------------------------------------------------------------
PROGRESS: 82.0%
| epoch  83 |   100/  269 batches | lr 0.00000 | ms/batch 256.64 | loss  2.89 | ppl    17.97 
| epoch  83 |   200/  269 batches | lr 0.00000 | ms/batch 237.47 | loss  2.86 | ppl    17.48 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 66.81s | valid loss  3.77 | valid ppl    43.48 | valid bpc    5.442
-----------------------------------------------------------------------------------------
PROGRESS: 83.0%
| epoch  84 |   100/  269 batches | lr 0.00000 | ms/batch 258.39 | loss  2.87 | ppl    17.71 
| epoch  84 |   200/  269 batches | lr 0.00000 | ms/batch 236.45 | loss  2.83 | ppl    16.90 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 66.93s | valid loss  3.82 | valid ppl    45.56 | valid bpc    5.510
-----------------------------------------------------------------------------------------
PROGRESS: 84.0%
| epoch  85 |   100/  269 batches | lr 0.00000 | ms/batch 257.44 | loss  2.87 | ppl    17.59 
| epoch  85 |   200/  269 batches | lr 0.00000 | ms/batch 236.40 | loss  2.85 | ppl    17.28 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 66.91s | valid loss  3.75 | valid ppl    42.71 | valid bpc    5.416
-----------------------------------------------------------------------------------------
PROGRESS: 85.0%
| epoch  86 |   100/  269 batches | lr 0.00000 | ms/batch 256.88 | loss  2.89 | ppl    17.98 
| epoch  86 |   200/  269 batches | lr 0.00000 | ms/batch 237.94 | loss  2.83 | ppl    16.91 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 66.91s | valid loss  3.76 | valid ppl    42.74 | valid bpc    5.418
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  269 batches | lr 0.00000 | ms/batch 257.44 | loss  2.87 | ppl    17.55 
| epoch  87 |   200/  269 batches | lr 0.00000 | ms/batch 237.65 | loss  2.85 | ppl    17.32 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 67.03s | valid loss  3.74 | valid ppl    41.95 | valid bpc    5.391
-----------------------------------------------------------------------------------------
PROGRESS: 87.0%
| epoch  88 |   100/  269 batches | lr 0.00000 | ms/batch 258.75 | loss  2.88 | ppl    17.79 
| epoch  88 |   200/  269 batches | lr 0.00000 | ms/batch 235.89 | loss  2.84 | ppl    17.20 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 66.87s | valid loss  3.71 | valid ppl    41.02 | valid bpc    5.358
-----------------------------------------------------------------------------------------
PROGRESS: 88.0%
| epoch  89 |   100/  269 batches | lr 0.00000 | ms/batch 258.50 | loss  2.88 | ppl    17.78 
| epoch  89 |   200/  269 batches | lr 0.00000 | ms/batch 236.66 | loss  2.85 | ppl    17.22 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 66.94s | valid loss  3.79 | valid ppl    44.04 | valid bpc    5.461
-----------------------------------------------------------------------------------------
PROGRESS: 89.0%
| epoch  90 |   100/  269 batches | lr 0.00000 | ms/batch 257.51 | loss  2.88 | ppl    17.76 
| epoch  90 |   200/  269 batches | lr 0.00000 | ms/batch 237.12 | loss  2.85 | ppl    17.26 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 66.98s | valid loss  3.75 | valid ppl    42.56 | valid bpc    5.411
-----------------------------------------------------------------------------------------
PROGRESS: 90.0%
| epoch  91 |   100/  269 batches | lr 0.00000 | ms/batch 256.33 | loss  2.88 | ppl    17.89 
| epoch  91 |   200/  269 batches | lr 0.00000 | ms/batch 234.47 | loss  2.81 | ppl    16.57 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 66.91s | valid loss  3.75 | valid ppl    42.62 | valid bpc    5.414
-----------------------------------------------------------------------------------------
PROGRESS: 91.0%
| epoch  92 |   100/  269 batches | lr 0.00000 | ms/batch 254.75 | loss  2.86 | ppl    17.40 
| epoch  92 |   200/  269 batches | lr 0.00000 | ms/batch 235.49 | loss  2.84 | ppl    17.09 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 66.98s | valid loss  3.73 | valid ppl    41.54 | valid bpc    5.377
-----------------------------------------------------------------------------------------
PROGRESS: 92.0%
| epoch  93 |   100/  269 batches | lr 0.00000 | ms/batch 252.80 | loss  2.87 | ppl    17.68 
| epoch  93 |   200/  269 batches | lr 0.00000 | ms/batch 236.11 | loss  2.84 | ppl    17.19 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 66.87s | valid loss  3.79 | valid ppl    44.09 | valid bpc    5.463
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  269 batches | lr 0.00000 | ms/batch 251.79 | loss  2.87 | ppl    17.64 
| epoch  94 |   200/  269 batches | lr 0.00000 | ms/batch 237.00 | loss  2.83 | ppl    16.98 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 66.98s | valid loss  3.80 | valid ppl    44.78 | valid bpc    5.485
-----------------------------------------------------------------------------------------
PROGRESS: 94.0%
| epoch  95 |   100/  269 batches | lr 0.00000 | ms/batch 252.83 | loss  2.87 | ppl    17.69 
| epoch  95 |   200/  269 batches | lr 0.00000 | ms/batch 235.34 | loss  2.86 | ppl    17.44 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 66.88s | valid loss  3.74 | valid ppl    42.07 | valid bpc    5.395
-----------------------------------------------------------------------------------------
PROGRESS: 95.0%
| epoch  96 |   100/  269 batches | lr 0.00000 | ms/batch 253.27 | loss  2.88 | ppl    17.84 
| epoch  96 |   200/  269 batches | lr 0.00000 | ms/batch 236.54 | loss  2.83 | ppl    16.88 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 66.91s | valid loss  3.83 | valid ppl    46.11 | valid bpc    5.527
-----------------------------------------------------------------------------------------
PROGRESS: 96.0%
| epoch  97 |   100/  269 batches | lr 0.00000 | ms/batch 252.45 | loss  2.87 | ppl    17.66 
| epoch  97 |   200/  269 batches | lr 0.00000 | ms/batch 236.59 | loss  2.82 | ppl    16.78 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 66.95s | valid loss  3.78 | valid ppl    43.86 | valid bpc    5.455
-----------------------------------------------------------------------------------------
PROGRESS: 97.0%
| epoch  98 |   100/  269 batches | lr 0.00000 | ms/batch 252.51 | loss  2.87 | ppl    17.66 
| epoch  98 |   200/  269 batches | lr 0.00000 | ms/batch 236.49 | loss  2.85 | ppl    17.21 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 66.96s | valid loss  3.77 | valid ppl    43.18 | valid bpc    5.432
-----------------------------------------------------------------------------------------
PROGRESS: 98.0%
| epoch  99 |   100/  269 batches | lr 0.00000 | ms/batch 251.42 | loss  2.89 | ppl    17.99 
| epoch  99 |   200/  269 batches | lr 0.00000 | ms/batch 237.72 | loss  2.84 | ppl    17.04 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 66.90s | valid loss  3.84 | valid ppl    46.35 | valid bpc    5.534
-----------------------------------------------------------------------------------------
PROGRESS: 99.0%
| epoch 100 |   100/  269 batches | lr 0.00000 | ms/batch 248.79 | loss  2.87 | ppl    17.65 
| epoch 100 |   200/  269 batches | lr 0.00000 | ms/batch 236.66 | loss  2.85 | ppl    17.37 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 66.53s | valid loss  3.73 | valid ppl    41.75 | valid bpc    5.384
-----------------------------------------------------------------------------------------
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  3.86 | test ppl    47.54 | test bpc    5.571
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.4604, Mean Reca: 0.6453, Mean F1: 0.5332, Mean Subword_Reca: 0.7716
-----------------------------------------------------------------------------------------
=========================================================================================
Loading dataset...
Using subword tokenizer...
Number of tokens:  8000
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer_in_parser', nhid=512, nlayers=8, front_layers=1, rear_layers=7, subword='omarmomen/ptb_filtered_lowcase_bpe_tokenizer_8', n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=4444, nonmono=5, cuda=True, log_interval=100, save='trained_models/subword_structformer_in_parser_4444_17.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 37449140
Model architecture: StructFormer_In_Parser(
  (transformer_front): Transformer_Front(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(8000, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0): TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
  (transformer_rear): Transformer_Rear(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(8000, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-6): 7 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (output_layer): Linear(in_features=512, out_features=8000, bias=True)
  )
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  269 batches | lr 0.00030 | ms/batch 260.73 | loss  7.73 | ppl  2278.88 
| epoch   1 |   200/  269 batches | lr 0.00030 | ms/batch 242.68 | loss  7.34 | ppl  1547.68 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 67.74s | valid loss  7.00 | valid ppl  1096.54 | valid bpc   10.099
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  269 batches | lr 0.00030 | ms/batch 251.54 | loss  7.14 | ppl  1260.22 
| epoch   2 |   200/  269 batches | lr 0.00030 | ms/batch 243.21 | loss  6.78 | ppl   879.71 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 66.85s | valid loss  6.20 | valid ppl   494.14 | valid bpc    8.949
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  269 batches | lr 0.00030 | ms/batch 185.02 | loss  6.36 | ppl   578.06 
| epoch   3 |   200/  269 batches | lr 0.00030 | ms/batch 171.93 | loss  6.07 | ppl   432.73 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 44.75s | valid loss  5.69 | valid ppl   294.62 | valid bpc    8.203
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  269 batches | lr 0.00030 | ms/batch 104.29 | loss  5.85 | ppl   346.75 
| epoch   4 |   200/  269 batches | lr 0.00030 | ms/batch 92.15 | loss  5.70 | ppl   299.82 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 26.45s | valid loss  5.42 | valid ppl   226.62 | valid bpc    7.824
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  269 batches | lr 0.00030 | ms/batch 79.31 | loss  5.57 | ppl   263.36 
| epoch   5 |   200/  269 batches | lr 0.00030 | ms/batch 76.33 | loss  5.48 | ppl   238.87 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 21.17s | valid loss  5.20 | valid ppl   181.67 | valid bpc    7.505
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  269 batches | lr 0.00030 | ms/batch 90.09 | loss  5.39 | ppl   220.25 
| epoch   6 |   200/  269 batches | lr 0.00030 | ms/batch 173.04 | loss  5.26 | ppl   193.22 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 44.29s | valid loss  5.08 | valid ppl   160.57 | valid bpc    7.327
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  269 batches | lr 0.00030 | ms/batch 246.64 | loss  5.20 | ppl   181.82 
| epoch   7 |   200/  269 batches | lr 0.00030 | ms/batch 234.33 | loss  5.10 | ppl   163.84 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 66.13s | valid loss  4.93 | valid ppl   137.74 | valid bpc    7.106
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  269 batches | lr 0.00030 | ms/batch 248.82 | loss  5.05 | ppl   156.48 
| epoch   8 |   200/  269 batches | lr 0.00030 | ms/batch 233.14 | loss  4.98 | ppl   145.24 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 66.20s | valid loss  4.79 | valid ppl   120.30 | valid bpc    6.910
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 8.0%
| epoch   9 |   100/  269 batches | lr 0.00030 | ms/batch 248.27 | loss  4.92 | ppl   137.67 
| epoch   9 |   200/  269 batches | lr 0.00030 | ms/batch 234.46 | loss  4.85 | ppl   127.46 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 66.23s | valid loss  4.65 | valid ppl   104.54 | valid bpc    6.708
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  269 batches | lr 0.00030 | ms/batch 248.00 | loss  4.76 | ppl   116.29 
| epoch  10 |   200/  269 batches | lr 0.00030 | ms/batch 234.67 | loss  4.73 | ppl   113.21 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 66.25s | valid loss  4.58 | valid ppl    97.67 | valid bpc    6.610
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  269 batches | lr 0.00030 | ms/batch 248.01 | loss  4.65 | ppl   104.11 
| epoch  11 |   200/  269 batches | lr 0.00030 | ms/batch 234.74 | loss  4.60 | ppl    99.90 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 66.22s | valid loss  4.52 | valid ppl    92.09 | valid bpc    6.525
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  269 batches | lr 0.00030 | ms/batch 248.76 | loss  4.56 | ppl    95.78 
| epoch  12 |   200/  269 batches | lr 0.00030 | ms/batch 232.97 | loss  4.47 | ppl    87.16 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 66.18s | valid loss  4.41 | valid ppl    82.44 | valid bpc    6.365
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 12.0%
| epoch  13 |   100/  269 batches | lr 0.00030 | ms/batch 248.32 | loss  4.43 | ppl    83.85 
| epoch  13 |   200/  269 batches | lr 0.00030 | ms/batch 233.03 | loss  4.37 | ppl    78.92 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 66.17s | valid loss  4.32 | valid ppl    75.06 | valid bpc    6.230
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 13.0%
| epoch  14 |   100/  269 batches | lr 0.00030 | ms/batch 247.53 | loss  4.35 | ppl    77.67 
| epoch  14 |   200/  269 batches | lr 0.00030 | ms/batch 235.48 | loss  4.29 | ppl    73.19 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 66.20s | valid loss  4.26 | valid ppl    70.95 | valid bpc    6.149
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  269 batches | lr 0.00030 | ms/batch 247.83 | loss  4.24 | ppl    69.08 
| epoch  15 |   200/  269 batches | lr 0.00030 | ms/batch 234.78 | loss  4.22 | ppl    68.34 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 66.24s | valid loss  4.24 | valid ppl    69.73 | valid bpc    6.124
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 15.0%
| epoch  16 |   100/  269 batches | lr 0.00030 | ms/batch 247.04 | loss  4.19 | ppl    65.75 
| epoch  16 |   200/  269 batches | lr 0.00030 | ms/batch 234.99 | loss  4.12 | ppl    61.72 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 66.19s | valid loss  4.22 | valid ppl    67.84 | valid bpc    6.084
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 16.0%
| epoch  17 |   100/  269 batches | lr 0.00030 | ms/batch 248.35 | loss  4.11 | ppl    60.96 
| epoch  17 |   200/  269 batches | lr 0.00030 | ms/batch 234.51 | loss  4.09 | ppl    59.45 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 66.22s | valid loss  4.15 | valid ppl    63.51 | valid bpc    5.989
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 17.0%
| epoch  18 |   100/  269 batches | lr 0.00030 | ms/batch 248.62 | loss  4.04 | ppl    56.98 
| epoch  18 |   200/  269 batches | lr 0.00030 | ms/batch 233.24 | loss  4.02 | ppl    55.59 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 66.20s | valid loss  4.10 | valid ppl    60.63 | valid bpc    5.922
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 18.0%
| epoch  19 |   100/  269 batches | lr 0.00030 | ms/batch 247.19 | loss  3.98 | ppl    53.78 
| epoch  19 |   200/  269 batches | lr 0.00030 | ms/batch 232.87 | loss  3.94 | ppl    51.30 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 65.99s | valid loss  4.06 | valid ppl    57.82 | valid bpc    5.853
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 19.0%
| epoch  20 |   100/  269 batches | lr 0.00030 | ms/batch 245.89 | loss  3.92 | ppl    50.20 
| epoch  20 |   200/  269 batches | lr 0.00030 | ms/batch 232.48 | loss  3.87 | ppl    47.84 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 65.86s | valid loss  4.06 | valid ppl    58.15 | valid bpc    5.862
-----------------------------------------------------------------------------------------
PROGRESS: 20.0%
| epoch  21 |   100/  269 batches | lr 0.00030 | ms/batch 245.91 | loss  3.83 | ppl    46.13 
| epoch  21 |   200/  269 batches | lr 0.00030 | ms/batch 233.75 | loss  3.85 | ppl    47.20 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 65.97s | valid loss  4.04 | valid ppl    56.83 | valid bpc    5.828
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 21.0%
| epoch  22 |   100/  269 batches | lr 0.00030 | ms/batch 249.31 | loss  3.82 | ppl    45.39 
| epoch  22 |   200/  269 batches | lr 0.00030 | ms/batch 234.33 | loss  3.78 | ppl    43.62 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 66.10s | valid loss  4.04 | valid ppl    56.98 | valid bpc    5.832
-----------------------------------------------------------------------------------------
PROGRESS: 22.0%
| epoch  23 |   100/  269 batches | lr 0.00030 | ms/batch 249.48 | loss  3.75 | ppl    42.72 
| epoch  23 |   200/  269 batches | lr 0.00030 | ms/batch 234.15 | loss  3.72 | ppl    41.25 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 66.08s | valid loss  4.00 | valid ppl    54.78 | valid bpc    5.776
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 23.0%
| epoch  24 |   100/  269 batches | lr 0.00030 | ms/batch 256.81 | loss  3.72 | ppl    41.46 
| epoch  24 |   200/  269 batches | lr 0.00030 | ms/batch 232.40 | loss  3.66 | ppl    38.89 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 66.51s | valid loss  3.97 | valid ppl    53.16 | valid bpc    5.732
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 24.0%
| epoch  25 |   100/  269 batches | lr 0.00030 | ms/batch 256.17 | loss  3.62 | ppl    37.31 
| epoch  25 |   200/  269 batches | lr 0.00030 | ms/batch 234.36 | loss  3.64 | ppl    37.91 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 66.15s | valid loss  3.98 | valid ppl    53.70 | valid bpc    5.747
-----------------------------------------------------------------------------------------
PROGRESS: 25.0%
| epoch  26 |   100/  269 batches | lr 0.00030 | ms/batch 258.29 | loss  3.61 | ppl    36.80 
| epoch  26 |   200/  269 batches | lr 0.00030 | ms/batch 232.57 | loss  3.58 | ppl    35.82 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 66.19s | valid loss  3.95 | valid ppl    52.11 | valid bpc    5.703
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 26.0%
| epoch  27 |   100/  269 batches | lr 0.00030 | ms/batch 257.72 | loss  3.56 | ppl    35.28 
| epoch  27 |   200/  269 batches | lr 0.00030 | ms/batch 233.08 | loss  3.55 | ppl    34.70 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 66.16s | valid loss  3.96 | valid ppl    52.27 | valid bpc    5.708
-----------------------------------------------------------------------------------------
PROGRESS: 27.0%
| epoch  28 |   100/  269 batches | lr 0.00030 | ms/batch 257.66 | loss  3.54 | ppl    34.47 
| epoch  28 |   200/  269 batches | lr 0.00030 | ms/batch 233.99 | loss  3.50 | ppl    33.01 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 66.30s | valid loss  3.92 | valid ppl    50.55 | valid bpc    5.660
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  269 batches | lr 0.00030 | ms/batch 256.32 | loss  3.49 | ppl    32.74 
| epoch  29 |   200/  269 batches | lr 0.00030 | ms/batch 234.52 | loss  3.46 | ppl    31.84 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 66.24s | valid loss  3.90 | valid ppl    49.41 | valid bpc    5.627
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  269 batches | lr 0.00030 | ms/batch 256.52 | loss  3.45 | ppl    31.41 
| epoch  30 |   200/  269 batches | lr 0.00030 | ms/batch 234.66 | loss  3.44 | ppl    31.27 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 66.21s | valid loss  3.89 | valid ppl    48.76 | valid bpc    5.608
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 30.0%
| epoch  31 |   100/  269 batches | lr 0.00030 | ms/batch 254.93 | loss  3.40 | ppl    30.10 
| epoch  31 |   200/  269 batches | lr 0.00030 | ms/batch 237.94 | loss  3.41 | ppl    30.12 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 66.27s | valid loss  3.86 | valid ppl    47.64 | valid bpc    5.574
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 31.0%
| epoch  32 |   100/  269 batches | lr 0.00030 | ms/batch 251.52 | loss  3.39 | ppl    29.60 
| epoch  32 |   200/  269 batches | lr 0.00030 | ms/batch 240.76 | loss  3.36 | ppl    28.72 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 66.30s | valid loss  3.91 | valid ppl    49.72 | valid bpc    5.636
-----------------------------------------------------------------------------------------
PROGRESS: 32.0%
| epoch  33 |   100/  269 batches | lr 0.00030 | ms/batch 251.96 | loss  3.33 | ppl    27.93 
| epoch  33 |   200/  269 batches | lr 0.00030 | ms/batch 243.08 | loss  3.36 | ppl    28.79 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 66.94s | valid loss  3.89 | valid ppl    48.87 | valid bpc    5.611
-----------------------------------------------------------------------------------------
PROGRESS: 33.0%
| epoch  34 |   100/  269 batches | lr 0.00030 | ms/batch 249.60 | loss  3.33 | ppl    27.90 
| epoch  34 |   200/  269 batches | lr 0.00030 | ms/batch 242.92 | loss  3.32 | ppl    27.56 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 66.23s | valid loss  3.89 | valid ppl    49.08 | valid bpc    5.617
-----------------------------------------------------------------------------------------
PROGRESS: 34.0%
| epoch  35 |   100/  269 batches | lr 0.00015 | ms/batch 248.14 | loss  3.24 | ppl    25.58 
| epoch  35 |   200/  269 batches | lr 0.00015 | ms/batch 243.46 | loss  3.20 | ppl    24.54 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 66.18s | valid loss  3.87 | valid ppl    47.90 | valid bpc    5.582
-----------------------------------------------------------------------------------------
PROGRESS: 35.0%
| epoch  36 |   100/  269 batches | lr 0.00015 | ms/batch 251.60 | loss  3.19 | ppl    24.24 
| epoch  36 |   200/  269 batches | lr 0.00015 | ms/batch 243.17 | loss  3.14 | ppl    23.06 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 66.58s | valid loss  3.82 | valid ppl    45.76 | valid bpc    5.516
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 36.0%
| epoch  37 |   100/  269 batches | lr 0.00015 | ms/batch 249.25 | loss  3.13 | ppl    22.90 
| epoch  37 |   200/  269 batches | lr 0.00015 | ms/batch 238.43 | loss  3.12 | ppl    22.75 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 66.52s | valid loss  3.81 | valid ppl    45.00 | valid bpc    5.492
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 37.0%
| epoch  38 |   100/  269 batches | lr 0.00015 | ms/batch 252.13 | loss  3.10 | ppl    22.26 
| epoch  38 |   200/  269 batches | lr 0.00015 | ms/batch 233.98 | loss  3.09 | ppl    21.87 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 66.60s | valid loss  3.83 | valid ppl    45.98 | valid bpc    5.523
-----------------------------------------------------------------------------------------
PROGRESS: 38.0%
| epoch  39 |   100/  269 batches | lr 0.00015 | ms/batch 252.76 | loss  3.06 | ppl    21.38 
| epoch  39 |   200/  269 batches | lr 0.00015 | ms/batch 234.01 | loss  3.09 | ppl    22.01 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 66.61s | valid loss  3.81 | valid ppl    45.28 | valid bpc    5.501
-----------------------------------------------------------------------------------------
PROGRESS: 39.0%
| epoch  40 |   100/  269 batches | lr 0.00015 | ms/batch 250.70 | loss  3.06 | ppl    21.33 
| epoch  40 |   200/  269 batches | lr 0.00015 | ms/batch 234.49 | loss  3.05 | ppl    21.18 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 66.60s | valid loss  3.82 | valid ppl    45.72 | valid bpc    5.515
-----------------------------------------------------------------------------------------
PROGRESS: 40.0%
| epoch  41 |   100/  269 batches | lr 0.00007 | ms/batch 247.73 | loss  3.02 | ppl    20.47 
| epoch  41 |   200/  269 batches | lr 0.00007 | ms/batch 234.73 | loss  3.00 | ppl    20.03 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 66.29s | valid loss  3.79 | valid ppl    44.16 | valid bpc    5.465
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 41.0%
| epoch  42 |   100/  269 batches | lr 0.00007 | ms/batch 252.03 | loss  3.00 | ppl    20.08 
| epoch  42 |   200/  269 batches | lr 0.00007 | ms/batch 233.66 | loss  2.96 | ppl    19.24 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 66.51s | valid loss  3.82 | valid ppl    45.49 | valid bpc    5.508
-----------------------------------------------------------------------------------------
PROGRESS: 42.0%
| epoch  43 |   100/  269 batches | lr 0.00007 | ms/batch 250.71 | loss  2.96 | ppl    19.32 
| epoch  43 |   200/  269 batches | lr 0.00007 | ms/batch 236.25 | loss  2.93 | ppl    18.66 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 66.83s | valid loss  3.77 | valid ppl    43.22 | valid bpc    5.434
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 43.0%
| epoch  44 |   100/  269 batches | lr 0.00007 | ms/batch 250.76 | loss  2.94 | ppl    18.93 
| epoch  44 |   200/  269 batches | lr 0.00007 | ms/batch 237.72 | loss  2.92 | ppl    18.47 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 66.88s | valid loss  3.70 | valid ppl    40.31 | valid bpc    5.333
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 44.0%
| epoch  45 |   100/  269 batches | lr 0.00007 | ms/batch 248.52 | loss  2.92 | ppl    18.60 
| epoch  45 |   200/  269 batches | lr 0.00007 | ms/batch 237.16 | loss  2.91 | ppl    18.37 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 66.53s | valid loss  3.80 | valid ppl    44.49 | valid bpc    5.475
-----------------------------------------------------------------------------------------
PROGRESS: 45.0%
| epoch  46 |   100/  269 batches | lr 0.00007 | ms/batch 250.72 | loss  2.93 | ppl    18.64 
| epoch  46 |   200/  269 batches | lr 0.00007 | ms/batch 234.63 | loss  2.90 | ppl    18.26 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 66.62s | valid loss  3.76 | valid ppl    42.92 | valid bpc    5.424
-----------------------------------------------------------------------------------------
PROGRESS: 46.0%
| epoch  47 |   100/  269 batches | lr 0.00007 | ms/batch 248.85 | loss  2.90 | ppl    18.17 
| epoch  47 |   200/  269 batches | lr 0.00007 | ms/batch 233.04 | loss  2.87 | ppl    17.64 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 66.19s | valid loss  3.80 | valid ppl    44.48 | valid bpc    5.475
-----------------------------------------------------------------------------------------
PROGRESS: 47.0%
| epoch  48 |   100/  269 batches | lr 0.00004 | ms/batch 248.84 | loss  2.88 | ppl    17.80 
| epoch  48 |   200/  269 batches | lr 0.00004 | ms/batch 236.55 | loss  2.84 | ppl    17.18 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 66.59s | valid loss  3.73 | valid ppl    41.61 | valid bpc    5.379
-----------------------------------------------------------------------------------------
PROGRESS: 48.0%
| epoch  49 |   100/  269 batches | lr 0.00004 | ms/batch 251.43 | loss  2.87 | ppl    17.71 
| epoch  49 |   200/  269 batches | lr 0.00004 | ms/batch 233.81 | loss  2.85 | ppl    17.24 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 66.53s | valid loss  3.75 | valid ppl    42.56 | valid bpc    5.412
-----------------------------------------------------------------------------------------
PROGRESS: 49.0%
| epoch  50 |   100/  269 batches | lr 0.00004 | ms/batch 247.87 | loss  2.87 | ppl    17.67 
| epoch  50 |   200/  269 batches | lr 0.00004 | ms/batch 238.28 | loss  2.83 | ppl    16.87 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 66.65s | valid loss  3.76 | valid ppl    43.08 | valid bpc    5.429
-----------------------------------------------------------------------------------------
PROGRESS: 50.0%
| epoch  51 |   100/  269 batches | lr 0.00002 | ms/batch 248.56 | loss  2.87 | ppl    17.66 
| epoch  51 |   200/  269 batches | lr 0.00002 | ms/batch 236.88 | loss  2.83 | ppl    16.89 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 66.66s | valid loss  3.71 | valid ppl    40.85 | valid bpc    5.352
-----------------------------------------------------------------------------------------
PROGRESS: 51.0%
| epoch  52 |   100/  269 batches | lr 0.00002 | ms/batch 251.29 | loss  2.85 | ppl    17.22 
| epoch  52 |   200/  269 batches | lr 0.00002 | ms/batch 237.63 | loss  2.81 | ppl    16.55 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 66.92s | valid loss  3.80 | valid ppl    44.64 | valid bpc    5.480
-----------------------------------------------------------------------------------------
PROGRESS: 52.0%
| epoch  53 |   100/  269 batches | lr 0.00002 | ms/batch 252.35 | loss  2.85 | ppl    17.20 
| epoch  53 |   200/  269 batches | lr 0.00002 | ms/batch 233.21 | loss  2.79 | ppl    16.32 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 66.61s | valid loss  3.75 | valid ppl    42.69 | valid bpc    5.416
-----------------------------------------------------------------------------------------
PROGRESS: 53.0%
| epoch  54 |   100/  269 batches | lr 0.00001 | ms/batch 251.75 | loss  2.83 | ppl    16.87 
| epoch  54 |   200/  269 batches | lr 0.00001 | ms/batch 233.59 | loss  2.80 | ppl    16.38 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 66.59s | valid loss  3.80 | valid ppl    44.68 | valid bpc    5.481
-----------------------------------------------------------------------------------------
PROGRESS: 54.0%
| epoch  55 |   100/  269 batches | lr 0.00001 | ms/batch 251.66 | loss  2.82 | ppl    16.86 
| epoch  55 |   200/  269 batches | lr 0.00001 | ms/batch 237.92 | loss  2.79 | ppl    16.33 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 66.92s | valid loss  3.78 | valid ppl    43.83 | valid bpc    5.454
-----------------------------------------------------------------------------------------
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  269 batches | lr 0.00001 | ms/batch 252.91 | loss  2.83 | ppl    16.87 
| epoch  56 |   200/  269 batches | lr 0.00001 | ms/batch 233.40 | loss  2.80 | ppl    16.42 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 66.53s | valid loss  3.76 | valid ppl    42.99 | valid bpc    5.426
-----------------------------------------------------------------------------------------
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  269 batches | lr 0.00000 | ms/batch 248.52 | loss  2.84 | ppl    17.05 
| epoch  57 |   200/  269 batches | lr 0.00000 | ms/batch 237.06 | loss  2.81 | ppl    16.63 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 66.64s | valid loss  3.76 | valid ppl    42.88 | valid bpc    5.422
-----------------------------------------------------------------------------------------
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  269 batches | lr 0.00000 | ms/batch 248.19 | loss  2.82 | ppl    16.83 
| epoch  58 |   200/  269 batches | lr 0.00000 | ms/batch 241.01 | loss  2.79 | ppl    16.35 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 66.89s | valid loss  3.72 | valid ppl    41.16 | valid bpc    5.363
-----------------------------------------------------------------------------------------
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  269 batches | lr 0.00000 | ms/batch 245.11 | loss  2.81 | ppl    16.57 
| epoch  59 |   200/  269 batches | lr 0.00000 | ms/batch 243.76 | loss  2.79 | ppl    16.23 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 66.92s | valid loss  3.77 | valid ppl    43.32 | valid bpc    5.437
-----------------------------------------------------------------------------------------
PROGRESS: 59.0%
| epoch  60 |   100/  269 batches | lr 0.00000 | ms/batch 243.33 | loss  2.81 | ppl    16.60 
| epoch  60 |   200/  269 batches | lr 0.00000 | ms/batch 243.01 | loss  2.81 | ppl    16.69 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 66.64s | valid loss  3.71 | valid ppl    40.92 | valid bpc    5.355
-----------------------------------------------------------------------------------------
PROGRESS: 60.0%
| epoch  61 |   100/  269 batches | lr 0.00000 | ms/batch 242.94 | loss  2.80 | ppl    16.43 
| epoch  61 |   200/  269 batches | lr 0.00000 | ms/batch 242.88 | loss  2.82 | ppl    16.79 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 66.54s | valid loss  3.71 | valid ppl    40.92 | valid bpc    5.355
-----------------------------------------------------------------------------------------
PROGRESS: 61.0%
| epoch  62 |   100/  269 batches | lr 0.00000 | ms/batch 241.34 | loss  2.83 | ppl    17.03 
| epoch  62 |   200/  269 batches | lr 0.00000 | ms/batch 242.87 | loss  2.78 | ppl    16.11 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 66.55s | valid loss  3.77 | valid ppl    43.26 | valid bpc    5.435
-----------------------------------------------------------------------------------------
PROGRESS: 62.0%
| epoch  63 |   100/  269 batches | lr 0.00000 | ms/batch 245.14 | loss  2.82 | ppl    16.70 
| epoch  63 |   200/  269 batches | lr 0.00000 | ms/batch 242.24 | loss  2.78 | ppl    16.18 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 66.89s | valid loss  3.71 | valid ppl    40.97 | valid bpc    5.357
-----------------------------------------------------------------------------------------
PROGRESS: 63.0%
| epoch  64 |   100/  269 batches | lr 0.00000 | ms/batch 245.50 | loss  2.83 | ppl    16.89 
| epoch  64 |   200/  269 batches | lr 0.00000 | ms/batch 243.41 | loss  2.79 | ppl    16.23 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 66.95s | valid loss  3.75 | valid ppl    42.56 | valid bpc    5.412
-----------------------------------------------------------------------------------------
PROGRESS: 64.0%
| epoch  65 |   100/  269 batches | lr 0.00000 | ms/batch 244.67 | loss  2.81 | ppl    16.57 
| epoch  65 |   200/  269 batches | lr 0.00000 | ms/batch 242.72 | loss  2.78 | ppl    16.07 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 66.89s | valid loss  3.76 | valid ppl    43.06 | valid bpc    5.428
-----------------------------------------------------------------------------------------
PROGRESS: 65.0%
| epoch  66 |   100/  269 batches | lr 0.00000 | ms/batch 245.32 | loss  2.80 | ppl    16.43 
| epoch  66 |   200/  269 batches | lr 0.00000 | ms/batch 242.64 | loss  2.79 | ppl    16.31 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 66.93s | valid loss  3.74 | valid ppl    41.89 | valid bpc    5.389
-----------------------------------------------------------------------------------------
PROGRESS: 66.0%
| epoch  67 |   100/  269 batches | lr 0.00000 | ms/batch 246.03 | loss  2.80 | ppl    16.50 
| epoch  67 |   200/  269 batches | lr 0.00000 | ms/batch 241.99 | loss  2.79 | ppl    16.29 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 66.90s | valid loss  3.79 | valid ppl    44.38 | valid bpc    5.472
-----------------------------------------------------------------------------------------
PROGRESS: 67.0%
| epoch  68 |   100/  269 batches | lr 0.00000 | ms/batch 245.44 | loss  2.81 | ppl    16.62 
| epoch  68 |   200/  269 batches | lr 0.00000 | ms/batch 242.76 | loss  2.77 | ppl    16.03 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 66.70s | valid loss  3.76 | valid ppl    42.95 | valid bpc    5.425
-----------------------------------------------------------------------------------------
PROGRESS: 68.0%
| epoch  69 |   100/  269 batches | lr 0.00000 | ms/batch 242.55 | loss  2.79 | ppl    16.26 
| epoch  69 |   200/  269 batches | lr 0.00000 | ms/batch 242.54 | loss  2.76 | ppl    15.87 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 66.48s | valid loss  3.71 | valid ppl    40.84 | valid bpc    5.352
-----------------------------------------------------------------------------------------
PROGRESS: 69.0%
| epoch  70 |   100/  269 batches | lr 0.00000 | ms/batch 246.32 | loss  2.81 | ppl    16.56 
| epoch  70 |   200/  269 batches | lr 0.00000 | ms/batch 242.40 | loss  2.80 | ppl    16.47 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 66.75s | valid loss  3.77 | valid ppl    43.51 | valid bpc    5.443
-----------------------------------------------------------------------------------------
PROGRESS: 70.0%
| epoch  71 |   100/  269 batches | lr 0.00000 | ms/batch 246.00 | loss  2.81 | ppl    16.68 
| epoch  71 |   200/  269 batches | lr 0.00000 | ms/batch 244.23 | loss  2.78 | ppl    16.05 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 66.61s | valid loss  3.80 | valid ppl    44.59 | valid bpc    5.479
-----------------------------------------------------------------------------------------
PROGRESS: 71.0%
| epoch  72 |   100/  269 batches | lr 0.00000 | ms/batch 251.84 | loss  2.79 | ppl    16.30 
| epoch  72 |   200/  269 batches | lr 0.00000 | ms/batch 242.62 | loss  2.79 | ppl    16.24 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 66.79s | valid loss  3.72 | valid ppl    41.23 | valid bpc    5.366
-----------------------------------------------------------------------------------------
PROGRESS: 72.0%
| epoch  73 |   100/  269 batches | lr 0.00000 | ms/batch 248.56 | loss  2.83 | ppl    16.99 
| epoch  73 |   200/  269 batches | lr 0.00000 | ms/batch 242.23 | loss  2.78 | ppl    16.11 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 66.57s | valid loss  3.74 | valid ppl    42.17 | valid bpc    5.398
-----------------------------------------------------------------------------------------
PROGRESS: 73.0%
| epoch  74 |   100/  269 batches | lr 0.00000 | ms/batch 252.98 | loss  2.82 | ppl    16.83 
| epoch  74 |   200/  269 batches | lr 0.00000 | ms/batch 241.55 | loss  2.77 | ppl    16.02 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 66.96s | valid loss  3.79 | valid ppl    44.43 | valid bpc    5.473
-----------------------------------------------------------------------------------------
PROGRESS: 74.0%
| epoch  75 |   100/  269 batches | lr 0.00000 | ms/batch 250.25 | loss  2.79 | ppl    16.24 
| epoch  75 |   200/  269 batches | lr 0.00000 | ms/batch 243.82 | loss  2.80 | ppl    16.39 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 66.94s | valid loss  3.69 | valid ppl    40.15 | valid bpc    5.327
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 75.0%
| epoch  76 |   100/  269 batches | lr 0.00000 | ms/batch 252.40 | loss  2.83 | ppl    17.00 
| epoch  76 |   200/  269 batches | lr 0.00000 | ms/batch 241.55 | loss  2.78 | ppl    16.08 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 66.40s | valid loss  3.77 | valid ppl    43.43 | valid bpc    5.441
-----------------------------------------------------------------------------------------
PROGRESS: 76.0%
| epoch  77 |   100/  269 batches | lr 0.00000 | ms/batch 258.31 | loss  2.82 | ppl    16.75 
| epoch  77 |   200/  269 batches | lr 0.00000 | ms/batch 243.52 | loss  2.80 | ppl    16.44 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 66.99s | valid loss  3.74 | valid ppl    41.95 | valid bpc    5.391
-----------------------------------------------------------------------------------------
PROGRESS: 77.0%
| epoch  78 |   100/  269 batches | lr 0.00000 | ms/batch 257.88 | loss  2.81 | ppl    16.59 
| epoch  78 |   200/  269 batches | lr 0.00000 | ms/batch 243.24 | loss  2.80 | ppl    16.38 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 66.90s | valid loss  3.78 | valid ppl    43.75 | valid bpc    5.451
-----------------------------------------------------------------------------------------
PROGRESS: 78.0%
| epoch  79 |   100/  269 batches | lr 0.00000 | ms/batch 257.41 | loss  2.83 | ppl    16.94 
| epoch  79 |   200/  269 batches | lr 0.00000 | ms/batch 243.19 | loss  2.76 | ppl    15.81 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 66.92s | valid loss  3.78 | valid ppl    43.90 | valid bpc    5.456
-----------------------------------------------------------------------------------------
PROGRESS: 79.0%
| epoch  80 |   100/  269 batches | lr 0.00000 | ms/batch 257.84 | loss  2.81 | ppl    16.64 
| epoch  80 |   200/  269 batches | lr 0.00000 | ms/batch 243.05 | loss  2.78 | ppl    16.19 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 66.86s | valid loss  3.75 | valid ppl    42.67 | valid bpc    5.415
-----------------------------------------------------------------------------------------
PROGRESS: 80.0%
| epoch  81 |   100/  269 batches | lr 0.00000 | ms/batch 257.59 | loss  2.83 | ppl    16.89 
| epoch  81 |   200/  269 batches | lr 0.00000 | ms/batch 242.06 | loss  2.78 | ppl    16.17 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 66.88s | valid loss  3.78 | valid ppl    43.94 | valid bpc    5.457
-----------------------------------------------------------------------------------------
PROGRESS: 81.0%
| epoch  82 |   100/  269 batches | lr 0.00000 | ms/batch 256.70 | loss  2.80 | ppl    16.49 
| epoch  82 |   200/  269 batches | lr 0.00000 | ms/batch 244.38 | loss  2.78 | ppl    16.17 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 66.87s | valid loss  3.78 | valid ppl    43.62 | valid bpc    5.447
-----------------------------------------------------------------------------------------
PROGRESS: 82.0%
| epoch  83 |   100/  269 batches | lr 0.00000 | ms/batch 256.30 | loss  2.82 | ppl    16.74 
| epoch  83 |   200/  269 batches | lr 0.00000 | ms/batch 242.16 | loss  2.79 | ppl    16.26 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 66.87s | valid loss  3.71 | valid ppl    41.06 | valid bpc    5.360
-----------------------------------------------------------------------------------------
PROGRESS: 83.0%
| epoch  84 |   100/  269 batches | lr 0.00000 | ms/batch 257.30 | loss  2.82 | ppl    16.84 
| epoch  84 |   200/  269 batches | lr 0.00000 | ms/batch 244.20 | loss  2.77 | ppl    16.02 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 66.90s | valid loss  3.70 | valid ppl    40.25 | valid bpc    5.331
-----------------------------------------------------------------------------------------
PROGRESS: 84.0%
| epoch  85 |   100/  269 batches | lr 0.00000 | ms/batch 256.54 | loss  2.82 | ppl    16.70 
| epoch  85 |   200/  269 batches | lr 0.00000 | ms/batch 242.64 | loss  2.77 | ppl    15.94 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 66.81s | valid loss  3.78 | valid ppl    43.96 | valid bpc    5.458
-----------------------------------------------------------------------------------------
PROGRESS: 85.0%
| epoch  86 |   100/  269 batches | lr 0.00000 | ms/batch 256.74 | loss  2.81 | ppl    16.63 
| epoch  86 |   200/  269 batches | lr 0.00000 | ms/batch 244.93 | loss  2.77 | ppl    16.01 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 66.98s | valid loss  3.75 | valid ppl    42.41 | valid bpc    5.406
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  269 batches | lr 0.00000 | ms/batch 257.41 | loss  2.81 | ppl    16.55 
| epoch  87 |   200/  269 batches | lr 0.00000 | ms/batch 240.57 | loss  2.78 | ppl    16.09 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 66.90s | valid loss  3.76 | valid ppl    42.80 | valid bpc    5.419
-----------------------------------------------------------------------------------------
PROGRESS: 87.0%
| epoch  88 |   100/  269 batches | lr 0.00000 | ms/batch 259.09 | loss  2.83 | ppl    16.88 
| epoch  88 |   200/  269 batches | lr 0.00000 | ms/batch 236.60 | loss  2.79 | ppl    16.21 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 66.94s | valid loss  3.76 | valid ppl    42.86 | valid bpc    5.422
-----------------------------------------------------------------------------------------
PROGRESS: 88.0%
| epoch  89 |   100/  269 batches | lr 0.00000 | ms/batch 258.56 | loss  2.80 | ppl    16.43 
| epoch  89 |   200/  269 batches | lr 0.00000 | ms/batch 234.09 | loss  2.77 | ppl    16.01 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 66.58s | valid loss  3.71 | valid ppl    40.89 | valid bpc    5.354
-----------------------------------------------------------------------------------------
PROGRESS: 89.0%
| epoch  90 |   100/  269 batches | lr 0.00000 | ms/batch 257.54 | loss  2.81 | ppl    16.55 
| epoch  90 |   200/  269 batches | lr 0.00000 | ms/batch 235.60 | loss  2.79 | ppl    16.21 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 66.86s | valid loss  3.70 | valid ppl    40.40 | valid bpc    5.336
-----------------------------------------------------------------------------------------
PROGRESS: 90.0%
| epoch  91 |   100/  269 batches | lr 0.00000 | ms/batch 256.64 | loss  2.80 | ppl    16.48 
| epoch  91 |   200/  269 batches | lr 0.00000 | ms/batch 233.76 | loss  2.78 | ppl    16.18 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 66.84s | valid loss  3.76 | valid ppl    42.75 | valid bpc    5.418
-----------------------------------------------------------------------------------------
PROGRESS: 91.0%
| epoch  92 |   100/  269 batches | lr 0.00000 | ms/batch 257.79 | loss  2.81 | ppl    16.58 
| epoch  92 |   200/  269 batches | lr 0.00000 | ms/batch 231.91 | loss  2.78 | ppl    16.05 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 66.88s | valid loss  3.71 | valid ppl    40.68 | valid bpc    5.346
-----------------------------------------------------------------------------------------
PROGRESS: 92.0%
| epoch  93 |   100/  269 batches | lr 0.00000 | ms/batch 257.72 | loss  2.81 | ppl    16.59 
| epoch  93 |   200/  269 batches | lr 0.00000 | ms/batch 231.60 | loss  2.78 | ppl    16.13 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 66.90s | valid loss  3.75 | valid ppl    42.53 | valid bpc    5.410
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  269 batches | lr 0.00000 | ms/batch 256.60 | loss  2.81 | ppl    16.67 
| epoch  94 |   200/  269 batches | lr 0.00000 | ms/batch 231.24 | loss  2.78 | ppl    16.08 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 66.93s | valid loss  3.74 | valid ppl    42.06 | valid bpc    5.394
-----------------------------------------------------------------------------------------
PROGRESS: 94.0%
| epoch  95 |   100/  269 batches | lr 0.00000 | ms/batch 258.33 | loss  2.79 | ppl    16.31 
| epoch  95 |   200/  269 batches | lr 0.00000 | ms/batch 231.24 | loss  2.79 | ppl    16.23 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 66.94s | valid loss  3.72 | valid ppl    41.06 | valid bpc    5.360
-----------------------------------------------------------------------------------------
PROGRESS: 95.0%
| epoch  96 |   100/  269 batches | lr 0.00000 | ms/batch 257.71 | loss  2.81 | ppl    16.55 
| epoch  96 |   200/  269 batches | lr 0.00000 | ms/batch 231.20 | loss  2.79 | ppl    16.26 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 66.93s | valid loss  3.76 | valid ppl    42.74 | valid bpc    5.417
-----------------------------------------------------------------------------------------
PROGRESS: 96.0%
| epoch  97 |   100/  269 batches | lr 0.00000 | ms/batch 255.91 | loss  2.82 | ppl    16.76 
| epoch  97 |   200/  269 batches | lr 0.00000 | ms/batch 231.57 | loss  2.77 | ppl    15.94 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 66.96s | valid loss  3.76 | valid ppl    42.90 | valid bpc    5.423
-----------------------------------------------------------------------------------------
PROGRESS: 97.0%
| epoch  98 |   100/  269 batches | lr 0.00000 | ms/batch 257.64 | loss  2.82 | ppl    16.77 
| epoch  98 |   200/  269 batches | lr 0.00000 | ms/batch 230.63 | loss  2.77 | ppl    15.95 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 66.88s | valid loss  3.71 | valid ppl    40.72 | valid bpc    5.348
-----------------------------------------------------------------------------------------
PROGRESS: 98.0%
| epoch  99 |   100/  269 batches | lr 0.00000 | ms/batch 256.27 | loss  2.80 | ppl    16.46 
| epoch  99 |   200/  269 batches | lr 0.00000 | ms/batch 232.00 | loss  2.78 | ppl    16.09 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 66.87s | valid loss  3.74 | valid ppl    42.14 | valid bpc    5.397
-----------------------------------------------------------------------------------------
PROGRESS: 99.0%
| epoch 100 |   100/  269 batches | lr 0.00000 | ms/batch 257.50 | loss  2.81 | ppl    16.66 
| epoch 100 |   200/  269 batches | lr 0.00000 | ms/batch 231.48 | loss  2.78 | ppl    16.11 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 66.88s | valid loss  3.74 | valid ppl    41.98 | valid bpc    5.392
-----------------------------------------------------------------------------------------
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  3.82 | test ppl    45.69 | test bpc    5.514
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.4606, Mean Reca: 0.6475, Mean F1: 0.5340, Mean Subword_Reca: 0.8340
-----------------------------------------------------------------------------------------
=========================================================================================
Loading dataset...
Using subword tokenizer...
Number of tokens:  8000
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer_in_parser', nhid=512, nlayers=8, front_layers=1, rear_layers=7, subword='omarmomen/ptb_filtered_lowcase_bpe_tokenizer_8', n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=5555, nonmono=5, cuda=True, log_interval=100, save='trained_models/subword_structformer_in_parser_5555_17.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 37449140
Model architecture: StructFormer_In_Parser(
  (transformer_front): Transformer_Front(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(8000, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0): TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
  (transformer_rear): Transformer_Rear(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(8000, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-6): 7 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (output_layer): Linear(in_features=512, out_features=8000, bias=True)
  )
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  269 batches | lr 0.00030 | ms/batch 255.36 | loss  7.72 | ppl  2262.89 
| epoch   1 |   200/  269 batches | lr 0.00030 | ms/batch 242.69 | loss  7.34 | ppl  1541.37 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 67.71s | valid loss  7.02 | valid ppl  1118.94 | valid bpc   10.128
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  269 batches | lr 0.00030 | ms/batch 176.71 | loss  7.19 | ppl  1321.78 
| epoch   2 |   200/  269 batches | lr 0.00030 | ms/batch 173.13 | loss  6.84 | ppl   929.86 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 47.72s | valid loss  6.30 | valid ppl   543.64 | valid bpc    9.087
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  269 batches | lr 0.00030 | ms/batch 140.81 | loss  6.37 | ppl   586.87 
| epoch   3 |   200/  269 batches | lr 0.00030 | ms/batch 92.41 | loss  6.11 | ppl   448.98 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 30.13s | valid loss  5.71 | valid ppl   302.04 | valid bpc    8.239
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  269 batches | lr 0.00030 | ms/batch 93.53 | loss  5.88 | ppl   358.51 
| epoch   4 |   200/  269 batches | lr 0.00030 | ms/batch 82.41 | loss  5.75 | ppl   312.72 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 23.22s | valid loss  5.43 | valid ppl   229.23 | valid bpc    7.841
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  269 batches | lr 0.00030 | ms/batch 139.22 | loss  5.63 | ppl   277.40 
| epoch   5 |   200/  269 batches | lr 0.00030 | ms/batch 162.05 | loss  5.52 | ppl   248.87 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 46.94s | valid loss  5.21 | valid ppl   183.89 | valid bpc    7.523
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  269 batches | lr 0.00030 | ms/batch 247.85 | loss  5.44 | ppl   230.76 
| epoch   6 |   200/  269 batches | lr 0.00030 | ms/batch 241.97 | loss  5.33 | ppl   207.31 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 66.16s | valid loss  5.08 | valid ppl   160.17 | valid bpc    7.323
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  269 batches | lr 0.00030 | ms/batch 247.76 | loss  5.30 | ppl   199.39 
| epoch   7 |   200/  269 batches | lr 0.00030 | ms/batch 239.27 | loss  5.17 | ppl   175.59 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 66.17s | valid loss  4.97 | valid ppl   144.11 | valid bpc    7.171
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  269 batches | lr 0.00030 | ms/batch 247.37 | loss  5.12 | ppl   167.69 
| epoch   8 |   200/  269 batches | lr 0.00030 | ms/batch 236.40 | loss  5.03 | ppl   153.65 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 66.18s | valid loss  4.87 | valid ppl   129.73 | valid bpc    7.019
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 8.0%
| epoch   9 |   100/  269 batches | lr 0.00030 | ms/batch 245.07 | loss  4.99 | ppl   146.79 
| epoch   9 |   200/  269 batches | lr 0.00030 | ms/batch 233.75 | loss  4.90 | ppl   134.39 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 65.88s | valid loss  4.76 | valid ppl   116.93 | valid bpc    6.870
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  269 batches | lr 0.00030 | ms/batch 248.39 | loss  4.86 | ppl   128.74 
| epoch  10 |   200/  269 batches | lr 0.00030 | ms/batch 233.28 | loss  4.78 | ppl   119.59 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 66.04s | valid loss  4.69 | valid ppl   109.27 | valid bpc    6.772
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  269 batches | lr 0.00030 | ms/batch 254.85 | loss  4.74 | ppl   114.76 
| epoch  11 |   200/  269 batches | lr 0.00030 | ms/batch 233.87 | loss  4.67 | ppl   106.37 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 66.11s | valid loss  4.55 | valid ppl    94.55 | valid bpc    6.563
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  269 batches | lr 0.00030 | ms/batch 256.64 | loss  4.62 | ppl   101.05 
| epoch  12 |   200/  269 batches | lr 0.00030 | ms/batch 234.55 | loss  4.56 | ppl    95.71 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 66.21s | valid loss  4.46 | valid ppl    86.71 | valid bpc    6.438
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 12.0%
| epoch  13 |   100/  269 batches | lr 0.00030 | ms/batch 258.35 | loss  4.52 | ppl    92.06 
| epoch  13 |   200/  269 batches | lr 0.00030 | ms/batch 233.53 | loss  4.49 | ppl    88.82 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 66.18s | valid loss  4.37 | valid ppl    79.39 | valid bpc    6.311
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 13.0%
| epoch  14 |   100/  269 batches | lr 0.00030 | ms/batch 256.64 | loss  4.43 | ppl    83.53 
| epoch  14 |   200/  269 batches | lr 0.00030 | ms/batch 235.44 | loss  4.38 | ppl    79.51 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 66.20s | valid loss  4.29 | valid ppl    72.68 | valid bpc    6.184
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  269 batches | lr 0.00030 | ms/batch 258.24 | loss  4.34 | ppl    76.63 
| epoch  15 |   200/  269 batches | lr 0.00030 | ms/batch 233.82 | loss  4.31 | ppl    74.27 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 66.23s | valid loss  4.27 | valid ppl    71.86 | valid bpc    6.167
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 15.0%
| epoch  16 |   100/  269 batches | lr 0.00030 | ms/batch 257.21 | loss  4.24 | ppl    69.74 
| epoch  16 |   200/  269 batches | lr 0.00030 | ms/batch 233.76 | loss  4.21 | ppl    67.61 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 66.23s | valid loss  4.22 | valid ppl    68.09 | valid bpc    6.089
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 16.0%
| epoch  17 |   100/  269 batches | lr 0.00030 | ms/batch 257.42 | loss  4.17 | ppl    64.81 
| epoch  17 |   200/  269 batches | lr 0.00030 | ms/batch 234.33 | loss  4.12 | ppl    61.75 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 66.23s | valid loss  4.18 | valid ppl    65.23 | valid bpc    6.027
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 17.0%
| epoch  18 |   100/  269 batches | lr 0.00030 | ms/batch 257.63 | loss  4.08 | ppl    59.32 
| epoch  18 |   200/  269 batches | lr 0.00030 | ms/batch 234.41 | loss  4.09 | ppl    59.73 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 66.24s | valid loss  4.18 | valid ppl    65.33 | valid bpc    6.030
-----------------------------------------------------------------------------------------
PROGRESS: 18.0%
| epoch  19 |   100/  269 batches | lr 0.00030 | ms/batch 258.41 | loss  4.02 | ppl    55.93 
| epoch  19 |   200/  269 batches | lr 0.00030 | ms/batch 232.51 | loss  4.01 | ppl    55.27 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 66.20s | valid loss  4.13 | valid ppl    62.00 | valid bpc    5.954
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 19.0%
| epoch  20 |   100/  269 batches | lr 0.00030 | ms/batch 258.08 | loss  3.98 | ppl    53.53 
| epoch  20 |   200/  269 batches | lr 0.00030 | ms/batch 233.02 | loss  3.95 | ppl    51.82 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 66.18s | valid loss  4.08 | valid ppl    59.31 | valid bpc    5.890
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 20.0%
| epoch  21 |   100/  269 batches | lr 0.00030 | ms/batch 257.10 | loss  3.91 | ppl    49.99 
| epoch  21 |   200/  269 batches | lr 0.00030 | ms/batch 233.89 | loss  3.87 | ppl    47.88 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 66.54s | valid loss  4.06 | valid ppl    58.20 | valid bpc    5.863
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 21.0%
| epoch  22 |   100/  269 batches | lr 0.00030 | ms/batch 257.14 | loss  3.86 | ppl    47.36 
| epoch  22 |   200/  269 batches | lr 0.00030 | ms/batch 229.80 | loss  3.84 | ppl    46.57 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 66.21s | valid loss  4.03 | valid ppl    56.37 | valid bpc    5.817
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 22.0%
| epoch  23 |   100/  269 batches | lr 0.00030 | ms/batch 257.26 | loss  3.83 | ppl    46.11 
| epoch  23 |   200/  269 batches | lr 0.00030 | ms/batch 225.36 | loss  3.78 | ppl    43.75 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 66.22s | valid loss  4.02 | valid ppl    55.63 | valid bpc    5.798
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 23.0%
| epoch  24 |   100/  269 batches | lr 0.00030 | ms/batch 257.22 | loss  3.71 | ppl    40.89 
| epoch  24 |   200/  269 batches | lr 0.00030 | ms/batch 224.07 | loss  3.72 | ppl    41.26 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 66.18s | valid loss  3.98 | valid ppl    53.72 | valid bpc    5.747
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 24.0%
| epoch  25 |   100/  269 batches | lr 0.00030 | ms/batch 257.25 | loss  3.70 | ppl    40.55 
| epoch  25 |   200/  269 batches | lr 0.00030 | ms/batch 224.75 | loss  3.70 | ppl    40.50 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 66.22s | valid loss  4.00 | valid ppl    54.76 | valid bpc    5.775
-----------------------------------------------------------------------------------------
PROGRESS: 25.0%
| epoch  26 |   100/  269 batches | lr 0.00030 | ms/batch 257.38 | loss  3.65 | ppl    38.65 
| epoch  26 |   200/  269 batches | lr 0.00030 | ms/batch 224.25 | loss  3.65 | ppl    38.34 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 66.19s | valid loss  3.92 | valid ppl    50.26 | valid bpc    5.651
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 26.0%
| epoch  27 |   100/  269 batches | lr 0.00030 | ms/batch 257.99 | loss  3.61 | ppl    36.96 
| epoch  27 |   200/  269 batches | lr 0.00030 | ms/batch 223.99 | loss  3.61 | ppl    36.79 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 66.24s | valid loss  3.96 | valid ppl    52.54 | valid bpc    5.715
-----------------------------------------------------------------------------------------
PROGRESS: 27.0%
| epoch  28 |   100/  269 batches | lr 0.00030 | ms/batch 259.49 | loss  3.59 | ppl    36.29 
| epoch  28 |   200/  269 batches | lr 0.00030 | ms/batch 223.28 | loss  3.55 | ppl    34.92 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 66.24s | valid loss  3.97 | valid ppl    53.13 | valid bpc    5.732
-----------------------------------------------------------------------------------------
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  269 batches | lr 0.00030 | ms/batch 257.26 | loss  3.52 | ppl    33.82 
| epoch  29 |   200/  269 batches | lr 0.00030 | ms/batch 231.75 | loss  3.50 | ppl    33.13 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 66.90s | valid loss  3.95 | valid ppl    52.18 | valid bpc    5.705
-----------------------------------------------------------------------------------------
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  269 batches | lr 0.00015 | ms/batch 257.71 | loss  3.46 | ppl    31.72 
| epoch  30 |   200/  269 batches | lr 0.00015 | ms/batch 224.51 | loss  3.40 | ppl    29.89 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 66.20s | valid loss  3.86 | valid ppl    47.48 | valid bpc    5.569
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 30.0%
| epoch  31 |   100/  269 batches | lr 0.00015 | ms/batch 256.85 | loss  3.38 | ppl    29.40 
| epoch  31 |   200/  269 batches | lr 0.00015 | ms/batch 225.24 | loss  3.36 | ppl    28.74 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 66.24s | valid loss  3.88 | valid ppl    48.24 | valid bpc    5.592
-----------------------------------------------------------------------------------------
PROGRESS: 31.0%
| epoch  32 |   100/  269 batches | lr 0.00015 | ms/batch 258.19 | loss  3.33 | ppl    27.93 
| epoch  32 |   200/  269 batches | lr 0.00015 | ms/batch 227.63 | loss  3.32 | ppl    27.66 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 66.59s | valid loss  3.92 | valid ppl    50.39 | valid bpc    5.655
-----------------------------------------------------------------------------------------
PROGRESS: 32.0%
| epoch  33 |   100/  269 batches | lr 0.00015 | ms/batch 256.37 | loss  3.30 | ppl    27.19 
| epoch  33 |   200/  269 batches | lr 0.00015 | ms/batch 228.31 | loss  3.28 | ppl    26.57 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 66.62s | valid loss  3.85 | valid ppl    47.18 | valid bpc    5.560
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 33.0%
| epoch  34 |   100/  269 batches | lr 0.00015 | ms/batch 257.54 | loss  3.28 | ppl    26.64 
| epoch  34 |   200/  269 batches | lr 0.00015 | ms/batch 231.09 | loss  3.28 | ppl    26.50 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 66.94s | valid loss  3.82 | valid ppl    45.44 | valid bpc    5.506
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 34.0%
| epoch  35 |   100/  269 batches | lr 0.00015 | ms/batch 254.35 | loss  3.24 | ppl    25.64 
| epoch  35 |   200/  269 batches | lr 0.00015 | ms/batch 232.34 | loss  3.24 | ppl    25.62 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 66.53s | valid loss  3.87 | valid ppl    47.85 | valid bpc    5.580
-----------------------------------------------------------------------------------------
PROGRESS: 35.0%
| epoch  36 |   100/  269 batches | lr 0.00015 | ms/batch 255.07 | loss  3.24 | ppl    25.53 
| epoch  36 |   200/  269 batches | lr 0.00015 | ms/batch 232.14 | loss  3.21 | ppl    24.86 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 66.53s | valid loss  3.75 | valid ppl    42.65 | valid bpc    5.415
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 36.0%
| epoch  37 |   100/  269 batches | lr 0.00015 | ms/batch 253.11 | loss  3.20 | ppl    24.55 
| epoch  37 |   200/  269 batches | lr 0.00015 | ms/batch 232.15 | loss  3.21 | ppl    24.70 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 66.50s | valid loss  3.82 | valid ppl    45.80 | valid bpc    5.517
-----------------------------------------------------------------------------------------
PROGRESS: 37.0%
| epoch  38 |   100/  269 batches | lr 0.00015 | ms/batch 252.93 | loss  3.19 | ppl    24.32 
| epoch  38 |   200/  269 batches | lr 0.00015 | ms/batch 232.99 | loss  3.16 | ppl    23.57 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 66.54s | valid loss  3.80 | valid ppl    44.83 | valid bpc    5.487
-----------------------------------------------------------------------------------------
PROGRESS: 38.0%
| epoch  39 |   100/  269 batches | lr 0.00015 | ms/batch 248.77 | loss  3.16 | ppl    23.59 
| epoch  39 |   200/  269 batches | lr 0.00015 | ms/batch 233.43 | loss  3.15 | ppl    23.38 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 66.25s | valid loss  3.79 | valid ppl    44.36 | valid bpc    5.471
-----------------------------------------------------------------------------------------
PROGRESS: 39.0%
| epoch  40 |   100/  269 batches | lr 0.00007 | ms/batch 247.01 | loss  3.12 | ppl    22.73 
| epoch  40 |   200/  269 batches | lr 0.00007 | ms/batch 237.05 | loss  3.09 | ppl    22.04 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 66.52s | valid loss  3.81 | valid ppl    45.13 | valid bpc    5.496
-----------------------------------------------------------------------------------------
PROGRESS: 40.0%
| epoch  41 |   100/  269 batches | lr 0.00007 | ms/batch 250.95 | loss  3.10 | ppl    22.19 
| epoch  41 |   200/  269 batches | lr 0.00007 | ms/batch 238.00 | loss  3.05 | ppl    21.18 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 66.94s | valid loss  3.82 | valid ppl    45.59 | valid bpc    5.511
-----------------------------------------------------------------------------------------
PROGRESS: 41.0%
| epoch  42 |   100/  269 batches | lr 0.00007 | ms/batch 244.67 | loss  3.09 | ppl    21.90 
| epoch  42 |   200/  269 batches | lr 0.00007 | ms/batch 242.62 | loss  3.04 | ppl    20.81 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 66.60s | valid loss  3.80 | valid ppl    44.52 | valid bpc    5.476
-----------------------------------------------------------------------------------------
PROGRESS: 42.0%
| epoch  43 |   100/  269 batches | lr 0.00004 | ms/batch 242.29 | loss  3.02 | ppl    20.56 
| epoch  43 |   200/  269 batches | lr 0.00004 | ms/batch 243.27 | loss  3.04 | ppl    20.87 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 66.56s | valid loss  3.79 | valid ppl    44.44 | valid bpc    5.474
-----------------------------------------------------------------------------------------
PROGRESS: 43.0%
| epoch  44 |   100/  269 batches | lr 0.00004 | ms/batch 239.41 | loss  3.01 | ppl    20.34 
| epoch  44 |   200/  269 batches | lr 0.00004 | ms/batch 243.27 | loss  3.01 | ppl    20.28 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 66.21s | valid loss  3.83 | valid ppl    45.98 | valid bpc    5.523
-----------------------------------------------------------------------------------------
PROGRESS: 44.0%
| epoch  45 |   100/  269 batches | lr 0.00004 | ms/batch 239.46 | loss  3.02 | ppl    20.56 
| epoch  45 |   200/  269 batches | lr 0.00004 | ms/batch 242.36 | loss  2.99 | ppl    19.84 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 66.15s | valid loss  3.83 | valid ppl    45.87 | valid bpc    5.519
-----------------------------------------------------------------------------------------
PROGRESS: 45.0%
| epoch  46 |   100/  269 batches | lr 0.00002 | ms/batch 237.32 | loss  3.01 | ppl    20.22 
| epoch  46 |   200/  269 batches | lr 0.00002 | ms/batch 243.87 | loss  2.99 | ppl    19.82 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 66.13s | valid loss  3.78 | valid ppl    43.92 | valid bpc    5.457
-----------------------------------------------------------------------------------------
PROGRESS: 46.0%
| epoch  47 |   100/  269 batches | lr 0.00002 | ms/batch 244.69 | loss  2.99 | ppl    19.81 
| epoch  47 |   200/  269 batches | lr 0.00002 | ms/batch 243.45 | loss  2.97 | ppl    19.40 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 66.92s | valid loss  3.79 | valid ppl    44.29 | valid bpc    5.469
-----------------------------------------------------------------------------------------
PROGRESS: 47.0%
| epoch  48 |   100/  269 batches | lr 0.00002 | ms/batch 245.51 | loss  2.99 | ppl    19.98 
| epoch  48 |   200/  269 batches | lr 0.00002 | ms/batch 243.39 | loss  2.99 | ppl    19.86 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 66.91s | valid loss  3.71 | valid ppl    40.72 | valid bpc    5.348
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 48.0%
| epoch  49 |   100/  269 batches | lr 0.00002 | ms/batch 239.19 | loss  2.98 | ppl    19.78 
| epoch  49 |   200/  269 batches | lr 0.00002 | ms/batch 244.45 | loss  2.98 | ppl    19.68 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 66.32s | valid loss  3.81 | valid ppl    45.14 | valid bpc    5.496
-----------------------------------------------------------------------------------------
PROGRESS: 49.0%
| epoch  50 |   100/  269 batches | lr 0.00002 | ms/batch 242.04 | loss  2.98 | ppl    19.71 
| epoch  50 |   200/  269 batches | lr 0.00002 | ms/batch 244.24 | loss  2.96 | ppl    19.37 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 66.62s | valid loss  3.80 | valid ppl    44.89 | valid bpc    5.488
-----------------------------------------------------------------------------------------
PROGRESS: 50.0%
| epoch  51 |   100/  269 batches | lr 0.00002 | ms/batch 242.78 | loss  3.00 | ppl    20.07 
| epoch  51 |   200/  269 batches | lr 0.00002 | ms/batch 244.21 | loss  2.96 | ppl    19.34 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 66.61s | valid loss  3.79 | valid ppl    44.05 | valid bpc    5.461
-----------------------------------------------------------------------------------------
PROGRESS: 51.0%
| epoch  52 |   100/  269 batches | lr 0.00001 | ms/batch 245.98 | loss  2.95 | ppl    19.19 
| epoch  52 |   200/  269 batches | lr 0.00001 | ms/batch 244.67 | loss  2.96 | ppl    19.20 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 67.03s | valid loss  3.73 | valid ppl    41.53 | valid bpc    5.376
-----------------------------------------------------------------------------------------
PROGRESS: 52.0%
| epoch  53 |   100/  269 batches | lr 0.00001 | ms/batch 228.33 | loss  2.97 | ppl    19.40 
| epoch  53 |   200/  269 batches | lr 0.00001 | ms/batch 243.51 | loss  2.93 | ppl    18.66 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 65.16s | valid loss  3.80 | valid ppl    44.74 | valid bpc    5.483
-----------------------------------------------------------------------------------------
PROGRESS: 53.0%
| epoch  54 |   100/  269 batches | lr 0.00001 | ms/batch 246.94 | loss  2.98 | ppl    19.70 
| epoch  54 |   200/  269 batches | lr 0.00001 | ms/batch 241.19 | loss  2.93 | ppl    18.70 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 66.88s | valid loss  3.74 | valid ppl    42.22 | valid bpc    5.400
-----------------------------------------------------------------------------------------
PROGRESS: 54.0%
| epoch  55 |   100/  269 batches | lr 0.00000 | ms/batch 244.90 | loss  2.97 | ppl    19.53 
| epoch  55 |   200/  269 batches | lr 0.00000 | ms/batch 245.09 | loss  2.93 | ppl    18.72 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 66.92s | valid loss  3.82 | valid ppl    45.61 | valid bpc    5.511
-----------------------------------------------------------------------------------------
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  269 batches | lr 0.00000 | ms/batch 246.35 | loss  2.96 | ppl    19.23 
| epoch  56 |   200/  269 batches | lr 0.00000 | ms/batch 242.33 | loss  2.92 | ppl    18.61 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 66.91s | valid loss  3.74 | valid ppl    41.92 | valid bpc    5.390
-----------------------------------------------------------------------------------------
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  269 batches | lr 0.00000 | ms/batch 242.22 | loss  2.95 | ppl    19.16 
| epoch  57 |   200/  269 batches | lr 0.00000 | ms/batch 243.27 | loss  2.93 | ppl    18.75 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 66.59s | valid loss  3.74 | valid ppl    42.30 | valid bpc    5.403
-----------------------------------------------------------------------------------------
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  269 batches | lr 0.00000 | ms/batch 242.46 | loss  2.95 | ppl    19.18 
| epoch  58 |   200/  269 batches | lr 0.00000 | ms/batch 243.59 | loss  2.94 | ppl    18.93 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 66.56s | valid loss  3.79 | valid ppl    44.40 | valid bpc    5.473
-----------------------------------------------------------------------------------------
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  269 batches | lr 0.00000 | ms/batch 245.40 | loss  2.96 | ppl    19.29 
| epoch  59 |   200/  269 batches | lr 0.00000 | ms/batch 243.80 | loss  2.91 | ppl    18.40 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 66.89s | valid loss  3.76 | valid ppl    42.96 | valid bpc    5.425
-----------------------------------------------------------------------------------------
PROGRESS: 59.0%
| epoch  60 |   100/  269 batches | lr 0.00000 | ms/batch 242.83 | loss  2.98 | ppl    19.77 
| epoch  60 |   200/  269 batches | lr 0.00000 | ms/batch 243.12 | loss  2.91 | ppl    18.44 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 66.56s | valid loss  3.75 | valid ppl    42.67 | valid bpc    5.415
-----------------------------------------------------------------------------------------
PROGRESS: 60.0%
| epoch  61 |   100/  269 batches | lr 0.00000 | ms/batch 243.18 | loss  2.93 | ppl    18.81 
| epoch  61 |   200/  269 batches | lr 0.00000 | ms/batch 242.94 | loss  2.93 | ppl    18.75 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 66.58s | valid loss  3.74 | valid ppl    42.05 | valid bpc    5.394
-----------------------------------------------------------------------------------------
PROGRESS: 61.0%
| epoch  62 |   100/  269 batches | lr 0.00000 | ms/batch 245.15 | loss  2.97 | ppl    19.40 
| epoch  62 |   200/  269 batches | lr 0.00000 | ms/batch 243.95 | loss  2.94 | ppl    18.89 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 66.91s | valid loss  3.79 | valid ppl    44.44 | valid bpc    5.474
-----------------------------------------------------------------------------------------
PROGRESS: 62.0%
| epoch  63 |   100/  269 batches | lr 0.00000 | ms/batch 245.55 | loss  2.95 | ppl    19.10 
| epoch  63 |   200/  269 batches | lr 0.00000 | ms/batch 243.04 | loss  2.94 | ppl    18.87 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 66.93s | valid loss  3.73 | valid ppl    41.75 | valid bpc    5.384
-----------------------------------------------------------------------------------------
PROGRESS: 63.0%
| epoch  64 |   100/  269 batches | lr 0.00000 | ms/batch 242.89 | loss  2.94 | ppl    18.90 
| epoch  64 |   200/  269 batches | lr 0.00000 | ms/batch 242.52 | loss  2.94 | ppl    18.88 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 66.51s | valid loss  3.78 | valid ppl    43.90 | valid bpc    5.456
-----------------------------------------------------------------------------------------
PROGRESS: 64.0%
| epoch  65 |   100/  269 batches | lr 0.00000 | ms/batch 245.70 | loss  2.96 | ppl    19.24 
| epoch  65 |   200/  269 batches | lr 0.00000 | ms/batch 243.65 | loss  2.92 | ppl    18.51 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 66.93s | valid loss  3.75 | valid ppl    42.58 | valid bpc    5.412
-----------------------------------------------------------------------------------------
PROGRESS: 65.0%
| epoch  66 |   100/  269 batches | lr 0.00000 | ms/batch 241.34 | loss  2.93 | ppl    18.79 
| epoch  66 |   200/  269 batches | lr 0.00000 | ms/batch 243.06 | loss  2.94 | ppl    18.91 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 66.39s | valid loss  3.78 | valid ppl    43.90 | valid bpc    5.456
-----------------------------------------------------------------------------------------
PROGRESS: 66.0%
| epoch  67 |   100/  269 batches | lr 0.00000 | ms/batch 247.83 | loss  2.97 | ppl    19.42 
| epoch  67 |   200/  269 batches | lr 0.00000 | ms/batch 242.50 | loss  2.89 | ppl    18.07 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 66.41s | valid loss  3.79 | valid ppl    44.41 | valid bpc    5.473
-----------------------------------------------------------------------------------------
PROGRESS: 67.0%
| epoch  68 |   100/  269 batches | lr 0.00000 | ms/batch 252.32 | loss  2.98 | ppl    19.63 
| epoch  68 |   200/  269 batches | lr 0.00000 | ms/batch 242.53 | loss  2.93 | ppl    18.81 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 66.89s | valid loss  3.81 | valid ppl    45.11 | valid bpc    5.495
-----------------------------------------------------------------------------------------
PROGRESS: 68.0%
| epoch  69 |   100/  269 batches | lr 0.00000 | ms/batch 251.79 | loss  2.94 | ppl    18.87 
| epoch  69 |   200/  269 batches | lr 0.00000 | ms/batch 243.30 | loss  2.91 | ppl    18.42 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 66.90s | valid loss  3.75 | valid ppl    42.37 | valid bpc    5.405
-----------------------------------------------------------------------------------------
PROGRESS: 69.0%
| epoch  70 |   100/  269 batches | lr 0.00000 | ms/batch 250.52 | loss  2.93 | ppl    18.79 
| epoch  70 |   200/  269 batches | lr 0.00000 | ms/batch 242.59 | loss  2.92 | ppl    18.53 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 66.82s | valid loss  3.76 | valid ppl    43.11 | valid bpc    5.430
-----------------------------------------------------------------------------------------
PROGRESS: 70.0%
| epoch  71 |   100/  269 batches | lr 0.00000 | ms/batch 253.61 | loss  2.95 | ppl    19.13 
| epoch  71 |   200/  269 batches | lr 0.00000 | ms/batch 241.99 | loss  2.93 | ppl    18.73 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 66.96s | valid loss  3.74 | valid ppl    42.23 | valid bpc    5.400
-----------------------------------------------------------------------------------------
PROGRESS: 71.0%
| epoch  72 |   100/  269 batches | lr 0.00000 | ms/batch 251.95 | loss  2.94 | ppl    18.99 
| epoch  72 |   200/  269 batches | lr 0.00000 | ms/batch 243.83 | loss  2.93 | ppl    18.71 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 66.96s | valid loss  3.77 | valid ppl    43.23 | valid bpc    5.434
-----------------------------------------------------------------------------------------
PROGRESS: 72.0%
| epoch  73 |   100/  269 batches | lr 0.00000 | ms/batch 252.30 | loss  2.97 | ppl    19.42 
| epoch  73 |   200/  269 batches | lr 0.00000 | ms/batch 242.94 | loss  2.92 | ppl    18.60 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 66.91s | valid loss  3.75 | valid ppl    42.71 | valid bpc    5.417
-----------------------------------------------------------------------------------------
PROGRESS: 73.0%
| epoch  74 |   100/  269 batches | lr 0.00000 | ms/batch 250.86 | loss  2.97 | ppl    19.41 
| epoch  74 |   200/  269 batches | lr 0.00000 | ms/batch 243.91 | loss  2.93 | ppl    18.66 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 66.92s | valid loss  3.78 | valid ppl    43.76 | valid bpc    5.452
-----------------------------------------------------------------------------------------
PROGRESS: 74.0%
| epoch  75 |   100/  269 batches | lr 0.00000 | ms/batch 251.31 | loss  2.97 | ppl    19.56 
| epoch  75 |   200/  269 batches | lr 0.00000 | ms/batch 243.62 | loss  2.90 | ppl    18.22 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 66.81s | valid loss  3.78 | valid ppl    43.64 | valid bpc    5.447
-----------------------------------------------------------------------------------------
PROGRESS: 75.0%
| epoch  76 |   100/  269 batches | lr 0.00000 | ms/batch 251.92 | loss  2.95 | ppl    19.02 
| epoch  76 |   200/  269 batches | lr 0.00000 | ms/batch 244.87 | loss  2.90 | ppl    18.26 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 66.64s | valid loss  3.70 | valid ppl    40.56 | valid bpc    5.342
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 76.0%
| epoch  77 |   100/  269 batches | lr 0.00000 | ms/batch 257.78 | loss  2.94 | ppl    18.90 
| epoch  77 |   200/  269 batches | lr 0.00000 | ms/batch 241.63 | loss  2.91 | ppl    18.34 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 66.97s | valid loss  3.77 | valid ppl    43.47 | valid bpc    5.442
-----------------------------------------------------------------------------------------
PROGRESS: 77.0%
| epoch  78 |   100/  269 batches | lr 0.00000 | ms/batch 257.16 | loss  2.95 | ppl    19.01 
| epoch  78 |   200/  269 batches | lr 0.00000 | ms/batch 237.82 | loss  2.92 | ppl    18.47 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 66.56s | valid loss  3.76 | valid ppl    42.75 | valid bpc    5.418
-----------------------------------------------------------------------------------------
PROGRESS: 78.0%
| epoch  79 |   100/  269 batches | lr 0.00000 | ms/batch 255.82 | loss  2.94 | ppl    18.99 
| epoch  79 |   200/  269 batches | lr 0.00000 | ms/batch 238.21 | loss  2.94 | ppl    18.93 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 66.89s | valid loss  3.78 | valid ppl    43.86 | valid bpc    5.455
-----------------------------------------------------------------------------------------
PROGRESS: 79.0%
| epoch  80 |   100/  269 batches | lr 0.00000 | ms/batch 256.68 | loss  2.95 | ppl    19.04 
| epoch  80 |   200/  269 batches | lr 0.00000 | ms/batch 238.57 | loss  2.95 | ppl    19.04 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 66.86s | valid loss  3.76 | valid ppl    42.86 | valid bpc    5.421
-----------------------------------------------------------------------------------------
PROGRESS: 80.0%
| epoch  81 |   100/  269 batches | lr 0.00000 | ms/batch 258.96 | loss  2.97 | ppl    19.49 
| epoch  81 |   200/  269 batches | lr 0.00000 | ms/batch 237.74 | loss  2.93 | ppl    18.78 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 66.94s | valid loss  3.75 | valid ppl    42.67 | valid bpc    5.415
-----------------------------------------------------------------------------------------
PROGRESS: 81.0%
| epoch  82 |   100/  269 batches | lr 0.00000 | ms/batch 257.86 | loss  2.97 | ppl    19.51 
| epoch  82 |   200/  269 batches | lr 0.00000 | ms/batch 236.98 | loss  2.92 | ppl    18.56 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 66.92s | valid loss  3.71 | valid ppl    41.01 | valid bpc    5.358
-----------------------------------------------------------------------------------------
PROGRESS: 82.0%
| epoch  83 |   100/  269 batches | lr 0.00000 | ms/batch 257.25 | loss  2.95 | ppl    19.13 
| epoch  83 |   200/  269 batches | lr 0.00000 | ms/batch 233.52 | loss  2.94 | ppl    18.89 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 66.60s | valid loss  3.74 | valid ppl    42.07 | valid bpc    5.395
-----------------------------------------------------------------------------------------
PROGRESS: 83.0%
| epoch  84 |   100/  269 batches | lr 0.00000 | ms/batch 256.89 | loss  2.96 | ppl    19.32 
| epoch  84 |   200/  269 batches | lr 0.00000 | ms/batch 237.90 | loss  2.92 | ppl    18.45 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 66.91s | valid loss  3.72 | valid ppl    41.36 | valid bpc    5.370
-----------------------------------------------------------------------------------------
PROGRESS: 84.0%
| epoch  85 |   100/  269 batches | lr 0.00000 | ms/batch 259.29 | loss  2.94 | ppl    18.95 
| epoch  85 |   200/  269 batches | lr 0.00000 | ms/batch 236.54 | loss  2.93 | ppl    18.79 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 66.99s | valid loss  3.73 | valid ppl    41.66 | valid bpc    5.380
-----------------------------------------------------------------------------------------
PROGRESS: 85.0%
| epoch  86 |   100/  269 batches | lr 0.00000 | ms/batch 257.25 | loss  2.96 | ppl    19.23 
| epoch  86 |   200/  269 batches | lr 0.00000 | ms/batch 238.48 | loss  2.91 | ppl    18.40 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 66.90s | valid loss  3.73 | valid ppl    41.71 | valid bpc    5.382
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  269 batches | lr 0.00000 | ms/batch 257.78 | loss  2.95 | ppl    19.15 
| epoch  87 |   200/  269 batches | lr 0.00000 | ms/batch 236.26 | loss  2.94 | ppl    19.01 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 66.92s | valid loss  3.81 | valid ppl    45.30 | valid bpc    5.501
-----------------------------------------------------------------------------------------
PROGRESS: 87.0%
| epoch  88 |   100/  269 batches | lr 0.00000 | ms/batch 257.35 | loss  2.94 | ppl    18.95 
| epoch  88 |   200/  269 batches | lr 0.00000 | ms/batch 237.90 | loss  2.94 | ppl    18.83 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 66.98s | valid loss  3.77 | valid ppl    43.51 | valid bpc    5.443
-----------------------------------------------------------------------------------------
PROGRESS: 88.0%
| epoch  89 |   100/  269 batches | lr 0.00000 | ms/batch 257.58 | loss  2.95 | ppl    19.07 
| epoch  89 |   200/  269 batches | lr 0.00000 | ms/batch 236.70 | loss  2.93 | ppl    18.69 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 66.98s | valid loss  3.80 | valid ppl    44.62 | valid bpc    5.480
-----------------------------------------------------------------------------------------
PROGRESS: 89.0%
| epoch  90 |   100/  269 batches | lr 0.00000 | ms/batch 257.94 | loss  2.94 | ppl    18.93 
| epoch  90 |   200/  269 batches | lr 0.00000 | ms/batch 236.92 | loss  2.91 | ppl    18.33 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 66.94s | valid loss  3.72 | valid ppl    41.47 | valid bpc    5.374
-----------------------------------------------------------------------------------------
PROGRESS: 90.0%
| epoch  91 |   100/  269 batches | lr 0.00000 | ms/batch 258.71 | loss  2.96 | ppl    19.38 
| epoch  91 |   200/  269 batches | lr 0.00000 | ms/batch 236.85 | loss  2.91 | ppl    18.28 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 66.98s | valid loss  3.77 | valid ppl    43.42 | valid bpc    5.440
-----------------------------------------------------------------------------------------
PROGRESS: 91.0%
| epoch  92 |   100/  269 batches | lr 0.00000 | ms/batch 259.64 | loss  2.96 | ppl    19.22 
| epoch  92 |   200/  269 batches | lr 0.00000 | ms/batch 237.23 | loss  2.94 | ppl    18.87 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 66.98s | valid loss  3.76 | valid ppl    43.10 | valid bpc    5.430
-----------------------------------------------------------------------------------------
PROGRESS: 92.0%
| epoch  93 |   100/  269 batches | lr 0.00000 | ms/batch 256.96 | loss  2.96 | ppl    19.24 
| epoch  93 |   200/  269 batches | lr 0.00000 | ms/batch 237.25 | loss  2.92 | ppl    18.53 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 66.93s | valid loss  3.79 | valid ppl    44.16 | valid bpc    5.465
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  269 batches | lr 0.00000 | ms/batch 254.35 | loss  2.97 | ppl    19.46 
| epoch  94 |   200/  269 batches | lr 0.00000 | ms/batch 238.88 | loss  2.93 | ppl    18.74 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 66.87s | valid loss  3.73 | valid ppl    41.49 | valid bpc    5.375
-----------------------------------------------------------------------------------------
PROGRESS: 94.0%
| epoch  95 |   100/  269 batches | lr 0.00000 | ms/batch 252.44 | loss  2.96 | ppl    19.23 
| epoch  95 |   200/  269 batches | lr 0.00000 | ms/batch 237.59 | loss  2.93 | ppl    18.76 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 66.91s | valid loss  3.80 | valid ppl    44.88 | valid bpc    5.488
-----------------------------------------------------------------------------------------
PROGRESS: 95.0%
| epoch  96 |   100/  269 batches | lr 0.00000 | ms/batch 251.00 | loss  2.94 | ppl    19.01 
| epoch  96 |   200/  269 batches | lr 0.00000 | ms/batch 238.07 | loss  2.93 | ppl    18.79 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 66.93s | valid loss  3.76 | valid ppl    42.97 | valid bpc    5.425
-----------------------------------------------------------------------------------------
PROGRESS: 96.0%
| epoch  97 |   100/  269 batches | lr 0.00000 | ms/batch 252.26 | loss  2.96 | ppl    19.21 
| epoch  97 |   200/  269 batches | lr 0.00000 | ms/batch 236.54 | loss  2.92 | ppl    18.63 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 66.91s | valid loss  3.76 | valid ppl    42.78 | valid bpc    5.419
-----------------------------------------------------------------------------------------
PROGRESS: 97.0%
| epoch  98 |   100/  269 batches | lr 0.00000 | ms/batch 250.84 | loss  2.93 | ppl    18.81 
| epoch  98 |   200/  269 batches | lr 0.00000 | ms/batch 232.85 | loss  2.94 | ppl    18.84 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 66.57s | valid loss  3.79 | valid ppl    44.15 | valid bpc    5.464
-----------------------------------------------------------------------------------------
PROGRESS: 98.0%
| epoch  99 |   100/  269 batches | lr 0.00000 | ms/batch 251.12 | loss  2.96 | ppl    19.26 
| epoch  99 |   200/  269 batches | lr 0.00000 | ms/batch 238.51 | loss  2.89 | ppl    17.97 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 66.90s | valid loss  3.73 | valid ppl    41.61 | valid bpc    5.379
-----------------------------------------------------------------------------------------
PROGRESS: 99.0%
| epoch 100 |   100/  269 batches | lr 0.00000 | ms/batch 252.62 | loss  2.92 | ppl    18.63 
| epoch 100 |   200/  269 batches | lr 0.00000 | ms/batch 237.10 | loss  2.95 | ppl    19.10 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 66.96s | valid loss  3.73 | valid ppl    41.63 | valid bpc    5.379
-----------------------------------------------------------------------------------------
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  3.88 | test ppl    48.40 | test bpc    5.597
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.4555, Mean Reca: 0.6384, Mean F1: 0.5277, Mean Subword_Reca: 0.7891
-----------------------------------------------------------------------------------------
=========================================================================================
Loading dataset...
Using subword tokenizer...
Number of tokens:  8000
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer_in_parser', nhid=512, nlayers=8, front_layers=2, rear_layers=6, subword='omarmomen/ptb_filtered_lowcase_bpe_tokenizer_8', n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=1111, nonmono=5, cuda=True, log_interval=100, save='trained_models/subword_structformer_in_parser_1111_26.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 37449124
Model architecture: StructFormer_In_Parser(
  (transformer_front): Transformer_Front(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(8000, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-1): 2 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
  (transformer_rear): Transformer_Rear(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(8000, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-5): 6 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (output_layer): Linear(in_features=512, out_features=8000, bias=True)
  )
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  269 batches | lr 0.00030 | ms/batch 180.65 | loss  7.73 | ppl  2273.30 
| epoch   1 |   200/  269 batches | lr 0.00030 | ms/batch 171.57 | loss  7.35 | ppl  1561.79 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 47.96s | valid loss  7.09 | valid ppl  1202.58 | valid bpc   10.232
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  269 batches | lr 0.00030 | ms/batch 127.78 | loss  7.28 | ppl  1444.08 
| epoch   2 |   200/  269 batches | lr 0.00030 | ms/batch 90.33 | loss  7.13 | ppl  1253.69 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 28.60s | valid loss  6.76 | valid ppl   859.56 | valid bpc    9.747
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  269 batches | lr 0.00030 | ms/batch 92.70 | loss  6.89 | ppl   978.44 
| epoch   3 |   200/  269 batches | lr 0.00030 | ms/batch 81.07 | loss  6.59 | ppl   727.55 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 28.81s | valid loss  6.16 | valid ppl   474.60 | valid bpc    8.891
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  269 batches | lr 0.00030 | ms/batch 169.70 | loss  6.27 | ppl   529.10 
| epoch   4 |   200/  269 batches | lr 0.00030 | ms/batch 194.86 | loss  6.04 | ppl   421.19 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 54.39s | valid loss  5.72 | valid ppl   304.64 | valid bpc    8.251
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  269 batches | lr 0.00030 | ms/batch 256.08 | loss  5.88 | ppl   359.32 
| epoch   5 |   200/  269 batches | lr 0.00030 | ms/batch 224.85 | loss  5.78 | ppl   323.70 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 65.94s | valid loss  5.43 | valid ppl   227.24 | valid bpc    7.828
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  269 batches | lr 0.00030 | ms/batch 256.91 | loss  5.67 | ppl   289.87 
| epoch   6 |   200/  269 batches | lr 0.00030 | ms/batch 223.69 | loss  5.55 | ppl   256.08 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 66.04s | valid loss  5.29 | valid ppl   199.05 | valid bpc    7.637
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  269 batches | lr 0.00030 | ms/batch 255.94 | loss  5.44 | ppl   230.57 
| epoch   7 |   200/  269 batches | lr 0.00030 | ms/batch 225.17 | loss  5.40 | ppl   221.60 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 66.10s | valid loss  5.17 | valid ppl   176.56 | valid bpc    7.464
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  269 batches | lr 0.00030 | ms/batch 258.14 | loss  5.33 | ppl   206.25 
| epoch   8 |   200/  269 batches | lr 0.00030 | ms/batch 222.29 | loss  5.24 | ppl   187.78 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 66.03s | valid loss  5.07 | valid ppl   159.32 | valid bpc    7.316
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 8.0%
| epoch   9 |   100/  269 batches | lr 0.00030 | ms/batch 255.94 | loss  5.17 | ppl   176.50 
| epoch   9 |   200/  269 batches | lr 0.00030 | ms/batch 210.35 | loss  5.10 | ppl   163.40 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 64.78s | valid loss  4.92 | valid ppl   136.81 | valid bpc    7.096
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  269 batches | lr 0.00030 | ms/batch 256.45 | loss  5.05 | ppl   156.15 
| epoch  10 |   200/  269 batches | lr 0.00030 | ms/batch 223.07 | loss  4.98 | ppl   145.83 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 66.01s | valid loss  4.83 | valid ppl   124.64 | valid bpc    6.962
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  269 batches | lr 0.00030 | ms/batch 257.20 | loss  4.94 | ppl   139.42 
| epoch  11 |   200/  269 batches | lr 0.00030 | ms/batch 223.74 | loss  4.87 | ppl   130.70 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 66.07s | valid loss  4.74 | valid ppl   114.59 | valid bpc    6.840
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  269 batches | lr 0.00030 | ms/batch 250.42 | loss  4.83 | ppl   125.68 
| epoch  12 |   200/  269 batches | lr 0.00030 | ms/batch 231.52 | loss  4.79 | ppl   119.71 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 66.04s | valid loss  4.58 | valid ppl    97.74 | valid bpc    6.611
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 12.0%
| epoch  13 |   100/  269 batches | lr 0.00030 | ms/batch 246.60 | loss  4.73 | ppl   113.21 
| epoch  13 |   200/  269 batches | lr 0.00030 | ms/batch 234.05 | loss  4.66 | ppl   105.67 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 66.04s | valid loss  4.60 | valid ppl    99.59 | valid bpc    6.638
-----------------------------------------------------------------------------------------
PROGRESS: 13.0%
| epoch  14 |   100/  269 batches | lr 0.00030 | ms/batch 247.89 | loss  4.64 | ppl   103.38 
| epoch  14 |   200/  269 batches | lr 0.00030 | ms/batch 233.78 | loss  4.58 | ppl    97.99 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 66.03s | valid loss  4.48 | valid ppl    88.09 | valid bpc    6.461
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  269 batches | lr 0.00030 | ms/batch 246.35 | loss  4.55 | ppl    94.25 
| epoch  15 |   200/  269 batches | lr 0.00030 | ms/batch 235.19 | loss  4.52 | ppl    92.25 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 66.05s | valid loss  4.40 | valid ppl    81.45 | valid bpc    6.348
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 15.0%
| epoch  16 |   100/  269 batches | lr 0.00030 | ms/batch 247.20 | loss  4.45 | ppl    85.75 
| epoch  16 |   200/  269 batches | lr 0.00030 | ms/batch 233.94 | loss  4.44 | ppl    84.89 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 66.04s | valid loss  4.37 | valid ppl    79.02 | valid bpc    6.304
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 16.0%
| epoch  17 |   100/  269 batches | lr 0.00030 | ms/batch 248.06 | loss  4.40 | ppl    81.24 
| epoch  17 |   200/  269 batches | lr 0.00030 | ms/batch 232.42 | loss  4.30 | ppl    74.07 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 66.08s | valid loss  4.27 | valid ppl    71.81 | valid bpc    6.166
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 17.0%
| epoch  18 |   100/  269 batches | lr 0.00030 | ms/batch 248.10 | loss  4.30 | ppl    73.38 
| epoch  18 |   200/  269 batches | lr 0.00030 | ms/batch 237.87 | loss  4.30 | ppl    73.40 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 66.50s | valid loss  4.29 | valid ppl    73.09 | valid bpc    6.192
-----------------------------------------------------------------------------------------
PROGRESS: 18.0%
| epoch  19 |   100/  269 batches | lr 0.00030 | ms/batch 247.97 | loss  4.24 | ppl    69.59 
| epoch  19 |   200/  269 batches | lr 0.00030 | ms/batch 233.78 | loss  4.18 | ppl    65.36 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 66.02s | valid loss  4.23 | valid ppl    68.52 | valid bpc    6.098
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 19.0%
| epoch  20 |   100/  269 batches | lr 0.00030 | ms/batch 245.74 | loss  4.17 | ppl    64.99 
| epoch  20 |   200/  269 batches | lr 0.00030 | ms/batch 236.75 | loss  4.14 | ppl    62.69 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 66.07s | valid loss  4.19 | valid ppl    66.20 | valid bpc    6.049
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 20.0%
| epoch  21 |   100/  269 batches | lr 0.00030 | ms/batch 246.44 | loss  4.09 | ppl    59.73 
| epoch  21 |   200/  269 batches | lr 0.00030 | ms/batch 238.42 | loss  4.07 | ppl    58.65 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 65.61s | valid loss  4.18 | valid ppl    65.05 | valid bpc    6.023
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 21.0%
| epoch  22 |   100/  269 batches | lr 0.00030 | ms/batch 246.58 | loss  4.04 | ppl    56.91 
| epoch  22 |   200/  269 batches | lr 0.00030 | ms/batch 243.60 | loss  4.02 | ppl    55.88 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 66.03s | valid loss  4.14 | valid ppl    62.64 | valid bpc    5.969
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 22.0%
| epoch  23 |   100/  269 batches | lr 0.00030 | ms/batch 247.19 | loss  3.97 | ppl    53.11 
| epoch  23 |   200/  269 batches | lr 0.00030 | ms/batch 243.28 | loss  3.98 | ppl    53.65 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 66.03s | valid loss  4.07 | valid ppl    58.40 | valid bpc    5.868
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 23.0%
| epoch  24 |   100/  269 batches | lr 0.00030 | ms/batch 247.23 | loss  3.90 | ppl    49.19 
| epoch  24 |   200/  269 batches | lr 0.00030 | ms/batch 242.00 | loss  3.92 | ppl    50.51 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 66.05s | valid loss  4.06 | valid ppl    58.14 | valid bpc    5.861
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 24.0%
| epoch  25 |   100/  269 batches | lr 0.00030 | ms/batch 245.35 | loss  3.88 | ppl    48.22 
| epoch  25 |   200/  269 batches | lr 0.00030 | ms/batch 242.93 | loss  3.83 | ppl    46.09 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 66.22s | valid loss  4.07 | valid ppl    58.47 | valid bpc    5.870
-----------------------------------------------------------------------------------------
PROGRESS: 25.0%
| epoch  26 |   100/  269 batches | lr 0.00030 | ms/batch 246.69 | loss  3.84 | ppl    46.46 
| epoch  26 |   200/  269 batches | lr 0.00030 | ms/batch 242.73 | loss  3.83 | ppl    45.85 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 66.05s | valid loss  4.02 | valid ppl    55.89 | valid bpc    5.804
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 26.0%
| epoch  27 |   100/  269 batches | lr 0.00030 | ms/batch 247.89 | loss  3.77 | ppl    43.49 
| epoch  27 |   200/  269 batches | lr 0.00030 | ms/batch 232.63 | loss  3.76 | ppl    42.79 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 66.08s | valid loss  4.00 | valid ppl    54.34 | valid bpc    5.764
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 27.0%
| epoch  28 |   100/  269 batches | lr 0.00030 | ms/batch 247.83 | loss  3.74 | ppl    42.09 
| epoch  28 |   200/  269 batches | lr 0.00030 | ms/batch 233.72 | loss  3.72 | ppl    41.37 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 66.06s | valid loss  3.97 | valid ppl    53.12 | valid bpc    5.731
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  269 batches | lr 0.00030 | ms/batch 246.75 | loss  3.69 | ppl    40.14 
| epoch  29 |   200/  269 batches | lr 0.00030 | ms/batch 237.79 | loss  3.68 | ppl    39.75 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 66.36s | valid loss  3.97 | valid ppl    52.72 | valid bpc    5.720
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  269 batches | lr 0.00030 | ms/batch 245.55 | loss  3.63 | ppl    37.83 
| epoch  30 |   200/  269 batches | lr 0.00030 | ms/batch 238.10 | loss  3.63 | ppl    37.89 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 66.39s | valid loss  3.93 | valid ppl    51.02 | valid bpc    5.673
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 30.0%
| epoch  31 |   100/  269 batches | lr 0.00030 | ms/batch 246.24 | loss  3.60 | ppl    36.51 
| epoch  31 |   200/  269 batches | lr 0.00030 | ms/batch 234.77 | loss  3.59 | ppl    36.15 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 66.01s | valid loss  3.93 | valid ppl    50.79 | valid bpc    5.666
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 31.0%
| epoch  32 |   100/  269 batches | lr 0.00030 | ms/batch 248.59 | loss  3.57 | ppl    35.40 
| epoch  32 |   200/  269 batches | lr 0.00030 | ms/batch 233.21 | loss  3.57 | ppl    35.41 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 66.07s | valid loss  3.95 | valid ppl    51.96 | valid bpc    5.699
-----------------------------------------------------------------------------------------
PROGRESS: 32.0%
| epoch  33 |   100/  269 batches | lr 0.00030 | ms/batch 246.40 | loss  3.55 | ppl    34.96 
| epoch  33 |   200/  269 batches | lr 0.00030 | ms/batch 234.76 | loss  3.51 | ppl    33.42 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 66.01s | valid loss  3.93 | valid ppl    50.69 | valid bpc    5.664
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 33.0%
| epoch  34 |   100/  269 batches | lr 0.00030 | ms/batch 247.65 | loss  3.51 | ppl    33.58 
| epoch  34 |   200/  269 batches | lr 0.00030 | ms/batch 237.11 | loss  3.47 | ppl    32.17 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 66.37s | valid loss  3.92 | valid ppl    50.32 | valid bpc    5.653
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 34.0%
| epoch  35 |   100/  269 batches | lr 0.00030 | ms/batch 241.21 | loss  3.46 | ppl    31.78 
| epoch  35 |   200/  269 batches | lr 0.00030 | ms/batch 242.63 | loss  3.46 | ppl    31.83 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 66.44s | valid loss  3.92 | valid ppl    50.26 | valid bpc    5.651
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 35.0%
| epoch  36 |   100/  269 batches | lr 0.00030 | ms/batch 245.19 | loss  3.43 | ppl    30.79 
| epoch  36 |   200/  269 batches | lr 0.00030 | ms/batch 243.08 | loss  3.41 | ppl    30.14 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 66.79s | valid loss  3.87 | valid ppl    48.12 | valid bpc    5.589
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 36.0%
| epoch  37 |   100/  269 batches | lr 0.00030 | ms/batch 241.27 | loss  3.39 | ppl    29.65 
| epoch  37 |   200/  269 batches | lr 0.00030 | ms/batch 242.11 | loss  3.39 | ppl    29.54 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 66.38s | valid loss  3.90 | valid ppl    49.60 | valid bpc    5.632
-----------------------------------------------------------------------------------------
PROGRESS: 37.0%
| epoch  38 |   100/  269 batches | lr 0.00030 | ms/batch 242.68 | loss  3.35 | ppl    28.48 
| epoch  38 |   200/  269 batches | lr 0.00030 | ms/batch 242.96 | loss  3.37 | ppl    29.20 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 66.41s | valid loss  3.91 | valid ppl    49.91 | valid bpc    5.641
-----------------------------------------------------------------------------------------
PROGRESS: 38.0%
| epoch  39 |   100/  269 batches | lr 0.00030 | ms/batch 239.42 | loss  3.32 | ppl    27.70 
| epoch  39 |   200/  269 batches | lr 0.00030 | ms/batch 243.26 | loss  3.32 | ppl    27.62 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 66.17s | valid loss  3.91 | valid ppl    49.65 | valid bpc    5.634
-----------------------------------------------------------------------------------------
PROGRESS: 39.0%
| epoch  40 |   100/  269 batches | lr 0.00015 | ms/batch 241.74 | loss  3.26 | ppl    25.95 
| epoch  40 |   200/  269 batches | lr 0.00015 | ms/batch 242.42 | loss  3.20 | ppl    24.60 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 66.40s | valid loss  3.80 | valid ppl    44.69 | valid bpc    5.482
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 40.0%
| epoch  41 |   100/  269 batches | lr 0.00015 | ms/batch 241.54 | loss  3.22 | ppl    24.92 
| epoch  41 |   200/  269 batches | lr 0.00015 | ms/batch 243.23 | loss  3.16 | ppl    23.53 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 66.35s | valid loss  3.82 | valid ppl    45.61 | valid bpc    5.511
-----------------------------------------------------------------------------------------
PROGRESS: 41.0%
| epoch  42 |   100/  269 batches | lr 0.00015 | ms/batch 237.30 | loss  3.17 | ppl    23.75 
| epoch  42 |   200/  269 batches | lr 0.00015 | ms/batch 242.83 | loss  3.13 | ppl    22.97 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 66.04s | valid loss  3.78 | valid ppl    43.88 | valid bpc    5.456
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 42.0%
| epoch  43 |   100/  269 batches | lr 0.00015 | ms/batch 245.05 | loss  3.12 | ppl    22.60 
| epoch  43 |   200/  269 batches | lr 0.00015 | ms/batch 243.04 | loss  3.15 | ppl    23.25 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 65.98s | valid loss  3.79 | valid ppl    44.36 | valid bpc    5.471
-----------------------------------------------------------------------------------------
PROGRESS: 43.0%
| epoch  44 |   100/  269 batches | lr 0.00015 | ms/batch 247.30 | loss  3.12 | ppl    22.74 
| epoch  44 |   200/  269 batches | lr 0.00015 | ms/batch 242.24 | loss  3.09 | ppl    21.92 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 66.26s | valid loss  3.80 | valid ppl    44.87 | valid bpc    5.488
-----------------------------------------------------------------------------------------
PROGRESS: 44.0%
| epoch  45 |   100/  269 batches | lr 0.00015 | ms/batch 251.66 | loss  3.11 | ppl    22.41 
| epoch  45 |   200/  269 batches | lr 0.00015 | ms/batch 242.51 | loss  3.07 | ppl    21.57 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 66.77s | valid loss  3.74 | valid ppl    42.20 | valid bpc    5.399
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 45.0%
| epoch  46 |   100/  269 batches | lr 0.00015 | ms/batch 250.52 | loss  3.09 | ppl    22.00 
| epoch  46 |   200/  269 batches | lr 0.00015 | ms/batch 241.73 | loss  3.04 | ppl    20.95 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 66.69s | valid loss  3.77 | valid ppl    43.52 | valid bpc    5.444
-----------------------------------------------------------------------------------------
PROGRESS: 46.0%
| epoch  47 |   100/  269 batches | lr 0.00015 | ms/batch 251.67 | loss  3.03 | ppl    20.75 
| epoch  47 |   200/  269 batches | lr 0.00015 | ms/batch 243.60 | loss  3.03 | ppl    20.63 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 66.47s | valid loss  3.74 | valid ppl    41.94 | valid bpc    5.390
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 47.0%
| epoch  48 |   100/  269 batches | lr 0.00015 | ms/batch 248.51 | loss  3.04 | ppl    20.95 
| epoch  48 |   200/  269 batches | lr 0.00015 | ms/batch 242.27 | loss  3.01 | ppl    20.37 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 66.08s | valid loss  3.77 | valid ppl    43.59 | valid bpc    5.446
-----------------------------------------------------------------------------------------
PROGRESS: 48.0%
| epoch  49 |   100/  269 batches | lr 0.00015 | ms/batch 251.41 | loss  3.00 | ppl    20.08 
| epoch  49 |   200/  269 batches | lr 0.00015 | ms/batch 239.46 | loss  3.01 | ppl    20.21 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 66.73s | valid loss  3.77 | valid ppl    43.37 | valid bpc    5.439
-----------------------------------------------------------------------------------------
PROGRESS: 49.0%
| epoch  50 |   100/  269 batches | lr 0.00015 | ms/batch 252.40 | loss  2.98 | ppl    19.69 
| epoch  50 |   200/  269 batches | lr 0.00015 | ms/batch 231.76 | loss  2.99 | ppl    19.90 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 66.44s | valid loss  3.81 | valid ppl    45.26 | valid bpc    5.500
-----------------------------------------------------------------------------------------
PROGRESS: 50.0%
| epoch  51 |   100/  269 batches | lr 0.00007 | ms/batch 250.32 | loss  2.95 | ppl    19.02 
| epoch  51 |   200/  269 batches | lr 0.00007 | ms/batch 237.76 | loss  2.93 | ppl    18.69 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 66.71s | valid loss  3.75 | valid ppl    42.58 | valid bpc    5.412
-----------------------------------------------------------------------------------------
PROGRESS: 51.0%
| epoch  52 |   100/  269 batches | lr 0.00007 | ms/batch 252.64 | loss  2.89 | ppl    18.02 
| epoch  52 |   200/  269 batches | lr 0.00007 | ms/batch 234.92 | loss  2.90 | ppl    18.26 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 66.71s | valid loss  3.75 | valid ppl    42.69 | valid bpc    5.416
-----------------------------------------------------------------------------------------
PROGRESS: 52.0%
| epoch  53 |   100/  269 batches | lr 0.00007 | ms/batch 251.26 | loss  2.91 | ppl    18.32 
| epoch  53 |   200/  269 batches | lr 0.00007 | ms/batch 237.90 | loss  2.90 | ppl    18.21 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 66.76s | valid loss  3.79 | valid ppl    44.43 | valid bpc    5.473
-----------------------------------------------------------------------------------------
PROGRESS: 53.0%
| epoch  54 |   100/  269 batches | lr 0.00004 | ms/batch 243.65 | loss  2.89 | ppl    18.00 
| epoch  54 |   200/  269 batches | lr 0.00004 | ms/batch 234.56 | loss  2.83 | ppl    16.97 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 65.82s | valid loss  3.74 | valid ppl    41.92 | valid bpc    5.390
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 54.0%
| epoch  55 |   100/  269 batches | lr 0.00004 | ms/batch 251.36 | loss  2.87 | ppl    17.63 
| epoch  55 |   200/  269 batches | lr 0.00004 | ms/batch 235.58 | loss  2.85 | ppl    17.21 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 66.55s | valid loss  3.70 | valid ppl    40.34 | valid bpc    5.334
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  269 batches | lr 0.00004 | ms/batch 257.24 | loss  2.85 | ppl    17.24 
| epoch  56 |   200/  269 batches | lr 0.00004 | ms/batch 236.56 | loss  2.85 | ppl    17.30 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 66.80s | valid loss  3.75 | valid ppl    42.38 | valid bpc    5.405
-----------------------------------------------------------------------------------------
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  269 batches | lr 0.00004 | ms/batch 256.64 | loss  2.86 | ppl    17.41 
| epoch  57 |   200/  269 batches | lr 0.00004 | ms/batch 236.06 | loss  2.83 | ppl    16.90 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 66.80s | valid loss  3.77 | valid ppl    43.52 | valid bpc    5.443
-----------------------------------------------------------------------------------------
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  269 batches | lr 0.00004 | ms/batch 251.50 | loss  2.84 | ppl    17.15 
| epoch  58 |   200/  269 batches | lr 0.00004 | ms/batch 242.52 | loss  2.81 | ppl    16.66 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 66.76s | valid loss  3.75 | valid ppl    42.52 | valid bpc    5.410
-----------------------------------------------------------------------------------------
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  269 batches | lr 0.00002 | ms/batch 250.91 | loss  2.83 | ppl    16.95 
| epoch  59 |   200/  269 batches | lr 0.00002 | ms/batch 243.40 | loss  2.82 | ppl    16.77 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 66.79s | valid loss  3.71 | valid ppl    40.98 | valid bpc    5.357
-----------------------------------------------------------------------------------------
PROGRESS: 59.0%
| epoch  60 |   100/  269 batches | lr 0.00002 | ms/batch 251.05 | loss  2.83 | ppl    16.94 
| epoch  60 |   200/  269 batches | lr 0.00002 | ms/batch 242.98 | loss  2.79 | ppl    16.36 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 66.76s | valid loss  3.74 | valid ppl    41.94 | valid bpc    5.390
-----------------------------------------------------------------------------------------
PROGRESS: 60.0%
| epoch  61 |   100/  269 batches | lr 0.00002 | ms/batch 251.90 | loss  2.81 | ppl    16.58 
| epoch  61 |   200/  269 batches | lr 0.00002 | ms/batch 242.01 | loss  2.79 | ppl    16.24 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 66.77s | valid loss  3.76 | valid ppl    42.90 | valid bpc    5.423
-----------------------------------------------------------------------------------------
PROGRESS: 61.0%
| epoch  62 |   100/  269 batches | lr 0.00001 | ms/batch 250.86 | loss  2.80 | ppl    16.46 
| epoch  62 |   200/  269 batches | lr 0.00001 | ms/batch 243.63 | loss  2.79 | ppl    16.30 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 66.78s | valid loss  3.74 | valid ppl    42.29 | valid bpc    5.402
-----------------------------------------------------------------------------------------
PROGRESS: 62.0%
| epoch  63 |   100/  269 batches | lr 0.00001 | ms/batch 252.50 | loss  2.81 | ppl    16.59 
| epoch  63 |   200/  269 batches | lr 0.00001 | ms/batch 242.55 | loss  2.77 | ppl    15.96 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 66.76s | valid loss  3.74 | valid ppl    42.31 | valid bpc    5.403
-----------------------------------------------------------------------------------------
PROGRESS: 63.0%
| epoch  64 |   100/  269 batches | lr 0.00001 | ms/batch 247.57 | loss  2.81 | ppl    16.67 
| epoch  64 |   200/  269 batches | lr 0.00001 | ms/batch 241.99 | loss  2.80 | ppl    16.39 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 66.32s | valid loss  3.75 | valid ppl    42.53 | valid bpc    5.410
-----------------------------------------------------------------------------------------
PROGRESS: 64.0%
| epoch  65 |   100/  269 batches | lr 0.00000 | ms/batch 251.18 | loss  2.80 | ppl    16.37 
| epoch  65 |   200/  269 batches | lr 0.00000 | ms/batch 242.21 | loss  2.76 | ppl    15.87 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 66.45s | valid loss  3.69 | valid ppl    40.15 | valid bpc    5.327
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 65.0%
| epoch  66 |   100/  269 batches | lr 0.00000 | ms/batch 245.45 | loss  2.82 | ppl    16.72 
| epoch  66 |   200/  269 batches | lr 0.00000 | ms/batch 243.03 | loss  2.78 | ppl    16.06 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 65.63s | valid loss  3.77 | valid ppl    43.31 | valid bpc    5.437
-----------------------------------------------------------------------------------------
PROGRESS: 66.0%
| epoch  67 |   100/  269 batches | lr 0.00000 | ms/batch 255.15 | loss  2.79 | ppl    16.34 
| epoch  67 |   200/  269 batches | lr 0.00000 | ms/batch 241.96 | loss  2.77 | ppl    16.02 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 66.49s | valid loss  3.72 | valid ppl    41.15 | valid bpc    5.363
-----------------------------------------------------------------------------------------
PROGRESS: 67.0%
| epoch  68 |   100/  269 batches | lr 0.00000 | ms/batch 258.55 | loss  2.79 | ppl    16.33 
| epoch  68 |   200/  269 batches | lr 0.00000 | ms/batch 241.18 | loss  2.78 | ppl    16.08 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 66.67s | valid loss  3.74 | valid ppl    42.07 | valid bpc    5.395
-----------------------------------------------------------------------------------------
PROGRESS: 68.0%
| epoch  69 |   100/  269 batches | lr 0.00000 | ms/batch 257.10 | loss  2.79 | ppl    16.21 
| epoch  69 |   200/  269 batches | lr 0.00000 | ms/batch 242.17 | loss  2.76 | ppl    15.77 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 66.69s | valid loss  3.68 | valid ppl    39.46 | valid bpc    5.302
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 69.0%
| epoch  70 |   100/  269 batches | lr 0.00000 | ms/batch 257.11 | loss  2.78 | ppl    16.18 
| epoch  70 |   200/  269 batches | lr 0.00000 | ms/batch 241.22 | loss  2.76 | ppl    15.74 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 66.25s | valid loss  3.68 | valid ppl    39.75 | valid bpc    5.313
-----------------------------------------------------------------------------------------
PROGRESS: 70.0%
| epoch  71 |   100/  269 batches | lr 0.00000 | ms/batch 256.95 | loss  2.79 | ppl    16.26 
| epoch  71 |   200/  269 batches | lr 0.00000 | ms/batch 243.33 | loss  2.77 | ppl    15.92 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 66.74s | valid loss  3.71 | valid ppl    40.87 | valid bpc    5.353
-----------------------------------------------------------------------------------------
PROGRESS: 71.0%
| epoch  72 |   100/  269 batches | lr 0.00000 | ms/batch 258.69 | loss  2.80 | ppl    16.46 
| epoch  72 |   200/  269 batches | lr 0.00000 | ms/batch 238.17 | loss  2.77 | ppl    15.91 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 66.77s | valid loss  3.70 | valid ppl    40.51 | valid bpc    5.340
-----------------------------------------------------------------------------------------
PROGRESS: 72.0%
| epoch  73 |   100/  269 batches | lr 0.00000 | ms/batch 257.53 | loss  2.78 | ppl    16.18 
| epoch  73 |   200/  269 batches | lr 0.00000 | ms/batch 234.00 | loss  2.77 | ppl    15.96 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 66.69s | valid loss  3.73 | valid ppl    41.87 | valid bpc    5.388
-----------------------------------------------------------------------------------------
PROGRESS: 73.0%
| epoch  74 |   100/  269 batches | lr 0.00000 | ms/batch 256.75 | loss  2.79 | ppl    16.27 
| epoch  74 |   200/  269 batches | lr 0.00000 | ms/batch 237.11 | loss  2.79 | ppl    16.20 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 66.75s | valid loss  3.71 | valid ppl    40.91 | valid bpc    5.354
-----------------------------------------------------------------------------------------
PROGRESS: 74.0%
| epoch  75 |   100/  269 batches | lr 0.00000 | ms/batch 256.94 | loss  2.79 | ppl    16.33 
| epoch  75 |   200/  269 batches | lr 0.00000 | ms/batch 236.96 | loss  2.76 | ppl    15.81 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 66.84s | valid loss  3.71 | valid ppl    40.90 | valid bpc    5.354
-----------------------------------------------------------------------------------------
PROGRESS: 75.0%
| epoch  76 |   100/  269 batches | lr 0.00000 | ms/batch 256.40 | loss  2.78 | ppl    16.18 
| epoch  76 |   200/  269 batches | lr 0.00000 | ms/batch 237.03 | loss  2.78 | ppl    16.07 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 66.73s | valid loss  3.69 | valid ppl    40.15 | valid bpc    5.327
-----------------------------------------------------------------------------------------
PROGRESS: 76.0%
| epoch  77 |   100/  269 batches | lr 0.00000 | ms/batch 255.88 | loss  2.79 | ppl    16.24 
| epoch  77 |   200/  269 batches | lr 0.00000 | ms/batch 236.02 | loss  2.75 | ppl    15.71 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 66.77s | valid loss  3.76 | valid ppl    42.85 | valid bpc    5.421
-----------------------------------------------------------------------------------------
PROGRESS: 77.0%
| epoch  78 |   100/  269 batches | lr 0.00000 | ms/batch 256.87 | loss  2.76 | ppl    15.85 
| epoch  78 |   200/  269 batches | lr 0.00000 | ms/batch 232.37 | loss  2.78 | ppl    16.16 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 66.71s | valid loss  3.70 | valid ppl    40.61 | valid bpc    5.344
-----------------------------------------------------------------------------------------
PROGRESS: 78.0%
| epoch  79 |   100/  269 batches | lr 0.00000 | ms/batch 256.85 | loss  2.79 | ppl    16.23 
| epoch  79 |   200/  269 batches | lr 0.00000 | ms/batch 230.44 | loss  2.76 | ppl    15.77 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 66.71s | valid loss  3.71 | valid ppl    40.79 | valid bpc    5.350
-----------------------------------------------------------------------------------------
PROGRESS: 79.0%
| epoch  80 |   100/  269 batches | lr 0.00000 | ms/batch 255.21 | loss  2.80 | ppl    16.39 
| epoch  80 |   200/  269 batches | lr 0.00000 | ms/batch 231.80 | loss  2.77 | ppl    15.93 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 66.74s | valid loss  3.78 | valid ppl    43.65 | valid bpc    5.448
-----------------------------------------------------------------------------------------
PROGRESS: 80.0%
| epoch  81 |   100/  269 batches | lr 0.00000 | ms/batch 251.64 | loss  2.81 | ppl    16.63 
| epoch  81 |   200/  269 batches | lr 0.00000 | ms/batch 235.71 | loss  2.76 | ppl    15.75 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 66.68s | valid loss  3.71 | valid ppl    41.01 | valid bpc    5.358
-----------------------------------------------------------------------------------------
PROGRESS: 81.0%
| epoch  82 |   100/  269 batches | lr 0.00000 | ms/batch 247.37 | loss  2.79 | ppl    16.22 
| epoch  82 |   200/  269 batches | lr 0.00000 | ms/batch 237.19 | loss  2.78 | ppl    16.06 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 66.34s | valid loss  3.72 | valid ppl    41.34 | valid bpc    5.369
-----------------------------------------------------------------------------------------
PROGRESS: 82.0%
| epoch  83 |   100/  269 batches | lr 0.00000 | ms/batch 251.70 | loss  2.77 | ppl    16.01 
| epoch  83 |   200/  269 batches | lr 0.00000 | ms/batch 235.60 | loss  2.76 | ppl    15.87 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 66.74s | valid loss  3.71 | valid ppl    40.85 | valid bpc    5.352
-----------------------------------------------------------------------------------------
PROGRESS: 83.0%
| epoch  84 |   100/  269 batches | lr 0.00000 | ms/batch 250.70 | loss  2.79 | ppl    16.22 
| epoch  84 |   200/  269 batches | lr 0.00000 | ms/batch 237.30 | loss  2.76 | ppl    15.81 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 66.83s | valid loss  3.77 | valid ppl    43.40 | valid bpc    5.439
-----------------------------------------------------------------------------------------
PROGRESS: 84.0%
| epoch  85 |   100/  269 batches | lr 0.00000 | ms/batch 252.62 | loss  2.77 | ppl    16.02 
| epoch  85 |   200/  269 batches | lr 0.00000 | ms/batch 237.01 | loss  2.74 | ppl    15.52 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 66.80s | valid loss  3.72 | valid ppl    41.24 | valid bpc    5.366
-----------------------------------------------------------------------------------------
PROGRESS: 85.0%
| epoch  86 |   100/  269 batches | lr 0.00000 | ms/batch 251.80 | loss  2.78 | ppl    16.09 
| epoch  86 |   200/  269 batches | lr 0.00000 | ms/batch 236.26 | loss  2.75 | ppl    15.68 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 66.74s | valid loss  3.70 | valid ppl    40.60 | valid bpc    5.343
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  269 batches | lr 0.00000 | ms/batch 247.68 | loss  2.79 | ppl    16.22 
| epoch  87 |   200/  269 batches | lr 0.00000 | ms/batch 236.00 | loss  2.77 | ppl    15.98 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 66.35s | valid loss  3.74 | valid ppl    41.96 | valid bpc    5.391
-----------------------------------------------------------------------------------------
PROGRESS: 87.0%
| epoch  88 |   100/  269 batches | lr 0.00000 | ms/batch 250.25 | loss  2.78 | ppl    16.16 
| epoch  88 |   200/  269 batches | lr 0.00000 | ms/batch 237.75 | loss  2.76 | ppl    15.73 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 66.77s | valid loss  3.76 | valid ppl    43.01 | valid bpc    5.427
-----------------------------------------------------------------------------------------
PROGRESS: 88.0%
| epoch  89 |   100/  269 batches | lr 0.00000 | ms/batch 249.64 | loss  2.79 | ppl    16.29 
| epoch  89 |   200/  269 batches | lr 0.00000 | ms/batch 236.29 | loss  2.80 | ppl    16.43 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 66.55s | valid loss  3.70 | valid ppl    40.33 | valid bpc    5.334
-----------------------------------------------------------------------------------------
PROGRESS: 89.0%
| epoch  90 |   100/  269 batches | lr 0.00000 | ms/batch 250.89 | loss  2.78 | ppl    16.15 
| epoch  90 |   200/  269 batches | lr 0.00000 | ms/batch 236.03 | loss  2.74 | ppl    15.51 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 66.23s | valid loss  3.76 | valid ppl    42.81 | valid bpc    5.420
-----------------------------------------------------------------------------------------
PROGRESS: 90.0%
| epoch  91 |   100/  269 batches | lr 0.00000 | ms/batch 257.05 | loss  2.79 | ppl    16.28 
| epoch  91 |   200/  269 batches | lr 0.00000 | ms/batch 237.77 | loss  2.77 | ppl    15.93 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 66.45s | valid loss  3.72 | valid ppl    41.22 | valid bpc    5.365
-----------------------------------------------------------------------------------------
PROGRESS: 91.0%
| epoch  92 |   100/  269 batches | lr 0.00000 | ms/batch 255.82 | loss  2.79 | ppl    16.25 
| epoch  92 |   200/  269 batches | lr 0.00000 | ms/batch 235.68 | loss  2.78 | ppl    16.11 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 66.61s | valid loss  3.72 | valid ppl    41.43 | valid bpc    5.373
-----------------------------------------------------------------------------------------
PROGRESS: 92.0%
| epoch  93 |   100/  269 batches | lr 0.00000 | ms/batch 257.53 | loss  2.79 | ppl    16.34 
| epoch  93 |   200/  269 batches | lr 0.00000 | ms/batch 236.18 | loss  2.75 | ppl    15.61 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 66.71s | valid loss  3.72 | valid ppl    41.23 | valid bpc    5.366
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  269 batches | lr 0.00000 | ms/batch 256.74 | loss  2.80 | ppl    16.38 
| epoch  94 |   200/  269 batches | lr 0.00000 | ms/batch 236.95 | loss  2.75 | ppl    15.68 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 66.70s | valid loss  3.73 | valid ppl    41.69 | valid bpc    5.382
-----------------------------------------------------------------------------------------
PROGRESS: 94.0%
| epoch  95 |   100/  269 batches | lr 0.00000 | ms/batch 257.38 | loss  2.80 | ppl    16.45 
| epoch  95 |   200/  269 batches | lr 0.00000 | ms/batch 236.31 | loss  2.74 | ppl    15.53 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 66.78s | valid loss  3.73 | valid ppl    41.75 | valid bpc    5.384
-----------------------------------------------------------------------------------------
PROGRESS: 95.0%
| epoch  96 |   100/  269 batches | lr 0.00000 | ms/batch 257.02 | loss  2.79 | ppl    16.25 
| epoch  96 |   200/  269 batches | lr 0.00000 | ms/batch 231.99 | loss  2.77 | ppl    15.89 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 66.81s | valid loss  3.75 | valid ppl    42.67 | valid bpc    5.415
-----------------------------------------------------------------------------------------
PROGRESS: 96.0%
| epoch  97 |   100/  269 batches | lr 0.00000 | ms/batch 256.48 | loss  2.81 | ppl    16.62 
| epoch  97 |   200/  269 batches | lr 0.00000 | ms/batch 230.88 | loss  2.77 | ppl    16.00 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 66.72s | valid loss  3.73 | valid ppl    41.71 | valid bpc    5.382
-----------------------------------------------------------------------------------------
PROGRESS: 97.0%
| epoch  98 |   100/  269 batches | lr 0.00000 | ms/batch 257.10 | loss  2.79 | ppl    16.28 
| epoch  98 |   200/  269 batches | lr 0.00000 | ms/batch 230.55 | loss  2.75 | ppl    15.62 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 66.74s | valid loss  3.74 | valid ppl    42.02 | valid bpc    5.393
-----------------------------------------------------------------------------------------
PROGRESS: 98.0%
| epoch  99 |   100/  269 batches | lr 0.00000 | ms/batch 257.55 | loss  2.78 | ppl    16.08 
| epoch  99 |   200/  269 batches | lr 0.00000 | ms/batch 209.47 | loss  2.77 | ppl    15.99 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 59.55s | valid loss  3.70 | valid ppl    40.36 | valid bpc    5.335
-----------------------------------------------------------------------------------------
PROGRESS: 99.0%
| epoch 100 |   100/  269 batches | lr 0.00000 | ms/batch 180.62 | loss  2.78 | ppl    16.05 
| epoch 100 |   200/  269 batches | lr 0.00000 | ms/batch 165.28 | loss  2.74 | ppl    15.52 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 47.35s | valid loss  3.75 | valid ppl    42.32 | valid bpc    5.403
-----------------------------------------------------------------------------------------
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  3.82 | test ppl    45.61 | test bpc    5.511
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.4653, Mean Reca: 0.6523, Mean F1: 0.5392, Mean Subword_Reca: 0.7907
-----------------------------------------------------------------------------------------
=========================================================================================
Loading dataset...
Using subword tokenizer...
Number of tokens:  8000
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer_in_parser', nhid=512, nlayers=8, front_layers=2, rear_layers=6, subword='omarmomen/ptb_filtered_lowcase_bpe_tokenizer_8', n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=2222, nonmono=5, cuda=True, log_interval=100, save='trained_models/subword_structformer_in_parser_2222_26.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 37449124
Model architecture: StructFormer_In_Parser(
  (transformer_front): Transformer_Front(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(8000, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-1): 2 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
  (transformer_rear): Transformer_Rear(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(8000, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-5): 6 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (output_layer): Linear(in_features=512, out_features=8000, bias=True)
  )
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  269 batches | lr 0.00030 | ms/batch 175.03 | loss  7.72 | ppl  2245.70 
| epoch   1 |   200/  269 batches | lr 0.00030 | ms/batch 171.91 | loss  7.35 | ppl  1549.14 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 47.46s | valid loss  7.07 | valid ppl  1170.71 | valid bpc   10.193
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  269 batches | lr 0.00030 | ms/batch 166.57 | loss  7.26 | ppl  1424.62 
| epoch   2 |   200/  269 batches | lr 0.00030 | ms/batch 161.51 | loss  7.09 | ppl  1196.89 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 44.72s | valid loss  6.63 | valid ppl   755.62 | valid bpc    9.562
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  269 batches | lr 0.00030 | ms/batch 190.90 | loss  6.70 | ppl   813.24 
| epoch   3 |   200/  269 batches | lr 0.00030 | ms/batch 241.76 | loss  6.39 | ppl   598.13 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 61.23s | valid loss  5.89 | valid ppl   360.19 | valid bpc    8.493
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  269 batches | lr 0.00030 | ms/batch 234.66 | loss  6.06 | ppl   426.84 
| epoch   4 |   200/  269 batches | lr 0.00030 | ms/batch 243.09 | loss  5.93 | ppl   376.50 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 65.52s | valid loss  5.60 | valid ppl   270.62 | valid bpc    8.080
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  269 batches | lr 0.00030 | ms/batch 246.86 | loss  5.77 | ppl   321.71 
| epoch   5 |   200/  269 batches | lr 0.00030 | ms/batch 242.79 | loss  5.64 | ppl   281.45 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 65.98s | valid loss  5.38 | valid ppl   217.67 | valid bpc    7.766
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  269 batches | lr 0.00030 | ms/batch 248.90 | loss  5.56 | ppl   260.80 
| epoch   6 |   200/  269 batches | lr 0.00030 | ms/batch 240.83 | loss  5.43 | ppl   227.61 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 66.08s | valid loss  5.23 | valid ppl   187.36 | valid bpc    7.550
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  269 batches | lr 0.00030 | ms/batch 247.17 | loss  5.36 | ppl   213.17 
| epoch   7 |   200/  269 batches | lr 0.00030 | ms/batch 242.09 | loss  5.28 | ppl   197.20 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 65.97s | valid loss  5.00 | valid ppl   149.02 | valid bpc    7.219
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  269 batches | lr 0.00030 | ms/batch 247.69 | loss  5.26 | ppl   192.34 
| epoch   8 |   200/  269 batches | lr 0.00030 | ms/batch 241.85 | loss  5.10 | ppl   163.71 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 65.99s | valid loss  4.98 | valid ppl   145.01 | valid bpc    7.180
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 8.0%
| epoch   9 |   100/  269 batches | lr 0.00030 | ms/batch 248.24 | loss  5.08 | ppl   160.12 
| epoch   9 |   200/  269 batches | lr 0.00030 | ms/batch 242.97 | loss  5.00 | ppl   149.05 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 65.98s | valid loss  4.80 | valid ppl   121.03 | valid bpc    6.919
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  269 batches | lr 0.00030 | ms/batch 247.73 | loss  4.96 | ppl   142.80 
| epoch  10 |   200/  269 batches | lr 0.00030 | ms/batch 238.32 | loss  4.90 | ppl   134.08 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 66.01s | valid loss  4.77 | valid ppl   117.61 | valid bpc    6.878
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  269 batches | lr 0.00030 | ms/batch 248.05 | loss  4.84 | ppl   125.90 
| epoch  11 |   200/  269 batches | lr 0.00030 | ms/batch 233.04 | loss  4.82 | ppl   123.39 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 66.01s | valid loss  4.61 | valid ppl   100.45 | valid bpc    6.650
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  269 batches | lr 0.00030 | ms/batch 248.29 | loss  4.79 | ppl   119.79 
| epoch  12 |   200/  269 batches | lr 0.00030 | ms/batch 232.55 | loss  4.65 | ppl   104.50 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 66.03s | valid loss  4.58 | valid ppl    97.31 | valid bpc    6.604
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 12.0%
| epoch  13 |   100/  269 batches | lr 0.00030 | ms/batch 247.55 | loss  4.65 | ppl   104.87 
| epoch  13 |   200/  269 batches | lr 0.00030 | ms/batch 232.34 | loss  4.55 | ppl    94.93 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 65.95s | valid loss  4.52 | valid ppl    91.49 | valid bpc    6.516
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 13.0%
| epoch  14 |   100/  269 batches | lr 0.00030 | ms/batch 246.64 | loss  4.54 | ppl    94.07 
| epoch  14 |   200/  269 batches | lr 0.00030 | ms/batch 232.90 | loss  4.48 | ppl    88.65 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 65.95s | valid loss  4.43 | valid ppl    83.93 | valid bpc    6.391
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  269 batches | lr 0.00030 | ms/batch 246.66 | loss  4.44 | ppl    84.83 
| epoch  15 |   200/  269 batches | lr 0.00030 | ms/batch 233.39 | loss  4.41 | ppl    81.93 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 66.02s | valid loss  4.34 | valid ppl    76.34 | valid bpc    6.254
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 15.0%
| epoch  16 |   100/  269 batches | lr 0.00030 | ms/batch 249.18 | loss  4.37 | ppl    78.78 
| epoch  16 |   200/  269 batches | lr 0.00030 | ms/batch 235.68 | loss  4.32 | ppl    75.01 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 66.41s | valid loss  4.34 | valid ppl    77.02 | valid bpc    6.267
-----------------------------------------------------------------------------------------
PROGRESS: 16.0%
| epoch  17 |   100/  269 batches | lr 0.00030 | ms/batch 246.70 | loss  4.28 | ppl    72.47 
| epoch  17 |   200/  269 batches | lr 0.00030 | ms/batch 233.01 | loss  4.24 | ppl    69.11 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 66.03s | valid loss  4.25 | valid ppl    70.00 | valid bpc    6.129
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 17.0%
| epoch  18 |   100/  269 batches | lr 0.00030 | ms/batch 248.84 | loss  4.20 | ppl    66.88 
| epoch  18 |   200/  269 batches | lr 0.00030 | ms/batch 232.45 | loss  4.18 | ppl    65.33 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 66.01s | valid loss  4.17 | valid ppl    64.81 | valid bpc    6.018
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 18.0%
| epoch  19 |   100/  269 batches | lr 0.00030 | ms/batch 239.43 | loss  4.15 | ppl    63.28 
| epoch  19 |   200/  269 batches | lr 0.00030 | ms/batch 239.94 | loss  4.11 | ppl    60.83 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 65.87s | valid loss  4.14 | valid ppl    62.99 | valid bpc    5.977
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 19.0%
| epoch  20 |   100/  269 batches | lr 0.00030 | ms/batch 236.66 | loss  4.08 | ppl    59.12 
| epoch  20 |   200/  269 batches | lr 0.00030 | ms/batch 243.06 | loss  4.06 | ppl    58.22 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 65.81s | valid loss  4.17 | valid ppl    64.80 | valid bpc    6.018
-----------------------------------------------------------------------------------------
PROGRESS: 20.0%
| epoch  21 |   100/  269 batches | lr 0.00030 | ms/batch 239.87 | loss  4.03 | ppl    56.09 
| epoch  21 |   200/  269 batches | lr 0.00030 | ms/batch 243.30 | loss  3.99 | ppl    54.12 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 66.36s | valid loss  4.07 | valid ppl    58.75 | valid bpc    5.877
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 21.0%
| epoch  22 |   100/  269 batches | lr 0.00030 | ms/batch 235.79 | loss  3.95 | ppl    52.11 
| epoch  22 |   200/  269 batches | lr 0.00030 | ms/batch 243.59 | loss  3.90 | ppl    49.38 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 65.90s | valid loss  4.09 | valid ppl    59.63 | valid bpc    5.898
-----------------------------------------------------------------------------------------
PROGRESS: 22.0%
| epoch  23 |   100/  269 batches | lr 0.00030 | ms/batch 240.10 | loss  3.90 | ppl    49.17 
| epoch  23 |   200/  269 batches | lr 0.00030 | ms/batch 242.33 | loss  3.87 | ppl    47.96 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 66.18s | valid loss  4.10 | valid ppl    60.28 | valid bpc    5.914
-----------------------------------------------------------------------------------------
PROGRESS: 23.0%
| epoch  24 |   100/  269 batches | lr 0.00030 | ms/batch 238.02 | loss  3.85 | ppl    47.13 
| epoch  24 |   200/  269 batches | lr 0.00030 | ms/batch 241.99 | loss  3.83 | ppl    46.05 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 65.95s | valid loss  4.01 | valid ppl    54.91 | valid bpc    5.779
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 24.0%
| epoch  25 |   100/  269 batches | lr 0.00030 | ms/batch 240.94 | loss  3.79 | ppl    44.37 
| epoch  25 |   200/  269 batches | lr 0.00030 | ms/batch 241.23 | loss  3.77 | ppl    43.57 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 66.26s | valid loss  3.99 | valid ppl    54.10 | valid bpc    5.758
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 25.0%
| epoch  26 |   100/  269 batches | lr 0.00030 | ms/batch 238.55 | loss  3.76 | ppl    42.82 
| epoch  26 |   200/  269 batches | lr 0.00030 | ms/batch 241.81 | loss  3.72 | ppl    41.27 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 65.95s | valid loss  3.96 | valid ppl    52.64 | valid bpc    5.718
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 26.0%
| epoch  27 |   100/  269 batches | lr 0.00030 | ms/batch 243.89 | loss  3.70 | ppl    40.53 
| epoch  27 |   200/  269 batches | lr 0.00030 | ms/batch 242.58 | loss  3.68 | ppl    39.45 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 66.46s | valid loss  3.95 | valid ppl    52.12 | valid bpc    5.704
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 27.0%
| epoch  28 |   100/  269 batches | lr 0.00030 | ms/batch 253.29 | loss  3.66 | ppl    38.90 
| epoch  28 |   200/  269 batches | lr 0.00030 | ms/batch 242.26 | loss  3.63 | ppl    37.56 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 66.15s | valid loss  3.94 | valid ppl    51.39 | valid bpc    5.683
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  269 batches | lr 0.00030 | ms/batch 256.38 | loss  3.59 | ppl    36.34 
| epoch  29 |   200/  269 batches | lr 0.00030 | ms/batch 242.74 | loss  3.60 | ppl    36.58 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 66.39s | valid loss  3.93 | valid ppl    51.16 | valid bpc    5.677
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  269 batches | lr 0.00030 | ms/batch 256.27 | loss  3.58 | ppl    35.85 
| epoch  30 |   200/  269 batches | lr 0.00030 | ms/batch 242.46 | loss  3.52 | ppl    33.91 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 66.32s | valid loss  3.91 | valid ppl    49.93 | valid bpc    5.642
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 30.0%
| epoch  31 |   100/  269 batches | lr 0.00030 | ms/batch 256.64 | loss  3.53 | ppl    34.04 
| epoch  31 |   200/  269 batches | lr 0.00030 | ms/batch 242.28 | loss  3.52 | ppl    33.73 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 66.64s | valid loss  3.91 | valid ppl    50.07 | valid bpc    5.646
-----------------------------------------------------------------------------------------
PROGRESS: 31.0%
| epoch  32 |   100/  269 batches | lr 0.00030 | ms/batch 256.63 | loss  3.49 | ppl    32.84 
| epoch  32 |   200/  269 batches | lr 0.00030 | ms/batch 237.24 | loss  3.48 | ppl    32.45 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 66.37s | valid loss  3.93 | valid ppl    50.66 | valid bpc    5.663
-----------------------------------------------------------------------------------------
PROGRESS: 32.0%
| epoch  33 |   100/  269 batches | lr 0.00030 | ms/batch 255.91 | loss  3.45 | ppl    31.51 
| epoch  33 |   200/  269 batches | lr 0.00030 | ms/batch 236.98 | loss  3.46 | ppl    31.84 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 66.34s | valid loss  3.90 | valid ppl    49.28 | valid bpc    5.623
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 33.0%
| epoch  34 |   100/  269 batches | lr 0.00030 | ms/batch 256.72 | loss  3.40 | ppl    29.84 
| epoch  34 |   200/  269 batches | lr 0.00030 | ms/batch 232.55 | loss  3.44 | ppl    31.30 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 65.96s | valid loss  3.84 | valid ppl    46.62 | valid bpc    5.543
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 34.0%
| epoch  35 |   100/  269 batches | lr 0.00030 | ms/batch 258.02 | loss  3.40 | ppl    30.10 
| epoch  35 |   200/  269 batches | lr 0.00030 | ms/batch 235.87 | loss  3.38 | ppl    29.43 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 66.74s | valid loss  3.87 | valid ppl    47.92 | valid bpc    5.582
-----------------------------------------------------------------------------------------
PROGRESS: 35.0%
| epoch  36 |   100/  269 batches | lr 0.00030 | ms/batch 256.21 | loss  3.35 | ppl    28.42 
| epoch  36 |   200/  269 batches | lr 0.00030 | ms/batch 237.41 | loss  3.35 | ppl    28.45 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 66.69s | valid loss  3.85 | valid ppl    46.90 | valid bpc    5.552
-----------------------------------------------------------------------------------------
PROGRESS: 36.0%
| epoch  37 |   100/  269 batches | lr 0.00030 | ms/batch 256.70 | loss  3.32 | ppl    27.57 
| epoch  37 |   200/  269 batches | lr 0.00030 | ms/batch 237.20 | loss  3.32 | ppl    27.60 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 66.73s | valid loss  3.86 | valid ppl    47.31 | valid bpc    5.564
-----------------------------------------------------------------------------------------
PROGRESS: 37.0%
| epoch  38 |   100/  269 batches | lr 0.00015 | ms/batch 257.33 | loss  3.24 | ppl    25.55 
| epoch  38 |   200/  269 batches | lr 0.00015 | ms/batch 232.79 | loss  3.21 | ppl    24.74 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 66.30s | valid loss  3.80 | valid ppl    44.86 | valid bpc    5.487
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 38.0%
| epoch  39 |   100/  269 batches | lr 0.00015 | ms/batch 256.88 | loss  3.16 | ppl    23.47 
| epoch  39 |   200/  269 batches | lr 0.00015 | ms/batch 235.66 | loss  3.17 | ppl    23.76 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 66.39s | valid loss  3.83 | valid ppl    46.10 | valid bpc    5.527
-----------------------------------------------------------------------------------------
PROGRESS: 39.0%
| epoch  40 |   100/  269 batches | lr 0.00015 | ms/batch 256.14 | loss  3.13 | ppl    22.93 
| epoch  40 |   200/  269 batches | lr 0.00015 | ms/batch 236.21 | loss  3.14 | ppl    23.13 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 66.32s | valid loss  3.78 | valid ppl    43.63 | valid bpc    5.447
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 40.0%
| epoch  41 |   100/  269 batches | lr 0.00015 | ms/batch 246.89 | loss  3.13 | ppl    22.80 
| epoch  41 |   200/  269 batches | lr 0.00015 | ms/batch 242.05 | loss  3.11 | ppl    22.38 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 66.31s | valid loss  3.79 | valid ppl    44.37 | valid bpc    5.472
-----------------------------------------------------------------------------------------
PROGRESS: 41.0%
| epoch  42 |   100/  269 batches | lr 0.00015 | ms/batch 247.26 | loss  3.08 | ppl    21.66 
| epoch  42 |   200/  269 batches | lr 0.00015 | ms/batch 241.45 | loss  3.08 | ppl    21.68 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 66.39s | valid loss  3.76 | valid ppl    42.79 | valid bpc    5.419
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 42.0%
| epoch  43 |   100/  269 batches | lr 0.00015 | ms/batch 247.70 | loss  3.07 | ppl    21.53 
| epoch  43 |   200/  269 batches | lr 0.00015 | ms/batch 242.15 | loss  3.09 | ppl    21.91 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 65.97s | valid loss  3.78 | valid ppl    43.89 | valid bpc    5.456
-----------------------------------------------------------------------------------------
PROGRESS: 43.0%
| epoch  44 |   100/  269 batches | lr 0.00015 | ms/batch 250.89 | loss  3.05 | ppl    21.03 
| epoch  44 |   200/  269 batches | lr 0.00015 | ms/batch 242.10 | loss  3.03 | ppl    20.69 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 66.75s | valid loss  3.74 | valid ppl    42.21 | valid bpc    5.400
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 44.0%
| epoch  45 |   100/  269 batches | lr 0.00015 | ms/batch 246.46 | loss  3.04 | ppl    20.85 
| epoch  45 |   200/  269 batches | lr 0.00015 | ms/batch 243.16 | loss  3.02 | ppl    20.40 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 65.95s | valid loss  3.77 | valid ppl    43.43 | valid bpc    5.441
-----------------------------------------------------------------------------------------
PROGRESS: 45.0%
| epoch  46 |   100/  269 batches | lr 0.00015 | ms/batch 250.60 | loss  3.01 | ppl    20.27 
| epoch  46 |   200/  269 batches | lr 0.00015 | ms/batch 242.38 | loss  3.01 | ppl    20.34 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 66.68s | valid loss  3.81 | valid ppl    45.17 | valid bpc    5.497
-----------------------------------------------------------------------------------------
PROGRESS: 46.0%
| epoch  47 |   100/  269 batches | lr 0.00015 | ms/batch 251.86 | loss  3.00 | ppl    20.11 
| epoch  47 |   200/  269 batches | lr 0.00015 | ms/batch 241.96 | loss  2.97 | ppl    19.44 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 66.73s | valid loss  3.80 | valid ppl    44.87 | valid bpc    5.488
-----------------------------------------------------------------------------------------
PROGRESS: 47.0%
| epoch  48 |   100/  269 batches | lr 0.00007 | ms/batch 250.10 | loss  2.94 | ppl    18.92 
| epoch  48 |   200/  269 batches | lr 0.00007 | ms/batch 241.40 | loss  2.92 | ppl    18.57 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 66.77s | valid loss  3.77 | valid ppl    43.28 | valid bpc    5.436
-----------------------------------------------------------------------------------------
PROGRESS: 48.0%
| epoch  49 |   100/  269 batches | lr 0.00007 | ms/batch 246.68 | loss  2.91 | ppl    18.35 
| epoch  49 |   200/  269 batches | lr 0.00007 | ms/batch 238.55 | loss  2.90 | ppl    18.16 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 66.34s | valid loss  3.77 | valid ppl    43.35 | valid bpc    5.438
-----------------------------------------------------------------------------------------
PROGRESS: 49.0%
| epoch  50 |   100/  269 batches | lr 0.00007 | ms/batch 250.08 | loss  2.90 | ppl    18.25 
| epoch  50 |   200/  269 batches | lr 0.00007 | ms/batch 236.95 | loss  2.87 | ppl    17.68 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 66.07s | valid loss  3.71 | valid ppl    40.74 | valid bpc    5.349
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 50.0%
| epoch  51 |   100/  269 batches | lr 0.00007 | ms/batch 257.53 | loss  2.87 | ppl    17.67 
| epoch  51 |   200/  269 batches | lr 0.00007 | ms/batch 235.85 | loss  2.88 | ppl    17.86 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 66.67s | valid loss  3.76 | valid ppl    43.16 | valid bpc    5.432
-----------------------------------------------------------------------------------------
PROGRESS: 51.0%
| epoch  52 |   100/  269 batches | lr 0.00007 | ms/batch 257.12 | loss  2.87 | ppl    17.60 
| epoch  52 |   200/  269 batches | lr 0.00007 | ms/batch 236.06 | loss  2.85 | ppl    17.36 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 66.28s | valid loss  3.82 | valid ppl    45.79 | valid bpc    5.517
-----------------------------------------------------------------------------------------
PROGRESS: 52.0%
| epoch  53 |   100/  269 batches | lr 0.00007 | ms/batch 256.44 | loss  2.87 | ppl    17.58 
| epoch  53 |   200/  269 batches | lr 0.00007 | ms/batch 238.35 | loss  2.84 | ppl    17.07 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 66.38s | valid loss  3.77 | valid ppl    43.48 | valid bpc    5.442
-----------------------------------------------------------------------------------------
PROGRESS: 53.0%
| epoch  54 |   100/  269 batches | lr 0.00004 | ms/batch 256.02 | loss  2.83 | ppl    17.00 
| epoch  54 |   200/  269 batches | lr 0.00004 | ms/batch 237.55 | loss  2.84 | ppl    17.04 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 66.73s | valid loss  3.69 | valid ppl    39.88 | valid bpc    5.318
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 54.0%
| epoch  55 |   100/  269 batches | lr 0.00004 | ms/batch 256.38 | loss  2.81 | ppl    16.68 
| epoch  55 |   200/  269 batches | lr 0.00004 | ms/batch 236.45 | loss  2.80 | ppl    16.45 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 66.64s | valid loss  3.74 | valid ppl    42.01 | valid bpc    5.393
-----------------------------------------------------------------------------------------
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  269 batches | lr 0.00004 | ms/batch 257.02 | loss  2.80 | ppl    16.45 
| epoch  56 |   200/  269 batches | lr 0.00004 | ms/batch 230.80 | loss  2.77 | ppl    16.03 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 66.75s | valid loss  3.71 | valid ppl    40.79 | valid bpc    5.350
-----------------------------------------------------------------------------------------
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  269 batches | lr 0.00004 | ms/batch 257.22 | loss  2.81 | ppl    16.68 
| epoch  57 |   200/  269 batches | lr 0.00004 | ms/batch 230.30 | loss  2.77 | ppl    15.94 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 66.74s | valid loss  3.72 | valid ppl    41.18 | valid bpc    5.364
-----------------------------------------------------------------------------------------
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  269 batches | lr 0.00002 | ms/batch 255.99 | loss  2.80 | ppl    16.49 
| epoch  58 |   200/  269 batches | lr 0.00002 | ms/batch 224.07 | loss  2.77 | ppl    15.94 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 65.95s | valid loss  3.71 | valid ppl    40.76 | valid bpc    5.349
-----------------------------------------------------------------------------------------
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  269 batches | lr 0.00002 | ms/batch 256.78 | loss  2.79 | ppl    16.32 
| epoch  59 |   200/  269 batches | lr 0.00002 | ms/batch 231.10 | loss  2.78 | ppl    16.10 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 66.74s | valid loss  3.73 | valid ppl    41.85 | valid bpc    5.387
-----------------------------------------------------------------------------------------
PROGRESS: 59.0%
| epoch  60 |   100/  269 batches | lr 0.00002 | ms/batch 257.39 | loss  2.78 | ppl    16.16 
| epoch  60 |   200/  269 batches | lr 0.00002 | ms/batch 231.06 | loss  2.77 | ppl    15.92 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 66.68s | valid loss  3.76 | valid ppl    43.04 | valid bpc    5.427
-----------------------------------------------------------------------------------------
PROGRESS: 60.0%
| epoch  61 |   100/  269 batches | lr 0.00001 | ms/batch 257.39 | loss  2.78 | ppl    16.10 
| epoch  61 |   200/  269 batches | lr 0.00001 | ms/batch 229.72 | loss  2.76 | ppl    15.87 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 66.70s | valid loss  3.69 | valid ppl    40.06 | valid bpc    5.324
-----------------------------------------------------------------------------------------
PROGRESS: 61.0%
| epoch  62 |   100/  269 batches | lr 0.00001 | ms/batch 256.55 | loss  2.77 | ppl    15.89 
| epoch  62 |   200/  269 batches | lr 0.00001 | ms/batch 231.21 | loss  2.75 | ppl    15.58 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 66.77s | valid loss  3.74 | valid ppl    42.03 | valid bpc    5.394
-----------------------------------------------------------------------------------------
PROGRESS: 62.0%
| epoch  63 |   100/  269 batches | lr 0.00001 | ms/batch 256.55 | loss  2.78 | ppl    16.12 
| epoch  63 |   200/  269 batches | lr 0.00001 | ms/batch 230.81 | loss  2.74 | ppl    15.56 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 66.68s | valid loss  3.77 | valid ppl    43.55 | valid bpc    5.445
-----------------------------------------------------------------------------------------
PROGRESS: 63.0%
| epoch  64 |   100/  269 batches | lr 0.00000 | ms/batch 256.54 | loss  2.77 | ppl    16.02 
| epoch  64 |   200/  269 batches | lr 0.00000 | ms/batch 231.49 | loss  2.74 | ppl    15.42 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 66.73s | valid loss  3.74 | valid ppl    42.29 | valid bpc    5.402
-----------------------------------------------------------------------------------------
PROGRESS: 64.0%
| epoch  65 |   100/  269 batches | lr 0.00000 | ms/batch 250.41 | loss  2.77 | ppl    15.97 
| epoch  65 |   200/  269 batches | lr 0.00000 | ms/batch 236.97 | loss  2.76 | ppl    15.79 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 66.68s | valid loss  3.71 | valid ppl    40.73 | valid bpc    5.348
-----------------------------------------------------------------------------------------
PROGRESS: 65.0%
| epoch  66 |   100/  269 batches | lr 0.00000 | ms/batch 251.39 | loss  2.76 | ppl    15.86 
| epoch  66 |   200/  269 batches | lr 0.00000 | ms/batch 236.08 | loss  2.74 | ppl    15.50 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 66.68s | valid loss  3.71 | valid ppl    41.03 | valid bpc    5.359
-----------------------------------------------------------------------------------------
PROGRESS: 66.0%
| epoch  67 |   100/  269 batches | lr 0.00000 | ms/batch 253.15 | loss  2.75 | ppl    15.69 
| epoch  67 |   200/  269 batches | lr 0.00000 | ms/batch 235.92 | loss  2.73 | ppl    15.35 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 66.76s | valid loss  3.73 | valid ppl    41.80 | valid bpc    5.385
-----------------------------------------------------------------------------------------
PROGRESS: 67.0%
| epoch  68 |   100/  269 batches | lr 0.00000 | ms/batch 250.27 | loss  2.76 | ppl    15.81 
| epoch  68 |   200/  269 batches | lr 0.00000 | ms/batch 235.75 | loss  2.74 | ppl    15.50 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 66.68s | valid loss  3.72 | valid ppl    41.30 | valid bpc    5.368
-----------------------------------------------------------------------------------------
PROGRESS: 68.0%
| epoch  69 |   100/  269 batches | lr 0.00000 | ms/batch 247.58 | loss  2.74 | ppl    15.50 
| epoch  69 |   200/  269 batches | lr 0.00000 | ms/batch 236.36 | loss  2.75 | ppl    15.71 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 66.31s | valid loss  3.70 | valid ppl    40.30 | valid bpc    5.333
-----------------------------------------------------------------------------------------
PROGRESS: 69.0%
| epoch  70 |   100/  269 batches | lr 0.00000 | ms/batch 251.82 | loss  2.77 | ppl    15.98 
| epoch  70 |   200/  269 batches | lr 0.00000 | ms/batch 233.04 | loss  2.73 | ppl    15.34 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 66.32s | valid loss  3.69 | valid ppl    40.18 | valid bpc    5.328
-----------------------------------------------------------------------------------------
PROGRESS: 70.0%
| epoch  71 |   100/  269 batches | lr 0.00000 | ms/batch 251.68 | loss  2.74 | ppl    15.52 
| epoch  71 |   200/  269 batches | lr 0.00000 | ms/batch 235.95 | loss  2.74 | ppl    15.41 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 66.72s | valid loss  3.71 | valid ppl    40.79 | valid bpc    5.350
-----------------------------------------------------------------------------------------
PROGRESS: 71.0%
| epoch  72 |   100/  269 batches | lr 0.00000 | ms/batch 252.09 | loss  2.75 | ppl    15.66 
| epoch  72 |   200/  269 batches | lr 0.00000 | ms/batch 235.40 | loss  2.75 | ppl    15.57 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 66.71s | valid loss  3.71 | valid ppl    41.05 | valid bpc    5.359
-----------------------------------------------------------------------------------------
PROGRESS: 72.0%
| epoch  73 |   100/  269 batches | lr 0.00000 | ms/batch 249.64 | loss  2.76 | ppl    15.74 
| epoch  73 |   200/  269 batches | lr 0.00000 | ms/batch 238.46 | loss  2.75 | ppl    15.57 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 66.64s | valid loss  3.72 | valid ppl    41.19 | valid bpc    5.364
-----------------------------------------------------------------------------------------
PROGRESS: 73.0%
| epoch  74 |   100/  269 batches | lr 0.00000 | ms/batch 249.88 | loss  2.75 | ppl    15.61 
| epoch  74 |   200/  269 batches | lr 0.00000 | ms/batch 237.85 | loss  2.73 | ppl    15.29 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 66.20s | valid loss  3.69 | valid ppl    39.85 | valid bpc    5.317
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 74.0%
| epoch  75 |   100/  269 batches | lr 0.00000 | ms/batch 256.84 | loss  2.76 | ppl    15.77 
| epoch  75 |   200/  269 batches | lr 0.00000 | ms/batch 235.99 | loss  2.72 | ppl    15.16 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 66.69s | valid loss  3.69 | valid ppl    39.90 | valid bpc    5.318
-----------------------------------------------------------------------------------------
PROGRESS: 75.0%
| epoch  76 |   100/  269 batches | lr 0.00000 | ms/batch 256.30 | loss  2.75 | ppl    15.70 
| epoch  76 |   200/  269 batches | lr 0.00000 | ms/batch 238.05 | loss  2.74 | ppl    15.51 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 66.68s | valid loss  3.75 | valid ppl    42.53 | valid bpc    5.410
-----------------------------------------------------------------------------------------
PROGRESS: 76.0%
| epoch  77 |   100/  269 batches | lr 0.00000 | ms/batch 256.89 | loss  2.77 | ppl    15.90 
| epoch  77 |   200/  269 batches | lr 0.00000 | ms/batch 236.25 | loss  2.73 | ppl    15.38 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 66.66s | valid loss  3.77 | valid ppl    43.38 | valid bpc    5.439
-----------------------------------------------------------------------------------------
PROGRESS: 77.0%
| epoch  78 |   100/  269 batches | lr 0.00000 | ms/batch 257.40 | loss  2.77 | ppl    16.02 
| epoch  78 |   200/  269 batches | lr 0.00000 | ms/batch 236.63 | loss  2.73 | ppl    15.31 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 66.75s | valid loss  3.76 | valid ppl    43.15 | valid bpc    5.431
-----------------------------------------------------------------------------------------
PROGRESS: 78.0%
| epoch  79 |   100/  269 batches | lr 0.00000 | ms/batch 257.56 | loss  2.74 | ppl    15.42 
| epoch  79 |   200/  269 batches | lr 0.00000 | ms/batch 235.37 | loss  2.74 | ppl    15.43 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 66.68s | valid loss  3.70 | valid ppl    40.54 | valid bpc    5.341
-----------------------------------------------------------------------------------------
PROGRESS: 79.0%
| epoch  80 |   100/  269 batches | lr 0.00000 | ms/batch 255.77 | loss  2.77 | ppl    15.88 
| epoch  80 |   200/  269 batches | lr 0.00000 | ms/batch 233.08 | loss  2.71 | ppl    15.09 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 66.82s | valid loss  3.73 | valid ppl    41.88 | valid bpc    5.388
-----------------------------------------------------------------------------------------
PROGRESS: 80.0%
| epoch  81 |   100/  269 batches | lr 0.00000 | ms/batch 253.34 | loss  2.74 | ppl    15.53 
| epoch  81 |   200/  269 batches | lr 0.00000 | ms/batch 234.21 | loss  2.74 | ppl    15.48 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 66.68s | valid loss  3.73 | valid ppl    41.58 | valid bpc    5.378
-----------------------------------------------------------------------------------------
PROGRESS: 81.0%
| epoch  82 |   100/  269 batches | lr 0.00000 | ms/batch 251.69 | loss  2.75 | ppl    15.65 
| epoch  82 |   200/  269 batches | lr 0.00000 | ms/batch 235.94 | loss  2.74 | ppl    15.56 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 66.80s | valid loss  3.73 | valid ppl    41.50 | valid bpc    5.375
-----------------------------------------------------------------------------------------
PROGRESS: 82.0%
| epoch  83 |   100/  269 batches | lr 0.00000 | ms/batch 252.47 | loss  2.76 | ppl    15.82 
| epoch  83 |   200/  269 batches | lr 0.00000 | ms/batch 234.89 | loss  2.75 | ppl    15.65 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 66.73s | valid loss  3.72 | valid ppl    41.26 | valid bpc    5.367
-----------------------------------------------------------------------------------------
PROGRESS: 83.0%
| epoch  84 |   100/  269 batches | lr 0.00000 | ms/batch 247.55 | loss  2.76 | ppl    15.79 
| epoch  84 |   200/  269 batches | lr 0.00000 | ms/batch 236.29 | loss  2.74 | ppl    15.45 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 66.34s | valid loss  3.77 | valid ppl    43.33 | valid bpc    5.437
-----------------------------------------------------------------------------------------
PROGRESS: 84.0%
| epoch  85 |   100/  269 batches | lr 0.00000 | ms/batch 250.70 | loss  2.75 | ppl    15.68 
| epoch  85 |   200/  269 batches | lr 0.00000 | ms/batch 236.54 | loss  2.74 | ppl    15.52 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 66.73s | valid loss  3.75 | valid ppl    42.65 | valid bpc    5.414
-----------------------------------------------------------------------------------------
PROGRESS: 85.0%
| epoch  86 |   100/  269 batches | lr 0.00000 | ms/batch 246.95 | loss  2.75 | ppl    15.68 
| epoch  86 |   200/  269 batches | lr 0.00000 | ms/batch 233.79 | loss  2.73 | ppl    15.37 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 66.01s | valid loss  3.76 | valid ppl    42.95 | valid bpc    5.425
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  269 batches | lr 0.00000 | ms/batch 250.13 | loss  2.77 | ppl    15.92 
| epoch  87 |   200/  269 batches | lr 0.00000 | ms/batch 236.44 | loss  2.73 | ppl    15.30 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 66.71s | valid loss  3.77 | valid ppl    43.25 | valid bpc    5.435
-----------------------------------------------------------------------------------------
PROGRESS: 87.0%
| epoch  88 |   100/  269 batches | lr 0.00000 | ms/batch 249.58 | loss  2.75 | ppl    15.69 
| epoch  88 |   200/  269 batches | lr 0.00000 | ms/batch 238.39 | loss  2.74 | ppl    15.53 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 66.75s | valid loss  3.73 | valid ppl    41.54 | valid bpc    5.376
-----------------------------------------------------------------------------------------
PROGRESS: 88.0%
| epoch  89 |   100/  269 batches | lr 0.00000 | ms/batch 245.65 | loss  2.76 | ppl    15.77 
| epoch  89 |   200/  269 batches | lr 0.00000 | ms/batch 242.38 | loss  2.73 | ppl    15.33 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 66.71s | valid loss  3.73 | valid ppl    41.77 | valid bpc    5.384
-----------------------------------------------------------------------------------------
PROGRESS: 89.0%
| epoch  90 |   100/  269 batches | lr 0.00000 | ms/batch 247.00 | loss  2.75 | ppl    15.67 
| epoch  90 |   200/  269 batches | lr 0.00000 | ms/batch 241.41 | loss  2.73 | ppl    15.36 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 66.77s | valid loss  3.74 | valid ppl    42.06 | valid bpc    5.395
-----------------------------------------------------------------------------------------
PROGRESS: 90.0%
| epoch  91 |   100/  269 batches | lr 0.00000 | ms/batch 246.03 | loss  2.74 | ppl    15.54 
| epoch  91 |   200/  269 batches | lr 0.00000 | ms/batch 242.35 | loss  2.74 | ppl    15.45 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 66.74s | valid loss  3.70 | valid ppl    40.32 | valid bpc    5.333
-----------------------------------------------------------------------------------------
PROGRESS: 91.0%
| epoch  92 |   100/  269 batches | lr 0.00000 | ms/batch 245.19 | loss  2.76 | ppl    15.86 
| epoch  92 |   200/  269 batches | lr 0.00000 | ms/batch 243.79 | loss  2.73 | ppl    15.31 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 66.73s | valid loss  3.77 | valid ppl    43.38 | valid bpc    5.439
-----------------------------------------------------------------------------------------
PROGRESS: 92.0%
| epoch  93 |   100/  269 batches | lr 0.00000 | ms/batch 244.97 | loss  2.75 | ppl    15.60 
| epoch  93 |   200/  269 batches | lr 0.00000 | ms/batch 242.08 | loss  2.74 | ppl    15.54 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 66.64s | valid loss  3.70 | valid ppl    40.41 | valid bpc    5.336
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  269 batches | lr 0.00000 | ms/batch 246.10 | loss  2.74 | ppl    15.55 
| epoch  94 |   200/  269 batches | lr 0.00000 | ms/batch 240.33 | loss  2.72 | ppl    15.25 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 66.66s | valid loss  3.74 | valid ppl    41.96 | valid bpc    5.391
-----------------------------------------------------------------------------------------
PROGRESS: 94.0%
| epoch  95 |   100/  269 batches | lr 0.00000 | ms/batch 246.86 | loss  2.75 | ppl    15.63 
| epoch  95 |   200/  269 batches | lr 0.00000 | ms/batch 241.88 | loss  2.73 | ppl    15.32 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 66.70s | valid loss  3.69 | valid ppl    40.01 | valid bpc    5.322
-----------------------------------------------------------------------------------------
PROGRESS: 95.0%
| epoch  96 |   100/  269 batches | lr 0.00000 | ms/batch 186.70 | loss  2.77 | ppl    15.90 
| epoch  96 |   200/  269 batches | lr 0.00000 | ms/batch 171.41 | loss  2.72 | ppl    15.19 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 48.52s | valid loss  3.74 | valid ppl    42.19 | valid bpc    5.399
-----------------------------------------------------------------------------------------
PROGRESS: 96.0%
| epoch  97 |   100/  269 batches | lr 0.00000 | ms/batch 173.65 | loss  2.73 | ppl    15.26 
| epoch  97 |   200/  269 batches | lr 0.00000 | ms/batch 164.95 | loss  2.74 | ppl    15.43 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 45.82s | valid loss  3.80 | valid ppl    44.52 | valid bpc    5.477
-----------------------------------------------------------------------------------------
PROGRESS: 97.0%
| epoch  98 |   100/  269 batches | lr 0.00000 | ms/batch 162.09 | loss  2.74 | ppl    15.52 
| epoch  98 |   200/  269 batches | lr 0.00000 | ms/batch 223.34 | loss  2.74 | ppl    15.44 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 56.45s | valid loss  3.70 | valid ppl    40.25 | valid bpc    5.331
-----------------------------------------------------------------------------------------
PROGRESS: 98.0%
| epoch  99 |   100/  269 batches | lr 0.00000 | ms/batch 249.48 | loss  2.75 | ppl    15.62 
| epoch  99 |   200/  269 batches | lr 0.00000 | ms/batch 232.66 | loss  2.72 | ppl    15.24 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 66.29s | valid loss  3.72 | valid ppl    41.46 | valid bpc    5.373
-----------------------------------------------------------------------------------------
PROGRESS: 99.0%
| epoch 100 |   100/  269 batches | lr 0.00000 | ms/batch 248.54 | loss  2.76 | ppl    15.87 
| epoch 100 |   200/  269 batches | lr 0.00000 | ms/batch 235.99 | loss  2.73 | ppl    15.30 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 66.31s | valid loss  3.74 | valid ppl    41.90 | valid bpc    5.389
-----------------------------------------------------------------------------------------
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  3.80 | test ppl    44.87 | test bpc    5.488
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.4822, Mean Reca: 0.6771, Mean F1: 0.5588, Mean Subword_Reca: 0.8542
-----------------------------------------------------------------------------------------
=========================================================================================
Loading dataset...
Using subword tokenizer...
Number of tokens:  8000
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer_in_parser', nhid=512, nlayers=8, front_layers=2, rear_layers=6, subword='omarmomen/ptb_filtered_lowcase_bpe_tokenizer_8', n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=3333, nonmono=5, cuda=True, log_interval=100, save='trained_models/subword_structformer_in_parser_3333_26.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 37449124
Model architecture: StructFormer_In_Parser(
  (transformer_front): Transformer_Front(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(8000, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-1): 2 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
  (transformer_rear): Transformer_Rear(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(8000, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-5): 6 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (output_layer): Linear(in_features=512, out_features=8000, bias=True)
  )
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  269 batches | lr 0.00030 | ms/batch 162.35 | loss  7.72 | ppl  2257.33 
| epoch   1 |   200/  269 batches | lr 0.00030 | ms/batch 173.38 | loss  7.34 | ppl  1543.53 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 51.34s | valid loss  7.04 | valid ppl  1139.80 | valid bpc   10.155
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  269 batches | lr 0.00030 | ms/batch 248.44 | loss  7.18 | ppl  1314.19 
| epoch   2 |   200/  269 batches | lr 0.00030 | ms/batch 232.36 | loss  6.96 | ppl  1050.97 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 66.02s | valid loss  6.61 | valid ppl   743.03 | valid bpc    9.537
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  269 batches | lr 0.00030 | ms/batch 247.47 | loss  6.76 | ppl   863.71 
| epoch   3 |   200/  269 batches | lr 0.00030 | ms/batch 231.78 | loss  6.52 | ppl   681.90 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 66.02s | valid loss  6.12 | valid ppl   455.04 | valid bpc    8.830
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  269 batches | lr 0.00030 | ms/batch 247.25 | loss  6.27 | ppl   529.25 
| epoch   4 |   200/  269 batches | lr 0.00030 | ms/batch 233.79 | loss  6.04 | ppl   418.88 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 66.06s | valid loss  5.73 | valid ppl   309.30 | valid bpc    8.273
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  269 batches | lr 0.00030 | ms/batch 246.89 | loss  5.89 | ppl   360.89 
| epoch   5 |   200/  269 batches | lr 0.00030 | ms/batch 232.72 | loss  5.75 | ppl   314.51 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 65.99s | valid loss  5.46 | valid ppl   234.31 | valid bpc    7.872
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  269 batches | lr 0.00030 | ms/batch 247.12 | loss  5.66 | ppl   285.86 
| epoch   6 |   200/  269 batches | lr 0.00030 | ms/batch 233.11 | loss  5.53 | ppl   251.53 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 66.03s | valid loss  5.32 | valid ppl   203.86 | valid bpc    7.671
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  269 batches | lr 0.00030 | ms/batch 244.46 | loss  5.45 | ppl   233.36 
| epoch   7 |   200/  269 batches | lr 0.00030 | ms/batch 232.54 | loss  5.38 | ppl   216.02 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 65.55s | valid loss  5.17 | valid ppl   176.73 | valid bpc    7.465
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  269 batches | lr 0.00030 | ms/batch 255.93 | loss  5.32 | ppl   203.86 
| epoch   8 |   200/  269 batches | lr 0.00030 | ms/batch 232.45 | loss  5.24 | ppl   189.42 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 65.90s | valid loss  5.02 | valid ppl   151.24 | valid bpc    7.241
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 8.0%
| epoch   9 |   100/  269 batches | lr 0.00030 | ms/batch 257.55 | loss  5.21 | ppl   182.34 
| epoch   9 |   200/  269 batches | lr 0.00030 | ms/batch 233.92 | loss  5.10 | ppl   163.51 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 66.02s | valid loss  4.90 | valid ppl   133.96 | valid bpc    7.066
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  269 batches | lr 0.00030 | ms/batch 258.81 | loss  5.09 | ppl   162.84 
| epoch  10 |   200/  269 batches | lr 0.00030 | ms/batch 232.54 | loss  4.97 | ppl   144.44 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 66.10s | valid loss  4.88 | valid ppl   131.20 | valid bpc    7.036
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  269 batches | lr 0.00030 | ms/batch 256.56 | loss  4.97 | ppl   143.64 
| epoch  11 |   200/  269 batches | lr 0.00030 | ms/batch 232.51 | loss  4.88 | ppl   131.35 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 66.04s | valid loss  4.69 | valid ppl   109.13 | valid bpc    6.770
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  269 batches | lr 0.00030 | ms/batch 257.12 | loss  4.86 | ppl   128.53 
| epoch  12 |   200/  269 batches | lr 0.00030 | ms/batch 234.45 | loss  4.79 | ppl   120.13 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 66.19s | valid loss  4.67 | valid ppl   106.35 | valid bpc    6.733
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 12.0%
| epoch  13 |   100/  269 batches | lr 0.00030 | ms/batch 258.60 | loss  4.74 | ppl   114.89 
| epoch  13 |   200/  269 batches | lr 0.00030 | ms/batch 227.84 | loss  4.68 | ppl   107.89 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 66.06s | valid loss  4.57 | valid ppl    96.27 | valid bpc    6.589
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 13.0%
| epoch  14 |   100/  269 batches | lr 0.00030 | ms/batch 256.47 | loss  4.63 | ppl   102.07 
| epoch  14 |   200/  269 batches | lr 0.00030 | ms/batch 223.65 | loss  4.62 | ppl   101.73 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 66.00s | valid loss  4.49 | valid ppl    89.18 | valid bpc    6.479
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  269 batches | lr 0.00030 | ms/batch 256.09 | loss  4.55 | ppl    94.80 
| epoch  15 |   200/  269 batches | lr 0.00030 | ms/batch 228.57 | loss  4.50 | ppl    90.42 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 66.45s | valid loss  4.43 | valid ppl    83.92 | valid bpc    6.391
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 15.0%
| epoch  16 |   100/  269 batches | lr 0.00030 | ms/batch 258.13 | loss  4.50 | ppl    90.22 
| epoch  16 |   200/  269 batches | lr 0.00030 | ms/batch 222.45 | loss  4.44 | ppl    84.73 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 66.02s | valid loss  4.34 | valid ppl    77.09 | valid bpc    6.268
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 16.0%
| epoch  17 |   100/  269 batches | lr 0.00030 | ms/batch 256.28 | loss  4.39 | ppl    80.92 
| epoch  17 |   200/  269 batches | lr 0.00030 | ms/batch 223.50 | loss  4.37 | ppl    78.71 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 66.06s | valid loss  4.35 | valid ppl    77.34 | valid bpc    6.273
-----------------------------------------------------------------------------------------
PROGRESS: 17.0%
| epoch  18 |   100/  269 batches | lr 0.00030 | ms/batch 256.32 | loss  4.33 | ppl    75.76 
| epoch  18 |   200/  269 batches | lr 0.00030 | ms/batch 227.66 | loss  4.29 | ppl    72.80 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 66.39s | valid loss  4.27 | valid ppl    71.46 | valid bpc    6.159
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 18.0%
| epoch  19 |   100/  269 batches | lr 0.00030 | ms/batch 257.33 | loss  4.28 | ppl    72.24 
| epoch  19 |   200/  269 batches | lr 0.00030 | ms/batch 217.65 | loss  4.20 | ppl    66.99 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 65.47s | valid loss  4.24 | valid ppl    69.20 | valid bpc    6.113
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 19.0%
| epoch  20 |   100/  269 batches | lr 0.00030 | ms/batch 257.19 | loss  4.18 | ppl    65.45 
| epoch  20 |   200/  269 batches | lr 0.00030 | ms/batch 227.56 | loss  4.15 | ppl    63.50 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 66.51s | valid loss  4.18 | valid ppl    65.49 | valid bpc    6.033
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 20.0%
| epoch  21 |   100/  269 batches | lr 0.00030 | ms/batch 254.90 | loss  4.15 | ppl    63.33 
| epoch  21 |   200/  269 batches | lr 0.00030 | ms/batch 226.68 | loss  4.10 | ppl    60.27 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 66.02s | valid loss  4.20 | valid ppl    66.38 | valid bpc    6.053
-----------------------------------------------------------------------------------------
PROGRESS: 21.0%
| epoch  22 |   100/  269 batches | lr 0.00030 | ms/batch 248.69 | loss  4.07 | ppl    58.38 
| epoch  22 |   200/  269 batches | lr 0.00030 | ms/batch 233.47 | loss  4.05 | ppl    57.61 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 66.07s | valid loss  4.10 | valid ppl    60.41 | valid bpc    5.917
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 22.0%
| epoch  23 |   100/  269 batches | lr 0.00030 | ms/batch 248.85 | loss  4.03 | ppl    56.48 
| epoch  23 |   200/  269 batches | lr 0.00030 | ms/batch 233.57 | loss  3.99 | ppl    54.24 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 66.03s | valid loss  4.06 | valid ppl    58.24 | valid bpc    5.864
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 23.0%
| epoch  24 |   100/  269 batches | lr 0.00030 | ms/batch 247.68 | loss  3.97 | ppl    53.07 
| epoch  24 |   200/  269 batches | lr 0.00030 | ms/batch 235.33 | loss  3.91 | ppl    49.96 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 66.37s | valid loss  4.05 | valid ppl    57.48 | valid bpc    5.845
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 24.0%
| epoch  25 |   100/  269 batches | lr 0.00030 | ms/batch 247.59 | loss  3.91 | ppl    49.70 
| epoch  25 |   200/  269 batches | lr 0.00030 | ms/batch 235.01 | loss  3.90 | ppl    49.57 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 66.06s | valid loss  4.08 | valid ppl    58.91 | valid bpc    5.880
-----------------------------------------------------------------------------------------
PROGRESS: 25.0%
| epoch  26 |   100/  269 batches | lr 0.00030 | ms/batch 248.82 | loss  3.87 | ppl    48.17 
| epoch  26 |   200/  269 batches | lr 0.00030 | ms/batch 236.11 | loss  3.82 | ppl    45.49 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 66.48s | valid loss  4.00 | valid ppl    54.71 | valid bpc    5.774
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 26.0%
| epoch  27 |   100/  269 batches | lr 0.00030 | ms/batch 246.21 | loss  3.82 | ppl    45.43 
| epoch  27 |   200/  269 batches | lr 0.00030 | ms/batch 236.36 | loss  3.81 | ppl    45.16 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 66.11s | valid loss  4.01 | valid ppl    55.01 | valid bpc    5.782
-----------------------------------------------------------------------------------------
PROGRESS: 27.0%
| epoch  28 |   100/  269 batches | lr 0.00030 | ms/batch 249.22 | loss  3.76 | ppl    43.13 
| epoch  28 |   200/  269 batches | lr 0.00030 | ms/batch 235.65 | loss  3.75 | ppl    42.61 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 66.45s | valid loss  4.00 | valid ppl    54.77 | valid bpc    5.775
-----------------------------------------------------------------------------------------
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  269 batches | lr 0.00030 | ms/batch 249.35 | loss  3.74 | ppl    41.96 
| epoch  29 |   200/  269 batches | lr 0.00030 | ms/batch 235.24 | loss  3.73 | ppl    41.51 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 66.44s | valid loss  3.91 | valid ppl    50.03 | valid bpc    5.645
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  269 batches | lr 0.00030 | ms/batch 248.09 | loss  3.69 | ppl    40.09 
| epoch  30 |   200/  269 batches | lr 0.00030 | ms/batch 236.75 | loss  3.65 | ppl    38.49 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 65.98s | valid loss  3.92 | valid ppl    50.55 | valid bpc    5.660
-----------------------------------------------------------------------------------------
PROGRESS: 30.0%
| epoch  31 |   100/  269 batches | lr 0.00030 | ms/batch 248.66 | loss  3.63 | ppl    37.79 
| epoch  31 |   200/  269 batches | lr 0.00030 | ms/batch 239.92 | loss  3.61 | ppl    37.09 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 65.82s | valid loss  3.92 | valid ppl    50.18 | valid bpc    5.649
-----------------------------------------------------------------------------------------
PROGRESS: 31.0%
| epoch  32 |   100/  269 batches | lr 0.00030 | ms/batch 252.61 | loss  3.62 | ppl    37.20 
| epoch  32 |   200/  269 batches | lr 0.00030 | ms/batch 242.98 | loss  3.59 | ppl    36.10 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 66.35s | valid loss  3.91 | valid ppl    49.98 | valid bpc    5.643
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 32.0%
| epoch  33 |   100/  269 batches | lr 0.00030 | ms/batch 247.42 | loss  3.57 | ppl    35.67 
| epoch  33 |   200/  269 batches | lr 0.00030 | ms/batch 242.14 | loss  3.54 | ppl    34.63 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 66.08s | valid loss  3.92 | valid ppl    50.27 | valid bpc    5.652
-----------------------------------------------------------------------------------------
PROGRESS: 33.0%
| epoch  34 |   100/  269 batches | lr 0.00030 | ms/batch 247.38 | loss  3.53 | ppl    34.09 
| epoch  34 |   200/  269 batches | lr 0.00030 | ms/batch 242.35 | loss  3.52 | ppl    33.81 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 66.09s | valid loss  3.90 | valid ppl    49.43 | valid bpc    5.627
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 34.0%
| epoch  35 |   100/  269 batches | lr 0.00030 | ms/batch 250.86 | loss  3.48 | ppl    32.50 
| epoch  35 |   200/  269 batches | lr 0.00030 | ms/batch 242.76 | loss  3.48 | ppl    32.54 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 66.35s | valid loss  3.93 | valid ppl    51.08 | valid bpc    5.675
-----------------------------------------------------------------------------------------
PROGRESS: 35.0%
| epoch  36 |   100/  269 batches | lr 0.00030 | ms/batch 251.52 | loss  3.46 | ppl    31.93 
| epoch  36 |   200/  269 batches | lr 0.00030 | ms/batch 241.84 | loss  3.44 | ppl    31.32 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 66.75s | valid loss  3.92 | valid ppl    50.31 | valid bpc    5.653
-----------------------------------------------------------------------------------------
PROGRESS: 36.0%
| epoch  37 |   100/  269 batches | lr 0.00030 | ms/batch 247.93 | loss  3.44 | ppl    31.06 
| epoch  37 |   200/  269 batches | lr 0.00030 | ms/batch 241.67 | loss  3.42 | ppl    30.49 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 66.43s | valid loss  3.87 | valid ppl    47.87 | valid bpc    5.581
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 37.0%
| epoch  38 |   100/  269 batches | lr 0.00030 | ms/batch 246.79 | loss  3.38 | ppl    29.41 
| epoch  38 |   200/  269 batches | lr 0.00030 | ms/batch 234.38 | loss  3.40 | ppl    29.92 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 66.15s | valid loss  3.88 | valid ppl    48.20 | valid bpc    5.591
-----------------------------------------------------------------------------------------
PROGRESS: 38.0%
| epoch  39 |   100/  269 batches | lr 0.00030 | ms/batch 247.00 | loss  3.35 | ppl    28.47 
| epoch  39 |   200/  269 batches | lr 0.00030 | ms/batch 237.68 | loss  3.38 | ppl    29.28 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 66.42s | valid loss  3.87 | valid ppl    48.16 | valid bpc    5.590
-----------------------------------------------------------------------------------------
PROGRESS: 39.0%
| epoch  40 |   100/  269 batches | lr 0.00030 | ms/batch 251.99 | loss  3.35 | ppl    28.51 
| epoch  40 |   200/  269 batches | lr 0.00030 | ms/batch 236.49 | loss  3.31 | ppl    27.41 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 66.77s | valid loss  3.87 | valid ppl    47.75 | valid bpc    5.578
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 40.0%
| epoch  41 |   100/  269 batches | lr 0.00030 | ms/batch 247.26 | loss  3.31 | ppl    27.30 
| epoch  41 |   200/  269 batches | lr 0.00030 | ms/batch 237.32 | loss  3.30 | ppl    27.11 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 66.44s | valid loss  3.84 | valid ppl    46.34 | valid bpc    5.534
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 41.0%
| epoch  42 |   100/  269 batches | lr 0.00030 | ms/batch 250.19 | loss  3.26 | ppl    26.14 
| epoch  42 |   200/  269 batches | lr 0.00030 | ms/batch 234.43 | loss  3.28 | ppl    26.54 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 66.52s | valid loss  3.82 | valid ppl    45.60 | valid bpc    5.511
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 42.0%
| epoch  43 |   100/  269 batches | lr 0.00030 | ms/batch 247.86 | loss  3.25 | ppl    25.76 
| epoch  43 |   200/  269 batches | lr 0.00030 | ms/batch 235.96 | loss  3.25 | ppl    25.91 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 66.38s | valid loss  3.83 | valid ppl    46.13 | valid bpc    5.528
-----------------------------------------------------------------------------------------
PROGRESS: 43.0%
| epoch  44 |   100/  269 batches | lr 0.00030 | ms/batch 252.25 | loss  3.26 | ppl    26.17 
| epoch  44 |   200/  269 batches | lr 0.00030 | ms/batch 232.45 | loss  3.22 | ppl    25.09 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 66.41s | valid loss  3.86 | valid ppl    47.53 | valid bpc    5.571
-----------------------------------------------------------------------------------------
PROGRESS: 44.0%
| epoch  45 |   100/  269 batches | lr 0.00030 | ms/batch 249.73 | loss  3.21 | ppl    24.68 
| epoch  45 |   200/  269 batches | lr 0.00030 | ms/batch 238.12 | loss  3.19 | ppl    24.28 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 66.73s | valid loss  3.83 | valid ppl    45.96 | valid bpc    5.522
-----------------------------------------------------------------------------------------
PROGRESS: 45.0%
| epoch  46 |   100/  269 batches | lr 0.00015 | ms/batch 240.92 | loss  3.13 | ppl    22.77 
| epoch  46 |   200/  269 batches | lr 0.00015 | ms/batch 244.34 | loss  3.08 | ppl    21.85 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 66.33s | valid loss  3.82 | valid ppl    45.39 | valid bpc    5.504
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 46.0%
| epoch  47 |   100/  269 batches | lr 0.00015 | ms/batch 237.54 | loss  3.06 | ppl    21.36 
| epoch  47 |   200/  269 batches | lr 0.00015 | ms/batch 243.51 | loss  3.06 | ppl    21.24 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 66.11s | valid loss  3.76 | valid ppl    43.13 | valid bpc    5.431
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 47.0%
| epoch  48 |   100/  269 batches | lr 0.00015 | ms/batch 246.21 | loss  3.03 | ppl    20.70 
| epoch  48 |   200/  269 batches | lr 0.00015 | ms/batch 242.28 | loss  3.01 | ppl    20.30 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 66.81s | valid loss  3.78 | valid ppl    43.96 | valid bpc    5.458
-----------------------------------------------------------------------------------------
PROGRESS: 48.0%
| epoch  49 |   100/  269 batches | lr 0.00015 | ms/batch 244.67 | loss  2.99 | ppl    19.90 
| epoch  49 |   200/  269 batches | lr 0.00015 | ms/batch 243.38 | loss  3.01 | ppl    20.35 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 66.77s | valid loss  3.77 | valid ppl    43.43 | valid bpc    5.441
-----------------------------------------------------------------------------------------
PROGRESS: 49.0%
| epoch  50 |   100/  269 batches | lr 0.00015 | ms/batch 245.45 | loss  2.99 | ppl    19.81 
| epoch  50 |   200/  269 batches | lr 0.00015 | ms/batch 243.15 | loss  2.96 | ppl    19.37 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 66.86s | valid loss  3.81 | valid ppl    45.14 | valid bpc    5.496
-----------------------------------------------------------------------------------------
PROGRESS: 50.0%
| epoch  51 |   100/  269 batches | lr 0.00007 | ms/batch 242.56 | loss  2.95 | ppl    19.06 
| epoch  51 |   200/  269 batches | lr 0.00007 | ms/batch 242.63 | loss  2.92 | ppl    18.49 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 66.42s | valid loss  3.75 | valid ppl    42.31 | valid bpc    5.403
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 51.0%
| epoch  52 |   100/  269 batches | lr 0.00007 | ms/batch 245.21 | loss  2.89 | ppl    18.08 
| epoch  52 |   200/  269 batches | lr 0.00007 | ms/batch 242.81 | loss  2.90 | ppl    18.11 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 66.78s | valid loss  3.76 | valid ppl    42.86 | valid bpc    5.421
-----------------------------------------------------------------------------------------
PROGRESS: 52.0%
| epoch  53 |   100/  269 batches | lr 0.00007 | ms/batch 245.82 | loss  2.89 | ppl    17.91 
| epoch  53 |   200/  269 batches | lr 0.00007 | ms/batch 241.57 | loss  2.88 | ppl    17.74 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 66.31s | valid loss  3.72 | valid ppl    41.41 | valid bpc    5.372
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 53.0%
| epoch  54 |   100/  269 batches | lr 0.00007 | ms/batch 251.88 | loss  2.88 | ppl    17.82 
| epoch  54 |   200/  269 batches | lr 0.00007 | ms/batch 242.15 | loss  2.85 | ppl    17.34 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 66.70s | valid loss  3.70 | valid ppl    40.59 | valid bpc    5.343
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 54.0%
| epoch  55 |   100/  269 batches | lr 0.00007 | ms/batch 250.96 | loss  2.86 | ppl    17.40 
| epoch  55 |   200/  269 batches | lr 0.00007 | ms/batch 242.60 | loss  2.86 | ppl    17.39 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 66.75s | valid loss  3.72 | valid ppl    41.34 | valid bpc    5.369
-----------------------------------------------------------------------------------------
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  269 batches | lr 0.00007 | ms/batch 251.76 | loss  2.84 | ppl    17.15 
| epoch  56 |   200/  269 batches | lr 0.00007 | ms/batch 241.65 | loss  2.85 | ppl    17.33 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 66.80s | valid loss  3.74 | valid ppl    42.19 | valid bpc    5.399
-----------------------------------------------------------------------------------------
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  269 batches | lr 0.00007 | ms/batch 251.54 | loss  2.86 | ppl    17.41 
| epoch  57 |   200/  269 batches | lr 0.00007 | ms/batch 242.55 | loss  2.82 | ppl    16.78 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 66.81s | valid loss  3.76 | valid ppl    42.98 | valid bpc    5.426
-----------------------------------------------------------------------------------------
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  269 batches | lr 0.00004 | ms/batch 252.45 | loss  2.84 | ppl    17.08 
| epoch  58 |   200/  269 batches | lr 0.00004 | ms/batch 241.19 | loss  2.80 | ppl    16.41 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 66.82s | valid loss  3.71 | valid ppl    40.95 | valid bpc    5.356
-----------------------------------------------------------------------------------------
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  269 batches | lr 0.00004 | ms/batch 249.97 | loss  2.80 | ppl    16.39 
| epoch  59 |   200/  269 batches | lr 0.00004 | ms/batch 237.39 | loss  2.81 | ppl    16.62 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 66.75s | valid loss  3.74 | valid ppl    41.91 | valid bpc    5.389
-----------------------------------------------------------------------------------------
PROGRESS: 59.0%
| epoch  60 |   100/  269 batches | lr 0.00004 | ms/batch 250.41 | loss  2.80 | ppl    16.37 
| epoch  60 |   200/  269 batches | lr 0.00004 | ms/batch 236.45 | loss  2.76 | ppl    15.78 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 66.75s | valid loss  3.71 | valid ppl    41.01 | valid bpc    5.358
-----------------------------------------------------------------------------------------
PROGRESS: 60.0%
| epoch  61 |   100/  269 batches | lr 0.00002 | ms/batch 250.25 | loss  2.78 | ppl    16.05 
| epoch  61 |   200/  269 batches | lr 0.00002 | ms/batch 236.25 | loss  2.75 | ppl    15.71 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 66.69s | valid loss  3.71 | valid ppl    40.75 | valid bpc    5.349
-----------------------------------------------------------------------------------------
PROGRESS: 61.0%
| epoch  62 |   100/  269 batches | lr 0.00002 | ms/batch 250.76 | loss  2.79 | ppl    16.25 
| epoch  62 |   200/  269 batches | lr 0.00002 | ms/batch 236.43 | loss  2.76 | ppl    15.83 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 66.49s | valid loss  3.74 | valid ppl    42.27 | valid bpc    5.402
-----------------------------------------------------------------------------------------
PROGRESS: 62.0%
| epoch  63 |   100/  269 batches | lr 0.00002 | ms/batch 248.07 | loss  2.77 | ppl    16.03 
| epoch  63 |   200/  269 batches | lr 0.00002 | ms/batch 238.41 | loss  2.75 | ppl    15.66 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 66.47s | valid loss  3.73 | valid ppl    41.65 | valid bpc    5.380
-----------------------------------------------------------------------------------------
PROGRESS: 63.0%
| epoch  64 |   100/  269 batches | lr 0.00001 | ms/batch 251.60 | loss  2.76 | ppl    15.83 
| epoch  64 |   200/  269 batches | lr 0.00001 | ms/batch 236.08 | loss  2.73 | ppl    15.32 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 66.52s | valid loss  3.74 | valid ppl    42.20 | valid bpc    5.399
-----------------------------------------------------------------------------------------
PROGRESS: 64.0%
| epoch  65 |   100/  269 batches | lr 0.00001 | ms/batch 249.84 | loss  2.76 | ppl    15.83 
| epoch  65 |   200/  269 batches | lr 0.00001 | ms/batch 237.52 | loss  2.75 | ppl    15.58 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 66.50s | valid loss  3.74 | valid ppl    42.15 | valid bpc    5.397
-----------------------------------------------------------------------------------------
PROGRESS: 65.0%
| epoch  66 |   100/  269 batches | lr 0.00001 | ms/batch 252.50 | loss  2.78 | ppl    16.05 
| epoch  66 |   200/  269 batches | lr 0.00001 | ms/batch 236.38 | loss  2.74 | ppl    15.42 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 66.54s | valid loss  3.73 | valid ppl    41.48 | valid bpc    5.374
-----------------------------------------------------------------------------------------
PROGRESS: 66.0%
| epoch  67 |   100/  269 batches | lr 0.00000 | ms/batch 249.76 | loss  2.76 | ppl    15.78 
| epoch  67 |   200/  269 batches | lr 0.00000 | ms/batch 242.91 | loss  2.74 | ppl    15.47 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 66.71s | valid loss  3.71 | valid ppl    41.00 | valid bpc    5.358
-----------------------------------------------------------------------------------------
PROGRESS: 67.0%
| epoch  68 |   100/  269 batches | lr 0.00000 | ms/batch 251.22 | loss  2.78 | ppl    16.14 
| epoch  68 |   200/  269 batches | lr 0.00000 | ms/batch 242.90 | loss  2.73 | ppl    15.36 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 66.43s | valid loss  3.76 | valid ppl    42.91 | valid bpc    5.423
-----------------------------------------------------------------------------------------
PROGRESS: 68.0%
| epoch  69 |   100/  269 batches | lr 0.00000 | ms/batch 249.81 | loss  2.76 | ppl    15.80 
| epoch  69 |   200/  269 batches | lr 0.00000 | ms/batch 243.58 | loss  2.73 | ppl    15.33 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 66.43s | valid loss  3.71 | valid ppl    40.98 | valid bpc    5.357
-----------------------------------------------------------------------------------------
PROGRESS: 69.0%
| epoch  70 |   100/  269 batches | lr 0.00000 | ms/batch 249.79 | loss  2.76 | ppl    15.87 
| epoch  70 |   200/  269 batches | lr 0.00000 | ms/batch 242.83 | loss  2.74 | ppl    15.54 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 66.58s | valid loss  3.72 | valid ppl    41.45 | valid bpc    5.373
-----------------------------------------------------------------------------------------
PROGRESS: 70.0%
| epoch  71 |   100/  269 batches | lr 0.00000 | ms/batch 251.67 | loss  2.75 | ppl    15.61 
| epoch  71 |   200/  269 batches | lr 0.00000 | ms/batch 241.37 | loss  2.74 | ppl    15.50 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 66.77s | valid loss  3.73 | valid ppl    41.79 | valid bpc    5.385
-----------------------------------------------------------------------------------------
PROGRESS: 71.0%
| epoch  72 |   100/  269 batches | lr 0.00000 | ms/batch 250.34 | loss  2.76 | ppl    15.87 
| epoch  72 |   200/  269 batches | lr 0.00000 | ms/batch 242.56 | loss  2.74 | ppl    15.50 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 66.75s | valid loss  3.65 | valid ppl    38.44 | valid bpc    5.265
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 72.0%
| epoch  73 |   100/  269 batches | lr 0.00000 | ms/batch 251.04 | loss  2.74 | ppl    15.51 
| epoch  73 |   200/  269 batches | lr 0.00000 | ms/batch 241.78 | loss  2.71 | ppl    15.04 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 66.75s | valid loss  3.72 | valid ppl    41.28 | valid bpc    5.367
-----------------------------------------------------------------------------------------
PROGRESS: 73.0%
| epoch  74 |   100/  269 batches | lr 0.00000 | ms/batch 250.42 | loss  2.75 | ppl    15.57 
| epoch  74 |   200/  269 batches | lr 0.00000 | ms/batch 242.61 | loss  2.73 | ppl    15.28 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 66.74s | valid loss  3.75 | valid ppl    42.65 | valid bpc    5.415
-----------------------------------------------------------------------------------------
PROGRESS: 74.0%
| epoch  75 |   100/  269 batches | lr 0.00000 | ms/batch 249.96 | loss  2.76 | ppl    15.77 
| epoch  75 |   200/  269 batches | lr 0.00000 | ms/batch 243.10 | loss  2.72 | ppl    15.13 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 66.10s | valid loss  3.77 | valid ppl    43.24 | valid bpc    5.434
-----------------------------------------------------------------------------------------
PROGRESS: 75.0%
| epoch  76 |   100/  269 batches | lr 0.00000 | ms/batch 255.09 | loss  2.73 | ppl    15.38 
| epoch  76 |   200/  269 batches | lr 0.00000 | ms/batch 242.08 | loss  2.73 | ppl    15.27 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 66.67s | valid loss  3.70 | valid ppl    40.35 | valid bpc    5.334
-----------------------------------------------------------------------------------------
PROGRESS: 76.0%
| epoch  77 |   100/  269 batches | lr 0.00000 | ms/batch 257.13 | loss  2.75 | ppl    15.68 
| epoch  77 |   200/  269 batches | lr 0.00000 | ms/batch 242.23 | loss  2.71 | ppl    15.10 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 66.72s | valid loss  3.77 | valid ppl    43.18 | valid bpc    5.432
-----------------------------------------------------------------------------------------
PROGRESS: 77.0%
| epoch  78 |   100/  269 batches | lr 0.00000 | ms/batch 255.45 | loss  2.74 | ppl    15.44 
| epoch  78 |   200/  269 batches | lr 0.00000 | ms/batch 243.19 | loss  2.73 | ppl    15.36 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 66.68s | valid loss  3.67 | valid ppl    39.10 | valid bpc    5.289
-----------------------------------------------------------------------------------------
PROGRESS: 78.0%
| epoch  79 |   100/  269 batches | lr 0.00000 | ms/batch 256.97 | loss  2.74 | ppl    15.52 
| epoch  79 |   200/  269 batches | lr 0.00000 | ms/batch 242.16 | loss  2.73 | ppl    15.36 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 66.79s | valid loss  3.71 | valid ppl    40.97 | valid bpc    5.357
-----------------------------------------------------------------------------------------
PROGRESS: 79.0%
| epoch  80 |   100/  269 batches | lr 0.00000 | ms/batch 257.55 | loss  2.76 | ppl    15.76 
| epoch  80 |   200/  269 batches | lr 0.00000 | ms/batch 242.90 | loss  2.73 | ppl    15.27 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 66.72s | valid loss  3.75 | valid ppl    42.54 | valid bpc    5.411
-----------------------------------------------------------------------------------------
PROGRESS: 80.0%
| epoch  81 |   100/  269 batches | lr 0.00000 | ms/batch 258.26 | loss  2.74 | ppl    15.56 
| epoch  81 |   200/  269 batches | lr 0.00000 | ms/batch 236.93 | loss  2.70 | ppl    14.95 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 66.76s | valid loss  3.74 | valid ppl    41.90 | valid bpc    5.389
-----------------------------------------------------------------------------------------
PROGRESS: 81.0%
| epoch  82 |   100/  269 batches | lr 0.00000 | ms/batch 257.93 | loss  2.76 | ppl    15.75 
| epoch  82 |   200/  269 batches | lr 0.00000 | ms/batch 235.88 | loss  2.73 | ppl    15.32 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 66.74s | valid loss  3.77 | valid ppl    43.29 | valid bpc    5.436
-----------------------------------------------------------------------------------------
PROGRESS: 82.0%
| epoch  83 |   100/  269 batches | lr 0.00000 | ms/batch 256.39 | loss  2.78 | ppl    16.04 
| epoch  83 |   200/  269 batches | lr 0.00000 | ms/batch 235.15 | loss  2.74 | ppl    15.44 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 66.70s | valid loss  3.69 | valid ppl    40.08 | valid bpc    5.325
-----------------------------------------------------------------------------------------
PROGRESS: 83.0%
| epoch  84 |   100/  269 batches | lr 0.00000 | ms/batch 258.16 | loss  2.76 | ppl    15.82 
| epoch  84 |   200/  269 batches | lr 0.00000 | ms/batch 235.53 | loss  2.73 | ppl    15.40 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 66.71s | valid loss  3.75 | valid ppl    42.37 | valid bpc    5.405
-----------------------------------------------------------------------------------------
PROGRESS: 84.0%
| epoch  85 |   100/  269 batches | lr 0.00000 | ms/batch 257.03 | loss  2.75 | ppl    15.60 
| epoch  85 |   200/  269 batches | lr 0.00000 | ms/batch 236.24 | loss  2.70 | ppl    14.95 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 66.75s | valid loss  3.77 | valid ppl    43.31 | valid bpc    5.437
-----------------------------------------------------------------------------------------
PROGRESS: 85.0%
| epoch  86 |   100/  269 batches | lr 0.00000 | ms/batch 256.88 | loss  2.74 | ppl    15.53 
| epoch  86 |   200/  269 batches | lr 0.00000 | ms/batch 236.13 | loss  2.73 | ppl    15.32 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 66.68s | valid loss  3.72 | valid ppl    41.37 | valid bpc    5.370
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  269 batches | lr 0.00000 | ms/batch 257.93 | loss  2.74 | ppl    15.51 
| epoch  87 |   200/  269 batches | lr 0.00000 | ms/batch 235.70 | loss  2.72 | ppl    15.18 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 66.73s | valid loss  3.72 | valid ppl    41.36 | valid bpc    5.370
-----------------------------------------------------------------------------------------
PROGRESS: 87.0%
| epoch  88 |   100/  269 batches | lr 0.00000 | ms/batch 256.68 | loss  2.74 | ppl    15.44 
| epoch  88 |   200/  269 batches | lr 0.00000 | ms/batch 235.15 | loss  2.72 | ppl    15.13 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 66.68s | valid loss  3.71 | valid ppl    40.65 | valid bpc    5.345
-----------------------------------------------------------------------------------------
PROGRESS: 88.0%
| epoch  89 |   100/  269 batches | lr 0.00000 | ms/batch 253.44 | loss  2.76 | ppl    15.82 
| epoch  89 |   200/  269 batches | lr 0.00000 | ms/batch 239.20 | loss  2.73 | ppl    15.27 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 66.75s | valid loss  3.72 | valid ppl    41.38 | valid bpc    5.371
-----------------------------------------------------------------------------------------
PROGRESS: 89.0%
| epoch  90 |   100/  269 batches | lr 0.00000 | ms/batch 251.73 | loss  2.75 | ppl    15.66 
| epoch  90 |   200/  269 batches | lr 0.00000 | ms/batch 241.40 | loss  2.71 | ppl    14.99 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 66.71s | valid loss  3.77 | valid ppl    43.35 | valid bpc    5.438
-----------------------------------------------------------------------------------------
PROGRESS: 90.0%
| epoch  91 |   100/  269 batches | lr 0.00000 | ms/batch 239.21 | loss  2.75 | ppl    15.66 
| epoch  91 |   200/  269 batches | lr 0.00000 | ms/batch 169.94 | loss  2.72 | ppl    15.11 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 53.29s | valid loss  3.69 | valid ppl    40.07 | valid bpc    5.325
-----------------------------------------------------------------------------------------
PROGRESS: 91.0%
| epoch  92 |   100/  269 batches | lr 0.00000 | ms/batch 179.80 | loss  2.75 | ppl    15.67 
| epoch  92 |   200/  269 batches | lr 0.00000 | ms/batch 167.27 | loss  2.72 | ppl    15.15 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 46.61s | valid loss  3.70 | valid ppl    40.56 | valid bpc    5.342
-----------------------------------------------------------------------------------------
PROGRESS: 92.0%
| epoch  93 |   100/  269 batches | lr 0.00000 | ms/batch 169.24 | loss  2.76 | ppl    15.75 
| epoch  93 |   200/  269 batches | lr 0.00000 | ms/batch 168.65 | loss  2.73 | ppl    15.32 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 51.64s | valid loss  3.70 | valid ppl    40.65 | valid bpc    5.345
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  269 batches | lr 0.00000 | ms/batch 256.31 | loss  2.75 | ppl    15.57 
| epoch  94 |   200/  269 batches | lr 0.00000 | ms/batch 227.66 | loss  2.71 | ppl    15.02 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 66.38s | valid loss  3.69 | valid ppl    40.19 | valid bpc    5.329
-----------------------------------------------------------------------------------------
PROGRESS: 94.0%
| epoch  95 |   100/  269 batches | lr 0.00000 | ms/batch 256.18 | loss  2.76 | ppl    15.86 
| epoch  95 |   200/  269 batches | lr 0.00000 | ms/batch 228.02 | loss  2.73 | ppl    15.38 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 66.36s | valid loss  3.73 | valid ppl    41.75 | valid bpc    5.384
-----------------------------------------------------------------------------------------
PROGRESS: 95.0%
| epoch  96 |   100/  269 batches | lr 0.00000 | ms/batch 258.39 | loss  2.77 | ppl    15.93 
| epoch  96 |   200/  269 batches | lr 0.00000 | ms/batch 226.05 | loss  2.72 | ppl    15.14 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 66.40s | valid loss  3.74 | valid ppl    41.90 | valid bpc    5.389
-----------------------------------------------------------------------------------------
PROGRESS: 96.0%
| epoch  97 |   100/  269 batches | lr 0.00000 | ms/batch 257.74 | loss  2.74 | ppl    15.55 
| epoch  97 |   200/  269 batches | lr 0.00000 | ms/batch 227.23 | loss  2.72 | ppl    15.15 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 66.35s | valid loss  3.72 | valid ppl    41.30 | valid bpc    5.368
-----------------------------------------------------------------------------------------
PROGRESS: 97.0%
| epoch  98 |   100/  269 batches | lr 0.00000 | ms/batch 257.02 | loss  2.76 | ppl    15.75 
| epoch  98 |   200/  269 batches | lr 0.00000 | ms/batch 225.87 | loss  2.73 | ppl    15.37 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 66.36s | valid loss  3.70 | valid ppl    40.41 | valid bpc    5.337
-----------------------------------------------------------------------------------------
PROGRESS: 98.0%
| epoch  99 |   100/  269 batches | lr 0.00000 | ms/batch 257.42 | loss  2.77 | ppl    15.94 
| epoch  99 |   200/  269 batches | lr 0.00000 | ms/batch 226.61 | loss  2.72 | ppl    15.18 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 66.39s | valid loss  3.80 | valid ppl    44.82 | valid bpc    5.486
-----------------------------------------------------------------------------------------
PROGRESS: 99.0%
| epoch 100 |   100/  269 batches | lr 0.00000 | ms/batch 256.31 | loss  2.76 | ppl    15.76 
| epoch 100 |   200/  269 batches | lr 0.00000 | ms/batch 214.33 | loss  2.70 | ppl    14.91 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 59.99s | valid loss  3.71 | valid ppl    40.83 | valid bpc    5.351
-----------------------------------------------------------------------------------------
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  3.82 | test ppl    45.65 | test bpc    5.513
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.3166, Mean Reca: 0.4463, Mean F1: 0.3671, Mean Subword_Reca: 0.5850
-----------------------------------------------------------------------------------------
=========================================================================================
Loading dataset...
Using subword tokenizer...
Number of tokens:  8000
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer_in_parser', nhid=512, nlayers=8, front_layers=2, rear_layers=6, subword='omarmomen/ptb_filtered_lowcase_bpe_tokenizer_8', n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=4444, nonmono=5, cuda=True, log_interval=100, save='trained_models/subword_structformer_in_parser_4444_26.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 37449124
Model architecture: StructFormer_In_Parser(
  (transformer_front): Transformer_Front(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(8000, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-1): 2 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
  (transformer_rear): Transformer_Rear(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(8000, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-5): 6 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (output_layer): Linear(in_features=512, out_features=8000, bias=True)
  )
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  269 batches | lr 0.00030 | ms/batch 254.29 | loss  7.75 | ppl  2322.74 
| epoch   1 |   200/  269 batches | lr 0.00030 | ms/batch 242.49 | loss  7.34 | ppl  1541.51 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 66.78s | valid loss  7.03 | valid ppl  1125.34 | valid bpc   10.136
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  269 batches | lr 0.00030 | ms/batch 247.06 | loss  7.23 | ppl  1386.69 
| epoch   2 |   200/  269 batches | lr 0.00030 | ms/batch 242.08 | loss  7.03 | ppl  1134.78 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 65.95s | valid loss  6.73 | valid ppl   837.62 | valid bpc    9.710
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  269 batches | lr 0.00030 | ms/batch 246.60 | loss  6.91 | ppl  1004.62 
| epoch   3 |   200/  269 batches | lr 0.00030 | ms/batch 242.02 | loss  6.71 | ppl   824.51 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 65.94s | valid loss  6.32 | valid ppl   557.30 | valid bpc    9.122
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  269 batches | lr 0.00030 | ms/batch 247.58 | loss  6.50 | ppl   662.35 
| epoch   4 |   200/  269 batches | lr 0.00030 | ms/batch 239.74 | loss  6.26 | ppl   523.20 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 65.91s | valid loss  5.89 | valid ppl   361.06 | valid bpc    8.496
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  269 batches | lr 0.00030 | ms/batch 248.26 | loss  6.07 | ppl   431.24 
| epoch   5 |   200/  269 batches | lr 0.00030 | ms/batch 237.93 | loss  5.89 | ppl   360.58 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 66.07s | valid loss  5.58 | valid ppl   265.42 | valid bpc    8.052
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  269 batches | lr 0.00030 | ms/batch 246.49 | loss  5.77 | ppl   320.70 
| epoch   6 |   200/  269 batches | lr 0.00030 | ms/batch 235.81 | loss  5.67 | ppl   289.18 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 65.93s | valid loss  5.42 | valid ppl   225.35 | valid bpc    7.816
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  269 batches | lr 0.00030 | ms/batch 245.20 | loss  5.56 | ppl   260.66 
| epoch   7 |   200/  269 batches | lr 0.00030 | ms/batch 233.21 | loss  5.48 | ppl   239.93 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 65.77s | valid loss  5.24 | valid ppl   188.40 | valid bpc    7.558
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  269 batches | lr 0.00030 | ms/batch 250.68 | loss  5.40 | ppl   220.79 
| epoch   8 |   200/  269 batches | lr 0.00030 | ms/batch 233.08 | loss  5.28 | ppl   196.70 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 65.82s | valid loss  5.05 | valid ppl   156.15 | valid bpc    7.287
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 8.0%
| epoch   9 |   100/  269 batches | lr 0.00030 | ms/batch 257.32 | loss  5.25 | ppl   190.72 
| epoch   9 |   200/  269 batches | lr 0.00030 | ms/batch 232.44 | loss  5.19 | ppl   178.98 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 66.00s | valid loss  4.95 | valid ppl   141.87 | valid bpc    7.148
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  269 batches | lr 0.00030 | ms/batch 257.48 | loss  5.11 | ppl   166.46 
| epoch  10 |   200/  269 batches | lr 0.00030 | ms/batch 233.72 | loss  5.03 | ppl   152.29 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 66.42s | valid loss  4.89 | valid ppl   133.49 | valid bpc    7.061
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  269 batches | lr 0.00030 | ms/batch 257.42 | loss  5.01 | ppl   150.63 
| epoch  11 |   200/  269 batches | lr 0.00030 | ms/batch 232.25 | loss  4.91 | ppl   135.43 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 66.01s | valid loss  4.75 | valid ppl   115.11 | valid bpc    6.847
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  269 batches | lr 0.00030 | ms/batch 257.87 | loss  4.89 | ppl   133.61 
| epoch  12 |   200/  269 batches | lr 0.00030 | ms/batch 232.69 | loss  4.83 | ppl   125.51 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 65.99s | valid loss  4.72 | valid ppl   112.09 | valid bpc    6.809
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 12.0%
| epoch  13 |   100/  269 batches | lr 0.00030 | ms/batch 257.22 | loss  4.77 | ppl   118.10 
| epoch  13 |   200/  269 batches | lr 0.00030 | ms/batch 227.76 | loss  4.70 | ppl   109.42 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 66.32s | valid loss  4.56 | valid ppl    96.02 | valid bpc    6.585
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 13.0%
| epoch  14 |   100/  269 batches | lr 0.00030 | ms/batch 257.87 | loss  4.70 | ppl   110.23 
| epoch  14 |   200/  269 batches | lr 0.00030 | ms/batch 226.92 | loss  4.60 | ppl    99.75 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 66.39s | valid loss  4.51 | valid ppl    90.59 | valid bpc    6.501
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  269 batches | lr 0.00030 | ms/batch 255.76 | loss  4.56 | ppl    95.19 
| epoch  15 |   200/  269 batches | lr 0.00030 | ms/batch 215.98 | loss  4.55 | ppl    94.73 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 65.27s | valid loss  4.45 | valid ppl    85.20 | valid bpc    6.413
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 15.0%
| epoch  16 |   100/  269 batches | lr 0.00030 | ms/batch 256.26 | loss  4.49 | ppl    89.50 
| epoch  16 |   200/  269 batches | lr 0.00030 | ms/batch 208.12 | loss  4.45 | ppl    85.75 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 64.46s | valid loss  4.41 | valid ppl    82.53 | valid bpc    6.367
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 16.0%
| epoch  17 |   100/  269 batches | lr 0.00030 | ms/batch 256.99 | loss  4.42 | ppl    83.22 
| epoch  17 |   200/  269 batches | lr 0.00030 | ms/batch 227.52 | loss  4.36 | ppl    78.37 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 66.38s | valid loss  4.33 | valid ppl    75.74 | valid bpc    6.243
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 17.0%
| epoch  18 |   100/  269 batches | lr 0.00030 | ms/batch 256.53 | loss  4.34 | ppl    76.36 
| epoch  18 |   200/  269 batches | lr 0.00030 | ms/batch 224.06 | loss  4.31 | ppl    74.73 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 66.01s | valid loss  4.26 | valid ppl    70.79 | valid bpc    6.146
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 18.0%
| epoch  19 |   100/  269 batches | lr 0.00030 | ms/batch 257.82 | loss  4.29 | ppl    73.01 
| epoch  19 |   200/  269 batches | lr 0.00030 | ms/batch 222.71 | loss  4.24 | ppl    69.64 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 66.03s | valid loss  4.23 | valid ppl    69.02 | valid bpc    6.109
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 19.0%
| epoch  20 |   100/  269 batches | lr 0.00030 | ms/batch 256.66 | loss  4.20 | ppl    66.54 
| epoch  20 |   200/  269 batches | lr 0.00030 | ms/batch 224.23 | loss  4.15 | ppl    63.44 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 65.97s | valid loss  4.15 | valid ppl    63.60 | valid bpc    5.991
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 20.0%
| epoch  21 |   100/  269 batches | lr 0.00030 | ms/batch 255.86 | loss  4.13 | ppl    61.89 
| epoch  21 |   200/  269 batches | lr 0.00030 | ms/batch 224.21 | loss  4.11 | ppl    60.98 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 66.06s | valid loss  4.21 | valid ppl    67.46 | valid bpc    6.076
-----------------------------------------------------------------------------------------
PROGRESS: 21.0%
| epoch  22 |   100/  269 batches | lr 0.00030 | ms/batch 253.15 | loss  4.06 | ppl    58.18 
| epoch  22 |   200/  269 batches | lr 0.00030 | ms/batch 227.31 | loss  4.06 | ppl    57.71 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 65.98s | valid loss  4.09 | valid ppl    59.87 | valid bpc    5.904
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 22.0%
| epoch  23 |   100/  269 batches | lr 0.00030 | ms/batch 252.30 | loss  4.01 | ppl    55.34 
| epoch  23 |   200/  269 batches | lr 0.00030 | ms/batch 232.53 | loss  3.99 | ppl    54.03 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 66.42s | valid loss  4.11 | valid ppl    60.83 | valid bpc    5.927
-----------------------------------------------------------------------------------------
PROGRESS: 23.0%
| epoch  24 |   100/  269 batches | lr 0.00030 | ms/batch 249.63 | loss  3.96 | ppl    52.43 
| epoch  24 |   200/  269 batches | lr 0.00030 | ms/batch 237.45 | loss  3.94 | ppl    51.59 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 66.71s | valid loss  4.07 | valid ppl    58.56 | valid bpc    5.872
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 24.0%
| epoch  25 |   100/  269 batches | lr 0.00030 | ms/batch 250.17 | loss  3.89 | ppl    48.89 
| epoch  25 |   200/  269 batches | lr 0.00030 | ms/batch 233.39 | loss  3.89 | ppl    49.03 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 66.32s | valid loss  4.01 | valid ppl    55.36 | valid bpc    5.791
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 25.0%
| epoch  26 |   100/  269 batches | lr 0.00030 | ms/batch 247.58 | loss  3.87 | ppl    48.16 
| epoch  26 |   200/  269 batches | lr 0.00030 | ms/batch 236.52 | loss  3.84 | ppl    46.47 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 66.33s | valid loss  3.99 | valid ppl    54.11 | valid bpc    5.758
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 26.0%
| epoch  27 |   100/  269 batches | lr 0.00030 | ms/batch 250.45 | loss  3.80 | ppl    44.51 
| epoch  27 |   200/  269 batches | lr 0.00030 | ms/batch 233.88 | loss  3.81 | ppl    45.32 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 66.36s | valid loss  4.00 | valid ppl    54.82 | valid bpc    5.777
-----------------------------------------------------------------------------------------
PROGRESS: 27.0%
| epoch  28 |   100/  269 batches | lr 0.00030 | ms/batch 246.60 | loss  3.77 | ppl    43.24 
| epoch  28 |   200/  269 batches | lr 0.00030 | ms/batch 238.17 | loss  3.74 | ppl    42.26 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 66.41s | valid loss  3.98 | valid ppl    53.52 | valid bpc    5.742
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  269 batches | lr 0.00030 | ms/batch 249.63 | loss  3.71 | ppl    40.79 
| epoch  29 |   200/  269 batches | lr 0.00030 | ms/batch 233.44 | loss  3.70 | ppl    40.42 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 66.34s | valid loss  3.95 | valid ppl    52.05 | valid bpc    5.702
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  269 batches | lr 0.00030 | ms/batch 247.92 | loss  3.69 | ppl    40.15 
| epoch  30 |   200/  269 batches | lr 0.00030 | ms/batch 235.13 | loss  3.66 | ppl    39.00 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 65.73s | valid loss  3.95 | valid ppl    52.13 | valid bpc    5.704
-----------------------------------------------------------------------------------------
PROGRESS: 30.0%
| epoch  31 |   100/  269 batches | lr 0.00030 | ms/batch 256.78 | loss  3.64 | ppl    38.18 
| epoch  31 |   200/  269 batches | lr 0.00030 | ms/batch 232.69 | loss  3.62 | ppl    37.44 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 65.91s | valid loss  3.93 | valid ppl    51.05 | valid bpc    5.674
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 31.0%
| epoch  32 |   100/  269 batches | lr 0.00030 | ms/batch 257.32 | loss  3.60 | ppl    36.57 
| epoch  32 |   200/  269 batches | lr 0.00030 | ms/batch 232.78 | loss  3.57 | ppl    35.50 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 66.31s | valid loss  3.91 | valid ppl    50.11 | valid bpc    5.647
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 32.0%
| epoch  33 |   100/  269 batches | lr 0.00030 | ms/batch 257.40 | loss  3.56 | ppl    35.24 
| epoch  33 |   200/  269 batches | lr 0.00030 | ms/batch 232.63 | loss  3.56 | ppl    35.04 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 66.35s | valid loss  3.84 | valid ppl    46.57 | valid bpc    5.541
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 33.0%
| epoch  34 |   100/  269 batches | lr 0.00030 | ms/batch 256.43 | loss  3.56 | ppl    35.08 
| epoch  34 |   200/  269 batches | lr 0.00030 | ms/batch 237.61 | loss  3.51 | ppl    33.61 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 66.76s | valid loss  3.92 | valid ppl    50.56 | valid bpc    5.660
-----------------------------------------------------------------------------------------
PROGRESS: 34.0%
| epoch  35 |   100/  269 batches | lr 0.00030 | ms/batch 258.63 | loss  3.51 | ppl    33.35 
| epoch  35 |   200/  269 batches | lr 0.00030 | ms/batch 235.37 | loss  3.47 | ppl    32.07 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 66.79s | valid loss  3.90 | valid ppl    49.32 | valid bpc    5.624
-----------------------------------------------------------------------------------------
PROGRESS: 35.0%
| epoch  36 |   100/  269 batches | lr 0.00030 | ms/batch 257.58 | loss  3.46 | ppl    31.87 
| epoch  36 |   200/  269 batches | lr 0.00030 | ms/batch 227.73 | loss  3.45 | ppl    31.60 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 66.39s | valid loss  3.86 | valid ppl    47.40 | valid bpc    5.567
-----------------------------------------------------------------------------------------
PROGRESS: 36.0%
| epoch  37 |   100/  269 batches | lr 0.00015 | ms/batch 256.09 | loss  3.38 | ppl    29.25 
| epoch  37 |   200/  269 batches | lr 0.00015 | ms/batch 229.60 | loss  3.35 | ppl    28.47 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 66.37s | valid loss  3.83 | valid ppl    45.96 | valid bpc    5.522
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 37.0%
| epoch  38 |   100/  269 batches | lr 0.00015 | ms/batch 254.25 | loss  3.31 | ppl    27.32 
| epoch  38 |   200/  269 batches | lr 0.00015 | ms/batch 235.45 | loss  3.30 | ppl    27.15 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 66.77s | valid loss  3.78 | valid ppl    43.86 | valid bpc    5.455
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 38.0%
| epoch  39 |   100/  269 batches | lr 0.00015 | ms/batch 250.76 | loss  3.27 | ppl    26.23 
| epoch  39 |   200/  269 batches | lr 0.00015 | ms/batch 237.06 | loss  3.28 | ppl    26.46 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 66.73s | valid loss  3.86 | valid ppl    47.43 | valid bpc    5.568
-----------------------------------------------------------------------------------------
PROGRESS: 39.0%
| epoch  40 |   100/  269 batches | lr 0.00015 | ms/batch 249.34 | loss  3.26 | ppl    26.14 
| epoch  40 |   200/  269 batches | lr 0.00015 | ms/batch 235.95 | loss  3.23 | ppl    25.39 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 66.41s | valid loss  3.83 | valid ppl    45.99 | valid bpc    5.523
-----------------------------------------------------------------------------------------
PROGRESS: 40.0%
| epoch  41 |   100/  269 batches | lr 0.00015 | ms/batch 250.99 | loss  3.24 | ppl    25.66 
| epoch  41 |   200/  269 batches | lr 0.00015 | ms/batch 236.25 | loss  3.23 | ppl    25.21 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 66.73s | valid loss  3.82 | valid ppl    45.58 | valid bpc    5.510
-----------------------------------------------------------------------------------------
PROGRESS: 41.0%
| epoch  42 |   100/  269 batches | lr 0.00007 | ms/batch 247.35 | loss  3.20 | ppl    24.50 
| epoch  42 |   200/  269 batches | lr 0.00007 | ms/batch 234.48 | loss  3.14 | ppl    23.19 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 66.03s | valid loss  3.77 | valid ppl    43.32 | valid bpc    5.437
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 42.0%
| epoch  43 |   100/  269 batches | lr 0.00007 | ms/batch 250.31 | loss  3.15 | ppl    23.36 
| epoch  43 |   200/  269 batches | lr 0.00007 | ms/batch 237.06 | loss  3.14 | ppl    23.04 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 66.76s | valid loss  3.77 | valid ppl    43.47 | valid bpc    5.442
-----------------------------------------------------------------------------------------
PROGRESS: 43.0%
| epoch  44 |   100/  269 batches | lr 0.00007 | ms/batch 245.01 | loss  3.15 | ppl    23.39 
| epoch  44 |   200/  269 batches | lr 0.00007 | ms/batch 241.76 | loss  3.12 | ppl    22.67 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 66.68s | valid loss  3.72 | valid ppl    41.35 | valid bpc    5.370
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 44.0%
| epoch  45 |   100/  269 batches | lr 0.00007 | ms/batch 240.56 | loss  3.13 | ppl    22.77 
| epoch  45 |   200/  269 batches | lr 0.00007 | ms/batch 241.86 | loss  3.10 | ppl    22.22 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 66.23s | valid loss  3.71 | valid ppl    40.73 | valid bpc    5.348
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 45.0%
| epoch  46 |   100/  269 batches | lr 0.00007 | ms/batch 245.62 | loss  3.12 | ppl    22.57 
| epoch  46 |   200/  269 batches | lr 0.00007 | ms/batch 241.36 | loss  3.08 | ppl    21.86 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 66.69s | valid loss  3.78 | valid ppl    43.79 | valid bpc    5.452
-----------------------------------------------------------------------------------------
PROGRESS: 46.0%
| epoch  47 |   100/  269 batches | lr 0.00007 | ms/batch 245.48 | loss  3.08 | ppl    21.82 
| epoch  47 |   200/  269 batches | lr 0.00007 | ms/batch 241.75 | loss  3.08 | ppl    21.72 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 66.80s | valid loss  3.74 | valid ppl    42.12 | valid bpc    5.396
-----------------------------------------------------------------------------------------
PROGRESS: 47.0%
| epoch  48 |   100/  269 batches | lr 0.00007 | ms/batch 244.94 | loss  3.09 | ppl    22.03 
| epoch  48 |   200/  269 batches | lr 0.00007 | ms/batch 241.76 | loss  3.07 | ppl    21.63 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 66.69s | valid loss  3.79 | valid ppl    44.17 | valid bpc    5.465
-----------------------------------------------------------------------------------------
PROGRESS: 48.0%
| epoch  49 |   100/  269 batches | lr 0.00004 | ms/batch 237.56 | loss  3.08 | ppl    21.67 
| epoch  49 |   200/  269 batches | lr 0.00004 | ms/batch 242.93 | loss  3.04 | ppl    20.89 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 66.03s | valid loss  3.76 | valid ppl    43.14 | valid bpc    5.431
-----------------------------------------------------------------------------------------
PROGRESS: 49.0%
| epoch  50 |   100/  269 batches | lr 0.00004 | ms/batch 241.64 | loss  3.07 | ppl    21.58 
| epoch  50 |   200/  269 batches | lr 0.00004 | ms/batch 243.08 | loss  3.02 | ppl    20.57 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 66.38s | valid loss  3.76 | valid ppl    43.08 | valid bpc    5.429
-----------------------------------------------------------------------------------------
PROGRESS: 50.0%
| epoch  51 |   100/  269 batches | lr 0.00004 | ms/batch 241.70 | loss  3.03 | ppl    20.79 
| epoch  51 |   200/  269 batches | lr 0.00004 | ms/batch 241.60 | loss  3.01 | ppl    20.38 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 66.30s | valid loss  3.71 | valid ppl    41.05 | valid bpc    5.359
-----------------------------------------------------------------------------------------
PROGRESS: 51.0%
| epoch  52 |   100/  269 batches | lr 0.00002 | ms/batch 245.16 | loss  3.03 | ppl    20.62 
| epoch  52 |   200/  269 batches | lr 0.00002 | ms/batch 243.12 | loss  3.02 | ppl    20.39 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 66.26s | valid loss  3.68 | valid ppl    39.78 | valid bpc    5.314
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 52.0%
| epoch  53 |   100/  269 batches | lr 0.00002 | ms/batch 249.77 | loss  3.03 | ppl    20.69 
| epoch  53 |   200/  269 batches | lr 0.00002 | ms/batch 244.85 | loss  2.99 | ppl    19.88 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 66.81s | valid loss  3.75 | valid ppl    42.44 | valid bpc    5.407
-----------------------------------------------------------------------------------------
PROGRESS: 53.0%
| epoch  54 |   100/  269 batches | lr 0.00002 | ms/batch 249.94 | loss  3.01 | ppl    20.22 
| epoch  54 |   200/  269 batches | lr 0.00002 | ms/batch 243.69 | loss  2.98 | ppl    19.64 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 66.77s | valid loss  3.70 | valid ppl    40.62 | valid bpc    5.344
-----------------------------------------------------------------------------------------
PROGRESS: 54.0%
| epoch  55 |   100/  269 batches | lr 0.00002 | ms/batch 249.82 | loss  3.00 | ppl    20.15 
| epoch  55 |   200/  269 batches | lr 0.00002 | ms/batch 242.85 | loss  3.00 | ppl    20.05 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 66.70s | valid loss  3.68 | valid ppl    39.82 | valid bpc    5.315
-----------------------------------------------------------------------------------------
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  269 batches | lr 0.00001 | ms/batch 249.70 | loss  3.01 | ppl    20.27 
| epoch  56 |   200/  269 batches | lr 0.00001 | ms/batch 243.15 | loss  2.97 | ppl    19.40 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 66.65s | valid loss  3.67 | valid ppl    39.13 | valid bpc    5.290
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  269 batches | lr 0.00001 | ms/batch 250.93 | loss  3.02 | ppl    20.51 
| epoch  57 |   200/  269 batches | lr 0.00001 | ms/batch 241.56 | loss  2.97 | ppl    19.48 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 66.75s | valid loss  3.70 | valid ppl    40.46 | valid bpc    5.339
-----------------------------------------------------------------------------------------
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  269 batches | lr 0.00001 | ms/batch 250.83 | loss  3.01 | ppl    20.31 
| epoch  58 |   200/  269 batches | lr 0.00001 | ms/batch 237.71 | loss  2.97 | ppl    19.52 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 66.74s | valid loss  3.71 | valid ppl    41.02 | valid bpc    5.358
-----------------------------------------------------------------------------------------
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  269 batches | lr 0.00001 | ms/batch 252.54 | loss  2.99 | ppl    19.90 
| epoch  59 |   200/  269 batches | lr 0.00001 | ms/batch 235.54 | loss  2.96 | ppl    19.37 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 66.74s | valid loss  3.67 | valid ppl    39.21 | valid bpc    5.293
-----------------------------------------------------------------------------------------
PROGRESS: 59.0%
| epoch  60 |   100/  269 batches | lr 0.00000 | ms/batch 249.54 | loss  2.99 | ppl    19.79 
| epoch  60 |   200/  269 batches | lr 0.00000 | ms/batch 237.71 | loss  2.97 | ppl    19.42 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 66.71s | valid loss  3.71 | valid ppl    40.92 | valid bpc    5.355
-----------------------------------------------------------------------------------------
PROGRESS: 60.0%
| epoch  61 |   100/  269 batches | lr 0.00000 | ms/batch 251.54 | loss  2.97 | ppl    19.55 
| epoch  61 |   200/  269 batches | lr 0.00000 | ms/batch 237.60 | loss  2.98 | ppl    19.69 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 66.84s | valid loss  3.73 | valid ppl    41.64 | valid bpc    5.380
-----------------------------------------------------------------------------------------
PROGRESS: 61.0%
| epoch  62 |   100/  269 batches | lr 0.00000 | ms/batch 250.34 | loss  3.00 | ppl    20.06 
| epoch  62 |   200/  269 batches | lr 0.00000 | ms/batch 234.09 | loss  2.97 | ppl    19.46 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 66.36s | valid loss  3.75 | valid ppl    42.45 | valid bpc    5.408
-----------------------------------------------------------------------------------------
PROGRESS: 62.0%
| epoch  63 |   100/  269 batches | lr 0.00000 | ms/batch 248.93 | loss  2.99 | ppl    19.84 
| epoch  63 |   200/  269 batches | lr 0.00000 | ms/batch 232.95 | loss  2.94 | ppl    18.99 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 66.04s | valid loss  3.68 | valid ppl    39.83 | valid bpc    5.316
-----------------------------------------------------------------------------------------
PROGRESS: 63.0%
| epoch  64 |   100/  269 batches | lr 0.00000 | ms/batch 250.07 | loss  2.99 | ppl    19.88 
| epoch  64 |   200/  269 batches | lr 0.00000 | ms/batch 236.47 | loss  2.96 | ppl    19.20 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 66.69s | valid loss  3.66 | valid ppl    38.81 | valid bpc    5.278
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 64.0%
| epoch  65 |   100/  269 batches | lr 0.00000 | ms/batch 250.97 | loss  2.95 | ppl    19.17 
| epoch  65 |   200/  269 batches | lr 0.00000 | ms/batch 237.04 | loss  2.96 | ppl    19.28 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 66.74s | valid loss  3.71 | valid ppl    41.03 | valid bpc    5.359
-----------------------------------------------------------------------------------------
PROGRESS: 65.0%
| epoch  66 |   100/  269 batches | lr 0.00000 | ms/batch 248.84 | loss  2.98 | ppl    19.77 
| epoch  66 |   200/  269 batches | lr 0.00000 | ms/batch 239.46 | loss  2.95 | ppl    19.11 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 66.61s | valid loss  3.76 | valid ppl    42.86 | valid bpc    5.422
-----------------------------------------------------------------------------------------
PROGRESS: 66.0%
| epoch  67 |   100/  269 batches | lr 0.00000 | ms/batch 244.25 | loss  2.99 | ppl    19.96 
| epoch  67 |   200/  269 batches | lr 0.00000 | ms/batch 243.07 | loss  2.96 | ppl    19.35 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 66.76s | valid loss  3.75 | valid ppl    42.42 | valid bpc    5.407
-----------------------------------------------------------------------------------------
PROGRESS: 67.0%
| epoch  68 |   100/  269 batches | lr 0.00000 | ms/batch 244.98 | loss  2.98 | ppl    19.68 
| epoch  68 |   200/  269 batches | lr 0.00000 | ms/batch 240.98 | loss  2.97 | ppl    19.49 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 66.65s | valid loss  3.69 | valid ppl    39.99 | valid bpc    5.322
-----------------------------------------------------------------------------------------
PROGRESS: 68.0%
| epoch  69 |   100/  269 batches | lr 0.00000 | ms/batch 238.01 | loss  2.98 | ppl    19.69 
| epoch  69 |   200/  269 batches | lr 0.00000 | ms/batch 244.46 | loss  2.95 | ppl    19.11 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 66.16s | valid loss  3.70 | valid ppl    40.64 | valid bpc    5.345
-----------------------------------------------------------------------------------------
PROGRESS: 69.0%
| epoch  70 |   100/  269 batches | lr 0.00000 | ms/batch 246.13 | loss  3.00 | ppl    20.01 
| epoch  70 |   200/  269 batches | lr 0.00000 | ms/batch 242.27 | loss  2.94 | ppl    18.96 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 66.73s | valid loss  3.74 | valid ppl    42.22 | valid bpc    5.400
-----------------------------------------------------------------------------------------
PROGRESS: 70.0%
| epoch  71 |   100/  269 batches | lr 0.00000 | ms/batch 243.73 | loss  2.99 | ppl    19.96 
| epoch  71 |   200/  269 batches | lr 0.00000 | ms/batch 243.04 | loss  2.93 | ppl    18.73 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 66.71s | valid loss  3.70 | valid ppl    40.43 | valid bpc    5.337
-----------------------------------------------------------------------------------------
PROGRESS: 71.0%
| epoch  72 |   100/  269 batches | lr 0.00000 | ms/batch 245.46 | loss  2.97 | ppl    19.44 
| epoch  72 |   200/  269 batches | lr 0.00000 | ms/batch 242.60 | loss  2.95 | ppl    19.05 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 66.50s | valid loss  3.73 | valid ppl    41.56 | valid bpc    5.377
-----------------------------------------------------------------------------------------
PROGRESS: 72.0%
| epoch  73 |   100/  269 batches | lr 0.00000 | ms/batch 247.84 | loss  2.98 | ppl    19.71 
| epoch  73 |   200/  269 batches | lr 0.00000 | ms/batch 243.50 | loss  2.94 | ppl    18.87 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 66.54s | valid loss  3.77 | valid ppl    43.35 | valid bpc    5.438
-----------------------------------------------------------------------------------------
PROGRESS: 73.0%
| epoch  74 |   100/  269 batches | lr 0.00000 | ms/batch 249.47 | loss  2.98 | ppl    19.62 
| epoch  74 |   200/  269 batches | lr 0.00000 | ms/batch 242.86 | loss  2.95 | ppl    19.08 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 66.68s | valid loss  3.69 | valid ppl    39.98 | valid bpc    5.321
-----------------------------------------------------------------------------------------
PROGRESS: 74.0%
| epoch  75 |   100/  269 batches | lr 0.00000 | ms/batch 250.47 | loss  2.98 | ppl    19.60 
| epoch  75 |   200/  269 batches | lr 0.00000 | ms/batch 242.54 | loss  2.95 | ppl    19.08 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 66.18s | valid loss  3.71 | valid ppl    41.04 | valid bpc    5.359
-----------------------------------------------------------------------------------------
PROGRESS: 75.0%
| epoch  76 |   100/  269 batches | lr 0.00000 | ms/batch 256.57 | loss  2.97 | ppl    19.48 
| epoch  76 |   200/  269 batches | lr 0.00000 | ms/batch 243.19 | loss  2.95 | ppl    19.19 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 66.33s | valid loss  3.69 | valid ppl    39.85 | valid bpc    5.316
-----------------------------------------------------------------------------------------
PROGRESS: 76.0%
| epoch  77 |   100/  269 batches | lr 0.00000 | ms/batch 255.71 | loss  2.98 | ppl    19.74 
| epoch  77 |   200/  269 batches | lr 0.00000 | ms/batch 242.21 | loss  2.96 | ppl    19.38 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 66.71s | valid loss  3.69 | valid ppl    40.14 | valid bpc    5.327
-----------------------------------------------------------------------------------------
PROGRESS: 77.0%
| epoch  78 |   100/  269 batches | lr 0.00000 | ms/batch 255.98 | loss  2.98 | ppl    19.75 
| epoch  78 |   200/  269 batches | lr 0.00000 | ms/batch 242.85 | loss  2.94 | ppl    18.96 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 66.78s | valid loss  3.72 | valid ppl    41.19 | valid bpc    5.364
-----------------------------------------------------------------------------------------
PROGRESS: 78.0%
| epoch  79 |   100/  269 batches | lr 0.00000 | ms/batch 255.93 | loss  2.99 | ppl    19.94 
| epoch  79 |   200/  269 batches | lr 0.00000 | ms/batch 242.71 | loss  2.95 | ppl    19.03 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 66.71s | valid loss  3.71 | valid ppl    40.79 | valid bpc    5.350
-----------------------------------------------------------------------------------------
PROGRESS: 79.0%
| epoch  80 |   100/  269 batches | lr 0.00000 | ms/batch 257.00 | loss  2.98 | ppl    19.65 
| epoch  80 |   200/  269 batches | lr 0.00000 | ms/batch 241.53 | loss  2.95 | ppl    19.18 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 66.38s | valid loss  3.74 | valid ppl    42.11 | valid bpc    5.396
-----------------------------------------------------------------------------------------
PROGRESS: 80.0%
| epoch  81 |   100/  269 batches | lr 0.00000 | ms/batch 255.62 | loss  2.98 | ppl    19.75 
| epoch  81 |   200/  269 batches | lr 0.00000 | ms/batch 239.98 | loss  2.94 | ppl    19.01 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 66.73s | valid loss  3.70 | valid ppl    40.29 | valid bpc    5.332
-----------------------------------------------------------------------------------------
PROGRESS: 81.0%
| epoch  82 |   100/  269 batches | lr 0.00000 | ms/batch 256.39 | loss  2.98 | ppl    19.64 
| epoch  82 |   200/  269 batches | lr 0.00000 | ms/batch 236.80 | loss  2.96 | ppl    19.25 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 66.74s | valid loss  3.72 | valid ppl    41.19 | valid bpc    5.364
-----------------------------------------------------------------------------------------
PROGRESS: 82.0%
| epoch  83 |   100/  269 batches | lr 0.00000 | ms/batch 257.15 | loss  2.99 | ppl    19.83 
| epoch  83 |   200/  269 batches | lr 0.00000 | ms/batch 237.00 | loss  2.96 | ppl    19.21 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 66.74s | valid loss  3.71 | valid ppl    40.77 | valid bpc    5.350
-----------------------------------------------------------------------------------------
PROGRESS: 83.0%
| epoch  84 |   100/  269 batches | lr 0.00000 | ms/batch 257.12 | loss  2.99 | ppl    19.84 
| epoch  84 |   200/  269 batches | lr 0.00000 | ms/batch 236.84 | loss  2.94 | ppl    18.97 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 66.74s | valid loss  3.70 | valid ppl    40.55 | valid bpc    5.342
-----------------------------------------------------------------------------------------
PROGRESS: 84.0%
| epoch  85 |   100/  269 batches | lr 0.00000 | ms/batch 257.65 | loss  2.99 | ppl    19.84 
| epoch  85 |   200/  269 batches | lr 0.00000 | ms/batch 236.54 | loss  2.95 | ppl    19.12 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 66.73s | valid loss  3.70 | valid ppl    40.41 | valid bpc    5.336
-----------------------------------------------------------------------------------------
PROGRESS: 85.0%
| epoch  86 |   100/  269 batches | lr 0.00000 | ms/batch 256.67 | loss  2.97 | ppl    19.52 
| epoch  86 |   200/  269 batches | lr 0.00000 | ms/batch 202.09 | loss  2.95 | ppl    19.09 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 58.02s | valid loss  3.73 | valid ppl    41.81 | valid bpc    5.386
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  269 batches | lr 0.00000 | ms/batch 180.62 | loss  3.00 | ppl    20.05 
| epoch  87 |   200/  269 batches | lr 0.00000 | ms/batch 172.39 | loss  2.93 | ppl    18.75 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 47.26s | valid loss  3.76 | valid ppl    42.77 | valid bpc    5.418
-----------------------------------------------------------------------------------------
PROGRESS: 87.0%
| epoch  88 |   100/  269 batches | lr 0.00000 | ms/batch 168.23 | loss  2.99 | ppl    19.85 
| epoch  88 |   200/  269 batches | lr 0.00000 | ms/batch 161.15 | loss  2.96 | ppl    19.22 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 45.40s | valid loss  3.73 | valid ppl    41.87 | valid bpc    5.388
-----------------------------------------------------------------------------------------
PROGRESS: 88.0%
| epoch  89 |   100/  269 batches | lr 0.00000 | ms/batch 256.59 | loss  2.98 | ppl    19.63 
| epoch  89 |   200/  269 batches | lr 0.00000 | ms/batch 242.47 | loss  2.94 | ppl    18.91 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 66.42s | valid loss  3.76 | valid ppl    42.75 | valid bpc    5.418
-----------------------------------------------------------------------------------------
PROGRESS: 89.0%
| epoch  90 |   100/  269 batches | lr 0.00000 | ms/batch 257.40 | loss  2.98 | ppl    19.62 
| epoch  90 |   200/  269 batches | lr 0.00000 | ms/batch 241.57 | loss  2.95 | ppl    19.12 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 66.37s | valid loss  3.70 | valid ppl    40.58 | valid bpc    5.343
-----------------------------------------------------------------------------------------
PROGRESS: 90.0%
| epoch  91 |   100/  269 batches | lr 0.00000 | ms/batch 256.38 | loss  2.98 | ppl    19.74 
| epoch  91 |   200/  269 batches | lr 0.00000 | ms/batch 243.26 | loss  2.95 | ppl    19.14 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 66.46s | valid loss  3.68 | valid ppl    39.53 | valid bpc    5.305
-----------------------------------------------------------------------------------------
PROGRESS: 91.0%
| epoch  92 |   100/  269 batches | lr 0.00000 | ms/batch 255.60 | loss  2.99 | ppl    19.98 
| epoch  92 |   200/  269 batches | lr 0.00000 | ms/batch 243.84 | loss  2.95 | ppl    19.12 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 66.32s | valid loss  3.73 | valid ppl    41.84 | valid bpc    5.387
-----------------------------------------------------------------------------------------
PROGRESS: 92.0%
| epoch  93 |   100/  269 batches | lr 0.00000 | ms/batch 256.78 | loss  2.98 | ppl    19.70 
| epoch  93 |   200/  269 batches | lr 0.00000 | ms/batch 243.28 | loss  2.96 | ppl    19.22 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 66.19s | valid loss  3.73 | valid ppl    41.85 | valid bpc    5.387
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  269 batches | lr 0.00000 | ms/batch 255.52 | loss  2.98 | ppl    19.77 
| epoch  94 |   200/  269 batches | lr 0.00000 | ms/batch 243.65 | loss  2.93 | ppl    18.73 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 66.09s | valid loss  3.71 | valid ppl    41.03 | valid bpc    5.359
-----------------------------------------------------------------------------------------
PROGRESS: 94.0%
| epoch  95 |   100/  269 batches | lr 0.00000 | ms/batch 255.57 | loss  2.98 | ppl    19.70 
| epoch  95 |   200/  269 batches | lr 0.00000 | ms/batch 243.92 | loss  2.97 | ppl    19.51 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 66.09s | valid loss  3.75 | valid ppl    42.51 | valid bpc    5.410
-----------------------------------------------------------------------------------------
PROGRESS: 95.0%
| epoch  96 |   100/  269 batches | lr 0.00000 | ms/batch 258.07 | loss  2.98 | ppl    19.77 
| epoch  96 |   200/  269 batches | lr 0.00000 | ms/batch 240.36 | loss  2.95 | ppl    19.20 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 66.07s | valid loss  3.71 | valid ppl    40.67 | valid bpc    5.346
-----------------------------------------------------------------------------------------
PROGRESS: 96.0%
| epoch  97 |   100/  269 batches | lr 0.00000 | ms/batch 256.10 | loss  2.96 | ppl    19.29 
| epoch  97 |   200/  269 batches | lr 0.00000 | ms/batch 236.66 | loss  2.96 | ppl    19.23 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 66.24s | valid loss  3.72 | valid ppl    41.40 | valid bpc    5.371
-----------------------------------------------------------------------------------------
PROGRESS: 97.0%
| epoch  98 |   100/  269 batches | lr 0.00000 | ms/batch 257.16 | loss  2.97 | ppl    19.49 
| epoch  98 |   200/  269 batches | lr 0.00000 | ms/batch 229.46 | loss  2.94 | ppl    19.00 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 66.34s | valid loss  3.72 | valid ppl    41.14 | valid bpc    5.362
-----------------------------------------------------------------------------------------
PROGRESS: 98.0%
| epoch  99 |   100/  269 batches | lr 0.00000 | ms/batch 256.40 | loss  2.98 | ppl    19.59 
| epoch  99 |   200/  269 batches | lr 0.00000 | ms/batch 226.65 | loss  2.95 | ppl    19.14 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 61.45s | valid loss  3.65 | valid ppl    38.61 | valid bpc    5.271
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 99.0%
| epoch 100 |   100/  269 batches | lr 0.00000 | ms/batch 181.26 | loss  2.97 | ppl    19.58 
| epoch 100 |   200/  269 batches | lr 0.00000 | ms/batch 160.17 | loss  2.94 | ppl    18.93 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 46.97s | valid loss  3.70 | valid ppl    40.52 | valid bpc    5.341
-----------------------------------------------------------------------------------------
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  3.79 | test ppl    44.38 | test bpc    5.472
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.3759, Mean Reca: 0.5307, Mean F1: 0.4365, Mean Subword_Reca: 0.7833
-----------------------------------------------------------------------------------------
=========================================================================================
Loading dataset...
Using subword tokenizer...
Number of tokens:  8000
Args: Namespace(data='data/penn/', dict_thd=1, model='structformer_in_parser', nhid=512, nlayers=8, front_layers=2, rear_layers=6, subword='omarmomen/ptb_filtered_lowcase_bpe_tokenizer_8', n_parser_layers=3, nheads=8, conv_size=9, lr=0.0003, clip=0.25, epochs=100, batch_size=4096, dropout=0.1, dropatt=0, mask_rate=0.3, relative_bias=False, pos_emb=True, weight_act='softmax', relations='head,child', seed=5555, nonmono=5, cuda=True, log_interval=100, save='trained_models/subword_structformer_in_parser_5555_26.pt', wdecay=1.2e-06, resume='', test_grammar=True, tied=True)
Model total parameters: 37449124
Model architecture: StructFormer_In_Parser(
  (transformer_front): Transformer_Front(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(8000, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-1): 2 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
  (transformer_rear): Transformer_Rear(
    (drop): Dropout(p=0.1, inplace=False)
    (emb): Embedding(8000, 512)
    (pos_emb): Embedding(500, 512)
    (layers): ModuleList(
      (0-5): 6 x TransformerLayer(
        (self_attn): MultiheadAttention(
          (drop): Dropout(p=0, inplace=False)
          (q_proj): Linear(in_features=512, out_features=512, bias=True)
          (k_proj): Linear(in_features=512, out_features=512, bias=True)
          (v_proj): Linear(in_features=512, out_features=512, bias=True)
          (out_proj): Linear(in_features=512, out_features=512, bias=True)
        )
        (feedforward): Sequential(
          (0): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
          (1): Linear(in_features=512, out_features=2048, bias=True)
          (2): LeakyReLU(negative_slope=0.01)
          (3): Dropout(p=0.1, inplace=False)
          (4): Linear(in_features=2048, out_features=512, bias=True)
        )
        (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (dropout1): Dropout(p=0.1, inplace=False)
        (dropout2): Dropout(p=0.1, inplace=False)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (output_layer): Linear(in_features=512, out_features=8000, bias=True)
  )
  (parser_layers): ModuleList(
    (0-2): 3 x Sequential(
      (0): Conv1d(
        (conv): Conv1d(512, 512, kernel_size=(9,), stride=(1,), padding=(4,))
      )
      (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
      (2): Tanh()
    )
  )
  (distance_ff): Sequential(
    (0): Conv1d(
      (conv): Conv1d(512, 512, kernel_size=(2,), stride=(1,), padding=(1,))
    )
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
  (height_ff): Sequential(
    (0): Linear(in_features=512, out_features=512, bias=True)
    (1): LayerNorm((512,), eps=1e-05, elementwise_affine=False)
    (2): Tanh()
    (3): Linear(in_features=512, out_features=1, bias=True)
  )
)
| epoch   1 |   100/  269 batches | lr 0.00030 | ms/batch 246.86 | loss  7.74 | ppl  2298.91 
| epoch   1 |   200/  269 batches | lr 0.00030 | ms/batch 241.31 | loss  7.36 | ppl  1573.65 
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 66.73s | valid loss  7.13 | valid ppl  1254.64 | valid bpc   10.293
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 1.0%
| epoch   2 |   100/  269 batches | lr 0.00030 | ms/batch 238.78 | loss  7.33 | ppl  1529.05 
| epoch   2 |   200/  269 batches | lr 0.00030 | ms/batch 242.57 | loss  7.17 | ppl  1299.86 
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 66.00s | valid loss  6.95 | valid ppl  1042.04 | valid bpc   10.025
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 2.0%
| epoch   3 |   100/  269 batches | lr 0.00030 | ms/batch 243.11 | loss  7.12 | ppl  1232.17 
| epoch   3 |   200/  269 batches | lr 0.00030 | ms/batch 242.45 | loss  6.85 | ppl   944.08 
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 65.49s | valid loss  6.38 | valid ppl   590.78 | valid bpc    9.206
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 3.0%
| epoch   4 |   100/  269 batches | lr 0.00030 | ms/batch 246.76 | loss  6.50 | ppl   665.53 
| epoch   4 |   200/  269 batches | lr 0.00030 | ms/batch 243.22 | loss  6.23 | ppl   509.49 
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 66.03s | valid loss  5.91 | valid ppl   368.20 | valid bpc    8.524
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 4.0%
| epoch   5 |   100/  269 batches | lr 0.00030 | ms/batch 248.33 | loss  6.01 | ppl   406.40 
| epoch   5 |   200/  269 batches | lr 0.00030 | ms/batch 242.36 | loss  5.87 | ppl   354.46 
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 66.03s | valid loss  5.56 | valid ppl   258.87 | valid bpc    8.016
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 5.0%
| epoch   6 |   100/  269 batches | lr 0.00030 | ms/batch 248.43 | loss  5.75 | ppl   315.11 
| epoch   6 |   200/  269 batches | lr 0.00030 | ms/batch 242.53 | loss  5.64 | ppl   281.14 
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 66.02s | valid loss  5.37 | valid ppl   215.77 | valid bpc    7.753
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 6.0%
| epoch   7 |   100/  269 batches | lr 0.00030 | ms/batch 246.96 | loss  5.55 | ppl   255.98 
| epoch   7 |   200/  269 batches | lr 0.00030 | ms/batch 243.29 | loss  5.46 | ppl   234.70 
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 66.06s | valid loss  5.22 | valid ppl   184.68 | valid bpc    7.529
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 7.000000000000001%
| epoch   8 |   100/  269 batches | lr 0.00030 | ms/batch 247.63 | loss  5.41 | ppl   222.52 
| epoch   8 |   200/  269 batches | lr 0.00030 | ms/batch 242.53 | loss  5.30 | ppl   200.66 
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 65.97s | valid loss  5.08 | valid ppl   160.32 | valid bpc    7.325
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 8.0%
| epoch   9 |   100/  269 batches | lr 0.00030 | ms/batch 247.48 | loss  5.24 | ppl   188.98 
| epoch   9 |   200/  269 batches | lr 0.00030 | ms/batch 235.48 | loss  5.15 | ppl   173.25 
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 66.07s | valid loss  4.99 | valid ppl   146.62 | valid bpc    7.196
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 9.0%
| epoch  10 |   100/  269 batches | lr 0.00030 | ms/batch 247.20 | loss  5.12 | ppl   166.57 
| epoch  10 |   200/  269 batches | lr 0.00030 | ms/batch 236.62 | loss  5.03 | ppl   153.61 
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 66.31s | valid loss  4.87 | valid ppl   129.78 | valid bpc    7.020
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 10.0%
| epoch  11 |   100/  269 batches | lr 0.00030 | ms/batch 247.62 | loss  5.00 | ppl   148.71 
| epoch  11 |   200/  269 batches | lr 0.00030 | ms/batch 234.22 | loss  4.91 | ppl   135.33 
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 66.18s | valid loss  4.74 | valid ppl   114.98 | valid bpc    6.845
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 11.0%
| epoch  12 |   100/  269 batches | lr 0.00030 | ms/batch 248.15 | loss  4.90 | ppl   133.76 
| epoch  12 |   200/  269 batches | lr 0.00030 | ms/batch 233.33 | loss  4.83 | ppl   125.22 
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 66.06s | valid loss  4.67 | valid ppl   106.82 | valid bpc    6.739
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 12.0%
| epoch  13 |   100/  269 batches | lr 0.00030 | ms/batch 246.75 | loss  4.78 | ppl   119.30 
| epoch  13 |   200/  269 batches | lr 0.00030 | ms/batch 237.25 | loss  4.73 | ppl   113.37 
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 66.35s | valid loss  4.62 | valid ppl   101.67 | valid bpc    6.668
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 13.0%
| epoch  14 |   100/  269 batches | lr 0.00030 | ms/batch 248.34 | loss  4.70 | ppl   109.82 
| epoch  14 |   200/  269 batches | lr 0.00030 | ms/batch 233.44 | loss  4.65 | ppl   104.38 
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 66.03s | valid loss  4.52 | valid ppl    91.70 | valid bpc    6.519
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 14.000000000000002%
| epoch  15 |   100/  269 batches | lr 0.00030 | ms/batch 248.78 | loss  4.58 | ppl    97.63 
| epoch  15 |   200/  269 batches | lr 0.00030 | ms/batch 233.57 | loss  4.56 | ppl    95.20 
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 66.11s | valid loss  4.47 | valid ppl    87.75 | valid bpc    6.455
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 15.0%
| epoch  16 |   100/  269 batches | lr 0.00030 | ms/batch 246.50 | loss  4.54 | ppl    93.72 
| epoch  16 |   200/  269 batches | lr 0.00030 | ms/batch 231.50 | loss  4.46 | ppl    86.08 
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 65.92s | valid loss  4.38 | valid ppl    80.11 | valid bpc    6.324
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 16.0%
| epoch  17 |   100/  269 batches | lr 0.00030 | ms/batch 242.06 | loss  4.45 | ppl    85.34 
| epoch  17 |   200/  269 batches | lr 0.00030 | ms/batch 242.33 | loss  4.39 | ppl    81.03 
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 66.38s | valid loss  4.35 | valid ppl    77.53 | valid bpc    6.277
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 17.0%
| epoch  18 |   100/  269 batches | lr 0.00030 | ms/batch 236.52 | loss  4.38 | ppl    79.61 
| epoch  18 |   200/  269 batches | lr 0.00030 | ms/batch 244.92 | loss  4.33 | ppl    75.68 
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 66.15s | valid loss  4.35 | valid ppl    77.55 | valid bpc    6.277
-----------------------------------------------------------------------------------------
PROGRESS: 18.0%
| epoch  19 |   100/  269 batches | lr 0.00030 | ms/batch 238.59 | loss  4.27 | ppl    71.69 
| epoch  19 |   200/  269 batches | lr 0.00030 | ms/batch 241.91 | loss  4.25 | ppl    69.80 
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 66.07s | valid loss  4.29 | valid ppl    72.97 | valid bpc    6.189
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 19.0%
| epoch  20 |   100/  269 batches | lr 0.00030 | ms/batch 241.13 | loss  4.23 | ppl    68.65 
| epoch  20 |   200/  269 batches | lr 0.00030 | ms/batch 242.41 | loss  4.21 | ppl    67.09 
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 66.32s | valid loss  4.22 | valid ppl    68.22 | valid bpc    6.092
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 20.0%
| epoch  21 |   100/  269 batches | lr 0.00030 | ms/batch 241.32 | loss  4.16 | ppl    64.14 
| epoch  21 |   200/  269 batches | lr 0.00030 | ms/batch 242.34 | loss  4.12 | ppl    61.71 
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 66.34s | valid loss  4.16 | valid ppl    64.34 | valid bpc    6.008
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 21.0%
| epoch  22 |   100/  269 batches | lr 0.00030 | ms/batch 241.72 | loss  4.10 | ppl    60.58 
| epoch  22 |   200/  269 batches | lr 0.00030 | ms/batch 242.63 | loss  4.06 | ppl    58.19 
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 66.36s | valid loss  4.17 | valid ppl    65.00 | valid bpc    6.022
-----------------------------------------------------------------------------------------
PROGRESS: 22.0%
| epoch  23 |   100/  269 batches | lr 0.00030 | ms/batch 242.38 | loss  4.06 | ppl    57.86 
| epoch  23 |   200/  269 batches | lr 0.00030 | ms/batch 242.37 | loss  4.00 | ppl    54.83 
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 66.43s | valid loss  4.11 | valid ppl    61.23 | valid bpc    5.936
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 23.0%
| epoch  24 |   100/  269 batches | lr 0.00030 | ms/batch 241.99 | loss  4.00 | ppl    54.42 
| epoch  24 |   200/  269 batches | lr 0.00030 | ms/batch 242.60 | loss  3.95 | ppl    51.92 
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 66.41s | valid loss  4.08 | valid ppl    58.90 | valid bpc    5.880
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 24.0%
| epoch  25 |   100/  269 batches | lr 0.00030 | ms/batch 245.95 | loss  3.93 | ppl    50.98 
| epoch  25 |   200/  269 batches | lr 0.00030 | ms/batch 242.40 | loss  3.90 | ppl    49.32 
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 66.08s | valid loss  4.02 | valid ppl    55.47 | valid bpc    5.794
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 25.0%
| epoch  26 |   100/  269 batches | lr 0.00030 | ms/batch 253.77 | loss  3.90 | ppl    49.41 
| epoch  26 |   200/  269 batches | lr 0.00030 | ms/batch 242.56 | loss  3.85 | ppl    46.97 
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 66.52s | valid loss  4.00 | valid ppl    54.61 | valid bpc    5.771
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 26.0%
| epoch  27 |   100/  269 batches | lr 0.00030 | ms/batch 256.80 | loss  3.83 | ppl    46.14 
| epoch  27 |   200/  269 batches | lr 0.00030 | ms/batch 242.60 | loss  3.82 | ppl    45.46 
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 66.17s | valid loss  4.05 | valid ppl    57.37 | valid bpc    5.842
-----------------------------------------------------------------------------------------
PROGRESS: 27.0%
| epoch  28 |   100/  269 batches | lr 0.00030 | ms/batch 256.04 | loss  3.79 | ppl    44.43 
| epoch  28 |   200/  269 batches | lr 0.00030 | ms/batch 243.24 | loss  3.75 | ppl    42.59 
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 66.47s | valid loss  4.01 | valid ppl    55.24 | valid bpc    5.788
-----------------------------------------------------------------------------------------
PROGRESS: 28.000000000000004%
| epoch  29 |   100/  269 batches | lr 0.00030 | ms/batch 256.83 | loss  3.77 | ppl    43.21 
| epoch  29 |   200/  269 batches | lr 0.00030 | ms/batch 240.28 | loss  3.73 | ppl    41.86 
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 66.71s | valid loss  3.96 | valid ppl    52.44 | valid bpc    5.713
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 28.999999999999996%
| epoch  30 |   100/  269 batches | lr 0.00030 | ms/batch 256.39 | loss  3.69 | ppl    39.96 
| epoch  30 |   200/  269 batches | lr 0.00030 | ms/batch 233.62 | loss  3.69 | ppl    39.98 
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 66.37s | valid loss  3.94 | valid ppl    51.31 | valid bpc    5.681
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 30.0%
| epoch  31 |   100/  269 batches | lr 0.00030 | ms/batch 256.47 | loss  3.63 | ppl    37.82 
| epoch  31 |   200/  269 batches | lr 0.00030 | ms/batch 236.64 | loss  3.66 | ppl    39.02 
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 66.76s | valid loss  3.95 | valid ppl    51.72 | valid bpc    5.693
-----------------------------------------------------------------------------------------
PROGRESS: 31.0%
| epoch  32 |   100/  269 batches | lr 0.00030 | ms/batch 256.98 | loss  3.60 | ppl    36.71 
| epoch  32 |   200/  269 batches | lr 0.00030 | ms/batch 236.40 | loss  3.59 | ppl    36.38 
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 66.50s | valid loss  3.95 | valid ppl    51.79 | valid bpc    5.694
-----------------------------------------------------------------------------------------
PROGRESS: 32.0%
| epoch  33 |   100/  269 batches | lr 0.00030 | ms/batch 257.42 | loss  3.58 | ppl    35.83 
| epoch  33 |   200/  269 batches | lr 0.00030 | ms/batch 236.26 | loss  3.55 | ppl    34.90 
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 66.77s | valid loss  3.87 | valid ppl    48.16 | valid bpc    5.590
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 33.0%
| epoch  34 |   100/  269 batches | lr 0.00030 | ms/batch 257.44 | loss  3.56 | ppl    35.09 
| epoch  34 |   200/  269 batches | lr 0.00030 | ms/batch 236.57 | loss  3.52 | ppl    33.90 
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 66.76s | valid loss  3.91 | valid ppl    49.89 | valid bpc    5.641
-----------------------------------------------------------------------------------------
PROGRESS: 34.0%
| epoch  35 |   100/  269 batches | lr 0.00030 | ms/batch 255.79 | loss  3.49 | ppl    32.87 
| epoch  35 |   200/  269 batches | lr 0.00030 | ms/batch 236.77 | loss  3.49 | ppl    32.81 
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 66.74s | valid loss  3.91 | valid ppl    50.13 | valid bpc    5.648
-----------------------------------------------------------------------------------------
PROGRESS: 35.0%
| epoch  36 |   100/  269 batches | lr 0.00030 | ms/batch 255.49 | loss  3.48 | ppl    32.38 
| epoch  36 |   200/  269 batches | lr 0.00030 | ms/batch 236.77 | loss  3.45 | ppl    31.41 
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 66.32s | valid loss  3.87 | valid ppl    47.93 | valid bpc    5.583
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 36.0%
| epoch  37 |   100/  269 batches | lr 0.00030 | ms/batch 251.68 | loss  3.42 | ppl    30.50 
| epoch  37 |   200/  269 batches | lr 0.00030 | ms/batch 242.81 | loss  3.44 | ppl    31.15 
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 66.82s | valid loss  3.87 | valid ppl    48.12 | valid bpc    5.588
-----------------------------------------------------------------------------------------
PROGRESS: 37.0%
| epoch  38 |   100/  269 batches | lr 0.00030 | ms/batch 251.05 | loss  3.40 | ppl    29.82 
| epoch  38 |   200/  269 batches | lr 0.00030 | ms/batch 241.59 | loss  3.39 | ppl    29.75 
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 66.71s | valid loss  3.90 | valid ppl    49.30 | valid bpc    5.624
-----------------------------------------------------------------------------------------
PROGRESS: 38.0%
| epoch  39 |   100/  269 batches | lr 0.00030 | ms/batch 251.20 | loss  3.37 | ppl    29.02 
| epoch  39 |   200/  269 batches | lr 0.00030 | ms/batch 242.99 | loss  3.36 | ppl    28.70 
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 66.79s | valid loss  3.82 | valid ppl    45.50 | valid bpc    5.508
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 39.0%
| epoch  40 |   100/  269 batches | lr 0.00030 | ms/batch 251.51 | loss  3.35 | ppl    28.61 
| epoch  40 |   200/  269 batches | lr 0.00030 | ms/batch 241.73 | loss  3.35 | ppl    28.41 
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 66.69s | valid loss  3.81 | valid ppl    45.30 | valid bpc    5.502
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 40.0%
| epoch  41 |   100/  269 batches | lr 0.00030 | ms/batch 250.91 | loss  3.32 | ppl    27.53 
| epoch  41 |   200/  269 batches | lr 0.00030 | ms/batch 242.17 | loss  3.30 | ppl    27.10 
-----------------------------------------------------------------------------------------
| end of epoch  41 | time: 66.75s | valid loss  3.85 | valid ppl    47.09 | valid bpc    5.557
-----------------------------------------------------------------------------------------
PROGRESS: 41.0%
| epoch  42 |   100/  269 batches | lr 0.00030 | ms/batch 251.86 | loss  3.31 | ppl    27.32 
| epoch  42 |   200/  269 batches | lr 0.00030 | ms/batch 242.26 | loss  3.27 | ppl    26.31 
-----------------------------------------------------------------------------------------
| end of epoch  42 | time: 66.72s | valid loss  3.86 | valid ppl    47.36 | valid bpc    5.565
-----------------------------------------------------------------------------------------
PROGRESS: 42.0%
| epoch  43 |   100/  269 batches | lr 0.00030 | ms/batch 247.90 | loss  3.26 | ppl    25.96 
| epoch  43 |   200/  269 batches | lr 0.00030 | ms/batch 242.27 | loss  3.26 | ppl    26.14 
-----------------------------------------------------------------------------------------
| end of epoch  43 | time: 65.99s | valid loss  3.81 | valid ppl    45.20 | valid bpc    5.498
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 43.0%
| epoch  44 |   100/  269 batches | lr 0.00030 | ms/batch 246.24 | loss  3.23 | ppl    25.34 
| epoch  44 |   200/  269 batches | lr 0.00030 | ms/batch 243.23 | loss  3.22 | ppl    24.99 
-----------------------------------------------------------------------------------------
| end of epoch  44 | time: 66.43s | valid loss  3.84 | valid ppl    46.58 | valid bpc    5.542
-----------------------------------------------------------------------------------------
PROGRESS: 44.0%
| epoch  45 |   100/  269 batches | lr 0.00030 | ms/batch 250.89 | loss  3.20 | ppl    24.54 
| epoch  45 |   200/  269 batches | lr 0.00030 | ms/batch 242.38 | loss  3.19 | ppl    24.41 
-----------------------------------------------------------------------------------------
| end of epoch  45 | time: 65.78s | valid loss  3.82 | valid ppl    45.78 | valid bpc    5.517
-----------------------------------------------------------------------------------------
PROGRESS: 45.0%
| epoch  46 |   100/  269 batches | lr 0.00030 | ms/batch 256.23 | loss  3.18 | ppl    23.95 
| epoch  46 |   200/  269 batches | lr 0.00030 | ms/batch 243.43 | loss  3.16 | ppl    23.66 
-----------------------------------------------------------------------------------------
| end of epoch  46 | time: 66.70s | valid loss  3.79 | valid ppl    44.07 | valid bpc    5.462
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 46.0%
| epoch  47 |   100/  269 batches | lr 0.00030 | ms/batch 255.66 | loss  3.15 | ppl    23.32 
| epoch  47 |   200/  269 batches | lr 0.00030 | ms/batch 238.86 | loss  3.16 | ppl    23.47 
-----------------------------------------------------------------------------------------
| end of epoch  47 | time: 66.64s | valid loss  3.82 | valid ppl    45.78 | valid bpc    5.517
-----------------------------------------------------------------------------------------
PROGRESS: 47.0%
| epoch  48 |   100/  269 batches | lr 0.00030 | ms/batch 257.16 | loss  3.11 | ppl    22.44 
| epoch  48 |   200/  269 batches | lr 0.00030 | ms/batch 237.11 | loss  3.13 | ppl    22.80 
-----------------------------------------------------------------------------------------
| end of epoch  48 | time: 66.71s | valid loss  3.84 | valid ppl    46.64 | valid bpc    5.543
-----------------------------------------------------------------------------------------
PROGRESS: 48.0%
| epoch  49 |   100/  269 batches | lr 0.00030 | ms/batch 256.36 | loss  3.10 | ppl    22.09 
| epoch  49 |   200/  269 batches | lr 0.00030 | ms/batch 236.72 | loss  3.10 | ppl    22.20 
-----------------------------------------------------------------------------------------
| end of epoch  49 | time: 66.70s | valid loss  3.81 | valid ppl    45.08 | valid bpc    5.495
-----------------------------------------------------------------------------------------
PROGRESS: 49.0%
| epoch  50 |   100/  269 batches | lr 0.00015 | ms/batch 257.97 | loss  3.03 | ppl    20.65 
| epoch  50 |   200/  269 batches | lr 0.00015 | ms/batch 236.42 | loss  2.99 | ppl    19.83 
-----------------------------------------------------------------------------------------
| end of epoch  50 | time: 66.78s | valid loss  3.82 | valid ppl    45.56 | valid bpc    5.510
-----------------------------------------------------------------------------------------
PROGRESS: 50.0%
| epoch  51 |   100/  269 batches | lr 0.00015 | ms/batch 256.28 | loss  2.96 | ppl    19.27 
| epoch  51 |   200/  269 batches | lr 0.00015 | ms/batch 231.28 | loss  2.97 | ppl    19.44 
-----------------------------------------------------------------------------------------
| end of epoch  51 | time: 66.78s | valid loss  3.76 | valid ppl    43.11 | valid bpc    5.430
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 51.0%
| epoch  52 |   100/  269 batches | lr 0.00015 | ms/batch 255.94 | loss  2.94 | ppl    18.95 
| epoch  52 |   200/  269 batches | lr 0.00015 | ms/batch 231.51 | loss  2.94 | ppl    18.85 
-----------------------------------------------------------------------------------------
| end of epoch  52 | time: 66.72s | valid loss  3.76 | valid ppl    42.94 | valid bpc    5.424
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 52.0%
| epoch  53 |   100/  269 batches | lr 0.00015 | ms/batch 256.53 | loss  2.92 | ppl    18.59 
| epoch  53 |   200/  269 batches | lr 0.00015 | ms/batch 230.74 | loss  2.88 | ppl    17.78 
-----------------------------------------------------------------------------------------
| end of epoch  53 | time: 66.75s | valid loss  3.83 | valid ppl    46.15 | valid bpc    5.528
-----------------------------------------------------------------------------------------
PROGRESS: 53.0%
| epoch  54 |   100/  269 batches | lr 0.00015 | ms/batch 257.37 | loss  2.90 | ppl    18.12 
| epoch  54 |   200/  269 batches | lr 0.00015 | ms/batch 229.72 | loss  2.84 | ppl    17.13 
-----------------------------------------------------------------------------------------
| end of epoch  54 | time: 66.69s | valid loss  3.81 | valid ppl    45.05 | valid bpc    5.493
-----------------------------------------------------------------------------------------
PROGRESS: 54.0%
| epoch  55 |   100/  269 batches | lr 0.00015 | ms/batch 255.97 | loss  2.87 | ppl    17.61 
| epoch  55 |   200/  269 batches | lr 0.00015 | ms/batch 231.09 | loss  2.89 | ppl    17.92 
-----------------------------------------------------------------------------------------
| end of epoch  55 | time: 66.70s | valid loss  3.84 | valid ppl    46.49 | valid bpc    5.539
-----------------------------------------------------------------------------------------
PROGRESS: 55.00000000000001%
| epoch  56 |   100/  269 batches | lr 0.00007 | ms/batch 255.72 | loss  2.84 | ppl    17.20 
| epoch  56 |   200/  269 batches | lr 0.00007 | ms/batch 232.01 | loss  2.80 | ppl    16.52 
-----------------------------------------------------------------------------------------
| end of epoch  56 | time: 66.72s | valid loss  3.74 | valid ppl    41.93 | valid bpc    5.390
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 56.00000000000001%
| epoch  57 |   100/  269 batches | lr 0.00007 | ms/batch 255.16 | loss  2.79 | ppl    16.32 
| epoch  57 |   200/  269 batches | lr 0.00007 | ms/batch 231.42 | loss  2.79 | ppl    16.29 
-----------------------------------------------------------------------------------------
| end of epoch  57 | time: 66.67s | valid loss  3.77 | valid ppl    43.35 | valid bpc    5.438
-----------------------------------------------------------------------------------------
PROGRESS: 56.99999999999999%
| epoch  58 |   100/  269 batches | lr 0.00007 | ms/batch 252.95 | loss  2.78 | ppl    16.20 
| epoch  58 |   200/  269 batches | lr 0.00007 | ms/batch 235.02 | loss  2.74 | ppl    15.54 
-----------------------------------------------------------------------------------------
| end of epoch  58 | time: 66.72s | valid loss  3.79 | valid ppl    44.04 | valid bpc    5.461
-----------------------------------------------------------------------------------------
PROGRESS: 57.99999999999999%
| epoch  59 |   100/  269 batches | lr 0.00007 | ms/batch 251.10 | loss  2.79 | ppl    16.22 
| epoch  59 |   200/  269 batches | lr 0.00007 | ms/batch 237.81 | loss  2.76 | ppl    15.79 
-----------------------------------------------------------------------------------------
| end of epoch  59 | time: 66.81s | valid loss  3.76 | valid ppl    43.14 | valid bpc    5.431
-----------------------------------------------------------------------------------------
PROGRESS: 59.0%
| epoch  60 |   100/  269 batches | lr 0.00004 | ms/batch 250.43 | loss  2.75 | ppl    15.62 
| epoch  60 |   200/  269 batches | lr 0.00004 | ms/batch 237.03 | loss  2.74 | ppl    15.53 
-----------------------------------------------------------------------------------------
| end of epoch  60 | time: 66.77s | valid loss  3.71 | valid ppl    40.73 | valid bpc    5.348
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 60.0%
| epoch  61 |   100/  269 batches | lr 0.00004 | ms/batch 252.60 | loss  2.73 | ppl    15.40 
| epoch  61 |   200/  269 batches | lr 0.00004 | ms/batch 235.01 | loss  2.71 | ppl    15.05 
-----------------------------------------------------------------------------------------
| end of epoch  61 | time: 66.77s | valid loss  3.71 | valid ppl    41.06 | valid bpc    5.360
-----------------------------------------------------------------------------------------
PROGRESS: 61.0%
| epoch  62 |   100/  269 batches | lr 0.00004 | ms/batch 249.35 | loss  2.71 | ppl    15.09 
| epoch  62 |   200/  269 batches | lr 0.00004 | ms/batch 237.72 | loss  2.72 | ppl    15.14 
-----------------------------------------------------------------------------------------
| end of epoch  62 | time: 66.75s | valid loss  3.75 | valid ppl    42.43 | valid bpc    5.407
-----------------------------------------------------------------------------------------
PROGRESS: 62.0%
| epoch  63 |   100/  269 batches | lr 0.00004 | ms/batch 251.43 | loss  2.72 | ppl    15.24 
| epoch  63 |   200/  269 batches | lr 0.00004 | ms/batch 237.68 | loss  2.69 | ppl    14.74 
-----------------------------------------------------------------------------------------
| end of epoch  63 | time: 66.86s | valid loss  3.79 | valid ppl    44.14 | valid bpc    5.464
-----------------------------------------------------------------------------------------
PROGRESS: 63.0%
| epoch  64 |   100/  269 batches | lr 0.00002 | ms/batch 250.08 | loss  2.70 | ppl    14.92 
| epoch  64 |   200/  269 batches | lr 0.00002 | ms/batch 236.21 | loss  2.67 | ppl    14.48 
-----------------------------------------------------------------------------------------
| end of epoch  64 | time: 66.79s | valid loss  3.72 | valid ppl    41.33 | valid bpc    5.369
-----------------------------------------------------------------------------------------
PROGRESS: 64.0%
| epoch  65 |   100/  269 batches | lr 0.00002 | ms/batch 250.57 | loss  2.71 | ppl    15.09 
| epoch  65 |   200/  269 batches | lr 0.00002 | ms/batch 237.31 | loss  2.65 | ppl    14.20 
-----------------------------------------------------------------------------------------
| end of epoch  65 | time: 66.79s | valid loss  3.75 | valid ppl    42.65 | valid bpc    5.414
-----------------------------------------------------------------------------------------
PROGRESS: 65.0%
| epoch  66 |   100/  269 batches | lr 0.00002 | ms/batch 249.99 | loss  2.70 | ppl    14.92 
| epoch  66 |   200/  269 batches | lr 0.00002 | ms/batch 236.93 | loss  2.68 | ppl    14.63 
-----------------------------------------------------------------------------------------
| end of epoch  66 | time: 66.08s | valid loss  3.75 | valid ppl    42.41 | valid bpc    5.406
-----------------------------------------------------------------------------------------
PROGRESS: 66.0%
| epoch  67 |   100/  269 batches | lr 0.00001 | ms/batch 257.27 | loss  2.69 | ppl    14.72 
| epoch  67 |   200/  269 batches | lr 0.00001 | ms/batch 236.79 | loss  2.66 | ppl    14.34 
-----------------------------------------------------------------------------------------
| end of epoch  67 | time: 66.79s | valid loss  3.76 | valid ppl    43.12 | valid bpc    5.430
-----------------------------------------------------------------------------------------
PROGRESS: 67.0%
| epoch  68 |   100/  269 batches | lr 0.00001 | ms/batch 256.83 | loss  2.70 | ppl    14.93 
| epoch  68 |   200/  269 batches | lr 0.00001 | ms/batch 236.06 | loss  2.65 | ppl    14.10 
-----------------------------------------------------------------------------------------
| end of epoch  68 | time: 66.72s | valid loss  3.74 | valid ppl    42.08 | valid bpc    5.395
-----------------------------------------------------------------------------------------
PROGRESS: 68.0%
| epoch  69 |   100/  269 batches | lr 0.00001 | ms/batch 255.68 | loss  2.67 | ppl    14.50 
| epoch  69 |   200/  269 batches | lr 0.00001 | ms/batch 236.47 | loss  2.66 | ppl    14.36 
-----------------------------------------------------------------------------------------
| end of epoch  69 | time: 66.67s | valid loss  3.75 | valid ppl    42.53 | valid bpc    5.410
-----------------------------------------------------------------------------------------
PROGRESS: 69.0%
| epoch  70 |   100/  269 batches | lr 0.00000 | ms/batch 255.11 | loss  2.68 | ppl    14.52 
| epoch  70 |   200/  269 batches | lr 0.00000 | ms/batch 237.00 | loss  2.66 | ppl    14.35 
-----------------------------------------------------------------------------------------
| end of epoch  70 | time: 66.69s | valid loss  3.77 | valid ppl    43.34 | valid bpc    5.438
-----------------------------------------------------------------------------------------
PROGRESS: 70.0%
| epoch  71 |   100/  269 batches | lr 0.00000 | ms/batch 255.49 | loss  2.67 | ppl    14.45 
| epoch  71 |   200/  269 batches | lr 0.00000 | ms/batch 237.63 | loss  2.68 | ppl    14.57 
-----------------------------------------------------------------------------------------
| end of epoch  71 | time: 66.71s | valid loss  3.68 | valid ppl    39.59 | valid bpc    5.307
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 71.0%
| epoch  72 |   100/  269 batches | lr 0.00000 | ms/batch 256.26 | loss  2.67 | ppl    14.48 
| epoch  72 |   200/  269 batches | lr 0.00000 | ms/batch 226.77 | loss  2.65 | ppl    14.18 
-----------------------------------------------------------------------------------------
| end of epoch  72 | time: 66.41s | valid loss  3.77 | valid ppl    43.32 | valid bpc    5.437
-----------------------------------------------------------------------------------------
PROGRESS: 72.0%
| epoch  73 |   100/  269 batches | lr 0.00000 | ms/batch 255.01 | loss  2.68 | ppl    14.64 
| epoch  73 |   200/  269 batches | lr 0.00000 | ms/batch 231.63 | loss  2.66 | ppl    14.23 
-----------------------------------------------------------------------------------------
| end of epoch  73 | time: 66.63s | valid loss  3.77 | valid ppl    43.48 | valid bpc    5.442
-----------------------------------------------------------------------------------------
PROGRESS: 73.0%
| epoch  74 |   100/  269 batches | lr 0.00000 | ms/batch 256.73 | loss  2.70 | ppl    14.81 
| epoch  74 |   200/  269 batches | lr 0.00000 | ms/batch 231.11 | loss  2.64 | ppl    14.07 
-----------------------------------------------------------------------------------------
| end of epoch  74 | time: 66.71s | valid loss  3.71 | valid ppl    40.92 | valid bpc    5.355
-----------------------------------------------------------------------------------------
PROGRESS: 74.0%
| epoch  75 |   100/  269 batches | lr 0.00000 | ms/batch 254.71 | loss  2.67 | ppl    14.38 
| epoch  75 |   200/  269 batches | lr 0.00000 | ms/batch 232.92 | loss  2.66 | ppl    14.26 
-----------------------------------------------------------------------------------------
| end of epoch  75 | time: 66.67s | valid loss  3.72 | valid ppl    41.31 | valid bpc    5.368
-----------------------------------------------------------------------------------------
PROGRESS: 75.0%
| epoch  76 |   100/  269 batches | lr 0.00000 | ms/batch 253.48 | loss  2.67 | ppl    14.39 
| epoch  76 |   200/  269 batches | lr 0.00000 | ms/batch 235.39 | loss  2.64 | ppl    13.96 
-----------------------------------------------------------------------------------------
| end of epoch  76 | time: 66.74s | valid loss  3.68 | valid ppl    39.63 | valid bpc    5.309
-----------------------------------------------------------------------------------------
PROGRESS: 76.0%
| epoch  77 |   100/  269 batches | lr 0.00000 | ms/batch 250.85 | loss  2.67 | ppl    14.42 
| epoch  77 |   200/  269 batches | lr 0.00000 | ms/batch 235.29 | loss  2.65 | ppl    14.12 
-----------------------------------------------------------------------------------------
| end of epoch  77 | time: 66.66s | valid loss  3.69 | valid ppl    40.10 | valid bpc    5.326
-----------------------------------------------------------------------------------------
PROGRESS: 77.0%
| epoch  78 |   100/  269 batches | lr 0.00000 | ms/batch 251.21 | loss  2.69 | ppl    14.77 
| epoch  78 |   200/  269 batches | lr 0.00000 | ms/batch 236.67 | loss  2.65 | ppl    14.16 
-----------------------------------------------------------------------------------------
| end of epoch  78 | time: 66.69s | valid loss  3.75 | valid ppl    42.61 | valid bpc    5.413
-----------------------------------------------------------------------------------------
PROGRESS: 78.0%
| epoch  79 |   100/  269 batches | lr 0.00000 | ms/batch 251.71 | loss  2.67 | ppl    14.48 
| epoch  79 |   200/  269 batches | lr 0.00000 | ms/batch 236.84 | loss  2.65 | ppl    14.14 
-----------------------------------------------------------------------------------------
| end of epoch  79 | time: 66.71s | valid loss  3.74 | valid ppl    42.17 | valid bpc    5.398
-----------------------------------------------------------------------------------------
PROGRESS: 79.0%
| epoch  80 |   100/  269 batches | lr 0.00000 | ms/batch 249.89 | loss  2.68 | ppl    14.61 
| epoch  80 |   200/  269 batches | lr 0.00000 | ms/batch 238.76 | loss  2.65 | ppl    14.11 
-----------------------------------------------------------------------------------------
| end of epoch  80 | time: 66.68s | valid loss  3.79 | valid ppl    44.27 | valid bpc    5.468
-----------------------------------------------------------------------------------------
PROGRESS: 80.0%
| epoch  81 |   100/  269 batches | lr 0.00000 | ms/batch 244.89 | loss  2.68 | ppl    14.56 
| epoch  81 |   200/  269 batches | lr 0.00000 | ms/batch 243.08 | loss  2.63 | ppl    13.82 
-----------------------------------------------------------------------------------------
| end of epoch  81 | time: 66.74s | valid loss  3.66 | valid ppl    39.03 | valid bpc    5.286
-----------------------------------------------------------------------------------------
Saving model (new best validation)
PROGRESS: 81.0%
| epoch  82 |   100/  269 batches | lr 0.00000 | ms/batch 233.11 | loss  2.69 | ppl    14.72 
| epoch  82 |   200/  269 batches | lr 0.00000 | ms/batch 172.51 | loss  2.63 | ppl    13.90 
-----------------------------------------------------------------------------------------
| end of epoch  82 | time: 53.25s | valid loss  3.73 | valid ppl    41.72 | valid bpc    5.383
-----------------------------------------------------------------------------------------
PROGRESS: 82.0%
| epoch  83 |   100/  269 batches | lr 0.00000 | ms/batch 174.80 | loss  2.68 | ppl    14.52 
| epoch  83 |   200/  269 batches | lr 0.00000 | ms/batch 170.83 | loss  2.63 | ppl    13.93 
-----------------------------------------------------------------------------------------
| end of epoch  83 | time: 46.53s | valid loss  3.71 | valid ppl    40.89 | valid bpc    5.354
-----------------------------------------------------------------------------------------
PROGRESS: 83.0%
| epoch  84 |   100/  269 batches | lr 0.00000 | ms/batch 163.26 | loss  2.68 | ppl    14.52 
| epoch  84 |   200/  269 batches | lr 0.00000 | ms/batch 168.85 | loss  2.63 | ppl    13.86 
-----------------------------------------------------------------------------------------
| end of epoch  84 | time: 51.08s | valid loss  3.72 | valid ppl    41.38 | valid bpc    5.371
-----------------------------------------------------------------------------------------
PROGRESS: 84.0%
| epoch  85 |   100/  269 batches | lr 0.00000 | ms/batch 251.16 | loss  2.68 | ppl    14.60 
| epoch  85 |   200/  269 batches | lr 0.00000 | ms/batch 232.69 | loss  2.64 | ppl    14.04 
-----------------------------------------------------------------------------------------
| end of epoch  85 | time: 66.31s | valid loss  3.69 | valid ppl    40.04 | valid bpc    5.323
-----------------------------------------------------------------------------------------
PROGRESS: 85.0%
| epoch  86 |   100/  269 batches | lr 0.00000 | ms/batch 251.21 | loss  2.68 | ppl    14.57 
| epoch  86 |   200/  269 batches | lr 0.00000 | ms/batch 233.28 | loss  2.64 | ppl    14.03 
-----------------------------------------------------------------------------------------
| end of epoch  86 | time: 66.34s | valid loss  3.73 | valid ppl    41.77 | valid bpc    5.384
-----------------------------------------------------------------------------------------
PROGRESS: 86.0%
| epoch  87 |   100/  269 batches | lr 0.00000 | ms/batch 250.04 | loss  2.66 | ppl    14.31 
| epoch  87 |   200/  269 batches | lr 0.00000 | ms/batch 233.60 | loss  2.66 | ppl    14.27 
-----------------------------------------------------------------------------------------
| end of epoch  87 | time: 66.30s | valid loss  3.72 | valid ppl    41.47 | valid bpc    5.374
-----------------------------------------------------------------------------------------
PROGRESS: 87.0%
| epoch  88 |   100/  269 batches | lr 0.00000 | ms/batch 250.88 | loss  2.66 | ppl    14.29 
| epoch  88 |   200/  269 batches | lr 0.00000 | ms/batch 232.40 | loss  2.65 | ppl    14.22 
-----------------------------------------------------------------------------------------
| end of epoch  88 | time: 66.35s | valid loss  3.70 | valid ppl    40.42 | valid bpc    5.337
-----------------------------------------------------------------------------------------
PROGRESS: 88.0%
| epoch  89 |   100/  269 batches | lr 0.00000 | ms/batch 252.80 | loss  2.68 | ppl    14.57 
| epoch  89 |   200/  269 batches | lr 0.00000 | ms/batch 232.14 | loss  2.63 | ppl    13.87 
-----------------------------------------------------------------------------------------
| end of epoch  89 | time: 66.33s | valid loss  3.76 | valid ppl    43.14 | valid bpc    5.431
-----------------------------------------------------------------------------------------
PROGRESS: 89.0%
| epoch  90 |   100/  269 batches | lr 0.00000 | ms/batch 250.90 | loss  2.66 | ppl    14.31 
| epoch  90 |   200/  269 batches | lr 0.00000 | ms/batch 232.26 | loss  2.66 | ppl    14.30 
-----------------------------------------------------------------------------------------
| end of epoch  90 | time: 66.27s | valid loss  3.75 | valid ppl    42.48 | valid bpc    5.409
-----------------------------------------------------------------------------------------
PROGRESS: 90.0%
| epoch  91 |   100/  269 batches | lr 0.00000 | ms/batch 250.79 | loss  2.67 | ppl    14.37 
| epoch  91 |   200/  269 batches | lr 0.00000 | ms/batch 232.63 | loss  2.64 | ppl    14.06 
-----------------------------------------------------------------------------------------
| end of epoch  91 | time: 66.34s | valid loss  3.77 | valid ppl    43.21 | valid bpc    5.433
-----------------------------------------------------------------------------------------
PROGRESS: 91.0%
| epoch  92 |   100/  269 batches | lr 0.00000 | ms/batch 250.37 | loss  2.68 | ppl    14.53 
| epoch  92 |   200/  269 batches | lr 0.00000 | ms/batch 232.80 | loss  2.67 | ppl    14.44 
-----------------------------------------------------------------------------------------
| end of epoch  92 | time: 66.34s | valid loss  3.75 | valid ppl    42.62 | valid bpc    5.413
-----------------------------------------------------------------------------------------
PROGRESS: 92.0%
| epoch  93 |   100/  269 batches | lr 0.00000 | ms/batch 252.02 | loss  2.67 | ppl    14.42 
| epoch  93 |   200/  269 batches | lr 0.00000 | ms/batch 231.41 | loss  2.64 | ppl    14.04 
-----------------------------------------------------------------------------------------
| end of epoch  93 | time: 66.34s | valid loss  3.72 | valid ppl    41.43 | valid bpc    5.373
-----------------------------------------------------------------------------------------
PROGRESS: 93.0%
| epoch  94 |   100/  269 batches | lr 0.00000 | ms/batch 252.92 | loss  2.69 | ppl    14.77 
| epoch  94 |   200/  269 batches | lr 0.00000 | ms/batch 232.36 | loss  2.66 | ppl    14.34 
-----------------------------------------------------------------------------------------
| end of epoch  94 | time: 66.38s | valid loss  3.72 | valid ppl    41.12 | valid bpc    5.362
-----------------------------------------------------------------------------------------
PROGRESS: 94.0%
| epoch  95 |   100/  269 batches | lr 0.00000 | ms/batch 248.87 | loss  2.66 | ppl    14.26 
| epoch  95 |   200/  269 batches | lr 0.00000 | ms/batch 235.08 | loss  2.66 | ppl    14.28 
-----------------------------------------------------------------------------------------
| end of epoch  95 | time: 66.34s | valid loss  3.74 | valid ppl    42.22 | valid bpc    5.400
-----------------------------------------------------------------------------------------
PROGRESS: 95.0%
| epoch  96 |   100/  269 batches | lr 0.00000 | ms/batch 242.87 | loss  2.67 | ppl    14.39 
| epoch  96 |   200/  269 batches | lr 0.00000 | ms/batch 241.80 | loss  2.66 | ppl    14.24 
-----------------------------------------------------------------------------------------
| end of epoch  96 | time: 66.56s | valid loss  3.73 | valid ppl    41.59 | valid bpc    5.378
-----------------------------------------------------------------------------------------
PROGRESS: 96.0%
| epoch  97 |   100/  269 batches | lr 0.00000 | ms/batch 242.00 | loss  2.65 | ppl    14.16 
| epoch  97 |   200/  269 batches | lr 0.00000 | ms/batch 241.66 | loss  2.65 | ppl    14.20 
-----------------------------------------------------------------------------------------
| end of epoch  97 | time: 66.38s | valid loss  3.76 | valid ppl    42.81 | valid bpc    5.420
-----------------------------------------------------------------------------------------
PROGRESS: 97.0%
| epoch  98 |   100/  269 batches | lr 0.00000 | ms/batch 242.90 | loss  2.64 | ppl    14.06 
| epoch  98 |   200/  269 batches | lr 0.00000 | ms/batch 241.34 | loss  2.68 | ppl    14.59 
-----------------------------------------------------------------------------------------
| end of epoch  98 | time: 66.36s | valid loss  3.71 | valid ppl    40.86 | valid bpc    5.353
-----------------------------------------------------------------------------------------
PROGRESS: 98.0%
| epoch  99 |   100/  269 batches | lr 0.00000 | ms/batch 197.50 | loss  2.67 | ppl    14.37 
| epoch  99 |   200/  269 batches | lr 0.00000 | ms/batch 172.33 | loss  2.65 | ppl    14.11 
-----------------------------------------------------------------------------------------
| end of epoch  99 | time: 49.73s | valid loss  3.74 | valid ppl    42.28 | valid bpc    5.402
-----------------------------------------------------------------------------------------
PROGRESS: 99.0%
| epoch 100 |   100/  269 batches | lr 0.00000 | ms/batch 169.28 | loss  2.68 | ppl    14.52 
| epoch 100 |   200/  269 batches | lr 0.00000 | ms/batch 166.80 | loss  2.65 | ppl    14.15 
-----------------------------------------------------------------------------------------
| end of epoch 100 | time: 45.57s | valid loss  3.77 | valid ppl    43.50 | valid bpc    5.443
-----------------------------------------------------------------------------------------
PROGRESS: 100.0%
=========================================================================================
| End of training | test loss  3.80 | test ppl    44.63 | test bpc    5.480
=========================================================================================
Constituency parsing performance:
Mean Prec: 0.4700, Mean Reca: 0.6575, Mean F1: 0.5442, Mean Subword_Reca: 0.7714
-----------------------------------------------------------------------------------------
=========================================================================================
